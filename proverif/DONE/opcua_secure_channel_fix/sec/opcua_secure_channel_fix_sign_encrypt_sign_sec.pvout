Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
{7}new skI: bitstring;
{8}out(c, skI);
(
    {9}!
    {10}in(c, (Cli: host,Disco: host,Sess: host));
    {11}let v_594: bool = (Cli = A) in
    (
        {12}if v_594 then
        (
            {13}let skCli: bitstring = skA in
            {14}let pkCli: bitstring = pub(skCli) in
            {15}let v_595: bool = (Disco = A) in
            (
                {16}if v_595 then
                (
                    {17}let pkDisco: bitstring = pub(skA) in
                    {18}let v_596: bool = (Sess = A) in
                    (
                        {19}if v_596 then
                        (
                            {20}let pkSess: bitstring = pub(skA) in
                            {21}out(c, GetEndpointRequest);
                            {22}in(c, (SPs: bitstring,=SignAndEncrypt,UP: bitstring,=pkSess));
                            {23}new SPc: bitstring;
                            {24}new Nc: bitstring;
                            {25}let m1: bitstring = (Sess,SPc,exp(g,Nc)) in
                            {26}out(c, (pkCli,enc(m1,pkSess),sign(m1,skCli)));
                            {27}in(c, (ePartS: bitstring,sigPartS: bitstring));
                            {28}let (=Cli,PartS: bitstring) = dec(ePartS,skCli) in
                            {29}if (verify((Cli,PartS),sigPartS,pkSess) <> true) then
                                0
                            else
                                {30}let Kcli: bitstring = exp(PartS,Nc) in
                                {31}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {32}let v_597: bool = (Sess = B) in
                            (
                                {33}if v_597 then
                                (
                                    {34}let pkSess_598: bitstring = pub(skB) in
                                    {35}out(c, GetEndpointRequest);
                                    {36}in(c, (SPs_599: bitstring,=SignAndEncrypt,UP_600: bitstring,=pkSess_598));
                                    {37}new SPc_601: bitstring;
                                    {38}new Nc_602: bitstring;
                                    {39}let m1_603: bitstring = (Sess,SPc_601,exp(g,Nc_602)) in
                                    {40}out(c, (pkCli,enc(m1_603,pkSess_598),sign(m1_603,skCli)));
                                    {41}in(c, (ePartS_604: bitstring,sigPartS_605: bitstring));
                                    {42}let (=Cli,PartS_606: bitstring) = dec(ePartS_604,skCli) in
                                    {43}if (verify((Cli,PartS_606),sigPartS_605,pkSess_598) <> true) then
                                        0
                                    else
                                        {44}let Kcli_607: bitstring = exp(PartS_606,Nc_602) in
                                        {45}out(c, senc(mCli(pkCli,pkSess_598),Kcli_607))
                                )
                                else
                                    {46}let v_608: bool = (Sess = C) in
                                    (
                                        {47}if v_608 then
                                        (
                                            {48}let pkSess_609: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (SPs_610: bitstring,=SignAndEncrypt,UP_611: bitstring,=pkSess_609));
                                            {51}new SPc_612: bitstring;
                                            {52}new Nc_613: bitstring;
                                            {53}let m1_614: bitstring = (Sess,SPc_612,exp(g,Nc_613)) in
                                            {54}out(c, (pkCli,enc(m1_614,pkSess_609),sign(m1_614,skCli)));
                                            {55}in(c, (ePartS_615: bitstring,sigPartS_616: bitstring));
                                            {56}let (=Cli,PartS_617: bitstring) = dec(ePartS_615,skCli) in
                                            {57}if (verify((Cli,PartS_617),sigPartS_616,pkSess_609) <> true) then
                                                0
                                            else
                                                {58}let Kcli_618: bitstring = exp(PartS_617,Nc_613) in
                                                {59}out(c, senc(mCli(pkCli,pkSess_609),Kcli_618))
                                        )
                                        else
                                            {60}let pkSess_619: bitstring = pub(skI) in
                                            {61}out(c, GetEndpointRequest);
                                            {62}in(c, (SPs_620: bitstring,=SignAndEncrypt,UP_621: bitstring,=pkSess_619));
                                            {63}new SPc_622: bitstring;
                                            {64}new Nc_623: bitstring;
                                            {65}let m1_624: bitstring = (Sess,SPc_622,exp(g,Nc_623)) in
                                            {66}out(c, (pkCli,enc(m1_624,pkSess_619),sign(m1_624,skCli)));
                                            {67}in(c, (ePartS_625: bitstring,sigPartS_626: bitstring));
                                            {68}let (=Cli,PartS_627: bitstring) = dec(ePartS_625,skCli) in
                                            {69}if (verify((Cli,PartS_627),sigPartS_626,pkSess_619) <> true) then
                                                0
                                            else
                                                {70}let Kcli_628: bitstring = exp(PartS_627,Nc_623) in
                                                {71}out(c, senc(mCli(pkCli,pkSess_619),Kcli_628))
                                    )
                                    else
                                        {72}let pkSess_629: bitstring = fail-any in
                                        {73}out(c, GetEndpointRequest);
                                        {74}in(c, (SPs_630: bitstring,=SignAndEncrypt,UP_631: bitstring,=pkSess_629));
                                        {75}new SPc_632: bitstring;
                                        {76}new Nc_633: bitstring;
                                        {77}let m1_634: bitstring = (Sess,SPc_632,exp(g,Nc_633)) in
                                        {78}out(c, (pkCli,enc(m1_634,pkSess_629),sign(m1_634,skCli)));
                                        {79}in(c, (ePartS_635: bitstring,sigPartS_636: bitstring));
                                        {80}let (=Cli,PartS_637: bitstring) = dec(ePartS_635,skCli) in
                                        {81}if (verify((Cli,PartS_637),sigPartS_636,pkSess_629) <> true) then
                                            0
                                        else
                                            {82}let Kcli_638: bitstring = exp(PartS_637,Nc_633) in
                                            {83}out(c, senc(mCli(pkCli,pkSess_629),Kcli_638))
                            )
                            else
                                {84}let pkSess_639: bitstring = fail-any in
                                {85}out(c, GetEndpointRequest);
                                {86}in(c, (SPs_640: bitstring,=SignAndEncrypt,UP_641: bitstring,=pkSess_639));
                                {87}new SPc_642: bitstring;
                                {88}new Nc_643: bitstring;
                                {89}let m1_644: bitstring = (Sess,SPc_642,exp(g,Nc_643)) in
                                {90}out(c, (pkCli,enc(m1_644,pkSess_639),sign(m1_644,skCli)));
                                {91}in(c, (ePartS_645: bitstring,sigPartS_646: bitstring));
                                {92}let (=Cli,PartS_647: bitstring) = dec(ePartS_645,skCli) in
                                {93}if (verify((Cli,PartS_647),sigPartS_646,pkSess_639) <> true) then
                                    0
                                else
                                    {94}let Kcli_648: bitstring = exp(PartS_647,Nc_643) in
                                    {95}out(c, senc(mCli(pkCli,pkSess_639),Kcli_648))
                    )
                    else
                        {96}let pkSess_649: bitstring = fail-any in
                        {97}out(c, GetEndpointRequest);
                        {98}in(c, (SPs_650: bitstring,=SignAndEncrypt,UP_651: bitstring,=pkSess_649));
                        {99}new SPc_652: bitstring;
                        {100}new Nc_653: bitstring;
                        {101}let m1_654: bitstring = (Sess,SPc_652,exp(g,Nc_653)) in
                        {102}out(c, (pkCli,enc(m1_654,pkSess_649),sign(m1_654,skCli)));
                        {103}in(c, (ePartS_655: bitstring,sigPartS_656: bitstring));
                        {104}let (=Cli,PartS_657: bitstring) = dec(ePartS_655,skCli) in
                        {105}if (verify((Cli,PartS_657),sigPartS_656,pkSess_649) <> true) then
                            0
                        else
                            {106}let Kcli_658: bitstring = exp(PartS_657,Nc_653) in
                            {107}out(c, senc(mCli(pkCli,pkSess_649),Kcli_658))
                )
                else
                    {108}let v_659: bool = (Disco = B) in
                    (
                        {109}if v_659 then
                        (
                            {110}let pkDisco_660: bitstring = pub(skB) in
                            {111}let v_661: bool = (Sess = A) in
                            (
                                {112}if v_661 then
                                (
                                    {113}let pkSess_662: bitstring = pub(skA) in
                                    {114}out(c, GetEndpointRequest);
                                    {115}in(c, (SPs_663: bitstring,=SignAndEncrypt,UP_664: bitstring,=pkSess_662));
                                    {116}new SPc_665: bitstring;
                                    {117}new Nc_666: bitstring;
                                    {118}let m1_667: bitstring = (Sess,SPc_665,exp(g,Nc_666)) in
                                    {119}out(c, (pkCli,enc(m1_667,pkSess_662),sign(m1_667,skCli)));
                                    {120}in(c, (ePartS_668: bitstring,sigPartS_669: bitstring));
                                    {121}let (=Cli,PartS_670: bitstring) = dec(ePartS_668,skCli) in
                                    {122}if (verify((Cli,PartS_670),sigPartS_669,pkSess_662) <> true) then
                                        0
                                    else
                                        {123}let Kcli_671: bitstring = exp(PartS_670,Nc_666) in
                                        {124}out(c, senc(mCli(pkCli,pkSess_662),Kcli_671))
                                )
                                else
                                    {125}let v_672: bool = (Sess = B) in
                                    (
                                        {126}if v_672 then
                                        (
                                            {127}let pkSess_673: bitstring = pub(skB) in
                                            {128}out(c, GetEndpointRequest);
                                            {129}in(c, (SPs_674: bitstring,=SignAndEncrypt,UP_675: bitstring,=pkSess_673));
                                            {130}new SPc_676: bitstring;
                                            {131}new Nc_677: bitstring;
                                            {132}let m1_678: bitstring = (Sess,SPc_676,exp(g,Nc_677)) in
                                            {133}out(c, (pkCli,enc(m1_678,pkSess_673),sign(m1_678,skCli)));
                                            {134}in(c, (ePartS_679: bitstring,sigPartS_680: bitstring));
                                            {135}let (=Cli,PartS_681: bitstring) = dec(ePartS_679,skCli) in
                                            {136}if (verify((Cli,PartS_681),sigPartS_680,pkSess_673) <> true) then
                                                0
                                            else
                                                {137}let Kcli_682: bitstring = exp(PartS_681,Nc_677) in
                                                {138}out(c, senc(mCli(pkCli,pkSess_673),Kcli_682))
                                        )
                                        else
                                            {139}let v_683: bool = (Sess = C) in
                                            (
                                                {140}if v_683 then
                                                (
                                                    {141}let pkSess_684: bitstring = pub(skC) in
                                                    {142}out(c, GetEndpointRequest);
                                                    {143}in(c, (SPs_685: bitstring,=SignAndEncrypt,UP_686: bitstring,=pkSess_684));
                                                    {144}new SPc_687: bitstring;
                                                    {145}new Nc_688: bitstring;
                                                    {146}let m1_689: bitstring = (Sess,SPc_687,exp(g,Nc_688)) in
                                                    {147}out(c, (pkCli,enc(m1_689,pkSess_684),sign(m1_689,skCli)));
                                                    {148}in(c, (ePartS_690: bitstring,sigPartS_691: bitstring));
                                                    {149}let (=Cli,PartS_692: bitstring) = dec(ePartS_690,skCli) in
                                                    {150}if (verify((Cli,PartS_692),sigPartS_691,pkSess_684) <> true) then
                                                        0
                                                    else
                                                        {151}let Kcli_693: bitstring = exp(PartS_692,Nc_688) in
                                                        {152}out(c, senc(mCli(pkCli,pkSess_684),Kcli_693))
                                                )
                                                else
                                                    {153}let pkSess_694: bitstring = pub(skI) in
                                                    {154}out(c, GetEndpointRequest);
                                                    {155}in(c, (SPs_695: bitstring,=SignAndEncrypt,UP_696: bitstring,=pkSess_694));
                                                    {156}new SPc_697: bitstring;
                                                    {157}new Nc_698: bitstring;
                                                    {158}let m1_699: bitstring = (Sess,SPc_697,exp(g,Nc_698)) in
                                                    {159}out(c, (pkCli,enc(m1_699,pkSess_694),sign(m1_699,skCli)));
                                                    {160}in(c, (ePartS_700: bitstring,sigPartS_701: bitstring));
                                                    {161}let (=Cli,PartS_702: bitstring) = dec(ePartS_700,skCli) in
                                                    {162}if (verify((Cli,PartS_702),sigPartS_701,pkSess_694) <> true) then
                                                        0
                                                    else
                                                        {163}let Kcli_703: bitstring = exp(PartS_702,Nc_698) in
                                                        {164}out(c, senc(mCli(pkCli,pkSess_694),Kcli_703))
                                            )
                                            else
                                                {165}let pkSess_704: bitstring = fail-any in
                                                {166}out(c, GetEndpointRequest);
                                                {167}in(c, (SPs_705: bitstring,=SignAndEncrypt,UP_706: bitstring,=pkSess_704));
                                                {168}new SPc_707: bitstring;
                                                {169}new Nc_708: bitstring;
                                                {170}let m1_709: bitstring = (Sess,SPc_707,exp(g,Nc_708)) in
                                                {171}out(c, (pkCli,enc(m1_709,pkSess_704),sign(m1_709,skCli)));
                                                {172}in(c, (ePartS_710: bitstring,sigPartS_711: bitstring));
                                                {173}let (=Cli,PartS_712: bitstring) = dec(ePartS_710,skCli) in
                                                {174}if (verify((Cli,PartS_712),sigPartS_711,pkSess_704) <> true) then
                                                    0
                                                else
                                                    {175}let Kcli_713: bitstring = exp(PartS_712,Nc_708) in
                                                    {176}out(c, senc(mCli(pkCli,pkSess_704),Kcli_713))
                                    )
                                    else
                                        {177}let pkSess_714: bitstring = fail-any in
                                        {178}out(c, GetEndpointRequest);
                                        {179}in(c, (SPs_715: bitstring,=SignAndEncrypt,UP_716: bitstring,=pkSess_714));
                                        {180}new SPc_717: bitstring;
                                        {181}new Nc_718: bitstring;
                                        {182}let m1_719: bitstring = (Sess,SPc_717,exp(g,Nc_718)) in
                                        {183}out(c, (pkCli,enc(m1_719,pkSess_714),sign(m1_719,skCli)));
                                        {184}in(c, (ePartS_720: bitstring,sigPartS_721: bitstring));
                                        {185}let (=Cli,PartS_722: bitstring) = dec(ePartS_720,skCli) in
                                        {186}if (verify((Cli,PartS_722),sigPartS_721,pkSess_714) <> true) then
                                            0
                                        else
                                            {187}let Kcli_723: bitstring = exp(PartS_722,Nc_718) in
                                            {188}out(c, senc(mCli(pkCli,pkSess_714),Kcli_723))
                            )
                            else
                                {189}let pkSess_724: bitstring = fail-any in
                                {190}out(c, GetEndpointRequest);
                                {191}in(c, (SPs_725: bitstring,=SignAndEncrypt,UP_726: bitstring,=pkSess_724));
                                {192}new SPc_727: bitstring;
                                {193}new Nc_728: bitstring;
                                {194}let m1_729: bitstring = (Sess,SPc_727,exp(g,Nc_728)) in
                                {195}out(c, (pkCli,enc(m1_729,pkSess_724),sign(m1_729,skCli)));
                                {196}in(c, (ePartS_730: bitstring,sigPartS_731: bitstring));
                                {197}let (=Cli,PartS_732: bitstring) = dec(ePartS_730,skCli) in
                                {198}if (verify((Cli,PartS_732),sigPartS_731,pkSess_724) <> true) then
                                    0
                                else
                                    {199}let Kcli_733: bitstring = exp(PartS_732,Nc_728) in
                                    {200}out(c, senc(mCli(pkCli,pkSess_724),Kcli_733))
                        )
                        else
                            {201}let v_734: bool = (Disco = C) in
                            (
                                {202}if v_734 then
                                (
                                    {203}let pkDisco_735: bitstring = pub(skC) in
                                    {204}let v_736: bool = (Sess = A) in
                                    (
                                        {205}if v_736 then
                                        (
                                            {206}let pkSess_737: bitstring = pub(skA) in
                                            {207}out(c, GetEndpointRequest);
                                            {208}in(c, (SPs_738: bitstring,=SignAndEncrypt,UP_739: bitstring,=pkSess_737));
                                            {209}new SPc_740: bitstring;
                                            {210}new Nc_741: bitstring;
                                            {211}let m1_742: bitstring = (Sess,SPc_740,exp(g,Nc_741)) in
                                            {212}out(c, (pkCli,enc(m1_742,pkSess_737),sign(m1_742,skCli)));
                                            {213}in(c, (ePartS_743: bitstring,sigPartS_744: bitstring));
                                            {214}let (=Cli,PartS_745: bitstring) = dec(ePartS_743,skCli) in
                                            {215}if (verify((Cli,PartS_745),sigPartS_744,pkSess_737) <> true) then
                                                0
                                            else
                                                {216}let Kcli_746: bitstring = exp(PartS_745,Nc_741) in
                                                {217}out(c, senc(mCli(pkCli,pkSess_737),Kcli_746))
                                        )
                                        else
                                            {218}let v_747: bool = (Sess = B) in
                                            (
                                                {219}if v_747 then
                                                (
                                                    {220}let pkSess_748: bitstring = pub(skB) in
                                                    {221}out(c, GetEndpointRequest);
                                                    {222}in(c, (SPs_749: bitstring,=SignAndEncrypt,UP_750: bitstring,=pkSess_748));
                                                    {223}new SPc_751: bitstring;
                                                    {224}new Nc_752: bitstring;
                                                    {225}let m1_753: bitstring = (Sess,SPc_751,exp(g,Nc_752)) in
                                                    {226}out(c, (pkCli,enc(m1_753,pkSess_748),sign(m1_753,skCli)));
                                                    {227}in(c, (ePartS_754: bitstring,sigPartS_755: bitstring));
                                                    {228}let (=Cli,PartS_756: bitstring) = dec(ePartS_754,skCli) in
                                                    {229}if (verify((Cli,PartS_756),sigPartS_755,pkSess_748) <> true) then
                                                        0
                                                    else
                                                        {230}let Kcli_757: bitstring = exp(PartS_756,Nc_752) in
                                                        {231}out(c, senc(mCli(pkCli,pkSess_748),Kcli_757))
                                                )
                                                else
                                                    {232}let v_758: bool = (Sess = C) in
                                                    (
                                                        {233}if v_758 then
                                                        (
                                                            {234}let pkSess_759: bitstring = pub(skC) in
                                                            {235}out(c, GetEndpointRequest);
                                                            {236}in(c, (SPs_760: bitstring,=SignAndEncrypt,UP_761: bitstring,=pkSess_759));
                                                            {237}new SPc_762: bitstring;
                                                            {238}new Nc_763: bitstring;
                                                            {239}let m1_764: bitstring = (Sess,SPc_762,exp(g,Nc_763)) in
                                                            {240}out(c, (pkCli,enc(m1_764,pkSess_759),sign(m1_764,skCli)));
                                                            {241}in(c, (ePartS_765: bitstring,sigPartS_766: bitstring));
                                                            {242}let (=Cli,PartS_767: bitstring) = dec(ePartS_765,skCli) in
                                                            {243}if (verify((Cli,PartS_767),sigPartS_766,pkSess_759) <> true) then
                                                                0
                                                            else
                                                                {244}let Kcli_768: bitstring = exp(PartS_767,Nc_763) in
                                                                {245}out(c, senc(mCli(pkCli,pkSess_759),Kcli_768))
                                                        )
                                                        else
                                                            {246}let pkSess_769: bitstring = pub(skI) in
                                                            {247}out(c, GetEndpointRequest);
                                                            {248}in(c, (SPs_770: bitstring,=SignAndEncrypt,UP_771: bitstring,=pkSess_769));
                                                            {249}new SPc_772: bitstring;
                                                            {250}new Nc_773: bitstring;
                                                            {251}let m1_774: bitstring = (Sess,SPc_772,exp(g,Nc_773)) in
                                                            {252}out(c, (pkCli,enc(m1_774,pkSess_769),sign(m1_774,skCli)));
                                                            {253}in(c, (ePartS_775: bitstring,sigPartS_776: bitstring));
                                                            {254}let (=Cli,PartS_777: bitstring) = dec(ePartS_775,skCli) in
                                                            {255}if (verify((Cli,PartS_777),sigPartS_776,pkSess_769) <> true) then
                                                                0
                                                            else
                                                                {256}let Kcli_778: bitstring = exp(PartS_777,Nc_773) in
                                                                {257}out(c, senc(mCli(pkCli,pkSess_769),Kcli_778))
                                                    )
                                                    else
                                                        {258}let pkSess_779: bitstring = fail-any in
                                                        {259}out(c, GetEndpointRequest);
                                                        {260}in(c, (SPs_780: bitstring,=SignAndEncrypt,UP_781: bitstring,=pkSess_779));
                                                        {261}new SPc_782: bitstring;
                                                        {262}new Nc_783: bitstring;
                                                        {263}let m1_784: bitstring = (Sess,SPc_782,exp(g,Nc_783)) in
                                                        {264}out(c, (pkCli,enc(m1_784,pkSess_779),sign(m1_784,skCli)));
                                                        {265}in(c, (ePartS_785: bitstring,sigPartS_786: bitstring));
                                                        {266}let (=Cli,PartS_787: bitstring) = dec(ePartS_785,skCli) in
                                                        {267}if (verify((Cli,PartS_787),sigPartS_786,pkSess_779) <> true) then
                                                            0
                                                        else
                                                            {268}let Kcli_788: bitstring = exp(PartS_787,Nc_783) in
                                                            {269}out(c, senc(mCli(pkCli,pkSess_779),Kcli_788))
                                            )
                                            else
                                                {270}let pkSess_789: bitstring = fail-any in
                                                {271}out(c, GetEndpointRequest);
                                                {272}in(c, (SPs_790: bitstring,=SignAndEncrypt,UP_791: bitstring,=pkSess_789));
                                                {273}new SPc_792: bitstring;
                                                {274}new Nc_793: bitstring;
                                                {275}let m1_794: bitstring = (Sess,SPc_792,exp(g,Nc_793)) in
                                                {276}out(c, (pkCli,enc(m1_794,pkSess_789),sign(m1_794,skCli)));
                                                {277}in(c, (ePartS_795: bitstring,sigPartS_796: bitstring));
                                                {278}let (=Cli,PartS_797: bitstring) = dec(ePartS_795,skCli) in
                                                {279}if (verify((Cli,PartS_797),sigPartS_796,pkSess_789) <> true) then
                                                    0
                                                else
                                                    {280}let Kcli_798: bitstring = exp(PartS_797,Nc_793) in
                                                    {281}out(c, senc(mCli(pkCli,pkSess_789),Kcli_798))
                                    )
                                    else
                                        {282}let pkSess_799: bitstring = fail-any in
                                        {283}out(c, GetEndpointRequest);
                                        {284}in(c, (SPs_800: bitstring,=SignAndEncrypt,UP_801: bitstring,=pkSess_799));
                                        {285}new SPc_802: bitstring;
                                        {286}new Nc_803: bitstring;
                                        {287}let m1_804: bitstring = (Sess,SPc_802,exp(g,Nc_803)) in
                                        {288}out(c, (pkCli,enc(m1_804,pkSess_799),sign(m1_804,skCli)));
                                        {289}in(c, (ePartS_805: bitstring,sigPartS_806: bitstring));
                                        {290}let (=Cli,PartS_807: bitstring) = dec(ePartS_805,skCli) in
                                        {291}if (verify((Cli,PartS_807),sigPartS_806,pkSess_799) <> true) then
                                            0
                                        else
                                            {292}let Kcli_808: bitstring = exp(PartS_807,Nc_803) in
                                            {293}out(c, senc(mCli(pkCli,pkSess_799),Kcli_808))
                                )
                                else
                                    {294}let pkDisco_809: bitstring = pub(skI) in
                                    {295}let v_810: bool = (Sess = A) in
                                    (
                                        {296}if v_810 then
                                        (
                                            {297}let pkSess_811: bitstring = pub(skA) in
                                            {298}out(c, GetEndpointRequest);
                                            {299}in(c, (SPs_812: bitstring,=SignAndEncrypt,UP_813: bitstring,=pkSess_811));
                                            {300}new SPc_814: bitstring;
                                            {301}new Nc_815: bitstring;
                                            {302}let m1_816: bitstring = (Sess,SPc_814,exp(g,Nc_815)) in
                                            {303}out(c, (pkCli,enc(m1_816,pkSess_811),sign(m1_816,skCli)));
                                            {304}in(c, (ePartS_817: bitstring,sigPartS_818: bitstring));
                                            {305}let (=Cli,PartS_819: bitstring) = dec(ePartS_817,skCli) in
                                            {306}if (verify((Cli,PartS_819),sigPartS_818,pkSess_811) <> true) then
                                                0
                                            else
                                                {307}let Kcli_820: bitstring = exp(PartS_819,Nc_815) in
                                                {308}out(c, senc(mCli(pkCli,pkSess_811),Kcli_820))
                                        )
                                        else
                                            {309}let v_821: bool = (Sess = B) in
                                            (
                                                {310}if v_821 then
                                                (
                                                    {311}let pkSess_822: bitstring = pub(skB) in
                                                    {312}out(c, GetEndpointRequest);
                                                    {313}in(c, (SPs_823: bitstring,=SignAndEncrypt,UP_824: bitstring,=pkSess_822));
                                                    {314}new SPc_825: bitstring;
                                                    {315}new Nc_826: bitstring;
                                                    {316}let m1_827: bitstring = (Sess,SPc_825,exp(g,Nc_826)) in
                                                    {317}out(c, (pkCli,enc(m1_827,pkSess_822),sign(m1_827,skCli)));
                                                    {318}in(c, (ePartS_828: bitstring,sigPartS_829: bitstring));
                                                    {319}let (=Cli,PartS_830: bitstring) = dec(ePartS_828,skCli) in
                                                    {320}if (verify((Cli,PartS_830),sigPartS_829,pkSess_822) <> true) then
                                                        0
                                                    else
                                                        {321}let Kcli_831: bitstring = exp(PartS_830,Nc_826) in
                                                        {322}out(c, senc(mCli(pkCli,pkSess_822),Kcli_831))
                                                )
                                                else
                                                    {323}let v_832: bool = (Sess = C) in
                                                    (
                                                        {324}if v_832 then
                                                        (
                                                            {325}let pkSess_833: bitstring = pub(skC) in
                                                            {326}out(c, GetEndpointRequest);
                                                            {327}in(c, (SPs_834: bitstring,=SignAndEncrypt,UP_835: bitstring,=pkSess_833));
                                                            {328}new SPc_836: bitstring;
                                                            {329}new Nc_837: bitstring;
                                                            {330}let m1_838: bitstring = (Sess,SPc_836,exp(g,Nc_837)) in
                                                            {331}out(c, (pkCli,enc(m1_838,pkSess_833),sign(m1_838,skCli)));
                                                            {332}in(c, (ePartS_839: bitstring,sigPartS_840: bitstring));
                                                            {333}let (=Cli,PartS_841: bitstring) = dec(ePartS_839,skCli) in
                                                            {334}if (verify((Cli,PartS_841),sigPartS_840,pkSess_833) <> true) then
                                                                0
                                                            else
                                                                {335}let Kcli_842: bitstring = exp(PartS_841,Nc_837) in
                                                                {336}out(c, senc(mCli(pkCli,pkSess_833),Kcli_842))
                                                        )
                                                        else
                                                            {337}let pkSess_843: bitstring = pub(skI) in
                                                            {338}out(c, GetEndpointRequest);
                                                            {339}in(c, (SPs_844: bitstring,=SignAndEncrypt,UP_845: bitstring,=pkSess_843));
                                                            {340}new SPc_846: bitstring;
                                                            {341}new Nc_847: bitstring;
                                                            {342}let m1_848: bitstring = (Sess,SPc_846,exp(g,Nc_847)) in
                                                            {343}out(c, (pkCli,enc(m1_848,pkSess_843),sign(m1_848,skCli)));
                                                            {344}in(c, (ePartS_849: bitstring,sigPartS_850: bitstring));
                                                            {345}let (=Cli,PartS_851: bitstring) = dec(ePartS_849,skCli) in
                                                            {346}if (verify((Cli,PartS_851),sigPartS_850,pkSess_843) <> true) then
                                                                0
                                                            else
                                                                {347}let Kcli_852: bitstring = exp(PartS_851,Nc_847) in
                                                                {348}out(c, senc(mCli(pkCli,pkSess_843),Kcli_852))
                                                    )
                                                    else
                                                        {349}let pkSess_853: bitstring = fail-any in
                                                        {350}out(c, GetEndpointRequest);
                                                        {351}in(c, (SPs_854: bitstring,=SignAndEncrypt,UP_855: bitstring,=pkSess_853));
                                                        {352}new SPc_856: bitstring;
                                                        {353}new Nc_857: bitstring;
                                                        {354}let m1_858: bitstring = (Sess,SPc_856,exp(g,Nc_857)) in
                                                        {355}out(c, (pkCli,enc(m1_858,pkSess_853),sign(m1_858,skCli)));
                                                        {356}in(c, (ePartS_859: bitstring,sigPartS_860: bitstring));
                                                        {357}let (=Cli,PartS_861: bitstring) = dec(ePartS_859,skCli) in
                                                        {358}if (verify((Cli,PartS_861),sigPartS_860,pkSess_853) <> true) then
                                                            0
                                                        else
                                                            {359}let Kcli_862: bitstring = exp(PartS_861,Nc_857) in
                                                            {360}out(c, senc(mCli(pkCli,pkSess_853),Kcli_862))
                                            )
                                            else
                                                {361}let pkSess_863: bitstring = fail-any in
                                                {362}out(c, GetEndpointRequest);
                                                {363}in(c, (SPs_864: bitstring,=SignAndEncrypt,UP_865: bitstring,=pkSess_863));
                                                {364}new SPc_866: bitstring;
                                                {365}new Nc_867: bitstring;
                                                {366}let m1_868: bitstring = (Sess,SPc_866,exp(g,Nc_867)) in
                                                {367}out(c, (pkCli,enc(m1_868,pkSess_863),sign(m1_868,skCli)));
                                                {368}in(c, (ePartS_869: bitstring,sigPartS_870: bitstring));
                                                {369}let (=Cli,PartS_871: bitstring) = dec(ePartS_869,skCli) in
                                                {370}if (verify((Cli,PartS_871),sigPartS_870,pkSess_863) <> true) then
                                                    0
                                                else
                                                    {371}let Kcli_872: bitstring = exp(PartS_871,Nc_867) in
                                                    {372}out(c, senc(mCli(pkCli,pkSess_863),Kcli_872))
                                    )
                                    else
                                        {373}let pkSess_873: bitstring = fail-any in
                                        {374}out(c, GetEndpointRequest);
                                        {375}in(c, (SPs_874: bitstring,=SignAndEncrypt,UP_875: bitstring,=pkSess_873));
                                        {376}new SPc_876: bitstring;
                                        {377}new Nc_877: bitstring;
                                        {378}let m1_878: bitstring = (Sess,SPc_876,exp(g,Nc_877)) in
                                        {379}out(c, (pkCli,enc(m1_878,pkSess_873),sign(m1_878,skCli)));
                                        {380}in(c, (ePartS_879: bitstring,sigPartS_880: bitstring));
                                        {381}let (=Cli,PartS_881: bitstring) = dec(ePartS_879,skCli) in
                                        {382}if (verify((Cli,PartS_881),sigPartS_880,pkSess_873) <> true) then
                                            0
                                        else
                                            {383}let Kcli_882: bitstring = exp(PartS_881,Nc_877) in
                                            {384}out(c, senc(mCli(pkCli,pkSess_873),Kcli_882))
                            )
                            else
                                {385}let pkDisco_883: bitstring = fail-any in
                                {386}let v_884: bool = (Sess = A) in
                                (
                                    {387}if v_884 then
                                    (
                                        {388}let pkSess_885: bitstring = pub(skA) in
                                        {389}out(c, GetEndpointRequest);
                                        {390}in(c, (SPs_886: bitstring,=SignAndEncrypt,UP_887: bitstring,=pkSess_885));
                                        {391}new SPc_888: bitstring;
                                        {392}new Nc_889: bitstring;
                                        {393}let m1_890: bitstring = (Sess,SPc_888,exp(g,Nc_889)) in
                                        {394}out(c, (pkCli,enc(m1_890,pkSess_885),sign(m1_890,skCli)));
                                        {395}in(c, (ePartS_891: bitstring,sigPartS_892: bitstring));
                                        {396}let (=Cli,PartS_893: bitstring) = dec(ePartS_891,skCli) in
                                        {397}if (verify((Cli,PartS_893),sigPartS_892,pkSess_885) <> true) then
                                            0
                                        else
                                            {398}let Kcli_894: bitstring = exp(PartS_893,Nc_889) in
                                            {399}out(c, senc(mCli(pkCli,pkSess_885),Kcli_894))
                                    )
                                    else
                                        {400}let v_895: bool = (Sess = B) in
                                        (
                                            {401}if v_895 then
                                            (
                                                {402}let pkSess_896: bitstring = pub(skB) in
                                                {403}out(c, GetEndpointRequest);
                                                {404}in(c, (SPs_897: bitstring,=SignAndEncrypt,UP_898: bitstring,=pkSess_896));
                                                {405}new SPc_899: bitstring;
                                                {406}new Nc_900: bitstring;
                                                {407}let m1_901: bitstring = (Sess,SPc_899,exp(g,Nc_900)) in
                                                {408}out(c, (pkCli,enc(m1_901,pkSess_896),sign(m1_901,skCli)));
                                                {409}in(c, (ePartS_902: bitstring,sigPartS_903: bitstring));
                                                {410}let (=Cli,PartS_904: bitstring) = dec(ePartS_902,skCli) in
                                                {411}if (verify((Cli,PartS_904),sigPartS_903,pkSess_896) <> true) then
                                                    0
                                                else
                                                    {412}let Kcli_905: bitstring = exp(PartS_904,Nc_900) in
                                                    {413}out(c, senc(mCli(pkCli,pkSess_896),Kcli_905))
                                            )
                                            else
                                                {414}let v_906: bool = (Sess = C) in
                                                (
                                                    {415}if v_906 then
                                                    (
                                                        {416}let pkSess_907: bitstring = pub(skC) in
                                                        {417}out(c, GetEndpointRequest);
                                                        {418}in(c, (SPs_908: bitstring,=SignAndEncrypt,UP_909: bitstring,=pkSess_907));
                                                        {419}new SPc_910: bitstring;
                                                        {420}new Nc_911: bitstring;
                                                        {421}let m1_912: bitstring = (Sess,SPc_910,exp(g,Nc_911)) in
                                                        {422}out(c, (pkCli,enc(m1_912,pkSess_907),sign(m1_912,skCli)));
                                                        {423}in(c, (ePartS_913: bitstring,sigPartS_914: bitstring));
                                                        {424}let (=Cli,PartS_915: bitstring) = dec(ePartS_913,skCli) in
                                                        {425}if (verify((Cli,PartS_915),sigPartS_914,pkSess_907) <> true) then
                                                            0
                                                        else
                                                            {426}let Kcli_916: bitstring = exp(PartS_915,Nc_911) in
                                                            {427}out(c, senc(mCli(pkCli,pkSess_907),Kcli_916))
                                                    )
                                                    else
                                                        {428}let pkSess_917: bitstring = pub(skI) in
                                                        {429}out(c, GetEndpointRequest);
                                                        {430}in(c, (SPs_918: bitstring,=SignAndEncrypt,UP_919: bitstring,=pkSess_917));
                                                        {431}new SPc_920: bitstring;
                                                        {432}new Nc_921: bitstring;
                                                        {433}let m1_922: bitstring = (Sess,SPc_920,exp(g,Nc_921)) in
                                                        {434}out(c, (pkCli,enc(m1_922,pkSess_917),sign(m1_922,skCli)));
                                                        {435}in(c, (ePartS_923: bitstring,sigPartS_924: bitstring));
                                                        {436}let (=Cli,PartS_925: bitstring) = dec(ePartS_923,skCli) in
                                                        {437}if (verify((Cli,PartS_925),sigPartS_924,pkSess_917) <> true) then
                                                            0
                                                        else
                                                            {438}let Kcli_926: bitstring = exp(PartS_925,Nc_921) in
                                                            {439}out(c, senc(mCli(pkCli,pkSess_917),Kcli_926))
                                                )
                                                else
                                                    {440}let pkSess_927: bitstring = fail-any in
                                                    {441}out(c, GetEndpointRequest);
                                                    {442}in(c, (SPs_928: bitstring,=SignAndEncrypt,UP_929: bitstring,=pkSess_927));
                                                    {443}new SPc_930: bitstring;
                                                    {444}new Nc_931: bitstring;
                                                    {445}let m1_932: bitstring = (Sess,SPc_930,exp(g,Nc_931)) in
                                                    {446}out(c, (pkCli,enc(m1_932,pkSess_927),sign(m1_932,skCli)));
                                                    {447}in(c, (ePartS_933: bitstring,sigPartS_934: bitstring));
                                                    {448}let (=Cli,PartS_935: bitstring) = dec(ePartS_933,skCli) in
                                                    {449}if (verify((Cli,PartS_935),sigPartS_934,pkSess_927) <> true) then
                                                        0
                                                    else
                                                        {450}let Kcli_936: bitstring = exp(PartS_935,Nc_931) in
                                                        {451}out(c, senc(mCli(pkCli,pkSess_927),Kcli_936))
                                        )
                                        else
                                            {452}let pkSess_937: bitstring = fail-any in
                                            {453}out(c, GetEndpointRequest);
                                            {454}in(c, (SPs_938: bitstring,=SignAndEncrypt,UP_939: bitstring,=pkSess_937));
                                            {455}new SPc_940: bitstring;
                                            {456}new Nc_941: bitstring;
                                            {457}let m1_942: bitstring = (Sess,SPc_940,exp(g,Nc_941)) in
                                            {458}out(c, (pkCli,enc(m1_942,pkSess_937),sign(m1_942,skCli)));
                                            {459}in(c, (ePartS_943: bitstring,sigPartS_944: bitstring));
                                            {460}let (=Cli,PartS_945: bitstring) = dec(ePartS_943,skCli) in
                                            {461}if (verify((Cli,PartS_945),sigPartS_944,pkSess_937) <> true) then
                                                0
                                            else
                                                {462}let Kcli_946: bitstring = exp(PartS_945,Nc_941) in
                                                {463}out(c, senc(mCli(pkCli,pkSess_937),Kcli_946))
                                )
                                else
                                    {464}let pkSess_947: bitstring = fail-any in
                                    {465}out(c, GetEndpointRequest);
                                    {466}in(c, (SPs_948: bitstring,=SignAndEncrypt,UP_949: bitstring,=pkSess_947));
                                    {467}new SPc_950: bitstring;
                                    {468}new Nc_951: bitstring;
                                    {469}let m1_952: bitstring = (Sess,SPc_950,exp(g,Nc_951)) in
                                    {470}out(c, (pkCli,enc(m1_952,pkSess_947),sign(m1_952,skCli)));
                                    {471}in(c, (ePartS_953: bitstring,sigPartS_954: bitstring));
                                    {472}let (=Cli,PartS_955: bitstring) = dec(ePartS_953,skCli) in
                                    {473}if (verify((Cli,PartS_955),sigPartS_954,pkSess_947) <> true) then
                                        0
                                    else
                                        {474}let Kcli_956: bitstring = exp(PartS_955,Nc_951) in
                                        {475}out(c, senc(mCli(pkCli,pkSess_947),Kcli_956))
                    )
                    else
                        {476}let pkDisco_957: bitstring = fail-any in
                        {477}let v_958: bool = (Sess = A) in
                        (
                            {478}if v_958 then
                            (
                                {479}let pkSess_959: bitstring = pub(skA) in
                                {480}out(c, GetEndpointRequest);
                                {481}in(c, (SPs_960: bitstring,=SignAndEncrypt,UP_961: bitstring,=pkSess_959));
                                {482}new SPc_962: bitstring;
                                {483}new Nc_963: bitstring;
                                {484}let m1_964: bitstring = (Sess,SPc_962,exp(g,Nc_963)) in
                                {485}out(c, (pkCli,enc(m1_964,pkSess_959),sign(m1_964,skCli)));
                                {486}in(c, (ePartS_965: bitstring,sigPartS_966: bitstring));
                                {487}let (=Cli,PartS_967: bitstring) = dec(ePartS_965,skCli) in
                                {488}if (verify((Cli,PartS_967),sigPartS_966,pkSess_959) <> true) then
                                    0
                                else
                                    {489}let Kcli_968: bitstring = exp(PartS_967,Nc_963) in
                                    {490}out(c, senc(mCli(pkCli,pkSess_959),Kcli_968))
                            )
                            else
                                {491}let v_969: bool = (Sess = B) in
                                (
                                    {492}if v_969 then
                                    (
                                        {493}let pkSess_970: bitstring = pub(skB) in
                                        {494}out(c, GetEndpointRequest);
                                        {495}in(c, (SPs_971: bitstring,=SignAndEncrypt,UP_972: bitstring,=pkSess_970));
                                        {496}new SPc_973: bitstring;
                                        {497}new Nc_974: bitstring;
                                        {498}let m1_975: bitstring = (Sess,SPc_973,exp(g,Nc_974)) in
                                        {499}out(c, (pkCli,enc(m1_975,pkSess_970),sign(m1_975,skCli)));
                                        {500}in(c, (ePartS_976: bitstring,sigPartS_977: bitstring));
                                        {501}let (=Cli,PartS_978: bitstring) = dec(ePartS_976,skCli) in
                                        {502}if (verify((Cli,PartS_978),sigPartS_977,pkSess_970) <> true) then
                                            0
                                        else
                                            {503}let Kcli_979: bitstring = exp(PartS_978,Nc_974) in
                                            {504}out(c, senc(mCli(pkCli,pkSess_970),Kcli_979))
                                    )
                                    else
                                        {505}let v_980: bool = (Sess = C) in
                                        (
                                            {506}if v_980 then
                                            (
                                                {507}let pkSess_981: bitstring = pub(skC) in
                                                {508}out(c, GetEndpointRequest);
                                                {509}in(c, (SPs_982: bitstring,=SignAndEncrypt,UP_983: bitstring,=pkSess_981));
                                                {510}new SPc_984: bitstring;
                                                {511}new Nc_985: bitstring;
                                                {512}let m1_986: bitstring = (Sess,SPc_984,exp(g,Nc_985)) in
                                                {513}out(c, (pkCli,enc(m1_986,pkSess_981),sign(m1_986,skCli)));
                                                {514}in(c, (ePartS_987: bitstring,sigPartS_988: bitstring));
                                                {515}let (=Cli,PartS_989: bitstring) = dec(ePartS_987,skCli) in
                                                {516}if (verify((Cli,PartS_989),sigPartS_988,pkSess_981) <> true) then
                                                    0
                                                else
                                                    {517}let Kcli_990: bitstring = exp(PartS_989,Nc_985) in
                                                    {518}out(c, senc(mCli(pkCli,pkSess_981),Kcli_990))
                                            )
                                            else
                                                {519}let pkSess_991: bitstring = pub(skI) in
                                                {520}out(c, GetEndpointRequest);
                                                {521}in(c, (SPs_992: bitstring,=SignAndEncrypt,UP_993: bitstring,=pkSess_991));
                                                {522}new SPc_994: bitstring;
                                                {523}new Nc_995: bitstring;
                                                {524}let m1_996: bitstring = (Sess,SPc_994,exp(g,Nc_995)) in
                                                {525}out(c, (pkCli,enc(m1_996,pkSess_991),sign(m1_996,skCli)));
                                                {526}in(c, (ePartS_997: bitstring,sigPartS_998: bitstring));
                                                {527}let (=Cli,PartS_999: bitstring) = dec(ePartS_997,skCli) in
                                                {528}if (verify((Cli,PartS_999),sigPartS_998,pkSess_991) <> true) then
                                                    0
                                                else
                                                    {529}let Kcli_1000: bitstring = exp(PartS_999,Nc_995) in
                                                    {530}out(c, senc(mCli(pkCli,pkSess_991),Kcli_1000))
                                        )
                                        else
                                            {531}let pkSess_1001: bitstring = fail-any in
                                            {532}out(c, GetEndpointRequest);
                                            {533}in(c, (SPs_1002: bitstring,=SignAndEncrypt,UP_1003: bitstring,=pkSess_1001));
                                            {534}new SPc_1004: bitstring;
                                            {535}new Nc_1005: bitstring;
                                            {536}let m1_1006: bitstring = (Sess,SPc_1004,exp(g,Nc_1005)) in
                                            {537}out(c, (pkCli,enc(m1_1006,pkSess_1001),sign(m1_1006,skCli)));
                                            {538}in(c, (ePartS_1007: bitstring,sigPartS_1008: bitstring));
                                            {539}let (=Cli,PartS_1009: bitstring) = dec(ePartS_1007,skCli) in
                                            {540}if (verify((Cli,PartS_1009),sigPartS_1008,pkSess_1001) <> true) then
                                                0
                                            else
                                                {541}let Kcli_1010: bitstring = exp(PartS_1009,Nc_1005) in
                                                {542}out(c, senc(mCli(pkCli,pkSess_1001),Kcli_1010))
                                )
                                else
                                    {543}let pkSess_1011: bitstring = fail-any in
                                    {544}out(c, GetEndpointRequest);
                                    {545}in(c, (SPs_1012: bitstring,=SignAndEncrypt,UP_1013: bitstring,=pkSess_1011));
                                    {546}new SPc_1014: bitstring;
                                    {547}new Nc_1015: bitstring;
                                    {548}let m1_1016: bitstring = (Sess,SPc_1014,exp(g,Nc_1015)) in
                                    {549}out(c, (pkCli,enc(m1_1016,pkSess_1011),sign(m1_1016,skCli)));
                                    {550}in(c, (ePartS_1017: bitstring,sigPartS_1018: bitstring));
                                    {551}let (=Cli,PartS_1019: bitstring) = dec(ePartS_1017,skCli) in
                                    {552}if (verify((Cli,PartS_1019),sigPartS_1018,pkSess_1011) <> true) then
                                        0
                                    else
                                        {553}let Kcli_1020: bitstring = exp(PartS_1019,Nc_1015) in
                                        {554}out(c, senc(mCli(pkCli,pkSess_1011),Kcli_1020))
                        )
                        else
                            {555}let pkSess_1021: bitstring = fail-any in
                            {556}out(c, GetEndpointRequest);
                            {557}in(c, (SPs_1022: bitstring,=SignAndEncrypt,UP_1023: bitstring,=pkSess_1021));
                            {558}new SPc_1024: bitstring;
                            {559}new Nc_1025: bitstring;
                            {560}let m1_1026: bitstring = (Sess,SPc_1024,exp(g,Nc_1025)) in
                            {561}out(c, (pkCli,enc(m1_1026,pkSess_1021),sign(m1_1026,skCli)));
                            {562}in(c, (ePartS_1027: bitstring,sigPartS_1028: bitstring));
                            {563}let (=Cli,PartS_1029: bitstring) = dec(ePartS_1027,skCli) in
                            {564}if (verify((Cli,PartS_1029),sigPartS_1028,pkSess_1021) <> true) then
                                0
                            else
                                {565}let Kcli_1030: bitstring = exp(PartS_1029,Nc_1025) in
                                {566}out(c, senc(mCli(pkCli,pkSess_1021),Kcli_1030))
            )
            else
                {567}let pkDisco_1031: bitstring = fail-any in
                {568}let v_1032: bool = (Sess = A) in
                (
                    {569}if v_1032 then
                    (
                        {570}let pkSess_1033: bitstring = pub(skA) in
                        {571}out(c, GetEndpointRequest);
                        {572}in(c, (SPs_1034: bitstring,=SignAndEncrypt,UP_1035: bitstring,=pkSess_1033));
                        {573}new SPc_1036: bitstring;
                        {574}new Nc_1037: bitstring;
                        {575}let m1_1038: bitstring = (Sess,SPc_1036,exp(g,Nc_1037)) in
                        {576}out(c, (pkCli,enc(m1_1038,pkSess_1033),sign(m1_1038,skCli)));
                        {577}in(c, (ePartS_1039: bitstring,sigPartS_1040: bitstring));
                        {578}let (=Cli,PartS_1041: bitstring) = dec(ePartS_1039,skCli) in
                        {579}if (verify((Cli,PartS_1041),sigPartS_1040,pkSess_1033) <> true) then
                            0
                        else
                            {580}let Kcli_1042: bitstring = exp(PartS_1041,Nc_1037) in
                            {581}out(c, senc(mCli(pkCli,pkSess_1033),Kcli_1042))
                    )
                    else
                        {582}let v_1043: bool = (Sess = B) in
                        (
                            {583}if v_1043 then
                            (
                                {584}let pkSess_1044: bitstring = pub(skB) in
                                {585}out(c, GetEndpointRequest);
                                {586}in(c, (SPs_1045: bitstring,=SignAndEncrypt,UP_1046: bitstring,=pkSess_1044));
                                {587}new SPc_1047: bitstring;
                                {588}new Nc_1048: bitstring;
                                {589}let m1_1049: bitstring = (Sess,SPc_1047,exp(g,Nc_1048)) in
                                {590}out(c, (pkCli,enc(m1_1049,pkSess_1044),sign(m1_1049,skCli)));
                                {591}in(c, (ePartS_1050: bitstring,sigPartS_1051: bitstring));
                                {592}let (=Cli,PartS_1052: bitstring) = dec(ePartS_1050,skCli) in
                                {593}if (verify((Cli,PartS_1052),sigPartS_1051,pkSess_1044) <> true) then
                                    0
                                else
                                    {594}let Kcli_1053: bitstring = exp(PartS_1052,Nc_1048) in
                                    {595}out(c, senc(mCli(pkCli,pkSess_1044),Kcli_1053))
                            )
                            else
                                {596}let v_1054: bool = (Sess = C) in
                                (
                                    {597}if v_1054 then
                                    (
                                        {598}let pkSess_1055: bitstring = pub(skC) in
                                        {599}out(c, GetEndpointRequest);
                                        {600}in(c, (SPs_1056: bitstring,=SignAndEncrypt,UP_1057: bitstring,=pkSess_1055));
                                        {601}new SPc_1058: bitstring;
                                        {602}new Nc_1059: bitstring;
                                        {603}let m1_1060: bitstring = (Sess,SPc_1058,exp(g,Nc_1059)) in
                                        {604}out(c, (pkCli,enc(m1_1060,pkSess_1055),sign(m1_1060,skCli)));
                                        {605}in(c, (ePartS_1061: bitstring,sigPartS_1062: bitstring));
                                        {606}let (=Cli,PartS_1063: bitstring) = dec(ePartS_1061,skCli) in
                                        {607}if (verify((Cli,PartS_1063),sigPartS_1062,pkSess_1055) <> true) then
                                            0
                                        else
                                            {608}let Kcli_1064: bitstring = exp(PartS_1063,Nc_1059) in
                                            {609}out(c, senc(mCli(pkCli,pkSess_1055),Kcli_1064))
                                    )
                                    else
                                        {610}let pkSess_1065: bitstring = pub(skI) in
                                        {611}out(c, GetEndpointRequest);
                                        {612}in(c, (SPs_1066: bitstring,=SignAndEncrypt,UP_1067: bitstring,=pkSess_1065));
                                        {613}new SPc_1068: bitstring;
                                        {614}new Nc_1069: bitstring;
                                        {615}let m1_1070: bitstring = (Sess,SPc_1068,exp(g,Nc_1069)) in
                                        {616}out(c, (pkCli,enc(m1_1070,pkSess_1065),sign(m1_1070,skCli)));
                                        {617}in(c, (ePartS_1071: bitstring,sigPartS_1072: bitstring));
                                        {618}let (=Cli,PartS_1073: bitstring) = dec(ePartS_1071,skCli) in
                                        {619}if (verify((Cli,PartS_1073),sigPartS_1072,pkSess_1065) <> true) then
                                            0
                                        else
                                            {620}let Kcli_1074: bitstring = exp(PartS_1073,Nc_1069) in
                                            {621}out(c, senc(mCli(pkCli,pkSess_1065),Kcli_1074))
                                )
                                else
                                    {622}let pkSess_1075: bitstring = fail-any in
                                    {623}out(c, GetEndpointRequest);
                                    {624}in(c, (SPs_1076: bitstring,=SignAndEncrypt,UP_1077: bitstring,=pkSess_1075));
                                    {625}new SPc_1078: bitstring;
                                    {626}new Nc_1079: bitstring;
                                    {627}let m1_1080: bitstring = (Sess,SPc_1078,exp(g,Nc_1079)) in
                                    {628}out(c, (pkCli,enc(m1_1080,pkSess_1075),sign(m1_1080,skCli)));
                                    {629}in(c, (ePartS_1081: bitstring,sigPartS_1082: bitstring));
                                    {630}let (=Cli,PartS_1083: bitstring) = dec(ePartS_1081,skCli) in
                                    {631}if (verify((Cli,PartS_1083),sigPartS_1082,pkSess_1075) <> true) then
                                        0
                                    else
                                        {632}let Kcli_1084: bitstring = exp(PartS_1083,Nc_1079) in
                                        {633}out(c, senc(mCli(pkCli,pkSess_1075),Kcli_1084))
                        )
                        else
                            {634}let pkSess_1085: bitstring = fail-any in
                            {635}out(c, GetEndpointRequest);
                            {636}in(c, (SPs_1086: bitstring,=SignAndEncrypt,UP_1087: bitstring,=pkSess_1085));
                            {637}new SPc_1088: bitstring;
                            {638}new Nc_1089: bitstring;
                            {639}let m1_1090: bitstring = (Sess,SPc_1088,exp(g,Nc_1089)) in
                            {640}out(c, (pkCli,enc(m1_1090,pkSess_1085),sign(m1_1090,skCli)));
                            {641}in(c, (ePartS_1091: bitstring,sigPartS_1092: bitstring));
                            {642}let (=Cli,PartS_1093: bitstring) = dec(ePartS_1091,skCli) in
                            {643}if (verify((Cli,PartS_1093),sigPartS_1092,pkSess_1085) <> true) then
                                0
                            else
                                {644}let Kcli_1094: bitstring = exp(PartS_1093,Nc_1089) in
                                {645}out(c, senc(mCli(pkCli,pkSess_1085),Kcli_1094))
                )
                else
                    {646}let pkSess_1095: bitstring = fail-any in
                    {647}out(c, GetEndpointRequest);
                    {648}in(c, (SPs_1096: bitstring,=SignAndEncrypt,UP_1097: bitstring,=pkSess_1095));
                    {649}new SPc_1098: bitstring;
                    {650}new Nc_1099: bitstring;
                    {651}let m1_1100: bitstring = (Sess,SPc_1098,exp(g,Nc_1099)) in
                    {652}out(c, (pkCli,enc(m1_1100,pkSess_1095),sign(m1_1100,skCli)));
                    {653}in(c, (ePartS_1101: bitstring,sigPartS_1102: bitstring));
                    {654}let (=Cli,PartS_1103: bitstring) = dec(ePartS_1101,skCli) in
                    {655}if (verify((Cli,PartS_1103),sigPartS_1102,pkSess_1095) <> true) then
                        0
                    else
                        {656}let Kcli_1104: bitstring = exp(PartS_1103,Nc_1099) in
                        {657}out(c, senc(mCli(pkCli,pkSess_1095),Kcli_1104))
        )
        else
            {658}let v_1105: bool = (Cli = B) in
            (
                {659}if v_1105 then
                (
                    {660}let skCli_1106: bitstring = skB in
                    {661}let pkCli_1107: bitstring = pub(skCli_1106) in
                    {662}let v_1108: bool = (Disco = A) in
                    (
                        {663}if v_1108 then
                        (
                            {664}let pkDisco_1109: bitstring = pub(skA) in
                            {665}let v_1110: bool = (Sess = A) in
                            (
                                {666}if v_1110 then
                                (
                                    {667}let pkSess_1111: bitstring = pub(skA) in
                                    {668}out(c, GetEndpointRequest);
                                    {669}in(c, (SPs_1112: bitstring,=SignAndEncrypt,UP_1113: bitstring,=pkSess_1111));
                                    {670}new SPc_1114: bitstring;
                                    {671}new Nc_1115: bitstring;
                                    {672}let m1_1116: bitstring = (Sess,SPc_1114,exp(g,Nc_1115)) in
                                    {673}out(c, (pkCli_1107,enc(m1_1116,pkSess_1111),sign(m1_1116,skCli_1106)));
                                    {674}in(c, (ePartS_1117: bitstring,sigPartS_1118: bitstring));
                                    {675}let (=Cli,PartS_1119: bitstring) = dec(ePartS_1117,skCli_1106) in
                                    {676}if (verify((Cli,PartS_1119),sigPartS_1118,pkSess_1111) <> true) then
                                        0
                                    else
                                        {677}let Kcli_1120: bitstring = exp(PartS_1119,Nc_1115) in
                                        {678}out(c, senc(mCli(pkCli_1107,pkSess_1111),Kcli_1120))
                                )
                                else
                                    {679}let v_1121: bool = (Sess = B) in
                                    (
                                        {680}if v_1121 then
                                        (
                                            {681}let pkSess_1122: bitstring = pub(skB) in
                                            {682}out(c, GetEndpointRequest);
                                            {683}in(c, (SPs_1123: bitstring,=SignAndEncrypt,UP_1124: bitstring,=pkSess_1122));
                                            {684}new SPc_1125: bitstring;
                                            {685}new Nc_1126: bitstring;
                                            {686}let m1_1127: bitstring = (Sess,SPc_1125,exp(g,Nc_1126)) in
                                            {687}out(c, (pkCli_1107,enc(m1_1127,pkSess_1122),sign(m1_1127,skCli_1106)));
                                            {688}in(c, (ePartS_1128: bitstring,sigPartS_1129: bitstring));
                                            {689}let (=Cli,PartS_1130: bitstring) = dec(ePartS_1128,skCli_1106) in
                                            {690}if (verify((Cli,PartS_1130),sigPartS_1129,pkSess_1122) <> true) then
                                                0
                                            else
                                                {691}let Kcli_1131: bitstring = exp(PartS_1130,Nc_1126) in
                                                {692}out(c, senc(mCli(pkCli_1107,pkSess_1122),Kcli_1131))
                                        )
                                        else
                                            {693}let v_1132: bool = (Sess = C) in
                                            (
                                                {694}if v_1132 then
                                                (
                                                    {695}let pkSess_1133: bitstring = pub(skC) in
                                                    {696}out(c, GetEndpointRequest);
                                                    {697}in(c, (SPs_1134: bitstring,=SignAndEncrypt,UP_1135: bitstring,=pkSess_1133));
                                                    {698}new SPc_1136: bitstring;
                                                    {699}new Nc_1137: bitstring;
                                                    {700}let m1_1138: bitstring = (Sess,SPc_1136,exp(g,Nc_1137)) in
                                                    {701}out(c, (pkCli_1107,enc(m1_1138,pkSess_1133),sign(m1_1138,skCli_1106)));
                                                    {702}in(c, (ePartS_1139: bitstring,sigPartS_1140: bitstring));
                                                    {703}let (=Cli,PartS_1141: bitstring) = dec(ePartS_1139,skCli_1106) in
                                                    {704}if (verify((Cli,PartS_1141),sigPartS_1140,pkSess_1133) <> true) then
                                                        0
                                                    else
                                                        {705}let Kcli_1142: bitstring = exp(PartS_1141,Nc_1137) in
                                                        {706}out(c, senc(mCli(pkCli_1107,pkSess_1133),Kcli_1142))
                                                )
                                                else
                                                    {707}let pkSess_1143: bitstring = pub(skI) in
                                                    {708}out(c, GetEndpointRequest);
                                                    {709}in(c, (SPs_1144: bitstring,=SignAndEncrypt,UP_1145: bitstring,=pkSess_1143));
                                                    {710}new SPc_1146: bitstring;
                                                    {711}new Nc_1147: bitstring;
                                                    {712}let m1_1148: bitstring = (Sess,SPc_1146,exp(g,Nc_1147)) in
                                                    {713}out(c, (pkCli_1107,enc(m1_1148,pkSess_1143),sign(m1_1148,skCli_1106)));
                                                    {714}in(c, (ePartS_1149: bitstring,sigPartS_1150: bitstring));
                                                    {715}let (=Cli,PartS_1151: bitstring) = dec(ePartS_1149,skCli_1106) in
                                                    {716}if (verify((Cli,PartS_1151),sigPartS_1150,pkSess_1143) <> true) then
                                                        0
                                                    else
                                                        {717}let Kcli_1152: bitstring = exp(PartS_1151,Nc_1147) in
                                                        {718}out(c, senc(mCli(pkCli_1107,pkSess_1143),Kcli_1152))
                                            )
                                            else
                                                {719}let pkSess_1153: bitstring = fail-any in
                                                {720}out(c, GetEndpointRequest);
                                                {721}in(c, (SPs_1154: bitstring,=SignAndEncrypt,UP_1155: bitstring,=pkSess_1153));
                                                {722}new SPc_1156: bitstring;
                                                {723}new Nc_1157: bitstring;
                                                {724}let m1_1158: bitstring = (Sess,SPc_1156,exp(g,Nc_1157)) in
                                                {725}out(c, (pkCli_1107,enc(m1_1158,pkSess_1153),sign(m1_1158,skCli_1106)));
                                                {726}in(c, (ePartS_1159: bitstring,sigPartS_1160: bitstring));
                                                {727}let (=Cli,PartS_1161: bitstring) = dec(ePartS_1159,skCli_1106) in
                                                {728}if (verify((Cli,PartS_1161),sigPartS_1160,pkSess_1153) <> true) then
                                                    0
                                                else
                                                    {729}let Kcli_1162: bitstring = exp(PartS_1161,Nc_1157) in
                                                    {730}out(c, senc(mCli(pkCli_1107,pkSess_1153),Kcli_1162))
                                    )
                                    else
                                        {731}let pkSess_1163: bitstring = fail-any in
                                        {732}out(c, GetEndpointRequest);
                                        {733}in(c, (SPs_1164: bitstring,=SignAndEncrypt,UP_1165: bitstring,=pkSess_1163));
                                        {734}new SPc_1166: bitstring;
                                        {735}new Nc_1167: bitstring;
                                        {736}let m1_1168: bitstring = (Sess,SPc_1166,exp(g,Nc_1167)) in
                                        {737}out(c, (pkCli_1107,enc(m1_1168,pkSess_1163),sign(m1_1168,skCli_1106)));
                                        {738}in(c, (ePartS_1169: bitstring,sigPartS_1170: bitstring));
                                        {739}let (=Cli,PartS_1171: bitstring) = dec(ePartS_1169,skCli_1106) in
                                        {740}if (verify((Cli,PartS_1171),sigPartS_1170,pkSess_1163) <> true) then
                                            0
                                        else
                                            {741}let Kcli_1172: bitstring = exp(PartS_1171,Nc_1167) in
                                            {742}out(c, senc(mCli(pkCli_1107,pkSess_1163),Kcli_1172))
                            )
                            else
                                {743}let pkSess_1173: bitstring = fail-any in
                                {744}out(c, GetEndpointRequest);
                                {745}in(c, (SPs_1174: bitstring,=SignAndEncrypt,UP_1175: bitstring,=pkSess_1173));
                                {746}new SPc_1176: bitstring;
                                {747}new Nc_1177: bitstring;
                                {748}let m1_1178: bitstring = (Sess,SPc_1176,exp(g,Nc_1177)) in
                                {749}out(c, (pkCli_1107,enc(m1_1178,pkSess_1173),sign(m1_1178,skCli_1106)));
                                {750}in(c, (ePartS_1179: bitstring,sigPartS_1180: bitstring));
                                {751}let (=Cli,PartS_1181: bitstring) = dec(ePartS_1179,skCli_1106) in
                                {752}if (verify((Cli,PartS_1181),sigPartS_1180,pkSess_1173) <> true) then
                                    0
                                else
                                    {753}let Kcli_1182: bitstring = exp(PartS_1181,Nc_1177) in
                                    {754}out(c, senc(mCli(pkCli_1107,pkSess_1173),Kcli_1182))
                        )
                        else
                            {755}let v_1183: bool = (Disco = B) in
                            (
                                {756}if v_1183 then
                                (
                                    {757}let pkDisco_1184: bitstring = pub(skB) in
                                    {758}let v_1185: bool = (Sess = A) in
                                    (
                                        {759}if v_1185 then
                                        (
                                            {760}let pkSess_1186: bitstring = pub(skA) in
                                            {761}out(c, GetEndpointRequest);
                                            {762}in(c, (SPs_1187: bitstring,=SignAndEncrypt,UP_1188: bitstring,=pkSess_1186));
                                            {763}new SPc_1189: bitstring;
                                            {764}new Nc_1190: bitstring;
                                            {765}let m1_1191: bitstring = (Sess,SPc_1189,exp(g,Nc_1190)) in
                                            {766}out(c, (pkCli_1107,enc(m1_1191,pkSess_1186),sign(m1_1191,skCli_1106)));
                                            {767}in(c, (ePartS_1192: bitstring,sigPartS_1193: bitstring));
                                            {768}let (=Cli,PartS_1194: bitstring) = dec(ePartS_1192,skCli_1106) in
                                            {769}if (verify((Cli,PartS_1194),sigPartS_1193,pkSess_1186) <> true) then
                                                0
                                            else
                                                {770}let Kcli_1195: bitstring = exp(PartS_1194,Nc_1190) in
                                                {771}out(c, senc(mCli(pkCli_1107,pkSess_1186),Kcli_1195))
                                        )
                                        else
                                            {772}let v_1196: bool = (Sess = B) in
                                            (
                                                {773}if v_1196 then
                                                (
                                                    {774}let pkSess_1197: bitstring = pub(skB) in
                                                    {775}out(c, GetEndpointRequest);
                                                    {776}in(c, (SPs_1198: bitstring,=SignAndEncrypt,UP_1199: bitstring,=pkSess_1197));
                                                    {777}new SPc_1200: bitstring;
                                                    {778}new Nc_1201: bitstring;
                                                    {779}let m1_1202: bitstring = (Sess,SPc_1200,exp(g,Nc_1201)) in
                                                    {780}out(c, (pkCli_1107,enc(m1_1202,pkSess_1197),sign(m1_1202,skCli_1106)));
                                                    {781}in(c, (ePartS_1203: bitstring,sigPartS_1204: bitstring));
                                                    {782}let (=Cli,PartS_1205: bitstring) = dec(ePartS_1203,skCli_1106) in
                                                    {783}if (verify((Cli,PartS_1205),sigPartS_1204,pkSess_1197) <> true) then
                                                        0
                                                    else
                                                        {784}let Kcli_1206: bitstring = exp(PartS_1205,Nc_1201) in
                                                        {785}out(c, senc(mCli(pkCli_1107,pkSess_1197),Kcli_1206))
                                                )
                                                else
                                                    {786}let v_1207: bool = (Sess = C) in
                                                    (
                                                        {787}if v_1207 then
                                                        (
                                                            {788}let pkSess_1208: bitstring = pub(skC) in
                                                            {789}out(c, GetEndpointRequest);
                                                            {790}in(c, (SPs_1209: bitstring,=SignAndEncrypt,UP_1210: bitstring,=pkSess_1208));
                                                            {791}new SPc_1211: bitstring;
                                                            {792}new Nc_1212: bitstring;
                                                            {793}let m1_1213: bitstring = (Sess,SPc_1211,exp(g,Nc_1212)) in
                                                            {794}out(c, (pkCli_1107,enc(m1_1213,pkSess_1208),sign(m1_1213,skCli_1106)));
                                                            {795}in(c, (ePartS_1214: bitstring,sigPartS_1215: bitstring));
                                                            {796}let (=Cli,PartS_1216: bitstring) = dec(ePartS_1214,skCli_1106) in
                                                            {797}if (verify((Cli,PartS_1216),sigPartS_1215,pkSess_1208) <> true) then
                                                                0
                                                            else
                                                                {798}let Kcli_1217: bitstring = exp(PartS_1216,Nc_1212) in
                                                                {799}out(c, senc(mCli(pkCli_1107,pkSess_1208),Kcli_1217))
                                                        )
                                                        else
                                                            {800}let pkSess_1218: bitstring = pub(skI) in
                                                            {801}out(c, GetEndpointRequest);
                                                            {802}in(c, (SPs_1219: bitstring,=SignAndEncrypt,UP_1220: bitstring,=pkSess_1218));
                                                            {803}new SPc_1221: bitstring;
                                                            {804}new Nc_1222: bitstring;
                                                            {805}let m1_1223: bitstring = (Sess,SPc_1221,exp(g,Nc_1222)) in
                                                            {806}out(c, (pkCli_1107,enc(m1_1223,pkSess_1218),sign(m1_1223,skCli_1106)));
                                                            {807}in(c, (ePartS_1224: bitstring,sigPartS_1225: bitstring));
                                                            {808}let (=Cli,PartS_1226: bitstring) = dec(ePartS_1224,skCli_1106) in
                                                            {809}if (verify((Cli,PartS_1226),sigPartS_1225,pkSess_1218) <> true) then
                                                                0
                                                            else
                                                                {810}let Kcli_1227: bitstring = exp(PartS_1226,Nc_1222) in
                                                                {811}out(c, senc(mCli(pkCli_1107,pkSess_1218),Kcli_1227))
                                                    )
                                                    else
                                                        {812}let pkSess_1228: bitstring = fail-any in
                                                        {813}out(c, GetEndpointRequest);
                                                        {814}in(c, (SPs_1229: bitstring,=SignAndEncrypt,UP_1230: bitstring,=pkSess_1228));
                                                        {815}new SPc_1231: bitstring;
                                                        {816}new Nc_1232: bitstring;
                                                        {817}let m1_1233: bitstring = (Sess,SPc_1231,exp(g,Nc_1232)) in
                                                        {818}out(c, (pkCli_1107,enc(m1_1233,pkSess_1228),sign(m1_1233,skCli_1106)));
                                                        {819}in(c, (ePartS_1234: bitstring,sigPartS_1235: bitstring));
                                                        {820}let (=Cli,PartS_1236: bitstring) = dec(ePartS_1234,skCli_1106) in
                                                        {821}if (verify((Cli,PartS_1236),sigPartS_1235,pkSess_1228) <> true) then
                                                            0
                                                        else
                                                            {822}let Kcli_1237: bitstring = exp(PartS_1236,Nc_1232) in
                                                            {823}out(c, senc(mCli(pkCli_1107,pkSess_1228),Kcli_1237))
                                            )
                                            else
                                                {824}let pkSess_1238: bitstring = fail-any in
                                                {825}out(c, GetEndpointRequest);
                                                {826}in(c, (SPs_1239: bitstring,=SignAndEncrypt,UP_1240: bitstring,=pkSess_1238));
                                                {827}new SPc_1241: bitstring;
                                                {828}new Nc_1242: bitstring;
                                                {829}let m1_1243: bitstring = (Sess,SPc_1241,exp(g,Nc_1242)) in
                                                {830}out(c, (pkCli_1107,enc(m1_1243,pkSess_1238),sign(m1_1243,skCli_1106)));
                                                {831}in(c, (ePartS_1244: bitstring,sigPartS_1245: bitstring));
                                                {832}let (=Cli,PartS_1246: bitstring) = dec(ePartS_1244,skCli_1106) in
                                                {833}if (verify((Cli,PartS_1246),sigPartS_1245,pkSess_1238) <> true) then
                                                    0
                                                else
                                                    {834}let Kcli_1247: bitstring = exp(PartS_1246,Nc_1242) in
                                                    {835}out(c, senc(mCli(pkCli_1107,pkSess_1238),Kcli_1247))
                                    )
                                    else
                                        {836}let pkSess_1248: bitstring = fail-any in
                                        {837}out(c, GetEndpointRequest);
                                        {838}in(c, (SPs_1249: bitstring,=SignAndEncrypt,UP_1250: bitstring,=pkSess_1248));
                                        {839}new SPc_1251: bitstring;
                                        {840}new Nc_1252: bitstring;
                                        {841}let m1_1253: bitstring = (Sess,SPc_1251,exp(g,Nc_1252)) in
                                        {842}out(c, (pkCli_1107,enc(m1_1253,pkSess_1248),sign(m1_1253,skCli_1106)));
                                        {843}in(c, (ePartS_1254: bitstring,sigPartS_1255: bitstring));
                                        {844}let (=Cli,PartS_1256: bitstring) = dec(ePartS_1254,skCli_1106) in
                                        {845}if (verify((Cli,PartS_1256),sigPartS_1255,pkSess_1248) <> true) then
                                            0
                                        else
                                            {846}let Kcli_1257: bitstring = exp(PartS_1256,Nc_1252) in
                                            {847}out(c, senc(mCli(pkCli_1107,pkSess_1248),Kcli_1257))
                                )
                                else
                                    {848}let v_1258: bool = (Disco = C) in
                                    (
                                        {849}if v_1258 then
                                        (
                                            {850}let pkDisco_1259: bitstring = pub(skC) in
                                            {851}let v_1260: bool = (Sess = A) in
                                            (
                                                {852}if v_1260 then
                                                (
                                                    {853}let pkSess_1261: bitstring = pub(skA) in
                                                    {854}out(c, GetEndpointRequest);
                                                    {855}in(c, (SPs_1262: bitstring,=SignAndEncrypt,UP_1263: bitstring,=pkSess_1261));
                                                    {856}new SPc_1264: bitstring;
                                                    {857}new Nc_1265: bitstring;
                                                    {858}let m1_1266: bitstring = (Sess,SPc_1264,exp(g,Nc_1265)) in
                                                    {859}out(c, (pkCli_1107,enc(m1_1266,pkSess_1261),sign(m1_1266,skCli_1106)));
                                                    {860}in(c, (ePartS_1267: bitstring,sigPartS_1268: bitstring));
                                                    {861}let (=Cli,PartS_1269: bitstring) = dec(ePartS_1267,skCli_1106) in
                                                    {862}if (verify((Cli,PartS_1269),sigPartS_1268,pkSess_1261) <> true) then
                                                        0
                                                    else
                                                        {863}let Kcli_1270: bitstring = exp(PartS_1269,Nc_1265) in
                                                        {864}out(c, senc(mCli(pkCli_1107,pkSess_1261),Kcli_1270))
                                                )
                                                else
                                                    {865}let v_1271: bool = (Sess = B) in
                                                    (
                                                        {866}if v_1271 then
                                                        (
                                                            {867}let pkSess_1272: bitstring = pub(skB) in
                                                            {868}out(c, GetEndpointRequest);
                                                            {869}in(c, (SPs_1273: bitstring,=SignAndEncrypt,UP_1274: bitstring,=pkSess_1272));
                                                            {870}new SPc_1275: bitstring;
                                                            {871}new Nc_1276: bitstring;
                                                            {872}let m1_1277: bitstring = (Sess,SPc_1275,exp(g,Nc_1276)) in
                                                            {873}out(c, (pkCli_1107,enc(m1_1277,pkSess_1272),sign(m1_1277,skCli_1106)));
                                                            {874}in(c, (ePartS_1278: bitstring,sigPartS_1279: bitstring));
                                                            {875}let (=Cli,PartS_1280: bitstring) = dec(ePartS_1278,skCli_1106) in
                                                            {876}if (verify((Cli,PartS_1280),sigPartS_1279,pkSess_1272) <> true) then
                                                                0
                                                            else
                                                                {877}let Kcli_1281: bitstring = exp(PartS_1280,Nc_1276) in
                                                                {878}out(c, senc(mCli(pkCli_1107,pkSess_1272),Kcli_1281))
                                                        )
                                                        else
                                                            {879}let v_1282: bool = (Sess = C) in
                                                            (
                                                                {880}if v_1282 then
                                                                (
                                                                    {881}let pkSess_1283: bitstring = pub(skC) in
                                                                    {882}out(c, GetEndpointRequest);
                                                                    {883}in(c, (SPs_1284: bitstring,=SignAndEncrypt,UP_1285: bitstring,=pkSess_1283));
                                                                    {884}new SPc_1286: bitstring;
                                                                    {885}new Nc_1287: bitstring;
                                                                    {886}let m1_1288: bitstring = (Sess,SPc_1286,exp(g,Nc_1287)) in
                                                                    {887}out(c, (pkCli_1107,enc(m1_1288,pkSess_1283),sign(m1_1288,skCli_1106)));
                                                                    {888}in(c, (ePartS_1289: bitstring,sigPartS_1290: bitstring));
                                                                    {889}let (=Cli,PartS_1291: bitstring) = dec(ePartS_1289,skCli_1106) in
                                                                    {890}if (verify((Cli,PartS_1291),sigPartS_1290,pkSess_1283) <> true) then
                                                                        0
                                                                    else
                                                                        {891}let Kcli_1292: bitstring = exp(PartS_1291,Nc_1287) in
                                                                        {892}out(c, senc(mCli(pkCli_1107,pkSess_1283),Kcli_1292))
                                                                )
                                                                else
                                                                    {893}let pkSess_1293: bitstring = pub(skI) in
                                                                    {894}out(c, GetEndpointRequest);
                                                                    {895}in(c, (SPs_1294: bitstring,=SignAndEncrypt,UP_1295: bitstring,=pkSess_1293));
                                                                    {896}new SPc_1296: bitstring;
                                                                    {897}new Nc_1297: bitstring;
                                                                    {898}let m1_1298: bitstring = (Sess,SPc_1296,exp(g,Nc_1297)) in
                                                                    {899}out(c, (pkCli_1107,enc(m1_1298,pkSess_1293),sign(m1_1298,skCli_1106)));
                                                                    {900}in(c, (ePartS_1299: bitstring,sigPartS_1300: bitstring));
                                                                    {901}let (=Cli,PartS_1301: bitstring) = dec(ePartS_1299,skCli_1106) in
                                                                    {902}if (verify((Cli,PartS_1301),sigPartS_1300,pkSess_1293) <> true) then
                                                                        0
                                                                    else
                                                                        {903}let Kcli_1302: bitstring = exp(PartS_1301,Nc_1297) in
                                                                        {904}out(c, senc(mCli(pkCli_1107,pkSess_1293),Kcli_1302))
                                                            )
                                                            else
                                                                {905}let pkSess_1303: bitstring = fail-any in
                                                                {906}out(c, GetEndpointRequest);
                                                                {907}in(c, (SPs_1304: bitstring,=SignAndEncrypt,UP_1305: bitstring,=pkSess_1303));
                                                                {908}new SPc_1306: bitstring;
                                                                {909}new Nc_1307: bitstring;
                                                                {910}let m1_1308: bitstring = (Sess,SPc_1306,exp(g,Nc_1307)) in
                                                                {911}out(c, (pkCli_1107,enc(m1_1308,pkSess_1303),sign(m1_1308,skCli_1106)));
                                                                {912}in(c, (ePartS_1309: bitstring,sigPartS_1310: bitstring));
                                                                {913}let (=Cli,PartS_1311: bitstring) = dec(ePartS_1309,skCli_1106) in
                                                                {914}if (verify((Cli,PartS_1311),sigPartS_1310,pkSess_1303) <> true) then
                                                                    0
                                                                else
                                                                    {915}let Kcli_1312: bitstring = exp(PartS_1311,Nc_1307) in
                                                                    {916}out(c, senc(mCli(pkCli_1107,pkSess_1303),Kcli_1312))
                                                    )
                                                    else
                                                        {917}let pkSess_1313: bitstring = fail-any in
                                                        {918}out(c, GetEndpointRequest);
                                                        {919}in(c, (SPs_1314: bitstring,=SignAndEncrypt,UP_1315: bitstring,=pkSess_1313));
                                                        {920}new SPc_1316: bitstring;
                                                        {921}new Nc_1317: bitstring;
                                                        {922}let m1_1318: bitstring = (Sess,SPc_1316,exp(g,Nc_1317)) in
                                                        {923}out(c, (pkCli_1107,enc(m1_1318,pkSess_1313),sign(m1_1318,skCli_1106)));
                                                        {924}in(c, (ePartS_1319: bitstring,sigPartS_1320: bitstring));
                                                        {925}let (=Cli,PartS_1321: bitstring) = dec(ePartS_1319,skCli_1106) in
                                                        {926}if (verify((Cli,PartS_1321),sigPartS_1320,pkSess_1313) <> true) then
                                                            0
                                                        else
                                                            {927}let Kcli_1322: bitstring = exp(PartS_1321,Nc_1317) in
                                                            {928}out(c, senc(mCli(pkCli_1107,pkSess_1313),Kcli_1322))
                                            )
                                            else
                                                {929}let pkSess_1323: bitstring = fail-any in
                                                {930}out(c, GetEndpointRequest);
                                                {931}in(c, (SPs_1324: bitstring,=SignAndEncrypt,UP_1325: bitstring,=pkSess_1323));
                                                {932}new SPc_1326: bitstring;
                                                {933}new Nc_1327: bitstring;
                                                {934}let m1_1328: bitstring = (Sess,SPc_1326,exp(g,Nc_1327)) in
                                                {935}out(c, (pkCli_1107,enc(m1_1328,pkSess_1323),sign(m1_1328,skCli_1106)));
                                                {936}in(c, (ePartS_1329: bitstring,sigPartS_1330: bitstring));
                                                {937}let (=Cli,PartS_1331: bitstring) = dec(ePartS_1329,skCli_1106) in
                                                {938}if (verify((Cli,PartS_1331),sigPartS_1330,pkSess_1323) <> true) then
                                                    0
                                                else
                                                    {939}let Kcli_1332: bitstring = exp(PartS_1331,Nc_1327) in
                                                    {940}out(c, senc(mCli(pkCli_1107,pkSess_1323),Kcli_1332))
                                        )
                                        else
                                            {941}let pkDisco_1333: bitstring = pub(skI) in
                                            {942}let v_1334: bool = (Sess = A) in
                                            (
                                                {943}if v_1334 then
                                                (
                                                    {944}let pkSess_1335: bitstring = pub(skA) in
                                                    {945}out(c, GetEndpointRequest);
                                                    {946}in(c, (SPs_1336: bitstring,=SignAndEncrypt,UP_1337: bitstring,=pkSess_1335));
                                                    {947}new SPc_1338: bitstring;
                                                    {948}new Nc_1339: bitstring;
                                                    {949}let m1_1340: bitstring = (Sess,SPc_1338,exp(g,Nc_1339)) in
                                                    {950}out(c, (pkCli_1107,enc(m1_1340,pkSess_1335),sign(m1_1340,skCli_1106)));
                                                    {951}in(c, (ePartS_1341: bitstring,sigPartS_1342: bitstring));
                                                    {952}let (=Cli,PartS_1343: bitstring) = dec(ePartS_1341,skCli_1106) in
                                                    {953}if (verify((Cli,PartS_1343),sigPartS_1342,pkSess_1335) <> true) then
                                                        0
                                                    else
                                                        {954}let Kcli_1344: bitstring = exp(PartS_1343,Nc_1339) in
                                                        {955}out(c, senc(mCli(pkCli_1107,pkSess_1335),Kcli_1344))
                                                )
                                                else
                                                    {956}let v_1345: bool = (Sess = B) in
                                                    (
                                                        {957}if v_1345 then
                                                        (
                                                            {958}let pkSess_1346: bitstring = pub(skB) in
                                                            {959}out(c, GetEndpointRequest);
                                                            {960}in(c, (SPs_1347: bitstring,=SignAndEncrypt,UP_1348: bitstring,=pkSess_1346));
                                                            {961}new SPc_1349: bitstring;
                                                            {962}new Nc_1350: bitstring;
                                                            {963}let m1_1351: bitstring = (Sess,SPc_1349,exp(g,Nc_1350)) in
                                                            {964}out(c, (pkCli_1107,enc(m1_1351,pkSess_1346),sign(m1_1351,skCli_1106)));
                                                            {965}in(c, (ePartS_1352: bitstring,sigPartS_1353: bitstring));
                                                            {966}let (=Cli,PartS_1354: bitstring) = dec(ePartS_1352,skCli_1106) in
                                                            {967}if (verify((Cli,PartS_1354),sigPartS_1353,pkSess_1346) <> true) then
                                                                0
                                                            else
                                                                {968}let Kcli_1355: bitstring = exp(PartS_1354,Nc_1350) in
                                                                {969}out(c, senc(mCli(pkCli_1107,pkSess_1346),Kcli_1355))
                                                        )
                                                        else
                                                            {970}let v_1356: bool = (Sess = C) in
                                                            (
                                                                {971}if v_1356 then
                                                                (
                                                                    {972}let pkSess_1357: bitstring = pub(skC) in
                                                                    {973}out(c, GetEndpointRequest);
                                                                    {974}in(c, (SPs_1358: bitstring,=SignAndEncrypt,UP_1359: bitstring,=pkSess_1357));
                                                                    {975}new SPc_1360: bitstring;
                                                                    {976}new Nc_1361: bitstring;
                                                                    {977}let m1_1362: bitstring = (Sess,SPc_1360,exp(g,Nc_1361)) in
                                                                    {978}out(c, (pkCli_1107,enc(m1_1362,pkSess_1357),sign(m1_1362,skCli_1106)));
                                                                    {979}in(c, (ePartS_1363: bitstring,sigPartS_1364: bitstring));
                                                                    {980}let (=Cli,PartS_1365: bitstring) = dec(ePartS_1363,skCli_1106) in
                                                                    {981}if (verify((Cli,PartS_1365),sigPartS_1364,pkSess_1357) <> true) then
                                                                        0
                                                                    else
                                                                        {982}let Kcli_1366: bitstring = exp(PartS_1365,Nc_1361) in
                                                                        {983}out(c, senc(mCli(pkCli_1107,pkSess_1357),Kcli_1366))
                                                                )
                                                                else
                                                                    {984}let pkSess_1367: bitstring = pub(skI) in
                                                                    {985}out(c, GetEndpointRequest);
                                                                    {986}in(c, (SPs_1368: bitstring,=SignAndEncrypt,UP_1369: bitstring,=pkSess_1367));
                                                                    {987}new SPc_1370: bitstring;
                                                                    {988}new Nc_1371: bitstring;
                                                                    {989}let m1_1372: bitstring = (Sess,SPc_1370,exp(g,Nc_1371)) in
                                                                    {990}out(c, (pkCli_1107,enc(m1_1372,pkSess_1367),sign(m1_1372,skCli_1106)));
                                                                    {991}in(c, (ePartS_1373: bitstring,sigPartS_1374: bitstring));
                                                                    {992}let (=Cli,PartS_1375: bitstring) = dec(ePartS_1373,skCli_1106) in
                                                                    {993}if (verify((Cli,PartS_1375),sigPartS_1374,pkSess_1367) <> true) then
                                                                        0
                                                                    else
                                                                        {994}let Kcli_1376: bitstring = exp(PartS_1375,Nc_1371) in
                                                                        {995}out(c, senc(mCli(pkCli_1107,pkSess_1367),Kcli_1376))
                                                            )
                                                            else
                                                                {996}let pkSess_1377: bitstring = fail-any in
                                                                {997}out(c, GetEndpointRequest);
                                                                {998}in(c, (SPs_1378: bitstring,=SignAndEncrypt,UP_1379: bitstring,=pkSess_1377));
                                                                {999}new SPc_1380: bitstring;
                                                                {1000}new Nc_1381: bitstring;
                                                                {1001}let m1_1382: bitstring = (Sess,SPc_1380,exp(g,Nc_1381)) in
                                                                {1002}out(c, (pkCli_1107,enc(m1_1382,pkSess_1377),sign(m1_1382,skCli_1106)));
                                                                {1003}in(c, (ePartS_1383: bitstring,sigPartS_1384: bitstring));
                                                                {1004}let (=Cli,PartS_1385: bitstring) = dec(ePartS_1383,skCli_1106) in
                                                                {1005}if (verify((Cli,PartS_1385),sigPartS_1384,pkSess_1377) <> true) then
                                                                    0
                                                                else
                                                                    {1006}let Kcli_1386: bitstring = exp(PartS_1385,Nc_1381) in
                                                                    {1007}out(c, senc(mCli(pkCli_1107,pkSess_1377),Kcli_1386))
                                                    )
                                                    else
                                                        {1008}let pkSess_1387: bitstring = fail-any in
                                                        {1009}out(c, GetEndpointRequest);
                                                        {1010}in(c, (SPs_1388: bitstring,=SignAndEncrypt,UP_1389: bitstring,=pkSess_1387));
                                                        {1011}new SPc_1390: bitstring;
                                                        {1012}new Nc_1391: bitstring;
                                                        {1013}let m1_1392: bitstring = (Sess,SPc_1390,exp(g,Nc_1391)) in
                                                        {1014}out(c, (pkCli_1107,enc(m1_1392,pkSess_1387),sign(m1_1392,skCli_1106)));
                                                        {1015}in(c, (ePartS_1393: bitstring,sigPartS_1394: bitstring));
                                                        {1016}let (=Cli,PartS_1395: bitstring) = dec(ePartS_1393,skCli_1106) in
                                                        {1017}if (verify((Cli,PartS_1395),sigPartS_1394,pkSess_1387) <> true) then
                                                            0
                                                        else
                                                            {1018}let Kcli_1396: bitstring = exp(PartS_1395,Nc_1391) in
                                                            {1019}out(c, senc(mCli(pkCli_1107,pkSess_1387),Kcli_1396))
                                            )
                                            else
                                                {1020}let pkSess_1397: bitstring = fail-any in
                                                {1021}out(c, GetEndpointRequest);
                                                {1022}in(c, (SPs_1398: bitstring,=SignAndEncrypt,UP_1399: bitstring,=pkSess_1397));
                                                {1023}new SPc_1400: bitstring;
                                                {1024}new Nc_1401: bitstring;
                                                {1025}let m1_1402: bitstring = (Sess,SPc_1400,exp(g,Nc_1401)) in
                                                {1026}out(c, (pkCli_1107,enc(m1_1402,pkSess_1397),sign(m1_1402,skCli_1106)));
                                                {1027}in(c, (ePartS_1403: bitstring,sigPartS_1404: bitstring));
                                                {1028}let (=Cli,PartS_1405: bitstring) = dec(ePartS_1403,skCli_1106) in
                                                {1029}if (verify((Cli,PartS_1405),sigPartS_1404,pkSess_1397) <> true) then
                                                    0
                                                else
                                                    {1030}let Kcli_1406: bitstring = exp(PartS_1405,Nc_1401) in
                                                    {1031}out(c, senc(mCli(pkCli_1107,pkSess_1397),Kcli_1406))
                                    )
                                    else
                                        {1032}let pkDisco_1407: bitstring = fail-any in
                                        {1033}let v_1408: bool = (Sess = A) in
                                        (
                                            {1034}if v_1408 then
                                            (
                                                {1035}let pkSess_1409: bitstring = pub(skA) in
                                                {1036}out(c, GetEndpointRequest);
                                                {1037}in(c, (SPs_1410: bitstring,=SignAndEncrypt,UP_1411: bitstring,=pkSess_1409));
                                                {1038}new SPc_1412: bitstring;
                                                {1039}new Nc_1413: bitstring;
                                                {1040}let m1_1414: bitstring = (Sess,SPc_1412,exp(g,Nc_1413)) in
                                                {1041}out(c, (pkCli_1107,enc(m1_1414,pkSess_1409),sign(m1_1414,skCli_1106)));
                                                {1042}in(c, (ePartS_1415: bitstring,sigPartS_1416: bitstring));
                                                {1043}let (=Cli,PartS_1417: bitstring) = dec(ePartS_1415,skCli_1106) in
                                                {1044}if (verify((Cli,PartS_1417),sigPartS_1416,pkSess_1409) <> true) then
                                                    0
                                                else
                                                    {1045}let Kcli_1418: bitstring = exp(PartS_1417,Nc_1413) in
                                                    {1046}out(c, senc(mCli(pkCli_1107,pkSess_1409),Kcli_1418))
                                            )
                                            else
                                                {1047}let v_1419: bool = (Sess = B) in
                                                (
                                                    {1048}if v_1419 then
                                                    (
                                                        {1049}let pkSess_1420: bitstring = pub(skB) in
                                                        {1050}out(c, GetEndpointRequest);
                                                        {1051}in(c, (SPs_1421: bitstring,=SignAndEncrypt,UP_1422: bitstring,=pkSess_1420));
                                                        {1052}new SPc_1423: bitstring;
                                                        {1053}new Nc_1424: bitstring;
                                                        {1054}let m1_1425: bitstring = (Sess,SPc_1423,exp(g,Nc_1424)) in
                                                        {1055}out(c, (pkCli_1107,enc(m1_1425,pkSess_1420),sign(m1_1425,skCli_1106)));
                                                        {1056}in(c, (ePartS_1426: bitstring,sigPartS_1427: bitstring));
                                                        {1057}let (=Cli,PartS_1428: bitstring) = dec(ePartS_1426,skCli_1106) in
                                                        {1058}if (verify((Cli,PartS_1428),sigPartS_1427,pkSess_1420) <> true) then
                                                            0
                                                        else
                                                            {1059}let Kcli_1429: bitstring = exp(PartS_1428,Nc_1424) in
                                                            {1060}out(c, senc(mCli(pkCli_1107,pkSess_1420),Kcli_1429))
                                                    )
                                                    else
                                                        {1061}let v_1430: bool = (Sess = C) in
                                                        (
                                                            {1062}if v_1430 then
                                                            (
                                                                {1063}let pkSess_1431: bitstring = pub(skC) in
                                                                {1064}out(c, GetEndpointRequest);
                                                                {1065}in(c, (SPs_1432: bitstring,=SignAndEncrypt,UP_1433: bitstring,=pkSess_1431));
                                                                {1066}new SPc_1434: bitstring;
                                                                {1067}new Nc_1435: bitstring;
                                                                {1068}let m1_1436: bitstring = (Sess,SPc_1434,exp(g,Nc_1435)) in
                                                                {1069}out(c, (pkCli_1107,enc(m1_1436,pkSess_1431),sign(m1_1436,skCli_1106)));
                                                                {1070}in(c, (ePartS_1437: bitstring,sigPartS_1438: bitstring));
                                                                {1071}let (=Cli,PartS_1439: bitstring) = dec(ePartS_1437,skCli_1106) in
                                                                {1072}if (verify((Cli,PartS_1439),sigPartS_1438,pkSess_1431) <> true) then
                                                                    0
                                                                else
                                                                    {1073}let Kcli_1440: bitstring = exp(PartS_1439,Nc_1435) in
                                                                    {1074}out(c, senc(mCli(pkCli_1107,pkSess_1431),Kcli_1440))
                                                            )
                                                            else
                                                                {1075}let pkSess_1441: bitstring = pub(skI) in
                                                                {1076}out(c, GetEndpointRequest);
                                                                {1077}in(c, (SPs_1442: bitstring,=SignAndEncrypt,UP_1443: bitstring,=pkSess_1441));
                                                                {1078}new SPc_1444: bitstring;
                                                                {1079}new Nc_1445: bitstring;
                                                                {1080}let m1_1446: bitstring = (Sess,SPc_1444,exp(g,Nc_1445)) in
                                                                {1081}out(c, (pkCli_1107,enc(m1_1446,pkSess_1441),sign(m1_1446,skCli_1106)));
                                                                {1082}in(c, (ePartS_1447: bitstring,sigPartS_1448: bitstring));
                                                                {1083}let (=Cli,PartS_1449: bitstring) = dec(ePartS_1447,skCli_1106) in
                                                                {1084}if (verify((Cli,PartS_1449),sigPartS_1448,pkSess_1441) <> true) then
                                                                    0
                                                                else
                                                                    {1085}let Kcli_1450: bitstring = exp(PartS_1449,Nc_1445) in
                                                                    {1086}out(c, senc(mCli(pkCli_1107,pkSess_1441),Kcli_1450))
                                                        )
                                                        else
                                                            {1087}let pkSess_1451: bitstring = fail-any in
                                                            {1088}out(c, GetEndpointRequest);
                                                            {1089}in(c, (SPs_1452: bitstring,=SignAndEncrypt,UP_1453: bitstring,=pkSess_1451));
                                                            {1090}new SPc_1454: bitstring;
                                                            {1091}new Nc_1455: bitstring;
                                                            {1092}let m1_1456: bitstring = (Sess,SPc_1454,exp(g,Nc_1455)) in
                                                            {1093}out(c, (pkCli_1107,enc(m1_1456,pkSess_1451),sign(m1_1456,skCli_1106)));
                                                            {1094}in(c, (ePartS_1457: bitstring,sigPartS_1458: bitstring));
                                                            {1095}let (=Cli,PartS_1459: bitstring) = dec(ePartS_1457,skCli_1106) in
                                                            {1096}if (verify((Cli,PartS_1459),sigPartS_1458,pkSess_1451) <> true) then
                                                                0
                                                            else
                                                                {1097}let Kcli_1460: bitstring = exp(PartS_1459,Nc_1455) in
                                                                {1098}out(c, senc(mCli(pkCli_1107,pkSess_1451),Kcli_1460))
                                                )
                                                else
                                                    {1099}let pkSess_1461: bitstring = fail-any in
                                                    {1100}out(c, GetEndpointRequest);
                                                    {1101}in(c, (SPs_1462: bitstring,=SignAndEncrypt,UP_1463: bitstring,=pkSess_1461));
                                                    {1102}new SPc_1464: bitstring;
                                                    {1103}new Nc_1465: bitstring;
                                                    {1104}let m1_1466: bitstring = (Sess,SPc_1464,exp(g,Nc_1465)) in
                                                    {1105}out(c, (pkCli_1107,enc(m1_1466,pkSess_1461),sign(m1_1466,skCli_1106)));
                                                    {1106}in(c, (ePartS_1467: bitstring,sigPartS_1468: bitstring));
                                                    {1107}let (=Cli,PartS_1469: bitstring) = dec(ePartS_1467,skCli_1106) in
                                                    {1108}if (verify((Cli,PartS_1469),sigPartS_1468,pkSess_1461) <> true) then
                                                        0
                                                    else
                                                        {1109}let Kcli_1470: bitstring = exp(PartS_1469,Nc_1465) in
                                                        {1110}out(c, senc(mCli(pkCli_1107,pkSess_1461),Kcli_1470))
                                        )
                                        else
                                            {1111}let pkSess_1471: bitstring = fail-any in
                                            {1112}out(c, GetEndpointRequest);
                                            {1113}in(c, (SPs_1472: bitstring,=SignAndEncrypt,UP_1473: bitstring,=pkSess_1471));
                                            {1114}new SPc_1474: bitstring;
                                            {1115}new Nc_1475: bitstring;
                                            {1116}let m1_1476: bitstring = (Sess,SPc_1474,exp(g,Nc_1475)) in
                                            {1117}out(c, (pkCli_1107,enc(m1_1476,pkSess_1471),sign(m1_1476,skCli_1106)));
                                            {1118}in(c, (ePartS_1477: bitstring,sigPartS_1478: bitstring));
                                            {1119}let (=Cli,PartS_1479: bitstring) = dec(ePartS_1477,skCli_1106) in
                                            {1120}if (verify((Cli,PartS_1479),sigPartS_1478,pkSess_1471) <> true) then
                                                0
                                            else
                                                {1121}let Kcli_1480: bitstring = exp(PartS_1479,Nc_1475) in
                                                {1122}out(c, senc(mCli(pkCli_1107,pkSess_1471),Kcli_1480))
                            )
                            else
                                {1123}let pkDisco_1481: bitstring = fail-any in
                                {1124}let v_1482: bool = (Sess = A) in
                                (
                                    {1125}if v_1482 then
                                    (
                                        {1126}let pkSess_1483: bitstring = pub(skA) in
                                        {1127}out(c, GetEndpointRequest);
                                        {1128}in(c, (SPs_1484: bitstring,=SignAndEncrypt,UP_1485: bitstring,=pkSess_1483));
                                        {1129}new SPc_1486: bitstring;
                                        {1130}new Nc_1487: bitstring;
                                        {1131}let m1_1488: bitstring = (Sess,SPc_1486,exp(g,Nc_1487)) in
                                        {1132}out(c, (pkCli_1107,enc(m1_1488,pkSess_1483),sign(m1_1488,skCli_1106)));
                                        {1133}in(c, (ePartS_1489: bitstring,sigPartS_1490: bitstring));
                                        {1134}let (=Cli,PartS_1491: bitstring) = dec(ePartS_1489,skCli_1106) in
                                        {1135}if (verify((Cli,PartS_1491),sigPartS_1490,pkSess_1483) <> true) then
                                            0
                                        else
                                            {1136}let Kcli_1492: bitstring = exp(PartS_1491,Nc_1487) in
                                            {1137}out(c, senc(mCli(pkCli_1107,pkSess_1483),Kcli_1492))
                                    )
                                    else
                                        {1138}let v_1493: bool = (Sess = B) in
                                        (
                                            {1139}if v_1493 then
                                            (
                                                {1140}let pkSess_1494: bitstring = pub(skB) in
                                                {1141}out(c, GetEndpointRequest);
                                                {1142}in(c, (SPs_1495: bitstring,=SignAndEncrypt,UP_1496: bitstring,=pkSess_1494));
                                                {1143}new SPc_1497: bitstring;
                                                {1144}new Nc_1498: bitstring;
                                                {1145}let m1_1499: bitstring = (Sess,SPc_1497,exp(g,Nc_1498)) in
                                                {1146}out(c, (pkCli_1107,enc(m1_1499,pkSess_1494),sign(m1_1499,skCli_1106)));
                                                {1147}in(c, (ePartS_1500: bitstring,sigPartS_1501: bitstring));
                                                {1148}let (=Cli,PartS_1502: bitstring) = dec(ePartS_1500,skCli_1106) in
                                                {1149}if (verify((Cli,PartS_1502),sigPartS_1501,pkSess_1494) <> true) then
                                                    0
                                                else
                                                    {1150}let Kcli_1503: bitstring = exp(PartS_1502,Nc_1498) in
                                                    {1151}out(c, senc(mCli(pkCli_1107,pkSess_1494),Kcli_1503))
                                            )
                                            else
                                                {1152}let v_1504: bool = (Sess = C) in
                                                (
                                                    {1153}if v_1504 then
                                                    (
                                                        {1154}let pkSess_1505: bitstring = pub(skC) in
                                                        {1155}out(c, GetEndpointRequest);
                                                        {1156}in(c, (SPs_1506: bitstring,=SignAndEncrypt,UP_1507: bitstring,=pkSess_1505));
                                                        {1157}new SPc_1508: bitstring;
                                                        {1158}new Nc_1509: bitstring;
                                                        {1159}let m1_1510: bitstring = (Sess,SPc_1508,exp(g,Nc_1509)) in
                                                        {1160}out(c, (pkCli_1107,enc(m1_1510,pkSess_1505),sign(m1_1510,skCli_1106)));
                                                        {1161}in(c, (ePartS_1511: bitstring,sigPartS_1512: bitstring));
                                                        {1162}let (=Cli,PartS_1513: bitstring) = dec(ePartS_1511,skCli_1106) in
                                                        {1163}if (verify((Cli,PartS_1513),sigPartS_1512,pkSess_1505) <> true) then
                                                            0
                                                        else
                                                            {1164}let Kcli_1514: bitstring = exp(PartS_1513,Nc_1509) in
                                                            {1165}out(c, senc(mCli(pkCli_1107,pkSess_1505),Kcli_1514))
                                                    )
                                                    else
                                                        {1166}let pkSess_1515: bitstring = pub(skI) in
                                                        {1167}out(c, GetEndpointRequest);
                                                        {1168}in(c, (SPs_1516: bitstring,=SignAndEncrypt,UP_1517: bitstring,=pkSess_1515));
                                                        {1169}new SPc_1518: bitstring;
                                                        {1170}new Nc_1519: bitstring;
                                                        {1171}let m1_1520: bitstring = (Sess,SPc_1518,exp(g,Nc_1519)) in
                                                        {1172}out(c, (pkCli_1107,enc(m1_1520,pkSess_1515),sign(m1_1520,skCli_1106)));
                                                        {1173}in(c, (ePartS_1521: bitstring,sigPartS_1522: bitstring));
                                                        {1174}let (=Cli,PartS_1523: bitstring) = dec(ePartS_1521,skCli_1106) in
                                                        {1175}if (verify((Cli,PartS_1523),sigPartS_1522,pkSess_1515) <> true) then
                                                            0
                                                        else
                                                            {1176}let Kcli_1524: bitstring = exp(PartS_1523,Nc_1519) in
                                                            {1177}out(c, senc(mCli(pkCli_1107,pkSess_1515),Kcli_1524))
                                                )
                                                else
                                                    {1178}let pkSess_1525: bitstring = fail-any in
                                                    {1179}out(c, GetEndpointRequest);
                                                    {1180}in(c, (SPs_1526: bitstring,=SignAndEncrypt,UP_1527: bitstring,=pkSess_1525));
                                                    {1181}new SPc_1528: bitstring;
                                                    {1182}new Nc_1529: bitstring;
                                                    {1183}let m1_1530: bitstring = (Sess,SPc_1528,exp(g,Nc_1529)) in
                                                    {1184}out(c, (pkCli_1107,enc(m1_1530,pkSess_1525),sign(m1_1530,skCli_1106)));
                                                    {1185}in(c, (ePartS_1531: bitstring,sigPartS_1532: bitstring));
                                                    {1186}let (=Cli,PartS_1533: bitstring) = dec(ePartS_1531,skCli_1106) in
                                                    {1187}if (verify((Cli,PartS_1533),sigPartS_1532,pkSess_1525) <> true) then
                                                        0
                                                    else
                                                        {1188}let Kcli_1534: bitstring = exp(PartS_1533,Nc_1529) in
                                                        {1189}out(c, senc(mCli(pkCli_1107,pkSess_1525),Kcli_1534))
                                        )
                                        else
                                            {1190}let pkSess_1535: bitstring = fail-any in
                                            {1191}out(c, GetEndpointRequest);
                                            {1192}in(c, (SPs_1536: bitstring,=SignAndEncrypt,UP_1537: bitstring,=pkSess_1535));
                                            {1193}new SPc_1538: bitstring;
                                            {1194}new Nc_1539: bitstring;
                                            {1195}let m1_1540: bitstring = (Sess,SPc_1538,exp(g,Nc_1539)) in
                                            {1196}out(c, (pkCli_1107,enc(m1_1540,pkSess_1535),sign(m1_1540,skCli_1106)));
                                            {1197}in(c, (ePartS_1541: bitstring,sigPartS_1542: bitstring));
                                            {1198}let (=Cli,PartS_1543: bitstring) = dec(ePartS_1541,skCli_1106) in
                                            {1199}if (verify((Cli,PartS_1543),sigPartS_1542,pkSess_1535) <> true) then
                                                0
                                            else
                                                {1200}let Kcli_1544: bitstring = exp(PartS_1543,Nc_1539) in
                                                {1201}out(c, senc(mCli(pkCli_1107,pkSess_1535),Kcli_1544))
                                )
                                else
                                    {1202}let pkSess_1545: bitstring = fail-any in
                                    {1203}out(c, GetEndpointRequest);
                                    {1204}in(c, (SPs_1546: bitstring,=SignAndEncrypt,UP_1547: bitstring,=pkSess_1545));
                                    {1205}new SPc_1548: bitstring;
                                    {1206}new Nc_1549: bitstring;
                                    {1207}let m1_1550: bitstring = (Sess,SPc_1548,exp(g,Nc_1549)) in
                                    {1208}out(c, (pkCli_1107,enc(m1_1550,pkSess_1545),sign(m1_1550,skCli_1106)));
                                    {1209}in(c, (ePartS_1551: bitstring,sigPartS_1552: bitstring));
                                    {1210}let (=Cli,PartS_1553: bitstring) = dec(ePartS_1551,skCli_1106) in
                                    {1211}if (verify((Cli,PartS_1553),sigPartS_1552,pkSess_1545) <> true) then
                                        0
                                    else
                                        {1212}let Kcli_1554: bitstring = exp(PartS_1553,Nc_1549) in
                                        {1213}out(c, senc(mCli(pkCli_1107,pkSess_1545),Kcli_1554))
                    )
                    else
                        {1214}let pkDisco_1555: bitstring = fail-any in
                        {1215}let v_1556: bool = (Sess = A) in
                        (
                            {1216}if v_1556 then
                            (
                                {1217}let pkSess_1557: bitstring = pub(skA) in
                                {1218}out(c, GetEndpointRequest);
                                {1219}in(c, (SPs_1558: bitstring,=SignAndEncrypt,UP_1559: bitstring,=pkSess_1557));
                                {1220}new SPc_1560: bitstring;
                                {1221}new Nc_1561: bitstring;
                                {1222}let m1_1562: bitstring = (Sess,SPc_1560,exp(g,Nc_1561)) in
                                {1223}out(c, (pkCli_1107,enc(m1_1562,pkSess_1557),sign(m1_1562,skCli_1106)));
                                {1224}in(c, (ePartS_1563: bitstring,sigPartS_1564: bitstring));
                                {1225}let (=Cli,PartS_1565: bitstring) = dec(ePartS_1563,skCli_1106) in
                                {1226}if (verify((Cli,PartS_1565),sigPartS_1564,pkSess_1557) <> true) then
                                    0
                                else
                                    {1227}let Kcli_1566: bitstring = exp(PartS_1565,Nc_1561) in
                                    {1228}out(c, senc(mCli(pkCli_1107,pkSess_1557),Kcli_1566))
                            )
                            else
                                {1229}let v_1567: bool = (Sess = B) in
                                (
                                    {1230}if v_1567 then
                                    (
                                        {1231}let pkSess_1568: bitstring = pub(skB) in
                                        {1232}out(c, GetEndpointRequest);
                                        {1233}in(c, (SPs_1569: bitstring,=SignAndEncrypt,UP_1570: bitstring,=pkSess_1568));
                                        {1234}new SPc_1571: bitstring;
                                        {1235}new Nc_1572: bitstring;
                                        {1236}let m1_1573: bitstring = (Sess,SPc_1571,exp(g,Nc_1572)) in
                                        {1237}out(c, (pkCli_1107,enc(m1_1573,pkSess_1568),sign(m1_1573,skCli_1106)));
                                        {1238}in(c, (ePartS_1574: bitstring,sigPartS_1575: bitstring));
                                        {1239}let (=Cli,PartS_1576: bitstring) = dec(ePartS_1574,skCli_1106) in
                                        {1240}if (verify((Cli,PartS_1576),sigPartS_1575,pkSess_1568) <> true) then
                                            0
                                        else
                                            {1241}let Kcli_1577: bitstring = exp(PartS_1576,Nc_1572) in
                                            {1242}out(c, senc(mCli(pkCli_1107,pkSess_1568),Kcli_1577))
                                    )
                                    else
                                        {1243}let v_1578: bool = (Sess = C) in
                                        (
                                            {1244}if v_1578 then
                                            (
                                                {1245}let pkSess_1579: bitstring = pub(skC) in
                                                {1246}out(c, GetEndpointRequest);
                                                {1247}in(c, (SPs_1580: bitstring,=SignAndEncrypt,UP_1581: bitstring,=pkSess_1579));
                                                {1248}new SPc_1582: bitstring;
                                                {1249}new Nc_1583: bitstring;
                                                {1250}let m1_1584: bitstring = (Sess,SPc_1582,exp(g,Nc_1583)) in
                                                {1251}out(c, (pkCli_1107,enc(m1_1584,pkSess_1579),sign(m1_1584,skCli_1106)));
                                                {1252}in(c, (ePartS_1585: bitstring,sigPartS_1586: bitstring));
                                                {1253}let (=Cli,PartS_1587: bitstring) = dec(ePartS_1585,skCli_1106) in
                                                {1254}if (verify((Cli,PartS_1587),sigPartS_1586,pkSess_1579) <> true) then
                                                    0
                                                else
                                                    {1255}let Kcli_1588: bitstring = exp(PartS_1587,Nc_1583) in
                                                    {1256}out(c, senc(mCli(pkCli_1107,pkSess_1579),Kcli_1588))
                                            )
                                            else
                                                {1257}let pkSess_1589: bitstring = pub(skI) in
                                                {1258}out(c, GetEndpointRequest);
                                                {1259}in(c, (SPs_1590: bitstring,=SignAndEncrypt,UP_1591: bitstring,=pkSess_1589));
                                                {1260}new SPc_1592: bitstring;
                                                {1261}new Nc_1593: bitstring;
                                                {1262}let m1_1594: bitstring = (Sess,SPc_1592,exp(g,Nc_1593)) in
                                                {1263}out(c, (pkCli_1107,enc(m1_1594,pkSess_1589),sign(m1_1594,skCli_1106)));
                                                {1264}in(c, (ePartS_1595: bitstring,sigPartS_1596: bitstring));
                                                {1265}let (=Cli,PartS_1597: bitstring) = dec(ePartS_1595,skCli_1106) in
                                                {1266}if (verify((Cli,PartS_1597),sigPartS_1596,pkSess_1589) <> true) then
                                                    0
                                                else
                                                    {1267}let Kcli_1598: bitstring = exp(PartS_1597,Nc_1593) in
                                                    {1268}out(c, senc(mCli(pkCli_1107,pkSess_1589),Kcli_1598))
                                        )
                                        else
                                            {1269}let pkSess_1599: bitstring = fail-any in
                                            {1270}out(c, GetEndpointRequest);
                                            {1271}in(c, (SPs_1600: bitstring,=SignAndEncrypt,UP_1601: bitstring,=pkSess_1599));
                                            {1272}new SPc_1602: bitstring;
                                            {1273}new Nc_1603: bitstring;
                                            {1274}let m1_1604: bitstring = (Sess,SPc_1602,exp(g,Nc_1603)) in
                                            {1275}out(c, (pkCli_1107,enc(m1_1604,pkSess_1599),sign(m1_1604,skCli_1106)));
                                            {1276}in(c, (ePartS_1605: bitstring,sigPartS_1606: bitstring));
                                            {1277}let (=Cli,PartS_1607: bitstring) = dec(ePartS_1605,skCli_1106) in
                                            {1278}if (verify((Cli,PartS_1607),sigPartS_1606,pkSess_1599) <> true) then
                                                0
                                            else
                                                {1279}let Kcli_1608: bitstring = exp(PartS_1607,Nc_1603) in
                                                {1280}out(c, senc(mCli(pkCli_1107,pkSess_1599),Kcli_1608))
                                )
                                else
                                    {1281}let pkSess_1609: bitstring = fail-any in
                                    {1282}out(c, GetEndpointRequest);
                                    {1283}in(c, (SPs_1610: bitstring,=SignAndEncrypt,UP_1611: bitstring,=pkSess_1609));
                                    {1284}new SPc_1612: bitstring;
                                    {1285}new Nc_1613: bitstring;
                                    {1286}let m1_1614: bitstring = (Sess,SPc_1612,exp(g,Nc_1613)) in
                                    {1287}out(c, (pkCli_1107,enc(m1_1614,pkSess_1609),sign(m1_1614,skCli_1106)));
                                    {1288}in(c, (ePartS_1615: bitstring,sigPartS_1616: bitstring));
                                    {1289}let (=Cli,PartS_1617: bitstring) = dec(ePartS_1615,skCli_1106) in
                                    {1290}if (verify((Cli,PartS_1617),sigPartS_1616,pkSess_1609) <> true) then
                                        0
                                    else
                                        {1291}let Kcli_1618: bitstring = exp(PartS_1617,Nc_1613) in
                                        {1292}out(c, senc(mCli(pkCli_1107,pkSess_1609),Kcli_1618))
                        )
                        else
                            {1293}let pkSess_1619: bitstring = fail-any in
                            {1294}out(c, GetEndpointRequest);
                            {1295}in(c, (SPs_1620: bitstring,=SignAndEncrypt,UP_1621: bitstring,=pkSess_1619));
                            {1296}new SPc_1622: bitstring;
                            {1297}new Nc_1623: bitstring;
                            {1298}let m1_1624: bitstring = (Sess,SPc_1622,exp(g,Nc_1623)) in
                            {1299}out(c, (pkCli_1107,enc(m1_1624,pkSess_1619),sign(m1_1624,skCli_1106)));
                            {1300}in(c, (ePartS_1625: bitstring,sigPartS_1626: bitstring));
                            {1301}let (=Cli,PartS_1627: bitstring) = dec(ePartS_1625,skCli_1106) in
                            {1302}if (verify((Cli,PartS_1627),sigPartS_1626,pkSess_1619) <> true) then
                                0
                            else
                                {1303}let Kcli_1628: bitstring = exp(PartS_1627,Nc_1623) in
                                {1304}out(c, senc(mCli(pkCli_1107,pkSess_1619),Kcli_1628))
                )
                else
                    {1305}let v_1629: bool = (Cli = C) in
                    (
                        {1306}if v_1629 then
                        (
                            {1307}let skCli_1630: bitstring = skC in
                            {1308}let pkCli_1631: bitstring = pub(skCli_1630) in
                            {1309}let v_1632: bool = (Disco = A) in
                            (
                                {1310}if v_1632 then
                                (
                                    {1311}let pkDisco_1633: bitstring = pub(skA) in
                                    {1312}let v_1634: bool = (Sess = A) in
                                    (
                                        {1313}if v_1634 then
                                        (
                                            {1314}let pkSess_1635: bitstring = pub(skA) in
                                            {1315}out(c, GetEndpointRequest);
                                            {1316}in(c, (SPs_1636: bitstring,=SignAndEncrypt,UP_1637: bitstring,=pkSess_1635));
                                            {1317}new SPc_1638: bitstring;
                                            {1318}new Nc_1639: bitstring;
                                            {1319}let m1_1640: bitstring = (Sess,SPc_1638,exp(g,Nc_1639)) in
                                            {1320}out(c, (pkCli_1631,enc(m1_1640,pkSess_1635),sign(m1_1640,skCli_1630)));
                                            {1321}in(c, (ePartS_1641: bitstring,sigPartS_1642: bitstring));
                                            {1322}let (=Cli,PartS_1643: bitstring) = dec(ePartS_1641,skCli_1630) in
                                            {1323}if (verify((Cli,PartS_1643),sigPartS_1642,pkSess_1635) <> true) then
                                                0
                                            else
                                                {1324}let Kcli_1644: bitstring = exp(PartS_1643,Nc_1639) in
                                                {1325}out(c, senc(mCli(pkCli_1631,pkSess_1635),Kcli_1644))
                                        )
                                        else
                                            {1326}let v_1645: bool = (Sess = B) in
                                            (
                                                {1327}if v_1645 then
                                                (
                                                    {1328}let pkSess_1646: bitstring = pub(skB) in
                                                    {1329}out(c, GetEndpointRequest);
                                                    {1330}in(c, (SPs_1647: bitstring,=SignAndEncrypt,UP_1648: bitstring,=pkSess_1646));
                                                    {1331}new SPc_1649: bitstring;
                                                    {1332}new Nc_1650: bitstring;
                                                    {1333}let m1_1651: bitstring = (Sess,SPc_1649,exp(g,Nc_1650)) in
                                                    {1334}out(c, (pkCli_1631,enc(m1_1651,pkSess_1646),sign(m1_1651,skCli_1630)));
                                                    {1335}in(c, (ePartS_1652: bitstring,sigPartS_1653: bitstring));
                                                    {1336}let (=Cli,PartS_1654: bitstring) = dec(ePartS_1652,skCli_1630) in
                                                    {1337}if (verify((Cli,PartS_1654),sigPartS_1653,pkSess_1646) <> true) then
                                                        0
                                                    else
                                                        {1338}let Kcli_1655: bitstring = exp(PartS_1654,Nc_1650) in
                                                        {1339}out(c, senc(mCli(pkCli_1631,pkSess_1646),Kcli_1655))
                                                )
                                                else
                                                    {1340}let v_1656: bool = (Sess = C) in
                                                    (
                                                        {1341}if v_1656 then
                                                        (
                                                            {1342}let pkSess_1657: bitstring = pub(skC) in
                                                            {1343}out(c, GetEndpointRequest);
                                                            {1344}in(c, (SPs_1658: bitstring,=SignAndEncrypt,UP_1659: bitstring,=pkSess_1657));
                                                            {1345}new SPc_1660: bitstring;
                                                            {1346}new Nc_1661: bitstring;
                                                            {1347}let m1_1662: bitstring = (Sess,SPc_1660,exp(g,Nc_1661)) in
                                                            {1348}out(c, (pkCli_1631,enc(m1_1662,pkSess_1657),sign(m1_1662,skCli_1630)));
                                                            {1349}in(c, (ePartS_1663: bitstring,sigPartS_1664: bitstring));
                                                            {1350}let (=Cli,PartS_1665: bitstring) = dec(ePartS_1663,skCli_1630) in
                                                            {1351}if (verify((Cli,PartS_1665),sigPartS_1664,pkSess_1657) <> true) then
                                                                0
                                                            else
                                                                {1352}let Kcli_1666: bitstring = exp(PartS_1665,Nc_1661) in
                                                                {1353}out(c, senc(mCli(pkCli_1631,pkSess_1657),Kcli_1666))
                                                        )
                                                        else
                                                            {1354}let pkSess_1667: bitstring = pub(skI) in
                                                            {1355}out(c, GetEndpointRequest);
                                                            {1356}in(c, (SPs_1668: bitstring,=SignAndEncrypt,UP_1669: bitstring,=pkSess_1667));
                                                            {1357}new SPc_1670: bitstring;
                                                            {1358}new Nc_1671: bitstring;
                                                            {1359}let m1_1672: bitstring = (Sess,SPc_1670,exp(g,Nc_1671)) in
                                                            {1360}out(c, (pkCli_1631,enc(m1_1672,pkSess_1667),sign(m1_1672,skCli_1630)));
                                                            {1361}in(c, (ePartS_1673: bitstring,sigPartS_1674: bitstring));
                                                            {1362}let (=Cli,PartS_1675: bitstring) = dec(ePartS_1673,skCli_1630) in
                                                            {1363}if (verify((Cli,PartS_1675),sigPartS_1674,pkSess_1667) <> true) then
                                                                0
                                                            else
                                                                {1364}let Kcli_1676: bitstring = exp(PartS_1675,Nc_1671) in
                                                                {1365}out(c, senc(mCli(pkCli_1631,pkSess_1667),Kcli_1676))
                                                    )
                                                    else
                                                        {1366}let pkSess_1677: bitstring = fail-any in
                                                        {1367}out(c, GetEndpointRequest);
                                                        {1368}in(c, (SPs_1678: bitstring,=SignAndEncrypt,UP_1679: bitstring,=pkSess_1677));
                                                        {1369}new SPc_1680: bitstring;
                                                        {1370}new Nc_1681: bitstring;
                                                        {1371}let m1_1682: bitstring = (Sess,SPc_1680,exp(g,Nc_1681)) in
                                                        {1372}out(c, (pkCli_1631,enc(m1_1682,pkSess_1677),sign(m1_1682,skCli_1630)));
                                                        {1373}in(c, (ePartS_1683: bitstring,sigPartS_1684: bitstring));
                                                        {1374}let (=Cli,PartS_1685: bitstring) = dec(ePartS_1683,skCli_1630) in
                                                        {1375}if (verify((Cli,PartS_1685),sigPartS_1684,pkSess_1677) <> true) then
                                                            0
                                                        else
                                                            {1376}let Kcli_1686: bitstring = exp(PartS_1685,Nc_1681) in
                                                            {1377}out(c, senc(mCli(pkCli_1631,pkSess_1677),Kcli_1686))
                                            )
                                            else
                                                {1378}let pkSess_1687: bitstring = fail-any in
                                                {1379}out(c, GetEndpointRequest);
                                                {1380}in(c, (SPs_1688: bitstring,=SignAndEncrypt,UP_1689: bitstring,=pkSess_1687));
                                                {1381}new SPc_1690: bitstring;
                                                {1382}new Nc_1691: bitstring;
                                                {1383}let m1_1692: bitstring = (Sess,SPc_1690,exp(g,Nc_1691)) in
                                                {1384}out(c, (pkCli_1631,enc(m1_1692,pkSess_1687),sign(m1_1692,skCli_1630)));
                                                {1385}in(c, (ePartS_1693: bitstring,sigPartS_1694: bitstring));
                                                {1386}let (=Cli,PartS_1695: bitstring) = dec(ePartS_1693,skCli_1630) in
                                                {1387}if (verify((Cli,PartS_1695),sigPartS_1694,pkSess_1687) <> true) then
                                                    0
                                                else
                                                    {1388}let Kcli_1696: bitstring = exp(PartS_1695,Nc_1691) in
                                                    {1389}out(c, senc(mCli(pkCli_1631,pkSess_1687),Kcli_1696))
                                    )
                                    else
                                        {1390}let pkSess_1697: bitstring = fail-any in
                                        {1391}out(c, GetEndpointRequest);
                                        {1392}in(c, (SPs_1698: bitstring,=SignAndEncrypt,UP_1699: bitstring,=pkSess_1697));
                                        {1393}new SPc_1700: bitstring;
                                        {1394}new Nc_1701: bitstring;
                                        {1395}let m1_1702: bitstring = (Sess,SPc_1700,exp(g,Nc_1701)) in
                                        {1396}out(c, (pkCli_1631,enc(m1_1702,pkSess_1697),sign(m1_1702,skCli_1630)));
                                        {1397}in(c, (ePartS_1703: bitstring,sigPartS_1704: bitstring));
                                        {1398}let (=Cli,PartS_1705: bitstring) = dec(ePartS_1703,skCli_1630) in
                                        {1399}if (verify((Cli,PartS_1705),sigPartS_1704,pkSess_1697) <> true) then
                                            0
                                        else
                                            {1400}let Kcli_1706: bitstring = exp(PartS_1705,Nc_1701) in
                                            {1401}out(c, senc(mCli(pkCli_1631,pkSess_1697),Kcli_1706))
                                )
                                else
                                    {1402}let v_1707: bool = (Disco = B) in
                                    (
                                        {1403}if v_1707 then
                                        (
                                            {1404}let pkDisco_1708: bitstring = pub(skB) in
                                            {1405}let v_1709: bool = (Sess = A) in
                                            (
                                                {1406}if v_1709 then
                                                (
                                                    {1407}let pkSess_1710: bitstring = pub(skA) in
                                                    {1408}out(c, GetEndpointRequest);
                                                    {1409}in(c, (SPs_1711: bitstring,=SignAndEncrypt,UP_1712: bitstring,=pkSess_1710));
                                                    {1410}new SPc_1713: bitstring;
                                                    {1411}new Nc_1714: bitstring;
                                                    {1412}let m1_1715: bitstring = (Sess,SPc_1713,exp(g,Nc_1714)) in
                                                    {1413}out(c, (pkCli_1631,enc(m1_1715,pkSess_1710),sign(m1_1715,skCli_1630)));
                                                    {1414}in(c, (ePartS_1716: bitstring,sigPartS_1717: bitstring));
                                                    {1415}let (=Cli,PartS_1718: bitstring) = dec(ePartS_1716,skCli_1630) in
                                                    {1416}if (verify((Cli,PartS_1718),sigPartS_1717,pkSess_1710) <> true) then
                                                        0
                                                    else
                                                        {1417}let Kcli_1719: bitstring = exp(PartS_1718,Nc_1714) in
                                                        {1418}out(c, senc(mCli(pkCli_1631,pkSess_1710),Kcli_1719))
                                                )
                                                else
                                                    {1419}let v_1720: bool = (Sess = B) in
                                                    (
                                                        {1420}if v_1720 then
                                                        (
                                                            {1421}let pkSess_1721: bitstring = pub(skB) in
                                                            {1422}out(c, GetEndpointRequest);
                                                            {1423}in(c, (SPs_1722: bitstring,=SignAndEncrypt,UP_1723: bitstring,=pkSess_1721));
                                                            {1424}new SPc_1724: bitstring;
                                                            {1425}new Nc_1725: bitstring;
                                                            {1426}let m1_1726: bitstring = (Sess,SPc_1724,exp(g,Nc_1725)) in
                                                            {1427}out(c, (pkCli_1631,enc(m1_1726,pkSess_1721),sign(m1_1726,skCli_1630)));
                                                            {1428}in(c, (ePartS_1727: bitstring,sigPartS_1728: bitstring));
                                                            {1429}let (=Cli,PartS_1729: bitstring) = dec(ePartS_1727,skCli_1630) in
                                                            {1430}if (verify((Cli,PartS_1729),sigPartS_1728,pkSess_1721) <> true) then
                                                                0
                                                            else
                                                                {1431}let Kcli_1730: bitstring = exp(PartS_1729,Nc_1725) in
                                                                {1432}out(c, senc(mCli(pkCli_1631,pkSess_1721),Kcli_1730))
                                                        )
                                                        else
                                                            {1433}let v_1731: bool = (Sess = C) in
                                                            (
                                                                {1434}if v_1731 then
                                                                (
                                                                    {1435}let pkSess_1732: bitstring = pub(skC) in
                                                                    {1436}out(c, GetEndpointRequest);
                                                                    {1437}in(c, (SPs_1733: bitstring,=SignAndEncrypt,UP_1734: bitstring,=pkSess_1732));
                                                                    {1438}new SPc_1735: bitstring;
                                                                    {1439}new Nc_1736: bitstring;
                                                                    {1440}let m1_1737: bitstring = (Sess,SPc_1735,exp(g,Nc_1736)) in
                                                                    {1441}out(c, (pkCli_1631,enc(m1_1737,pkSess_1732),sign(m1_1737,skCli_1630)));
                                                                    {1442}in(c, (ePartS_1738: bitstring,sigPartS_1739: bitstring));
                                                                    {1443}let (=Cli,PartS_1740: bitstring) = dec(ePartS_1738,skCli_1630) in
                                                                    {1444}if (verify((Cli,PartS_1740),sigPartS_1739,pkSess_1732) <> true) then
                                                                        0
                                                                    else
                                                                        {1445}let Kcli_1741: bitstring = exp(PartS_1740,Nc_1736) in
                                                                        {1446}out(c, senc(mCli(pkCli_1631,pkSess_1732),Kcli_1741))
                                                                )
                                                                else
                                                                    {1447}let pkSess_1742: bitstring = pub(skI) in
                                                                    {1448}out(c, GetEndpointRequest);
                                                                    {1449}in(c, (SPs_1743: bitstring,=SignAndEncrypt,UP_1744: bitstring,=pkSess_1742));
                                                                    {1450}new SPc_1745: bitstring;
                                                                    {1451}new Nc_1746: bitstring;
                                                                    {1452}let m1_1747: bitstring = (Sess,SPc_1745,exp(g,Nc_1746)) in
                                                                    {1453}out(c, (pkCli_1631,enc(m1_1747,pkSess_1742),sign(m1_1747,skCli_1630)));
                                                                    {1454}in(c, (ePartS_1748: bitstring,sigPartS_1749: bitstring));
                                                                    {1455}let (=Cli,PartS_1750: bitstring) = dec(ePartS_1748,skCli_1630) in
                                                                    {1456}if (verify((Cli,PartS_1750),sigPartS_1749,pkSess_1742) <> true) then
                                                                        0
                                                                    else
                                                                        {1457}let Kcli_1751: bitstring = exp(PartS_1750,Nc_1746) in
                                                                        {1458}out(c, senc(mCli(pkCli_1631,pkSess_1742),Kcli_1751))
                                                            )
                                                            else
                                                                {1459}let pkSess_1752: bitstring = fail-any in
                                                                {1460}out(c, GetEndpointRequest);
                                                                {1461}in(c, (SPs_1753: bitstring,=SignAndEncrypt,UP_1754: bitstring,=pkSess_1752));
                                                                {1462}new SPc_1755: bitstring;
                                                                {1463}new Nc_1756: bitstring;
                                                                {1464}let m1_1757: bitstring = (Sess,SPc_1755,exp(g,Nc_1756)) in
                                                                {1465}out(c, (pkCli_1631,enc(m1_1757,pkSess_1752),sign(m1_1757,skCli_1630)));
                                                                {1466}in(c, (ePartS_1758: bitstring,sigPartS_1759: bitstring));
                                                                {1467}let (=Cli,PartS_1760: bitstring) = dec(ePartS_1758,skCli_1630) in
                                                                {1468}if (verify((Cli,PartS_1760),sigPartS_1759,pkSess_1752) <> true) then
                                                                    0
                                                                else
                                                                    {1469}let Kcli_1761: bitstring = exp(PartS_1760,Nc_1756) in
                                                                    {1470}out(c, senc(mCli(pkCli_1631,pkSess_1752),Kcli_1761))
                                                    )
                                                    else
                                                        {1471}let pkSess_1762: bitstring = fail-any in
                                                        {1472}out(c, GetEndpointRequest);
                                                        {1473}in(c, (SPs_1763: bitstring,=SignAndEncrypt,UP_1764: bitstring,=pkSess_1762));
                                                        {1474}new SPc_1765: bitstring;
                                                        {1475}new Nc_1766: bitstring;
                                                        {1476}let m1_1767: bitstring = (Sess,SPc_1765,exp(g,Nc_1766)) in
                                                        {1477}out(c, (pkCli_1631,enc(m1_1767,pkSess_1762),sign(m1_1767,skCli_1630)));
                                                        {1478}in(c, (ePartS_1768: bitstring,sigPartS_1769: bitstring));
                                                        {1479}let (=Cli,PartS_1770: bitstring) = dec(ePartS_1768,skCli_1630) in
                                                        {1480}if (verify((Cli,PartS_1770),sigPartS_1769,pkSess_1762) <> true) then
                                                            0
                                                        else
                                                            {1481}let Kcli_1771: bitstring = exp(PartS_1770,Nc_1766) in
                                                            {1482}out(c, senc(mCli(pkCli_1631,pkSess_1762),Kcli_1771))
                                            )
                                            else
                                                {1483}let pkSess_1772: bitstring = fail-any in
                                                {1484}out(c, GetEndpointRequest);
                                                {1485}in(c, (SPs_1773: bitstring,=SignAndEncrypt,UP_1774: bitstring,=pkSess_1772));
                                                {1486}new SPc_1775: bitstring;
                                                {1487}new Nc_1776: bitstring;
                                                {1488}let m1_1777: bitstring = (Sess,SPc_1775,exp(g,Nc_1776)) in
                                                {1489}out(c, (pkCli_1631,enc(m1_1777,pkSess_1772),sign(m1_1777,skCli_1630)));
                                                {1490}in(c, (ePartS_1778: bitstring,sigPartS_1779: bitstring));
                                                {1491}let (=Cli,PartS_1780: bitstring) = dec(ePartS_1778,skCli_1630) in
                                                {1492}if (verify((Cli,PartS_1780),sigPartS_1779,pkSess_1772) <> true) then
                                                    0
                                                else
                                                    {1493}let Kcli_1781: bitstring = exp(PartS_1780,Nc_1776) in
                                                    {1494}out(c, senc(mCli(pkCli_1631,pkSess_1772),Kcli_1781))
                                        )
                                        else
                                            {1495}let v_1782: bool = (Disco = C) in
                                            (
                                                {1496}if v_1782 then
                                                (
                                                    {1497}let pkDisco_1783: bitstring = pub(skC) in
                                                    {1498}let v_1784: bool = (Sess = A) in
                                                    (
                                                        {1499}if v_1784 then
                                                        (
                                                            {1500}let pkSess_1785: bitstring = pub(skA) in
                                                            {1501}out(c, GetEndpointRequest);
                                                            {1502}in(c, (SPs_1786: bitstring,=SignAndEncrypt,UP_1787: bitstring,=pkSess_1785));
                                                            {1503}new SPc_1788: bitstring;
                                                            {1504}new Nc_1789: bitstring;
                                                            {1505}let m1_1790: bitstring = (Sess,SPc_1788,exp(g,Nc_1789)) in
                                                            {1506}out(c, (pkCli_1631,enc(m1_1790,pkSess_1785),sign(m1_1790,skCli_1630)));
                                                            {1507}in(c, (ePartS_1791: bitstring,sigPartS_1792: bitstring));
                                                            {1508}let (=Cli,PartS_1793: bitstring) = dec(ePartS_1791,skCli_1630) in
                                                            {1509}if (verify((Cli,PartS_1793),sigPartS_1792,pkSess_1785) <> true) then
                                                                0
                                                            else
                                                                {1510}let Kcli_1794: bitstring = exp(PartS_1793,Nc_1789) in
                                                                {1511}out(c, senc(mCli(pkCli_1631,pkSess_1785),Kcli_1794))
                                                        )
                                                        else
                                                            {1512}let v_1795: bool = (Sess = B) in
                                                            (
                                                                {1513}if v_1795 then
                                                                (
                                                                    {1514}let pkSess_1796: bitstring = pub(skB) in
                                                                    {1515}out(c, GetEndpointRequest);
                                                                    {1516}in(c, (SPs_1797: bitstring,=SignAndEncrypt,UP_1798: bitstring,=pkSess_1796));
                                                                    {1517}new SPc_1799: bitstring;
                                                                    {1518}new Nc_1800: bitstring;
                                                                    {1519}let m1_1801: bitstring = (Sess,SPc_1799,exp(g,Nc_1800)) in
                                                                    {1520}out(c, (pkCli_1631,enc(m1_1801,pkSess_1796),sign(m1_1801,skCli_1630)));
                                                                    {1521}in(c, (ePartS_1802: bitstring,sigPartS_1803: bitstring));
                                                                    {1522}let (=Cli,PartS_1804: bitstring) = dec(ePartS_1802,skCli_1630) in
                                                                    {1523}if (verify((Cli,PartS_1804),sigPartS_1803,pkSess_1796) <> true) then
                                                                        0
                                                                    else
                                                                        {1524}let Kcli_1805: bitstring = exp(PartS_1804,Nc_1800) in
                                                                        {1525}out(c, senc(mCli(pkCli_1631,pkSess_1796),Kcli_1805))
                                                                )
                                                                else
                                                                    {1526}let v_1806: bool = (Sess = C) in
                                                                    (
                                                                        {1527}if v_1806 then
                                                                        (
                                                                            {1528}let pkSess_1807: bitstring = pub(skC) in
                                                                            {1529}out(c, GetEndpointRequest);
                                                                            {1530}in(c, (SPs_1808: bitstring,=SignAndEncrypt,UP_1809: bitstring,=pkSess_1807));
                                                                            {1531}new SPc_1810: bitstring;
                                                                            {1532}new Nc_1811: bitstring;
                                                                            {1533}let m1_1812: bitstring = (Sess,SPc_1810,exp(g,Nc_1811)) in
                                                                            {1534}out(c, (pkCli_1631,enc(m1_1812,pkSess_1807),sign(m1_1812,skCli_1630)));
                                                                            {1535}in(c, (ePartS_1813: bitstring,sigPartS_1814: bitstring));
                                                                            {1536}let (=Cli,PartS_1815: bitstring) = dec(ePartS_1813,skCli_1630) in
                                                                            {1537}if (verify((Cli,PartS_1815),sigPartS_1814,pkSess_1807) <> true) then
                                                                                0
                                                                            else
                                                                                {1538}let Kcli_1816: bitstring = exp(PartS_1815,Nc_1811) in
                                                                                {1539}out(c, senc(mCli(pkCli_1631,pkSess_1807),Kcli_1816))
                                                                        )
                                                                        else
                                                                            {1540}let pkSess_1817: bitstring = pub(skI) in
                                                                            {1541}out(c, GetEndpointRequest);
                                                                            {1542}in(c, (SPs_1818: bitstring,=SignAndEncrypt,UP_1819: bitstring,=pkSess_1817));
                                                                            {1543}new SPc_1820: bitstring;
                                                                            {1544}new Nc_1821: bitstring;
                                                                            {1545}let m1_1822: bitstring = (Sess,SPc_1820,exp(g,Nc_1821)) in
                                                                            {1546}out(c, (pkCli_1631,enc(m1_1822,pkSess_1817),sign(m1_1822,skCli_1630)));
                                                                            {1547}in(c, (ePartS_1823: bitstring,sigPartS_1824: bitstring));
                                                                            {1548}let (=Cli,PartS_1825: bitstring) = dec(ePartS_1823,skCli_1630) in
                                                                            {1549}if (verify((Cli,PartS_1825),sigPartS_1824,pkSess_1817) <> true) then
                                                                                0
                                                                            else
                                                                                {1550}let Kcli_1826: bitstring = exp(PartS_1825,Nc_1821) in
                                                                                {1551}out(c, senc(mCli(pkCli_1631,pkSess_1817),Kcli_1826))
                                                                    )
                                                                    else
                                                                        {1552}let pkSess_1827: bitstring = fail-any in
                                                                        {1553}out(c, GetEndpointRequest);
                                                                        {1554}in(c, (SPs_1828: bitstring,=SignAndEncrypt,UP_1829: bitstring,=pkSess_1827));
                                                                        {1555}new SPc_1830: bitstring;
                                                                        {1556}new Nc_1831: bitstring;
                                                                        {1557}let m1_1832: bitstring = (Sess,SPc_1830,exp(g,Nc_1831)) in
                                                                        {1558}out(c, (pkCli_1631,enc(m1_1832,pkSess_1827),sign(m1_1832,skCli_1630)));
                                                                        {1559}in(c, (ePartS_1833: bitstring,sigPartS_1834: bitstring));
                                                                        {1560}let (=Cli,PartS_1835: bitstring) = dec(ePartS_1833,skCli_1630) in
                                                                        {1561}if (verify((Cli,PartS_1835),sigPartS_1834,pkSess_1827) <> true) then
                                                                            0
                                                                        else
                                                                            {1562}let Kcli_1836: bitstring = exp(PartS_1835,Nc_1831) in
                                                                            {1563}out(c, senc(mCli(pkCli_1631,pkSess_1827),Kcli_1836))
                                                            )
                                                            else
                                                                {1564}let pkSess_1837: bitstring = fail-any in
                                                                {1565}out(c, GetEndpointRequest);
                                                                {1566}in(c, (SPs_1838: bitstring,=SignAndEncrypt,UP_1839: bitstring,=pkSess_1837));
                                                                {1567}new SPc_1840: bitstring;
                                                                {1568}new Nc_1841: bitstring;
                                                                {1569}let m1_1842: bitstring = (Sess,SPc_1840,exp(g,Nc_1841)) in
                                                                {1570}out(c, (pkCli_1631,enc(m1_1842,pkSess_1837),sign(m1_1842,skCli_1630)));
                                                                {1571}in(c, (ePartS_1843: bitstring,sigPartS_1844: bitstring));
                                                                {1572}let (=Cli,PartS_1845: bitstring) = dec(ePartS_1843,skCli_1630) in
                                                                {1573}if (verify((Cli,PartS_1845),sigPartS_1844,pkSess_1837) <> true) then
                                                                    0
                                                                else
                                                                    {1574}let Kcli_1846: bitstring = exp(PartS_1845,Nc_1841) in
                                                                    {1575}out(c, senc(mCli(pkCli_1631,pkSess_1837),Kcli_1846))
                                                    )
                                                    else
                                                        {1576}let pkSess_1847: bitstring = fail-any in
                                                        {1577}out(c, GetEndpointRequest);
                                                        {1578}in(c, (SPs_1848: bitstring,=SignAndEncrypt,UP_1849: bitstring,=pkSess_1847));
                                                        {1579}new SPc_1850: bitstring;
                                                        {1580}new Nc_1851: bitstring;
                                                        {1581}let m1_1852: bitstring = (Sess,SPc_1850,exp(g,Nc_1851)) in
                                                        {1582}out(c, (pkCli_1631,enc(m1_1852,pkSess_1847),sign(m1_1852,skCli_1630)));
                                                        {1583}in(c, (ePartS_1853: bitstring,sigPartS_1854: bitstring));
                                                        {1584}let (=Cli,PartS_1855: bitstring) = dec(ePartS_1853,skCli_1630) in
                                                        {1585}if (verify((Cli,PartS_1855),sigPartS_1854,pkSess_1847) <> true) then
                                                            0
                                                        else
                                                            {1586}let Kcli_1856: bitstring = exp(PartS_1855,Nc_1851) in
                                                            {1587}out(c, senc(mCli(pkCli_1631,pkSess_1847),Kcli_1856))
                                                )
                                                else
                                                    {1588}let pkDisco_1857: bitstring = pub(skI) in
                                                    {1589}let v_1858: bool = (Sess = A) in
                                                    (
                                                        {1590}if v_1858 then
                                                        (
                                                            {1591}let pkSess_1859: bitstring = pub(skA) in
                                                            {1592}out(c, GetEndpointRequest);
                                                            {1593}in(c, (SPs_1860: bitstring,=SignAndEncrypt,UP_1861: bitstring,=pkSess_1859));
                                                            {1594}new SPc_1862: bitstring;
                                                            {1595}new Nc_1863: bitstring;
                                                            {1596}let m1_1864: bitstring = (Sess,SPc_1862,exp(g,Nc_1863)) in
                                                            {1597}out(c, (pkCli_1631,enc(m1_1864,pkSess_1859),sign(m1_1864,skCli_1630)));
                                                            {1598}in(c, (ePartS_1865: bitstring,sigPartS_1866: bitstring));
                                                            {1599}let (=Cli,PartS_1867: bitstring) = dec(ePartS_1865,skCli_1630) in
                                                            {1600}if (verify((Cli,PartS_1867),sigPartS_1866,pkSess_1859) <> true) then
                                                                0
                                                            else
                                                                {1601}let Kcli_1868: bitstring = exp(PartS_1867,Nc_1863) in
                                                                {1602}out(c, senc(mCli(pkCli_1631,pkSess_1859),Kcli_1868))
                                                        )
                                                        else
                                                            {1603}let v_1869: bool = (Sess = B) in
                                                            (
                                                                {1604}if v_1869 then
                                                                (
                                                                    {1605}let pkSess_1870: bitstring = pub(skB) in
                                                                    {1606}out(c, GetEndpointRequest);
                                                                    {1607}in(c, (SPs_1871: bitstring,=SignAndEncrypt,UP_1872: bitstring,=pkSess_1870));
                                                                    {1608}new SPc_1873: bitstring;
                                                                    {1609}new Nc_1874: bitstring;
                                                                    {1610}let m1_1875: bitstring = (Sess,SPc_1873,exp(g,Nc_1874)) in
                                                                    {1611}out(c, (pkCli_1631,enc(m1_1875,pkSess_1870),sign(m1_1875,skCli_1630)));
                                                                    {1612}in(c, (ePartS_1876: bitstring,sigPartS_1877: bitstring));
                                                                    {1613}let (=Cli,PartS_1878: bitstring) = dec(ePartS_1876,skCli_1630) in
                                                                    {1614}if (verify((Cli,PartS_1878),sigPartS_1877,pkSess_1870) <> true) then
                                                                        0
                                                                    else
                                                                        {1615}let Kcli_1879: bitstring = exp(PartS_1878,Nc_1874) in
                                                                        {1616}out(c, senc(mCli(pkCli_1631,pkSess_1870),Kcli_1879))
                                                                )
                                                                else
                                                                    {1617}let v_1880: bool = (Sess = C) in
                                                                    (
                                                                        {1618}if v_1880 then
                                                                        (
                                                                            {1619}let pkSess_1881: bitstring = pub(skC) in
                                                                            {1620}out(c, GetEndpointRequest);
                                                                            {1621}in(c, (SPs_1882: bitstring,=SignAndEncrypt,UP_1883: bitstring,=pkSess_1881));
                                                                            {1622}new SPc_1884: bitstring;
                                                                            {1623}new Nc_1885: bitstring;
                                                                            {1624}let m1_1886: bitstring = (Sess,SPc_1884,exp(g,Nc_1885)) in
                                                                            {1625}out(c, (pkCli_1631,enc(m1_1886,pkSess_1881),sign(m1_1886,skCli_1630)));
                                                                            {1626}in(c, (ePartS_1887: bitstring,sigPartS_1888: bitstring));
                                                                            {1627}let (=Cli,PartS_1889: bitstring) = dec(ePartS_1887,skCli_1630) in
                                                                            {1628}if (verify((Cli,PartS_1889),sigPartS_1888,pkSess_1881) <> true) then
                                                                                0
                                                                            else
                                                                                {1629}let Kcli_1890: bitstring = exp(PartS_1889,Nc_1885) in
                                                                                {1630}out(c, senc(mCli(pkCli_1631,pkSess_1881),Kcli_1890))
                                                                        )
                                                                        else
                                                                            {1631}let pkSess_1891: bitstring = pub(skI) in
                                                                            {1632}out(c, GetEndpointRequest);
                                                                            {1633}in(c, (SPs_1892: bitstring,=SignAndEncrypt,UP_1893: bitstring,=pkSess_1891));
                                                                            {1634}new SPc_1894: bitstring;
                                                                            {1635}new Nc_1895: bitstring;
                                                                            {1636}let m1_1896: bitstring = (Sess,SPc_1894,exp(g,Nc_1895)) in
                                                                            {1637}out(c, (pkCli_1631,enc(m1_1896,pkSess_1891),sign(m1_1896,skCli_1630)));
                                                                            {1638}in(c, (ePartS_1897: bitstring,sigPartS_1898: bitstring));
                                                                            {1639}let (=Cli,PartS_1899: bitstring) = dec(ePartS_1897,skCli_1630) in
                                                                            {1640}if (verify((Cli,PartS_1899),sigPartS_1898,pkSess_1891) <> true) then
                                                                                0
                                                                            else
                                                                                {1641}let Kcli_1900: bitstring = exp(PartS_1899,Nc_1895) in
                                                                                {1642}out(c, senc(mCli(pkCli_1631,pkSess_1891),Kcli_1900))
                                                                    )
                                                                    else
                                                                        {1643}let pkSess_1901: bitstring = fail-any in
                                                                        {1644}out(c, GetEndpointRequest);
                                                                        {1645}in(c, (SPs_1902: bitstring,=SignAndEncrypt,UP_1903: bitstring,=pkSess_1901));
                                                                        {1646}new SPc_1904: bitstring;
                                                                        {1647}new Nc_1905: bitstring;
                                                                        {1648}let m1_1906: bitstring = (Sess,SPc_1904,exp(g,Nc_1905)) in
                                                                        {1649}out(c, (pkCli_1631,enc(m1_1906,pkSess_1901),sign(m1_1906,skCli_1630)));
                                                                        {1650}in(c, (ePartS_1907: bitstring,sigPartS_1908: bitstring));
                                                                        {1651}let (=Cli,PartS_1909: bitstring) = dec(ePartS_1907,skCli_1630) in
                                                                        {1652}if (verify((Cli,PartS_1909),sigPartS_1908,pkSess_1901) <> true) then
                                                                            0
                                                                        else
                                                                            {1653}let Kcli_1910: bitstring = exp(PartS_1909,Nc_1905) in
                                                                            {1654}out(c, senc(mCli(pkCli_1631,pkSess_1901),Kcli_1910))
                                                            )
                                                            else
                                                                {1655}let pkSess_1911: bitstring = fail-any in
                                                                {1656}out(c, GetEndpointRequest);
                                                                {1657}in(c, (SPs_1912: bitstring,=SignAndEncrypt,UP_1913: bitstring,=pkSess_1911));
                                                                {1658}new SPc_1914: bitstring;
                                                                {1659}new Nc_1915: bitstring;
                                                                {1660}let m1_1916: bitstring = (Sess,SPc_1914,exp(g,Nc_1915)) in
                                                                {1661}out(c, (pkCli_1631,enc(m1_1916,pkSess_1911),sign(m1_1916,skCli_1630)));
                                                                {1662}in(c, (ePartS_1917: bitstring,sigPartS_1918: bitstring));
                                                                {1663}let (=Cli,PartS_1919: bitstring) = dec(ePartS_1917,skCli_1630) in
                                                                {1664}if (verify((Cli,PartS_1919),sigPartS_1918,pkSess_1911) <> true) then
                                                                    0
                                                                else
                                                                    {1665}let Kcli_1920: bitstring = exp(PartS_1919,Nc_1915) in
                                                                    {1666}out(c, senc(mCli(pkCli_1631,pkSess_1911),Kcli_1920))
                                                    )
                                                    else
                                                        {1667}let pkSess_1921: bitstring = fail-any in
                                                        {1668}out(c, GetEndpointRequest);
                                                        {1669}in(c, (SPs_1922: bitstring,=SignAndEncrypt,UP_1923: bitstring,=pkSess_1921));
                                                        {1670}new SPc_1924: bitstring;
                                                        {1671}new Nc_1925: bitstring;
                                                        {1672}let m1_1926: bitstring = (Sess,SPc_1924,exp(g,Nc_1925)) in
                                                        {1673}out(c, (pkCli_1631,enc(m1_1926,pkSess_1921),sign(m1_1926,skCli_1630)));
                                                        {1674}in(c, (ePartS_1927: bitstring,sigPartS_1928: bitstring));
                                                        {1675}let (=Cli,PartS_1929: bitstring) = dec(ePartS_1927,skCli_1630) in
                                                        {1676}if (verify((Cli,PartS_1929),sigPartS_1928,pkSess_1921) <> true) then
                                                            0
                                                        else
                                                            {1677}let Kcli_1930: bitstring = exp(PartS_1929,Nc_1925) in
                                                            {1678}out(c, senc(mCli(pkCli_1631,pkSess_1921),Kcli_1930))
                                            )
                                            else
                                                {1679}let pkDisco_1931: bitstring = fail-any in
                                                {1680}let v_1932: bool = (Sess = A) in
                                                (
                                                    {1681}if v_1932 then
                                                    (
                                                        {1682}let pkSess_1933: bitstring = pub(skA) in
                                                        {1683}out(c, GetEndpointRequest);
                                                        {1684}in(c, (SPs_1934: bitstring,=SignAndEncrypt,UP_1935: bitstring,=pkSess_1933));
                                                        {1685}new SPc_1936: bitstring;
                                                        {1686}new Nc_1937: bitstring;
                                                        {1687}let m1_1938: bitstring = (Sess,SPc_1936,exp(g,Nc_1937)) in
                                                        {1688}out(c, (pkCli_1631,enc(m1_1938,pkSess_1933),sign(m1_1938,skCli_1630)));
                                                        {1689}in(c, (ePartS_1939: bitstring,sigPartS_1940: bitstring));
                                                        {1690}let (=Cli,PartS_1941: bitstring) = dec(ePartS_1939,skCli_1630) in
                                                        {1691}if (verify((Cli,PartS_1941),sigPartS_1940,pkSess_1933) <> true) then
                                                            0
                                                        else
                                                            {1692}let Kcli_1942: bitstring = exp(PartS_1941,Nc_1937) in
                                                            {1693}out(c, senc(mCli(pkCli_1631,pkSess_1933),Kcli_1942))
                                                    )
                                                    else
                                                        {1694}let v_1943: bool = (Sess = B) in
                                                        (
                                                            {1695}if v_1943 then
                                                            (
                                                                {1696}let pkSess_1944: bitstring = pub(skB) in
                                                                {1697}out(c, GetEndpointRequest);
                                                                {1698}in(c, (SPs_1945: bitstring,=SignAndEncrypt,UP_1946: bitstring,=pkSess_1944));
                                                                {1699}new SPc_1947: bitstring;
                                                                {1700}new Nc_1948: bitstring;
                                                                {1701}let m1_1949: bitstring = (Sess,SPc_1947,exp(g,Nc_1948)) in
                                                                {1702}out(c, (pkCli_1631,enc(m1_1949,pkSess_1944),sign(m1_1949,skCli_1630)));
                                                                {1703}in(c, (ePartS_1950: bitstring,sigPartS_1951: bitstring));
                                                                {1704}let (=Cli,PartS_1952: bitstring) = dec(ePartS_1950,skCli_1630) in
                                                                {1705}if (verify((Cli,PartS_1952),sigPartS_1951,pkSess_1944) <> true) then
                                                                    0
                                                                else
                                                                    {1706}let Kcli_1953: bitstring = exp(PartS_1952,Nc_1948) in
                                                                    {1707}out(c, senc(mCli(pkCli_1631,pkSess_1944),Kcli_1953))
                                                            )
                                                            else
                                                                {1708}let v_1954: bool = (Sess = C) in
                                                                (
                                                                    {1709}if v_1954 then
                                                                    (
                                                                        {1710}let pkSess_1955: bitstring = pub(skC) in
                                                                        {1711}out(c, GetEndpointRequest);
                                                                        {1712}in(c, (SPs_1956: bitstring,=SignAndEncrypt,UP_1957: bitstring,=pkSess_1955));
                                                                        {1713}new SPc_1958: bitstring;
                                                                        {1714}new Nc_1959: bitstring;
                                                                        {1715}let m1_1960: bitstring = (Sess,SPc_1958,exp(g,Nc_1959)) in
                                                                        {1716}out(c, (pkCli_1631,enc(m1_1960,pkSess_1955),sign(m1_1960,skCli_1630)));
                                                                        {1717}in(c, (ePartS_1961: bitstring,sigPartS_1962: bitstring));
                                                                        {1718}let (=Cli,PartS_1963: bitstring) = dec(ePartS_1961,skCli_1630) in
                                                                        {1719}if (verify((Cli,PartS_1963),sigPartS_1962,pkSess_1955) <> true) then
                                                                            0
                                                                        else
                                                                            {1720}let Kcli_1964: bitstring = exp(PartS_1963,Nc_1959) in
                                                                            {1721}out(c, senc(mCli(pkCli_1631,pkSess_1955),Kcli_1964))
                                                                    )
                                                                    else
                                                                        {1722}let pkSess_1965: bitstring = pub(skI) in
                                                                        {1723}out(c, GetEndpointRequest);
                                                                        {1724}in(c, (SPs_1966: bitstring,=SignAndEncrypt,UP_1967: bitstring,=pkSess_1965));
                                                                        {1725}new SPc_1968: bitstring;
                                                                        {1726}new Nc_1969: bitstring;
                                                                        {1727}let m1_1970: bitstring = (Sess,SPc_1968,exp(g,Nc_1969)) in
                                                                        {1728}out(c, (pkCli_1631,enc(m1_1970,pkSess_1965),sign(m1_1970,skCli_1630)));
                                                                        {1729}in(c, (ePartS_1971: bitstring,sigPartS_1972: bitstring));
                                                                        {1730}let (=Cli,PartS_1973: bitstring) = dec(ePartS_1971,skCli_1630) in
                                                                        {1731}if (verify((Cli,PartS_1973),sigPartS_1972,pkSess_1965) <> true) then
                                                                            0
                                                                        else
                                                                            {1732}let Kcli_1974: bitstring = exp(PartS_1973,Nc_1969) in
                                                                            {1733}out(c, senc(mCli(pkCli_1631,pkSess_1965),Kcli_1974))
                                                                )
                                                                else
                                                                    {1734}let pkSess_1975: bitstring = fail-any in
                                                                    {1735}out(c, GetEndpointRequest);
                                                                    {1736}in(c, (SPs_1976: bitstring,=SignAndEncrypt,UP_1977: bitstring,=pkSess_1975));
                                                                    {1737}new SPc_1978: bitstring;
                                                                    {1738}new Nc_1979: bitstring;
                                                                    {1739}let m1_1980: bitstring = (Sess,SPc_1978,exp(g,Nc_1979)) in
                                                                    {1740}out(c, (pkCli_1631,enc(m1_1980,pkSess_1975),sign(m1_1980,skCli_1630)));
                                                                    {1741}in(c, (ePartS_1981: bitstring,sigPartS_1982: bitstring));
                                                                    {1742}let (=Cli,PartS_1983: bitstring) = dec(ePartS_1981,skCli_1630) in
                                                                    {1743}if (verify((Cli,PartS_1983),sigPartS_1982,pkSess_1975) <> true) then
                                                                        0
                                                                    else
                                                                        {1744}let Kcli_1984: bitstring = exp(PartS_1983,Nc_1979) in
                                                                        {1745}out(c, senc(mCli(pkCli_1631,pkSess_1975),Kcli_1984))
                                                        )
                                                        else
                                                            {1746}let pkSess_1985: bitstring = fail-any in
                                                            {1747}out(c, GetEndpointRequest);
                                                            {1748}in(c, (SPs_1986: bitstring,=SignAndEncrypt,UP_1987: bitstring,=pkSess_1985));
                                                            {1749}new SPc_1988: bitstring;
                                                            {1750}new Nc_1989: bitstring;
                                                            {1751}let m1_1990: bitstring = (Sess,SPc_1988,exp(g,Nc_1989)) in
                                                            {1752}out(c, (pkCli_1631,enc(m1_1990,pkSess_1985),sign(m1_1990,skCli_1630)));
                                                            {1753}in(c, (ePartS_1991: bitstring,sigPartS_1992: bitstring));
                                                            {1754}let (=Cli,PartS_1993: bitstring) = dec(ePartS_1991,skCli_1630) in
                                                            {1755}if (verify((Cli,PartS_1993),sigPartS_1992,pkSess_1985) <> true) then
                                                                0
                                                            else
                                                                {1756}let Kcli_1994: bitstring = exp(PartS_1993,Nc_1989) in
                                                                {1757}out(c, senc(mCli(pkCli_1631,pkSess_1985),Kcli_1994))
                                                )
                                                else
                                                    {1758}let pkSess_1995: bitstring = fail-any in
                                                    {1759}out(c, GetEndpointRequest);
                                                    {1760}in(c, (SPs_1996: bitstring,=SignAndEncrypt,UP_1997: bitstring,=pkSess_1995));
                                                    {1761}new SPc_1998: bitstring;
                                                    {1762}new Nc_1999: bitstring;
                                                    {1763}let m1_2000: bitstring = (Sess,SPc_1998,exp(g,Nc_1999)) in
                                                    {1764}out(c, (pkCli_1631,enc(m1_2000,pkSess_1995),sign(m1_2000,skCli_1630)));
                                                    {1765}in(c, (ePartS_2001: bitstring,sigPartS_2002: bitstring));
                                                    {1766}let (=Cli,PartS_2003: bitstring) = dec(ePartS_2001,skCli_1630) in
                                                    {1767}if (verify((Cli,PartS_2003),sigPartS_2002,pkSess_1995) <> true) then
                                                        0
                                                    else
                                                        {1768}let Kcli_2004: bitstring = exp(PartS_2003,Nc_1999) in
                                                        {1769}out(c, senc(mCli(pkCli_1631,pkSess_1995),Kcli_2004))
                                    )
                                    else
                                        {1770}let pkDisco_2005: bitstring = fail-any in
                                        {1771}let v_2006: bool = (Sess = A) in
                                        (
                                            {1772}if v_2006 then
                                            (
                                                {1773}let pkSess_2007: bitstring = pub(skA) in
                                                {1774}out(c, GetEndpointRequest);
                                                {1775}in(c, (SPs_2008: bitstring,=SignAndEncrypt,UP_2009: bitstring,=pkSess_2007));
                                                {1776}new SPc_2010: bitstring;
                                                {1777}new Nc_2011: bitstring;
                                                {1778}let m1_2012: bitstring = (Sess,SPc_2010,exp(g,Nc_2011)) in
                                                {1779}out(c, (pkCli_1631,enc(m1_2012,pkSess_2007),sign(m1_2012,skCli_1630)));
                                                {1780}in(c, (ePartS_2013: bitstring,sigPartS_2014: bitstring));
                                                {1781}let (=Cli,PartS_2015: bitstring) = dec(ePartS_2013,skCli_1630) in
                                                {1782}if (verify((Cli,PartS_2015),sigPartS_2014,pkSess_2007) <> true) then
                                                    0
                                                else
                                                    {1783}let Kcli_2016: bitstring = exp(PartS_2015,Nc_2011) in
                                                    {1784}out(c, senc(mCli(pkCli_1631,pkSess_2007),Kcli_2016))
                                            )
                                            else
                                                {1785}let v_2017: bool = (Sess = B) in
                                                (
                                                    {1786}if v_2017 then
                                                    (
                                                        {1787}let pkSess_2018: bitstring = pub(skB) in
                                                        {1788}out(c, GetEndpointRequest);
                                                        {1789}in(c, (SPs_2019: bitstring,=SignAndEncrypt,UP_2020: bitstring,=pkSess_2018));
                                                        {1790}new SPc_2021: bitstring;
                                                        {1791}new Nc_2022: bitstring;
                                                        {1792}let m1_2023: bitstring = (Sess,SPc_2021,exp(g,Nc_2022)) in
                                                        {1793}out(c, (pkCli_1631,enc(m1_2023,pkSess_2018),sign(m1_2023,skCli_1630)));
                                                        {1794}in(c, (ePartS_2024: bitstring,sigPartS_2025: bitstring));
                                                        {1795}let (=Cli,PartS_2026: bitstring) = dec(ePartS_2024,skCli_1630) in
                                                        {1796}if (verify((Cli,PartS_2026),sigPartS_2025,pkSess_2018) <> true) then
                                                            0
                                                        else
                                                            {1797}let Kcli_2027: bitstring = exp(PartS_2026,Nc_2022) in
                                                            {1798}out(c, senc(mCli(pkCli_1631,pkSess_2018),Kcli_2027))
                                                    )
                                                    else
                                                        {1799}let v_2028: bool = (Sess = C) in
                                                        (
                                                            {1800}if v_2028 then
                                                            (
                                                                {1801}let pkSess_2029: bitstring = pub(skC) in
                                                                {1802}out(c, GetEndpointRequest);
                                                                {1803}in(c, (SPs_2030: bitstring,=SignAndEncrypt,UP_2031: bitstring,=pkSess_2029));
                                                                {1804}new SPc_2032: bitstring;
                                                                {1805}new Nc_2033: bitstring;
                                                                {1806}let m1_2034: bitstring = (Sess,SPc_2032,exp(g,Nc_2033)) in
                                                                {1807}out(c, (pkCli_1631,enc(m1_2034,pkSess_2029),sign(m1_2034,skCli_1630)));
                                                                {1808}in(c, (ePartS_2035: bitstring,sigPartS_2036: bitstring));
                                                                {1809}let (=Cli,PartS_2037: bitstring) = dec(ePartS_2035,skCli_1630) in
                                                                {1810}if (verify((Cli,PartS_2037),sigPartS_2036,pkSess_2029) <> true) then
                                                                    0
                                                                else
                                                                    {1811}let Kcli_2038: bitstring = exp(PartS_2037,Nc_2033) in
                                                                    {1812}out(c, senc(mCli(pkCli_1631,pkSess_2029),Kcli_2038))
                                                            )
                                                            else
                                                                {1813}let pkSess_2039: bitstring = pub(skI) in
                                                                {1814}out(c, GetEndpointRequest);
                                                                {1815}in(c, (SPs_2040: bitstring,=SignAndEncrypt,UP_2041: bitstring,=pkSess_2039));
                                                                {1816}new SPc_2042: bitstring;
                                                                {1817}new Nc_2043: bitstring;
                                                                {1818}let m1_2044: bitstring = (Sess,SPc_2042,exp(g,Nc_2043)) in
                                                                {1819}out(c, (pkCli_1631,enc(m1_2044,pkSess_2039),sign(m1_2044,skCli_1630)));
                                                                {1820}in(c, (ePartS_2045: bitstring,sigPartS_2046: bitstring));
                                                                {1821}let (=Cli,PartS_2047: bitstring) = dec(ePartS_2045,skCli_1630) in
                                                                {1822}if (verify((Cli,PartS_2047),sigPartS_2046,pkSess_2039) <> true) then
                                                                    0
                                                                else
                                                                    {1823}let Kcli_2048: bitstring = exp(PartS_2047,Nc_2043) in
                                                                    {1824}out(c, senc(mCli(pkCli_1631,pkSess_2039),Kcli_2048))
                                                        )
                                                        else
                                                            {1825}let pkSess_2049: bitstring = fail-any in
                                                            {1826}out(c, GetEndpointRequest);
                                                            {1827}in(c, (SPs_2050: bitstring,=SignAndEncrypt,UP_2051: bitstring,=pkSess_2049));
                                                            {1828}new SPc_2052: bitstring;
                                                            {1829}new Nc_2053: bitstring;
                                                            {1830}let m1_2054: bitstring = (Sess,SPc_2052,exp(g,Nc_2053)) in
                                                            {1831}out(c, (pkCli_1631,enc(m1_2054,pkSess_2049),sign(m1_2054,skCli_1630)));
                                                            {1832}in(c, (ePartS_2055: bitstring,sigPartS_2056: bitstring));
                                                            {1833}let (=Cli,PartS_2057: bitstring) = dec(ePartS_2055,skCli_1630) in
                                                            {1834}if (verify((Cli,PartS_2057),sigPartS_2056,pkSess_2049) <> true) then
                                                                0
                                                            else
                                                                {1835}let Kcli_2058: bitstring = exp(PartS_2057,Nc_2053) in
                                                                {1836}out(c, senc(mCli(pkCli_1631,pkSess_2049),Kcli_2058))
                                                )
                                                else
                                                    {1837}let pkSess_2059: bitstring = fail-any in
                                                    {1838}out(c, GetEndpointRequest);
                                                    {1839}in(c, (SPs_2060: bitstring,=SignAndEncrypt,UP_2061: bitstring,=pkSess_2059));
                                                    {1840}new SPc_2062: bitstring;
                                                    {1841}new Nc_2063: bitstring;
                                                    {1842}let m1_2064: bitstring = (Sess,SPc_2062,exp(g,Nc_2063)) in
                                                    {1843}out(c, (pkCli_1631,enc(m1_2064,pkSess_2059),sign(m1_2064,skCli_1630)));
                                                    {1844}in(c, (ePartS_2065: bitstring,sigPartS_2066: bitstring));
                                                    {1845}let (=Cli,PartS_2067: bitstring) = dec(ePartS_2065,skCli_1630) in
                                                    {1846}if (verify((Cli,PartS_2067),sigPartS_2066,pkSess_2059) <> true) then
                                                        0
                                                    else
                                                        {1847}let Kcli_2068: bitstring = exp(PartS_2067,Nc_2063) in
                                                        {1848}out(c, senc(mCli(pkCli_1631,pkSess_2059),Kcli_2068))
                                        )
                                        else
                                            {1849}let pkSess_2069: bitstring = fail-any in
                                            {1850}out(c, GetEndpointRequest);
                                            {1851}in(c, (SPs_2070: bitstring,=SignAndEncrypt,UP_2071: bitstring,=pkSess_2069));
                                            {1852}new SPc_2072: bitstring;
                                            {1853}new Nc_2073: bitstring;
                                            {1854}let m1_2074: bitstring = (Sess,SPc_2072,exp(g,Nc_2073)) in
                                            {1855}out(c, (pkCli_1631,enc(m1_2074,pkSess_2069),sign(m1_2074,skCli_1630)));
                                            {1856}in(c, (ePartS_2075: bitstring,sigPartS_2076: bitstring));
                                            {1857}let (=Cli,PartS_2077: bitstring) = dec(ePartS_2075,skCli_1630) in
                                            {1858}if (verify((Cli,PartS_2077),sigPartS_2076,pkSess_2069) <> true) then
                                                0
                                            else
                                                {1859}let Kcli_2078: bitstring = exp(PartS_2077,Nc_2073) in
                                                {1860}out(c, senc(mCli(pkCli_1631,pkSess_2069),Kcli_2078))
                            )
                            else
                                {1861}let pkDisco_2079: bitstring = fail-any in
                                {1862}let v_2080: bool = (Sess = A) in
                                (
                                    {1863}if v_2080 then
                                    (
                                        {1864}let pkSess_2081: bitstring = pub(skA) in
                                        {1865}out(c, GetEndpointRequest);
                                        {1866}in(c, (SPs_2082: bitstring,=SignAndEncrypt,UP_2083: bitstring,=pkSess_2081));
                                        {1867}new SPc_2084: bitstring;
                                        {1868}new Nc_2085: bitstring;
                                        {1869}let m1_2086: bitstring = (Sess,SPc_2084,exp(g,Nc_2085)) in
                                        {1870}out(c, (pkCli_1631,enc(m1_2086,pkSess_2081),sign(m1_2086,skCli_1630)));
                                        {1871}in(c, (ePartS_2087: bitstring,sigPartS_2088: bitstring));
                                        {1872}let (=Cli,PartS_2089: bitstring) = dec(ePartS_2087,skCli_1630) in
                                        {1873}if (verify((Cli,PartS_2089),sigPartS_2088,pkSess_2081) <> true) then
                                            0
                                        else
                                            {1874}let Kcli_2090: bitstring = exp(PartS_2089,Nc_2085) in
                                            {1875}out(c, senc(mCli(pkCli_1631,pkSess_2081),Kcli_2090))
                                    )
                                    else
                                        {1876}let v_2091: bool = (Sess = B) in
                                        (
                                            {1877}if v_2091 then
                                            (
                                                {1878}let pkSess_2092: bitstring = pub(skB) in
                                                {1879}out(c, GetEndpointRequest);
                                                {1880}in(c, (SPs_2093: bitstring,=SignAndEncrypt,UP_2094: bitstring,=pkSess_2092));
                                                {1881}new SPc_2095: bitstring;
                                                {1882}new Nc_2096: bitstring;
                                                {1883}let m1_2097: bitstring = (Sess,SPc_2095,exp(g,Nc_2096)) in
                                                {1884}out(c, (pkCli_1631,enc(m1_2097,pkSess_2092),sign(m1_2097,skCli_1630)));
                                                {1885}in(c, (ePartS_2098: bitstring,sigPartS_2099: bitstring));
                                                {1886}let (=Cli,PartS_2100: bitstring) = dec(ePartS_2098,skCli_1630) in
                                                {1887}if (verify((Cli,PartS_2100),sigPartS_2099,pkSess_2092) <> true) then
                                                    0
                                                else
                                                    {1888}let Kcli_2101: bitstring = exp(PartS_2100,Nc_2096) in
                                                    {1889}out(c, senc(mCli(pkCli_1631,pkSess_2092),Kcli_2101))
                                            )
                                            else
                                                {1890}let v_2102: bool = (Sess = C) in
                                                (
                                                    {1891}if v_2102 then
                                                    (
                                                        {1892}let pkSess_2103: bitstring = pub(skC) in
                                                        {1893}out(c, GetEndpointRequest);
                                                        {1894}in(c, (SPs_2104: bitstring,=SignAndEncrypt,UP_2105: bitstring,=pkSess_2103));
                                                        {1895}new SPc_2106: bitstring;
                                                        {1896}new Nc_2107: bitstring;
                                                        {1897}let m1_2108: bitstring = (Sess,SPc_2106,exp(g,Nc_2107)) in
                                                        {1898}out(c, (pkCli_1631,enc(m1_2108,pkSess_2103),sign(m1_2108,skCli_1630)));
                                                        {1899}in(c, (ePartS_2109: bitstring,sigPartS_2110: bitstring));
                                                        {1900}let (=Cli,PartS_2111: bitstring) = dec(ePartS_2109,skCli_1630) in
                                                        {1901}if (verify((Cli,PartS_2111),sigPartS_2110,pkSess_2103) <> true) then
                                                            0
                                                        else
                                                            {1902}let Kcli_2112: bitstring = exp(PartS_2111,Nc_2107) in
                                                            {1903}out(c, senc(mCli(pkCli_1631,pkSess_2103),Kcli_2112))
                                                    )
                                                    else
                                                        {1904}let pkSess_2113: bitstring = pub(skI) in
                                                        {1905}out(c, GetEndpointRequest);
                                                        {1906}in(c, (SPs_2114: bitstring,=SignAndEncrypt,UP_2115: bitstring,=pkSess_2113));
                                                        {1907}new SPc_2116: bitstring;
                                                        {1908}new Nc_2117: bitstring;
                                                        {1909}let m1_2118: bitstring = (Sess,SPc_2116,exp(g,Nc_2117)) in
                                                        {1910}out(c, (pkCli_1631,enc(m1_2118,pkSess_2113),sign(m1_2118,skCli_1630)));
                                                        {1911}in(c, (ePartS_2119: bitstring,sigPartS_2120: bitstring));
                                                        {1912}let (=Cli,PartS_2121: bitstring) = dec(ePartS_2119,skCli_1630) in
                                                        {1913}if (verify((Cli,PartS_2121),sigPartS_2120,pkSess_2113) <> true) then
                                                            0
                                                        else
                                                            {1914}let Kcli_2122: bitstring = exp(PartS_2121,Nc_2117) in
                                                            {1915}out(c, senc(mCli(pkCli_1631,pkSess_2113),Kcli_2122))
                                                )
                                                else
                                                    {1916}let pkSess_2123: bitstring = fail-any in
                                                    {1917}out(c, GetEndpointRequest);
                                                    {1918}in(c, (SPs_2124: bitstring,=SignAndEncrypt,UP_2125: bitstring,=pkSess_2123));
                                                    {1919}new SPc_2126: bitstring;
                                                    {1920}new Nc_2127: bitstring;
                                                    {1921}let m1_2128: bitstring = (Sess,SPc_2126,exp(g,Nc_2127)) in
                                                    {1922}out(c, (pkCli_1631,enc(m1_2128,pkSess_2123),sign(m1_2128,skCli_1630)));
                                                    {1923}in(c, (ePartS_2129: bitstring,sigPartS_2130: bitstring));
                                                    {1924}let (=Cli,PartS_2131: bitstring) = dec(ePartS_2129,skCli_1630) in
                                                    {1925}if (verify((Cli,PartS_2131),sigPartS_2130,pkSess_2123) <> true) then
                                                        0
                                                    else
                                                        {1926}let Kcli_2132: bitstring = exp(PartS_2131,Nc_2127) in
                                                        {1927}out(c, senc(mCli(pkCli_1631,pkSess_2123),Kcli_2132))
                                        )
                                        else
                                            {1928}let pkSess_2133: bitstring = fail-any in
                                            {1929}out(c, GetEndpointRequest);
                                            {1930}in(c, (SPs_2134: bitstring,=SignAndEncrypt,UP_2135: bitstring,=pkSess_2133));
                                            {1931}new SPc_2136: bitstring;
                                            {1932}new Nc_2137: bitstring;
                                            {1933}let m1_2138: bitstring = (Sess,SPc_2136,exp(g,Nc_2137)) in
                                            {1934}out(c, (pkCli_1631,enc(m1_2138,pkSess_2133),sign(m1_2138,skCli_1630)));
                                            {1935}in(c, (ePartS_2139: bitstring,sigPartS_2140: bitstring));
                                            {1936}let (=Cli,PartS_2141: bitstring) = dec(ePartS_2139,skCli_1630) in
                                            {1937}if (verify((Cli,PartS_2141),sigPartS_2140,pkSess_2133) <> true) then
                                                0
                                            else
                                                {1938}let Kcli_2142: bitstring = exp(PartS_2141,Nc_2137) in
                                                {1939}out(c, senc(mCli(pkCli_1631,pkSess_2133),Kcli_2142))
                                )
                                else
                                    {1940}let pkSess_2143: bitstring = fail-any in
                                    {1941}out(c, GetEndpointRequest);
                                    {1942}in(c, (SPs_2144: bitstring,=SignAndEncrypt,UP_2145: bitstring,=pkSess_2143));
                                    {1943}new SPc_2146: bitstring;
                                    {1944}new Nc_2147: bitstring;
                                    {1945}let m1_2148: bitstring = (Sess,SPc_2146,exp(g,Nc_2147)) in
                                    {1946}out(c, (pkCli_1631,enc(m1_2148,pkSess_2143),sign(m1_2148,skCli_1630)));
                                    {1947}in(c, (ePartS_2149: bitstring,sigPartS_2150: bitstring));
                                    {1948}let (=Cli,PartS_2151: bitstring) = dec(ePartS_2149,skCli_1630) in
                                    {1949}if (verify((Cli,PartS_2151),sigPartS_2150,pkSess_2143) <> true) then
                                        0
                                    else
                                        {1950}let Kcli_2152: bitstring = exp(PartS_2151,Nc_2147) in
                                        {1951}out(c, senc(mCli(pkCli_1631,pkSess_2143),Kcli_2152))
                        )
                        else
                            {1952}let skCli_2153: bitstring = skI in
                            {1953}let pkCli_2154: bitstring = pub(skCli_2153) in
                            {1954}let v_2155: bool = (Disco = A) in
                            (
                                {1955}if v_2155 then
                                (
                                    {1956}let pkDisco_2156: bitstring = pub(skA) in
                                    {1957}let v_2157: bool = (Sess = A) in
                                    (
                                        {1958}if v_2157 then
                                        (
                                            {1959}let pkSess_2158: bitstring = pub(skA) in
                                            {1960}out(c, GetEndpointRequest);
                                            {1961}in(c, (SPs_2159: bitstring,=SignAndEncrypt,UP_2160: bitstring,=pkSess_2158));
                                            {1962}new SPc_2161: bitstring;
                                            {1963}new Nc_2162: bitstring;
                                            {1964}let m1_2163: bitstring = (Sess,SPc_2161,exp(g,Nc_2162)) in
                                            {1965}out(c, (pkCli_2154,enc(m1_2163,pkSess_2158),sign(m1_2163,skCli_2153)));
                                            {1966}in(c, (ePartS_2164: bitstring,sigPartS_2165: bitstring));
                                            {1967}let (=Cli,PartS_2166: bitstring) = dec(ePartS_2164,skCli_2153) in
                                            {1968}if (verify((Cli,PartS_2166),sigPartS_2165,pkSess_2158) <> true) then
                                                0
                                            else
                                                {1969}let Kcli_2167: bitstring = exp(PartS_2166,Nc_2162) in
                                                {1970}out(c, senc(mCli(pkCli_2154,pkSess_2158),Kcli_2167))
                                        )
                                        else
                                            {1971}let v_2168: bool = (Sess = B) in
                                            (
                                                {1972}if v_2168 then
                                                (
                                                    {1973}let pkSess_2169: bitstring = pub(skB) in
                                                    {1974}out(c, GetEndpointRequest);
                                                    {1975}in(c, (SPs_2170: bitstring,=SignAndEncrypt,UP_2171: bitstring,=pkSess_2169));
                                                    {1976}new SPc_2172: bitstring;
                                                    {1977}new Nc_2173: bitstring;
                                                    {1978}let m1_2174: bitstring = (Sess,SPc_2172,exp(g,Nc_2173)) in
                                                    {1979}out(c, (pkCli_2154,enc(m1_2174,pkSess_2169),sign(m1_2174,skCli_2153)));
                                                    {1980}in(c, (ePartS_2175: bitstring,sigPartS_2176: bitstring));
                                                    {1981}let (=Cli,PartS_2177: bitstring) = dec(ePartS_2175,skCli_2153) in
                                                    {1982}if (verify((Cli,PartS_2177),sigPartS_2176,pkSess_2169) <> true) then
                                                        0
                                                    else
                                                        {1983}let Kcli_2178: bitstring = exp(PartS_2177,Nc_2173) in
                                                        {1984}out(c, senc(mCli(pkCli_2154,pkSess_2169),Kcli_2178))
                                                )
                                                else
                                                    {1985}let v_2179: bool = (Sess = C) in
                                                    (
                                                        {1986}if v_2179 then
                                                        (
                                                            {1987}let pkSess_2180: bitstring = pub(skC) in
                                                            {1988}out(c, GetEndpointRequest);
                                                            {1989}in(c, (SPs_2181: bitstring,=SignAndEncrypt,UP_2182: bitstring,=pkSess_2180));
                                                            {1990}new SPc_2183: bitstring;
                                                            {1991}new Nc_2184: bitstring;
                                                            {1992}let m1_2185: bitstring = (Sess,SPc_2183,exp(g,Nc_2184)) in
                                                            {1993}out(c, (pkCli_2154,enc(m1_2185,pkSess_2180),sign(m1_2185,skCli_2153)));
                                                            {1994}in(c, (ePartS_2186: bitstring,sigPartS_2187: bitstring));
                                                            {1995}let (=Cli,PartS_2188: bitstring) = dec(ePartS_2186,skCli_2153) in
                                                            {1996}if (verify((Cli,PartS_2188),sigPartS_2187,pkSess_2180) <> true) then
                                                                0
                                                            else
                                                                {1997}let Kcli_2189: bitstring = exp(PartS_2188,Nc_2184) in
                                                                {1998}out(c, senc(mCli(pkCli_2154,pkSess_2180),Kcli_2189))
                                                        )
                                                        else
                                                            {1999}let pkSess_2190: bitstring = pub(skI) in
                                                            {2000}out(c, GetEndpointRequest);
                                                            {2001}in(c, (SPs_2191: bitstring,=SignAndEncrypt,UP_2192: bitstring,=pkSess_2190));
                                                            {2002}new SPc_2193: bitstring;
                                                            {2003}new Nc_2194: bitstring;
                                                            {2004}let m1_2195: bitstring = (Sess,SPc_2193,exp(g,Nc_2194)) in
                                                            {2005}out(c, (pkCli_2154,enc(m1_2195,pkSess_2190),sign(m1_2195,skCli_2153)));
                                                            {2006}in(c, (ePartS_2196: bitstring,sigPartS_2197: bitstring));
                                                            {2007}let (=Cli,PartS_2198: bitstring) = dec(ePartS_2196,skCli_2153) in
                                                            {2008}if (verify((Cli,PartS_2198),sigPartS_2197,pkSess_2190) <> true) then
                                                                0
                                                            else
                                                                {2009}let Kcli_2199: bitstring = exp(PartS_2198,Nc_2194) in
                                                                {2010}out(c, senc(mCli(pkCli_2154,pkSess_2190),Kcli_2199))
                                                    )
                                                    else
                                                        {2011}let pkSess_2200: bitstring = fail-any in
                                                        {2012}out(c, GetEndpointRequest);
                                                        {2013}in(c, (SPs_2201: bitstring,=SignAndEncrypt,UP_2202: bitstring,=pkSess_2200));
                                                        {2014}new SPc_2203: bitstring;
                                                        {2015}new Nc_2204: bitstring;
                                                        {2016}let m1_2205: bitstring = (Sess,SPc_2203,exp(g,Nc_2204)) in
                                                        {2017}out(c, (pkCli_2154,enc(m1_2205,pkSess_2200),sign(m1_2205,skCli_2153)));
                                                        {2018}in(c, (ePartS_2206: bitstring,sigPartS_2207: bitstring));
                                                        {2019}let (=Cli,PartS_2208: bitstring) = dec(ePartS_2206,skCli_2153) in
                                                        {2020}if (verify((Cli,PartS_2208),sigPartS_2207,pkSess_2200) <> true) then
                                                            0
                                                        else
                                                            {2021}let Kcli_2209: bitstring = exp(PartS_2208,Nc_2204) in
                                                            {2022}out(c, senc(mCli(pkCli_2154,pkSess_2200),Kcli_2209))
                                            )
                                            else
                                                {2023}let pkSess_2210: bitstring = fail-any in
                                                {2024}out(c, GetEndpointRequest);
                                                {2025}in(c, (SPs_2211: bitstring,=SignAndEncrypt,UP_2212: bitstring,=pkSess_2210));
                                                {2026}new SPc_2213: bitstring;
                                                {2027}new Nc_2214: bitstring;
                                                {2028}let m1_2215: bitstring = (Sess,SPc_2213,exp(g,Nc_2214)) in
                                                {2029}out(c, (pkCli_2154,enc(m1_2215,pkSess_2210),sign(m1_2215,skCli_2153)));
                                                {2030}in(c, (ePartS_2216: bitstring,sigPartS_2217: bitstring));
                                                {2031}let (=Cli,PartS_2218: bitstring) = dec(ePartS_2216,skCli_2153) in
                                                {2032}if (verify((Cli,PartS_2218),sigPartS_2217,pkSess_2210) <> true) then
                                                    0
                                                else
                                                    {2033}let Kcli_2219: bitstring = exp(PartS_2218,Nc_2214) in
                                                    {2034}out(c, senc(mCli(pkCli_2154,pkSess_2210),Kcli_2219))
                                    )
                                    else
                                        {2035}let pkSess_2220: bitstring = fail-any in
                                        {2036}out(c, GetEndpointRequest);
                                        {2037}in(c, (SPs_2221: bitstring,=SignAndEncrypt,UP_2222: bitstring,=pkSess_2220));
                                        {2038}new SPc_2223: bitstring;
                                        {2039}new Nc_2224: bitstring;
                                        {2040}let m1_2225: bitstring = (Sess,SPc_2223,exp(g,Nc_2224)) in
                                        {2041}out(c, (pkCli_2154,enc(m1_2225,pkSess_2220),sign(m1_2225,skCli_2153)));
                                        {2042}in(c, (ePartS_2226: bitstring,sigPartS_2227: bitstring));
                                        {2043}let (=Cli,PartS_2228: bitstring) = dec(ePartS_2226,skCli_2153) in
                                        {2044}if (verify((Cli,PartS_2228),sigPartS_2227,pkSess_2220) <> true) then
                                            0
                                        else
                                            {2045}let Kcli_2229: bitstring = exp(PartS_2228,Nc_2224) in
                                            {2046}out(c, senc(mCli(pkCli_2154,pkSess_2220),Kcli_2229))
                                )
                                else
                                    {2047}let v_2230: bool = (Disco = B) in
                                    (
                                        {2048}if v_2230 then
                                        (
                                            {2049}let pkDisco_2231: bitstring = pub(skB) in
                                            {2050}let v_2232: bool = (Sess = A) in
                                            (
                                                {2051}if v_2232 then
                                                (
                                                    {2052}let pkSess_2233: bitstring = pub(skA) in
                                                    {2053}out(c, GetEndpointRequest);
                                                    {2054}in(c, (SPs_2234: bitstring,=SignAndEncrypt,UP_2235: bitstring,=pkSess_2233));
                                                    {2055}new SPc_2236: bitstring;
                                                    {2056}new Nc_2237: bitstring;
                                                    {2057}let m1_2238: bitstring = (Sess,SPc_2236,exp(g,Nc_2237)) in
                                                    {2058}out(c, (pkCli_2154,enc(m1_2238,pkSess_2233),sign(m1_2238,skCli_2153)));
                                                    {2059}in(c, (ePartS_2239: bitstring,sigPartS_2240: bitstring));
                                                    {2060}let (=Cli,PartS_2241: bitstring) = dec(ePartS_2239,skCli_2153) in
                                                    {2061}if (verify((Cli,PartS_2241),sigPartS_2240,pkSess_2233) <> true) then
                                                        0
                                                    else
                                                        {2062}let Kcli_2242: bitstring = exp(PartS_2241,Nc_2237) in
                                                        {2063}out(c, senc(mCli(pkCli_2154,pkSess_2233),Kcli_2242))
                                                )
                                                else
                                                    {2064}let v_2243: bool = (Sess = B) in
                                                    (
                                                        {2065}if v_2243 then
                                                        (
                                                            {2066}let pkSess_2244: bitstring = pub(skB) in
                                                            {2067}out(c, GetEndpointRequest);
                                                            {2068}in(c, (SPs_2245: bitstring,=SignAndEncrypt,UP_2246: bitstring,=pkSess_2244));
                                                            {2069}new SPc_2247: bitstring;
                                                            {2070}new Nc_2248: bitstring;
                                                            {2071}let m1_2249: bitstring = (Sess,SPc_2247,exp(g,Nc_2248)) in
                                                            {2072}out(c, (pkCli_2154,enc(m1_2249,pkSess_2244),sign(m1_2249,skCli_2153)));
                                                            {2073}in(c, (ePartS_2250: bitstring,sigPartS_2251: bitstring));
                                                            {2074}let (=Cli,PartS_2252: bitstring) = dec(ePartS_2250,skCli_2153) in
                                                            {2075}if (verify((Cli,PartS_2252),sigPartS_2251,pkSess_2244) <> true) then
                                                                0
                                                            else
                                                                {2076}let Kcli_2253: bitstring = exp(PartS_2252,Nc_2248) in
                                                                {2077}out(c, senc(mCli(pkCli_2154,pkSess_2244),Kcli_2253))
                                                        )
                                                        else
                                                            {2078}let v_2254: bool = (Sess = C) in
                                                            (
                                                                {2079}if v_2254 then
                                                                (
                                                                    {2080}let pkSess_2255: bitstring = pub(skC) in
                                                                    {2081}out(c, GetEndpointRequest);
                                                                    {2082}in(c, (SPs_2256: bitstring,=SignAndEncrypt,UP_2257: bitstring,=pkSess_2255));
                                                                    {2083}new SPc_2258: bitstring;
                                                                    {2084}new Nc_2259: bitstring;
                                                                    {2085}let m1_2260: bitstring = (Sess,SPc_2258,exp(g,Nc_2259)) in
                                                                    {2086}out(c, (pkCli_2154,enc(m1_2260,pkSess_2255),sign(m1_2260,skCli_2153)));
                                                                    {2087}in(c, (ePartS_2261: bitstring,sigPartS_2262: bitstring));
                                                                    {2088}let (=Cli,PartS_2263: bitstring) = dec(ePartS_2261,skCli_2153) in
                                                                    {2089}if (verify((Cli,PartS_2263),sigPartS_2262,pkSess_2255) <> true) then
                                                                        0
                                                                    else
                                                                        {2090}let Kcli_2264: bitstring = exp(PartS_2263,Nc_2259) in
                                                                        {2091}out(c, senc(mCli(pkCli_2154,pkSess_2255),Kcli_2264))
                                                                )
                                                                else
                                                                    {2092}let pkSess_2265: bitstring = pub(skI) in
                                                                    {2093}out(c, GetEndpointRequest);
                                                                    {2094}in(c, (SPs_2266: bitstring,=SignAndEncrypt,UP_2267: bitstring,=pkSess_2265));
                                                                    {2095}new SPc_2268: bitstring;
                                                                    {2096}new Nc_2269: bitstring;
                                                                    {2097}let m1_2270: bitstring = (Sess,SPc_2268,exp(g,Nc_2269)) in
                                                                    {2098}out(c, (pkCli_2154,enc(m1_2270,pkSess_2265),sign(m1_2270,skCli_2153)));
                                                                    {2099}in(c, (ePartS_2271: bitstring,sigPartS_2272: bitstring));
                                                                    {2100}let (=Cli,PartS_2273: bitstring) = dec(ePartS_2271,skCli_2153) in
                                                                    {2101}if (verify((Cli,PartS_2273),sigPartS_2272,pkSess_2265) <> true) then
                                                                        0
                                                                    else
                                                                        {2102}let Kcli_2274: bitstring = exp(PartS_2273,Nc_2269) in
                                                                        {2103}out(c, senc(mCli(pkCli_2154,pkSess_2265),Kcli_2274))
                                                            )
                                                            else
                                                                {2104}let pkSess_2275: bitstring = fail-any in
                                                                {2105}out(c, GetEndpointRequest);
                                                                {2106}in(c, (SPs_2276: bitstring,=SignAndEncrypt,UP_2277: bitstring,=pkSess_2275));
                                                                {2107}new SPc_2278: bitstring;
                                                                {2108}new Nc_2279: bitstring;
                                                                {2109}let m1_2280: bitstring = (Sess,SPc_2278,exp(g,Nc_2279)) in
                                                                {2110}out(c, (pkCli_2154,enc(m1_2280,pkSess_2275),sign(m1_2280,skCli_2153)));
                                                                {2111}in(c, (ePartS_2281: bitstring,sigPartS_2282: bitstring));
                                                                {2112}let (=Cli,PartS_2283: bitstring) = dec(ePartS_2281,skCli_2153) in
                                                                {2113}if (verify((Cli,PartS_2283),sigPartS_2282,pkSess_2275) <> true) then
                                                                    0
                                                                else
                                                                    {2114}let Kcli_2284: bitstring = exp(PartS_2283,Nc_2279) in
                                                                    {2115}out(c, senc(mCli(pkCli_2154,pkSess_2275),Kcli_2284))
                                                    )
                                                    else
                                                        {2116}let pkSess_2285: bitstring = fail-any in
                                                        {2117}out(c, GetEndpointRequest);
                                                        {2118}in(c, (SPs_2286: bitstring,=SignAndEncrypt,UP_2287: bitstring,=pkSess_2285));
                                                        {2119}new SPc_2288: bitstring;
                                                        {2120}new Nc_2289: bitstring;
                                                        {2121}let m1_2290: bitstring = (Sess,SPc_2288,exp(g,Nc_2289)) in
                                                        {2122}out(c, (pkCli_2154,enc(m1_2290,pkSess_2285),sign(m1_2290,skCli_2153)));
                                                        {2123}in(c, (ePartS_2291: bitstring,sigPartS_2292: bitstring));
                                                        {2124}let (=Cli,PartS_2293: bitstring) = dec(ePartS_2291,skCli_2153) in
                                                        {2125}if (verify((Cli,PartS_2293),sigPartS_2292,pkSess_2285) <> true) then
                                                            0
                                                        else
                                                            {2126}let Kcli_2294: bitstring = exp(PartS_2293,Nc_2289) in
                                                            {2127}out(c, senc(mCli(pkCli_2154,pkSess_2285),Kcli_2294))
                                            )
                                            else
                                                {2128}let pkSess_2295: bitstring = fail-any in
                                                {2129}out(c, GetEndpointRequest);
                                                {2130}in(c, (SPs_2296: bitstring,=SignAndEncrypt,UP_2297: bitstring,=pkSess_2295));
                                                {2131}new SPc_2298: bitstring;
                                                {2132}new Nc_2299: bitstring;
                                                {2133}let m1_2300: bitstring = (Sess,SPc_2298,exp(g,Nc_2299)) in
                                                {2134}out(c, (pkCli_2154,enc(m1_2300,pkSess_2295),sign(m1_2300,skCli_2153)));
                                                {2135}in(c, (ePartS_2301: bitstring,sigPartS_2302: bitstring));
                                                {2136}let (=Cli,PartS_2303: bitstring) = dec(ePartS_2301,skCli_2153) in
                                                {2137}if (verify((Cli,PartS_2303),sigPartS_2302,pkSess_2295) <> true) then
                                                    0
                                                else
                                                    {2138}let Kcli_2304: bitstring = exp(PartS_2303,Nc_2299) in
                                                    {2139}out(c, senc(mCli(pkCli_2154,pkSess_2295),Kcli_2304))
                                        )
                                        else
                                            {2140}let v_2305: bool = (Disco = C) in
                                            (
                                                {2141}if v_2305 then
                                                (
                                                    {2142}let pkDisco_2306: bitstring = pub(skC) in
                                                    {2143}let v_2307: bool = (Sess = A) in
                                                    (
                                                        {2144}if v_2307 then
                                                        (
                                                            {2145}let pkSess_2308: bitstring = pub(skA) in
                                                            {2146}out(c, GetEndpointRequest);
                                                            {2147}in(c, (SPs_2309: bitstring,=SignAndEncrypt,UP_2310: bitstring,=pkSess_2308));
                                                            {2148}new SPc_2311: bitstring;
                                                            {2149}new Nc_2312: bitstring;
                                                            {2150}let m1_2313: bitstring = (Sess,SPc_2311,exp(g,Nc_2312)) in
                                                            {2151}out(c, (pkCli_2154,enc(m1_2313,pkSess_2308),sign(m1_2313,skCli_2153)));
                                                            {2152}in(c, (ePartS_2314: bitstring,sigPartS_2315: bitstring));
                                                            {2153}let (=Cli,PartS_2316: bitstring) = dec(ePartS_2314,skCli_2153) in
                                                            {2154}if (verify((Cli,PartS_2316),sigPartS_2315,pkSess_2308) <> true) then
                                                                0
                                                            else
                                                                {2155}let Kcli_2317: bitstring = exp(PartS_2316,Nc_2312) in
                                                                {2156}out(c, senc(mCli(pkCli_2154,pkSess_2308),Kcli_2317))
                                                        )
                                                        else
                                                            {2157}let v_2318: bool = (Sess = B) in
                                                            (
                                                                {2158}if v_2318 then
                                                                (
                                                                    {2159}let pkSess_2319: bitstring = pub(skB) in
                                                                    {2160}out(c, GetEndpointRequest);
                                                                    {2161}in(c, (SPs_2320: bitstring,=SignAndEncrypt,UP_2321: bitstring,=pkSess_2319));
                                                                    {2162}new SPc_2322: bitstring;
                                                                    {2163}new Nc_2323: bitstring;
                                                                    {2164}let m1_2324: bitstring = (Sess,SPc_2322,exp(g,Nc_2323)) in
                                                                    {2165}out(c, (pkCli_2154,enc(m1_2324,pkSess_2319),sign(m1_2324,skCli_2153)));
                                                                    {2166}in(c, (ePartS_2325: bitstring,sigPartS_2326: bitstring));
                                                                    {2167}let (=Cli,PartS_2327: bitstring) = dec(ePartS_2325,skCli_2153) in
                                                                    {2168}if (verify((Cli,PartS_2327),sigPartS_2326,pkSess_2319) <> true) then
                                                                        0
                                                                    else
                                                                        {2169}let Kcli_2328: bitstring = exp(PartS_2327,Nc_2323) in
                                                                        {2170}out(c, senc(mCli(pkCli_2154,pkSess_2319),Kcli_2328))
                                                                )
                                                                else
                                                                    {2171}let v_2329: bool = (Sess = C) in
                                                                    (
                                                                        {2172}if v_2329 then
                                                                        (
                                                                            {2173}let pkSess_2330: bitstring = pub(skC) in
                                                                            {2174}out(c, GetEndpointRequest);
                                                                            {2175}in(c, (SPs_2331: bitstring,=SignAndEncrypt,UP_2332: bitstring,=pkSess_2330));
                                                                            {2176}new SPc_2333: bitstring;
                                                                            {2177}new Nc_2334: bitstring;
                                                                            {2178}let m1_2335: bitstring = (Sess,SPc_2333,exp(g,Nc_2334)) in
                                                                            {2179}out(c, (pkCli_2154,enc(m1_2335,pkSess_2330),sign(m1_2335,skCli_2153)));
                                                                            {2180}in(c, (ePartS_2336: bitstring,sigPartS_2337: bitstring));
                                                                            {2181}let (=Cli,PartS_2338: bitstring) = dec(ePartS_2336,skCli_2153) in
                                                                            {2182}if (verify((Cli,PartS_2338),sigPartS_2337,pkSess_2330) <> true) then
                                                                                0
                                                                            else
                                                                                {2183}let Kcli_2339: bitstring = exp(PartS_2338,Nc_2334) in
                                                                                {2184}out(c, senc(mCli(pkCli_2154,pkSess_2330),Kcli_2339))
                                                                        )
                                                                        else
                                                                            {2185}let pkSess_2340: bitstring = pub(skI) in
                                                                            {2186}out(c, GetEndpointRequest);
                                                                            {2187}in(c, (SPs_2341: bitstring,=SignAndEncrypt,UP_2342: bitstring,=pkSess_2340));
                                                                            {2188}new SPc_2343: bitstring;
                                                                            {2189}new Nc_2344: bitstring;
                                                                            {2190}let m1_2345: bitstring = (Sess,SPc_2343,exp(g,Nc_2344)) in
                                                                            {2191}out(c, (pkCli_2154,enc(m1_2345,pkSess_2340),sign(m1_2345,skCli_2153)));
                                                                            {2192}in(c, (ePartS_2346: bitstring,sigPartS_2347: bitstring));
                                                                            {2193}let (=Cli,PartS_2348: bitstring) = dec(ePartS_2346,skCli_2153) in
                                                                            {2194}if (verify((Cli,PartS_2348),sigPartS_2347,pkSess_2340) <> true) then
                                                                                0
                                                                            else
                                                                                {2195}let Kcli_2349: bitstring = exp(PartS_2348,Nc_2344) in
                                                                                {2196}out(c, senc(mCli(pkCli_2154,pkSess_2340),Kcli_2349))
                                                                    )
                                                                    else
                                                                        {2197}let pkSess_2350: bitstring = fail-any in
                                                                        {2198}out(c, GetEndpointRequest);
                                                                        {2199}in(c, (SPs_2351: bitstring,=SignAndEncrypt,UP_2352: bitstring,=pkSess_2350));
                                                                        {2200}new SPc_2353: bitstring;
                                                                        {2201}new Nc_2354: bitstring;
                                                                        {2202}let m1_2355: bitstring = (Sess,SPc_2353,exp(g,Nc_2354)) in
                                                                        {2203}out(c, (pkCli_2154,enc(m1_2355,pkSess_2350),sign(m1_2355,skCli_2153)));
                                                                        {2204}in(c, (ePartS_2356: bitstring,sigPartS_2357: bitstring));
                                                                        {2205}let (=Cli,PartS_2358: bitstring) = dec(ePartS_2356,skCli_2153) in
                                                                        {2206}if (verify((Cli,PartS_2358),sigPartS_2357,pkSess_2350) <> true) then
                                                                            0
                                                                        else
                                                                            {2207}let Kcli_2359: bitstring = exp(PartS_2358,Nc_2354) in
                                                                            {2208}out(c, senc(mCli(pkCli_2154,pkSess_2350),Kcli_2359))
                                                            )
                                                            else
                                                                {2209}let pkSess_2360: bitstring = fail-any in
                                                                {2210}out(c, GetEndpointRequest);
                                                                {2211}in(c, (SPs_2361: bitstring,=SignAndEncrypt,UP_2362: bitstring,=pkSess_2360));
                                                                {2212}new SPc_2363: bitstring;
                                                                {2213}new Nc_2364: bitstring;
                                                                {2214}let m1_2365: bitstring = (Sess,SPc_2363,exp(g,Nc_2364)) in
                                                                {2215}out(c, (pkCli_2154,enc(m1_2365,pkSess_2360),sign(m1_2365,skCli_2153)));
                                                                {2216}in(c, (ePartS_2366: bitstring,sigPartS_2367: bitstring));
                                                                {2217}let (=Cli,PartS_2368: bitstring) = dec(ePartS_2366,skCli_2153) in
                                                                {2218}if (verify((Cli,PartS_2368),sigPartS_2367,pkSess_2360) <> true) then
                                                                    0
                                                                else
                                                                    {2219}let Kcli_2369: bitstring = exp(PartS_2368,Nc_2364) in
                                                                    {2220}out(c, senc(mCli(pkCli_2154,pkSess_2360),Kcli_2369))
                                                    )
                                                    else
                                                        {2221}let pkSess_2370: bitstring = fail-any in
                                                        {2222}out(c, GetEndpointRequest);
                                                        {2223}in(c, (SPs_2371: bitstring,=SignAndEncrypt,UP_2372: bitstring,=pkSess_2370));
                                                        {2224}new SPc_2373: bitstring;
                                                        {2225}new Nc_2374: bitstring;
                                                        {2226}let m1_2375: bitstring = (Sess,SPc_2373,exp(g,Nc_2374)) in
                                                        {2227}out(c, (pkCli_2154,enc(m1_2375,pkSess_2370),sign(m1_2375,skCli_2153)));
                                                        {2228}in(c, (ePartS_2376: bitstring,sigPartS_2377: bitstring));
                                                        {2229}let (=Cli,PartS_2378: bitstring) = dec(ePartS_2376,skCli_2153) in
                                                        {2230}if (verify((Cli,PartS_2378),sigPartS_2377,pkSess_2370) <> true) then
                                                            0
                                                        else
                                                            {2231}let Kcli_2379: bitstring = exp(PartS_2378,Nc_2374) in
                                                            {2232}out(c, senc(mCli(pkCli_2154,pkSess_2370),Kcli_2379))
                                                )
                                                else
                                                    {2233}let pkDisco_2380: bitstring = pub(skI) in
                                                    {2234}let v_2381: bool = (Sess = A) in
                                                    (
                                                        {2235}if v_2381 then
                                                        (
                                                            {2236}let pkSess_2382: bitstring = pub(skA) in
                                                            {2237}out(c, GetEndpointRequest);
                                                            {2238}in(c, (SPs_2383: bitstring,=SignAndEncrypt,UP_2384: bitstring,=pkSess_2382));
                                                            {2239}new SPc_2385: bitstring;
                                                            {2240}new Nc_2386: bitstring;
                                                            {2241}let m1_2387: bitstring = (Sess,SPc_2385,exp(g,Nc_2386)) in
                                                            {2242}out(c, (pkCli_2154,enc(m1_2387,pkSess_2382),sign(m1_2387,skCli_2153)));
                                                            {2243}in(c, (ePartS_2388: bitstring,sigPartS_2389: bitstring));
                                                            {2244}let (=Cli,PartS_2390: bitstring) = dec(ePartS_2388,skCli_2153) in
                                                            {2245}if (verify((Cli,PartS_2390),sigPartS_2389,pkSess_2382) <> true) then
                                                                0
                                                            else
                                                                {2246}let Kcli_2391: bitstring = exp(PartS_2390,Nc_2386) in
                                                                {2247}out(c, senc(mCli(pkCli_2154,pkSess_2382),Kcli_2391))
                                                        )
                                                        else
                                                            {2248}let v_2392: bool = (Sess = B) in
                                                            (
                                                                {2249}if v_2392 then
                                                                (
                                                                    {2250}let pkSess_2393: bitstring = pub(skB) in
                                                                    {2251}out(c, GetEndpointRequest);
                                                                    {2252}in(c, (SPs_2394: bitstring,=SignAndEncrypt,UP_2395: bitstring,=pkSess_2393));
                                                                    {2253}new SPc_2396: bitstring;
                                                                    {2254}new Nc_2397: bitstring;
                                                                    {2255}let m1_2398: bitstring = (Sess,SPc_2396,exp(g,Nc_2397)) in
                                                                    {2256}out(c, (pkCli_2154,enc(m1_2398,pkSess_2393),sign(m1_2398,skCli_2153)));
                                                                    {2257}in(c, (ePartS_2399: bitstring,sigPartS_2400: bitstring));
                                                                    {2258}let (=Cli,PartS_2401: bitstring) = dec(ePartS_2399,skCli_2153) in
                                                                    {2259}if (verify((Cli,PartS_2401),sigPartS_2400,pkSess_2393) <> true) then
                                                                        0
                                                                    else
                                                                        {2260}let Kcli_2402: bitstring = exp(PartS_2401,Nc_2397) in
                                                                        {2261}out(c, senc(mCli(pkCli_2154,pkSess_2393),Kcli_2402))
                                                                )
                                                                else
                                                                    {2262}let v_2403: bool = (Sess = C) in
                                                                    (
                                                                        {2263}if v_2403 then
                                                                        (
                                                                            {2264}let pkSess_2404: bitstring = pub(skC) in
                                                                            {2265}out(c, GetEndpointRequest);
                                                                            {2266}in(c, (SPs_2405: bitstring,=SignAndEncrypt,UP_2406: bitstring,=pkSess_2404));
                                                                            {2267}new SPc_2407: bitstring;
                                                                            {2268}new Nc_2408: bitstring;
                                                                            {2269}let m1_2409: bitstring = (Sess,SPc_2407,exp(g,Nc_2408)) in
                                                                            {2270}out(c, (pkCli_2154,enc(m1_2409,pkSess_2404),sign(m1_2409,skCli_2153)));
                                                                            {2271}in(c, (ePartS_2410: bitstring,sigPartS_2411: bitstring));
                                                                            {2272}let (=Cli,PartS_2412: bitstring) = dec(ePartS_2410,skCli_2153) in
                                                                            {2273}if (verify((Cli,PartS_2412),sigPartS_2411,pkSess_2404) <> true) then
                                                                                0
                                                                            else
                                                                                {2274}let Kcli_2413: bitstring = exp(PartS_2412,Nc_2408) in
                                                                                {2275}out(c, senc(mCli(pkCli_2154,pkSess_2404),Kcli_2413))
                                                                        )
                                                                        else
                                                                            {2276}let pkSess_2414: bitstring = pub(skI) in
                                                                            {2277}out(c, GetEndpointRequest);
                                                                            {2278}in(c, (SPs_2415: bitstring,=SignAndEncrypt,UP_2416: bitstring,=pkSess_2414));
                                                                            {2279}new SPc_2417: bitstring;
                                                                            {2280}new Nc_2418: bitstring;
                                                                            {2281}let m1_2419: bitstring = (Sess,SPc_2417,exp(g,Nc_2418)) in
                                                                            {2282}out(c, (pkCli_2154,enc(m1_2419,pkSess_2414),sign(m1_2419,skCli_2153)));
                                                                            {2283}in(c, (ePartS_2420: bitstring,sigPartS_2421: bitstring));
                                                                            {2284}let (=Cli,PartS_2422: bitstring) = dec(ePartS_2420,skCli_2153) in
                                                                            {2285}if (verify((Cli,PartS_2422),sigPartS_2421,pkSess_2414) <> true) then
                                                                                0
                                                                            else
                                                                                {2286}let Kcli_2423: bitstring = exp(PartS_2422,Nc_2418) in
                                                                                {2287}out(c, senc(mCli(pkCli_2154,pkSess_2414),Kcli_2423))
                                                                    )
                                                                    else
                                                                        {2288}let pkSess_2424: bitstring = fail-any in
                                                                        {2289}out(c, GetEndpointRequest);
                                                                        {2290}in(c, (SPs_2425: bitstring,=SignAndEncrypt,UP_2426: bitstring,=pkSess_2424));
                                                                        {2291}new SPc_2427: bitstring;
                                                                        {2292}new Nc_2428: bitstring;
                                                                        {2293}let m1_2429: bitstring = (Sess,SPc_2427,exp(g,Nc_2428)) in
                                                                        {2294}out(c, (pkCli_2154,enc(m1_2429,pkSess_2424),sign(m1_2429,skCli_2153)));
                                                                        {2295}in(c, (ePartS_2430: bitstring,sigPartS_2431: bitstring));
                                                                        {2296}let (=Cli,PartS_2432: bitstring) = dec(ePartS_2430,skCli_2153) in
                                                                        {2297}if (verify((Cli,PartS_2432),sigPartS_2431,pkSess_2424) <> true) then
                                                                            0
                                                                        else
                                                                            {2298}let Kcli_2433: bitstring = exp(PartS_2432,Nc_2428) in
                                                                            {2299}out(c, senc(mCli(pkCli_2154,pkSess_2424),Kcli_2433))
                                                            )
                                                            else
                                                                {2300}let pkSess_2434: bitstring = fail-any in
                                                                {2301}out(c, GetEndpointRequest);
                                                                {2302}in(c, (SPs_2435: bitstring,=SignAndEncrypt,UP_2436: bitstring,=pkSess_2434));
                                                                {2303}new SPc_2437: bitstring;
                                                                {2304}new Nc_2438: bitstring;
                                                                {2305}let m1_2439: bitstring = (Sess,SPc_2437,exp(g,Nc_2438)) in
                                                                {2306}out(c, (pkCli_2154,enc(m1_2439,pkSess_2434),sign(m1_2439,skCli_2153)));
                                                                {2307}in(c, (ePartS_2440: bitstring,sigPartS_2441: bitstring));
                                                                {2308}let (=Cli,PartS_2442: bitstring) = dec(ePartS_2440,skCli_2153) in
                                                                {2309}if (verify((Cli,PartS_2442),sigPartS_2441,pkSess_2434) <> true) then
                                                                    0
                                                                else
                                                                    {2310}let Kcli_2443: bitstring = exp(PartS_2442,Nc_2438) in
                                                                    {2311}out(c, senc(mCli(pkCli_2154,pkSess_2434),Kcli_2443))
                                                    )
                                                    else
                                                        {2312}let pkSess_2444: bitstring = fail-any in
                                                        {2313}out(c, GetEndpointRequest);
                                                        {2314}in(c, (SPs_2445: bitstring,=SignAndEncrypt,UP_2446: bitstring,=pkSess_2444));
                                                        {2315}new SPc_2447: bitstring;
                                                        {2316}new Nc_2448: bitstring;
                                                        {2317}let m1_2449: bitstring = (Sess,SPc_2447,exp(g,Nc_2448)) in
                                                        {2318}out(c, (pkCli_2154,enc(m1_2449,pkSess_2444),sign(m1_2449,skCli_2153)));
                                                        {2319}in(c, (ePartS_2450: bitstring,sigPartS_2451: bitstring));
                                                        {2320}let (=Cli,PartS_2452: bitstring) = dec(ePartS_2450,skCli_2153) in
                                                        {2321}if (verify((Cli,PartS_2452),sigPartS_2451,pkSess_2444) <> true) then
                                                            0
                                                        else
                                                            {2322}let Kcli_2453: bitstring = exp(PartS_2452,Nc_2448) in
                                                            {2323}out(c, senc(mCli(pkCli_2154,pkSess_2444),Kcli_2453))
                                            )
                                            else
                                                {2324}let pkDisco_2454: bitstring = fail-any in
                                                {2325}let v_2455: bool = (Sess = A) in
                                                (
                                                    {2326}if v_2455 then
                                                    (
                                                        {2327}let pkSess_2456: bitstring = pub(skA) in
                                                        {2328}out(c, GetEndpointRequest);
                                                        {2329}in(c, (SPs_2457: bitstring,=SignAndEncrypt,UP_2458: bitstring,=pkSess_2456));
                                                        {2330}new SPc_2459: bitstring;
                                                        {2331}new Nc_2460: bitstring;
                                                        {2332}let m1_2461: bitstring = (Sess,SPc_2459,exp(g,Nc_2460)) in
                                                        {2333}out(c, (pkCli_2154,enc(m1_2461,pkSess_2456),sign(m1_2461,skCli_2153)));
                                                        {2334}in(c, (ePartS_2462: bitstring,sigPartS_2463: bitstring));
                                                        {2335}let (=Cli,PartS_2464: bitstring) = dec(ePartS_2462,skCli_2153) in
                                                        {2336}if (verify((Cli,PartS_2464),sigPartS_2463,pkSess_2456) <> true) then
                                                            0
                                                        else
                                                            {2337}let Kcli_2465: bitstring = exp(PartS_2464,Nc_2460) in
                                                            {2338}out(c, senc(mCli(pkCli_2154,pkSess_2456),Kcli_2465))
                                                    )
                                                    else
                                                        {2339}let v_2466: bool = (Sess = B) in
                                                        (
                                                            {2340}if v_2466 then
                                                            (
                                                                {2341}let pkSess_2467: bitstring = pub(skB) in
                                                                {2342}out(c, GetEndpointRequest);
                                                                {2343}in(c, (SPs_2468: bitstring,=SignAndEncrypt,UP_2469: bitstring,=pkSess_2467));
                                                                {2344}new SPc_2470: bitstring;
                                                                {2345}new Nc_2471: bitstring;
                                                                {2346}let m1_2472: bitstring = (Sess,SPc_2470,exp(g,Nc_2471)) in
                                                                {2347}out(c, (pkCli_2154,enc(m1_2472,pkSess_2467),sign(m1_2472,skCli_2153)));
                                                                {2348}in(c, (ePartS_2473: bitstring,sigPartS_2474: bitstring));
                                                                {2349}let (=Cli,PartS_2475: bitstring) = dec(ePartS_2473,skCli_2153) in
                                                                {2350}if (verify((Cli,PartS_2475),sigPartS_2474,pkSess_2467) <> true) then
                                                                    0
                                                                else
                                                                    {2351}let Kcli_2476: bitstring = exp(PartS_2475,Nc_2471) in
                                                                    {2352}out(c, senc(mCli(pkCli_2154,pkSess_2467),Kcli_2476))
                                                            )
                                                            else
                                                                {2353}let v_2477: bool = (Sess = C) in
                                                                (
                                                                    {2354}if v_2477 then
                                                                    (
                                                                        {2355}let pkSess_2478: bitstring = pub(skC) in
                                                                        {2356}out(c, GetEndpointRequest);
                                                                        {2357}in(c, (SPs_2479: bitstring,=SignAndEncrypt,UP_2480: bitstring,=pkSess_2478));
                                                                        {2358}new SPc_2481: bitstring;
                                                                        {2359}new Nc_2482: bitstring;
                                                                        {2360}let m1_2483: bitstring = (Sess,SPc_2481,exp(g,Nc_2482)) in
                                                                        {2361}out(c, (pkCli_2154,enc(m1_2483,pkSess_2478),sign(m1_2483,skCli_2153)));
                                                                        {2362}in(c, (ePartS_2484: bitstring,sigPartS_2485: bitstring));
                                                                        {2363}let (=Cli,PartS_2486: bitstring) = dec(ePartS_2484,skCli_2153) in
                                                                        {2364}if (verify((Cli,PartS_2486),sigPartS_2485,pkSess_2478) <> true) then
                                                                            0
                                                                        else
                                                                            {2365}let Kcli_2487: bitstring = exp(PartS_2486,Nc_2482) in
                                                                            {2366}out(c, senc(mCli(pkCli_2154,pkSess_2478),Kcli_2487))
                                                                    )
                                                                    else
                                                                        {2367}let pkSess_2488: bitstring = pub(skI) in
                                                                        {2368}out(c, GetEndpointRequest);
                                                                        {2369}in(c, (SPs_2489: bitstring,=SignAndEncrypt,UP_2490: bitstring,=pkSess_2488));
                                                                        {2370}new SPc_2491: bitstring;
                                                                        {2371}new Nc_2492: bitstring;
                                                                        {2372}let m1_2493: bitstring = (Sess,SPc_2491,exp(g,Nc_2492)) in
                                                                        {2373}out(c, (pkCli_2154,enc(m1_2493,pkSess_2488),sign(m1_2493,skCli_2153)));
                                                                        {2374}in(c, (ePartS_2494: bitstring,sigPartS_2495: bitstring));
                                                                        {2375}let (=Cli,PartS_2496: bitstring) = dec(ePartS_2494,skCli_2153) in
                                                                        {2376}if (verify((Cli,PartS_2496),sigPartS_2495,pkSess_2488) <> true) then
                                                                            0
                                                                        else
                                                                            {2377}let Kcli_2497: bitstring = exp(PartS_2496,Nc_2492) in
                                                                            {2378}out(c, senc(mCli(pkCli_2154,pkSess_2488),Kcli_2497))
                                                                )
                                                                else
                                                                    {2379}let pkSess_2498: bitstring = fail-any in
                                                                    {2380}out(c, GetEndpointRequest);
                                                                    {2381}in(c, (SPs_2499: bitstring,=SignAndEncrypt,UP_2500: bitstring,=pkSess_2498));
                                                                    {2382}new SPc_2501: bitstring;
                                                                    {2383}new Nc_2502: bitstring;
                                                                    {2384}let m1_2503: bitstring = (Sess,SPc_2501,exp(g,Nc_2502)) in
                                                                    {2385}out(c, (pkCli_2154,enc(m1_2503,pkSess_2498),sign(m1_2503,skCli_2153)));
                                                                    {2386}in(c, (ePartS_2504: bitstring,sigPartS_2505: bitstring));
                                                                    {2387}let (=Cli,PartS_2506: bitstring) = dec(ePartS_2504,skCli_2153) in
                                                                    {2388}if (verify((Cli,PartS_2506),sigPartS_2505,pkSess_2498) <> true) then
                                                                        0
                                                                    else
                                                                        {2389}let Kcli_2507: bitstring = exp(PartS_2506,Nc_2502) in
                                                                        {2390}out(c, senc(mCli(pkCli_2154,pkSess_2498),Kcli_2507))
                                                        )
                                                        else
                                                            {2391}let pkSess_2508: bitstring = fail-any in
                                                            {2392}out(c, GetEndpointRequest);
                                                            {2393}in(c, (SPs_2509: bitstring,=SignAndEncrypt,UP_2510: bitstring,=pkSess_2508));
                                                            {2394}new SPc_2511: bitstring;
                                                            {2395}new Nc_2512: bitstring;
                                                            {2396}let m1_2513: bitstring = (Sess,SPc_2511,exp(g,Nc_2512)) in
                                                            {2397}out(c, (pkCli_2154,enc(m1_2513,pkSess_2508),sign(m1_2513,skCli_2153)));
                                                            {2398}in(c, (ePartS_2514: bitstring,sigPartS_2515: bitstring));
                                                            {2399}let (=Cli,PartS_2516: bitstring) = dec(ePartS_2514,skCli_2153) in
                                                            {2400}if (verify((Cli,PartS_2516),sigPartS_2515,pkSess_2508) <> true) then
                                                                0
                                                            else
                                                                {2401}let Kcli_2517: bitstring = exp(PartS_2516,Nc_2512) in
                                                                {2402}out(c, senc(mCli(pkCli_2154,pkSess_2508),Kcli_2517))
                                                )
                                                else
                                                    {2403}let pkSess_2518: bitstring = fail-any in
                                                    {2404}out(c, GetEndpointRequest);
                                                    {2405}in(c, (SPs_2519: bitstring,=SignAndEncrypt,UP_2520: bitstring,=pkSess_2518));
                                                    {2406}new SPc_2521: bitstring;
                                                    {2407}new Nc_2522: bitstring;
                                                    {2408}let m1_2523: bitstring = (Sess,SPc_2521,exp(g,Nc_2522)) in
                                                    {2409}out(c, (pkCli_2154,enc(m1_2523,pkSess_2518),sign(m1_2523,skCli_2153)));
                                                    {2410}in(c, (ePartS_2524: bitstring,sigPartS_2525: bitstring));
                                                    {2411}let (=Cli,PartS_2526: bitstring) = dec(ePartS_2524,skCli_2153) in
                                                    {2412}if (verify((Cli,PartS_2526),sigPartS_2525,pkSess_2518) <> true) then
                                                        0
                                                    else
                                                        {2413}let Kcli_2527: bitstring = exp(PartS_2526,Nc_2522) in
                                                        {2414}out(c, senc(mCli(pkCli_2154,pkSess_2518),Kcli_2527))
                                    )
                                    else
                                        {2415}let pkDisco_2528: bitstring = fail-any in
                                        {2416}let v_2529: bool = (Sess = A) in
                                        (
                                            {2417}if v_2529 then
                                            (
                                                {2418}let pkSess_2530: bitstring = pub(skA) in
                                                {2419}out(c, GetEndpointRequest);
                                                {2420}in(c, (SPs_2531: bitstring,=SignAndEncrypt,UP_2532: bitstring,=pkSess_2530));
                                                {2421}new SPc_2533: bitstring;
                                                {2422}new Nc_2534: bitstring;
                                                {2423}let m1_2535: bitstring = (Sess,SPc_2533,exp(g,Nc_2534)) in
                                                {2424}out(c, (pkCli_2154,enc(m1_2535,pkSess_2530),sign(m1_2535,skCli_2153)));
                                                {2425}in(c, (ePartS_2536: bitstring,sigPartS_2537: bitstring));
                                                {2426}let (=Cli,PartS_2538: bitstring) = dec(ePartS_2536,skCli_2153) in
                                                {2427}if (verify((Cli,PartS_2538),sigPartS_2537,pkSess_2530) <> true) then
                                                    0
                                                else
                                                    {2428}let Kcli_2539: bitstring = exp(PartS_2538,Nc_2534) in
                                                    {2429}out(c, senc(mCli(pkCli_2154,pkSess_2530),Kcli_2539))
                                            )
                                            else
                                                {2430}let v_2540: bool = (Sess = B) in
                                                (
                                                    {2431}if v_2540 then
                                                    (
                                                        {2432}let pkSess_2541: bitstring = pub(skB) in
                                                        {2433}out(c, GetEndpointRequest);
                                                        {2434}in(c, (SPs_2542: bitstring,=SignAndEncrypt,UP_2543: bitstring,=pkSess_2541));
                                                        {2435}new SPc_2544: bitstring;
                                                        {2436}new Nc_2545: bitstring;
                                                        {2437}let m1_2546: bitstring = (Sess,SPc_2544,exp(g,Nc_2545)) in
                                                        {2438}out(c, (pkCli_2154,enc(m1_2546,pkSess_2541),sign(m1_2546,skCli_2153)));
                                                        {2439}in(c, (ePartS_2547: bitstring,sigPartS_2548: bitstring));
                                                        {2440}let (=Cli,PartS_2549: bitstring) = dec(ePartS_2547,skCli_2153) in
                                                        {2441}if (verify((Cli,PartS_2549),sigPartS_2548,pkSess_2541) <> true) then
                                                            0
                                                        else
                                                            {2442}let Kcli_2550: bitstring = exp(PartS_2549,Nc_2545) in
                                                            {2443}out(c, senc(mCli(pkCli_2154,pkSess_2541),Kcli_2550))
                                                    )
                                                    else
                                                        {2444}let v_2551: bool = (Sess = C) in
                                                        (
                                                            {2445}if v_2551 then
                                                            (
                                                                {2446}let pkSess_2552: bitstring = pub(skC) in
                                                                {2447}out(c, GetEndpointRequest);
                                                                {2448}in(c, (SPs_2553: bitstring,=SignAndEncrypt,UP_2554: bitstring,=pkSess_2552));
                                                                {2449}new SPc_2555: bitstring;
                                                                {2450}new Nc_2556: bitstring;
                                                                {2451}let m1_2557: bitstring = (Sess,SPc_2555,exp(g,Nc_2556)) in
                                                                {2452}out(c, (pkCli_2154,enc(m1_2557,pkSess_2552),sign(m1_2557,skCli_2153)));
                                                                {2453}in(c, (ePartS_2558: bitstring,sigPartS_2559: bitstring));
                                                                {2454}let (=Cli,PartS_2560: bitstring) = dec(ePartS_2558,skCli_2153) in
                                                                {2455}if (verify((Cli,PartS_2560),sigPartS_2559,pkSess_2552) <> true) then
                                                                    0
                                                                else
                                                                    {2456}let Kcli_2561: bitstring = exp(PartS_2560,Nc_2556) in
                                                                    {2457}out(c, senc(mCli(pkCli_2154,pkSess_2552),Kcli_2561))
                                                            )
                                                            else
                                                                {2458}let pkSess_2562: bitstring = pub(skI) in
                                                                {2459}out(c, GetEndpointRequest);
                                                                {2460}in(c, (SPs_2563: bitstring,=SignAndEncrypt,UP_2564: bitstring,=pkSess_2562));
                                                                {2461}new SPc_2565: bitstring;
                                                                {2462}new Nc_2566: bitstring;
                                                                {2463}let m1_2567: bitstring = (Sess,SPc_2565,exp(g,Nc_2566)) in
                                                                {2464}out(c, (pkCli_2154,enc(m1_2567,pkSess_2562),sign(m1_2567,skCli_2153)));
                                                                {2465}in(c, (ePartS_2568: bitstring,sigPartS_2569: bitstring));
                                                                {2466}let (=Cli,PartS_2570: bitstring) = dec(ePartS_2568,skCli_2153) in
                                                                {2467}if (verify((Cli,PartS_2570),sigPartS_2569,pkSess_2562) <> true) then
                                                                    0
                                                                else
                                                                    {2468}let Kcli_2571: bitstring = exp(PartS_2570,Nc_2566) in
                                                                    {2469}out(c, senc(mCli(pkCli_2154,pkSess_2562),Kcli_2571))
                                                        )
                                                        else
                                                            {2470}let pkSess_2572: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (SPs_2573: bitstring,=SignAndEncrypt,UP_2574: bitstring,=pkSess_2572));
                                                            {2473}new SPc_2575: bitstring;
                                                            {2474}new Nc_2576: bitstring;
                                                            {2475}let m1_2577: bitstring = (Sess,SPc_2575,exp(g,Nc_2576)) in
                                                            {2476}out(c, (pkCli_2154,enc(m1_2577,pkSess_2572),sign(m1_2577,skCli_2153)));
                                                            {2477}in(c, (ePartS_2578: bitstring,sigPartS_2579: bitstring));
                                                            {2478}let (=Cli,PartS_2580: bitstring) = dec(ePartS_2578,skCli_2153) in
                                                            {2479}if (verify((Cli,PartS_2580),sigPartS_2579,pkSess_2572) <> true) then
                                                                0
                                                            else
                                                                {2480}let Kcli_2581: bitstring = exp(PartS_2580,Nc_2576) in
                                                                {2481}out(c, senc(mCli(pkCli_2154,pkSess_2572),Kcli_2581))
                                                )
                                                else
                                                    {2482}let pkSess_2582: bitstring = fail-any in
                                                    {2483}out(c, GetEndpointRequest);
                                                    {2484}in(c, (SPs_2583: bitstring,=SignAndEncrypt,UP_2584: bitstring,=pkSess_2582));
                                                    {2485}new SPc_2585: bitstring;
                                                    {2486}new Nc_2586: bitstring;
                                                    {2487}let m1_2587: bitstring = (Sess,SPc_2585,exp(g,Nc_2586)) in
                                                    {2488}out(c, (pkCli_2154,enc(m1_2587,pkSess_2582),sign(m1_2587,skCli_2153)));
                                                    {2489}in(c, (ePartS_2588: bitstring,sigPartS_2589: bitstring));
                                                    {2490}let (=Cli,PartS_2590: bitstring) = dec(ePartS_2588,skCli_2153) in
                                                    {2491}if (verify((Cli,PartS_2590),sigPartS_2589,pkSess_2582) <> true) then
                                                        0
                                                    else
                                                        {2492}let Kcli_2591: bitstring = exp(PartS_2590,Nc_2586) in
                                                        {2493}out(c, senc(mCli(pkCli_2154,pkSess_2582),Kcli_2591))
                                        )
                                        else
                                            {2494}let pkSess_2592: bitstring = fail-any in
                                            {2495}out(c, GetEndpointRequest);
                                            {2496}in(c, (SPs_2593: bitstring,=SignAndEncrypt,UP_2594: bitstring,=pkSess_2592));
                                            {2497}new SPc_2595: bitstring;
                                            {2498}new Nc_2596: bitstring;
                                            {2499}let m1_2597: bitstring = (Sess,SPc_2595,exp(g,Nc_2596)) in
                                            {2500}out(c, (pkCli_2154,enc(m1_2597,pkSess_2592),sign(m1_2597,skCli_2153)));
                                            {2501}in(c, (ePartS_2598: bitstring,sigPartS_2599: bitstring));
                                            {2502}let (=Cli,PartS_2600: bitstring) = dec(ePartS_2598,skCli_2153) in
                                            {2503}if (verify((Cli,PartS_2600),sigPartS_2599,pkSess_2592) <> true) then
                                                0
                                            else
                                                {2504}let Kcli_2601: bitstring = exp(PartS_2600,Nc_2596) in
                                                {2505}out(c, senc(mCli(pkCli_2154,pkSess_2592),Kcli_2601))
                            )
                            else
                                {2506}let pkDisco_2602: bitstring = fail-any in
                                {2507}let v_2603: bool = (Sess = A) in
                                (
                                    {2508}if v_2603 then
                                    (
                                        {2509}let pkSess_2604: bitstring = pub(skA) in
                                        {2510}out(c, GetEndpointRequest);
                                        {2511}in(c, (SPs_2605: bitstring,=SignAndEncrypt,UP_2606: bitstring,=pkSess_2604));
                                        {2512}new SPc_2607: bitstring;
                                        {2513}new Nc_2608: bitstring;
                                        {2514}let m1_2609: bitstring = (Sess,SPc_2607,exp(g,Nc_2608)) in
                                        {2515}out(c, (pkCli_2154,enc(m1_2609,pkSess_2604),sign(m1_2609,skCli_2153)));
                                        {2516}in(c, (ePartS_2610: bitstring,sigPartS_2611: bitstring));
                                        {2517}let (=Cli,PartS_2612: bitstring) = dec(ePartS_2610,skCli_2153) in
                                        {2518}if (verify((Cli,PartS_2612),sigPartS_2611,pkSess_2604) <> true) then
                                            0
                                        else
                                            {2519}let Kcli_2613: bitstring = exp(PartS_2612,Nc_2608) in
                                            {2520}out(c, senc(mCli(pkCli_2154,pkSess_2604),Kcli_2613))
                                    )
                                    else
                                        {2521}let v_2614: bool = (Sess = B) in
                                        (
                                            {2522}if v_2614 then
                                            (
                                                {2523}let pkSess_2615: bitstring = pub(skB) in
                                                {2524}out(c, GetEndpointRequest);
                                                {2525}in(c, (SPs_2616: bitstring,=SignAndEncrypt,UP_2617: bitstring,=pkSess_2615));
                                                {2526}new SPc_2618: bitstring;
                                                {2527}new Nc_2619: bitstring;
                                                {2528}let m1_2620: bitstring = (Sess,SPc_2618,exp(g,Nc_2619)) in
                                                {2529}out(c, (pkCli_2154,enc(m1_2620,pkSess_2615),sign(m1_2620,skCli_2153)));
                                                {2530}in(c, (ePartS_2621: bitstring,sigPartS_2622: bitstring));
                                                {2531}let (=Cli,PartS_2623: bitstring) = dec(ePartS_2621,skCli_2153) in
                                                {2532}if (verify((Cli,PartS_2623),sigPartS_2622,pkSess_2615) <> true) then
                                                    0
                                                else
                                                    {2533}let Kcli_2624: bitstring = exp(PartS_2623,Nc_2619) in
                                                    {2534}out(c, senc(mCli(pkCli_2154,pkSess_2615),Kcli_2624))
                                            )
                                            else
                                                {2535}let v_2625: bool = (Sess = C) in
                                                (
                                                    {2536}if v_2625 then
                                                    (
                                                        {2537}let pkSess_2626: bitstring = pub(skC) in
                                                        {2538}out(c, GetEndpointRequest);
                                                        {2539}in(c, (SPs_2627: bitstring,=SignAndEncrypt,UP_2628: bitstring,=pkSess_2626));
                                                        {2540}new SPc_2629: bitstring;
                                                        {2541}new Nc_2630: bitstring;
                                                        {2542}let m1_2631: bitstring = (Sess,SPc_2629,exp(g,Nc_2630)) in
                                                        {2543}out(c, (pkCli_2154,enc(m1_2631,pkSess_2626),sign(m1_2631,skCli_2153)));
                                                        {2544}in(c, (ePartS_2632: bitstring,sigPartS_2633: bitstring));
                                                        {2545}let (=Cli,PartS_2634: bitstring) = dec(ePartS_2632,skCli_2153) in
                                                        {2546}if (verify((Cli,PartS_2634),sigPartS_2633,pkSess_2626) <> true) then
                                                            0
                                                        else
                                                            {2547}let Kcli_2635: bitstring = exp(PartS_2634,Nc_2630) in
                                                            {2548}out(c, senc(mCli(pkCli_2154,pkSess_2626),Kcli_2635))
                                                    )
                                                    else
                                                        {2549}let pkSess_2636: bitstring = pub(skI) in
                                                        {2550}out(c, GetEndpointRequest);
                                                        {2551}in(c, (SPs_2637: bitstring,=SignAndEncrypt,UP_2638: bitstring,=pkSess_2636));
                                                        {2552}new SPc_2639: bitstring;
                                                        {2553}new Nc_2640: bitstring;
                                                        {2554}let m1_2641: bitstring = (Sess,SPc_2639,exp(g,Nc_2640)) in
                                                        {2555}out(c, (pkCli_2154,enc(m1_2641,pkSess_2636),sign(m1_2641,skCli_2153)));
                                                        {2556}in(c, (ePartS_2642: bitstring,sigPartS_2643: bitstring));
                                                        {2557}let (=Cli,PartS_2644: bitstring) = dec(ePartS_2642,skCli_2153) in
                                                        {2558}if (verify((Cli,PartS_2644),sigPartS_2643,pkSess_2636) <> true) then
                                                            0
                                                        else
                                                            {2559}let Kcli_2645: bitstring = exp(PartS_2644,Nc_2640) in
                                                            {2560}out(c, senc(mCli(pkCli_2154,pkSess_2636),Kcli_2645))
                                                )
                                                else
                                                    {2561}let pkSess_2646: bitstring = fail-any in
                                                    {2562}out(c, GetEndpointRequest);
                                                    {2563}in(c, (SPs_2647: bitstring,=SignAndEncrypt,UP_2648: bitstring,=pkSess_2646));
                                                    {2564}new SPc_2649: bitstring;
                                                    {2565}new Nc_2650: bitstring;
                                                    {2566}let m1_2651: bitstring = (Sess,SPc_2649,exp(g,Nc_2650)) in
                                                    {2567}out(c, (pkCli_2154,enc(m1_2651,pkSess_2646),sign(m1_2651,skCli_2153)));
                                                    {2568}in(c, (ePartS_2652: bitstring,sigPartS_2653: bitstring));
                                                    {2569}let (=Cli,PartS_2654: bitstring) = dec(ePartS_2652,skCli_2153) in
                                                    {2570}if (verify((Cli,PartS_2654),sigPartS_2653,pkSess_2646) <> true) then
                                                        0
                                                    else
                                                        {2571}let Kcli_2655: bitstring = exp(PartS_2654,Nc_2650) in
                                                        {2572}out(c, senc(mCli(pkCli_2154,pkSess_2646),Kcli_2655))
                                        )
                                        else
                                            {2573}let pkSess_2656: bitstring = fail-any in
                                            {2574}out(c, GetEndpointRequest);
                                            {2575}in(c, (SPs_2657: bitstring,=SignAndEncrypt,UP_2658: bitstring,=pkSess_2656));
                                            {2576}new SPc_2659: bitstring;
                                            {2577}new Nc_2660: bitstring;
                                            {2578}let m1_2661: bitstring = (Sess,SPc_2659,exp(g,Nc_2660)) in
                                            {2579}out(c, (pkCli_2154,enc(m1_2661,pkSess_2656),sign(m1_2661,skCli_2153)));
                                            {2580}in(c, (ePartS_2662: bitstring,sigPartS_2663: bitstring));
                                            {2581}let (=Cli,PartS_2664: bitstring) = dec(ePartS_2662,skCli_2153) in
                                            {2582}if (verify((Cli,PartS_2664),sigPartS_2663,pkSess_2656) <> true) then
                                                0
                                            else
                                                {2583}let Kcli_2665: bitstring = exp(PartS_2664,Nc_2660) in
                                                {2584}out(c, senc(mCli(pkCli_2154,pkSess_2656),Kcli_2665))
                                )
                                else
                                    {2585}let pkSess_2666: bitstring = fail-any in
                                    {2586}out(c, GetEndpointRequest);
                                    {2587}in(c, (SPs_2667: bitstring,=SignAndEncrypt,UP_2668: bitstring,=pkSess_2666));
                                    {2588}new SPc_2669: bitstring;
                                    {2589}new Nc_2670: bitstring;
                                    {2590}let m1_2671: bitstring = (Sess,SPc_2669,exp(g,Nc_2670)) in
                                    {2591}out(c, (pkCli_2154,enc(m1_2671,pkSess_2666),sign(m1_2671,skCli_2153)));
                                    {2592}in(c, (ePartS_2672: bitstring,sigPartS_2673: bitstring));
                                    {2593}let (=Cli,PartS_2674: bitstring) = dec(ePartS_2672,skCli_2153) in
                                    {2594}if (verify((Cli,PartS_2674),sigPartS_2673,pkSess_2666) <> true) then
                                        0
                                    else
                                        {2595}let Kcli_2675: bitstring = exp(PartS_2674,Nc_2670) in
                                        {2596}out(c, senc(mCli(pkCli_2154,pkSess_2666),Kcli_2675))
                    )
                    else
                        {2597}let skCli_2676: bitstring = fail-any in
                        {2598}let pkCli_2677: bitstring = pub(skCli_2676) in
                        {2599}let v_2678: bool = (Disco = A) in
                        (
                            {2600}if v_2678 then
                            (
                                {2601}let pkDisco_2679: bitstring = pub(skA) in
                                {2602}let v_2680: bool = (Sess = A) in
                                (
                                    {2603}if v_2680 then
                                    (
                                        {2604}let pkSess_2681: bitstring = pub(skA) in
                                        {2605}out(c, GetEndpointRequest);
                                        {2606}in(c, (SPs_2682: bitstring,=SignAndEncrypt,UP_2683: bitstring,=pkSess_2681));
                                        {2607}new SPc_2684: bitstring;
                                        {2608}new Nc_2685: bitstring;
                                        {2609}let m1_2686: bitstring = (Sess,SPc_2684,exp(g,Nc_2685)) in
                                        {2610}out(c, (pkCli_2677,enc(m1_2686,pkSess_2681),sign(m1_2686,skCli_2676)));
                                        {2611}in(c, (ePartS_2687: bitstring,sigPartS_2688: bitstring));
                                        {2612}let (=Cli,PartS_2689: bitstring) = dec(ePartS_2687,skCli_2676) in
                                        {2613}if (verify((Cli,PartS_2689),sigPartS_2688,pkSess_2681) <> true) then
                                            0
                                        else
                                            {2614}let Kcli_2690: bitstring = exp(PartS_2689,Nc_2685) in
                                            {2615}out(c, senc(mCli(pkCli_2677,pkSess_2681),Kcli_2690))
                                    )
                                    else
                                        {2616}let v_2691: bool = (Sess = B) in
                                        (
                                            {2617}if v_2691 then
                                            (
                                                {2618}let pkSess_2692: bitstring = pub(skB) in
                                                {2619}out(c, GetEndpointRequest);
                                                {2620}in(c, (SPs_2693: bitstring,=SignAndEncrypt,UP_2694: bitstring,=pkSess_2692));
                                                {2621}new SPc_2695: bitstring;
                                                {2622}new Nc_2696: bitstring;
                                                {2623}let m1_2697: bitstring = (Sess,SPc_2695,exp(g,Nc_2696)) in
                                                {2624}out(c, (pkCli_2677,enc(m1_2697,pkSess_2692),sign(m1_2697,skCli_2676)));
                                                {2625}in(c, (ePartS_2698: bitstring,sigPartS_2699: bitstring));
                                                {2626}let (=Cli,PartS_2700: bitstring) = dec(ePartS_2698,skCli_2676) in
                                                {2627}if (verify((Cli,PartS_2700),sigPartS_2699,pkSess_2692) <> true) then
                                                    0
                                                else
                                                    {2628}let Kcli_2701: bitstring = exp(PartS_2700,Nc_2696) in
                                                    {2629}out(c, senc(mCli(pkCli_2677,pkSess_2692),Kcli_2701))
                                            )
                                            else
                                                {2630}let v_2702: bool = (Sess = C) in
                                                (
                                                    {2631}if v_2702 then
                                                    (
                                                        {2632}let pkSess_2703: bitstring = pub(skC) in
                                                        {2633}out(c, GetEndpointRequest);
                                                        {2634}in(c, (SPs_2704: bitstring,=SignAndEncrypt,UP_2705: bitstring,=pkSess_2703));
                                                        {2635}new SPc_2706: bitstring;
                                                        {2636}new Nc_2707: bitstring;
                                                        {2637}let m1_2708: bitstring = (Sess,SPc_2706,exp(g,Nc_2707)) in
                                                        {2638}out(c, (pkCli_2677,enc(m1_2708,pkSess_2703),sign(m1_2708,skCli_2676)));
                                                        {2639}in(c, (ePartS_2709: bitstring,sigPartS_2710: bitstring));
                                                        {2640}let (=Cli,PartS_2711: bitstring) = dec(ePartS_2709,skCli_2676) in
                                                        {2641}if (verify((Cli,PartS_2711),sigPartS_2710,pkSess_2703) <> true) then
                                                            0
                                                        else
                                                            {2642}let Kcli_2712: bitstring = exp(PartS_2711,Nc_2707) in
                                                            {2643}out(c, senc(mCli(pkCli_2677,pkSess_2703),Kcli_2712))
                                                    )
                                                    else
                                                        {2644}let pkSess_2713: bitstring = pub(skI) in
                                                        {2645}out(c, GetEndpointRequest);
                                                        {2646}in(c, (SPs_2714: bitstring,=SignAndEncrypt,UP_2715: bitstring,=pkSess_2713));
                                                        {2647}new SPc_2716: bitstring;
                                                        {2648}new Nc_2717: bitstring;
                                                        {2649}let m1_2718: bitstring = (Sess,SPc_2716,exp(g,Nc_2717)) in
                                                        {2650}out(c, (pkCli_2677,enc(m1_2718,pkSess_2713),sign(m1_2718,skCli_2676)));
                                                        {2651}in(c, (ePartS_2719: bitstring,sigPartS_2720: bitstring));
                                                        {2652}let (=Cli,PartS_2721: bitstring) = dec(ePartS_2719,skCli_2676) in
                                                        {2653}if (verify((Cli,PartS_2721),sigPartS_2720,pkSess_2713) <> true) then
                                                            0
                                                        else
                                                            {2654}let Kcli_2722: bitstring = exp(PartS_2721,Nc_2717) in
                                                            {2655}out(c, senc(mCli(pkCli_2677,pkSess_2713),Kcli_2722))
                                                )
                                                else
                                                    {2656}let pkSess_2723: bitstring = fail-any in
                                                    {2657}out(c, GetEndpointRequest);
                                                    {2658}in(c, (SPs_2724: bitstring,=SignAndEncrypt,UP_2725: bitstring,=pkSess_2723));
                                                    {2659}new SPc_2726: bitstring;
                                                    {2660}new Nc_2727: bitstring;
                                                    {2661}let m1_2728: bitstring = (Sess,SPc_2726,exp(g,Nc_2727)) in
                                                    {2662}out(c, (pkCli_2677,enc(m1_2728,pkSess_2723),sign(m1_2728,skCli_2676)));
                                                    {2663}in(c, (ePartS_2729: bitstring,sigPartS_2730: bitstring));
                                                    {2664}let (=Cli,PartS_2731: bitstring) = dec(ePartS_2729,skCli_2676) in
                                                    {2665}if (verify((Cli,PartS_2731),sigPartS_2730,pkSess_2723) <> true) then
                                                        0
                                                    else
                                                        {2666}let Kcli_2732: bitstring = exp(PartS_2731,Nc_2727) in
                                                        {2667}out(c, senc(mCli(pkCli_2677,pkSess_2723),Kcli_2732))
                                        )
                                        else
                                            {2668}let pkSess_2733: bitstring = fail-any in
                                            {2669}out(c, GetEndpointRequest);
                                            {2670}in(c, (SPs_2734: bitstring,=SignAndEncrypt,UP_2735: bitstring,=pkSess_2733));
                                            {2671}new SPc_2736: bitstring;
                                            {2672}new Nc_2737: bitstring;
                                            {2673}let m1_2738: bitstring = (Sess,SPc_2736,exp(g,Nc_2737)) in
                                            {2674}out(c, (pkCli_2677,enc(m1_2738,pkSess_2733),sign(m1_2738,skCli_2676)));
                                            {2675}in(c, (ePartS_2739: bitstring,sigPartS_2740: bitstring));
                                            {2676}let (=Cli,PartS_2741: bitstring) = dec(ePartS_2739,skCli_2676) in
                                            {2677}if (verify((Cli,PartS_2741),sigPartS_2740,pkSess_2733) <> true) then
                                                0
                                            else
                                                {2678}let Kcli_2742: bitstring = exp(PartS_2741,Nc_2737) in
                                                {2679}out(c, senc(mCli(pkCli_2677,pkSess_2733),Kcli_2742))
                                )
                                else
                                    {2680}let pkSess_2743: bitstring = fail-any in
                                    {2681}out(c, GetEndpointRequest);
                                    {2682}in(c, (SPs_2744: bitstring,=SignAndEncrypt,UP_2745: bitstring,=pkSess_2743));
                                    {2683}new SPc_2746: bitstring;
                                    {2684}new Nc_2747: bitstring;
                                    {2685}let m1_2748: bitstring = (Sess,SPc_2746,exp(g,Nc_2747)) in
                                    {2686}out(c, (pkCli_2677,enc(m1_2748,pkSess_2743),sign(m1_2748,skCli_2676)));
                                    {2687}in(c, (ePartS_2749: bitstring,sigPartS_2750: bitstring));
                                    {2688}let (=Cli,PartS_2751: bitstring) = dec(ePartS_2749,skCli_2676) in
                                    {2689}if (verify((Cli,PartS_2751),sigPartS_2750,pkSess_2743) <> true) then
                                        0
                                    else
                                        {2690}let Kcli_2752: bitstring = exp(PartS_2751,Nc_2747) in
                                        {2691}out(c, senc(mCli(pkCli_2677,pkSess_2743),Kcli_2752))
                            )
                            else
                                {2692}let v_2753: bool = (Disco = B) in
                                (
                                    {2693}if v_2753 then
                                    (
                                        {2694}let pkDisco_2754: bitstring = pub(skB) in
                                        {2695}let v_2755: bool = (Sess = A) in
                                        (
                                            {2696}if v_2755 then
                                            (
                                                {2697}let pkSess_2756: bitstring = pub(skA) in
                                                {2698}out(c, GetEndpointRequest);
                                                {2699}in(c, (SPs_2757: bitstring,=SignAndEncrypt,UP_2758: bitstring,=pkSess_2756));
                                                {2700}new SPc_2759: bitstring;
                                                {2701}new Nc_2760: bitstring;
                                                {2702}let m1_2761: bitstring = (Sess,SPc_2759,exp(g,Nc_2760)) in
                                                {2703}out(c, (pkCli_2677,enc(m1_2761,pkSess_2756),sign(m1_2761,skCli_2676)));
                                                {2704}in(c, (ePartS_2762: bitstring,sigPartS_2763: bitstring));
                                                {2705}let (=Cli,PartS_2764: bitstring) = dec(ePartS_2762,skCli_2676) in
                                                {2706}if (verify((Cli,PartS_2764),sigPartS_2763,pkSess_2756) <> true) then
                                                    0
                                                else
                                                    {2707}let Kcli_2765: bitstring = exp(PartS_2764,Nc_2760) in
                                                    {2708}out(c, senc(mCli(pkCli_2677,pkSess_2756),Kcli_2765))
                                            )
                                            else
                                                {2709}let v_2766: bool = (Sess = B) in
                                                (
                                                    {2710}if v_2766 then
                                                    (
                                                        {2711}let pkSess_2767: bitstring = pub(skB) in
                                                        {2712}out(c, GetEndpointRequest);
                                                        {2713}in(c, (SPs_2768: bitstring,=SignAndEncrypt,UP_2769: bitstring,=pkSess_2767));
                                                        {2714}new SPc_2770: bitstring;
                                                        {2715}new Nc_2771: bitstring;
                                                        {2716}let m1_2772: bitstring = (Sess,SPc_2770,exp(g,Nc_2771)) in
                                                        {2717}out(c, (pkCli_2677,enc(m1_2772,pkSess_2767),sign(m1_2772,skCli_2676)));
                                                        {2718}in(c, (ePartS_2773: bitstring,sigPartS_2774: bitstring));
                                                        {2719}let (=Cli,PartS_2775: bitstring) = dec(ePartS_2773,skCli_2676) in
                                                        {2720}if (verify((Cli,PartS_2775),sigPartS_2774,pkSess_2767) <> true) then
                                                            0
                                                        else
                                                            {2721}let Kcli_2776: bitstring = exp(PartS_2775,Nc_2771) in
                                                            {2722}out(c, senc(mCli(pkCli_2677,pkSess_2767),Kcli_2776))
                                                    )
                                                    else
                                                        {2723}let v_2777: bool = (Sess = C) in
                                                        (
                                                            {2724}if v_2777 then
                                                            (
                                                                {2725}let pkSess_2778: bitstring = pub(skC) in
                                                                {2726}out(c, GetEndpointRequest);
                                                                {2727}in(c, (SPs_2779: bitstring,=SignAndEncrypt,UP_2780: bitstring,=pkSess_2778));
                                                                {2728}new SPc_2781: bitstring;
                                                                {2729}new Nc_2782: bitstring;
                                                                {2730}let m1_2783: bitstring = (Sess,SPc_2781,exp(g,Nc_2782)) in
                                                                {2731}out(c, (pkCli_2677,enc(m1_2783,pkSess_2778),sign(m1_2783,skCli_2676)));
                                                                {2732}in(c, (ePartS_2784: bitstring,sigPartS_2785: bitstring));
                                                                {2733}let (=Cli,PartS_2786: bitstring) = dec(ePartS_2784,skCli_2676) in
                                                                {2734}if (verify((Cli,PartS_2786),sigPartS_2785,pkSess_2778) <> true) then
                                                                    0
                                                                else
                                                                    {2735}let Kcli_2787: bitstring = exp(PartS_2786,Nc_2782) in
                                                                    {2736}out(c, senc(mCli(pkCli_2677,pkSess_2778),Kcli_2787))
                                                            )
                                                            else
                                                                {2737}let pkSess_2788: bitstring = pub(skI) in
                                                                {2738}out(c, GetEndpointRequest);
                                                                {2739}in(c, (SPs_2789: bitstring,=SignAndEncrypt,UP_2790: bitstring,=pkSess_2788));
                                                                {2740}new SPc_2791: bitstring;
                                                                {2741}new Nc_2792: bitstring;
                                                                {2742}let m1_2793: bitstring = (Sess,SPc_2791,exp(g,Nc_2792)) in
                                                                {2743}out(c, (pkCli_2677,enc(m1_2793,pkSess_2788),sign(m1_2793,skCli_2676)));
                                                                {2744}in(c, (ePartS_2794: bitstring,sigPartS_2795: bitstring));
                                                                {2745}let (=Cli,PartS_2796: bitstring) = dec(ePartS_2794,skCli_2676) in
                                                                {2746}if (verify((Cli,PartS_2796),sigPartS_2795,pkSess_2788) <> true) then
                                                                    0
                                                                else
                                                                    {2747}let Kcli_2797: bitstring = exp(PartS_2796,Nc_2792) in
                                                                    {2748}out(c, senc(mCli(pkCli_2677,pkSess_2788),Kcli_2797))
                                                        )
                                                        else
                                                            {2749}let pkSess_2798: bitstring = fail-any in
                                                            {2750}out(c, GetEndpointRequest);
                                                            {2751}in(c, (SPs_2799: bitstring,=SignAndEncrypt,UP_2800: bitstring,=pkSess_2798));
                                                            {2752}new SPc_2801: bitstring;
                                                            {2753}new Nc_2802: bitstring;
                                                            {2754}let m1_2803: bitstring = (Sess,SPc_2801,exp(g,Nc_2802)) in
                                                            {2755}out(c, (pkCli_2677,enc(m1_2803,pkSess_2798),sign(m1_2803,skCli_2676)));
                                                            {2756}in(c, (ePartS_2804: bitstring,sigPartS_2805: bitstring));
                                                            {2757}let (=Cli,PartS_2806: bitstring) = dec(ePartS_2804,skCli_2676) in
                                                            {2758}if (verify((Cli,PartS_2806),sigPartS_2805,pkSess_2798) <> true) then
                                                                0
                                                            else
                                                                {2759}let Kcli_2807: bitstring = exp(PartS_2806,Nc_2802) in
                                                                {2760}out(c, senc(mCli(pkCli_2677,pkSess_2798),Kcli_2807))
                                                )
                                                else
                                                    {2761}let pkSess_2808: bitstring = fail-any in
                                                    {2762}out(c, GetEndpointRequest);
                                                    {2763}in(c, (SPs_2809: bitstring,=SignAndEncrypt,UP_2810: bitstring,=pkSess_2808));
                                                    {2764}new SPc_2811: bitstring;
                                                    {2765}new Nc_2812: bitstring;
                                                    {2766}let m1_2813: bitstring = (Sess,SPc_2811,exp(g,Nc_2812)) in
                                                    {2767}out(c, (pkCli_2677,enc(m1_2813,pkSess_2808),sign(m1_2813,skCli_2676)));
                                                    {2768}in(c, (ePartS_2814: bitstring,sigPartS_2815: bitstring));
                                                    {2769}let (=Cli,PartS_2816: bitstring) = dec(ePartS_2814,skCli_2676) in
                                                    {2770}if (verify((Cli,PartS_2816),sigPartS_2815,pkSess_2808) <> true) then
                                                        0
                                                    else
                                                        {2771}let Kcli_2817: bitstring = exp(PartS_2816,Nc_2812) in
                                                        {2772}out(c, senc(mCli(pkCli_2677,pkSess_2808),Kcli_2817))
                                        )
                                        else
                                            {2773}let pkSess_2818: bitstring = fail-any in
                                            {2774}out(c, GetEndpointRequest);
                                            {2775}in(c, (SPs_2819: bitstring,=SignAndEncrypt,UP_2820: bitstring,=pkSess_2818));
                                            {2776}new SPc_2821: bitstring;
                                            {2777}new Nc_2822: bitstring;
                                            {2778}let m1_2823: bitstring = (Sess,SPc_2821,exp(g,Nc_2822)) in
                                            {2779}out(c, (pkCli_2677,enc(m1_2823,pkSess_2818),sign(m1_2823,skCli_2676)));
                                            {2780}in(c, (ePartS_2824: bitstring,sigPartS_2825: bitstring));
                                            {2781}let (=Cli,PartS_2826: bitstring) = dec(ePartS_2824,skCli_2676) in
                                            {2782}if (verify((Cli,PartS_2826),sigPartS_2825,pkSess_2818) <> true) then
                                                0
                                            else
                                                {2783}let Kcli_2827: bitstring = exp(PartS_2826,Nc_2822) in
                                                {2784}out(c, senc(mCli(pkCli_2677,pkSess_2818),Kcli_2827))
                                    )
                                    else
                                        {2785}let v_2828: bool = (Disco = C) in
                                        (
                                            {2786}if v_2828 then
                                            (
                                                {2787}let pkDisco_2829: bitstring = pub(skC) in
                                                {2788}let v_2830: bool = (Sess = A) in
                                                (
                                                    {2789}if v_2830 then
                                                    (
                                                        {2790}let pkSess_2831: bitstring = pub(skA) in
                                                        {2791}out(c, GetEndpointRequest);
                                                        {2792}in(c, (SPs_2832: bitstring,=SignAndEncrypt,UP_2833: bitstring,=pkSess_2831));
                                                        {2793}new SPc_2834: bitstring;
                                                        {2794}new Nc_2835: bitstring;
                                                        {2795}let m1_2836: bitstring = (Sess,SPc_2834,exp(g,Nc_2835)) in
                                                        {2796}out(c, (pkCli_2677,enc(m1_2836,pkSess_2831),sign(m1_2836,skCli_2676)));
                                                        {2797}in(c, (ePartS_2837: bitstring,sigPartS_2838: bitstring));
                                                        {2798}let (=Cli,PartS_2839: bitstring) = dec(ePartS_2837,skCli_2676) in
                                                        {2799}if (verify((Cli,PartS_2839),sigPartS_2838,pkSess_2831) <> true) then
                                                            0
                                                        else
                                                            {2800}let Kcli_2840: bitstring = exp(PartS_2839,Nc_2835) in
                                                            {2801}out(c, senc(mCli(pkCli_2677,pkSess_2831),Kcli_2840))
                                                    )
                                                    else
                                                        {2802}let v_2841: bool = (Sess = B) in
                                                        (
                                                            {2803}if v_2841 then
                                                            (
                                                                {2804}let pkSess_2842: bitstring = pub(skB) in
                                                                {2805}out(c, GetEndpointRequest);
                                                                {2806}in(c, (SPs_2843: bitstring,=SignAndEncrypt,UP_2844: bitstring,=pkSess_2842));
                                                                {2807}new SPc_2845: bitstring;
                                                                {2808}new Nc_2846: bitstring;
                                                                {2809}let m1_2847: bitstring = (Sess,SPc_2845,exp(g,Nc_2846)) in
                                                                {2810}out(c, (pkCli_2677,enc(m1_2847,pkSess_2842),sign(m1_2847,skCli_2676)));
                                                                {2811}in(c, (ePartS_2848: bitstring,sigPartS_2849: bitstring));
                                                                {2812}let (=Cli,PartS_2850: bitstring) = dec(ePartS_2848,skCli_2676) in
                                                                {2813}if (verify((Cli,PartS_2850),sigPartS_2849,pkSess_2842) <> true) then
                                                                    0
                                                                else
                                                                    {2814}let Kcli_2851: bitstring = exp(PartS_2850,Nc_2846) in
                                                                    {2815}out(c, senc(mCli(pkCli_2677,pkSess_2842),Kcli_2851))
                                                            )
                                                            else
                                                                {2816}let v_2852: bool = (Sess = C) in
                                                                (
                                                                    {2817}if v_2852 then
                                                                    (
                                                                        {2818}let pkSess_2853: bitstring = pub(skC) in
                                                                        {2819}out(c, GetEndpointRequest);
                                                                        {2820}in(c, (SPs_2854: bitstring,=SignAndEncrypt,UP_2855: bitstring,=pkSess_2853));
                                                                        {2821}new SPc_2856: bitstring;
                                                                        {2822}new Nc_2857: bitstring;
                                                                        {2823}let m1_2858: bitstring = (Sess,SPc_2856,exp(g,Nc_2857)) in
                                                                        {2824}out(c, (pkCli_2677,enc(m1_2858,pkSess_2853),sign(m1_2858,skCli_2676)));
                                                                        {2825}in(c, (ePartS_2859: bitstring,sigPartS_2860: bitstring));
                                                                        {2826}let (=Cli,PartS_2861: bitstring) = dec(ePartS_2859,skCli_2676) in
                                                                        {2827}if (verify((Cli,PartS_2861),sigPartS_2860,pkSess_2853) <> true) then
                                                                            0
                                                                        else
                                                                            {2828}let Kcli_2862: bitstring = exp(PartS_2861,Nc_2857) in
                                                                            {2829}out(c, senc(mCli(pkCli_2677,pkSess_2853),Kcli_2862))
                                                                    )
                                                                    else
                                                                        {2830}let pkSess_2863: bitstring = pub(skI) in
                                                                        {2831}out(c, GetEndpointRequest);
                                                                        {2832}in(c, (SPs_2864: bitstring,=SignAndEncrypt,UP_2865: bitstring,=pkSess_2863));
                                                                        {2833}new SPc_2866: bitstring;
                                                                        {2834}new Nc_2867: bitstring;
                                                                        {2835}let m1_2868: bitstring = (Sess,SPc_2866,exp(g,Nc_2867)) in
                                                                        {2836}out(c, (pkCli_2677,enc(m1_2868,pkSess_2863),sign(m1_2868,skCli_2676)));
                                                                        {2837}in(c, (ePartS_2869: bitstring,sigPartS_2870: bitstring));
                                                                        {2838}let (=Cli,PartS_2871: bitstring) = dec(ePartS_2869,skCli_2676) in
                                                                        {2839}if (verify((Cli,PartS_2871),sigPartS_2870,pkSess_2863) <> true) then
                                                                            0
                                                                        else
                                                                            {2840}let Kcli_2872: bitstring = exp(PartS_2871,Nc_2867) in
                                                                            {2841}out(c, senc(mCli(pkCli_2677,pkSess_2863),Kcli_2872))
                                                                )
                                                                else
                                                                    {2842}let pkSess_2873: bitstring = fail-any in
                                                                    {2843}out(c, GetEndpointRequest);
                                                                    {2844}in(c, (SPs_2874: bitstring,=SignAndEncrypt,UP_2875: bitstring,=pkSess_2873));
                                                                    {2845}new SPc_2876: bitstring;
                                                                    {2846}new Nc_2877: bitstring;
                                                                    {2847}let m1_2878: bitstring = (Sess,SPc_2876,exp(g,Nc_2877)) in
                                                                    {2848}out(c, (pkCli_2677,enc(m1_2878,pkSess_2873),sign(m1_2878,skCli_2676)));
                                                                    {2849}in(c, (ePartS_2879: bitstring,sigPartS_2880: bitstring));
                                                                    {2850}let (=Cli,PartS_2881: bitstring) = dec(ePartS_2879,skCli_2676) in
                                                                    {2851}if (verify((Cli,PartS_2881),sigPartS_2880,pkSess_2873) <> true) then
                                                                        0
                                                                    else
                                                                        {2852}let Kcli_2882: bitstring = exp(PartS_2881,Nc_2877) in
                                                                        {2853}out(c, senc(mCli(pkCli_2677,pkSess_2873),Kcli_2882))
                                                        )
                                                        else
                                                            {2854}let pkSess_2883: bitstring = fail-any in
                                                            {2855}out(c, GetEndpointRequest);
                                                            {2856}in(c, (SPs_2884: bitstring,=SignAndEncrypt,UP_2885: bitstring,=pkSess_2883));
                                                            {2857}new SPc_2886: bitstring;
                                                            {2858}new Nc_2887: bitstring;
                                                            {2859}let m1_2888: bitstring = (Sess,SPc_2886,exp(g,Nc_2887)) in
                                                            {2860}out(c, (pkCli_2677,enc(m1_2888,pkSess_2883),sign(m1_2888,skCli_2676)));
                                                            {2861}in(c, (ePartS_2889: bitstring,sigPartS_2890: bitstring));
                                                            {2862}let (=Cli,PartS_2891: bitstring) = dec(ePartS_2889,skCli_2676) in
                                                            {2863}if (verify((Cli,PartS_2891),sigPartS_2890,pkSess_2883) <> true) then
                                                                0
                                                            else
                                                                {2864}let Kcli_2892: bitstring = exp(PartS_2891,Nc_2887) in
                                                                {2865}out(c, senc(mCli(pkCli_2677,pkSess_2883),Kcli_2892))
                                                )
                                                else
                                                    {2866}let pkSess_2893: bitstring = fail-any in
                                                    {2867}out(c, GetEndpointRequest);
                                                    {2868}in(c, (SPs_2894: bitstring,=SignAndEncrypt,UP_2895: bitstring,=pkSess_2893));
                                                    {2869}new SPc_2896: bitstring;
                                                    {2870}new Nc_2897: bitstring;
                                                    {2871}let m1_2898: bitstring = (Sess,SPc_2896,exp(g,Nc_2897)) in
                                                    {2872}out(c, (pkCli_2677,enc(m1_2898,pkSess_2893),sign(m1_2898,skCli_2676)));
                                                    {2873}in(c, (ePartS_2899: bitstring,sigPartS_2900: bitstring));
                                                    {2874}let (=Cli,PartS_2901: bitstring) = dec(ePartS_2899,skCli_2676) in
                                                    {2875}if (verify((Cli,PartS_2901),sigPartS_2900,pkSess_2893) <> true) then
                                                        0
                                                    else
                                                        {2876}let Kcli_2902: bitstring = exp(PartS_2901,Nc_2897) in
                                                        {2877}out(c, senc(mCli(pkCli_2677,pkSess_2893),Kcli_2902))
                                            )
                                            else
                                                {2878}let pkDisco_2903: bitstring = pub(skI) in
                                                {2879}let v_2904: bool = (Sess = A) in
                                                (
                                                    {2880}if v_2904 then
                                                    (
                                                        {2881}let pkSess_2905: bitstring = pub(skA) in
                                                        {2882}out(c, GetEndpointRequest);
                                                        {2883}in(c, (SPs_2906: bitstring,=SignAndEncrypt,UP_2907: bitstring,=pkSess_2905));
                                                        {2884}new SPc_2908: bitstring;
                                                        {2885}new Nc_2909: bitstring;
                                                        {2886}let m1_2910: bitstring = (Sess,SPc_2908,exp(g,Nc_2909)) in
                                                        {2887}out(c, (pkCli_2677,enc(m1_2910,pkSess_2905),sign(m1_2910,skCli_2676)));
                                                        {2888}in(c, (ePartS_2911: bitstring,sigPartS_2912: bitstring));
                                                        {2889}let (=Cli,PartS_2913: bitstring) = dec(ePartS_2911,skCli_2676) in
                                                        {2890}if (verify((Cli,PartS_2913),sigPartS_2912,pkSess_2905) <> true) then
                                                            0
                                                        else
                                                            {2891}let Kcli_2914: bitstring = exp(PartS_2913,Nc_2909) in
                                                            {2892}out(c, senc(mCli(pkCli_2677,pkSess_2905),Kcli_2914))
                                                    )
                                                    else
                                                        {2893}let v_2915: bool = (Sess = B) in
                                                        (
                                                            {2894}if v_2915 then
                                                            (
                                                                {2895}let pkSess_2916: bitstring = pub(skB) in
                                                                {2896}out(c, GetEndpointRequest);
                                                                {2897}in(c, (SPs_2917: bitstring,=SignAndEncrypt,UP_2918: bitstring,=pkSess_2916));
                                                                {2898}new SPc_2919: bitstring;
                                                                {2899}new Nc_2920: bitstring;
                                                                {2900}let m1_2921: bitstring = (Sess,SPc_2919,exp(g,Nc_2920)) in
                                                                {2901}out(c, (pkCli_2677,enc(m1_2921,pkSess_2916),sign(m1_2921,skCli_2676)));
                                                                {2902}in(c, (ePartS_2922: bitstring,sigPartS_2923: bitstring));
                                                                {2903}let (=Cli,PartS_2924: bitstring) = dec(ePartS_2922,skCli_2676) in
                                                                {2904}if (verify((Cli,PartS_2924),sigPartS_2923,pkSess_2916) <> true) then
                                                                    0
                                                                else
                                                                    {2905}let Kcli_2925: bitstring = exp(PartS_2924,Nc_2920) in
                                                                    {2906}out(c, senc(mCli(pkCli_2677,pkSess_2916),Kcli_2925))
                                                            )
                                                            else
                                                                {2907}let v_2926: bool = (Sess = C) in
                                                                (
                                                                    {2908}if v_2926 then
                                                                    (
                                                                        {2909}let pkSess_2927: bitstring = pub(skC) in
                                                                        {2910}out(c, GetEndpointRequest);
                                                                        {2911}in(c, (SPs_2928: bitstring,=SignAndEncrypt,UP_2929: bitstring,=pkSess_2927));
                                                                        {2912}new SPc_2930: bitstring;
                                                                        {2913}new Nc_2931: bitstring;
                                                                        {2914}let m1_2932: bitstring = (Sess,SPc_2930,exp(g,Nc_2931)) in
                                                                        {2915}out(c, (pkCli_2677,enc(m1_2932,pkSess_2927),sign(m1_2932,skCli_2676)));
                                                                        {2916}in(c, (ePartS_2933: bitstring,sigPartS_2934: bitstring));
                                                                        {2917}let (=Cli,PartS_2935: bitstring) = dec(ePartS_2933,skCli_2676) in
                                                                        {2918}if (verify((Cli,PartS_2935),sigPartS_2934,pkSess_2927) <> true) then
                                                                            0
                                                                        else
                                                                            {2919}let Kcli_2936: bitstring = exp(PartS_2935,Nc_2931) in
                                                                            {2920}out(c, senc(mCli(pkCli_2677,pkSess_2927),Kcli_2936))
                                                                    )
                                                                    else
                                                                        {2921}let pkSess_2937: bitstring = pub(skI) in
                                                                        {2922}out(c, GetEndpointRequest);
                                                                        {2923}in(c, (SPs_2938: bitstring,=SignAndEncrypt,UP_2939: bitstring,=pkSess_2937));
                                                                        {2924}new SPc_2940: bitstring;
                                                                        {2925}new Nc_2941: bitstring;
                                                                        {2926}let m1_2942: bitstring = (Sess,SPc_2940,exp(g,Nc_2941)) in
                                                                        {2927}out(c, (pkCli_2677,enc(m1_2942,pkSess_2937),sign(m1_2942,skCli_2676)));
                                                                        {2928}in(c, (ePartS_2943: bitstring,sigPartS_2944: bitstring));
                                                                        {2929}let (=Cli,PartS_2945: bitstring) = dec(ePartS_2943,skCli_2676) in
                                                                        {2930}if (verify((Cli,PartS_2945),sigPartS_2944,pkSess_2937) <> true) then
                                                                            0
                                                                        else
                                                                            {2931}let Kcli_2946: bitstring = exp(PartS_2945,Nc_2941) in
                                                                            {2932}out(c, senc(mCli(pkCli_2677,pkSess_2937),Kcli_2946))
                                                                )
                                                                else
                                                                    {2933}let pkSess_2947: bitstring = fail-any in
                                                                    {2934}out(c, GetEndpointRequest);
                                                                    {2935}in(c, (SPs_2948: bitstring,=SignAndEncrypt,UP_2949: bitstring,=pkSess_2947));
                                                                    {2936}new SPc_2950: bitstring;
                                                                    {2937}new Nc_2951: bitstring;
                                                                    {2938}let m1_2952: bitstring = (Sess,SPc_2950,exp(g,Nc_2951)) in
                                                                    {2939}out(c, (pkCli_2677,enc(m1_2952,pkSess_2947),sign(m1_2952,skCli_2676)));
                                                                    {2940}in(c, (ePartS_2953: bitstring,sigPartS_2954: bitstring));
                                                                    {2941}let (=Cli,PartS_2955: bitstring) = dec(ePartS_2953,skCli_2676) in
                                                                    {2942}if (verify((Cli,PartS_2955),sigPartS_2954,pkSess_2947) <> true) then
                                                                        0
                                                                    else
                                                                        {2943}let Kcli_2956: bitstring = exp(PartS_2955,Nc_2951) in
                                                                        {2944}out(c, senc(mCli(pkCli_2677,pkSess_2947),Kcli_2956))
                                                        )
                                                        else
                                                            {2945}let pkSess_2957: bitstring = fail-any in
                                                            {2946}out(c, GetEndpointRequest);
                                                            {2947}in(c, (SPs_2958: bitstring,=SignAndEncrypt,UP_2959: bitstring,=pkSess_2957));
                                                            {2948}new SPc_2960: bitstring;
                                                            {2949}new Nc_2961: bitstring;
                                                            {2950}let m1_2962: bitstring = (Sess,SPc_2960,exp(g,Nc_2961)) in
                                                            {2951}out(c, (pkCli_2677,enc(m1_2962,pkSess_2957),sign(m1_2962,skCli_2676)));
                                                            {2952}in(c, (ePartS_2963: bitstring,sigPartS_2964: bitstring));
                                                            {2953}let (=Cli,PartS_2965: bitstring) = dec(ePartS_2963,skCli_2676) in
                                                            {2954}if (verify((Cli,PartS_2965),sigPartS_2964,pkSess_2957) <> true) then
                                                                0
                                                            else
                                                                {2955}let Kcli_2966: bitstring = exp(PartS_2965,Nc_2961) in
                                                                {2956}out(c, senc(mCli(pkCli_2677,pkSess_2957),Kcli_2966))
                                                )
                                                else
                                                    {2957}let pkSess_2967: bitstring = fail-any in
                                                    {2958}out(c, GetEndpointRequest);
                                                    {2959}in(c, (SPs_2968: bitstring,=SignAndEncrypt,UP_2969: bitstring,=pkSess_2967));
                                                    {2960}new SPc_2970: bitstring;
                                                    {2961}new Nc_2971: bitstring;
                                                    {2962}let m1_2972: bitstring = (Sess,SPc_2970,exp(g,Nc_2971)) in
                                                    {2963}out(c, (pkCli_2677,enc(m1_2972,pkSess_2967),sign(m1_2972,skCli_2676)));
                                                    {2964}in(c, (ePartS_2973: bitstring,sigPartS_2974: bitstring));
                                                    {2965}let (=Cli,PartS_2975: bitstring) = dec(ePartS_2973,skCli_2676) in
                                                    {2966}if (verify((Cli,PartS_2975),sigPartS_2974,pkSess_2967) <> true) then
                                                        0
                                                    else
                                                        {2967}let Kcli_2976: bitstring = exp(PartS_2975,Nc_2971) in
                                                        {2968}out(c, senc(mCli(pkCli_2677,pkSess_2967),Kcli_2976))
                                        )
                                        else
                                            {2969}let pkDisco_2977: bitstring = fail-any in
                                            {2970}let v_2978: bool = (Sess = A) in
                                            (
                                                {2971}if v_2978 then
                                                (
                                                    {2972}let pkSess_2979: bitstring = pub(skA) in
                                                    {2973}out(c, GetEndpointRequest);
                                                    {2974}in(c, (SPs_2980: bitstring,=SignAndEncrypt,UP_2981: bitstring,=pkSess_2979));
                                                    {2975}new SPc_2982: bitstring;
                                                    {2976}new Nc_2983: bitstring;
                                                    {2977}let m1_2984: bitstring = (Sess,SPc_2982,exp(g,Nc_2983)) in
                                                    {2978}out(c, (pkCli_2677,enc(m1_2984,pkSess_2979),sign(m1_2984,skCli_2676)));
                                                    {2979}in(c, (ePartS_2985: bitstring,sigPartS_2986: bitstring));
                                                    {2980}let (=Cli,PartS_2987: bitstring) = dec(ePartS_2985,skCli_2676) in
                                                    {2981}if (verify((Cli,PartS_2987),sigPartS_2986,pkSess_2979) <> true) then
                                                        0
                                                    else
                                                        {2982}let Kcli_2988: bitstring = exp(PartS_2987,Nc_2983) in
                                                        {2983}out(c, senc(mCli(pkCli_2677,pkSess_2979),Kcli_2988))
                                                )
                                                else
                                                    {2984}let v_2989: bool = (Sess = B) in
                                                    (
                                                        {2985}if v_2989 then
                                                        (
                                                            {2986}let pkSess_2990: bitstring = pub(skB) in
                                                            {2987}out(c, GetEndpointRequest);
                                                            {2988}in(c, (SPs_2991: bitstring,=SignAndEncrypt,UP_2992: bitstring,=pkSess_2990));
                                                            {2989}new SPc_2993: bitstring;
                                                            {2990}new Nc_2994: bitstring;
                                                            {2991}let m1_2995: bitstring = (Sess,SPc_2993,exp(g,Nc_2994)) in
                                                            {2992}out(c, (pkCli_2677,enc(m1_2995,pkSess_2990),sign(m1_2995,skCli_2676)));
                                                            {2993}in(c, (ePartS_2996: bitstring,sigPartS_2997: bitstring));
                                                            {2994}let (=Cli,PartS_2998: bitstring) = dec(ePartS_2996,skCli_2676) in
                                                            {2995}if (verify((Cli,PartS_2998),sigPartS_2997,pkSess_2990) <> true) then
                                                                0
                                                            else
                                                                {2996}let Kcli_2999: bitstring = exp(PartS_2998,Nc_2994) in
                                                                {2997}out(c, senc(mCli(pkCli_2677,pkSess_2990),Kcli_2999))
                                                        )
                                                        else
                                                            {2998}let v_3000: bool = (Sess = C) in
                                                            (
                                                                {2999}if v_3000 then
                                                                (
                                                                    {3000}let pkSess_3001: bitstring = pub(skC) in
                                                                    {3001}out(c, GetEndpointRequest);
                                                                    {3002}in(c, (SPs_3002: bitstring,=SignAndEncrypt,UP_3003: bitstring,=pkSess_3001));
                                                                    {3003}new SPc_3004: bitstring;
                                                                    {3004}new Nc_3005: bitstring;
                                                                    {3005}let m1_3006: bitstring = (Sess,SPc_3004,exp(g,Nc_3005)) in
                                                                    {3006}out(c, (pkCli_2677,enc(m1_3006,pkSess_3001),sign(m1_3006,skCli_2676)));
                                                                    {3007}in(c, (ePartS_3007: bitstring,sigPartS_3008: bitstring));
                                                                    {3008}let (=Cli,PartS_3009: bitstring) = dec(ePartS_3007,skCli_2676) in
                                                                    {3009}if (verify((Cli,PartS_3009),sigPartS_3008,pkSess_3001) <> true) then
                                                                        0
                                                                    else
                                                                        {3010}let Kcli_3010: bitstring = exp(PartS_3009,Nc_3005) in
                                                                        {3011}out(c, senc(mCli(pkCli_2677,pkSess_3001),Kcli_3010))
                                                                )
                                                                else
                                                                    {3012}let pkSess_3011: bitstring = pub(skI) in
                                                                    {3013}out(c, GetEndpointRequest);
                                                                    {3014}in(c, (SPs_3012: bitstring,=SignAndEncrypt,UP_3013: bitstring,=pkSess_3011));
                                                                    {3015}new SPc_3014: bitstring;
                                                                    {3016}new Nc_3015: bitstring;
                                                                    {3017}let m1_3016: bitstring = (Sess,SPc_3014,exp(g,Nc_3015)) in
                                                                    {3018}out(c, (pkCli_2677,enc(m1_3016,pkSess_3011),sign(m1_3016,skCli_2676)));
                                                                    {3019}in(c, (ePartS_3017: bitstring,sigPartS_3018: bitstring));
                                                                    {3020}let (=Cli,PartS_3019: bitstring) = dec(ePartS_3017,skCli_2676) in
                                                                    {3021}if (verify((Cli,PartS_3019),sigPartS_3018,pkSess_3011) <> true) then
                                                                        0
                                                                    else
                                                                        {3022}let Kcli_3020: bitstring = exp(PartS_3019,Nc_3015) in
                                                                        {3023}out(c, senc(mCli(pkCli_2677,pkSess_3011),Kcli_3020))
                                                            )
                                                            else
                                                                {3024}let pkSess_3021: bitstring = fail-any in
                                                                {3025}out(c, GetEndpointRequest);
                                                                {3026}in(c, (SPs_3022: bitstring,=SignAndEncrypt,UP_3023: bitstring,=pkSess_3021));
                                                                {3027}new SPc_3024: bitstring;
                                                                {3028}new Nc_3025: bitstring;
                                                                {3029}let m1_3026: bitstring = (Sess,SPc_3024,exp(g,Nc_3025)) in
                                                                {3030}out(c, (pkCli_2677,enc(m1_3026,pkSess_3021),sign(m1_3026,skCli_2676)));
                                                                {3031}in(c, (ePartS_3027: bitstring,sigPartS_3028: bitstring));
                                                                {3032}let (=Cli,PartS_3029: bitstring) = dec(ePartS_3027,skCli_2676) in
                                                                {3033}if (verify((Cli,PartS_3029),sigPartS_3028,pkSess_3021) <> true) then
                                                                    0
                                                                else
                                                                    {3034}let Kcli_3030: bitstring = exp(PartS_3029,Nc_3025) in
                                                                    {3035}out(c, senc(mCli(pkCli_2677,pkSess_3021),Kcli_3030))
                                                    )
                                                    else
                                                        {3036}let pkSess_3031: bitstring = fail-any in
                                                        {3037}out(c, GetEndpointRequest);
                                                        {3038}in(c, (SPs_3032: bitstring,=SignAndEncrypt,UP_3033: bitstring,=pkSess_3031));
                                                        {3039}new SPc_3034: bitstring;
                                                        {3040}new Nc_3035: bitstring;
                                                        {3041}let m1_3036: bitstring = (Sess,SPc_3034,exp(g,Nc_3035)) in
                                                        {3042}out(c, (pkCli_2677,enc(m1_3036,pkSess_3031),sign(m1_3036,skCli_2676)));
                                                        {3043}in(c, (ePartS_3037: bitstring,sigPartS_3038: bitstring));
                                                        {3044}let (=Cli,PartS_3039: bitstring) = dec(ePartS_3037,skCli_2676) in
                                                        {3045}if (verify((Cli,PartS_3039),sigPartS_3038,pkSess_3031) <> true) then
                                                            0
                                                        else
                                                            {3046}let Kcli_3040: bitstring = exp(PartS_3039,Nc_3035) in
                                                            {3047}out(c, senc(mCli(pkCli_2677,pkSess_3031),Kcli_3040))
                                            )
                                            else
                                                {3048}let pkSess_3041: bitstring = fail-any in
                                                {3049}out(c, GetEndpointRequest);
                                                {3050}in(c, (SPs_3042: bitstring,=SignAndEncrypt,UP_3043: bitstring,=pkSess_3041));
                                                {3051}new SPc_3044: bitstring;
                                                {3052}new Nc_3045: bitstring;
                                                {3053}let m1_3046: bitstring = (Sess,SPc_3044,exp(g,Nc_3045)) in
                                                {3054}out(c, (pkCli_2677,enc(m1_3046,pkSess_3041),sign(m1_3046,skCli_2676)));
                                                {3055}in(c, (ePartS_3047: bitstring,sigPartS_3048: bitstring));
                                                {3056}let (=Cli,PartS_3049: bitstring) = dec(ePartS_3047,skCli_2676) in
                                                {3057}if (verify((Cli,PartS_3049),sigPartS_3048,pkSess_3041) <> true) then
                                                    0
                                                else
                                                    {3058}let Kcli_3050: bitstring = exp(PartS_3049,Nc_3045) in
                                                    {3059}out(c, senc(mCli(pkCli_2677,pkSess_3041),Kcli_3050))
                                )
                                else
                                    {3060}let pkDisco_3051: bitstring = fail-any in
                                    {3061}let v_3052: bool = (Sess = A) in
                                    (
                                        {3062}if v_3052 then
                                        (
                                            {3063}let pkSess_3053: bitstring = pub(skA) in
                                            {3064}out(c, GetEndpointRequest);
                                            {3065}in(c, (SPs_3054: bitstring,=SignAndEncrypt,UP_3055: bitstring,=pkSess_3053));
                                            {3066}new SPc_3056: bitstring;
                                            {3067}new Nc_3057: bitstring;
                                            {3068}let m1_3058: bitstring = (Sess,SPc_3056,exp(g,Nc_3057)) in
                                            {3069}out(c, (pkCli_2677,enc(m1_3058,pkSess_3053),sign(m1_3058,skCli_2676)));
                                            {3070}in(c, (ePartS_3059: bitstring,sigPartS_3060: bitstring));
                                            {3071}let (=Cli,PartS_3061: bitstring) = dec(ePartS_3059,skCli_2676) in
                                            {3072}if (verify((Cli,PartS_3061),sigPartS_3060,pkSess_3053) <> true) then
                                                0
                                            else
                                                {3073}let Kcli_3062: bitstring = exp(PartS_3061,Nc_3057) in
                                                {3074}out(c, senc(mCli(pkCli_2677,pkSess_3053),Kcli_3062))
                                        )
                                        else
                                            {3075}let v_3063: bool = (Sess = B) in
                                            (
                                                {3076}if v_3063 then
                                                (
                                                    {3077}let pkSess_3064: bitstring = pub(skB) in
                                                    {3078}out(c, GetEndpointRequest);
                                                    {3079}in(c, (SPs_3065: bitstring,=SignAndEncrypt,UP_3066: bitstring,=pkSess_3064));
                                                    {3080}new SPc_3067: bitstring;
                                                    {3081}new Nc_3068: bitstring;
                                                    {3082}let m1_3069: bitstring = (Sess,SPc_3067,exp(g,Nc_3068)) in
                                                    {3083}out(c, (pkCli_2677,enc(m1_3069,pkSess_3064),sign(m1_3069,skCli_2676)));
                                                    {3084}in(c, (ePartS_3070: bitstring,sigPartS_3071: bitstring));
                                                    {3085}let (=Cli,PartS_3072: bitstring) = dec(ePartS_3070,skCli_2676) in
                                                    {3086}if (verify((Cli,PartS_3072),sigPartS_3071,pkSess_3064) <> true) then
                                                        0
                                                    else
                                                        {3087}let Kcli_3073: bitstring = exp(PartS_3072,Nc_3068) in
                                                        {3088}out(c, senc(mCli(pkCli_2677,pkSess_3064),Kcli_3073))
                                                )
                                                else
                                                    {3089}let v_3074: bool = (Sess = C) in
                                                    (
                                                        {3090}if v_3074 then
                                                        (
                                                            {3091}let pkSess_3075: bitstring = pub(skC) in
                                                            {3092}out(c, GetEndpointRequest);
                                                            {3093}in(c, (SPs_3076: bitstring,=SignAndEncrypt,UP_3077: bitstring,=pkSess_3075));
                                                            {3094}new SPc_3078: bitstring;
                                                            {3095}new Nc_3079: bitstring;
                                                            {3096}let m1_3080: bitstring = (Sess,SPc_3078,exp(g,Nc_3079)) in
                                                            {3097}out(c, (pkCli_2677,enc(m1_3080,pkSess_3075),sign(m1_3080,skCli_2676)));
                                                            {3098}in(c, (ePartS_3081: bitstring,sigPartS_3082: bitstring));
                                                            {3099}let (=Cli,PartS_3083: bitstring) = dec(ePartS_3081,skCli_2676) in
                                                            {3100}if (verify((Cli,PartS_3083),sigPartS_3082,pkSess_3075) <> true) then
                                                                0
                                                            else
                                                                {3101}let Kcli_3084: bitstring = exp(PartS_3083,Nc_3079) in
                                                                {3102}out(c, senc(mCli(pkCli_2677,pkSess_3075),Kcli_3084))
                                                        )
                                                        else
                                                            {3103}let pkSess_3085: bitstring = pub(skI) in
                                                            {3104}out(c, GetEndpointRequest);
                                                            {3105}in(c, (SPs_3086: bitstring,=SignAndEncrypt,UP_3087: bitstring,=pkSess_3085));
                                                            {3106}new SPc_3088: bitstring;
                                                            {3107}new Nc_3089: bitstring;
                                                            {3108}let m1_3090: bitstring = (Sess,SPc_3088,exp(g,Nc_3089)) in
                                                            {3109}out(c, (pkCli_2677,enc(m1_3090,pkSess_3085),sign(m1_3090,skCli_2676)));
                                                            {3110}in(c, (ePartS_3091: bitstring,sigPartS_3092: bitstring));
                                                            {3111}let (=Cli,PartS_3093: bitstring) = dec(ePartS_3091,skCli_2676) in
                                                            {3112}if (verify((Cli,PartS_3093),sigPartS_3092,pkSess_3085) <> true) then
                                                                0
                                                            else
                                                                {3113}let Kcli_3094: bitstring = exp(PartS_3093,Nc_3089) in
                                                                {3114}out(c, senc(mCli(pkCli_2677,pkSess_3085),Kcli_3094))
                                                    )
                                                    else
                                                        {3115}let pkSess_3095: bitstring = fail-any in
                                                        {3116}out(c, GetEndpointRequest);
                                                        {3117}in(c, (SPs_3096: bitstring,=SignAndEncrypt,UP_3097: bitstring,=pkSess_3095));
                                                        {3118}new SPc_3098: bitstring;
                                                        {3119}new Nc_3099: bitstring;
                                                        {3120}let m1_3100: bitstring = (Sess,SPc_3098,exp(g,Nc_3099)) in
                                                        {3121}out(c, (pkCli_2677,enc(m1_3100,pkSess_3095),sign(m1_3100,skCli_2676)));
                                                        {3122}in(c, (ePartS_3101: bitstring,sigPartS_3102: bitstring));
                                                        {3123}let (=Cli,PartS_3103: bitstring) = dec(ePartS_3101,skCli_2676) in
                                                        {3124}if (verify((Cli,PartS_3103),sigPartS_3102,pkSess_3095) <> true) then
                                                            0
                                                        else
                                                            {3125}let Kcli_3104: bitstring = exp(PartS_3103,Nc_3099) in
                                                            {3126}out(c, senc(mCli(pkCli_2677,pkSess_3095),Kcli_3104))
                                            )
                                            else
                                                {3127}let pkSess_3105: bitstring = fail-any in
                                                {3128}out(c, GetEndpointRequest);
                                                {3129}in(c, (SPs_3106: bitstring,=SignAndEncrypt,UP_3107: bitstring,=pkSess_3105));
                                                {3130}new SPc_3108: bitstring;
                                                {3131}new Nc_3109: bitstring;
                                                {3132}let m1_3110: bitstring = (Sess,SPc_3108,exp(g,Nc_3109)) in
                                                {3133}out(c, (pkCli_2677,enc(m1_3110,pkSess_3105),sign(m1_3110,skCli_2676)));
                                                {3134}in(c, (ePartS_3111: bitstring,sigPartS_3112: bitstring));
                                                {3135}let (=Cli,PartS_3113: bitstring) = dec(ePartS_3111,skCli_2676) in
                                                {3136}if (verify((Cli,PartS_3113),sigPartS_3112,pkSess_3105) <> true) then
                                                    0
                                                else
                                                    {3137}let Kcli_3114: bitstring = exp(PartS_3113,Nc_3109) in
                                                    {3138}out(c, senc(mCli(pkCli_2677,pkSess_3105),Kcli_3114))
                                    )
                                    else
                                        {3139}let pkSess_3115: bitstring = fail-any in
                                        {3140}out(c, GetEndpointRequest);
                                        {3141}in(c, (SPs_3116: bitstring,=SignAndEncrypt,UP_3117: bitstring,=pkSess_3115));
                                        {3142}new SPc_3118: bitstring;
                                        {3143}new Nc_3119: bitstring;
                                        {3144}let m1_3120: bitstring = (Sess,SPc_3118,exp(g,Nc_3119)) in
                                        {3145}out(c, (pkCli_2677,enc(m1_3120,pkSess_3115),sign(m1_3120,skCli_2676)));
                                        {3146}in(c, (ePartS_3121: bitstring,sigPartS_3122: bitstring));
                                        {3147}let (=Cli,PartS_3123: bitstring) = dec(ePartS_3121,skCli_2676) in
                                        {3148}if (verify((Cli,PartS_3123),sigPartS_3122,pkSess_3115) <> true) then
                                            0
                                        else
                                            {3149}let Kcli_3124: bitstring = exp(PartS_3123,Nc_3119) in
                                            {3150}out(c, senc(mCli(pkCli_2677,pkSess_3115),Kcli_3124))
                        )
                        else
                            {3151}let pkDisco_3125: bitstring = fail-any in
                            {3152}let v_3126: bool = (Sess = A) in
                            (
                                {3153}if v_3126 then
                                (
                                    {3154}let pkSess_3127: bitstring = pub(skA) in
                                    {3155}out(c, GetEndpointRequest);
                                    {3156}in(c, (SPs_3128: bitstring,=SignAndEncrypt,UP_3129: bitstring,=pkSess_3127));
                                    {3157}new SPc_3130: bitstring;
                                    {3158}new Nc_3131: bitstring;
                                    {3159}let m1_3132: bitstring = (Sess,SPc_3130,exp(g,Nc_3131)) in
                                    {3160}out(c, (pkCli_2677,enc(m1_3132,pkSess_3127),sign(m1_3132,skCli_2676)));
                                    {3161}in(c, (ePartS_3133: bitstring,sigPartS_3134: bitstring));
                                    {3162}let (=Cli,PartS_3135: bitstring) = dec(ePartS_3133,skCli_2676) in
                                    {3163}if (verify((Cli,PartS_3135),sigPartS_3134,pkSess_3127) <> true) then
                                        0
                                    else
                                        {3164}let Kcli_3136: bitstring = exp(PartS_3135,Nc_3131) in
                                        {3165}out(c, senc(mCli(pkCli_2677,pkSess_3127),Kcli_3136))
                                )
                                else
                                    {3166}let v_3137: bool = (Sess = B) in
                                    (
                                        {3167}if v_3137 then
                                        (
                                            {3168}let pkSess_3138: bitstring = pub(skB) in
                                            {3169}out(c, GetEndpointRequest);
                                            {3170}in(c, (SPs_3139: bitstring,=SignAndEncrypt,UP_3140: bitstring,=pkSess_3138));
                                            {3171}new SPc_3141: bitstring;
                                            {3172}new Nc_3142: bitstring;
                                            {3173}let m1_3143: bitstring = (Sess,SPc_3141,exp(g,Nc_3142)) in
                                            {3174}out(c, (pkCli_2677,enc(m1_3143,pkSess_3138),sign(m1_3143,skCli_2676)));
                                            {3175}in(c, (ePartS_3144: bitstring,sigPartS_3145: bitstring));
                                            {3176}let (=Cli,PartS_3146: bitstring) = dec(ePartS_3144,skCli_2676) in
                                            {3177}if (verify((Cli,PartS_3146),sigPartS_3145,pkSess_3138) <> true) then
                                                0
                                            else
                                                {3178}let Kcli_3147: bitstring = exp(PartS_3146,Nc_3142) in
                                                {3179}out(c, senc(mCli(pkCli_2677,pkSess_3138),Kcli_3147))
                                        )
                                        else
                                            {3180}let v_3148: bool = (Sess = C) in
                                            (
                                                {3181}if v_3148 then
                                                (
                                                    {3182}let pkSess_3149: bitstring = pub(skC) in
                                                    {3183}out(c, GetEndpointRequest);
                                                    {3184}in(c, (SPs_3150: bitstring,=SignAndEncrypt,UP_3151: bitstring,=pkSess_3149));
                                                    {3185}new SPc_3152: bitstring;
                                                    {3186}new Nc_3153: bitstring;
                                                    {3187}let m1_3154: bitstring = (Sess,SPc_3152,exp(g,Nc_3153)) in
                                                    {3188}out(c, (pkCli_2677,enc(m1_3154,pkSess_3149),sign(m1_3154,skCli_2676)));
                                                    {3189}in(c, (ePartS_3155: bitstring,sigPartS_3156: bitstring));
                                                    {3190}let (=Cli,PartS_3157: bitstring) = dec(ePartS_3155,skCli_2676) in
                                                    {3191}if (verify((Cli,PartS_3157),sigPartS_3156,pkSess_3149) <> true) then
                                                        0
                                                    else
                                                        {3192}let Kcli_3158: bitstring = exp(PartS_3157,Nc_3153) in
                                                        {3193}out(c, senc(mCli(pkCli_2677,pkSess_3149),Kcli_3158))
                                                )
                                                else
                                                    {3194}let pkSess_3159: bitstring = pub(skI) in
                                                    {3195}out(c, GetEndpointRequest);
                                                    {3196}in(c, (SPs_3160: bitstring,=SignAndEncrypt,UP_3161: bitstring,=pkSess_3159));
                                                    {3197}new SPc_3162: bitstring;
                                                    {3198}new Nc_3163: bitstring;
                                                    {3199}let m1_3164: bitstring = (Sess,SPc_3162,exp(g,Nc_3163)) in
                                                    {3200}out(c, (pkCli_2677,enc(m1_3164,pkSess_3159),sign(m1_3164,skCli_2676)));
                                                    {3201}in(c, (ePartS_3165: bitstring,sigPartS_3166: bitstring));
                                                    {3202}let (=Cli,PartS_3167: bitstring) = dec(ePartS_3165,skCli_2676) in
                                                    {3203}if (verify((Cli,PartS_3167),sigPartS_3166,pkSess_3159) <> true) then
                                                        0
                                                    else
                                                        {3204}let Kcli_3168: bitstring = exp(PartS_3167,Nc_3163) in
                                                        {3205}out(c, senc(mCli(pkCli_2677,pkSess_3159),Kcli_3168))
                                            )
                                            else
                                                {3206}let pkSess_3169: bitstring = fail-any in
                                                {3207}out(c, GetEndpointRequest);
                                                {3208}in(c, (SPs_3170: bitstring,=SignAndEncrypt,UP_3171: bitstring,=pkSess_3169));
                                                {3209}new SPc_3172: bitstring;
                                                {3210}new Nc_3173: bitstring;
                                                {3211}let m1_3174: bitstring = (Sess,SPc_3172,exp(g,Nc_3173)) in
                                                {3212}out(c, (pkCli_2677,enc(m1_3174,pkSess_3169),sign(m1_3174,skCli_2676)));
                                                {3213}in(c, (ePartS_3175: bitstring,sigPartS_3176: bitstring));
                                                {3214}let (=Cli,PartS_3177: bitstring) = dec(ePartS_3175,skCli_2676) in
                                                {3215}if (verify((Cli,PartS_3177),sigPartS_3176,pkSess_3169) <> true) then
                                                    0
                                                else
                                                    {3216}let Kcli_3178: bitstring = exp(PartS_3177,Nc_3173) in
                                                    {3217}out(c, senc(mCli(pkCli_2677,pkSess_3169),Kcli_3178))
                                    )
                                    else
                                        {3218}let pkSess_3179: bitstring = fail-any in
                                        {3219}out(c, GetEndpointRequest);
                                        {3220}in(c, (SPs_3180: bitstring,=SignAndEncrypt,UP_3181: bitstring,=pkSess_3179));
                                        {3221}new SPc_3182: bitstring;
                                        {3222}new Nc_3183: bitstring;
                                        {3223}let m1_3184: bitstring = (Sess,SPc_3182,exp(g,Nc_3183)) in
                                        {3224}out(c, (pkCli_2677,enc(m1_3184,pkSess_3179),sign(m1_3184,skCli_2676)));
                                        {3225}in(c, (ePartS_3185: bitstring,sigPartS_3186: bitstring));
                                        {3226}let (=Cli,PartS_3187: bitstring) = dec(ePartS_3185,skCli_2676) in
                                        {3227}if (verify((Cli,PartS_3187),sigPartS_3186,pkSess_3179) <> true) then
                                            0
                                        else
                                            {3228}let Kcli_3188: bitstring = exp(PartS_3187,Nc_3183) in
                                            {3229}out(c, senc(mCli(pkCli_2677,pkSess_3179),Kcli_3188))
                            )
                            else
                                {3230}let pkSess_3189: bitstring = fail-any in
                                {3231}out(c, GetEndpointRequest);
                                {3232}in(c, (SPs_3190: bitstring,=SignAndEncrypt,UP_3191: bitstring,=pkSess_3189));
                                {3233}new SPc_3192: bitstring;
                                {3234}new Nc_3193: bitstring;
                                {3235}let m1_3194: bitstring = (Sess,SPc_3192,exp(g,Nc_3193)) in
                                {3236}out(c, (pkCli_2677,enc(m1_3194,pkSess_3189),sign(m1_3194,skCli_2676)));
                                {3237}in(c, (ePartS_3195: bitstring,sigPartS_3196: bitstring));
                                {3238}let (=Cli,PartS_3197: bitstring) = dec(ePartS_3195,skCli_2676) in
                                {3239}if (verify((Cli,PartS_3197),sigPartS_3196,pkSess_3189) <> true) then
                                    0
                                else
                                    {3240}let Kcli_3198: bitstring = exp(PartS_3197,Nc_3193) in
                                    {3241}out(c, senc(mCli(pkCli_2677,pkSess_3189),Kcli_3198))
            )
            else
                {3242}let skCli_3199: bitstring = fail-any in
                {3243}let pkCli_3200: bitstring = pub(skCli_3199) in
                {3244}let v_3201: bool = (Disco = A) in
                (
                    {3245}if v_3201 then
                    (
                        {3246}let pkDisco_3202: bitstring = pub(skA) in
                        {3247}let v_3203: bool = (Sess = A) in
                        (
                            {3248}if v_3203 then
                            (
                                {3249}let pkSess_3204: bitstring = pub(skA) in
                                {3250}out(c, GetEndpointRequest);
                                {3251}in(c, (SPs_3205: bitstring,=SignAndEncrypt,UP_3206: bitstring,=pkSess_3204));
                                {3252}new SPc_3207: bitstring;
                                {3253}new Nc_3208: bitstring;
                                {3254}let m1_3209: bitstring = (Sess,SPc_3207,exp(g,Nc_3208)) in
                                {3255}out(c, (pkCli_3200,enc(m1_3209,pkSess_3204),sign(m1_3209,skCli_3199)));
                                {3256}in(c, (ePartS_3210: bitstring,sigPartS_3211: bitstring));
                                {3257}let (=Cli,PartS_3212: bitstring) = dec(ePartS_3210,skCli_3199) in
                                {3258}if (verify((Cli,PartS_3212),sigPartS_3211,pkSess_3204) <> true) then
                                    0
                                else
                                    {3259}let Kcli_3213: bitstring = exp(PartS_3212,Nc_3208) in
                                    {3260}out(c, senc(mCli(pkCli_3200,pkSess_3204),Kcli_3213))
                            )
                            else
                                {3261}let v_3214: bool = (Sess = B) in
                                (
                                    {3262}if v_3214 then
                                    (
                                        {3263}let pkSess_3215: bitstring = pub(skB) in
                                        {3264}out(c, GetEndpointRequest);
                                        {3265}in(c, (SPs_3216: bitstring,=SignAndEncrypt,UP_3217: bitstring,=pkSess_3215));
                                        {3266}new SPc_3218: bitstring;
                                        {3267}new Nc_3219: bitstring;
                                        {3268}let m1_3220: bitstring = (Sess,SPc_3218,exp(g,Nc_3219)) in
                                        {3269}out(c, (pkCli_3200,enc(m1_3220,pkSess_3215),sign(m1_3220,skCli_3199)));
                                        {3270}in(c, (ePartS_3221: bitstring,sigPartS_3222: bitstring));
                                        {3271}let (=Cli,PartS_3223: bitstring) = dec(ePartS_3221,skCli_3199) in
                                        {3272}if (verify((Cli,PartS_3223),sigPartS_3222,pkSess_3215) <> true) then
                                            0
                                        else
                                            {3273}let Kcli_3224: bitstring = exp(PartS_3223,Nc_3219) in
                                            {3274}out(c, senc(mCli(pkCli_3200,pkSess_3215),Kcli_3224))
                                    )
                                    else
                                        {3275}let v_3225: bool = (Sess = C) in
                                        (
                                            {3276}if v_3225 then
                                            (
                                                {3277}let pkSess_3226: bitstring = pub(skC) in
                                                {3278}out(c, GetEndpointRequest);
                                                {3279}in(c, (SPs_3227: bitstring,=SignAndEncrypt,UP_3228: bitstring,=pkSess_3226));
                                                {3280}new SPc_3229: bitstring;
                                                {3281}new Nc_3230: bitstring;
                                                {3282}let m1_3231: bitstring = (Sess,SPc_3229,exp(g,Nc_3230)) in
                                                {3283}out(c, (pkCli_3200,enc(m1_3231,pkSess_3226),sign(m1_3231,skCli_3199)));
                                                {3284}in(c, (ePartS_3232: bitstring,sigPartS_3233: bitstring));
                                                {3285}let (=Cli,PartS_3234: bitstring) = dec(ePartS_3232,skCli_3199) in
                                                {3286}if (verify((Cli,PartS_3234),sigPartS_3233,pkSess_3226) <> true) then
                                                    0
                                                else
                                                    {3287}let Kcli_3235: bitstring = exp(PartS_3234,Nc_3230) in
                                                    {3288}out(c, senc(mCli(pkCli_3200,pkSess_3226),Kcli_3235))
                                            )
                                            else
                                                {3289}let pkSess_3236: bitstring = pub(skI) in
                                                {3290}out(c, GetEndpointRequest);
                                                {3291}in(c, (SPs_3237: bitstring,=SignAndEncrypt,UP_3238: bitstring,=pkSess_3236));
                                                {3292}new SPc_3239: bitstring;
                                                {3293}new Nc_3240: bitstring;
                                                {3294}let m1_3241: bitstring = (Sess,SPc_3239,exp(g,Nc_3240)) in
                                                {3295}out(c, (pkCli_3200,enc(m1_3241,pkSess_3236),sign(m1_3241,skCli_3199)));
                                                {3296}in(c, (ePartS_3242: bitstring,sigPartS_3243: bitstring));
                                                {3297}let (=Cli,PartS_3244: bitstring) = dec(ePartS_3242,skCli_3199) in
                                                {3298}if (verify((Cli,PartS_3244),sigPartS_3243,pkSess_3236) <> true) then
                                                    0
                                                else
                                                    {3299}let Kcli_3245: bitstring = exp(PartS_3244,Nc_3240) in
                                                    {3300}out(c, senc(mCli(pkCli_3200,pkSess_3236),Kcli_3245))
                                        )
                                        else
                                            {3301}let pkSess_3246: bitstring = fail-any in
                                            {3302}out(c, GetEndpointRequest);
                                            {3303}in(c, (SPs_3247: bitstring,=SignAndEncrypt,UP_3248: bitstring,=pkSess_3246));
                                            {3304}new SPc_3249: bitstring;
                                            {3305}new Nc_3250: bitstring;
                                            {3306}let m1_3251: bitstring = (Sess,SPc_3249,exp(g,Nc_3250)) in
                                            {3307}out(c, (pkCli_3200,enc(m1_3251,pkSess_3246),sign(m1_3251,skCli_3199)));
                                            {3308}in(c, (ePartS_3252: bitstring,sigPartS_3253: bitstring));
                                            {3309}let (=Cli,PartS_3254: bitstring) = dec(ePartS_3252,skCli_3199) in
                                            {3310}if (verify((Cli,PartS_3254),sigPartS_3253,pkSess_3246) <> true) then
                                                0
                                            else
                                                {3311}let Kcli_3255: bitstring = exp(PartS_3254,Nc_3250) in
                                                {3312}out(c, senc(mCli(pkCli_3200,pkSess_3246),Kcli_3255))
                                )
                                else
                                    {3313}let pkSess_3256: bitstring = fail-any in
                                    {3314}out(c, GetEndpointRequest);
                                    {3315}in(c, (SPs_3257: bitstring,=SignAndEncrypt,UP_3258: bitstring,=pkSess_3256));
                                    {3316}new SPc_3259: bitstring;
                                    {3317}new Nc_3260: bitstring;
                                    {3318}let m1_3261: bitstring = (Sess,SPc_3259,exp(g,Nc_3260)) in
                                    {3319}out(c, (pkCli_3200,enc(m1_3261,pkSess_3256),sign(m1_3261,skCli_3199)));
                                    {3320}in(c, (ePartS_3262: bitstring,sigPartS_3263: bitstring));
                                    {3321}let (=Cli,PartS_3264: bitstring) = dec(ePartS_3262,skCli_3199) in
                                    {3322}if (verify((Cli,PartS_3264),sigPartS_3263,pkSess_3256) <> true) then
                                        0
                                    else
                                        {3323}let Kcli_3265: bitstring = exp(PartS_3264,Nc_3260) in
                                        {3324}out(c, senc(mCli(pkCli_3200,pkSess_3256),Kcli_3265))
                        )
                        else
                            {3325}let pkSess_3266: bitstring = fail-any in
                            {3326}out(c, GetEndpointRequest);
                            {3327}in(c, (SPs_3267: bitstring,=SignAndEncrypt,UP_3268: bitstring,=pkSess_3266));
                            {3328}new SPc_3269: bitstring;
                            {3329}new Nc_3270: bitstring;
                            {3330}let m1_3271: bitstring = (Sess,SPc_3269,exp(g,Nc_3270)) in
                            {3331}out(c, (pkCli_3200,enc(m1_3271,pkSess_3266),sign(m1_3271,skCli_3199)));
                            {3332}in(c, (ePartS_3272: bitstring,sigPartS_3273: bitstring));
                            {3333}let (=Cli,PartS_3274: bitstring) = dec(ePartS_3272,skCli_3199) in
                            {3334}if (verify((Cli,PartS_3274),sigPartS_3273,pkSess_3266) <> true) then
                                0
                            else
                                {3335}let Kcli_3275: bitstring = exp(PartS_3274,Nc_3270) in
                                {3336}out(c, senc(mCli(pkCli_3200,pkSess_3266),Kcli_3275))
                    )
                    else
                        {3337}let v_3276: bool = (Disco = B) in
                        (
                            {3338}if v_3276 then
                            (
                                {3339}let pkDisco_3277: bitstring = pub(skB) in
                                {3340}let v_3278: bool = (Sess = A) in
                                (
                                    {3341}if v_3278 then
                                    (
                                        {3342}let pkSess_3279: bitstring = pub(skA) in
                                        {3343}out(c, GetEndpointRequest);
                                        {3344}in(c, (SPs_3280: bitstring,=SignAndEncrypt,UP_3281: bitstring,=pkSess_3279));
                                        {3345}new SPc_3282: bitstring;
                                        {3346}new Nc_3283: bitstring;
                                        {3347}let m1_3284: bitstring = (Sess,SPc_3282,exp(g,Nc_3283)) in
                                        {3348}out(c, (pkCli_3200,enc(m1_3284,pkSess_3279),sign(m1_3284,skCli_3199)));
                                        {3349}in(c, (ePartS_3285: bitstring,sigPartS_3286: bitstring));
                                        {3350}let (=Cli,PartS_3287: bitstring) = dec(ePartS_3285,skCli_3199) in
                                        {3351}if (verify((Cli,PartS_3287),sigPartS_3286,pkSess_3279) <> true) then
                                            0
                                        else
                                            {3352}let Kcli_3288: bitstring = exp(PartS_3287,Nc_3283) in
                                            {3353}out(c, senc(mCli(pkCli_3200,pkSess_3279),Kcli_3288))
                                    )
                                    else
                                        {3354}let v_3289: bool = (Sess = B) in
                                        (
                                            {3355}if v_3289 then
                                            (
                                                {3356}let pkSess_3290: bitstring = pub(skB) in
                                                {3357}out(c, GetEndpointRequest);
                                                {3358}in(c, (SPs_3291: bitstring,=SignAndEncrypt,UP_3292: bitstring,=pkSess_3290));
                                                {3359}new SPc_3293: bitstring;
                                                {3360}new Nc_3294: bitstring;
                                                {3361}let m1_3295: bitstring = (Sess,SPc_3293,exp(g,Nc_3294)) in
                                                {3362}out(c, (pkCli_3200,enc(m1_3295,pkSess_3290),sign(m1_3295,skCli_3199)));
                                                {3363}in(c, (ePartS_3296: bitstring,sigPartS_3297: bitstring));
                                                {3364}let (=Cli,PartS_3298: bitstring) = dec(ePartS_3296,skCli_3199) in
                                                {3365}if (verify((Cli,PartS_3298),sigPartS_3297,pkSess_3290) <> true) then
                                                    0
                                                else
                                                    {3366}let Kcli_3299: bitstring = exp(PartS_3298,Nc_3294) in
                                                    {3367}out(c, senc(mCli(pkCli_3200,pkSess_3290),Kcli_3299))
                                            )
                                            else
                                                {3368}let v_3300: bool = (Sess = C) in
                                                (
                                                    {3369}if v_3300 then
                                                    (
                                                        {3370}let pkSess_3301: bitstring = pub(skC) in
                                                        {3371}out(c, GetEndpointRequest);
                                                        {3372}in(c, (SPs_3302: bitstring,=SignAndEncrypt,UP_3303: bitstring,=pkSess_3301));
                                                        {3373}new SPc_3304: bitstring;
                                                        {3374}new Nc_3305: bitstring;
                                                        {3375}let m1_3306: bitstring = (Sess,SPc_3304,exp(g,Nc_3305)) in
                                                        {3376}out(c, (pkCli_3200,enc(m1_3306,pkSess_3301),sign(m1_3306,skCli_3199)));
                                                        {3377}in(c, (ePartS_3307: bitstring,sigPartS_3308: bitstring));
                                                        {3378}let (=Cli,PartS_3309: bitstring) = dec(ePartS_3307,skCli_3199) in
                                                        {3379}if (verify((Cli,PartS_3309),sigPartS_3308,pkSess_3301) <> true) then
                                                            0
                                                        else
                                                            {3380}let Kcli_3310: bitstring = exp(PartS_3309,Nc_3305) in
                                                            {3381}out(c, senc(mCli(pkCli_3200,pkSess_3301),Kcli_3310))
                                                    )
                                                    else
                                                        {3382}let pkSess_3311: bitstring = pub(skI) in
                                                        {3383}out(c, GetEndpointRequest);
                                                        {3384}in(c, (SPs_3312: bitstring,=SignAndEncrypt,UP_3313: bitstring,=pkSess_3311));
                                                        {3385}new SPc_3314: bitstring;
                                                        {3386}new Nc_3315: bitstring;
                                                        {3387}let m1_3316: bitstring = (Sess,SPc_3314,exp(g,Nc_3315)) in
                                                        {3388}out(c, (pkCli_3200,enc(m1_3316,pkSess_3311),sign(m1_3316,skCli_3199)));
                                                        {3389}in(c, (ePartS_3317: bitstring,sigPartS_3318: bitstring));
                                                        {3390}let (=Cli,PartS_3319: bitstring) = dec(ePartS_3317,skCli_3199) in
                                                        {3391}if (verify((Cli,PartS_3319),sigPartS_3318,pkSess_3311) <> true) then
                                                            0
                                                        else
                                                            {3392}let Kcli_3320: bitstring = exp(PartS_3319,Nc_3315) in
                                                            {3393}out(c, senc(mCli(pkCli_3200,pkSess_3311),Kcli_3320))
                                                )
                                                else
                                                    {3394}let pkSess_3321: bitstring = fail-any in
                                                    {3395}out(c, GetEndpointRequest);
                                                    {3396}in(c, (SPs_3322: bitstring,=SignAndEncrypt,UP_3323: bitstring,=pkSess_3321));
                                                    {3397}new SPc_3324: bitstring;
                                                    {3398}new Nc_3325: bitstring;
                                                    {3399}let m1_3326: bitstring = (Sess,SPc_3324,exp(g,Nc_3325)) in
                                                    {3400}out(c, (pkCli_3200,enc(m1_3326,pkSess_3321),sign(m1_3326,skCli_3199)));
                                                    {3401}in(c, (ePartS_3327: bitstring,sigPartS_3328: bitstring));
                                                    {3402}let (=Cli,PartS_3329: bitstring) = dec(ePartS_3327,skCli_3199) in
                                                    {3403}if (verify((Cli,PartS_3329),sigPartS_3328,pkSess_3321) <> true) then
                                                        0
                                                    else
                                                        {3404}let Kcli_3330: bitstring = exp(PartS_3329,Nc_3325) in
                                                        {3405}out(c, senc(mCli(pkCli_3200,pkSess_3321),Kcli_3330))
                                        )
                                        else
                                            {3406}let pkSess_3331: bitstring = fail-any in
                                            {3407}out(c, GetEndpointRequest);
                                            {3408}in(c, (SPs_3332: bitstring,=SignAndEncrypt,UP_3333: bitstring,=pkSess_3331));
                                            {3409}new SPc_3334: bitstring;
                                            {3410}new Nc_3335: bitstring;
                                            {3411}let m1_3336: bitstring = (Sess,SPc_3334,exp(g,Nc_3335)) in
                                            {3412}out(c, (pkCli_3200,enc(m1_3336,pkSess_3331),sign(m1_3336,skCli_3199)));
                                            {3413}in(c, (ePartS_3337: bitstring,sigPartS_3338: bitstring));
                                            {3414}let (=Cli,PartS_3339: bitstring) = dec(ePartS_3337,skCli_3199) in
                                            {3415}if (verify((Cli,PartS_3339),sigPartS_3338,pkSess_3331) <> true) then
                                                0
                                            else
                                                {3416}let Kcli_3340: bitstring = exp(PartS_3339,Nc_3335) in
                                                {3417}out(c, senc(mCli(pkCli_3200,pkSess_3331),Kcli_3340))
                                )
                                else
                                    {3418}let pkSess_3341: bitstring = fail-any in
                                    {3419}out(c, GetEndpointRequest);
                                    {3420}in(c, (SPs_3342: bitstring,=SignAndEncrypt,UP_3343: bitstring,=pkSess_3341));
                                    {3421}new SPc_3344: bitstring;
                                    {3422}new Nc_3345: bitstring;
                                    {3423}let m1_3346: bitstring = (Sess,SPc_3344,exp(g,Nc_3345)) in
                                    {3424}out(c, (pkCli_3200,enc(m1_3346,pkSess_3341),sign(m1_3346,skCli_3199)));
                                    {3425}in(c, (ePartS_3347: bitstring,sigPartS_3348: bitstring));
                                    {3426}let (=Cli,PartS_3349: bitstring) = dec(ePartS_3347,skCli_3199) in
                                    {3427}if (verify((Cli,PartS_3349),sigPartS_3348,pkSess_3341) <> true) then
                                        0
                                    else
                                        {3428}let Kcli_3350: bitstring = exp(PartS_3349,Nc_3345) in
                                        {3429}out(c, senc(mCli(pkCli_3200,pkSess_3341),Kcli_3350))
                            )
                            else
                                {3430}let v_3351: bool = (Disco = C) in
                                (
                                    {3431}if v_3351 then
                                    (
                                        {3432}let pkDisco_3352: bitstring = pub(skC) in
                                        {3433}let v_3353: bool = (Sess = A) in
                                        (
                                            {3434}if v_3353 then
                                            (
                                                {3435}let pkSess_3354: bitstring = pub(skA) in
                                                {3436}out(c, GetEndpointRequest);
                                                {3437}in(c, (SPs_3355: bitstring,=SignAndEncrypt,UP_3356: bitstring,=pkSess_3354));
                                                {3438}new SPc_3357: bitstring;
                                                {3439}new Nc_3358: bitstring;
                                                {3440}let m1_3359: bitstring = (Sess,SPc_3357,exp(g,Nc_3358)) in
                                                {3441}out(c, (pkCli_3200,enc(m1_3359,pkSess_3354),sign(m1_3359,skCli_3199)));
                                                {3442}in(c, (ePartS_3360: bitstring,sigPartS_3361: bitstring));
                                                {3443}let (=Cli,PartS_3362: bitstring) = dec(ePartS_3360,skCli_3199) in
                                                {3444}if (verify((Cli,PartS_3362),sigPartS_3361,pkSess_3354) <> true) then
                                                    0
                                                else
                                                    {3445}let Kcli_3363: bitstring = exp(PartS_3362,Nc_3358) in
                                                    {3446}out(c, senc(mCli(pkCli_3200,pkSess_3354),Kcli_3363))
                                            )
                                            else
                                                {3447}let v_3364: bool = (Sess = B) in
                                                (
                                                    {3448}if v_3364 then
                                                    (
                                                        {3449}let pkSess_3365: bitstring = pub(skB) in
                                                        {3450}out(c, GetEndpointRequest);
                                                        {3451}in(c, (SPs_3366: bitstring,=SignAndEncrypt,UP_3367: bitstring,=pkSess_3365));
                                                        {3452}new SPc_3368: bitstring;
                                                        {3453}new Nc_3369: bitstring;
                                                        {3454}let m1_3370: bitstring = (Sess,SPc_3368,exp(g,Nc_3369)) in
                                                        {3455}out(c, (pkCli_3200,enc(m1_3370,pkSess_3365),sign(m1_3370,skCli_3199)));
                                                        {3456}in(c, (ePartS_3371: bitstring,sigPartS_3372: bitstring));
                                                        {3457}let (=Cli,PartS_3373: bitstring) = dec(ePartS_3371,skCli_3199) in
                                                        {3458}if (verify((Cli,PartS_3373),sigPartS_3372,pkSess_3365) <> true) then
                                                            0
                                                        else
                                                            {3459}let Kcli_3374: bitstring = exp(PartS_3373,Nc_3369) in
                                                            {3460}out(c, senc(mCli(pkCli_3200,pkSess_3365),Kcli_3374))
                                                    )
                                                    else
                                                        {3461}let v_3375: bool = (Sess = C) in
                                                        (
                                                            {3462}if v_3375 then
                                                            (
                                                                {3463}let pkSess_3376: bitstring = pub(skC) in
                                                                {3464}out(c, GetEndpointRequest);
                                                                {3465}in(c, (SPs_3377: bitstring,=SignAndEncrypt,UP_3378: bitstring,=pkSess_3376));
                                                                {3466}new SPc_3379: bitstring;
                                                                {3467}new Nc_3380: bitstring;
                                                                {3468}let m1_3381: bitstring = (Sess,SPc_3379,exp(g,Nc_3380)) in
                                                                {3469}out(c, (pkCli_3200,enc(m1_3381,pkSess_3376),sign(m1_3381,skCli_3199)));
                                                                {3470}in(c, (ePartS_3382: bitstring,sigPartS_3383: bitstring));
                                                                {3471}let (=Cli,PartS_3384: bitstring) = dec(ePartS_3382,skCli_3199) in
                                                                {3472}if (verify((Cli,PartS_3384),sigPartS_3383,pkSess_3376) <> true) then
                                                                    0
                                                                else
                                                                    {3473}let Kcli_3385: bitstring = exp(PartS_3384,Nc_3380) in
                                                                    {3474}out(c, senc(mCli(pkCli_3200,pkSess_3376),Kcli_3385))
                                                            )
                                                            else
                                                                {3475}let pkSess_3386: bitstring = pub(skI) in
                                                                {3476}out(c, GetEndpointRequest);
                                                                {3477}in(c, (SPs_3387: bitstring,=SignAndEncrypt,UP_3388: bitstring,=pkSess_3386));
                                                                {3478}new SPc_3389: bitstring;
                                                                {3479}new Nc_3390: bitstring;
                                                                {3480}let m1_3391: bitstring = (Sess,SPc_3389,exp(g,Nc_3390)) in
                                                                {3481}out(c, (pkCli_3200,enc(m1_3391,pkSess_3386),sign(m1_3391,skCli_3199)));
                                                                {3482}in(c, (ePartS_3392: bitstring,sigPartS_3393: bitstring));
                                                                {3483}let (=Cli,PartS_3394: bitstring) = dec(ePartS_3392,skCli_3199) in
                                                                {3484}if (verify((Cli,PartS_3394),sigPartS_3393,pkSess_3386) <> true) then
                                                                    0
                                                                else
                                                                    {3485}let Kcli_3395: bitstring = exp(PartS_3394,Nc_3390) in
                                                                    {3486}out(c, senc(mCli(pkCli_3200,pkSess_3386),Kcli_3395))
                                                        )
                                                        else
                                                            {3487}let pkSess_3396: bitstring = fail-any in
                                                            {3488}out(c, GetEndpointRequest);
                                                            {3489}in(c, (SPs_3397: bitstring,=SignAndEncrypt,UP_3398: bitstring,=pkSess_3396));
                                                            {3490}new SPc_3399: bitstring;
                                                            {3491}new Nc_3400: bitstring;
                                                            {3492}let m1_3401: bitstring = (Sess,SPc_3399,exp(g,Nc_3400)) in
                                                            {3493}out(c, (pkCli_3200,enc(m1_3401,pkSess_3396),sign(m1_3401,skCli_3199)));
                                                            {3494}in(c, (ePartS_3402: bitstring,sigPartS_3403: bitstring));
                                                            {3495}let (=Cli,PartS_3404: bitstring) = dec(ePartS_3402,skCli_3199) in
                                                            {3496}if (verify((Cli,PartS_3404),sigPartS_3403,pkSess_3396) <> true) then
                                                                0
                                                            else
                                                                {3497}let Kcli_3405: bitstring = exp(PartS_3404,Nc_3400) in
                                                                {3498}out(c, senc(mCli(pkCli_3200,pkSess_3396),Kcli_3405))
                                                )
                                                else
                                                    {3499}let pkSess_3406: bitstring = fail-any in
                                                    {3500}out(c, GetEndpointRequest);
                                                    {3501}in(c, (SPs_3407: bitstring,=SignAndEncrypt,UP_3408: bitstring,=pkSess_3406));
                                                    {3502}new SPc_3409: bitstring;
                                                    {3503}new Nc_3410: bitstring;
                                                    {3504}let m1_3411: bitstring = (Sess,SPc_3409,exp(g,Nc_3410)) in
                                                    {3505}out(c, (pkCli_3200,enc(m1_3411,pkSess_3406),sign(m1_3411,skCli_3199)));
                                                    {3506}in(c, (ePartS_3412: bitstring,sigPartS_3413: bitstring));
                                                    {3507}let (=Cli,PartS_3414: bitstring) = dec(ePartS_3412,skCli_3199) in
                                                    {3508}if (verify((Cli,PartS_3414),sigPartS_3413,pkSess_3406) <> true) then
                                                        0
                                                    else
                                                        {3509}let Kcli_3415: bitstring = exp(PartS_3414,Nc_3410) in
                                                        {3510}out(c, senc(mCli(pkCli_3200,pkSess_3406),Kcli_3415))
                                        )
                                        else
                                            {3511}let pkSess_3416: bitstring = fail-any in
                                            {3512}out(c, GetEndpointRequest);
                                            {3513}in(c, (SPs_3417: bitstring,=SignAndEncrypt,UP_3418: bitstring,=pkSess_3416));
                                            {3514}new SPc_3419: bitstring;
                                            {3515}new Nc_3420: bitstring;
                                            {3516}let m1_3421: bitstring = (Sess,SPc_3419,exp(g,Nc_3420)) in
                                            {3517}out(c, (pkCli_3200,enc(m1_3421,pkSess_3416),sign(m1_3421,skCli_3199)));
                                            {3518}in(c, (ePartS_3422: bitstring,sigPartS_3423: bitstring));
                                            {3519}let (=Cli,PartS_3424: bitstring) = dec(ePartS_3422,skCli_3199) in
                                            {3520}if (verify((Cli,PartS_3424),sigPartS_3423,pkSess_3416) <> true) then
                                                0
                                            else
                                                {3521}let Kcli_3425: bitstring = exp(PartS_3424,Nc_3420) in
                                                {3522}out(c, senc(mCli(pkCli_3200,pkSess_3416),Kcli_3425))
                                    )
                                    else
                                        {3523}let pkDisco_3426: bitstring = pub(skI) in
                                        {3524}let v_3427: bool = (Sess = A) in
                                        (
                                            {3525}if v_3427 then
                                            (
                                                {3526}let pkSess_3428: bitstring = pub(skA) in
                                                {3527}out(c, GetEndpointRequest);
                                                {3528}in(c, (SPs_3429: bitstring,=SignAndEncrypt,UP_3430: bitstring,=pkSess_3428));
                                                {3529}new SPc_3431: bitstring;
                                                {3530}new Nc_3432: bitstring;
                                                {3531}let m1_3433: bitstring = (Sess,SPc_3431,exp(g,Nc_3432)) in
                                                {3532}out(c, (pkCli_3200,enc(m1_3433,pkSess_3428),sign(m1_3433,skCli_3199)));
                                                {3533}in(c, (ePartS_3434: bitstring,sigPartS_3435: bitstring));
                                                {3534}let (=Cli,PartS_3436: bitstring) = dec(ePartS_3434,skCli_3199) in
                                                {3535}if (verify((Cli,PartS_3436),sigPartS_3435,pkSess_3428) <> true) then
                                                    0
                                                else
                                                    {3536}let Kcli_3437: bitstring = exp(PartS_3436,Nc_3432) in
                                                    {3537}out(c, senc(mCli(pkCli_3200,pkSess_3428),Kcli_3437))
                                            )
                                            else
                                                {3538}let v_3438: bool = (Sess = B) in
                                                (
                                                    {3539}if v_3438 then
                                                    (
                                                        {3540}let pkSess_3439: bitstring = pub(skB) in
                                                        {3541}out(c, GetEndpointRequest);
                                                        {3542}in(c, (SPs_3440: bitstring,=SignAndEncrypt,UP_3441: bitstring,=pkSess_3439));
                                                        {3543}new SPc_3442: bitstring;
                                                        {3544}new Nc_3443: bitstring;
                                                        {3545}let m1_3444: bitstring = (Sess,SPc_3442,exp(g,Nc_3443)) in
                                                        {3546}out(c, (pkCli_3200,enc(m1_3444,pkSess_3439),sign(m1_3444,skCli_3199)));
                                                        {3547}in(c, (ePartS_3445: bitstring,sigPartS_3446: bitstring));
                                                        {3548}let (=Cli,PartS_3447: bitstring) = dec(ePartS_3445,skCli_3199) in
                                                        {3549}if (verify((Cli,PartS_3447),sigPartS_3446,pkSess_3439) <> true) then
                                                            0
                                                        else
                                                            {3550}let Kcli_3448: bitstring = exp(PartS_3447,Nc_3443) in
                                                            {3551}out(c, senc(mCli(pkCli_3200,pkSess_3439),Kcli_3448))
                                                    )
                                                    else
                                                        {3552}let v_3449: bool = (Sess = C) in
                                                        (
                                                            {3553}if v_3449 then
                                                            (
                                                                {3554}let pkSess_3450: bitstring = pub(skC) in
                                                                {3555}out(c, GetEndpointRequest);
                                                                {3556}in(c, (SPs_3451: bitstring,=SignAndEncrypt,UP_3452: bitstring,=pkSess_3450));
                                                                {3557}new SPc_3453: bitstring;
                                                                {3558}new Nc_3454: bitstring;
                                                                {3559}let m1_3455: bitstring = (Sess,SPc_3453,exp(g,Nc_3454)) in
                                                                {3560}out(c, (pkCli_3200,enc(m1_3455,pkSess_3450),sign(m1_3455,skCli_3199)));
                                                                {3561}in(c, (ePartS_3456: bitstring,sigPartS_3457: bitstring));
                                                                {3562}let (=Cli,PartS_3458: bitstring) = dec(ePartS_3456,skCli_3199) in
                                                                {3563}if (verify((Cli,PartS_3458),sigPartS_3457,pkSess_3450) <> true) then
                                                                    0
                                                                else
                                                                    {3564}let Kcli_3459: bitstring = exp(PartS_3458,Nc_3454) in
                                                                    {3565}out(c, senc(mCli(pkCli_3200,pkSess_3450),Kcli_3459))
                                                            )
                                                            else
                                                                {3566}let pkSess_3460: bitstring = pub(skI) in
                                                                {3567}out(c, GetEndpointRequest);
                                                                {3568}in(c, (SPs_3461: bitstring,=SignAndEncrypt,UP_3462: bitstring,=pkSess_3460));
                                                                {3569}new SPc_3463: bitstring;
                                                                {3570}new Nc_3464: bitstring;
                                                                {3571}let m1_3465: bitstring = (Sess,SPc_3463,exp(g,Nc_3464)) in
                                                                {3572}out(c, (pkCli_3200,enc(m1_3465,pkSess_3460),sign(m1_3465,skCli_3199)));
                                                                {3573}in(c, (ePartS_3466: bitstring,sigPartS_3467: bitstring));
                                                                {3574}let (=Cli,PartS_3468: bitstring) = dec(ePartS_3466,skCli_3199) in
                                                                {3575}if (verify((Cli,PartS_3468),sigPartS_3467,pkSess_3460) <> true) then
                                                                    0
                                                                else
                                                                    {3576}let Kcli_3469: bitstring = exp(PartS_3468,Nc_3464) in
                                                                    {3577}out(c, senc(mCli(pkCli_3200,pkSess_3460),Kcli_3469))
                                                        )
                                                        else
                                                            {3578}let pkSess_3470: bitstring = fail-any in
                                                            {3579}out(c, GetEndpointRequest);
                                                            {3580}in(c, (SPs_3471: bitstring,=SignAndEncrypt,UP_3472: bitstring,=pkSess_3470));
                                                            {3581}new SPc_3473: bitstring;
                                                            {3582}new Nc_3474: bitstring;
                                                            {3583}let m1_3475: bitstring = (Sess,SPc_3473,exp(g,Nc_3474)) in
                                                            {3584}out(c, (pkCli_3200,enc(m1_3475,pkSess_3470),sign(m1_3475,skCli_3199)));
                                                            {3585}in(c, (ePartS_3476: bitstring,sigPartS_3477: bitstring));
                                                            {3586}let (=Cli,PartS_3478: bitstring) = dec(ePartS_3476,skCli_3199) in
                                                            {3587}if (verify((Cli,PartS_3478),sigPartS_3477,pkSess_3470) <> true) then
                                                                0
                                                            else
                                                                {3588}let Kcli_3479: bitstring = exp(PartS_3478,Nc_3474) in
                                                                {3589}out(c, senc(mCli(pkCli_3200,pkSess_3470),Kcli_3479))
                                                )
                                                else
                                                    {3590}let pkSess_3480: bitstring = fail-any in
                                                    {3591}out(c, GetEndpointRequest);
                                                    {3592}in(c, (SPs_3481: bitstring,=SignAndEncrypt,UP_3482: bitstring,=pkSess_3480));
                                                    {3593}new SPc_3483: bitstring;
                                                    {3594}new Nc_3484: bitstring;
                                                    {3595}let m1_3485: bitstring = (Sess,SPc_3483,exp(g,Nc_3484)) in
                                                    {3596}out(c, (pkCli_3200,enc(m1_3485,pkSess_3480),sign(m1_3485,skCli_3199)));
                                                    {3597}in(c, (ePartS_3486: bitstring,sigPartS_3487: bitstring));
                                                    {3598}let (=Cli,PartS_3488: bitstring) = dec(ePartS_3486,skCli_3199) in
                                                    {3599}if (verify((Cli,PartS_3488),sigPartS_3487,pkSess_3480) <> true) then
                                                        0
                                                    else
                                                        {3600}let Kcli_3489: bitstring = exp(PartS_3488,Nc_3484) in
                                                        {3601}out(c, senc(mCli(pkCli_3200,pkSess_3480),Kcli_3489))
                                        )
                                        else
                                            {3602}let pkSess_3490: bitstring = fail-any in
                                            {3603}out(c, GetEndpointRequest);
                                            {3604}in(c, (SPs_3491: bitstring,=SignAndEncrypt,UP_3492: bitstring,=pkSess_3490));
                                            {3605}new SPc_3493: bitstring;
                                            {3606}new Nc_3494: bitstring;
                                            {3607}let m1_3495: bitstring = (Sess,SPc_3493,exp(g,Nc_3494)) in
                                            {3608}out(c, (pkCli_3200,enc(m1_3495,pkSess_3490),sign(m1_3495,skCli_3199)));
                                            {3609}in(c, (ePartS_3496: bitstring,sigPartS_3497: bitstring));
                                            {3610}let (=Cli,PartS_3498: bitstring) = dec(ePartS_3496,skCli_3199) in
                                            {3611}if (verify((Cli,PartS_3498),sigPartS_3497,pkSess_3490) <> true) then
                                                0
                                            else
                                                {3612}let Kcli_3499: bitstring = exp(PartS_3498,Nc_3494) in
                                                {3613}out(c, senc(mCli(pkCli_3200,pkSess_3490),Kcli_3499))
                                )
                                else
                                    {3614}let pkDisco_3500: bitstring = fail-any in
                                    {3615}let v_3501: bool = (Sess = A) in
                                    (
                                        {3616}if v_3501 then
                                        (
                                            {3617}let pkSess_3502: bitstring = pub(skA) in
                                            {3618}out(c, GetEndpointRequest);
                                            {3619}in(c, (SPs_3503: bitstring,=SignAndEncrypt,UP_3504: bitstring,=pkSess_3502));
                                            {3620}new SPc_3505: bitstring;
                                            {3621}new Nc_3506: bitstring;
                                            {3622}let m1_3507: bitstring = (Sess,SPc_3505,exp(g,Nc_3506)) in
                                            {3623}out(c, (pkCli_3200,enc(m1_3507,pkSess_3502),sign(m1_3507,skCli_3199)));
                                            {3624}in(c, (ePartS_3508: bitstring,sigPartS_3509: bitstring));
                                            {3625}let (=Cli,PartS_3510: bitstring) = dec(ePartS_3508,skCli_3199) in
                                            {3626}if (verify((Cli,PartS_3510),sigPartS_3509,pkSess_3502) <> true) then
                                                0
                                            else
                                                {3627}let Kcli_3511: bitstring = exp(PartS_3510,Nc_3506) in
                                                {3628}out(c, senc(mCli(pkCli_3200,pkSess_3502),Kcli_3511))
                                        )
                                        else
                                            {3629}let v_3512: bool = (Sess = B) in
                                            (
                                                {3630}if v_3512 then
                                                (
                                                    {3631}let pkSess_3513: bitstring = pub(skB) in
                                                    {3632}out(c, GetEndpointRequest);
                                                    {3633}in(c, (SPs_3514: bitstring,=SignAndEncrypt,UP_3515: bitstring,=pkSess_3513));
                                                    {3634}new SPc_3516: bitstring;
                                                    {3635}new Nc_3517: bitstring;
                                                    {3636}let m1_3518: bitstring = (Sess,SPc_3516,exp(g,Nc_3517)) in
                                                    {3637}out(c, (pkCli_3200,enc(m1_3518,pkSess_3513),sign(m1_3518,skCli_3199)));
                                                    {3638}in(c, (ePartS_3519: bitstring,sigPartS_3520: bitstring));
                                                    {3639}let (=Cli,PartS_3521: bitstring) = dec(ePartS_3519,skCli_3199) in
                                                    {3640}if (verify((Cli,PartS_3521),sigPartS_3520,pkSess_3513) <> true) then
                                                        0
                                                    else
                                                        {3641}let Kcli_3522: bitstring = exp(PartS_3521,Nc_3517) in
                                                        {3642}out(c, senc(mCli(pkCli_3200,pkSess_3513),Kcli_3522))
                                                )
                                                else
                                                    {3643}let v_3523: bool = (Sess = C) in
                                                    (
                                                        {3644}if v_3523 then
                                                        (
                                                            {3645}let pkSess_3524: bitstring = pub(skC) in
                                                            {3646}out(c, GetEndpointRequest);
                                                            {3647}in(c, (SPs_3525: bitstring,=SignAndEncrypt,UP_3526: bitstring,=pkSess_3524));
                                                            {3648}new SPc_3527: bitstring;
                                                            {3649}new Nc_3528: bitstring;
                                                            {3650}let m1_3529: bitstring = (Sess,SPc_3527,exp(g,Nc_3528)) in
                                                            {3651}out(c, (pkCli_3200,enc(m1_3529,pkSess_3524),sign(m1_3529,skCli_3199)));
                                                            {3652}in(c, (ePartS_3530: bitstring,sigPartS_3531: bitstring));
                                                            {3653}let (=Cli,PartS_3532: bitstring) = dec(ePartS_3530,skCli_3199) in
                                                            {3654}if (verify((Cli,PartS_3532),sigPartS_3531,pkSess_3524) <> true) then
                                                                0
                                                            else
                                                                {3655}let Kcli_3533: bitstring = exp(PartS_3532,Nc_3528) in
                                                                {3656}out(c, senc(mCli(pkCli_3200,pkSess_3524),Kcli_3533))
                                                        )
                                                        else
                                                            {3657}let pkSess_3534: bitstring = pub(skI) in
                                                            {3658}out(c, GetEndpointRequest);
                                                            {3659}in(c, (SPs_3535: bitstring,=SignAndEncrypt,UP_3536: bitstring,=pkSess_3534));
                                                            {3660}new SPc_3537: bitstring;
                                                            {3661}new Nc_3538: bitstring;
                                                            {3662}let m1_3539: bitstring = (Sess,SPc_3537,exp(g,Nc_3538)) in
                                                            {3663}out(c, (pkCli_3200,enc(m1_3539,pkSess_3534),sign(m1_3539,skCli_3199)));
                                                            {3664}in(c, (ePartS_3540: bitstring,sigPartS_3541: bitstring));
                                                            {3665}let (=Cli,PartS_3542: bitstring) = dec(ePartS_3540,skCli_3199) in
                                                            {3666}if (verify((Cli,PartS_3542),sigPartS_3541,pkSess_3534) <> true) then
                                                                0
                                                            else
                                                                {3667}let Kcli_3543: bitstring = exp(PartS_3542,Nc_3538) in
                                                                {3668}out(c, senc(mCli(pkCli_3200,pkSess_3534),Kcli_3543))
                                                    )
                                                    else
                                                        {3669}let pkSess_3544: bitstring = fail-any in
                                                        {3670}out(c, GetEndpointRequest);
                                                        {3671}in(c, (SPs_3545: bitstring,=SignAndEncrypt,UP_3546: bitstring,=pkSess_3544));
                                                        {3672}new SPc_3547: bitstring;
                                                        {3673}new Nc_3548: bitstring;
                                                        {3674}let m1_3549: bitstring = (Sess,SPc_3547,exp(g,Nc_3548)) in
                                                        {3675}out(c, (pkCli_3200,enc(m1_3549,pkSess_3544),sign(m1_3549,skCli_3199)));
                                                        {3676}in(c, (ePartS_3550: bitstring,sigPartS_3551: bitstring));
                                                        {3677}let (=Cli,PartS_3552: bitstring) = dec(ePartS_3550,skCli_3199) in
                                                        {3678}if (verify((Cli,PartS_3552),sigPartS_3551,pkSess_3544) <> true) then
                                                            0
                                                        else
                                                            {3679}let Kcli_3553: bitstring = exp(PartS_3552,Nc_3548) in
                                                            {3680}out(c, senc(mCli(pkCli_3200,pkSess_3544),Kcli_3553))
                                            )
                                            else
                                                {3681}let pkSess_3554: bitstring = fail-any in
                                                {3682}out(c, GetEndpointRequest);
                                                {3683}in(c, (SPs_3555: bitstring,=SignAndEncrypt,UP_3556: bitstring,=pkSess_3554));
                                                {3684}new SPc_3557: bitstring;
                                                {3685}new Nc_3558: bitstring;
                                                {3686}let m1_3559: bitstring = (Sess,SPc_3557,exp(g,Nc_3558)) in
                                                {3687}out(c, (pkCli_3200,enc(m1_3559,pkSess_3554),sign(m1_3559,skCli_3199)));
                                                {3688}in(c, (ePartS_3560: bitstring,sigPartS_3561: bitstring));
                                                {3689}let (=Cli,PartS_3562: bitstring) = dec(ePartS_3560,skCli_3199) in
                                                {3690}if (verify((Cli,PartS_3562),sigPartS_3561,pkSess_3554) <> true) then
                                                    0
                                                else
                                                    {3691}let Kcli_3563: bitstring = exp(PartS_3562,Nc_3558) in
                                                    {3692}out(c, senc(mCli(pkCli_3200,pkSess_3554),Kcli_3563))
                                    )
                                    else
                                        {3693}let pkSess_3564: bitstring = fail-any in
                                        {3694}out(c, GetEndpointRequest);
                                        {3695}in(c, (SPs_3565: bitstring,=SignAndEncrypt,UP_3566: bitstring,=pkSess_3564));
                                        {3696}new SPc_3567: bitstring;
                                        {3697}new Nc_3568: bitstring;
                                        {3698}let m1_3569: bitstring = (Sess,SPc_3567,exp(g,Nc_3568)) in
                                        {3699}out(c, (pkCli_3200,enc(m1_3569,pkSess_3564),sign(m1_3569,skCli_3199)));
                                        {3700}in(c, (ePartS_3570: bitstring,sigPartS_3571: bitstring));
                                        {3701}let (=Cli,PartS_3572: bitstring) = dec(ePartS_3570,skCli_3199) in
                                        {3702}if (verify((Cli,PartS_3572),sigPartS_3571,pkSess_3564) <> true) then
                                            0
                                        else
                                            {3703}let Kcli_3573: bitstring = exp(PartS_3572,Nc_3568) in
                                            {3704}out(c, senc(mCli(pkCli_3200,pkSess_3564),Kcli_3573))
                        )
                        else
                            {3705}let pkDisco_3574: bitstring = fail-any in
                            {3706}let v_3575: bool = (Sess = A) in
                            (
                                {3707}if v_3575 then
                                (
                                    {3708}let pkSess_3576: bitstring = pub(skA) in
                                    {3709}out(c, GetEndpointRequest);
                                    {3710}in(c, (SPs_3577: bitstring,=SignAndEncrypt,UP_3578: bitstring,=pkSess_3576));
                                    {3711}new SPc_3579: bitstring;
                                    {3712}new Nc_3580: bitstring;
                                    {3713}let m1_3581: bitstring = (Sess,SPc_3579,exp(g,Nc_3580)) in
                                    {3714}out(c, (pkCli_3200,enc(m1_3581,pkSess_3576),sign(m1_3581,skCli_3199)));
                                    {3715}in(c, (ePartS_3582: bitstring,sigPartS_3583: bitstring));
                                    {3716}let (=Cli,PartS_3584: bitstring) = dec(ePartS_3582,skCli_3199) in
                                    {3717}if (verify((Cli,PartS_3584),sigPartS_3583,pkSess_3576) <> true) then
                                        0
                                    else
                                        {3718}let Kcli_3585: bitstring = exp(PartS_3584,Nc_3580) in
                                        {3719}out(c, senc(mCli(pkCli_3200,pkSess_3576),Kcli_3585))
                                )
                                else
                                    {3720}let v_3586: bool = (Sess = B) in
                                    (
                                        {3721}if v_3586 then
                                        (
                                            {3722}let pkSess_3587: bitstring = pub(skB) in
                                            {3723}out(c, GetEndpointRequest);
                                            {3724}in(c, (SPs_3588: bitstring,=SignAndEncrypt,UP_3589: bitstring,=pkSess_3587));
                                            {3725}new SPc_3590: bitstring;
                                            {3726}new Nc_3591: bitstring;
                                            {3727}let m1_3592: bitstring = (Sess,SPc_3590,exp(g,Nc_3591)) in
                                            {3728}out(c, (pkCli_3200,enc(m1_3592,pkSess_3587),sign(m1_3592,skCli_3199)));
                                            {3729}in(c, (ePartS_3593: bitstring,sigPartS_3594: bitstring));
                                            {3730}let (=Cli,PartS_3595: bitstring) = dec(ePartS_3593,skCli_3199) in
                                            {3731}if (verify((Cli,PartS_3595),sigPartS_3594,pkSess_3587) <> true) then
                                                0
                                            else
                                                {3732}let Kcli_3596: bitstring = exp(PartS_3595,Nc_3591) in
                                                {3733}out(c, senc(mCli(pkCli_3200,pkSess_3587),Kcli_3596))
                                        )
                                        else
                                            {3734}let v_3597: bool = (Sess = C) in
                                            (
                                                {3735}if v_3597 then
                                                (
                                                    {3736}let pkSess_3598: bitstring = pub(skC) in
                                                    {3737}out(c, GetEndpointRequest);
                                                    {3738}in(c, (SPs_3599: bitstring,=SignAndEncrypt,UP_3600: bitstring,=pkSess_3598));
                                                    {3739}new SPc_3601: bitstring;
                                                    {3740}new Nc_3602: bitstring;
                                                    {3741}let m1_3603: bitstring = (Sess,SPc_3601,exp(g,Nc_3602)) in
                                                    {3742}out(c, (pkCli_3200,enc(m1_3603,pkSess_3598),sign(m1_3603,skCli_3199)));
                                                    {3743}in(c, (ePartS_3604: bitstring,sigPartS_3605: bitstring));
                                                    {3744}let (=Cli,PartS_3606: bitstring) = dec(ePartS_3604,skCli_3199) in
                                                    {3745}if (verify((Cli,PartS_3606),sigPartS_3605,pkSess_3598) <> true) then
                                                        0
                                                    else
                                                        {3746}let Kcli_3607: bitstring = exp(PartS_3606,Nc_3602) in
                                                        {3747}out(c, senc(mCli(pkCli_3200,pkSess_3598),Kcli_3607))
                                                )
                                                else
                                                    {3748}let pkSess_3608: bitstring = pub(skI) in
                                                    {3749}out(c, GetEndpointRequest);
                                                    {3750}in(c, (SPs_3609: bitstring,=SignAndEncrypt,UP_3610: bitstring,=pkSess_3608));
                                                    {3751}new SPc_3611: bitstring;
                                                    {3752}new Nc_3612: bitstring;
                                                    {3753}let m1_3613: bitstring = (Sess,SPc_3611,exp(g,Nc_3612)) in
                                                    {3754}out(c, (pkCli_3200,enc(m1_3613,pkSess_3608),sign(m1_3613,skCli_3199)));
                                                    {3755}in(c, (ePartS_3614: bitstring,sigPartS_3615: bitstring));
                                                    {3756}let (=Cli,PartS_3616: bitstring) = dec(ePartS_3614,skCli_3199) in
                                                    {3757}if (verify((Cli,PartS_3616),sigPartS_3615,pkSess_3608) <> true) then
                                                        0
                                                    else
                                                        {3758}let Kcli_3617: bitstring = exp(PartS_3616,Nc_3612) in
                                                        {3759}out(c, senc(mCli(pkCli_3200,pkSess_3608),Kcli_3617))
                                            )
                                            else
                                                {3760}let pkSess_3618: bitstring = fail-any in
                                                {3761}out(c, GetEndpointRequest);
                                                {3762}in(c, (SPs_3619: bitstring,=SignAndEncrypt,UP_3620: bitstring,=pkSess_3618));
                                                {3763}new SPc_3621: bitstring;
                                                {3764}new Nc_3622: bitstring;
                                                {3765}let m1_3623: bitstring = (Sess,SPc_3621,exp(g,Nc_3622)) in
                                                {3766}out(c, (pkCli_3200,enc(m1_3623,pkSess_3618),sign(m1_3623,skCli_3199)));
                                                {3767}in(c, (ePartS_3624: bitstring,sigPartS_3625: bitstring));
                                                {3768}let (=Cli,PartS_3626: bitstring) = dec(ePartS_3624,skCli_3199) in
                                                {3769}if (verify((Cli,PartS_3626),sigPartS_3625,pkSess_3618) <> true) then
                                                    0
                                                else
                                                    {3770}let Kcli_3627: bitstring = exp(PartS_3626,Nc_3622) in
                                                    {3771}out(c, senc(mCli(pkCli_3200,pkSess_3618),Kcli_3627))
                                    )
                                    else
                                        {3772}let pkSess_3628: bitstring = fail-any in
                                        {3773}out(c, GetEndpointRequest);
                                        {3774}in(c, (SPs_3629: bitstring,=SignAndEncrypt,UP_3630: bitstring,=pkSess_3628));
                                        {3775}new SPc_3631: bitstring;
                                        {3776}new Nc_3632: bitstring;
                                        {3777}let m1_3633: bitstring = (Sess,SPc_3631,exp(g,Nc_3632)) in
                                        {3778}out(c, (pkCli_3200,enc(m1_3633,pkSess_3628),sign(m1_3633,skCli_3199)));
                                        {3779}in(c, (ePartS_3634: bitstring,sigPartS_3635: bitstring));
                                        {3780}let (=Cli,PartS_3636: bitstring) = dec(ePartS_3634,skCli_3199) in
                                        {3781}if (verify((Cli,PartS_3636),sigPartS_3635,pkSess_3628) <> true) then
                                            0
                                        else
                                            {3782}let Kcli_3637: bitstring = exp(PartS_3636,Nc_3632) in
                                            {3783}out(c, senc(mCli(pkCli_3200,pkSess_3628),Kcli_3637))
                            )
                            else
                                {3784}let pkSess_3638: bitstring = fail-any in
                                {3785}out(c, GetEndpointRequest);
                                {3786}in(c, (SPs_3639: bitstring,=SignAndEncrypt,UP_3640: bitstring,=pkSess_3638));
                                {3787}new SPc_3641: bitstring;
                                {3788}new Nc_3642: bitstring;
                                {3789}let m1_3643: bitstring = (Sess,SPc_3641,exp(g,Nc_3642)) in
                                {3790}out(c, (pkCli_3200,enc(m1_3643,pkSess_3638),sign(m1_3643,skCli_3199)));
                                {3791}in(c, (ePartS_3644: bitstring,sigPartS_3645: bitstring));
                                {3792}let (=Cli,PartS_3646: bitstring) = dec(ePartS_3644,skCli_3199) in
                                {3793}if (verify((Cli,PartS_3646),sigPartS_3645,pkSess_3638) <> true) then
                                    0
                                else
                                    {3794}let Kcli_3647: bitstring = exp(PartS_3646,Nc_3642) in
                                    {3795}out(c, senc(mCli(pkCli_3200,pkSess_3638),Kcli_3647))
                )
                else
                    {3796}let pkDisco_3648: bitstring = fail-any in
                    {3797}let v_3649: bool = (Sess = A) in
                    (
                        {3798}if v_3649 then
                        (
                            {3799}let pkSess_3650: bitstring = pub(skA) in
                            {3800}out(c, GetEndpointRequest);
                            {3801}in(c, (SPs_3651: bitstring,=SignAndEncrypt,UP_3652: bitstring,=pkSess_3650));
                            {3802}new SPc_3653: bitstring;
                            {3803}new Nc_3654: bitstring;
                            {3804}let m1_3655: bitstring = (Sess,SPc_3653,exp(g,Nc_3654)) in
                            {3805}out(c, (pkCli_3200,enc(m1_3655,pkSess_3650),sign(m1_3655,skCli_3199)));
                            {3806}in(c, (ePartS_3656: bitstring,sigPartS_3657: bitstring));
                            {3807}let (=Cli,PartS_3658: bitstring) = dec(ePartS_3656,skCli_3199) in
                            {3808}if (verify((Cli,PartS_3658),sigPartS_3657,pkSess_3650) <> true) then
                                0
                            else
                                {3809}let Kcli_3659: bitstring = exp(PartS_3658,Nc_3654) in
                                {3810}out(c, senc(mCli(pkCli_3200,pkSess_3650),Kcli_3659))
                        )
                        else
                            {3811}let v_3660: bool = (Sess = B) in
                            (
                                {3812}if v_3660 then
                                (
                                    {3813}let pkSess_3661: bitstring = pub(skB) in
                                    {3814}out(c, GetEndpointRequest);
                                    {3815}in(c, (SPs_3662: bitstring,=SignAndEncrypt,UP_3663: bitstring,=pkSess_3661));
                                    {3816}new SPc_3664: bitstring;
                                    {3817}new Nc_3665: bitstring;
                                    {3818}let m1_3666: bitstring = (Sess,SPc_3664,exp(g,Nc_3665)) in
                                    {3819}out(c, (pkCli_3200,enc(m1_3666,pkSess_3661),sign(m1_3666,skCli_3199)));
                                    {3820}in(c, (ePartS_3667: bitstring,sigPartS_3668: bitstring));
                                    {3821}let (=Cli,PartS_3669: bitstring) = dec(ePartS_3667,skCli_3199) in
                                    {3822}if (verify((Cli,PartS_3669),sigPartS_3668,pkSess_3661) <> true) then
                                        0
                                    else
                                        {3823}let Kcli_3670: bitstring = exp(PartS_3669,Nc_3665) in
                                        {3824}out(c, senc(mCli(pkCli_3200,pkSess_3661),Kcli_3670))
                                )
                                else
                                    {3825}let v_3671: bool = (Sess = C) in
                                    (
                                        {3826}if v_3671 then
                                        (
                                            {3827}let pkSess_3672: bitstring = pub(skC) in
                                            {3828}out(c, GetEndpointRequest);
                                            {3829}in(c, (SPs_3673: bitstring,=SignAndEncrypt,UP_3674: bitstring,=pkSess_3672));
                                            {3830}new SPc_3675: bitstring;
                                            {3831}new Nc_3676: bitstring;
                                            {3832}let m1_3677: bitstring = (Sess,SPc_3675,exp(g,Nc_3676)) in
                                            {3833}out(c, (pkCli_3200,enc(m1_3677,pkSess_3672),sign(m1_3677,skCli_3199)));
                                            {3834}in(c, (ePartS_3678: bitstring,sigPartS_3679: bitstring));
                                            {3835}let (=Cli,PartS_3680: bitstring) = dec(ePartS_3678,skCli_3199) in
                                            {3836}if (verify((Cli,PartS_3680),sigPartS_3679,pkSess_3672) <> true) then
                                                0
                                            else
                                                {3837}let Kcli_3681: bitstring = exp(PartS_3680,Nc_3676) in
                                                {3838}out(c, senc(mCli(pkCli_3200,pkSess_3672),Kcli_3681))
                                        )
                                        else
                                            {3839}let pkSess_3682: bitstring = pub(skI) in
                                            {3840}out(c, GetEndpointRequest);
                                            {3841}in(c, (SPs_3683: bitstring,=SignAndEncrypt,UP_3684: bitstring,=pkSess_3682));
                                            {3842}new SPc_3685: bitstring;
                                            {3843}new Nc_3686: bitstring;
                                            {3844}let m1_3687: bitstring = (Sess,SPc_3685,exp(g,Nc_3686)) in
                                            {3845}out(c, (pkCli_3200,enc(m1_3687,pkSess_3682),sign(m1_3687,skCli_3199)));
                                            {3846}in(c, (ePartS_3688: bitstring,sigPartS_3689: bitstring));
                                            {3847}let (=Cli,PartS_3690: bitstring) = dec(ePartS_3688,skCli_3199) in
                                            {3848}if (verify((Cli,PartS_3690),sigPartS_3689,pkSess_3682) <> true) then
                                                0
                                            else
                                                {3849}let Kcli_3691: bitstring = exp(PartS_3690,Nc_3686) in
                                                {3850}out(c, senc(mCli(pkCli_3200,pkSess_3682),Kcli_3691))
                                    )
                                    else
                                        {3851}let pkSess_3692: bitstring = fail-any in
                                        {3852}out(c, GetEndpointRequest);
                                        {3853}in(c, (SPs_3693: bitstring,=SignAndEncrypt,UP_3694: bitstring,=pkSess_3692));
                                        {3854}new SPc_3695: bitstring;
                                        {3855}new Nc_3696: bitstring;
                                        {3856}let m1_3697: bitstring = (Sess,SPc_3695,exp(g,Nc_3696)) in
                                        {3857}out(c, (pkCli_3200,enc(m1_3697,pkSess_3692),sign(m1_3697,skCli_3199)));
                                        {3858}in(c, (ePartS_3698: bitstring,sigPartS_3699: bitstring));
                                        {3859}let (=Cli,PartS_3700: bitstring) = dec(ePartS_3698,skCli_3199) in
                                        {3860}if (verify((Cli,PartS_3700),sigPartS_3699,pkSess_3692) <> true) then
                                            0
                                        else
                                            {3861}let Kcli_3701: bitstring = exp(PartS_3700,Nc_3696) in
                                            {3862}out(c, senc(mCli(pkCli_3200,pkSess_3692),Kcli_3701))
                            )
                            else
                                {3863}let pkSess_3702: bitstring = fail-any in
                                {3864}out(c, GetEndpointRequest);
                                {3865}in(c, (SPs_3703: bitstring,=SignAndEncrypt,UP_3704: bitstring,=pkSess_3702));
                                {3866}new SPc_3705: bitstring;
                                {3867}new Nc_3706: bitstring;
                                {3868}let m1_3707: bitstring = (Sess,SPc_3705,exp(g,Nc_3706)) in
                                {3869}out(c, (pkCli_3200,enc(m1_3707,pkSess_3702),sign(m1_3707,skCli_3199)));
                                {3870}in(c, (ePartS_3708: bitstring,sigPartS_3709: bitstring));
                                {3871}let (=Cli,PartS_3710: bitstring) = dec(ePartS_3708,skCli_3199) in
                                {3872}if (verify((Cli,PartS_3710),sigPartS_3709,pkSess_3702) <> true) then
                                    0
                                else
                                    {3873}let Kcli_3711: bitstring = exp(PartS_3710,Nc_3706) in
                                    {3874}out(c, senc(mCli(pkCli_3200,pkSess_3702),Kcli_3711))
                    )
                    else
                        {3875}let pkSess_3712: bitstring = fail-any in
                        {3876}out(c, GetEndpointRequest);
                        {3877}in(c, (SPs_3713: bitstring,=SignAndEncrypt,UP_3714: bitstring,=pkSess_3712));
                        {3878}new SPc_3715: bitstring;
                        {3879}new Nc_3716: bitstring;
                        {3880}let m1_3717: bitstring = (Sess,SPc_3715,exp(g,Nc_3716)) in
                        {3881}out(c, (pkCli_3200,enc(m1_3717,pkSess_3712),sign(m1_3717,skCli_3199)));
                        {3882}in(c, (ePartS_3718: bitstring,sigPartS_3719: bitstring));
                        {3883}let (=Cli,PartS_3720: bitstring) = dec(ePartS_3718,skCli_3199) in
                        {3884}if (verify((Cli,PartS_3720),sigPartS_3719,pkSess_3712) <> true) then
                            0
                        else
                            {3885}let Kcli_3721: bitstring = exp(PartS_3720,Nc_3716) in
                            {3886}out(c, senc(mCli(pkCli_3200,pkSess_3712),Kcli_3721))
    )
    else
        {3887}let skCli_3722: bitstring = fail-any in
        {3888}let pkCli_3723: bitstring = pub(skCli_3722) in
        {3889}let v_3724: bool = (Disco = A) in
        (
            {3890}if v_3724 then
            (
                {3891}let pkDisco_3725: bitstring = pub(skA) in
                {3892}let v_3726: bool = (Sess = A) in
                (
                    {3893}if v_3726 then
                    (
                        {3894}let pkSess_3727: bitstring = pub(skA) in
                        {3895}out(c, GetEndpointRequest);
                        {3896}in(c, (SPs_3728: bitstring,=SignAndEncrypt,UP_3729: bitstring,=pkSess_3727));
                        {3897}new SPc_3730: bitstring;
                        {3898}new Nc_3731: bitstring;
                        {3899}let m1_3732: bitstring = (Sess,SPc_3730,exp(g,Nc_3731)) in
                        {3900}out(c, (pkCli_3723,enc(m1_3732,pkSess_3727),sign(m1_3732,skCli_3722)));
                        {3901}in(c, (ePartS_3733: bitstring,sigPartS_3734: bitstring));
                        {3902}let (=Cli,PartS_3735: bitstring) = dec(ePartS_3733,skCli_3722) in
                        {3903}if (verify((Cli,PartS_3735),sigPartS_3734,pkSess_3727) <> true) then
                            0
                        else
                            {3904}let Kcli_3736: bitstring = exp(PartS_3735,Nc_3731) in
                            {3905}out(c, senc(mCli(pkCli_3723,pkSess_3727),Kcli_3736))
                    )
                    else
                        {3906}let v_3737: bool = (Sess = B) in
                        (
                            {3907}if v_3737 then
                            (
                                {3908}let pkSess_3738: bitstring = pub(skB) in
                                {3909}out(c, GetEndpointRequest);
                                {3910}in(c, (SPs_3739: bitstring,=SignAndEncrypt,UP_3740: bitstring,=pkSess_3738));
                                {3911}new SPc_3741: bitstring;
                                {3912}new Nc_3742: bitstring;
                                {3913}let m1_3743: bitstring = (Sess,SPc_3741,exp(g,Nc_3742)) in
                                {3914}out(c, (pkCli_3723,enc(m1_3743,pkSess_3738),sign(m1_3743,skCli_3722)));
                                {3915}in(c, (ePartS_3744: bitstring,sigPartS_3745: bitstring));
                                {3916}let (=Cli,PartS_3746: bitstring) = dec(ePartS_3744,skCli_3722) in
                                {3917}if (verify((Cli,PartS_3746),sigPartS_3745,pkSess_3738) <> true) then
                                    0
                                else
                                    {3918}let Kcli_3747: bitstring = exp(PartS_3746,Nc_3742) in
                                    {3919}out(c, senc(mCli(pkCli_3723,pkSess_3738),Kcli_3747))
                            )
                            else
                                {3920}let v_3748: bool = (Sess = C) in
                                (
                                    {3921}if v_3748 then
                                    (
                                        {3922}let pkSess_3749: bitstring = pub(skC) in
                                        {3923}out(c, GetEndpointRequest);
                                        {3924}in(c, (SPs_3750: bitstring,=SignAndEncrypt,UP_3751: bitstring,=pkSess_3749));
                                        {3925}new SPc_3752: bitstring;
                                        {3926}new Nc_3753: bitstring;
                                        {3927}let m1_3754: bitstring = (Sess,SPc_3752,exp(g,Nc_3753)) in
                                        {3928}out(c, (pkCli_3723,enc(m1_3754,pkSess_3749),sign(m1_3754,skCli_3722)));
                                        {3929}in(c, (ePartS_3755: bitstring,sigPartS_3756: bitstring));
                                        {3930}let (=Cli,PartS_3757: bitstring) = dec(ePartS_3755,skCli_3722) in
                                        {3931}if (verify((Cli,PartS_3757),sigPartS_3756,pkSess_3749) <> true) then
                                            0
                                        else
                                            {3932}let Kcli_3758: bitstring = exp(PartS_3757,Nc_3753) in
                                            {3933}out(c, senc(mCli(pkCli_3723,pkSess_3749),Kcli_3758))
                                    )
                                    else
                                        {3934}let pkSess_3759: bitstring = pub(skI) in
                                        {3935}out(c, GetEndpointRequest);
                                        {3936}in(c, (SPs_3760: bitstring,=SignAndEncrypt,UP_3761: bitstring,=pkSess_3759));
                                        {3937}new SPc_3762: bitstring;
                                        {3938}new Nc_3763: bitstring;
                                        {3939}let m1_3764: bitstring = (Sess,SPc_3762,exp(g,Nc_3763)) in
                                        {3940}out(c, (pkCli_3723,enc(m1_3764,pkSess_3759),sign(m1_3764,skCli_3722)));
                                        {3941}in(c, (ePartS_3765: bitstring,sigPartS_3766: bitstring));
                                        {3942}let (=Cli,PartS_3767: bitstring) = dec(ePartS_3765,skCli_3722) in
                                        {3943}if (verify((Cli,PartS_3767),sigPartS_3766,pkSess_3759) <> true) then
                                            0
                                        else
                                            {3944}let Kcli_3768: bitstring = exp(PartS_3767,Nc_3763) in
                                            {3945}out(c, senc(mCli(pkCli_3723,pkSess_3759),Kcli_3768))
                                )
                                else
                                    {3946}let pkSess_3769: bitstring = fail-any in
                                    {3947}out(c, GetEndpointRequest);
                                    {3948}in(c, (SPs_3770: bitstring,=SignAndEncrypt,UP_3771: bitstring,=pkSess_3769));
                                    {3949}new SPc_3772: bitstring;
                                    {3950}new Nc_3773: bitstring;
                                    {3951}let m1_3774: bitstring = (Sess,SPc_3772,exp(g,Nc_3773)) in
                                    {3952}out(c, (pkCli_3723,enc(m1_3774,pkSess_3769),sign(m1_3774,skCli_3722)));
                                    {3953}in(c, (ePartS_3775: bitstring,sigPartS_3776: bitstring));
                                    {3954}let (=Cli,PartS_3777: bitstring) = dec(ePartS_3775,skCli_3722) in
                                    {3955}if (verify((Cli,PartS_3777),sigPartS_3776,pkSess_3769) <> true) then
                                        0
                                    else
                                        {3956}let Kcli_3778: bitstring = exp(PartS_3777,Nc_3773) in
                                        {3957}out(c, senc(mCli(pkCli_3723,pkSess_3769),Kcli_3778))
                        )
                        else
                            {3958}let pkSess_3779: bitstring = fail-any in
                            {3959}out(c, GetEndpointRequest);
                            {3960}in(c, (SPs_3780: bitstring,=SignAndEncrypt,UP_3781: bitstring,=pkSess_3779));
                            {3961}new SPc_3782: bitstring;
                            {3962}new Nc_3783: bitstring;
                            {3963}let m1_3784: bitstring = (Sess,SPc_3782,exp(g,Nc_3783)) in
                            {3964}out(c, (pkCli_3723,enc(m1_3784,pkSess_3779),sign(m1_3784,skCli_3722)));
                            {3965}in(c, (ePartS_3785: bitstring,sigPartS_3786: bitstring));
                            {3966}let (=Cli,PartS_3787: bitstring) = dec(ePartS_3785,skCli_3722) in
                            {3967}if (verify((Cli,PartS_3787),sigPartS_3786,pkSess_3779) <> true) then
                                0
                            else
                                {3968}let Kcli_3788: bitstring = exp(PartS_3787,Nc_3783) in
                                {3969}out(c, senc(mCli(pkCli_3723,pkSess_3779),Kcli_3788))
                )
                else
                    {3970}let pkSess_3789: bitstring = fail-any in
                    {3971}out(c, GetEndpointRequest);
                    {3972}in(c, (SPs_3790: bitstring,=SignAndEncrypt,UP_3791: bitstring,=pkSess_3789));
                    {3973}new SPc_3792: bitstring;
                    {3974}new Nc_3793: bitstring;
                    {3975}let m1_3794: bitstring = (Sess,SPc_3792,exp(g,Nc_3793)) in
                    {3976}out(c, (pkCli_3723,enc(m1_3794,pkSess_3789),sign(m1_3794,skCli_3722)));
                    {3977}in(c, (ePartS_3795: bitstring,sigPartS_3796: bitstring));
                    {3978}let (=Cli,PartS_3797: bitstring) = dec(ePartS_3795,skCli_3722) in
                    {3979}if (verify((Cli,PartS_3797),sigPartS_3796,pkSess_3789) <> true) then
                        0
                    else
                        {3980}let Kcli_3798: bitstring = exp(PartS_3797,Nc_3793) in
                        {3981}out(c, senc(mCli(pkCli_3723,pkSess_3789),Kcli_3798))
            )
            else
                {3982}let v_3799: bool = (Disco = B) in
                (
                    {3983}if v_3799 then
                    (
                        {3984}let pkDisco_3800: bitstring = pub(skB) in
                        {3985}let v_3801: bool = (Sess = A) in
                        (
                            {3986}if v_3801 then
                            (
                                {3987}let pkSess_3802: bitstring = pub(skA) in
                                {3988}out(c, GetEndpointRequest);
                                {3989}in(c, (SPs_3803: bitstring,=SignAndEncrypt,UP_3804: bitstring,=pkSess_3802));
                                {3990}new SPc_3805: bitstring;
                                {3991}new Nc_3806: bitstring;
                                {3992}let m1_3807: bitstring = (Sess,SPc_3805,exp(g,Nc_3806)) in
                                {3993}out(c, (pkCli_3723,enc(m1_3807,pkSess_3802),sign(m1_3807,skCli_3722)));
                                {3994}in(c, (ePartS_3808: bitstring,sigPartS_3809: bitstring));
                                {3995}let (=Cli,PartS_3810: bitstring) = dec(ePartS_3808,skCli_3722) in
                                {3996}if (verify((Cli,PartS_3810),sigPartS_3809,pkSess_3802) <> true) then
                                    0
                                else
                                    {3997}let Kcli_3811: bitstring = exp(PartS_3810,Nc_3806) in
                                    {3998}out(c, senc(mCli(pkCli_3723,pkSess_3802),Kcli_3811))
                            )
                            else
                                {3999}let v_3812: bool = (Sess = B) in
                                (
                                    {4000}if v_3812 then
                                    (
                                        {4001}let pkSess_3813: bitstring = pub(skB) in
                                        {4002}out(c, GetEndpointRequest);
                                        {4003}in(c, (SPs_3814: bitstring,=SignAndEncrypt,UP_3815: bitstring,=pkSess_3813));
                                        {4004}new SPc_3816: bitstring;
                                        {4005}new Nc_3817: bitstring;
                                        {4006}let m1_3818: bitstring = (Sess,SPc_3816,exp(g,Nc_3817)) in
                                        {4007}out(c, (pkCli_3723,enc(m1_3818,pkSess_3813),sign(m1_3818,skCli_3722)));
                                        {4008}in(c, (ePartS_3819: bitstring,sigPartS_3820: bitstring));
                                        {4009}let (=Cli,PartS_3821: bitstring) = dec(ePartS_3819,skCli_3722) in
                                        {4010}if (verify((Cli,PartS_3821),sigPartS_3820,pkSess_3813) <> true) then
                                            0
                                        else
                                            {4011}let Kcli_3822: bitstring = exp(PartS_3821,Nc_3817) in
                                            {4012}out(c, senc(mCli(pkCli_3723,pkSess_3813),Kcli_3822))
                                    )
                                    else
                                        {4013}let v_3823: bool = (Sess = C) in
                                        (
                                            {4014}if v_3823 then
                                            (
                                                {4015}let pkSess_3824: bitstring = pub(skC) in
                                                {4016}out(c, GetEndpointRequest);
                                                {4017}in(c, (SPs_3825: bitstring,=SignAndEncrypt,UP_3826: bitstring,=pkSess_3824));
                                                {4018}new SPc_3827: bitstring;
                                                {4019}new Nc_3828: bitstring;
                                                {4020}let m1_3829: bitstring = (Sess,SPc_3827,exp(g,Nc_3828)) in
                                                {4021}out(c, (pkCli_3723,enc(m1_3829,pkSess_3824),sign(m1_3829,skCli_3722)));
                                                {4022}in(c, (ePartS_3830: bitstring,sigPartS_3831: bitstring));
                                                {4023}let (=Cli,PartS_3832: bitstring) = dec(ePartS_3830,skCli_3722) in
                                                {4024}if (verify((Cli,PartS_3832),sigPartS_3831,pkSess_3824) <> true) then
                                                    0
                                                else
                                                    {4025}let Kcli_3833: bitstring = exp(PartS_3832,Nc_3828) in
                                                    {4026}out(c, senc(mCli(pkCli_3723,pkSess_3824),Kcli_3833))
                                            )
                                            else
                                                {4027}let pkSess_3834: bitstring = pub(skI) in
                                                {4028}out(c, GetEndpointRequest);
                                                {4029}in(c, (SPs_3835: bitstring,=SignAndEncrypt,UP_3836: bitstring,=pkSess_3834));
                                                {4030}new SPc_3837: bitstring;
                                                {4031}new Nc_3838: bitstring;
                                                {4032}let m1_3839: bitstring = (Sess,SPc_3837,exp(g,Nc_3838)) in
                                                {4033}out(c, (pkCli_3723,enc(m1_3839,pkSess_3834),sign(m1_3839,skCli_3722)));
                                                {4034}in(c, (ePartS_3840: bitstring,sigPartS_3841: bitstring));
                                                {4035}let (=Cli,PartS_3842: bitstring) = dec(ePartS_3840,skCli_3722) in
                                                {4036}if (verify((Cli,PartS_3842),sigPartS_3841,pkSess_3834) <> true) then
                                                    0
                                                else
                                                    {4037}let Kcli_3843: bitstring = exp(PartS_3842,Nc_3838) in
                                                    {4038}out(c, senc(mCli(pkCli_3723,pkSess_3834),Kcli_3843))
                                        )
                                        else
                                            {4039}let pkSess_3844: bitstring = fail-any in
                                            {4040}out(c, GetEndpointRequest);
                                            {4041}in(c, (SPs_3845: bitstring,=SignAndEncrypt,UP_3846: bitstring,=pkSess_3844));
                                            {4042}new SPc_3847: bitstring;
                                            {4043}new Nc_3848: bitstring;
                                            {4044}let m1_3849: bitstring = (Sess,SPc_3847,exp(g,Nc_3848)) in
                                            {4045}out(c, (pkCli_3723,enc(m1_3849,pkSess_3844),sign(m1_3849,skCli_3722)));
                                            {4046}in(c, (ePartS_3850: bitstring,sigPartS_3851: bitstring));
                                            {4047}let (=Cli,PartS_3852: bitstring) = dec(ePartS_3850,skCli_3722) in
                                            {4048}if (verify((Cli,PartS_3852),sigPartS_3851,pkSess_3844) <> true) then
                                                0
                                            else
                                                {4049}let Kcli_3853: bitstring = exp(PartS_3852,Nc_3848) in
                                                {4050}out(c, senc(mCli(pkCli_3723,pkSess_3844),Kcli_3853))
                                )
                                else
                                    {4051}let pkSess_3854: bitstring = fail-any in
                                    {4052}out(c, GetEndpointRequest);
                                    {4053}in(c, (SPs_3855: bitstring,=SignAndEncrypt,UP_3856: bitstring,=pkSess_3854));
                                    {4054}new SPc_3857: bitstring;
                                    {4055}new Nc_3858: bitstring;
                                    {4056}let m1_3859: bitstring = (Sess,SPc_3857,exp(g,Nc_3858)) in
                                    {4057}out(c, (pkCli_3723,enc(m1_3859,pkSess_3854),sign(m1_3859,skCli_3722)));
                                    {4058}in(c, (ePartS_3860: bitstring,sigPartS_3861: bitstring));
                                    {4059}let (=Cli,PartS_3862: bitstring) = dec(ePartS_3860,skCli_3722) in
                                    {4060}if (verify((Cli,PartS_3862),sigPartS_3861,pkSess_3854) <> true) then
                                        0
                                    else
                                        {4061}let Kcli_3863: bitstring = exp(PartS_3862,Nc_3858) in
                                        {4062}out(c, senc(mCli(pkCli_3723,pkSess_3854),Kcli_3863))
                        )
                        else
                            {4063}let pkSess_3864: bitstring = fail-any in
                            {4064}out(c, GetEndpointRequest);
                            {4065}in(c, (SPs_3865: bitstring,=SignAndEncrypt,UP_3866: bitstring,=pkSess_3864));
                            {4066}new SPc_3867: bitstring;
                            {4067}new Nc_3868: bitstring;
                            {4068}let m1_3869: bitstring = (Sess,SPc_3867,exp(g,Nc_3868)) in
                            {4069}out(c, (pkCli_3723,enc(m1_3869,pkSess_3864),sign(m1_3869,skCli_3722)));
                            {4070}in(c, (ePartS_3870: bitstring,sigPartS_3871: bitstring));
                            {4071}let (=Cli,PartS_3872: bitstring) = dec(ePartS_3870,skCli_3722) in
                            {4072}if (verify((Cli,PartS_3872),sigPartS_3871,pkSess_3864) <> true) then
                                0
                            else
                                {4073}let Kcli_3873: bitstring = exp(PartS_3872,Nc_3868) in
                                {4074}out(c, senc(mCli(pkCli_3723,pkSess_3864),Kcli_3873))
                    )
                    else
                        {4075}let v_3874: bool = (Disco = C) in
                        (
                            {4076}if v_3874 then
                            (
                                {4077}let pkDisco_3875: bitstring = pub(skC) in
                                {4078}let v_3876: bool = (Sess = A) in
                                (
                                    {4079}if v_3876 then
                                    (
                                        {4080}let pkSess_3877: bitstring = pub(skA) in
                                        {4081}out(c, GetEndpointRequest);
                                        {4082}in(c, (SPs_3878: bitstring,=SignAndEncrypt,UP_3879: bitstring,=pkSess_3877));
                                        {4083}new SPc_3880: bitstring;
                                        {4084}new Nc_3881: bitstring;
                                        {4085}let m1_3882: bitstring = (Sess,SPc_3880,exp(g,Nc_3881)) in
                                        {4086}out(c, (pkCli_3723,enc(m1_3882,pkSess_3877),sign(m1_3882,skCli_3722)));
                                        {4087}in(c, (ePartS_3883: bitstring,sigPartS_3884: bitstring));
                                        {4088}let (=Cli,PartS_3885: bitstring) = dec(ePartS_3883,skCli_3722) in
                                        {4089}if (verify((Cli,PartS_3885),sigPartS_3884,pkSess_3877) <> true) then
                                            0
                                        else
                                            {4090}let Kcli_3886: bitstring = exp(PartS_3885,Nc_3881) in
                                            {4091}out(c, senc(mCli(pkCli_3723,pkSess_3877),Kcli_3886))
                                    )
                                    else
                                        {4092}let v_3887: bool = (Sess = B) in
                                        (
                                            {4093}if v_3887 then
                                            (
                                                {4094}let pkSess_3888: bitstring = pub(skB) in
                                                {4095}out(c, GetEndpointRequest);
                                                {4096}in(c, (SPs_3889: bitstring,=SignAndEncrypt,UP_3890: bitstring,=pkSess_3888));
                                                {4097}new SPc_3891: bitstring;
                                                {4098}new Nc_3892: bitstring;
                                                {4099}let m1_3893: bitstring = (Sess,SPc_3891,exp(g,Nc_3892)) in
                                                {4100}out(c, (pkCli_3723,enc(m1_3893,pkSess_3888),sign(m1_3893,skCli_3722)));
                                                {4101}in(c, (ePartS_3894: bitstring,sigPartS_3895: bitstring));
                                                {4102}let (=Cli,PartS_3896: bitstring) = dec(ePartS_3894,skCli_3722) in
                                                {4103}if (verify((Cli,PartS_3896),sigPartS_3895,pkSess_3888) <> true) then
                                                    0
                                                else
                                                    {4104}let Kcli_3897: bitstring = exp(PartS_3896,Nc_3892) in
                                                    {4105}out(c, senc(mCli(pkCli_3723,pkSess_3888),Kcli_3897))
                                            )
                                            else
                                                {4106}let v_3898: bool = (Sess = C) in
                                                (
                                                    {4107}if v_3898 then
                                                    (
                                                        {4108}let pkSess_3899: bitstring = pub(skC) in
                                                        {4109}out(c, GetEndpointRequest);
                                                        {4110}in(c, (SPs_3900: bitstring,=SignAndEncrypt,UP_3901: bitstring,=pkSess_3899));
                                                        {4111}new SPc_3902: bitstring;
                                                        {4112}new Nc_3903: bitstring;
                                                        {4113}let m1_3904: bitstring = (Sess,SPc_3902,exp(g,Nc_3903)) in
                                                        {4114}out(c, (pkCli_3723,enc(m1_3904,pkSess_3899),sign(m1_3904,skCli_3722)));
                                                        {4115}in(c, (ePartS_3905: bitstring,sigPartS_3906: bitstring));
                                                        {4116}let (=Cli,PartS_3907: bitstring) = dec(ePartS_3905,skCli_3722) in
                                                        {4117}if (verify((Cli,PartS_3907),sigPartS_3906,pkSess_3899) <> true) then
                                                            0
                                                        else
                                                            {4118}let Kcli_3908: bitstring = exp(PartS_3907,Nc_3903) in
                                                            {4119}out(c, senc(mCli(pkCli_3723,pkSess_3899),Kcli_3908))
                                                    )
                                                    else
                                                        {4120}let pkSess_3909: bitstring = pub(skI) in
                                                        {4121}out(c, GetEndpointRequest);
                                                        {4122}in(c, (SPs_3910: bitstring,=SignAndEncrypt,UP_3911: bitstring,=pkSess_3909));
                                                        {4123}new SPc_3912: bitstring;
                                                        {4124}new Nc_3913: bitstring;
                                                        {4125}let m1_3914: bitstring = (Sess,SPc_3912,exp(g,Nc_3913)) in
                                                        {4126}out(c, (pkCli_3723,enc(m1_3914,pkSess_3909),sign(m1_3914,skCli_3722)));
                                                        {4127}in(c, (ePartS_3915: bitstring,sigPartS_3916: bitstring));
                                                        {4128}let (=Cli,PartS_3917: bitstring) = dec(ePartS_3915,skCli_3722) in
                                                        {4129}if (verify((Cli,PartS_3917),sigPartS_3916,pkSess_3909) <> true) then
                                                            0
                                                        else
                                                            {4130}let Kcli_3918: bitstring = exp(PartS_3917,Nc_3913) in
                                                            {4131}out(c, senc(mCli(pkCli_3723,pkSess_3909),Kcli_3918))
                                                )
                                                else
                                                    {4132}let pkSess_3919: bitstring = fail-any in
                                                    {4133}out(c, GetEndpointRequest);
                                                    {4134}in(c, (SPs_3920: bitstring,=SignAndEncrypt,UP_3921: bitstring,=pkSess_3919));
                                                    {4135}new SPc_3922: bitstring;
                                                    {4136}new Nc_3923: bitstring;
                                                    {4137}let m1_3924: bitstring = (Sess,SPc_3922,exp(g,Nc_3923)) in
                                                    {4138}out(c, (pkCli_3723,enc(m1_3924,pkSess_3919),sign(m1_3924,skCli_3722)));
                                                    {4139}in(c, (ePartS_3925: bitstring,sigPartS_3926: bitstring));
                                                    {4140}let (=Cli,PartS_3927: bitstring) = dec(ePartS_3925,skCli_3722) in
                                                    {4141}if (verify((Cli,PartS_3927),sigPartS_3926,pkSess_3919) <> true) then
                                                        0
                                                    else
                                                        {4142}let Kcli_3928: bitstring = exp(PartS_3927,Nc_3923) in
                                                        {4143}out(c, senc(mCli(pkCli_3723,pkSess_3919),Kcli_3928))
                                        )
                                        else
                                            {4144}let pkSess_3929: bitstring = fail-any in
                                            {4145}out(c, GetEndpointRequest);
                                            {4146}in(c, (SPs_3930: bitstring,=SignAndEncrypt,UP_3931: bitstring,=pkSess_3929));
                                            {4147}new SPc_3932: bitstring;
                                            {4148}new Nc_3933: bitstring;
                                            {4149}let m1_3934: bitstring = (Sess,SPc_3932,exp(g,Nc_3933)) in
                                            {4150}out(c, (pkCli_3723,enc(m1_3934,pkSess_3929),sign(m1_3934,skCli_3722)));
                                            {4151}in(c, (ePartS_3935: bitstring,sigPartS_3936: bitstring));
                                            {4152}let (=Cli,PartS_3937: bitstring) = dec(ePartS_3935,skCli_3722) in
                                            {4153}if (verify((Cli,PartS_3937),sigPartS_3936,pkSess_3929) <> true) then
                                                0
                                            else
                                                {4154}let Kcli_3938: bitstring = exp(PartS_3937,Nc_3933) in
                                                {4155}out(c, senc(mCli(pkCli_3723,pkSess_3929),Kcli_3938))
                                )
                                else
                                    {4156}let pkSess_3939: bitstring = fail-any in
                                    {4157}out(c, GetEndpointRequest);
                                    {4158}in(c, (SPs_3940: bitstring,=SignAndEncrypt,UP_3941: bitstring,=pkSess_3939));
                                    {4159}new SPc_3942: bitstring;
                                    {4160}new Nc_3943: bitstring;
                                    {4161}let m1_3944: bitstring = (Sess,SPc_3942,exp(g,Nc_3943)) in
                                    {4162}out(c, (pkCli_3723,enc(m1_3944,pkSess_3939),sign(m1_3944,skCli_3722)));
                                    {4163}in(c, (ePartS_3945: bitstring,sigPartS_3946: bitstring));
                                    {4164}let (=Cli,PartS_3947: bitstring) = dec(ePartS_3945,skCli_3722) in
                                    {4165}if (verify((Cli,PartS_3947),sigPartS_3946,pkSess_3939) <> true) then
                                        0
                                    else
                                        {4166}let Kcli_3948: bitstring = exp(PartS_3947,Nc_3943) in
                                        {4167}out(c, senc(mCli(pkCli_3723,pkSess_3939),Kcli_3948))
                            )
                            else
                                {4168}let pkDisco_3949: bitstring = pub(skI) in
                                {4169}let v_3950: bool = (Sess = A) in
                                (
                                    {4170}if v_3950 then
                                    (
                                        {4171}let pkSess_3951: bitstring = pub(skA) in
                                        {4172}out(c, GetEndpointRequest);
                                        {4173}in(c, (SPs_3952: bitstring,=SignAndEncrypt,UP_3953: bitstring,=pkSess_3951));
                                        {4174}new SPc_3954: bitstring;
                                        {4175}new Nc_3955: bitstring;
                                        {4176}let m1_3956: bitstring = (Sess,SPc_3954,exp(g,Nc_3955)) in
                                        {4177}out(c, (pkCli_3723,enc(m1_3956,pkSess_3951),sign(m1_3956,skCli_3722)));
                                        {4178}in(c, (ePartS_3957: bitstring,sigPartS_3958: bitstring));
                                        {4179}let (=Cli,PartS_3959: bitstring) = dec(ePartS_3957,skCli_3722) in
                                        {4180}if (verify((Cli,PartS_3959),sigPartS_3958,pkSess_3951) <> true) then
                                            0
                                        else
                                            {4181}let Kcli_3960: bitstring = exp(PartS_3959,Nc_3955) in
                                            {4182}out(c, senc(mCli(pkCli_3723,pkSess_3951),Kcli_3960))
                                    )
                                    else
                                        {4183}let v_3961: bool = (Sess = B) in
                                        (
                                            {4184}if v_3961 then
                                            (
                                                {4185}let pkSess_3962: bitstring = pub(skB) in
                                                {4186}out(c, GetEndpointRequest);
                                                {4187}in(c, (SPs_3963: bitstring,=SignAndEncrypt,UP_3964: bitstring,=pkSess_3962));
                                                {4188}new SPc_3965: bitstring;
                                                {4189}new Nc_3966: bitstring;
                                                {4190}let m1_3967: bitstring = (Sess,SPc_3965,exp(g,Nc_3966)) in
                                                {4191}out(c, (pkCli_3723,enc(m1_3967,pkSess_3962),sign(m1_3967,skCli_3722)));
                                                {4192}in(c, (ePartS_3968: bitstring,sigPartS_3969: bitstring));
                                                {4193}let (=Cli,PartS_3970: bitstring) = dec(ePartS_3968,skCli_3722) in
                                                {4194}if (verify((Cli,PartS_3970),sigPartS_3969,pkSess_3962) <> true) then
                                                    0
                                                else
                                                    {4195}let Kcli_3971: bitstring = exp(PartS_3970,Nc_3966) in
                                                    {4196}out(c, senc(mCli(pkCli_3723,pkSess_3962),Kcli_3971))
                                            )
                                            else
                                                {4197}let v_3972: bool = (Sess = C) in
                                                (
                                                    {4198}if v_3972 then
                                                    (
                                                        {4199}let pkSess_3973: bitstring = pub(skC) in
                                                        {4200}out(c, GetEndpointRequest);
                                                        {4201}in(c, (SPs_3974: bitstring,=SignAndEncrypt,UP_3975: bitstring,=pkSess_3973));
                                                        {4202}new SPc_3976: bitstring;
                                                        {4203}new Nc_3977: bitstring;
                                                        {4204}let m1_3978: bitstring = (Sess,SPc_3976,exp(g,Nc_3977)) in
                                                        {4205}out(c, (pkCli_3723,enc(m1_3978,pkSess_3973),sign(m1_3978,skCli_3722)));
                                                        {4206}in(c, (ePartS_3979: bitstring,sigPartS_3980: bitstring));
                                                        {4207}let (=Cli,PartS_3981: bitstring) = dec(ePartS_3979,skCli_3722) in
                                                        {4208}if (verify((Cli,PartS_3981),sigPartS_3980,pkSess_3973) <> true) then
                                                            0
                                                        else
                                                            {4209}let Kcli_3982: bitstring = exp(PartS_3981,Nc_3977) in
                                                            {4210}out(c, senc(mCli(pkCli_3723,pkSess_3973),Kcli_3982))
                                                    )
                                                    else
                                                        {4211}let pkSess_3983: bitstring = pub(skI) in
                                                        {4212}out(c, GetEndpointRequest);
                                                        {4213}in(c, (SPs_3984: bitstring,=SignAndEncrypt,UP_3985: bitstring,=pkSess_3983));
                                                        {4214}new SPc_3986: bitstring;
                                                        {4215}new Nc_3987: bitstring;
                                                        {4216}let m1_3988: bitstring = (Sess,SPc_3986,exp(g,Nc_3987)) in
                                                        {4217}out(c, (pkCli_3723,enc(m1_3988,pkSess_3983),sign(m1_3988,skCli_3722)));
                                                        {4218}in(c, (ePartS_3989: bitstring,sigPartS_3990: bitstring));
                                                        {4219}let (=Cli,PartS_3991: bitstring) = dec(ePartS_3989,skCli_3722) in
                                                        {4220}if (verify((Cli,PartS_3991),sigPartS_3990,pkSess_3983) <> true) then
                                                            0
                                                        else
                                                            {4221}let Kcli_3992: bitstring = exp(PartS_3991,Nc_3987) in
                                                            {4222}out(c, senc(mCli(pkCli_3723,pkSess_3983),Kcli_3992))
                                                )
                                                else
                                                    {4223}let pkSess_3993: bitstring = fail-any in
                                                    {4224}out(c, GetEndpointRequest);
                                                    {4225}in(c, (SPs_3994: bitstring,=SignAndEncrypt,UP_3995: bitstring,=pkSess_3993));
                                                    {4226}new SPc_3996: bitstring;
                                                    {4227}new Nc_3997: bitstring;
                                                    {4228}let m1_3998: bitstring = (Sess,SPc_3996,exp(g,Nc_3997)) in
                                                    {4229}out(c, (pkCli_3723,enc(m1_3998,pkSess_3993),sign(m1_3998,skCli_3722)));
                                                    {4230}in(c, (ePartS_3999: bitstring,sigPartS_4000: bitstring));
                                                    {4231}let (=Cli,PartS_4001: bitstring) = dec(ePartS_3999,skCli_3722) in
                                                    {4232}if (verify((Cli,PartS_4001),sigPartS_4000,pkSess_3993) <> true) then
                                                        0
                                                    else
                                                        {4233}let Kcli_4002: bitstring = exp(PartS_4001,Nc_3997) in
                                                        {4234}out(c, senc(mCli(pkCli_3723,pkSess_3993),Kcli_4002))
                                        )
                                        else
                                            {4235}let pkSess_4003: bitstring = fail-any in
                                            {4236}out(c, GetEndpointRequest);
                                            {4237}in(c, (SPs_4004: bitstring,=SignAndEncrypt,UP_4005: bitstring,=pkSess_4003));
                                            {4238}new SPc_4006: bitstring;
                                            {4239}new Nc_4007: bitstring;
                                            {4240}let m1_4008: bitstring = (Sess,SPc_4006,exp(g,Nc_4007)) in
                                            {4241}out(c, (pkCli_3723,enc(m1_4008,pkSess_4003),sign(m1_4008,skCli_3722)));
                                            {4242}in(c, (ePartS_4009: bitstring,sigPartS_4010: bitstring));
                                            {4243}let (=Cli,PartS_4011: bitstring) = dec(ePartS_4009,skCli_3722) in
                                            {4244}if (verify((Cli,PartS_4011),sigPartS_4010,pkSess_4003) <> true) then
                                                0
                                            else
                                                {4245}let Kcli_4012: bitstring = exp(PartS_4011,Nc_4007) in
                                                {4246}out(c, senc(mCli(pkCli_3723,pkSess_4003),Kcli_4012))
                                )
                                else
                                    {4247}let pkSess_4013: bitstring = fail-any in
                                    {4248}out(c, GetEndpointRequest);
                                    {4249}in(c, (SPs_4014: bitstring,=SignAndEncrypt,UP_4015: bitstring,=pkSess_4013));
                                    {4250}new SPc_4016: bitstring;
                                    {4251}new Nc_4017: bitstring;
                                    {4252}let m1_4018: bitstring = (Sess,SPc_4016,exp(g,Nc_4017)) in
                                    {4253}out(c, (pkCli_3723,enc(m1_4018,pkSess_4013),sign(m1_4018,skCli_3722)));
                                    {4254}in(c, (ePartS_4019: bitstring,sigPartS_4020: bitstring));
                                    {4255}let (=Cli,PartS_4021: bitstring) = dec(ePartS_4019,skCli_3722) in
                                    {4256}if (verify((Cli,PartS_4021),sigPartS_4020,pkSess_4013) <> true) then
                                        0
                                    else
                                        {4257}let Kcli_4022: bitstring = exp(PartS_4021,Nc_4017) in
                                        {4258}out(c, senc(mCli(pkCli_3723,pkSess_4013),Kcli_4022))
                        )
                        else
                            {4259}let pkDisco_4023: bitstring = fail-any in
                            {4260}let v_4024: bool = (Sess = A) in
                            (
                                {4261}if v_4024 then
                                (
                                    {4262}let pkSess_4025: bitstring = pub(skA) in
                                    {4263}out(c, GetEndpointRequest);
                                    {4264}in(c, (SPs_4026: bitstring,=SignAndEncrypt,UP_4027: bitstring,=pkSess_4025));
                                    {4265}new SPc_4028: bitstring;
                                    {4266}new Nc_4029: bitstring;
                                    {4267}let m1_4030: bitstring = (Sess,SPc_4028,exp(g,Nc_4029)) in
                                    {4268}out(c, (pkCli_3723,enc(m1_4030,pkSess_4025),sign(m1_4030,skCli_3722)));
                                    {4269}in(c, (ePartS_4031: bitstring,sigPartS_4032: bitstring));
                                    {4270}let (=Cli,PartS_4033: bitstring) = dec(ePartS_4031,skCli_3722) in
                                    {4271}if (verify((Cli,PartS_4033),sigPartS_4032,pkSess_4025) <> true) then
                                        0
                                    else
                                        {4272}let Kcli_4034: bitstring = exp(PartS_4033,Nc_4029) in
                                        {4273}out(c, senc(mCli(pkCli_3723,pkSess_4025),Kcli_4034))
                                )
                                else
                                    {4274}let v_4035: bool = (Sess = B) in
                                    (
                                        {4275}if v_4035 then
                                        (
                                            {4276}let pkSess_4036: bitstring = pub(skB) in
                                            {4277}out(c, GetEndpointRequest);
                                            {4278}in(c, (SPs_4037: bitstring,=SignAndEncrypt,UP_4038: bitstring,=pkSess_4036));
                                            {4279}new SPc_4039: bitstring;
                                            {4280}new Nc_4040: bitstring;
                                            {4281}let m1_4041: bitstring = (Sess,SPc_4039,exp(g,Nc_4040)) in
                                            {4282}out(c, (pkCli_3723,enc(m1_4041,pkSess_4036),sign(m1_4041,skCli_3722)));
                                            {4283}in(c, (ePartS_4042: bitstring,sigPartS_4043: bitstring));
                                            {4284}let (=Cli,PartS_4044: bitstring) = dec(ePartS_4042,skCli_3722) in
                                            {4285}if (verify((Cli,PartS_4044),sigPartS_4043,pkSess_4036) <> true) then
                                                0
                                            else
                                                {4286}let Kcli_4045: bitstring = exp(PartS_4044,Nc_4040) in
                                                {4287}out(c, senc(mCli(pkCli_3723,pkSess_4036),Kcli_4045))
                                        )
                                        else
                                            {4288}let v_4046: bool = (Sess = C) in
                                            (
                                                {4289}if v_4046 then
                                                (
                                                    {4290}let pkSess_4047: bitstring = pub(skC) in
                                                    {4291}out(c, GetEndpointRequest);
                                                    {4292}in(c, (SPs_4048: bitstring,=SignAndEncrypt,UP_4049: bitstring,=pkSess_4047));
                                                    {4293}new SPc_4050: bitstring;
                                                    {4294}new Nc_4051: bitstring;
                                                    {4295}let m1_4052: bitstring = (Sess,SPc_4050,exp(g,Nc_4051)) in
                                                    {4296}out(c, (pkCli_3723,enc(m1_4052,pkSess_4047),sign(m1_4052,skCli_3722)));
                                                    {4297}in(c, (ePartS_4053: bitstring,sigPartS_4054: bitstring));
                                                    {4298}let (=Cli,PartS_4055: bitstring) = dec(ePartS_4053,skCli_3722) in
                                                    {4299}if (verify((Cli,PartS_4055),sigPartS_4054,pkSess_4047) <> true) then
                                                        0
                                                    else
                                                        {4300}let Kcli_4056: bitstring = exp(PartS_4055,Nc_4051) in
                                                        {4301}out(c, senc(mCli(pkCli_3723,pkSess_4047),Kcli_4056))
                                                )
                                                else
                                                    {4302}let pkSess_4057: bitstring = pub(skI) in
                                                    {4303}out(c, GetEndpointRequest);
                                                    {4304}in(c, (SPs_4058: bitstring,=SignAndEncrypt,UP_4059: bitstring,=pkSess_4057));
                                                    {4305}new SPc_4060: bitstring;
                                                    {4306}new Nc_4061: bitstring;
                                                    {4307}let m1_4062: bitstring = (Sess,SPc_4060,exp(g,Nc_4061)) in
                                                    {4308}out(c, (pkCli_3723,enc(m1_4062,pkSess_4057),sign(m1_4062,skCli_3722)));
                                                    {4309}in(c, (ePartS_4063: bitstring,sigPartS_4064: bitstring));
                                                    {4310}let (=Cli,PartS_4065: bitstring) = dec(ePartS_4063,skCli_3722) in
                                                    {4311}if (verify((Cli,PartS_4065),sigPartS_4064,pkSess_4057) <> true) then
                                                        0
                                                    else
                                                        {4312}let Kcli_4066: bitstring = exp(PartS_4065,Nc_4061) in
                                                        {4313}out(c, senc(mCli(pkCli_3723,pkSess_4057),Kcli_4066))
                                            )
                                            else
                                                {4314}let pkSess_4067: bitstring = fail-any in
                                                {4315}out(c, GetEndpointRequest);
                                                {4316}in(c, (SPs_4068: bitstring,=SignAndEncrypt,UP_4069: bitstring,=pkSess_4067));
                                                {4317}new SPc_4070: bitstring;
                                                {4318}new Nc_4071: bitstring;
                                                {4319}let m1_4072: bitstring = (Sess,SPc_4070,exp(g,Nc_4071)) in
                                                {4320}out(c, (pkCli_3723,enc(m1_4072,pkSess_4067),sign(m1_4072,skCli_3722)));
                                                {4321}in(c, (ePartS_4073: bitstring,sigPartS_4074: bitstring));
                                                {4322}let (=Cli,PartS_4075: bitstring) = dec(ePartS_4073,skCli_3722) in
                                                {4323}if (verify((Cli,PartS_4075),sigPartS_4074,pkSess_4067) <> true) then
                                                    0
                                                else
                                                    {4324}let Kcli_4076: bitstring = exp(PartS_4075,Nc_4071) in
                                                    {4325}out(c, senc(mCli(pkCli_3723,pkSess_4067),Kcli_4076))
                                    )
                                    else
                                        {4326}let pkSess_4077: bitstring = fail-any in
                                        {4327}out(c, GetEndpointRequest);
                                        {4328}in(c, (SPs_4078: bitstring,=SignAndEncrypt,UP_4079: bitstring,=pkSess_4077));
                                        {4329}new SPc_4080: bitstring;
                                        {4330}new Nc_4081: bitstring;
                                        {4331}let m1_4082: bitstring = (Sess,SPc_4080,exp(g,Nc_4081)) in
                                        {4332}out(c, (pkCli_3723,enc(m1_4082,pkSess_4077),sign(m1_4082,skCli_3722)));
                                        {4333}in(c, (ePartS_4083: bitstring,sigPartS_4084: bitstring));
                                        {4334}let (=Cli,PartS_4085: bitstring) = dec(ePartS_4083,skCli_3722) in
                                        {4335}if (verify((Cli,PartS_4085),sigPartS_4084,pkSess_4077) <> true) then
                                            0
                                        else
                                            {4336}let Kcli_4086: bitstring = exp(PartS_4085,Nc_4081) in
                                            {4337}out(c, senc(mCli(pkCli_3723,pkSess_4077),Kcli_4086))
                            )
                            else
                                {4338}let pkSess_4087: bitstring = fail-any in
                                {4339}out(c, GetEndpointRequest);
                                {4340}in(c, (SPs_4088: bitstring,=SignAndEncrypt,UP_4089: bitstring,=pkSess_4087));
                                {4341}new SPc_4090: bitstring;
                                {4342}new Nc_4091: bitstring;
                                {4343}let m1_4092: bitstring = (Sess,SPc_4090,exp(g,Nc_4091)) in
                                {4344}out(c, (pkCli_3723,enc(m1_4092,pkSess_4087),sign(m1_4092,skCli_3722)));
                                {4345}in(c, (ePartS_4093: bitstring,sigPartS_4094: bitstring));
                                {4346}let (=Cli,PartS_4095: bitstring) = dec(ePartS_4093,skCli_3722) in
                                {4347}if (verify((Cli,PartS_4095),sigPartS_4094,pkSess_4087) <> true) then
                                    0
                                else
                                    {4348}let Kcli_4096: bitstring = exp(PartS_4095,Nc_4091) in
                                    {4349}out(c, senc(mCli(pkCli_3723,pkSess_4087),Kcli_4096))
                )
                else
                    {4350}let pkDisco_4097: bitstring = fail-any in
                    {4351}let v_4098: bool = (Sess = A) in
                    (
                        {4352}if v_4098 then
                        (
                            {4353}let pkSess_4099: bitstring = pub(skA) in
                            {4354}out(c, GetEndpointRequest);
                            {4355}in(c, (SPs_4100: bitstring,=SignAndEncrypt,UP_4101: bitstring,=pkSess_4099));
                            {4356}new SPc_4102: bitstring;
                            {4357}new Nc_4103: bitstring;
                            {4358}let m1_4104: bitstring = (Sess,SPc_4102,exp(g,Nc_4103)) in
                            {4359}out(c, (pkCli_3723,enc(m1_4104,pkSess_4099),sign(m1_4104,skCli_3722)));
                            {4360}in(c, (ePartS_4105: bitstring,sigPartS_4106: bitstring));
                            {4361}let (=Cli,PartS_4107: bitstring) = dec(ePartS_4105,skCli_3722) in
                            {4362}if (verify((Cli,PartS_4107),sigPartS_4106,pkSess_4099) <> true) then
                                0
                            else
                                {4363}let Kcli_4108: bitstring = exp(PartS_4107,Nc_4103) in
                                {4364}out(c, senc(mCli(pkCli_3723,pkSess_4099),Kcli_4108))
                        )
                        else
                            {4365}let v_4109: bool = (Sess = B) in
                            (
                                {4366}if v_4109 then
                                (
                                    {4367}let pkSess_4110: bitstring = pub(skB) in
                                    {4368}out(c, GetEndpointRequest);
                                    {4369}in(c, (SPs_4111: bitstring,=SignAndEncrypt,UP_4112: bitstring,=pkSess_4110));
                                    {4370}new SPc_4113: bitstring;
                                    {4371}new Nc_4114: bitstring;
                                    {4372}let m1_4115: bitstring = (Sess,SPc_4113,exp(g,Nc_4114)) in
                                    {4373}out(c, (pkCli_3723,enc(m1_4115,pkSess_4110),sign(m1_4115,skCli_3722)));
                                    {4374}in(c, (ePartS_4116: bitstring,sigPartS_4117: bitstring));
                                    {4375}let (=Cli,PartS_4118: bitstring) = dec(ePartS_4116,skCli_3722) in
                                    {4376}if (verify((Cli,PartS_4118),sigPartS_4117,pkSess_4110) <> true) then
                                        0
                                    else
                                        {4377}let Kcli_4119: bitstring = exp(PartS_4118,Nc_4114) in
                                        {4378}out(c, senc(mCli(pkCli_3723,pkSess_4110),Kcli_4119))
                                )
                                else
                                    {4379}let v_4120: bool = (Sess = C) in
                                    (
                                        {4380}if v_4120 then
                                        (
                                            {4381}let pkSess_4121: bitstring = pub(skC) in
                                            {4382}out(c, GetEndpointRequest);
                                            {4383}in(c, (SPs_4122: bitstring,=SignAndEncrypt,UP_4123: bitstring,=pkSess_4121));
                                            {4384}new SPc_4124: bitstring;
                                            {4385}new Nc_4125: bitstring;
                                            {4386}let m1_4126: bitstring = (Sess,SPc_4124,exp(g,Nc_4125)) in
                                            {4387}out(c, (pkCli_3723,enc(m1_4126,pkSess_4121),sign(m1_4126,skCli_3722)));
                                            {4388}in(c, (ePartS_4127: bitstring,sigPartS_4128: bitstring));
                                            {4389}let (=Cli,PartS_4129: bitstring) = dec(ePartS_4127,skCli_3722) in
                                            {4390}if (verify((Cli,PartS_4129),sigPartS_4128,pkSess_4121) <> true) then
                                                0
                                            else
                                                {4391}let Kcli_4130: bitstring = exp(PartS_4129,Nc_4125) in
                                                {4392}out(c, senc(mCli(pkCli_3723,pkSess_4121),Kcli_4130))
                                        )
                                        else
                                            {4393}let pkSess_4131: bitstring = pub(skI) in
                                            {4394}out(c, GetEndpointRequest);
                                            {4395}in(c, (SPs_4132: bitstring,=SignAndEncrypt,UP_4133: bitstring,=pkSess_4131));
                                            {4396}new SPc_4134: bitstring;
                                            {4397}new Nc_4135: bitstring;
                                            {4398}let m1_4136: bitstring = (Sess,SPc_4134,exp(g,Nc_4135)) in
                                            {4399}out(c, (pkCli_3723,enc(m1_4136,pkSess_4131),sign(m1_4136,skCli_3722)));
                                            {4400}in(c, (ePartS_4137: bitstring,sigPartS_4138: bitstring));
                                            {4401}let (=Cli,PartS_4139: bitstring) = dec(ePartS_4137,skCli_3722) in
                                            {4402}if (verify((Cli,PartS_4139),sigPartS_4138,pkSess_4131) <> true) then
                                                0
                                            else
                                                {4403}let Kcli_4140: bitstring = exp(PartS_4139,Nc_4135) in
                                                {4404}out(c, senc(mCli(pkCli_3723,pkSess_4131),Kcli_4140))
                                    )
                                    else
                                        {4405}let pkSess_4141: bitstring = fail-any in
                                        {4406}out(c, GetEndpointRequest);
                                        {4407}in(c, (SPs_4142: bitstring,=SignAndEncrypt,UP_4143: bitstring,=pkSess_4141));
                                        {4408}new SPc_4144: bitstring;
                                        {4409}new Nc_4145: bitstring;
                                        {4410}let m1_4146: bitstring = (Sess,SPc_4144,exp(g,Nc_4145)) in
                                        {4411}out(c, (pkCli_3723,enc(m1_4146,pkSess_4141),sign(m1_4146,skCli_3722)));
                                        {4412}in(c, (ePartS_4147: bitstring,sigPartS_4148: bitstring));
                                        {4413}let (=Cli,PartS_4149: bitstring) = dec(ePartS_4147,skCli_3722) in
                                        {4414}if (verify((Cli,PartS_4149),sigPartS_4148,pkSess_4141) <> true) then
                                            0
                                        else
                                            {4415}let Kcli_4150: bitstring = exp(PartS_4149,Nc_4145) in
                                            {4416}out(c, senc(mCli(pkCli_3723,pkSess_4141),Kcli_4150))
                            )
                            else
                                {4417}let pkSess_4151: bitstring = fail-any in
                                {4418}out(c, GetEndpointRequest);
                                {4419}in(c, (SPs_4152: bitstring,=SignAndEncrypt,UP_4153: bitstring,=pkSess_4151));
                                {4420}new SPc_4154: bitstring;
                                {4421}new Nc_4155: bitstring;
                                {4422}let m1_4156: bitstring = (Sess,SPc_4154,exp(g,Nc_4155)) in
                                {4423}out(c, (pkCli_3723,enc(m1_4156,pkSess_4151),sign(m1_4156,skCli_3722)));
                                {4424}in(c, (ePartS_4157: bitstring,sigPartS_4158: bitstring));
                                {4425}let (=Cli,PartS_4159: bitstring) = dec(ePartS_4157,skCli_3722) in
                                {4426}if (verify((Cli,PartS_4159),sigPartS_4158,pkSess_4151) <> true) then
                                    0
                                else
                                    {4427}let Kcli_4160: bitstring = exp(PartS_4159,Nc_4155) in
                                    {4428}out(c, senc(mCli(pkCli_3723,pkSess_4151),Kcli_4160))
                    )
                    else
                        {4429}let pkSess_4161: bitstring = fail-any in
                        {4430}out(c, GetEndpointRequest);
                        {4431}in(c, (SPs_4162: bitstring,=SignAndEncrypt,UP_4163: bitstring,=pkSess_4161));
                        {4432}new SPc_4164: bitstring;
                        {4433}new Nc_4165: bitstring;
                        {4434}let m1_4166: bitstring = (Sess,SPc_4164,exp(g,Nc_4165)) in
                        {4435}out(c, (pkCli_3723,enc(m1_4166,pkSess_4161),sign(m1_4166,skCli_3722)));
                        {4436}in(c, (ePartS_4167: bitstring,sigPartS_4168: bitstring));
                        {4437}let (=Cli,PartS_4169: bitstring) = dec(ePartS_4167,skCli_3722) in
                        {4438}if (verify((Cli,PartS_4169),sigPartS_4168,pkSess_4161) <> true) then
                            0
                        else
                            {4439}let Kcli_4170: bitstring = exp(PartS_4169,Nc_4165) in
                            {4440}out(c, senc(mCli(pkCli_3723,pkSess_4161),Kcli_4170))
        )
        else
            {4441}let pkDisco_4171: bitstring = fail-any in
            {4442}let v_4172: bool = (Sess = A) in
            (
                {4443}if v_4172 then
                (
                    {4444}let pkSess_4173: bitstring = pub(skA) in
                    {4445}out(c, GetEndpointRequest);
                    {4446}in(c, (SPs_4174: bitstring,=SignAndEncrypt,UP_4175: bitstring,=pkSess_4173));
                    {4447}new SPc_4176: bitstring;
                    {4448}new Nc_4177: bitstring;
                    {4449}let m1_4178: bitstring = (Sess,SPc_4176,exp(g,Nc_4177)) in
                    {4450}out(c, (pkCli_3723,enc(m1_4178,pkSess_4173),sign(m1_4178,skCli_3722)));
                    {4451}in(c, (ePartS_4179: bitstring,sigPartS_4180: bitstring));
                    {4452}let (=Cli,PartS_4181: bitstring) = dec(ePartS_4179,skCli_3722) in
                    {4453}if (verify((Cli,PartS_4181),sigPartS_4180,pkSess_4173) <> true) then
                        0
                    else
                        {4454}let Kcli_4182: bitstring = exp(PartS_4181,Nc_4177) in
                        {4455}out(c, senc(mCli(pkCli_3723,pkSess_4173),Kcli_4182))
                )
                else
                    {4456}let v_4183: bool = (Sess = B) in
                    (
                        {4457}if v_4183 then
                        (
                            {4458}let pkSess_4184: bitstring = pub(skB) in
                            {4459}out(c, GetEndpointRequest);
                            {4460}in(c, (SPs_4185: bitstring,=SignAndEncrypt,UP_4186: bitstring,=pkSess_4184));
                            {4461}new SPc_4187: bitstring;
                            {4462}new Nc_4188: bitstring;
                            {4463}let m1_4189: bitstring = (Sess,SPc_4187,exp(g,Nc_4188)) in
                            {4464}out(c, (pkCli_3723,enc(m1_4189,pkSess_4184),sign(m1_4189,skCli_3722)));
                            {4465}in(c, (ePartS_4190: bitstring,sigPartS_4191: bitstring));
                            {4466}let (=Cli,PartS_4192: bitstring) = dec(ePartS_4190,skCli_3722) in
                            {4467}if (verify((Cli,PartS_4192),sigPartS_4191,pkSess_4184) <> true) then
                                0
                            else
                                {4468}let Kcli_4193: bitstring = exp(PartS_4192,Nc_4188) in
                                {4469}out(c, senc(mCli(pkCli_3723,pkSess_4184),Kcli_4193))
                        )
                        else
                            {4470}let v_4194: bool = (Sess = C) in
                            (
                                {4471}if v_4194 then
                                (
                                    {4472}let pkSess_4195: bitstring = pub(skC) in
                                    {4473}out(c, GetEndpointRequest);
                                    {4474}in(c, (SPs_4196: bitstring,=SignAndEncrypt,UP_4197: bitstring,=pkSess_4195));
                                    {4475}new SPc_4198: bitstring;
                                    {4476}new Nc_4199: bitstring;
                                    {4477}let m1_4200: bitstring = (Sess,SPc_4198,exp(g,Nc_4199)) in
                                    {4478}out(c, (pkCli_3723,enc(m1_4200,pkSess_4195),sign(m1_4200,skCli_3722)));
                                    {4479}in(c, (ePartS_4201: bitstring,sigPartS_4202: bitstring));
                                    {4480}let (=Cli,PartS_4203: bitstring) = dec(ePartS_4201,skCli_3722) in
                                    {4481}if (verify((Cli,PartS_4203),sigPartS_4202,pkSess_4195) <> true) then
                                        0
                                    else
                                        {4482}let Kcli_4204: bitstring = exp(PartS_4203,Nc_4199) in
                                        {4483}out(c, senc(mCli(pkCli_3723,pkSess_4195),Kcli_4204))
                                )
                                else
                                    {4484}let pkSess_4205: bitstring = pub(skI) in
                                    {4485}out(c, GetEndpointRequest);
                                    {4486}in(c, (SPs_4206: bitstring,=SignAndEncrypt,UP_4207: bitstring,=pkSess_4205));
                                    {4487}new SPc_4208: bitstring;
                                    {4488}new Nc_4209: bitstring;
                                    {4489}let m1_4210: bitstring = (Sess,SPc_4208,exp(g,Nc_4209)) in
                                    {4490}out(c, (pkCli_3723,enc(m1_4210,pkSess_4205),sign(m1_4210,skCli_3722)));
                                    {4491}in(c, (ePartS_4211: bitstring,sigPartS_4212: bitstring));
                                    {4492}let (=Cli,PartS_4213: bitstring) = dec(ePartS_4211,skCli_3722) in
                                    {4493}if (verify((Cli,PartS_4213),sigPartS_4212,pkSess_4205) <> true) then
                                        0
                                    else
                                        {4494}let Kcli_4214: bitstring = exp(PartS_4213,Nc_4209) in
                                        {4495}out(c, senc(mCli(pkCli_3723,pkSess_4205),Kcli_4214))
                            )
                            else
                                {4496}let pkSess_4215: bitstring = fail-any in
                                {4497}out(c, GetEndpointRequest);
                                {4498}in(c, (SPs_4216: bitstring,=SignAndEncrypt,UP_4217: bitstring,=pkSess_4215));
                                {4499}new SPc_4218: bitstring;
                                {4500}new Nc_4219: bitstring;
                                {4501}let m1_4220: bitstring = (Sess,SPc_4218,exp(g,Nc_4219)) in
                                {4502}out(c, (pkCli_3723,enc(m1_4220,pkSess_4215),sign(m1_4220,skCli_3722)));
                                {4503}in(c, (ePartS_4221: bitstring,sigPartS_4222: bitstring));
                                {4504}let (=Cli,PartS_4223: bitstring) = dec(ePartS_4221,skCli_3722) in
                                {4505}if (verify((Cli,PartS_4223),sigPartS_4222,pkSess_4215) <> true) then
                                    0
                                else
                                    {4506}let Kcli_4224: bitstring = exp(PartS_4223,Nc_4219) in
                                    {4507}out(c, senc(mCli(pkCli_3723,pkSess_4215),Kcli_4224))
                    )
                    else
                        {4508}let pkSess_4225: bitstring = fail-any in
                        {4509}out(c, GetEndpointRequest);
                        {4510}in(c, (SPs_4226: bitstring,=SignAndEncrypt,UP_4227: bitstring,=pkSess_4225));
                        {4511}new SPc_4228: bitstring;
                        {4512}new Nc_4229: bitstring;
                        {4513}let m1_4230: bitstring = (Sess,SPc_4228,exp(g,Nc_4229)) in
                        {4514}out(c, (pkCli_3723,enc(m1_4230,pkSess_4225),sign(m1_4230,skCli_3722)));
                        {4515}in(c, (ePartS_4231: bitstring,sigPartS_4232: bitstring));
                        {4516}let (=Cli,PartS_4233: bitstring) = dec(ePartS_4231,skCli_3722) in
                        {4517}if (verify((Cli,PartS_4233),sigPartS_4232,pkSess_4225) <> true) then
                            0
                        else
                            {4518}let Kcli_4234: bitstring = exp(PartS_4233,Nc_4229) in
                            {4519}out(c, senc(mCli(pkCli_3723,pkSess_4225),Kcli_4234))
            )
            else
                {4520}let pkSess_4235: bitstring = fail-any in
                {4521}out(c, GetEndpointRequest);
                {4522}in(c, (SPs_4236: bitstring,=SignAndEncrypt,UP_4237: bitstring,=pkSess_4235));
                {4523}new SPc_4238: bitstring;
                {4524}new Nc_4239: bitstring;
                {4525}let m1_4240: bitstring = (Sess,SPc_4238,exp(g,Nc_4239)) in
                {4526}out(c, (pkCli_3723,enc(m1_4240,pkSess_4235),sign(m1_4240,skCli_3722)));
                {4527}in(c, (ePartS_4241: bitstring,sigPartS_4242: bitstring));
                {4528}let (=Cli,PartS_4243: bitstring) = dec(ePartS_4241,skCli_3722) in
                {4529}if (verify((Cli,PartS_4243),sigPartS_4242,pkSess_4235) <> true) then
                    0
                else
                    {4530}let Kcli_4244: bitstring = exp(PartS_4243,Nc_4239) in
                    {4531}out(c, senc(mCli(pkCli_3723,pkSess_4235),Kcli_4244))
) | (
    {4532}!
    {4533}in(c, (Cli_4245: host,Disco_4246: host,Sess_4247: host));
    {4534}let v_4248: bool = (Disco_4246 = A) in
    (
        {4535}if v_4248 then
        (
            {4536}let skDisco: bitstring = skA in
            {4537}let pkDisco_4249: bitstring = pub(skDisco) in
            {4538}let v_4250: bool = (Cli_4245 = A) in
            (
                {4539}if v_4250 then
                (
                    {4540}let pkCli_4251: bitstring = pub(skA) in
                    {4541}let v_4252: bool = (Sess_4247 = A) in
                    (
                        {4542}if v_4252 then
                        (
                            {4543}let pkSess_4253: bitstring = pub(skA) in
                            {4544}in(c, =GetEndpointRequest);
                            {4545}new SPs_4254: bitstring;
                            {4546}new UP_4255: bitstring;
                            {4547}out(c, (SPs_4254,Sign,UP_4255,pkSess_4253))
                        )
                        else
                            {4548}let v_4256: bool = (Sess_4247 = B) in
                            (
                                {4549}if v_4256 then
                                (
                                    {4550}let pkSess_4257: bitstring = pub(skB) in
                                    {4551}in(c, =GetEndpointRequest);
                                    {4552}new SPs_4258: bitstring;
                                    {4553}new UP_4259: bitstring;
                                    {4554}out(c, (SPs_4258,Sign,UP_4259,pkSess_4257))
                                )
                                else
                                    {4555}let v_4260: bool = (Sess_4247 = C) in
                                    (
                                        {4556}if v_4260 then
                                        (
                                            {4557}let pkSess_4261: bitstring = pub(skC) in
                                            {4558}in(c, =GetEndpointRequest);
                                            {4559}new SPs_4262: bitstring;
                                            {4560}new UP_4263: bitstring;
                                            {4561}out(c, (SPs_4262,Sign,UP_4263,pkSess_4261))
                                        )
                                        else
                                            {4562}let pkSess_4264: bitstring = pub(skI) in
                                            {4563}in(c, =GetEndpointRequest);
                                            {4564}new SPs_4265: bitstring;
                                            {4565}new UP_4266: bitstring;
                                            {4566}out(c, (SPs_4265,Sign,UP_4266,pkSess_4264))
                                    )
                                    else
                                        {4567}let pkSess_4267: bitstring = fail-any in
                                        {4568}in(c, =GetEndpointRequest);
                                        {4569}new SPs_4268: bitstring;
                                        {4570}new UP_4269: bitstring;
                                        {4571}out(c, (SPs_4268,Sign,UP_4269,pkSess_4267))
                            )
                            else
                                {4572}let pkSess_4270: bitstring = fail-any in
                                {4573}in(c, =GetEndpointRequest);
                                {4574}new SPs_4271: bitstring;
                                {4575}new UP_4272: bitstring;
                                {4576}out(c, (SPs_4271,Sign,UP_4272,pkSess_4270))
                    )
                    else
                        {4577}let pkSess_4273: bitstring = fail-any in
                        {4578}in(c, =GetEndpointRequest);
                        {4579}new SPs_4274: bitstring;
                        {4580}new UP_4275: bitstring;
                        {4581}out(c, (SPs_4274,Sign,UP_4275,pkSess_4273))
                )
                else
                    {4582}let v_4276: bool = (Cli_4245 = B) in
                    (
                        {4583}if v_4276 then
                        (
                            {4584}let pkCli_4277: bitstring = pub(skB) in
                            {4585}let v_4278: bool = (Sess_4247 = A) in
                            (
                                {4586}if v_4278 then
                                (
                                    {4587}let pkSess_4279: bitstring = pub(skA) in
                                    {4588}in(c, =GetEndpointRequest);
                                    {4589}new SPs_4280: bitstring;
                                    {4590}new UP_4281: bitstring;
                                    {4591}out(c, (SPs_4280,Sign,UP_4281,pkSess_4279))
                                )
                                else
                                    {4592}let v_4282: bool = (Sess_4247 = B) in
                                    (
                                        {4593}if v_4282 then
                                        (
                                            {4594}let pkSess_4283: bitstring = pub(skB) in
                                            {4595}in(c, =GetEndpointRequest);
                                            {4596}new SPs_4284: bitstring;
                                            {4597}new UP_4285: bitstring;
                                            {4598}out(c, (SPs_4284,Sign,UP_4285,pkSess_4283))
                                        )
                                        else
                                            {4599}let v_4286: bool = (Sess_4247 = C) in
                                            (
                                                {4600}if v_4286 then
                                                (
                                                    {4601}let pkSess_4287: bitstring = pub(skC) in
                                                    {4602}in(c, =GetEndpointRequest);
                                                    {4603}new SPs_4288: bitstring;
                                                    {4604}new UP_4289: bitstring;
                                                    {4605}out(c, (SPs_4288,Sign,UP_4289,pkSess_4287))
                                                )
                                                else
                                                    {4606}let pkSess_4290: bitstring = pub(skI) in
                                                    {4607}in(c, =GetEndpointRequest);
                                                    {4608}new SPs_4291: bitstring;
                                                    {4609}new UP_4292: bitstring;
                                                    {4610}out(c, (SPs_4291,Sign,UP_4292,pkSess_4290))
                                            )
                                            else
                                                {4611}let pkSess_4293: bitstring = fail-any in
                                                {4612}in(c, =GetEndpointRequest);
                                                {4613}new SPs_4294: bitstring;
                                                {4614}new UP_4295: bitstring;
                                                {4615}out(c, (SPs_4294,Sign,UP_4295,pkSess_4293))
                                    )
                                    else
                                        {4616}let pkSess_4296: bitstring = fail-any in
                                        {4617}in(c, =GetEndpointRequest);
                                        {4618}new SPs_4297: bitstring;
                                        {4619}new UP_4298: bitstring;
                                        {4620}out(c, (SPs_4297,Sign,UP_4298,pkSess_4296))
                            )
                            else
                                {4621}let pkSess_4299: bitstring = fail-any in
                                {4622}in(c, =GetEndpointRequest);
                                {4623}new SPs_4300: bitstring;
                                {4624}new UP_4301: bitstring;
                                {4625}out(c, (SPs_4300,Sign,UP_4301,pkSess_4299))
                        )
                        else
                            {4626}let v_4302: bool = (Cli_4245 = C) in
                            (
                                {4627}if v_4302 then
                                (
                                    {4628}let pkCli_4303: bitstring = pub(skC) in
                                    {4629}let v_4304: bool = (Sess_4247 = A) in
                                    (
                                        {4630}if v_4304 then
                                        (
                                            {4631}let pkSess_4305: bitstring = pub(skA) in
                                            {4632}in(c, =GetEndpointRequest);
                                            {4633}new SPs_4306: bitstring;
                                            {4634}new UP_4307: bitstring;
                                            {4635}out(c, (SPs_4306,Sign,UP_4307,pkSess_4305))
                                        )
                                        else
                                            {4636}let v_4308: bool = (Sess_4247 = B) in
                                            (
                                                {4637}if v_4308 then
                                                (
                                                    {4638}let pkSess_4309: bitstring = pub(skB) in
                                                    {4639}in(c, =GetEndpointRequest);
                                                    {4640}new SPs_4310: bitstring;
                                                    {4641}new UP_4311: bitstring;
                                                    {4642}out(c, (SPs_4310,Sign,UP_4311,pkSess_4309))
                                                )
                                                else
                                                    {4643}let v_4312: bool = (Sess_4247 = C) in
                                                    (
                                                        {4644}if v_4312 then
                                                        (
                                                            {4645}let pkSess_4313: bitstring = pub(skC) in
                                                            {4646}in(c, =GetEndpointRequest);
                                                            {4647}new SPs_4314: bitstring;
                                                            {4648}new UP_4315: bitstring;
                                                            {4649}out(c, (SPs_4314,Sign,UP_4315,pkSess_4313))
                                                        )
                                                        else
                                                            {4650}let pkSess_4316: bitstring = pub(skI) in
                                                            {4651}in(c, =GetEndpointRequest);
                                                            {4652}new SPs_4317: bitstring;
                                                            {4653}new UP_4318: bitstring;
                                                            {4654}out(c, (SPs_4317,Sign,UP_4318,pkSess_4316))
                                                    )
                                                    else
                                                        {4655}let pkSess_4319: bitstring = fail-any in
                                                        {4656}in(c, =GetEndpointRequest);
                                                        {4657}new SPs_4320: bitstring;
                                                        {4658}new UP_4321: bitstring;
                                                        {4659}out(c, (SPs_4320,Sign,UP_4321,pkSess_4319))
                                            )
                                            else
                                                {4660}let pkSess_4322: bitstring = fail-any in
                                                {4661}in(c, =GetEndpointRequest);
                                                {4662}new SPs_4323: bitstring;
                                                {4663}new UP_4324: bitstring;
                                                {4664}out(c, (SPs_4323,Sign,UP_4324,pkSess_4322))
                                    )
                                    else
                                        {4665}let pkSess_4325: bitstring = fail-any in
                                        {4666}in(c, =GetEndpointRequest);
                                        {4667}new SPs_4326: bitstring;
                                        {4668}new UP_4327: bitstring;
                                        {4669}out(c, (SPs_4326,Sign,UP_4327,pkSess_4325))
                                )
                                else
                                    {4670}let pkCli_4328: bitstring = pub(skI) in
                                    {4671}let v_4329: bool = (Sess_4247 = A) in
                                    (
                                        {4672}if v_4329 then
                                        (
                                            {4673}let pkSess_4330: bitstring = pub(skA) in
                                            {4674}in(c, =GetEndpointRequest);
                                            {4675}new SPs_4331: bitstring;
                                            {4676}new UP_4332: bitstring;
                                            {4677}out(c, (SPs_4331,Sign,UP_4332,pkSess_4330))
                                        )
                                        else
                                            {4678}let v_4333: bool = (Sess_4247 = B) in
                                            (
                                                {4679}if v_4333 then
                                                (
                                                    {4680}let pkSess_4334: bitstring = pub(skB) in
                                                    {4681}in(c, =GetEndpointRequest);
                                                    {4682}new SPs_4335: bitstring;
                                                    {4683}new UP_4336: bitstring;
                                                    {4684}out(c, (SPs_4335,Sign,UP_4336,pkSess_4334))
                                                )
                                                else
                                                    {4685}let v_4337: bool = (Sess_4247 = C) in
                                                    (
                                                        {4686}if v_4337 then
                                                        (
                                                            {4687}let pkSess_4338: bitstring = pub(skC) in
                                                            {4688}in(c, =GetEndpointRequest);
                                                            {4689}new SPs_4339: bitstring;
                                                            {4690}new UP_4340: bitstring;
                                                            {4691}out(c, (SPs_4339,Sign,UP_4340,pkSess_4338))
                                                        )
                                                        else
                                                            {4692}let pkSess_4341: bitstring = pub(skI) in
                                                            {4693}in(c, =GetEndpointRequest);
                                                            {4694}new SPs_4342: bitstring;
                                                            {4695}new UP_4343: bitstring;
                                                            {4696}out(c, (SPs_4342,Sign,UP_4343,pkSess_4341))
                                                    )
                                                    else
                                                        {4697}let pkSess_4344: bitstring = fail-any in
                                                        {4698}in(c, =GetEndpointRequest);
                                                        {4699}new SPs_4345: bitstring;
                                                        {4700}new UP_4346: bitstring;
                                                        {4701}out(c, (SPs_4345,Sign,UP_4346,pkSess_4344))
                                            )
                                            else
                                                {4702}let pkSess_4347: bitstring = fail-any in
                                                {4703}in(c, =GetEndpointRequest);
                                                {4704}new SPs_4348: bitstring;
                                                {4705}new UP_4349: bitstring;
                                                {4706}out(c, (SPs_4348,Sign,UP_4349,pkSess_4347))
                                    )
                                    else
                                        {4707}let pkSess_4350: bitstring = fail-any in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SPs_4351: bitstring;
                                        {4710}new UP_4352: bitstring;
                                        {4711}out(c, (SPs_4351,Sign,UP_4352,pkSess_4350))
                            )
                            else
                                {4712}let pkCli_4353: bitstring = fail-any in
                                {4713}let v_4354: bool = (Sess_4247 = A) in
                                (
                                    {4714}if v_4354 then
                                    (
                                        {4715}let pkSess_4355: bitstring = pub(skA) in
                                        {4716}in(c, =GetEndpointRequest);
                                        {4717}new SPs_4356: bitstring;
                                        {4718}new UP_4357: bitstring;
                                        {4719}out(c, (SPs_4356,Sign,UP_4357,pkSess_4355))
                                    )
                                    else
                                        {4720}let v_4358: bool = (Sess_4247 = B) in
                                        (
                                            {4721}if v_4358 then
                                            (
                                                {4722}let pkSess_4359: bitstring = pub(skB) in
                                                {4723}in(c, =GetEndpointRequest);
                                                {4724}new SPs_4360: bitstring;
                                                {4725}new UP_4361: bitstring;
                                                {4726}out(c, (SPs_4360,Sign,UP_4361,pkSess_4359))
                                            )
                                            else
                                                {4727}let v_4362: bool = (Sess_4247 = C) in
                                                (
                                                    {4728}if v_4362 then
                                                    (
                                                        {4729}let pkSess_4363: bitstring = pub(skC) in
                                                        {4730}in(c, =GetEndpointRequest);
                                                        {4731}new SPs_4364: bitstring;
                                                        {4732}new UP_4365: bitstring;
                                                        {4733}out(c, (SPs_4364,Sign,UP_4365,pkSess_4363))
                                                    )
                                                    else
                                                        {4734}let pkSess_4366: bitstring = pub(skI) in
                                                        {4735}in(c, =GetEndpointRequest);
                                                        {4736}new SPs_4367: bitstring;
                                                        {4737}new UP_4368: bitstring;
                                                        {4738}out(c, (SPs_4367,Sign,UP_4368,pkSess_4366))
                                                )
                                                else
                                                    {4739}let pkSess_4369: bitstring = fail-any in
                                                    {4740}in(c, =GetEndpointRequest);
                                                    {4741}new SPs_4370: bitstring;
                                                    {4742}new UP_4371: bitstring;
                                                    {4743}out(c, (SPs_4370,Sign,UP_4371,pkSess_4369))
                                        )
                                        else
                                            {4744}let pkSess_4372: bitstring = fail-any in
                                            {4745}in(c, =GetEndpointRequest);
                                            {4746}new SPs_4373: bitstring;
                                            {4747}new UP_4374: bitstring;
                                            {4748}out(c, (SPs_4373,Sign,UP_4374,pkSess_4372))
                                )
                                else
                                    {4749}let pkSess_4375: bitstring = fail-any in
                                    {4750}in(c, =GetEndpointRequest);
                                    {4751}new SPs_4376: bitstring;
                                    {4752}new UP_4377: bitstring;
                                    {4753}out(c, (SPs_4376,Sign,UP_4377,pkSess_4375))
                    )
                    else
                        {4754}let pkCli_4378: bitstring = fail-any in
                        {4755}let v_4379: bool = (Sess_4247 = A) in
                        (
                            {4756}if v_4379 then
                            (
                                {4757}let pkSess_4380: bitstring = pub(skA) in
                                {4758}in(c, =GetEndpointRequest);
                                {4759}new SPs_4381: bitstring;
                                {4760}new UP_4382: bitstring;
                                {4761}out(c, (SPs_4381,Sign,UP_4382,pkSess_4380))
                            )
                            else
                                {4762}let v_4383: bool = (Sess_4247 = B) in
                                (
                                    {4763}if v_4383 then
                                    (
                                        {4764}let pkSess_4384: bitstring = pub(skB) in
                                        {4765}in(c, =GetEndpointRequest);
                                        {4766}new SPs_4385: bitstring;
                                        {4767}new UP_4386: bitstring;
                                        {4768}out(c, (SPs_4385,Sign,UP_4386,pkSess_4384))
                                    )
                                    else
                                        {4769}let v_4387: bool = (Sess_4247 = C) in
                                        (
                                            {4770}if v_4387 then
                                            (
                                                {4771}let pkSess_4388: bitstring = pub(skC) in
                                                {4772}in(c, =GetEndpointRequest);
                                                {4773}new SPs_4389: bitstring;
                                                {4774}new UP_4390: bitstring;
                                                {4775}out(c, (SPs_4389,Sign,UP_4390,pkSess_4388))
                                            )
                                            else
                                                {4776}let pkSess_4391: bitstring = pub(skI) in
                                                {4777}in(c, =GetEndpointRequest);
                                                {4778}new SPs_4392: bitstring;
                                                {4779}new UP_4393: bitstring;
                                                {4780}out(c, (SPs_4392,Sign,UP_4393,pkSess_4391))
                                        )
                                        else
                                            {4781}let pkSess_4394: bitstring = fail-any in
                                            {4782}in(c, =GetEndpointRequest);
                                            {4783}new SPs_4395: bitstring;
                                            {4784}new UP_4396: bitstring;
                                            {4785}out(c, (SPs_4395,Sign,UP_4396,pkSess_4394))
                                )
                                else
                                    {4786}let pkSess_4397: bitstring = fail-any in
                                    {4787}in(c, =GetEndpointRequest);
                                    {4788}new SPs_4398: bitstring;
                                    {4789}new UP_4399: bitstring;
                                    {4790}out(c, (SPs_4398,Sign,UP_4399,pkSess_4397))
                        )
                        else
                            {4791}let pkSess_4400: bitstring = fail-any in
                            {4792}in(c, =GetEndpointRequest);
                            {4793}new SPs_4401: bitstring;
                            {4794}new UP_4402: bitstring;
                            {4795}out(c, (SPs_4401,Sign,UP_4402,pkSess_4400))
            )
            else
                {4796}let pkCli_4403: bitstring = fail-any in
                {4797}let v_4404: bool = (Sess_4247 = A) in
                (
                    {4798}if v_4404 then
                    (
                        {4799}let pkSess_4405: bitstring = pub(skA) in
                        {4800}in(c, =GetEndpointRequest);
                        {4801}new SPs_4406: bitstring;
                        {4802}new UP_4407: bitstring;
                        {4803}out(c, (SPs_4406,Sign,UP_4407,pkSess_4405))
                    )
                    else
                        {4804}let v_4408: bool = (Sess_4247 = B) in
                        (
                            {4805}if v_4408 then
                            (
                                {4806}let pkSess_4409: bitstring = pub(skB) in
                                {4807}in(c, =GetEndpointRequest);
                                {4808}new SPs_4410: bitstring;
                                {4809}new UP_4411: bitstring;
                                {4810}out(c, (SPs_4410,Sign,UP_4411,pkSess_4409))
                            )
                            else
                                {4811}let v_4412: bool = (Sess_4247 = C) in
                                (
                                    {4812}if v_4412 then
                                    (
                                        {4813}let pkSess_4413: bitstring = pub(skC) in
                                        {4814}in(c, =GetEndpointRequest);
                                        {4815}new SPs_4414: bitstring;
                                        {4816}new UP_4415: bitstring;
                                        {4817}out(c, (SPs_4414,Sign,UP_4415,pkSess_4413))
                                    )
                                    else
                                        {4818}let pkSess_4416: bitstring = pub(skI) in
                                        {4819}in(c, =GetEndpointRequest);
                                        {4820}new SPs_4417: bitstring;
                                        {4821}new UP_4418: bitstring;
                                        {4822}out(c, (SPs_4417,Sign,UP_4418,pkSess_4416))
                                )
                                else
                                    {4823}let pkSess_4419: bitstring = fail-any in
                                    {4824}in(c, =GetEndpointRequest);
                                    {4825}new SPs_4420: bitstring;
                                    {4826}new UP_4421: bitstring;
                                    {4827}out(c, (SPs_4420,Sign,UP_4421,pkSess_4419))
                        )
                        else
                            {4828}let pkSess_4422: bitstring = fail-any in
                            {4829}in(c, =GetEndpointRequest);
                            {4830}new SPs_4423: bitstring;
                            {4831}new UP_4424: bitstring;
                            {4832}out(c, (SPs_4423,Sign,UP_4424,pkSess_4422))
                )
                else
                    {4833}let pkSess_4425: bitstring = fail-any in
                    {4834}in(c, =GetEndpointRequest);
                    {4835}new SPs_4426: bitstring;
                    {4836}new UP_4427: bitstring;
                    {4837}out(c, (SPs_4426,Sign,UP_4427,pkSess_4425))
        )
        else
            {4838}let v_4428: bool = (Disco_4246 = B) in
            (
                {4839}if v_4428 then
                (
                    {4840}let skDisco_4429: bitstring = skB in
                    {4841}let pkDisco_4430: bitstring = pub(skDisco_4429) in
                    {4842}let v_4431: bool = (Cli_4245 = A) in
                    (
                        {4843}if v_4431 then
                        (
                            {4844}let pkCli_4432: bitstring = pub(skA) in
                            {4845}let v_4433: bool = (Sess_4247 = A) in
                            (
                                {4846}if v_4433 then
                                (
                                    {4847}let pkSess_4434: bitstring = pub(skA) in
                                    {4848}in(c, =GetEndpointRequest);
                                    {4849}new SPs_4435: bitstring;
                                    {4850}new UP_4436: bitstring;
                                    {4851}out(c, (SPs_4435,Sign,UP_4436,pkSess_4434))
                                )
                                else
                                    {4852}let v_4437: bool = (Sess_4247 = B) in
                                    (
                                        {4853}if v_4437 then
                                        (
                                            {4854}let pkSess_4438: bitstring = pub(skB) in
                                            {4855}in(c, =GetEndpointRequest);
                                            {4856}new SPs_4439: bitstring;
                                            {4857}new UP_4440: bitstring;
                                            {4858}out(c, (SPs_4439,Sign,UP_4440,pkSess_4438))
                                        )
                                        else
                                            {4859}let v_4441: bool = (Sess_4247 = C) in
                                            (
                                                {4860}if v_4441 then
                                                (
                                                    {4861}let pkSess_4442: bitstring = pub(skC) in
                                                    {4862}in(c, =GetEndpointRequest);
                                                    {4863}new SPs_4443: bitstring;
                                                    {4864}new UP_4444: bitstring;
                                                    {4865}out(c, (SPs_4443,Sign,UP_4444,pkSess_4442))
                                                )
                                                else
                                                    {4866}let pkSess_4445: bitstring = pub(skI) in
                                                    {4867}in(c, =GetEndpointRequest);
                                                    {4868}new SPs_4446: bitstring;
                                                    {4869}new UP_4447: bitstring;
                                                    {4870}out(c, (SPs_4446,Sign,UP_4447,pkSess_4445))
                                            )
                                            else
                                                {4871}let pkSess_4448: bitstring = fail-any in
                                                {4872}in(c, =GetEndpointRequest);
                                                {4873}new SPs_4449: bitstring;
                                                {4874}new UP_4450: bitstring;
                                                {4875}out(c, (SPs_4449,Sign,UP_4450,pkSess_4448))
                                    )
                                    else
                                        {4876}let pkSess_4451: bitstring = fail-any in
                                        {4877}in(c, =GetEndpointRequest);
                                        {4878}new SPs_4452: bitstring;
                                        {4879}new UP_4453: bitstring;
                                        {4880}out(c, (SPs_4452,Sign,UP_4453,pkSess_4451))
                            )
                            else
                                {4881}let pkSess_4454: bitstring = fail-any in
                                {4882}in(c, =GetEndpointRequest);
                                {4883}new SPs_4455: bitstring;
                                {4884}new UP_4456: bitstring;
                                {4885}out(c, (SPs_4455,Sign,UP_4456,pkSess_4454))
                        )
                        else
                            {4886}let v_4457: bool = (Cli_4245 = B) in
                            (
                                {4887}if v_4457 then
                                (
                                    {4888}let pkCli_4458: bitstring = pub(skB) in
                                    {4889}let v_4459: bool = (Sess_4247 = A) in
                                    (
                                        {4890}if v_4459 then
                                        (
                                            {4891}let pkSess_4460: bitstring = pub(skA) in
                                            {4892}in(c, =GetEndpointRequest);
                                            {4893}new SPs_4461: bitstring;
                                            {4894}new UP_4462: bitstring;
                                            {4895}out(c, (SPs_4461,Sign,UP_4462,pkSess_4460))
                                        )
                                        else
                                            {4896}let v_4463: bool = (Sess_4247 = B) in
                                            (
                                                {4897}if v_4463 then
                                                (
                                                    {4898}let pkSess_4464: bitstring = pub(skB) in
                                                    {4899}in(c, =GetEndpointRequest);
                                                    {4900}new SPs_4465: bitstring;
                                                    {4901}new UP_4466: bitstring;
                                                    {4902}out(c, (SPs_4465,Sign,UP_4466,pkSess_4464))
                                                )
                                                else
                                                    {4903}let v_4467: bool = (Sess_4247 = C) in
                                                    (
                                                        {4904}if v_4467 then
                                                        (
                                                            {4905}let pkSess_4468: bitstring = pub(skC) in
                                                            {4906}in(c, =GetEndpointRequest);
                                                            {4907}new SPs_4469: bitstring;
                                                            {4908}new UP_4470: bitstring;
                                                            {4909}out(c, (SPs_4469,Sign,UP_4470,pkSess_4468))
                                                        )
                                                        else
                                                            {4910}let pkSess_4471: bitstring = pub(skI) in
                                                            {4911}in(c, =GetEndpointRequest);
                                                            {4912}new SPs_4472: bitstring;
                                                            {4913}new UP_4473: bitstring;
                                                            {4914}out(c, (SPs_4472,Sign,UP_4473,pkSess_4471))
                                                    )
                                                    else
                                                        {4915}let pkSess_4474: bitstring = fail-any in
                                                        {4916}in(c, =GetEndpointRequest);
                                                        {4917}new SPs_4475: bitstring;
                                                        {4918}new UP_4476: bitstring;
                                                        {4919}out(c, (SPs_4475,Sign,UP_4476,pkSess_4474))
                                            )
                                            else
                                                {4920}let pkSess_4477: bitstring = fail-any in
                                                {4921}in(c, =GetEndpointRequest);
                                                {4922}new SPs_4478: bitstring;
                                                {4923}new UP_4479: bitstring;
                                                {4924}out(c, (SPs_4478,Sign,UP_4479,pkSess_4477))
                                    )
                                    else
                                        {4925}let pkSess_4480: bitstring = fail-any in
                                        {4926}in(c, =GetEndpointRequest);
                                        {4927}new SPs_4481: bitstring;
                                        {4928}new UP_4482: bitstring;
                                        {4929}out(c, (SPs_4481,Sign,UP_4482,pkSess_4480))
                                )
                                else
                                    {4930}let v_4483: bool = (Cli_4245 = C) in
                                    (
                                        {4931}if v_4483 then
                                        (
                                            {4932}let pkCli_4484: bitstring = pub(skC) in
                                            {4933}let v_4485: bool = (Sess_4247 = A) in
                                            (
                                                {4934}if v_4485 then
                                                (
                                                    {4935}let pkSess_4486: bitstring = pub(skA) in
                                                    {4936}in(c, =GetEndpointRequest);
                                                    {4937}new SPs_4487: bitstring;
                                                    {4938}new UP_4488: bitstring;
                                                    {4939}out(c, (SPs_4487,Sign,UP_4488,pkSess_4486))
                                                )
                                                else
                                                    {4940}let v_4489: bool = (Sess_4247 = B) in
                                                    (
                                                        {4941}if v_4489 then
                                                        (
                                                            {4942}let pkSess_4490: bitstring = pub(skB) in
                                                            {4943}in(c, =GetEndpointRequest);
                                                            {4944}new SPs_4491: bitstring;
                                                            {4945}new UP_4492: bitstring;
                                                            {4946}out(c, (SPs_4491,Sign,UP_4492,pkSess_4490))
                                                        )
                                                        else
                                                            {4947}let v_4493: bool = (Sess_4247 = C) in
                                                            (
                                                                {4948}if v_4493 then
                                                                (
                                                                    {4949}let pkSess_4494: bitstring = pub(skC) in
                                                                    {4950}in(c, =GetEndpointRequest);
                                                                    {4951}new SPs_4495: bitstring;
                                                                    {4952}new UP_4496: bitstring;
                                                                    {4953}out(c, (SPs_4495,Sign,UP_4496,pkSess_4494))
                                                                )
                                                                else
                                                                    {4954}let pkSess_4497: bitstring = pub(skI) in
                                                                    {4955}in(c, =GetEndpointRequest);
                                                                    {4956}new SPs_4498: bitstring;
                                                                    {4957}new UP_4499: bitstring;
                                                                    {4958}out(c, (SPs_4498,Sign,UP_4499,pkSess_4497))
                                                            )
                                                            else
                                                                {4959}let pkSess_4500: bitstring = fail-any in
                                                                {4960}in(c, =GetEndpointRequest);
                                                                {4961}new SPs_4501: bitstring;
                                                                {4962}new UP_4502: bitstring;
                                                                {4963}out(c, (SPs_4501,Sign,UP_4502,pkSess_4500))
                                                    )
                                                    else
                                                        {4964}let pkSess_4503: bitstring = fail-any in
                                                        {4965}in(c, =GetEndpointRequest);
                                                        {4966}new SPs_4504: bitstring;
                                                        {4967}new UP_4505: bitstring;
                                                        {4968}out(c, (SPs_4504,Sign,UP_4505,pkSess_4503))
                                            )
                                            else
                                                {4969}let pkSess_4506: bitstring = fail-any in
                                                {4970}in(c, =GetEndpointRequest);
                                                {4971}new SPs_4507: bitstring;
                                                {4972}new UP_4508: bitstring;
                                                {4973}out(c, (SPs_4507,Sign,UP_4508,pkSess_4506))
                                        )
                                        else
                                            {4974}let pkCli_4509: bitstring = pub(skI) in
                                            {4975}let v_4510: bool = (Sess_4247 = A) in
                                            (
                                                {4976}if v_4510 then
                                                (
                                                    {4977}let pkSess_4511: bitstring = pub(skA) in
                                                    {4978}in(c, =GetEndpointRequest);
                                                    {4979}new SPs_4512: bitstring;
                                                    {4980}new UP_4513: bitstring;
                                                    {4981}out(c, (SPs_4512,Sign,UP_4513,pkSess_4511))
                                                )
                                                else
                                                    {4982}let v_4514: bool = (Sess_4247 = B) in
                                                    (
                                                        {4983}if v_4514 then
                                                        (
                                                            {4984}let pkSess_4515: bitstring = pub(skB) in
                                                            {4985}in(c, =GetEndpointRequest);
                                                            {4986}new SPs_4516: bitstring;
                                                            {4987}new UP_4517: bitstring;
                                                            {4988}out(c, (SPs_4516,Sign,UP_4517,pkSess_4515))
                                                        )
                                                        else
                                                            {4989}let v_4518: bool = (Sess_4247 = C) in
                                                            (
                                                                {4990}if v_4518 then
                                                                (
                                                                    {4991}let pkSess_4519: bitstring = pub(skC) in
                                                                    {4992}in(c, =GetEndpointRequest);
                                                                    {4993}new SPs_4520: bitstring;
                                                                    {4994}new UP_4521: bitstring;
                                                                    {4995}out(c, (SPs_4520,Sign,UP_4521,pkSess_4519))
                                                                )
                                                                else
                                                                    {4996}let pkSess_4522: bitstring = pub(skI) in
                                                                    {4997}in(c, =GetEndpointRequest);
                                                                    {4998}new SPs_4523: bitstring;
                                                                    {4999}new UP_4524: bitstring;
                                                                    {5000}out(c, (SPs_4523,Sign,UP_4524,pkSess_4522))
                                                            )
                                                            else
                                                                {5001}let pkSess_4525: bitstring = fail-any in
                                                                {5002}in(c, =GetEndpointRequest);
                                                                {5003}new SPs_4526: bitstring;
                                                                {5004}new UP_4527: bitstring;
                                                                {5005}out(c, (SPs_4526,Sign,UP_4527,pkSess_4525))
                                                    )
                                                    else
                                                        {5006}let pkSess_4528: bitstring = fail-any in
                                                        {5007}in(c, =GetEndpointRequest);
                                                        {5008}new SPs_4529: bitstring;
                                                        {5009}new UP_4530: bitstring;
                                                        {5010}out(c, (SPs_4529,Sign,UP_4530,pkSess_4528))
                                            )
                                            else
                                                {5011}let pkSess_4531: bitstring = fail-any in
                                                {5012}in(c, =GetEndpointRequest);
                                                {5013}new SPs_4532: bitstring;
                                                {5014}new UP_4533: bitstring;
                                                {5015}out(c, (SPs_4532,Sign,UP_4533,pkSess_4531))
                                    )
                                    else
                                        {5016}let pkCli_4534: bitstring = fail-any in
                                        {5017}let v_4535: bool = (Sess_4247 = A) in
                                        (
                                            {5018}if v_4535 then
                                            (
                                                {5019}let pkSess_4536: bitstring = pub(skA) in
                                                {5020}in(c, =GetEndpointRequest);
                                                {5021}new SPs_4537: bitstring;
                                                {5022}new UP_4538: bitstring;
                                                {5023}out(c, (SPs_4537,Sign,UP_4538,pkSess_4536))
                                            )
                                            else
                                                {5024}let v_4539: bool = (Sess_4247 = B) in
                                                (
                                                    {5025}if v_4539 then
                                                    (
                                                        {5026}let pkSess_4540: bitstring = pub(skB) in
                                                        {5027}in(c, =GetEndpointRequest);
                                                        {5028}new SPs_4541: bitstring;
                                                        {5029}new UP_4542: bitstring;
                                                        {5030}out(c, (SPs_4541,Sign,UP_4542,pkSess_4540))
                                                    )
                                                    else
                                                        {5031}let v_4543: bool = (Sess_4247 = C) in
                                                        (
                                                            {5032}if v_4543 then
                                                            (
                                                                {5033}let pkSess_4544: bitstring = pub(skC) in
                                                                {5034}in(c, =GetEndpointRequest);
                                                                {5035}new SPs_4545: bitstring;
                                                                {5036}new UP_4546: bitstring;
                                                                {5037}out(c, (SPs_4545,Sign,UP_4546,pkSess_4544))
                                                            )
                                                            else
                                                                {5038}let pkSess_4547: bitstring = pub(skI) in
                                                                {5039}in(c, =GetEndpointRequest);
                                                                {5040}new SPs_4548: bitstring;
                                                                {5041}new UP_4549: bitstring;
                                                                {5042}out(c, (SPs_4548,Sign,UP_4549,pkSess_4547))
                                                        )
                                                        else
                                                            {5043}let pkSess_4550: bitstring = fail-any in
                                                            {5044}in(c, =GetEndpointRequest);
                                                            {5045}new SPs_4551: bitstring;
                                                            {5046}new UP_4552: bitstring;
                                                            {5047}out(c, (SPs_4551,Sign,UP_4552,pkSess_4550))
                                                )
                                                else
                                                    {5048}let pkSess_4553: bitstring = fail-any in
                                                    {5049}in(c, =GetEndpointRequest);
                                                    {5050}new SPs_4554: bitstring;
                                                    {5051}new UP_4555: bitstring;
                                                    {5052}out(c, (SPs_4554,Sign,UP_4555,pkSess_4553))
                                        )
                                        else
                                            {5053}let pkSess_4556: bitstring = fail-any in
                                            {5054}in(c, =GetEndpointRequest);
                                            {5055}new SPs_4557: bitstring;
                                            {5056}new UP_4558: bitstring;
                                            {5057}out(c, (SPs_4557,Sign,UP_4558,pkSess_4556))
                            )
                            else
                                {5058}let pkCli_4559: bitstring = fail-any in
                                {5059}let v_4560: bool = (Sess_4247 = A) in
                                (
                                    {5060}if v_4560 then
                                    (
                                        {5061}let pkSess_4561: bitstring = pub(skA) in
                                        {5062}in(c, =GetEndpointRequest);
                                        {5063}new SPs_4562: bitstring;
                                        {5064}new UP_4563: bitstring;
                                        {5065}out(c, (SPs_4562,Sign,UP_4563,pkSess_4561))
                                    )
                                    else
                                        {5066}let v_4564: bool = (Sess_4247 = B) in
                                        (
                                            {5067}if v_4564 then
                                            (
                                                {5068}let pkSess_4565: bitstring = pub(skB) in
                                                {5069}in(c, =GetEndpointRequest);
                                                {5070}new SPs_4566: bitstring;
                                                {5071}new UP_4567: bitstring;
                                                {5072}out(c, (SPs_4566,Sign,UP_4567,pkSess_4565))
                                            )
                                            else
                                                {5073}let v_4568: bool = (Sess_4247 = C) in
                                                (
                                                    {5074}if v_4568 then
                                                    (
                                                        {5075}let pkSess_4569: bitstring = pub(skC) in
                                                        {5076}in(c, =GetEndpointRequest);
                                                        {5077}new SPs_4570: bitstring;
                                                        {5078}new UP_4571: bitstring;
                                                        {5079}out(c, (SPs_4570,Sign,UP_4571,pkSess_4569))
                                                    )
                                                    else
                                                        {5080}let pkSess_4572: bitstring = pub(skI) in
                                                        {5081}in(c, =GetEndpointRequest);
                                                        {5082}new SPs_4573: bitstring;
                                                        {5083}new UP_4574: bitstring;
                                                        {5084}out(c, (SPs_4573,Sign,UP_4574,pkSess_4572))
                                                )
                                                else
                                                    {5085}let pkSess_4575: bitstring = fail-any in
                                                    {5086}in(c, =GetEndpointRequest);
                                                    {5087}new SPs_4576: bitstring;
                                                    {5088}new UP_4577: bitstring;
                                                    {5089}out(c, (SPs_4576,Sign,UP_4577,pkSess_4575))
                                        )
                                        else
                                            {5090}let pkSess_4578: bitstring = fail-any in
                                            {5091}in(c, =GetEndpointRequest);
                                            {5092}new SPs_4579: bitstring;
                                            {5093}new UP_4580: bitstring;
                                            {5094}out(c, (SPs_4579,Sign,UP_4580,pkSess_4578))
                                )
                                else
                                    {5095}let pkSess_4581: bitstring = fail-any in
                                    {5096}in(c, =GetEndpointRequest);
                                    {5097}new SPs_4582: bitstring;
                                    {5098}new UP_4583: bitstring;
                                    {5099}out(c, (SPs_4582,Sign,UP_4583,pkSess_4581))
                    )
                    else
                        {5100}let pkCli_4584: bitstring = fail-any in
                        {5101}let v_4585: bool = (Sess_4247 = A) in
                        (
                            {5102}if v_4585 then
                            (
                                {5103}let pkSess_4586: bitstring = pub(skA) in
                                {5104}in(c, =GetEndpointRequest);
                                {5105}new SPs_4587: bitstring;
                                {5106}new UP_4588: bitstring;
                                {5107}out(c, (SPs_4587,Sign,UP_4588,pkSess_4586))
                            )
                            else
                                {5108}let v_4589: bool = (Sess_4247 = B) in
                                (
                                    {5109}if v_4589 then
                                    (
                                        {5110}let pkSess_4590: bitstring = pub(skB) in
                                        {5111}in(c, =GetEndpointRequest);
                                        {5112}new SPs_4591: bitstring;
                                        {5113}new UP_4592: bitstring;
                                        {5114}out(c, (SPs_4591,Sign,UP_4592,pkSess_4590))
                                    )
                                    else
                                        {5115}let v_4593: bool = (Sess_4247 = C) in
                                        (
                                            {5116}if v_4593 then
                                            (
                                                {5117}let pkSess_4594: bitstring = pub(skC) in
                                                {5118}in(c, =GetEndpointRequest);
                                                {5119}new SPs_4595: bitstring;
                                                {5120}new UP_4596: bitstring;
                                                {5121}out(c, (SPs_4595,Sign,UP_4596,pkSess_4594))
                                            )
                                            else
                                                {5122}let pkSess_4597: bitstring = pub(skI) in
                                                {5123}in(c, =GetEndpointRequest);
                                                {5124}new SPs_4598: bitstring;
                                                {5125}new UP_4599: bitstring;
                                                {5126}out(c, (SPs_4598,Sign,UP_4599,pkSess_4597))
                                        )
                                        else
                                            {5127}let pkSess_4600: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SPs_4601: bitstring;
                                            {5130}new UP_4602: bitstring;
                                            {5131}out(c, (SPs_4601,Sign,UP_4602,pkSess_4600))
                                )
                                else
                                    {5132}let pkSess_4603: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SPs_4604: bitstring;
                                    {5135}new UP_4605: bitstring;
                                    {5136}out(c, (SPs_4604,Sign,UP_4605,pkSess_4603))
                        )
                        else
                            {5137}let pkSess_4606: bitstring = fail-any in
                            {5138}in(c, =GetEndpointRequest);
                            {5139}new SPs_4607: bitstring;
                            {5140}new UP_4608: bitstring;
                            {5141}out(c, (SPs_4607,Sign,UP_4608,pkSess_4606))
                )
                else
                    {5142}let v_4609: bool = (Disco_4246 = C) in
                    (
                        {5143}if v_4609 then
                        (
                            {5144}let skDisco_4610: bitstring = skC in
                            {5145}let pkDisco_4611: bitstring = pub(skDisco_4610) in
                            {5146}let v_4612: bool = (Cli_4245 = A) in
                            (
                                {5147}if v_4612 then
                                (
                                    {5148}let pkCli_4613: bitstring = pub(skA) in
                                    {5149}let v_4614: bool = (Sess_4247 = A) in
                                    (
                                        {5150}if v_4614 then
                                        (
                                            {5151}let pkSess_4615: bitstring = pub(skA) in
                                            {5152}in(c, =GetEndpointRequest);
                                            {5153}new SPs_4616: bitstring;
                                            {5154}new UP_4617: bitstring;
                                            {5155}out(c, (SPs_4616,Sign,UP_4617,pkSess_4615))
                                        )
                                        else
                                            {5156}let v_4618: bool = (Sess_4247 = B) in
                                            (
                                                {5157}if v_4618 then
                                                (
                                                    {5158}let pkSess_4619: bitstring = pub(skB) in
                                                    {5159}in(c, =GetEndpointRequest);
                                                    {5160}new SPs_4620: bitstring;
                                                    {5161}new UP_4621: bitstring;
                                                    {5162}out(c, (SPs_4620,Sign,UP_4621,pkSess_4619))
                                                )
                                                else
                                                    {5163}let v_4622: bool = (Sess_4247 = C) in
                                                    (
                                                        {5164}if v_4622 then
                                                        (
                                                            {5165}let pkSess_4623: bitstring = pub(skC) in
                                                            {5166}in(c, =GetEndpointRequest);
                                                            {5167}new SPs_4624: bitstring;
                                                            {5168}new UP_4625: bitstring;
                                                            {5169}out(c, (SPs_4624,Sign,UP_4625,pkSess_4623))
                                                        )
                                                        else
                                                            {5170}let pkSess_4626: bitstring = pub(skI) in
                                                            {5171}in(c, =GetEndpointRequest);
                                                            {5172}new SPs_4627: bitstring;
                                                            {5173}new UP_4628: bitstring;
                                                            {5174}out(c, (SPs_4627,Sign,UP_4628,pkSess_4626))
                                                    )
                                                    else
                                                        {5175}let pkSess_4629: bitstring = fail-any in
                                                        {5176}in(c, =GetEndpointRequest);
                                                        {5177}new SPs_4630: bitstring;
                                                        {5178}new UP_4631: bitstring;
                                                        {5179}out(c, (SPs_4630,Sign,UP_4631,pkSess_4629))
                                            )
                                            else
                                                {5180}let pkSess_4632: bitstring = fail-any in
                                                {5181}in(c, =GetEndpointRequest);
                                                {5182}new SPs_4633: bitstring;
                                                {5183}new UP_4634: bitstring;
                                                {5184}out(c, (SPs_4633,Sign,UP_4634,pkSess_4632))
                                    )
                                    else
                                        {5185}let pkSess_4635: bitstring = fail-any in
                                        {5186}in(c, =GetEndpointRequest);
                                        {5187}new SPs_4636: bitstring;
                                        {5188}new UP_4637: bitstring;
                                        {5189}out(c, (SPs_4636,Sign,UP_4637,pkSess_4635))
                                )
                                else
                                    {5190}let v_4638: bool = (Cli_4245 = B) in
                                    (
                                        {5191}if v_4638 then
                                        (
                                            {5192}let pkCli_4639: bitstring = pub(skB) in
                                            {5193}let v_4640: bool = (Sess_4247 = A) in
                                            (
                                                {5194}if v_4640 then
                                                (
                                                    {5195}let pkSess_4641: bitstring = pub(skA) in
                                                    {5196}in(c, =GetEndpointRequest);
                                                    {5197}new SPs_4642: bitstring;
                                                    {5198}new UP_4643: bitstring;
                                                    {5199}out(c, (SPs_4642,Sign,UP_4643,pkSess_4641))
                                                )
                                                else
                                                    {5200}let v_4644: bool = (Sess_4247 = B) in
                                                    (
                                                        {5201}if v_4644 then
                                                        (
                                                            {5202}let pkSess_4645: bitstring = pub(skB) in
                                                            {5203}in(c, =GetEndpointRequest);
                                                            {5204}new SPs_4646: bitstring;
                                                            {5205}new UP_4647: bitstring;
                                                            {5206}out(c, (SPs_4646,Sign,UP_4647,pkSess_4645))
                                                        )
                                                        else
                                                            {5207}let v_4648: bool = (Sess_4247 = C) in
                                                            (
                                                                {5208}if v_4648 then
                                                                (
                                                                    {5209}let pkSess_4649: bitstring = pub(skC) in
                                                                    {5210}in(c, =GetEndpointRequest);
                                                                    {5211}new SPs_4650: bitstring;
                                                                    {5212}new UP_4651: bitstring;
                                                                    {5213}out(c, (SPs_4650,Sign,UP_4651,pkSess_4649))
                                                                )
                                                                else
                                                                    {5214}let pkSess_4652: bitstring = pub(skI) in
                                                                    {5215}in(c, =GetEndpointRequest);
                                                                    {5216}new SPs_4653: bitstring;
                                                                    {5217}new UP_4654: bitstring;
                                                                    {5218}out(c, (SPs_4653,Sign,UP_4654,pkSess_4652))
                                                            )
                                                            else
                                                                {5219}let pkSess_4655: bitstring = fail-any in
                                                                {5220}in(c, =GetEndpointRequest);
                                                                {5221}new SPs_4656: bitstring;
                                                                {5222}new UP_4657: bitstring;
                                                                {5223}out(c, (SPs_4656,Sign,UP_4657,pkSess_4655))
                                                    )
                                                    else
                                                        {5224}let pkSess_4658: bitstring = fail-any in
                                                        {5225}in(c, =GetEndpointRequest);
                                                        {5226}new SPs_4659: bitstring;
                                                        {5227}new UP_4660: bitstring;
                                                        {5228}out(c, (SPs_4659,Sign,UP_4660,pkSess_4658))
                                            )
                                            else
                                                {5229}let pkSess_4661: bitstring = fail-any in
                                                {5230}in(c, =GetEndpointRequest);
                                                {5231}new SPs_4662: bitstring;
                                                {5232}new UP_4663: bitstring;
                                                {5233}out(c, (SPs_4662,Sign,UP_4663,pkSess_4661))
                                        )
                                        else
                                            {5234}let v_4664: bool = (Cli_4245 = C) in
                                            (
                                                {5235}if v_4664 then
                                                (
                                                    {5236}let pkCli_4665: bitstring = pub(skC) in
                                                    {5237}let v_4666: bool = (Sess_4247 = A) in
                                                    (
                                                        {5238}if v_4666 then
                                                        (
                                                            {5239}let pkSess_4667: bitstring = pub(skA) in
                                                            {5240}in(c, =GetEndpointRequest);
                                                            {5241}new SPs_4668: bitstring;
                                                            {5242}new UP_4669: bitstring;
                                                            {5243}out(c, (SPs_4668,Sign,UP_4669,pkSess_4667))
                                                        )
                                                        else
                                                            {5244}let v_4670: bool = (Sess_4247 = B) in
                                                            (
                                                                {5245}if v_4670 then
                                                                (
                                                                    {5246}let pkSess_4671: bitstring = pub(skB) in
                                                                    {5247}in(c, =GetEndpointRequest);
                                                                    {5248}new SPs_4672: bitstring;
                                                                    {5249}new UP_4673: bitstring;
                                                                    {5250}out(c, (SPs_4672,Sign,UP_4673,pkSess_4671))
                                                                )
                                                                else
                                                                    {5251}let v_4674: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5252}if v_4674 then
                                                                        (
                                                                            {5253}let pkSess_4675: bitstring = pub(skC) in
                                                                            {5254}in(c, =GetEndpointRequest);
                                                                            {5255}new SPs_4676: bitstring;
                                                                            {5256}new UP_4677: bitstring;
                                                                            {5257}out(c, (SPs_4676,Sign,UP_4677,pkSess_4675))
                                                                        )
                                                                        else
                                                                            {5258}let pkSess_4678: bitstring = pub(skI) in
                                                                            {5259}in(c, =GetEndpointRequest);
                                                                            {5260}new SPs_4679: bitstring;
                                                                            {5261}new UP_4680: bitstring;
                                                                            {5262}out(c, (SPs_4679,Sign,UP_4680,pkSess_4678))
                                                                    )
                                                                    else
                                                                        {5263}let pkSess_4681: bitstring = fail-any in
                                                                        {5264}in(c, =GetEndpointRequest);
                                                                        {5265}new SPs_4682: bitstring;
                                                                        {5266}new UP_4683: bitstring;
                                                                        {5267}out(c, (SPs_4682,Sign,UP_4683,pkSess_4681))
                                                            )
                                                            else
                                                                {5268}let pkSess_4684: bitstring = fail-any in
                                                                {5269}in(c, =GetEndpointRequest);
                                                                {5270}new SPs_4685: bitstring;
                                                                {5271}new UP_4686: bitstring;
                                                                {5272}out(c, (SPs_4685,Sign,UP_4686,pkSess_4684))
                                                    )
                                                    else
                                                        {5273}let pkSess_4687: bitstring = fail-any in
                                                        {5274}in(c, =GetEndpointRequest);
                                                        {5275}new SPs_4688: bitstring;
                                                        {5276}new UP_4689: bitstring;
                                                        {5277}out(c, (SPs_4688,Sign,UP_4689,pkSess_4687))
                                                )
                                                else
                                                    {5278}let pkCli_4690: bitstring = pub(skI) in
                                                    {5279}let v_4691: bool = (Sess_4247 = A) in
                                                    (
                                                        {5280}if v_4691 then
                                                        (
                                                            {5281}let pkSess_4692: bitstring = pub(skA) in
                                                            {5282}in(c, =GetEndpointRequest);
                                                            {5283}new SPs_4693: bitstring;
                                                            {5284}new UP_4694: bitstring;
                                                            {5285}out(c, (SPs_4693,Sign,UP_4694,pkSess_4692))
                                                        )
                                                        else
                                                            {5286}let v_4695: bool = (Sess_4247 = B) in
                                                            (
                                                                {5287}if v_4695 then
                                                                (
                                                                    {5288}let pkSess_4696: bitstring = pub(skB) in
                                                                    {5289}in(c, =GetEndpointRequest);
                                                                    {5290}new SPs_4697: bitstring;
                                                                    {5291}new UP_4698: bitstring;
                                                                    {5292}out(c, (SPs_4697,Sign,UP_4698,pkSess_4696))
                                                                )
                                                                else
                                                                    {5293}let v_4699: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5294}if v_4699 then
                                                                        (
                                                                            {5295}let pkSess_4700: bitstring = pub(skC) in
                                                                            {5296}in(c, =GetEndpointRequest);
                                                                            {5297}new SPs_4701: bitstring;
                                                                            {5298}new UP_4702: bitstring;
                                                                            {5299}out(c, (SPs_4701,Sign,UP_4702,pkSess_4700))
                                                                        )
                                                                        else
                                                                            {5300}let pkSess_4703: bitstring = pub(skI) in
                                                                            {5301}in(c, =GetEndpointRequest);
                                                                            {5302}new SPs_4704: bitstring;
                                                                            {5303}new UP_4705: bitstring;
                                                                            {5304}out(c, (SPs_4704,Sign,UP_4705,pkSess_4703))
                                                                    )
                                                                    else
                                                                        {5305}let pkSess_4706: bitstring = fail-any in
                                                                        {5306}in(c, =GetEndpointRequest);
                                                                        {5307}new SPs_4707: bitstring;
                                                                        {5308}new UP_4708: bitstring;
                                                                        {5309}out(c, (SPs_4707,Sign,UP_4708,pkSess_4706))
                                                            )
                                                            else
                                                                {5310}let pkSess_4709: bitstring = fail-any in
                                                                {5311}in(c, =GetEndpointRequest);
                                                                {5312}new SPs_4710: bitstring;
                                                                {5313}new UP_4711: bitstring;
                                                                {5314}out(c, (SPs_4710,Sign,UP_4711,pkSess_4709))
                                                    )
                                                    else
                                                        {5315}let pkSess_4712: bitstring = fail-any in
                                                        {5316}in(c, =GetEndpointRequest);
                                                        {5317}new SPs_4713: bitstring;
                                                        {5318}new UP_4714: bitstring;
                                                        {5319}out(c, (SPs_4713,Sign,UP_4714,pkSess_4712))
                                            )
                                            else
                                                {5320}let pkCli_4715: bitstring = fail-any in
                                                {5321}let v_4716: bool = (Sess_4247 = A) in
                                                (
                                                    {5322}if v_4716 then
                                                    (
                                                        {5323}let pkSess_4717: bitstring = pub(skA) in
                                                        {5324}in(c, =GetEndpointRequest);
                                                        {5325}new SPs_4718: bitstring;
                                                        {5326}new UP_4719: bitstring;
                                                        {5327}out(c, (SPs_4718,Sign,UP_4719,pkSess_4717))
                                                    )
                                                    else
                                                        {5328}let v_4720: bool = (Sess_4247 = B) in
                                                        (
                                                            {5329}if v_4720 then
                                                            (
                                                                {5330}let pkSess_4721: bitstring = pub(skB) in
                                                                {5331}in(c, =GetEndpointRequest);
                                                                {5332}new SPs_4722: bitstring;
                                                                {5333}new UP_4723: bitstring;
                                                                {5334}out(c, (SPs_4722,Sign,UP_4723,pkSess_4721))
                                                            )
                                                            else
                                                                {5335}let v_4724: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5336}if v_4724 then
                                                                    (
                                                                        {5337}let pkSess_4725: bitstring = pub(skC) in
                                                                        {5338}in(c, =GetEndpointRequest);
                                                                        {5339}new SPs_4726: bitstring;
                                                                        {5340}new UP_4727: bitstring;
                                                                        {5341}out(c, (SPs_4726,Sign,UP_4727,pkSess_4725))
                                                                    )
                                                                    else
                                                                        {5342}let pkSess_4728: bitstring = pub(skI) in
                                                                        {5343}in(c, =GetEndpointRequest);
                                                                        {5344}new SPs_4729: bitstring;
                                                                        {5345}new UP_4730: bitstring;
                                                                        {5346}out(c, (SPs_4729,Sign,UP_4730,pkSess_4728))
                                                                )
                                                                else
                                                                    {5347}let pkSess_4731: bitstring = fail-any in
                                                                    {5348}in(c, =GetEndpointRequest);
                                                                    {5349}new SPs_4732: bitstring;
                                                                    {5350}new UP_4733: bitstring;
                                                                    {5351}out(c, (SPs_4732,Sign,UP_4733,pkSess_4731))
                                                        )
                                                        else
                                                            {5352}let pkSess_4734: bitstring = fail-any in
                                                            {5353}in(c, =GetEndpointRequest);
                                                            {5354}new SPs_4735: bitstring;
                                                            {5355}new UP_4736: bitstring;
                                                            {5356}out(c, (SPs_4735,Sign,UP_4736,pkSess_4734))
                                                )
                                                else
                                                    {5357}let pkSess_4737: bitstring = fail-any in
                                                    {5358}in(c, =GetEndpointRequest);
                                                    {5359}new SPs_4738: bitstring;
                                                    {5360}new UP_4739: bitstring;
                                                    {5361}out(c, (SPs_4738,Sign,UP_4739,pkSess_4737))
                                    )
                                    else
                                        {5362}let pkCli_4740: bitstring = fail-any in
                                        {5363}let v_4741: bool = (Sess_4247 = A) in
                                        (
                                            {5364}if v_4741 then
                                            (
                                                {5365}let pkSess_4742: bitstring = pub(skA) in
                                                {5366}in(c, =GetEndpointRequest);
                                                {5367}new SPs_4743: bitstring;
                                                {5368}new UP_4744: bitstring;
                                                {5369}out(c, (SPs_4743,Sign,UP_4744,pkSess_4742))
                                            )
                                            else
                                                {5370}let v_4745: bool = (Sess_4247 = B) in
                                                (
                                                    {5371}if v_4745 then
                                                    (
                                                        {5372}let pkSess_4746: bitstring = pub(skB) in
                                                        {5373}in(c, =GetEndpointRequest);
                                                        {5374}new SPs_4747: bitstring;
                                                        {5375}new UP_4748: bitstring;
                                                        {5376}out(c, (SPs_4747,Sign,UP_4748,pkSess_4746))
                                                    )
                                                    else
                                                        {5377}let v_4749: bool = (Sess_4247 = C) in
                                                        (
                                                            {5378}if v_4749 then
                                                            (
                                                                {5379}let pkSess_4750: bitstring = pub(skC) in
                                                                {5380}in(c, =GetEndpointRequest);
                                                                {5381}new SPs_4751: bitstring;
                                                                {5382}new UP_4752: bitstring;
                                                                {5383}out(c, (SPs_4751,Sign,UP_4752,pkSess_4750))
                                                            )
                                                            else
                                                                {5384}let pkSess_4753: bitstring = pub(skI) in
                                                                {5385}in(c, =GetEndpointRequest);
                                                                {5386}new SPs_4754: bitstring;
                                                                {5387}new UP_4755: bitstring;
                                                                {5388}out(c, (SPs_4754,Sign,UP_4755,pkSess_4753))
                                                        )
                                                        else
                                                            {5389}let pkSess_4756: bitstring = fail-any in
                                                            {5390}in(c, =GetEndpointRequest);
                                                            {5391}new SPs_4757: bitstring;
                                                            {5392}new UP_4758: bitstring;
                                                            {5393}out(c, (SPs_4757,Sign,UP_4758,pkSess_4756))
                                                )
                                                else
                                                    {5394}let pkSess_4759: bitstring = fail-any in
                                                    {5395}in(c, =GetEndpointRequest);
                                                    {5396}new SPs_4760: bitstring;
                                                    {5397}new UP_4761: bitstring;
                                                    {5398}out(c, (SPs_4760,Sign,UP_4761,pkSess_4759))
                                        )
                                        else
                                            {5399}let pkSess_4762: bitstring = fail-any in
                                            {5400}in(c, =GetEndpointRequest);
                                            {5401}new SPs_4763: bitstring;
                                            {5402}new UP_4764: bitstring;
                                            {5403}out(c, (SPs_4763,Sign,UP_4764,pkSess_4762))
                            )
                            else
                                {5404}let pkCli_4765: bitstring = fail-any in
                                {5405}let v_4766: bool = (Sess_4247 = A) in
                                (
                                    {5406}if v_4766 then
                                    (
                                        {5407}let pkSess_4767: bitstring = pub(skA) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SPs_4768: bitstring;
                                        {5410}new UP_4769: bitstring;
                                        {5411}out(c, (SPs_4768,Sign,UP_4769,pkSess_4767))
                                    )
                                    else
                                        {5412}let v_4770: bool = (Sess_4247 = B) in
                                        (
                                            {5413}if v_4770 then
                                            (
                                                {5414}let pkSess_4771: bitstring = pub(skB) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SPs_4772: bitstring;
                                                {5417}new UP_4773: bitstring;
                                                {5418}out(c, (SPs_4772,Sign,UP_4773,pkSess_4771))
                                            )
                                            else
                                                {5419}let v_4774: bool = (Sess_4247 = C) in
                                                (
                                                    {5420}if v_4774 then
                                                    (
                                                        {5421}let pkSess_4775: bitstring = pub(skC) in
                                                        {5422}in(c, =GetEndpointRequest);
                                                        {5423}new SPs_4776: bitstring;
                                                        {5424}new UP_4777: bitstring;
                                                        {5425}out(c, (SPs_4776,Sign,UP_4777,pkSess_4775))
                                                    )
                                                    else
                                                        {5426}let pkSess_4778: bitstring = pub(skI) in
                                                        {5427}in(c, =GetEndpointRequest);
                                                        {5428}new SPs_4779: bitstring;
                                                        {5429}new UP_4780: bitstring;
                                                        {5430}out(c, (SPs_4779,Sign,UP_4780,pkSess_4778))
                                                )
                                                else
                                                    {5431}let pkSess_4781: bitstring = fail-any in
                                                    {5432}in(c, =GetEndpointRequest);
                                                    {5433}new SPs_4782: bitstring;
                                                    {5434}new UP_4783: bitstring;
                                                    {5435}out(c, (SPs_4782,Sign,UP_4783,pkSess_4781))
                                        )
                                        else
                                            {5436}let pkSess_4784: bitstring = fail-any in
                                            {5437}in(c, =GetEndpointRequest);
                                            {5438}new SPs_4785: bitstring;
                                            {5439}new UP_4786: bitstring;
                                            {5440}out(c, (SPs_4785,Sign,UP_4786,pkSess_4784))
                                )
                                else
                                    {5441}let pkSess_4787: bitstring = fail-any in
                                    {5442}in(c, =GetEndpointRequest);
                                    {5443}new SPs_4788: bitstring;
                                    {5444}new UP_4789: bitstring;
                                    {5445}out(c, (SPs_4788,Sign,UP_4789,pkSess_4787))
                        )
                        else
                            {5446}let skDisco_4790: bitstring = skI in
                            {5447}let pkDisco_4791: bitstring = pub(skDisco_4790) in
                            {5448}let v_4792: bool = (Cli_4245 = A) in
                            (
                                {5449}if v_4792 then
                                (
                                    {5450}let pkCli_4793: bitstring = pub(skA) in
                                    {5451}let v_4794: bool = (Sess_4247 = A) in
                                    (
                                        {5452}if v_4794 then
                                        (
                                            {5453}let pkSess_4795: bitstring = pub(skA) in
                                            {5454}in(c, =GetEndpointRequest);
                                            {5455}new SPs_4796: bitstring;
                                            {5456}new UP_4797: bitstring;
                                            {5457}out(c, (SPs_4796,Sign,UP_4797,pkSess_4795))
                                        )
                                        else
                                            {5458}let v_4798: bool = (Sess_4247 = B) in
                                            (
                                                {5459}if v_4798 then
                                                (
                                                    {5460}let pkSess_4799: bitstring = pub(skB) in
                                                    {5461}in(c, =GetEndpointRequest);
                                                    {5462}new SPs_4800: bitstring;
                                                    {5463}new UP_4801: bitstring;
                                                    {5464}out(c, (SPs_4800,Sign,UP_4801,pkSess_4799))
                                                )
                                                else
                                                    {5465}let v_4802: bool = (Sess_4247 = C) in
                                                    (
                                                        {5466}if v_4802 then
                                                        (
                                                            {5467}let pkSess_4803: bitstring = pub(skC) in
                                                            {5468}in(c, =GetEndpointRequest);
                                                            {5469}new SPs_4804: bitstring;
                                                            {5470}new UP_4805: bitstring;
                                                            {5471}out(c, (SPs_4804,Sign,UP_4805,pkSess_4803))
                                                        )
                                                        else
                                                            {5472}let pkSess_4806: bitstring = pub(skI) in
                                                            {5473}in(c, =GetEndpointRequest);
                                                            {5474}new SPs_4807: bitstring;
                                                            {5475}new UP_4808: bitstring;
                                                            {5476}out(c, (SPs_4807,Sign,UP_4808,pkSess_4806))
                                                    )
                                                    else
                                                        {5477}let pkSess_4809: bitstring = fail-any in
                                                        {5478}in(c, =GetEndpointRequest);
                                                        {5479}new SPs_4810: bitstring;
                                                        {5480}new UP_4811: bitstring;
                                                        {5481}out(c, (SPs_4810,Sign,UP_4811,pkSess_4809))
                                            )
                                            else
                                                {5482}let pkSess_4812: bitstring = fail-any in
                                                {5483}in(c, =GetEndpointRequest);
                                                {5484}new SPs_4813: bitstring;
                                                {5485}new UP_4814: bitstring;
                                                {5486}out(c, (SPs_4813,Sign,UP_4814,pkSess_4812))
                                    )
                                    else
                                        {5487}let pkSess_4815: bitstring = fail-any in
                                        {5488}in(c, =GetEndpointRequest);
                                        {5489}new SPs_4816: bitstring;
                                        {5490}new UP_4817: bitstring;
                                        {5491}out(c, (SPs_4816,Sign,UP_4817,pkSess_4815))
                                )
                                else
                                    {5492}let v_4818: bool = (Cli_4245 = B) in
                                    (
                                        {5493}if v_4818 then
                                        (
                                            {5494}let pkCli_4819: bitstring = pub(skB) in
                                            {5495}let v_4820: bool = (Sess_4247 = A) in
                                            (
                                                {5496}if v_4820 then
                                                (
                                                    {5497}let pkSess_4821: bitstring = pub(skA) in
                                                    {5498}in(c, =GetEndpointRequest);
                                                    {5499}new SPs_4822: bitstring;
                                                    {5500}new UP_4823: bitstring;
                                                    {5501}out(c, (SPs_4822,Sign,UP_4823,pkSess_4821))
                                                )
                                                else
                                                    {5502}let v_4824: bool = (Sess_4247 = B) in
                                                    (
                                                        {5503}if v_4824 then
                                                        (
                                                            {5504}let pkSess_4825: bitstring = pub(skB) in
                                                            {5505}in(c, =GetEndpointRequest);
                                                            {5506}new SPs_4826: bitstring;
                                                            {5507}new UP_4827: bitstring;
                                                            {5508}out(c, (SPs_4826,Sign,UP_4827,pkSess_4825))
                                                        )
                                                        else
                                                            {5509}let v_4828: bool = (Sess_4247 = C) in
                                                            (
                                                                {5510}if v_4828 then
                                                                (
                                                                    {5511}let pkSess_4829: bitstring = pub(skC) in
                                                                    {5512}in(c, =GetEndpointRequest);
                                                                    {5513}new SPs_4830: bitstring;
                                                                    {5514}new UP_4831: bitstring;
                                                                    {5515}out(c, (SPs_4830,Sign,UP_4831,pkSess_4829))
                                                                )
                                                                else
                                                                    {5516}let pkSess_4832: bitstring = pub(skI) in
                                                                    {5517}in(c, =GetEndpointRequest);
                                                                    {5518}new SPs_4833: bitstring;
                                                                    {5519}new UP_4834: bitstring;
                                                                    {5520}out(c, (SPs_4833,Sign,UP_4834,pkSess_4832))
                                                            )
                                                            else
                                                                {5521}let pkSess_4835: bitstring = fail-any in
                                                                {5522}in(c, =GetEndpointRequest);
                                                                {5523}new SPs_4836: bitstring;
                                                                {5524}new UP_4837: bitstring;
                                                                {5525}out(c, (SPs_4836,Sign,UP_4837,pkSess_4835))
                                                    )
                                                    else
                                                        {5526}let pkSess_4838: bitstring = fail-any in
                                                        {5527}in(c, =GetEndpointRequest);
                                                        {5528}new SPs_4839: bitstring;
                                                        {5529}new UP_4840: bitstring;
                                                        {5530}out(c, (SPs_4839,Sign,UP_4840,pkSess_4838))
                                            )
                                            else
                                                {5531}let pkSess_4841: bitstring = fail-any in
                                                {5532}in(c, =GetEndpointRequest);
                                                {5533}new SPs_4842: bitstring;
                                                {5534}new UP_4843: bitstring;
                                                {5535}out(c, (SPs_4842,Sign,UP_4843,pkSess_4841))
                                        )
                                        else
                                            {5536}let v_4844: bool = (Cli_4245 = C) in
                                            (
                                                {5537}if v_4844 then
                                                (
                                                    {5538}let pkCli_4845: bitstring = pub(skC) in
                                                    {5539}let v_4846: bool = (Sess_4247 = A) in
                                                    (
                                                        {5540}if v_4846 then
                                                        (
                                                            {5541}let pkSess_4847: bitstring = pub(skA) in
                                                            {5542}in(c, =GetEndpointRequest);
                                                            {5543}new SPs_4848: bitstring;
                                                            {5544}new UP_4849: bitstring;
                                                            {5545}out(c, (SPs_4848,Sign,UP_4849,pkSess_4847))
                                                        )
                                                        else
                                                            {5546}let v_4850: bool = (Sess_4247 = B) in
                                                            (
                                                                {5547}if v_4850 then
                                                                (
                                                                    {5548}let pkSess_4851: bitstring = pub(skB) in
                                                                    {5549}in(c, =GetEndpointRequest);
                                                                    {5550}new SPs_4852: bitstring;
                                                                    {5551}new UP_4853: bitstring;
                                                                    {5552}out(c, (SPs_4852,Sign,UP_4853,pkSess_4851))
                                                                )
                                                                else
                                                                    {5553}let v_4854: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5554}if v_4854 then
                                                                        (
                                                                            {5555}let pkSess_4855: bitstring = pub(skC) in
                                                                            {5556}in(c, =GetEndpointRequest);
                                                                            {5557}new SPs_4856: bitstring;
                                                                            {5558}new UP_4857: bitstring;
                                                                            {5559}out(c, (SPs_4856,Sign,UP_4857,pkSess_4855))
                                                                        )
                                                                        else
                                                                            {5560}let pkSess_4858: bitstring = pub(skI) in
                                                                            {5561}in(c, =GetEndpointRequest);
                                                                            {5562}new SPs_4859: bitstring;
                                                                            {5563}new UP_4860: bitstring;
                                                                            {5564}out(c, (SPs_4859,Sign,UP_4860,pkSess_4858))
                                                                    )
                                                                    else
                                                                        {5565}let pkSess_4861: bitstring = fail-any in
                                                                        {5566}in(c, =GetEndpointRequest);
                                                                        {5567}new SPs_4862: bitstring;
                                                                        {5568}new UP_4863: bitstring;
                                                                        {5569}out(c, (SPs_4862,Sign,UP_4863,pkSess_4861))
                                                            )
                                                            else
                                                                {5570}let pkSess_4864: bitstring = fail-any in
                                                                {5571}in(c, =GetEndpointRequest);
                                                                {5572}new SPs_4865: bitstring;
                                                                {5573}new UP_4866: bitstring;
                                                                {5574}out(c, (SPs_4865,Sign,UP_4866,pkSess_4864))
                                                    )
                                                    else
                                                        {5575}let pkSess_4867: bitstring = fail-any in
                                                        {5576}in(c, =GetEndpointRequest);
                                                        {5577}new SPs_4868: bitstring;
                                                        {5578}new UP_4869: bitstring;
                                                        {5579}out(c, (SPs_4868,Sign,UP_4869,pkSess_4867))
                                                )
                                                else
                                                    {5580}let pkCli_4870: bitstring = pub(skI) in
                                                    {5581}let v_4871: bool = (Sess_4247 = A) in
                                                    (
                                                        {5582}if v_4871 then
                                                        (
                                                            {5583}let pkSess_4872: bitstring = pub(skA) in
                                                            {5584}in(c, =GetEndpointRequest);
                                                            {5585}new SPs_4873: bitstring;
                                                            {5586}new UP_4874: bitstring;
                                                            {5587}out(c, (SPs_4873,Sign,UP_4874,pkSess_4872))
                                                        )
                                                        else
                                                            {5588}let v_4875: bool = (Sess_4247 = B) in
                                                            (
                                                                {5589}if v_4875 then
                                                                (
                                                                    {5590}let pkSess_4876: bitstring = pub(skB) in
                                                                    {5591}in(c, =GetEndpointRequest);
                                                                    {5592}new SPs_4877: bitstring;
                                                                    {5593}new UP_4878: bitstring;
                                                                    {5594}out(c, (SPs_4877,Sign,UP_4878,pkSess_4876))
                                                                )
                                                                else
                                                                    {5595}let v_4879: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5596}if v_4879 then
                                                                        (
                                                                            {5597}let pkSess_4880: bitstring = pub(skC) in
                                                                            {5598}in(c, =GetEndpointRequest);
                                                                            {5599}new SPs_4881: bitstring;
                                                                            {5600}new UP_4882: bitstring;
                                                                            {5601}out(c, (SPs_4881,Sign,UP_4882,pkSess_4880))
                                                                        )
                                                                        else
                                                                            {5602}let pkSess_4883: bitstring = pub(skI) in
                                                                            {5603}in(c, =GetEndpointRequest);
                                                                            {5604}new SPs_4884: bitstring;
                                                                            {5605}new UP_4885: bitstring;
                                                                            {5606}out(c, (SPs_4884,Sign,UP_4885,pkSess_4883))
                                                                    )
                                                                    else
                                                                        {5607}let pkSess_4886: bitstring = fail-any in
                                                                        {5608}in(c, =GetEndpointRequest);
                                                                        {5609}new SPs_4887: bitstring;
                                                                        {5610}new UP_4888: bitstring;
                                                                        {5611}out(c, (SPs_4887,Sign,UP_4888,pkSess_4886))
                                                            )
                                                            else
                                                                {5612}let pkSess_4889: bitstring = fail-any in
                                                                {5613}in(c, =GetEndpointRequest);
                                                                {5614}new SPs_4890: bitstring;
                                                                {5615}new UP_4891: bitstring;
                                                                {5616}out(c, (SPs_4890,Sign,UP_4891,pkSess_4889))
                                                    )
                                                    else
                                                        {5617}let pkSess_4892: bitstring = fail-any in
                                                        {5618}in(c, =GetEndpointRequest);
                                                        {5619}new SPs_4893: bitstring;
                                                        {5620}new UP_4894: bitstring;
                                                        {5621}out(c, (SPs_4893,Sign,UP_4894,pkSess_4892))
                                            )
                                            else
                                                {5622}let pkCli_4895: bitstring = fail-any in
                                                {5623}let v_4896: bool = (Sess_4247 = A) in
                                                (
                                                    {5624}if v_4896 then
                                                    (
                                                        {5625}let pkSess_4897: bitstring = pub(skA) in
                                                        {5626}in(c, =GetEndpointRequest);
                                                        {5627}new SPs_4898: bitstring;
                                                        {5628}new UP_4899: bitstring;
                                                        {5629}out(c, (SPs_4898,Sign,UP_4899,pkSess_4897))
                                                    )
                                                    else
                                                        {5630}let v_4900: bool = (Sess_4247 = B) in
                                                        (
                                                            {5631}if v_4900 then
                                                            (
                                                                {5632}let pkSess_4901: bitstring = pub(skB) in
                                                                {5633}in(c, =GetEndpointRequest);
                                                                {5634}new SPs_4902: bitstring;
                                                                {5635}new UP_4903: bitstring;
                                                                {5636}out(c, (SPs_4902,Sign,UP_4903,pkSess_4901))
                                                            )
                                                            else
                                                                {5637}let v_4904: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5638}if v_4904 then
                                                                    (
                                                                        {5639}let pkSess_4905: bitstring = pub(skC) in
                                                                        {5640}in(c, =GetEndpointRequest);
                                                                        {5641}new SPs_4906: bitstring;
                                                                        {5642}new UP_4907: bitstring;
                                                                        {5643}out(c, (SPs_4906,Sign,UP_4907,pkSess_4905))
                                                                    )
                                                                    else
                                                                        {5644}let pkSess_4908: bitstring = pub(skI) in
                                                                        {5645}in(c, =GetEndpointRequest);
                                                                        {5646}new SPs_4909: bitstring;
                                                                        {5647}new UP_4910: bitstring;
                                                                        {5648}out(c, (SPs_4909,Sign,UP_4910,pkSess_4908))
                                                                )
                                                                else
                                                                    {5649}let pkSess_4911: bitstring = fail-any in
                                                                    {5650}in(c, =GetEndpointRequest);
                                                                    {5651}new SPs_4912: bitstring;
                                                                    {5652}new UP_4913: bitstring;
                                                                    {5653}out(c, (SPs_4912,Sign,UP_4913,pkSess_4911))
                                                        )
                                                        else
                                                            {5654}let pkSess_4914: bitstring = fail-any in
                                                            {5655}in(c, =GetEndpointRequest);
                                                            {5656}new SPs_4915: bitstring;
                                                            {5657}new UP_4916: bitstring;
                                                            {5658}out(c, (SPs_4915,Sign,UP_4916,pkSess_4914))
                                                )
                                                else
                                                    {5659}let pkSess_4917: bitstring = fail-any in
                                                    {5660}in(c, =GetEndpointRequest);
                                                    {5661}new SPs_4918: bitstring;
                                                    {5662}new UP_4919: bitstring;
                                                    {5663}out(c, (SPs_4918,Sign,UP_4919,pkSess_4917))
                                    )
                                    else
                                        {5664}let pkCli_4920: bitstring = fail-any in
                                        {5665}let v_4921: bool = (Sess_4247 = A) in
                                        (
                                            {5666}if v_4921 then
                                            (
                                                {5667}let pkSess_4922: bitstring = pub(skA) in
                                                {5668}in(c, =GetEndpointRequest);
                                                {5669}new SPs_4923: bitstring;
                                                {5670}new UP_4924: bitstring;
                                                {5671}out(c, (SPs_4923,Sign,UP_4924,pkSess_4922))
                                            )
                                            else
                                                {5672}let v_4925: bool = (Sess_4247 = B) in
                                                (
                                                    {5673}if v_4925 then
                                                    (
                                                        {5674}let pkSess_4926: bitstring = pub(skB) in
                                                        {5675}in(c, =GetEndpointRequest);
                                                        {5676}new SPs_4927: bitstring;
                                                        {5677}new UP_4928: bitstring;
                                                        {5678}out(c, (SPs_4927,Sign,UP_4928,pkSess_4926))
                                                    )
                                                    else
                                                        {5679}let v_4929: bool = (Sess_4247 = C) in
                                                        (
                                                            {5680}if v_4929 then
                                                            (
                                                                {5681}let pkSess_4930: bitstring = pub(skC) in
                                                                {5682}in(c, =GetEndpointRequest);
                                                                {5683}new SPs_4931: bitstring;
                                                                {5684}new UP_4932: bitstring;
                                                                {5685}out(c, (SPs_4931,Sign,UP_4932,pkSess_4930))
                                                            )
                                                            else
                                                                {5686}let pkSess_4933: bitstring = pub(skI) in
                                                                {5687}in(c, =GetEndpointRequest);
                                                                {5688}new SPs_4934: bitstring;
                                                                {5689}new UP_4935: bitstring;
                                                                {5690}out(c, (SPs_4934,Sign,UP_4935,pkSess_4933))
                                                        )
                                                        else
                                                            {5691}let pkSess_4936: bitstring = fail-any in
                                                            {5692}in(c, =GetEndpointRequest);
                                                            {5693}new SPs_4937: bitstring;
                                                            {5694}new UP_4938: bitstring;
                                                            {5695}out(c, (SPs_4937,Sign,UP_4938,pkSess_4936))
                                                )
                                                else
                                                    {5696}let pkSess_4939: bitstring = fail-any in
                                                    {5697}in(c, =GetEndpointRequest);
                                                    {5698}new SPs_4940: bitstring;
                                                    {5699}new UP_4941: bitstring;
                                                    {5700}out(c, (SPs_4940,Sign,UP_4941,pkSess_4939))
                                        )
                                        else
                                            {5701}let pkSess_4942: bitstring = fail-any in
                                            {5702}in(c, =GetEndpointRequest);
                                            {5703}new SPs_4943: bitstring;
                                            {5704}new UP_4944: bitstring;
                                            {5705}out(c, (SPs_4943,Sign,UP_4944,pkSess_4942))
                            )
                            else
                                {5706}let pkCli_4945: bitstring = fail-any in
                                {5707}let v_4946: bool = (Sess_4247 = A) in
                                (
                                    {5708}if v_4946 then
                                    (
                                        {5709}let pkSess_4947: bitstring = pub(skA) in
                                        {5710}in(c, =GetEndpointRequest);
                                        {5711}new SPs_4948: bitstring;
                                        {5712}new UP_4949: bitstring;
                                        {5713}out(c, (SPs_4948,Sign,UP_4949,pkSess_4947))
                                    )
                                    else
                                        {5714}let v_4950: bool = (Sess_4247 = B) in
                                        (
                                            {5715}if v_4950 then
                                            (
                                                {5716}let pkSess_4951: bitstring = pub(skB) in
                                                {5717}in(c, =GetEndpointRequest);
                                                {5718}new SPs_4952: bitstring;
                                                {5719}new UP_4953: bitstring;
                                                {5720}out(c, (SPs_4952,Sign,UP_4953,pkSess_4951))
                                            )
                                            else
                                                {5721}let v_4954: bool = (Sess_4247 = C) in
                                                (
                                                    {5722}if v_4954 then
                                                    (
                                                        {5723}let pkSess_4955: bitstring = pub(skC) in
                                                        {5724}in(c, =GetEndpointRequest);
                                                        {5725}new SPs_4956: bitstring;
                                                        {5726}new UP_4957: bitstring;
                                                        {5727}out(c, (SPs_4956,Sign,UP_4957,pkSess_4955))
                                                    )
                                                    else
                                                        {5728}let pkSess_4958: bitstring = pub(skI) in
                                                        {5729}in(c, =GetEndpointRequest);
                                                        {5730}new SPs_4959: bitstring;
                                                        {5731}new UP_4960: bitstring;
                                                        {5732}out(c, (SPs_4959,Sign,UP_4960,pkSess_4958))
                                                )
                                                else
                                                    {5733}let pkSess_4961: bitstring = fail-any in
                                                    {5734}in(c, =GetEndpointRequest);
                                                    {5735}new SPs_4962: bitstring;
                                                    {5736}new UP_4963: bitstring;
                                                    {5737}out(c, (SPs_4962,Sign,UP_4963,pkSess_4961))
                                        )
                                        else
                                            {5738}let pkSess_4964: bitstring = fail-any in
                                            {5739}in(c, =GetEndpointRequest);
                                            {5740}new SPs_4965: bitstring;
                                            {5741}new UP_4966: bitstring;
                                            {5742}out(c, (SPs_4965,Sign,UP_4966,pkSess_4964))
                                )
                                else
                                    {5743}let pkSess_4967: bitstring = fail-any in
                                    {5744}in(c, =GetEndpointRequest);
                                    {5745}new SPs_4968: bitstring;
                                    {5746}new UP_4969: bitstring;
                                    {5747}out(c, (SPs_4968,Sign,UP_4969,pkSess_4967))
                    )
                    else
                        {5748}let skDisco_4970: bitstring = fail-any in
                        {5749}let pkDisco_4971: bitstring = pub(skDisco_4970) in
                        {5750}let v_4972: bool = (Cli_4245 = A) in
                        (
                            {5751}if v_4972 then
                            (
                                {5752}let pkCli_4973: bitstring = pub(skA) in
                                {5753}let v_4974: bool = (Sess_4247 = A) in
                                (
                                    {5754}if v_4974 then
                                    (
                                        {5755}let pkSess_4975: bitstring = pub(skA) in
                                        {5756}in(c, =GetEndpointRequest);
                                        {5757}new SPs_4976: bitstring;
                                        {5758}new UP_4977: bitstring;
                                        {5759}out(c, (SPs_4976,Sign,UP_4977,pkSess_4975))
                                    )
                                    else
                                        {5760}let v_4978: bool = (Sess_4247 = B) in
                                        (
                                            {5761}if v_4978 then
                                            (
                                                {5762}let pkSess_4979: bitstring = pub(skB) in
                                                {5763}in(c, =GetEndpointRequest);
                                                {5764}new SPs_4980: bitstring;
                                                {5765}new UP_4981: bitstring;
                                                {5766}out(c, (SPs_4980,Sign,UP_4981,pkSess_4979))
                                            )
                                            else
                                                {5767}let v_4982: bool = (Sess_4247 = C) in
                                                (
                                                    {5768}if v_4982 then
                                                    (
                                                        {5769}let pkSess_4983: bitstring = pub(skC) in
                                                        {5770}in(c, =GetEndpointRequest);
                                                        {5771}new SPs_4984: bitstring;
                                                        {5772}new UP_4985: bitstring;
                                                        {5773}out(c, (SPs_4984,Sign,UP_4985,pkSess_4983))
                                                    )
                                                    else
                                                        {5774}let pkSess_4986: bitstring = pub(skI) in
                                                        {5775}in(c, =GetEndpointRequest);
                                                        {5776}new SPs_4987: bitstring;
                                                        {5777}new UP_4988: bitstring;
                                                        {5778}out(c, (SPs_4987,Sign,UP_4988,pkSess_4986))
                                                )
                                                else
                                                    {5779}let pkSess_4989: bitstring = fail-any in
                                                    {5780}in(c, =GetEndpointRequest);
                                                    {5781}new SPs_4990: bitstring;
                                                    {5782}new UP_4991: bitstring;
                                                    {5783}out(c, (SPs_4990,Sign,UP_4991,pkSess_4989))
                                        )
                                        else
                                            {5784}let pkSess_4992: bitstring = fail-any in
                                            {5785}in(c, =GetEndpointRequest);
                                            {5786}new SPs_4993: bitstring;
                                            {5787}new UP_4994: bitstring;
                                            {5788}out(c, (SPs_4993,Sign,UP_4994,pkSess_4992))
                                )
                                else
                                    {5789}let pkSess_4995: bitstring = fail-any in
                                    {5790}in(c, =GetEndpointRequest);
                                    {5791}new SPs_4996: bitstring;
                                    {5792}new UP_4997: bitstring;
                                    {5793}out(c, (SPs_4996,Sign,UP_4997,pkSess_4995))
                            )
                            else
                                {5794}let v_4998: bool = (Cli_4245 = B) in
                                (
                                    {5795}if v_4998 then
                                    (
                                        {5796}let pkCli_4999: bitstring = pub(skB) in
                                        {5797}let v_5000: bool = (Sess_4247 = A) in
                                        (
                                            {5798}if v_5000 then
                                            (
                                                {5799}let pkSess_5001: bitstring = pub(skA) in
                                                {5800}in(c, =GetEndpointRequest);
                                                {5801}new SPs_5002: bitstring;
                                                {5802}new UP_5003: bitstring;
                                                {5803}out(c, (SPs_5002,Sign,UP_5003,pkSess_5001))
                                            )
                                            else
                                                {5804}let v_5004: bool = (Sess_4247 = B) in
                                                (
                                                    {5805}if v_5004 then
                                                    (
                                                        {5806}let pkSess_5005: bitstring = pub(skB) in
                                                        {5807}in(c, =GetEndpointRequest);
                                                        {5808}new SPs_5006: bitstring;
                                                        {5809}new UP_5007: bitstring;
                                                        {5810}out(c, (SPs_5006,Sign,UP_5007,pkSess_5005))
                                                    )
                                                    else
                                                        {5811}let v_5008: bool = (Sess_4247 = C) in
                                                        (
                                                            {5812}if v_5008 then
                                                            (
                                                                {5813}let pkSess_5009: bitstring = pub(skC) in
                                                                {5814}in(c, =GetEndpointRequest);
                                                                {5815}new SPs_5010: bitstring;
                                                                {5816}new UP_5011: bitstring;
                                                                {5817}out(c, (SPs_5010,Sign,UP_5011,pkSess_5009))
                                                            )
                                                            else
                                                                {5818}let pkSess_5012: bitstring = pub(skI) in
                                                                {5819}in(c, =GetEndpointRequest);
                                                                {5820}new SPs_5013: bitstring;
                                                                {5821}new UP_5014: bitstring;
                                                                {5822}out(c, (SPs_5013,Sign,UP_5014,pkSess_5012))
                                                        )
                                                        else
                                                            {5823}let pkSess_5015: bitstring = fail-any in
                                                            {5824}in(c, =GetEndpointRequest);
                                                            {5825}new SPs_5016: bitstring;
                                                            {5826}new UP_5017: bitstring;
                                                            {5827}out(c, (SPs_5016,Sign,UP_5017,pkSess_5015))
                                                )
                                                else
                                                    {5828}let pkSess_5018: bitstring = fail-any in
                                                    {5829}in(c, =GetEndpointRequest);
                                                    {5830}new SPs_5019: bitstring;
                                                    {5831}new UP_5020: bitstring;
                                                    {5832}out(c, (SPs_5019,Sign,UP_5020,pkSess_5018))
                                        )
                                        else
                                            {5833}let pkSess_5021: bitstring = fail-any in
                                            {5834}in(c, =GetEndpointRequest);
                                            {5835}new SPs_5022: bitstring;
                                            {5836}new UP_5023: bitstring;
                                            {5837}out(c, (SPs_5022,Sign,UP_5023,pkSess_5021))
                                    )
                                    else
                                        {5838}let v_5024: bool = (Cli_4245 = C) in
                                        (
                                            {5839}if v_5024 then
                                            (
                                                {5840}let pkCli_5025: bitstring = pub(skC) in
                                                {5841}let v_5026: bool = (Sess_4247 = A) in
                                                (
                                                    {5842}if v_5026 then
                                                    (
                                                        {5843}let pkSess_5027: bitstring = pub(skA) in
                                                        {5844}in(c, =GetEndpointRequest);
                                                        {5845}new SPs_5028: bitstring;
                                                        {5846}new UP_5029: bitstring;
                                                        {5847}out(c, (SPs_5028,Sign,UP_5029,pkSess_5027))
                                                    )
                                                    else
                                                        {5848}let v_5030: bool = (Sess_4247 = B) in
                                                        (
                                                            {5849}if v_5030 then
                                                            (
                                                                {5850}let pkSess_5031: bitstring = pub(skB) in
                                                                {5851}in(c, =GetEndpointRequest);
                                                                {5852}new SPs_5032: bitstring;
                                                                {5853}new UP_5033: bitstring;
                                                                {5854}out(c, (SPs_5032,Sign,UP_5033,pkSess_5031))
                                                            )
                                                            else
                                                                {5855}let v_5034: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5856}if v_5034 then
                                                                    (
                                                                        {5857}let pkSess_5035: bitstring = pub(skC) in
                                                                        {5858}in(c, =GetEndpointRequest);
                                                                        {5859}new SPs_5036: bitstring;
                                                                        {5860}new UP_5037: bitstring;
                                                                        {5861}out(c, (SPs_5036,Sign,UP_5037,pkSess_5035))
                                                                    )
                                                                    else
                                                                        {5862}let pkSess_5038: bitstring = pub(skI) in
                                                                        {5863}in(c, =GetEndpointRequest);
                                                                        {5864}new SPs_5039: bitstring;
                                                                        {5865}new UP_5040: bitstring;
                                                                        {5866}out(c, (SPs_5039,Sign,UP_5040,pkSess_5038))
                                                                )
                                                                else
                                                                    {5867}let pkSess_5041: bitstring = fail-any in
                                                                    {5868}in(c, =GetEndpointRequest);
                                                                    {5869}new SPs_5042: bitstring;
                                                                    {5870}new UP_5043: bitstring;
                                                                    {5871}out(c, (SPs_5042,Sign,UP_5043,pkSess_5041))
                                                        )
                                                        else
                                                            {5872}let pkSess_5044: bitstring = fail-any in
                                                            {5873}in(c, =GetEndpointRequest);
                                                            {5874}new SPs_5045: bitstring;
                                                            {5875}new UP_5046: bitstring;
                                                            {5876}out(c, (SPs_5045,Sign,UP_5046,pkSess_5044))
                                                )
                                                else
                                                    {5877}let pkSess_5047: bitstring = fail-any in
                                                    {5878}in(c, =GetEndpointRequest);
                                                    {5879}new SPs_5048: bitstring;
                                                    {5880}new UP_5049: bitstring;
                                                    {5881}out(c, (SPs_5048,Sign,UP_5049,pkSess_5047))
                                            )
                                            else
                                                {5882}let pkCli_5050: bitstring = pub(skI) in
                                                {5883}let v_5051: bool = (Sess_4247 = A) in
                                                (
                                                    {5884}if v_5051 then
                                                    (
                                                        {5885}let pkSess_5052: bitstring = pub(skA) in
                                                        {5886}in(c, =GetEndpointRequest);
                                                        {5887}new SPs_5053: bitstring;
                                                        {5888}new UP_5054: bitstring;
                                                        {5889}out(c, (SPs_5053,Sign,UP_5054,pkSess_5052))
                                                    )
                                                    else
                                                        {5890}let v_5055: bool = (Sess_4247 = B) in
                                                        (
                                                            {5891}if v_5055 then
                                                            (
                                                                {5892}let pkSess_5056: bitstring = pub(skB) in
                                                                {5893}in(c, =GetEndpointRequest);
                                                                {5894}new SPs_5057: bitstring;
                                                                {5895}new UP_5058: bitstring;
                                                                {5896}out(c, (SPs_5057,Sign,UP_5058,pkSess_5056))
                                                            )
                                                            else
                                                                {5897}let v_5059: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5898}if v_5059 then
                                                                    (
                                                                        {5899}let pkSess_5060: bitstring = pub(skC) in
                                                                        {5900}in(c, =GetEndpointRequest);
                                                                        {5901}new SPs_5061: bitstring;
                                                                        {5902}new UP_5062: bitstring;
                                                                        {5903}out(c, (SPs_5061,Sign,UP_5062,pkSess_5060))
                                                                    )
                                                                    else
                                                                        {5904}let pkSess_5063: bitstring = pub(skI) in
                                                                        {5905}in(c, =GetEndpointRequest);
                                                                        {5906}new SPs_5064: bitstring;
                                                                        {5907}new UP_5065: bitstring;
                                                                        {5908}out(c, (SPs_5064,Sign,UP_5065,pkSess_5063))
                                                                )
                                                                else
                                                                    {5909}let pkSess_5066: bitstring = fail-any in
                                                                    {5910}in(c, =GetEndpointRequest);
                                                                    {5911}new SPs_5067: bitstring;
                                                                    {5912}new UP_5068: bitstring;
                                                                    {5913}out(c, (SPs_5067,Sign,UP_5068,pkSess_5066))
                                                        )
                                                        else
                                                            {5914}let pkSess_5069: bitstring = fail-any in
                                                            {5915}in(c, =GetEndpointRequest);
                                                            {5916}new SPs_5070: bitstring;
                                                            {5917}new UP_5071: bitstring;
                                                            {5918}out(c, (SPs_5070,Sign,UP_5071,pkSess_5069))
                                                )
                                                else
                                                    {5919}let pkSess_5072: bitstring = fail-any in
                                                    {5920}in(c, =GetEndpointRequest);
                                                    {5921}new SPs_5073: bitstring;
                                                    {5922}new UP_5074: bitstring;
                                                    {5923}out(c, (SPs_5073,Sign,UP_5074,pkSess_5072))
                                        )
                                        else
                                            {5924}let pkCli_5075: bitstring = fail-any in
                                            {5925}let v_5076: bool = (Sess_4247 = A) in
                                            (
                                                {5926}if v_5076 then
                                                (
                                                    {5927}let pkSess_5077: bitstring = pub(skA) in
                                                    {5928}in(c, =GetEndpointRequest);
                                                    {5929}new SPs_5078: bitstring;
                                                    {5930}new UP_5079: bitstring;
                                                    {5931}out(c, (SPs_5078,Sign,UP_5079,pkSess_5077))
                                                )
                                                else
                                                    {5932}let v_5080: bool = (Sess_4247 = B) in
                                                    (
                                                        {5933}if v_5080 then
                                                        (
                                                            {5934}let pkSess_5081: bitstring = pub(skB) in
                                                            {5935}in(c, =GetEndpointRequest);
                                                            {5936}new SPs_5082: bitstring;
                                                            {5937}new UP_5083: bitstring;
                                                            {5938}out(c, (SPs_5082,Sign,UP_5083,pkSess_5081))
                                                        )
                                                        else
                                                            {5939}let v_5084: bool = (Sess_4247 = C) in
                                                            (
                                                                {5940}if v_5084 then
                                                                (
                                                                    {5941}let pkSess_5085: bitstring = pub(skC) in
                                                                    {5942}in(c, =GetEndpointRequest);
                                                                    {5943}new SPs_5086: bitstring;
                                                                    {5944}new UP_5087: bitstring;
                                                                    {5945}out(c, (SPs_5086,Sign,UP_5087,pkSess_5085))
                                                                )
                                                                else
                                                                    {5946}let pkSess_5088: bitstring = pub(skI) in
                                                                    {5947}in(c, =GetEndpointRequest);
                                                                    {5948}new SPs_5089: bitstring;
                                                                    {5949}new UP_5090: bitstring;
                                                                    {5950}out(c, (SPs_5089,Sign,UP_5090,pkSess_5088))
                                                            )
                                                            else
                                                                {5951}let pkSess_5091: bitstring = fail-any in
                                                                {5952}in(c, =GetEndpointRequest);
                                                                {5953}new SPs_5092: bitstring;
                                                                {5954}new UP_5093: bitstring;
                                                                {5955}out(c, (SPs_5092,Sign,UP_5093,pkSess_5091))
                                                    )
                                                    else
                                                        {5956}let pkSess_5094: bitstring = fail-any in
                                                        {5957}in(c, =GetEndpointRequest);
                                                        {5958}new SPs_5095: bitstring;
                                                        {5959}new UP_5096: bitstring;
                                                        {5960}out(c, (SPs_5095,Sign,UP_5096,pkSess_5094))
                                            )
                                            else
                                                {5961}let pkSess_5097: bitstring = fail-any in
                                                {5962}in(c, =GetEndpointRequest);
                                                {5963}new SPs_5098: bitstring;
                                                {5964}new UP_5099: bitstring;
                                                {5965}out(c, (SPs_5098,Sign,UP_5099,pkSess_5097))
                                )
                                else
                                    {5966}let pkCli_5100: bitstring = fail-any in
                                    {5967}let v_5101: bool = (Sess_4247 = A) in
                                    (
                                        {5968}if v_5101 then
                                        (
                                            {5969}let pkSess_5102: bitstring = pub(skA) in
                                            {5970}in(c, =GetEndpointRequest);
                                            {5971}new SPs_5103: bitstring;
                                            {5972}new UP_5104: bitstring;
                                            {5973}out(c, (SPs_5103,Sign,UP_5104,pkSess_5102))
                                        )
                                        else
                                            {5974}let v_5105: bool = (Sess_4247 = B) in
                                            (
                                                {5975}if v_5105 then
                                                (
                                                    {5976}let pkSess_5106: bitstring = pub(skB) in
                                                    {5977}in(c, =GetEndpointRequest);
                                                    {5978}new SPs_5107: bitstring;
                                                    {5979}new UP_5108: bitstring;
                                                    {5980}out(c, (SPs_5107,Sign,UP_5108,pkSess_5106))
                                                )
                                                else
                                                    {5981}let v_5109: bool = (Sess_4247 = C) in
                                                    (
                                                        {5982}if v_5109 then
                                                        (
                                                            {5983}let pkSess_5110: bitstring = pub(skC) in
                                                            {5984}in(c, =GetEndpointRequest);
                                                            {5985}new SPs_5111: bitstring;
                                                            {5986}new UP_5112: bitstring;
                                                            {5987}out(c, (SPs_5111,Sign,UP_5112,pkSess_5110))
                                                        )
                                                        else
                                                            {5988}let pkSess_5113: bitstring = pub(skI) in
                                                            {5989}in(c, =GetEndpointRequest);
                                                            {5990}new SPs_5114: bitstring;
                                                            {5991}new UP_5115: bitstring;
                                                            {5992}out(c, (SPs_5114,Sign,UP_5115,pkSess_5113))
                                                    )
                                                    else
                                                        {5993}let pkSess_5116: bitstring = fail-any in
                                                        {5994}in(c, =GetEndpointRequest);
                                                        {5995}new SPs_5117: bitstring;
                                                        {5996}new UP_5118: bitstring;
                                                        {5997}out(c, (SPs_5117,Sign,UP_5118,pkSess_5116))
                                            )
                                            else
                                                {5998}let pkSess_5119: bitstring = fail-any in
                                                {5999}in(c, =GetEndpointRequest);
                                                {6000}new SPs_5120: bitstring;
                                                {6001}new UP_5121: bitstring;
                                                {6002}out(c, (SPs_5120,Sign,UP_5121,pkSess_5119))
                                    )
                                    else
                                        {6003}let pkSess_5122: bitstring = fail-any in
                                        {6004}in(c, =GetEndpointRequest);
                                        {6005}new SPs_5123: bitstring;
                                        {6006}new UP_5124: bitstring;
                                        {6007}out(c, (SPs_5123,Sign,UP_5124,pkSess_5122))
                        )
                        else
                            {6008}let pkCli_5125: bitstring = fail-any in
                            {6009}let v_5126: bool = (Sess_4247 = A) in
                            (
                                {6010}if v_5126 then
                                (
                                    {6011}let pkSess_5127: bitstring = pub(skA) in
                                    {6012}in(c, =GetEndpointRequest);
                                    {6013}new SPs_5128: bitstring;
                                    {6014}new UP_5129: bitstring;
                                    {6015}out(c, (SPs_5128,Sign,UP_5129,pkSess_5127))
                                )
                                else
                                    {6016}let v_5130: bool = (Sess_4247 = B) in
                                    (
                                        {6017}if v_5130 then
                                        (
                                            {6018}let pkSess_5131: bitstring = pub(skB) in
                                            {6019}in(c, =GetEndpointRequest);
                                            {6020}new SPs_5132: bitstring;
                                            {6021}new UP_5133: bitstring;
                                            {6022}out(c, (SPs_5132,Sign,UP_5133,pkSess_5131))
                                        )
                                        else
                                            {6023}let v_5134: bool = (Sess_4247 = C) in
                                            (
                                                {6024}if v_5134 then
                                                (
                                                    {6025}let pkSess_5135: bitstring = pub(skC) in
                                                    {6026}in(c, =GetEndpointRequest);
                                                    {6027}new SPs_5136: bitstring;
                                                    {6028}new UP_5137: bitstring;
                                                    {6029}out(c, (SPs_5136,Sign,UP_5137,pkSess_5135))
                                                )
                                                else
                                                    {6030}let pkSess_5138: bitstring = pub(skI) in
                                                    {6031}in(c, =GetEndpointRequest);
                                                    {6032}new SPs_5139: bitstring;
                                                    {6033}new UP_5140: bitstring;
                                                    {6034}out(c, (SPs_5139,Sign,UP_5140,pkSess_5138))
                                            )
                                            else
                                                {6035}let pkSess_5141: bitstring = fail-any in
                                                {6036}in(c, =GetEndpointRequest);
                                                {6037}new SPs_5142: bitstring;
                                                {6038}new UP_5143: bitstring;
                                                {6039}out(c, (SPs_5142,Sign,UP_5143,pkSess_5141))
                                    )
                                    else
                                        {6040}let pkSess_5144: bitstring = fail-any in
                                        {6041}in(c, =GetEndpointRequest);
                                        {6042}new SPs_5145: bitstring;
                                        {6043}new UP_5146: bitstring;
                                        {6044}out(c, (SPs_5145,Sign,UP_5146,pkSess_5144))
                            )
                            else
                                {6045}let pkSess_5147: bitstring = fail-any in
                                {6046}in(c, =GetEndpointRequest);
                                {6047}new SPs_5148: bitstring;
                                {6048}new UP_5149: bitstring;
                                {6049}out(c, (SPs_5148,Sign,UP_5149,pkSess_5147))
            )
            else
                {6050}let skDisco_5150: bitstring = fail-any in
                {6051}let pkDisco_5151: bitstring = pub(skDisco_5150) in
                {6052}let v_5152: bool = (Cli_4245 = A) in
                (
                    {6053}if v_5152 then
                    (
                        {6054}let pkCli_5153: bitstring = pub(skA) in
                        {6055}let v_5154: bool = (Sess_4247 = A) in
                        (
                            {6056}if v_5154 then
                            (
                                {6057}let pkSess_5155: bitstring = pub(skA) in
                                {6058}in(c, =GetEndpointRequest);
                                {6059}new SPs_5156: bitstring;
                                {6060}new UP_5157: bitstring;
                                {6061}out(c, (SPs_5156,Sign,UP_5157,pkSess_5155))
                            )
                            else
                                {6062}let v_5158: bool = (Sess_4247 = B) in
                                (
                                    {6063}if v_5158 then
                                    (
                                        {6064}let pkSess_5159: bitstring = pub(skB) in
                                        {6065}in(c, =GetEndpointRequest);
                                        {6066}new SPs_5160: bitstring;
                                        {6067}new UP_5161: bitstring;
                                        {6068}out(c, (SPs_5160,Sign,UP_5161,pkSess_5159))
                                    )
                                    else
                                        {6069}let v_5162: bool = (Sess_4247 = C) in
                                        (
                                            {6070}if v_5162 then
                                            (
                                                {6071}let pkSess_5163: bitstring = pub(skC) in
                                                {6072}in(c, =GetEndpointRequest);
                                                {6073}new SPs_5164: bitstring;
                                                {6074}new UP_5165: bitstring;
                                                {6075}out(c, (SPs_5164,Sign,UP_5165,pkSess_5163))
                                            )
                                            else
                                                {6076}let pkSess_5166: bitstring = pub(skI) in
                                                {6077}in(c, =GetEndpointRequest);
                                                {6078}new SPs_5167: bitstring;
                                                {6079}new UP_5168: bitstring;
                                                {6080}out(c, (SPs_5167,Sign,UP_5168,pkSess_5166))
                                        )
                                        else
                                            {6081}let pkSess_5169: bitstring = fail-any in
                                            {6082}in(c, =GetEndpointRequest);
                                            {6083}new SPs_5170: bitstring;
                                            {6084}new UP_5171: bitstring;
                                            {6085}out(c, (SPs_5170,Sign,UP_5171,pkSess_5169))
                                )
                                else
                                    {6086}let pkSess_5172: bitstring = fail-any in
                                    {6087}in(c, =GetEndpointRequest);
                                    {6088}new SPs_5173: bitstring;
                                    {6089}new UP_5174: bitstring;
                                    {6090}out(c, (SPs_5173,Sign,UP_5174,pkSess_5172))
                        )
                        else
                            {6091}let pkSess_5175: bitstring = fail-any in
                            {6092}in(c, =GetEndpointRequest);
                            {6093}new SPs_5176: bitstring;
                            {6094}new UP_5177: bitstring;
                            {6095}out(c, (SPs_5176,Sign,UP_5177,pkSess_5175))
                    )
                    else
                        {6096}let v_5178: bool = (Cli_4245 = B) in
                        (
                            {6097}if v_5178 then
                            (
                                {6098}let pkCli_5179: bitstring = pub(skB) in
                                {6099}let v_5180: bool = (Sess_4247 = A) in
                                (
                                    {6100}if v_5180 then
                                    (
                                        {6101}let pkSess_5181: bitstring = pub(skA) in
                                        {6102}in(c, =GetEndpointRequest);
                                        {6103}new SPs_5182: bitstring;
                                        {6104}new UP_5183: bitstring;
                                        {6105}out(c, (SPs_5182,Sign,UP_5183,pkSess_5181))
                                    )
                                    else
                                        {6106}let v_5184: bool = (Sess_4247 = B) in
                                        (
                                            {6107}if v_5184 then
                                            (
                                                {6108}let pkSess_5185: bitstring = pub(skB) in
                                                {6109}in(c, =GetEndpointRequest);
                                                {6110}new SPs_5186: bitstring;
                                                {6111}new UP_5187: bitstring;
                                                {6112}out(c, (SPs_5186,Sign,UP_5187,pkSess_5185))
                                            )
                                            else
                                                {6113}let v_5188: bool = (Sess_4247 = C) in
                                                (
                                                    {6114}if v_5188 then
                                                    (
                                                        {6115}let pkSess_5189: bitstring = pub(skC) in
                                                        {6116}in(c, =GetEndpointRequest);
                                                        {6117}new SPs_5190: bitstring;
                                                        {6118}new UP_5191: bitstring;
                                                        {6119}out(c, (SPs_5190,Sign,UP_5191,pkSess_5189))
                                                    )
                                                    else
                                                        {6120}let pkSess_5192: bitstring = pub(skI) in
                                                        {6121}in(c, =GetEndpointRequest);
                                                        {6122}new SPs_5193: bitstring;
                                                        {6123}new UP_5194: bitstring;
                                                        {6124}out(c, (SPs_5193,Sign,UP_5194,pkSess_5192))
                                                )
                                                else
                                                    {6125}let pkSess_5195: bitstring = fail-any in
                                                    {6126}in(c, =GetEndpointRequest);
                                                    {6127}new SPs_5196: bitstring;
                                                    {6128}new UP_5197: bitstring;
                                                    {6129}out(c, (SPs_5196,Sign,UP_5197,pkSess_5195))
                                        )
                                        else
                                            {6130}let pkSess_5198: bitstring = fail-any in
                                            {6131}in(c, =GetEndpointRequest);
                                            {6132}new SPs_5199: bitstring;
                                            {6133}new UP_5200: bitstring;
                                            {6134}out(c, (SPs_5199,Sign,UP_5200,pkSess_5198))
                                )
                                else
                                    {6135}let pkSess_5201: bitstring = fail-any in
                                    {6136}in(c, =GetEndpointRequest);
                                    {6137}new SPs_5202: bitstring;
                                    {6138}new UP_5203: bitstring;
                                    {6139}out(c, (SPs_5202,Sign,UP_5203,pkSess_5201))
                            )
                            else
                                {6140}let v_5204: bool = (Cli_4245 = C) in
                                (
                                    {6141}if v_5204 then
                                    (
                                        {6142}let pkCli_5205: bitstring = pub(skC) in
                                        {6143}let v_5206: bool = (Sess_4247 = A) in
                                        (
                                            {6144}if v_5206 then
                                            (
                                                {6145}let pkSess_5207: bitstring = pub(skA) in
                                                {6146}in(c, =GetEndpointRequest);
                                                {6147}new SPs_5208: bitstring;
                                                {6148}new UP_5209: bitstring;
                                                {6149}out(c, (SPs_5208,Sign,UP_5209,pkSess_5207))
                                            )
                                            else
                                                {6150}let v_5210: bool = (Sess_4247 = B) in
                                                (
                                                    {6151}if v_5210 then
                                                    (
                                                        {6152}let pkSess_5211: bitstring = pub(skB) in
                                                        {6153}in(c, =GetEndpointRequest);
                                                        {6154}new SPs_5212: bitstring;
                                                        {6155}new UP_5213: bitstring;
                                                        {6156}out(c, (SPs_5212,Sign,UP_5213,pkSess_5211))
                                                    )
                                                    else
                                                        {6157}let v_5214: bool = (Sess_4247 = C) in
                                                        (
                                                            {6158}if v_5214 then
                                                            (
                                                                {6159}let pkSess_5215: bitstring = pub(skC) in
                                                                {6160}in(c, =GetEndpointRequest);
                                                                {6161}new SPs_5216: bitstring;
                                                                {6162}new UP_5217: bitstring;
                                                                {6163}out(c, (SPs_5216,Sign,UP_5217,pkSess_5215))
                                                            )
                                                            else
                                                                {6164}let pkSess_5218: bitstring = pub(skI) in
                                                                {6165}in(c, =GetEndpointRequest);
                                                                {6166}new SPs_5219: bitstring;
                                                                {6167}new UP_5220: bitstring;
                                                                {6168}out(c, (SPs_5219,Sign,UP_5220,pkSess_5218))
                                                        )
                                                        else
                                                            {6169}let pkSess_5221: bitstring = fail-any in
                                                            {6170}in(c, =GetEndpointRequest);
                                                            {6171}new SPs_5222: bitstring;
                                                            {6172}new UP_5223: bitstring;
                                                            {6173}out(c, (SPs_5222,Sign,UP_5223,pkSess_5221))
                                                )
                                                else
                                                    {6174}let pkSess_5224: bitstring = fail-any in
                                                    {6175}in(c, =GetEndpointRequest);
                                                    {6176}new SPs_5225: bitstring;
                                                    {6177}new UP_5226: bitstring;
                                                    {6178}out(c, (SPs_5225,Sign,UP_5226,pkSess_5224))
                                        )
                                        else
                                            {6179}let pkSess_5227: bitstring = fail-any in
                                            {6180}in(c, =GetEndpointRequest);
                                            {6181}new SPs_5228: bitstring;
                                            {6182}new UP_5229: bitstring;
                                            {6183}out(c, (SPs_5228,Sign,UP_5229,pkSess_5227))
                                    )
                                    else
                                        {6184}let pkCli_5230: bitstring = pub(skI) in
                                        {6185}let v_5231: bool = (Sess_4247 = A) in
                                        (
                                            {6186}if v_5231 then
                                            (
                                                {6187}let pkSess_5232: bitstring = pub(skA) in
                                                {6188}in(c, =GetEndpointRequest);
                                                {6189}new SPs_5233: bitstring;
                                                {6190}new UP_5234: bitstring;
                                                {6191}out(c, (SPs_5233,Sign,UP_5234,pkSess_5232))
                                            )
                                            else
                                                {6192}let v_5235: bool = (Sess_4247 = B) in
                                                (
                                                    {6193}if v_5235 then
                                                    (
                                                        {6194}let pkSess_5236: bitstring = pub(skB) in
                                                        {6195}in(c, =GetEndpointRequest);
                                                        {6196}new SPs_5237: bitstring;
                                                        {6197}new UP_5238: bitstring;
                                                        {6198}out(c, (SPs_5237,Sign,UP_5238,pkSess_5236))
                                                    )
                                                    else
                                                        {6199}let v_5239: bool = (Sess_4247 = C) in
                                                        (
                                                            {6200}if v_5239 then
                                                            (
                                                                {6201}let pkSess_5240: bitstring = pub(skC) in
                                                                {6202}in(c, =GetEndpointRequest);
                                                                {6203}new SPs_5241: bitstring;
                                                                {6204}new UP_5242: bitstring;
                                                                {6205}out(c, (SPs_5241,Sign,UP_5242,pkSess_5240))
                                                            )
                                                            else
                                                                {6206}let pkSess_5243: bitstring = pub(skI) in
                                                                {6207}in(c, =GetEndpointRequest);
                                                                {6208}new SPs_5244: bitstring;
                                                                {6209}new UP_5245: bitstring;
                                                                {6210}out(c, (SPs_5244,Sign,UP_5245,pkSess_5243))
                                                        )
                                                        else
                                                            {6211}let pkSess_5246: bitstring = fail-any in
                                                            {6212}in(c, =GetEndpointRequest);
                                                            {6213}new SPs_5247: bitstring;
                                                            {6214}new UP_5248: bitstring;
                                                            {6215}out(c, (SPs_5247,Sign,UP_5248,pkSess_5246))
                                                )
                                                else
                                                    {6216}let pkSess_5249: bitstring = fail-any in
                                                    {6217}in(c, =GetEndpointRequest);
                                                    {6218}new SPs_5250: bitstring;
                                                    {6219}new UP_5251: bitstring;
                                                    {6220}out(c, (SPs_5250,Sign,UP_5251,pkSess_5249))
                                        )
                                        else
                                            {6221}let pkSess_5252: bitstring = fail-any in
                                            {6222}in(c, =GetEndpointRequest);
                                            {6223}new SPs_5253: bitstring;
                                            {6224}new UP_5254: bitstring;
                                            {6225}out(c, (SPs_5253,Sign,UP_5254,pkSess_5252))
                                )
                                else
                                    {6226}let pkCli_5255: bitstring = fail-any in
                                    {6227}let v_5256: bool = (Sess_4247 = A) in
                                    (
                                        {6228}if v_5256 then
                                        (
                                            {6229}let pkSess_5257: bitstring = pub(skA) in
                                            {6230}in(c, =GetEndpointRequest);
                                            {6231}new SPs_5258: bitstring;
                                            {6232}new UP_5259: bitstring;
                                            {6233}out(c, (SPs_5258,Sign,UP_5259,pkSess_5257))
                                        )
                                        else
                                            {6234}let v_5260: bool = (Sess_4247 = B) in
                                            (
                                                {6235}if v_5260 then
                                                (
                                                    {6236}let pkSess_5261: bitstring = pub(skB) in
                                                    {6237}in(c, =GetEndpointRequest);
                                                    {6238}new SPs_5262: bitstring;
                                                    {6239}new UP_5263: bitstring;
                                                    {6240}out(c, (SPs_5262,Sign,UP_5263,pkSess_5261))
                                                )
                                                else
                                                    {6241}let v_5264: bool = (Sess_4247 = C) in
                                                    (
                                                        {6242}if v_5264 then
                                                        (
                                                            {6243}let pkSess_5265: bitstring = pub(skC) in
                                                            {6244}in(c, =GetEndpointRequest);
                                                            {6245}new SPs_5266: bitstring;
                                                            {6246}new UP_5267: bitstring;
                                                            {6247}out(c, (SPs_5266,Sign,UP_5267,pkSess_5265))
                                                        )
                                                        else
                                                            {6248}let pkSess_5268: bitstring = pub(skI) in
                                                            {6249}in(c, =GetEndpointRequest);
                                                            {6250}new SPs_5269: bitstring;
                                                            {6251}new UP_5270: bitstring;
                                                            {6252}out(c, (SPs_5269,Sign,UP_5270,pkSess_5268))
                                                    )
                                                    else
                                                        {6253}let pkSess_5271: bitstring = fail-any in
                                                        {6254}in(c, =GetEndpointRequest);
                                                        {6255}new SPs_5272: bitstring;
                                                        {6256}new UP_5273: bitstring;
                                                        {6257}out(c, (SPs_5272,Sign,UP_5273,pkSess_5271))
                                            )
                                            else
                                                {6258}let pkSess_5274: bitstring = fail-any in
                                                {6259}in(c, =GetEndpointRequest);
                                                {6260}new SPs_5275: bitstring;
                                                {6261}new UP_5276: bitstring;
                                                {6262}out(c, (SPs_5275,Sign,UP_5276,pkSess_5274))
                                    )
                                    else
                                        {6263}let pkSess_5277: bitstring = fail-any in
                                        {6264}in(c, =GetEndpointRequest);
                                        {6265}new SPs_5278: bitstring;
                                        {6266}new UP_5279: bitstring;
                                        {6267}out(c, (SPs_5278,Sign,UP_5279,pkSess_5277))
                        )
                        else
                            {6268}let pkCli_5280: bitstring = fail-any in
                            {6269}let v_5281: bool = (Sess_4247 = A) in
                            (
                                {6270}if v_5281 then
                                (
                                    {6271}let pkSess_5282: bitstring = pub(skA) in
                                    {6272}in(c, =GetEndpointRequest);
                                    {6273}new SPs_5283: bitstring;
                                    {6274}new UP_5284: bitstring;
                                    {6275}out(c, (SPs_5283,Sign,UP_5284,pkSess_5282))
                                )
                                else
                                    {6276}let v_5285: bool = (Sess_4247 = B) in
                                    (
                                        {6277}if v_5285 then
                                        (
                                            {6278}let pkSess_5286: bitstring = pub(skB) in
                                            {6279}in(c, =GetEndpointRequest);
                                            {6280}new SPs_5287: bitstring;
                                            {6281}new UP_5288: bitstring;
                                            {6282}out(c, (SPs_5287,Sign,UP_5288,pkSess_5286))
                                        )
                                        else
                                            {6283}let v_5289: bool = (Sess_4247 = C) in
                                            (
                                                {6284}if v_5289 then
                                                (
                                                    {6285}let pkSess_5290: bitstring = pub(skC) in
                                                    {6286}in(c, =GetEndpointRequest);
                                                    {6287}new SPs_5291: bitstring;
                                                    {6288}new UP_5292: bitstring;
                                                    {6289}out(c, (SPs_5291,Sign,UP_5292,pkSess_5290))
                                                )
                                                else
                                                    {6290}let pkSess_5293: bitstring = pub(skI) in
                                                    {6291}in(c, =GetEndpointRequest);
                                                    {6292}new SPs_5294: bitstring;
                                                    {6293}new UP_5295: bitstring;
                                                    {6294}out(c, (SPs_5294,Sign,UP_5295,pkSess_5293))
                                            )
                                            else
                                                {6295}let pkSess_5296: bitstring = fail-any in
                                                {6296}in(c, =GetEndpointRequest);
                                                {6297}new SPs_5297: bitstring;
                                                {6298}new UP_5298: bitstring;
                                                {6299}out(c, (SPs_5297,Sign,UP_5298,pkSess_5296))
                                    )
                                    else
                                        {6300}let pkSess_5299: bitstring = fail-any in
                                        {6301}in(c, =GetEndpointRequest);
                                        {6302}new SPs_5300: bitstring;
                                        {6303}new UP_5301: bitstring;
                                        {6304}out(c, (SPs_5300,Sign,UP_5301,pkSess_5299))
                            )
                            else
                                {6305}let pkSess_5302: bitstring = fail-any in
                                {6306}in(c, =GetEndpointRequest);
                                {6307}new SPs_5303: bitstring;
                                {6308}new UP_5304: bitstring;
                                {6309}out(c, (SPs_5303,Sign,UP_5304,pkSess_5302))
                )
                else
                    {6310}let pkCli_5305: bitstring = fail-any in
                    {6311}let v_5306: bool = (Sess_4247 = A) in
                    (
                        {6312}if v_5306 then
                        (
                            {6313}let pkSess_5307: bitstring = pub(skA) in
                            {6314}in(c, =GetEndpointRequest);
                            {6315}new SPs_5308: bitstring;
                            {6316}new UP_5309: bitstring;
                            {6317}out(c, (SPs_5308,Sign,UP_5309,pkSess_5307))
                        )
                        else
                            {6318}let v_5310: bool = (Sess_4247 = B) in
                            (
                                {6319}if v_5310 then
                                (
                                    {6320}let pkSess_5311: bitstring = pub(skB) in
                                    {6321}in(c, =GetEndpointRequest);
                                    {6322}new SPs_5312: bitstring;
                                    {6323}new UP_5313: bitstring;
                                    {6324}out(c, (SPs_5312,Sign,UP_5313,pkSess_5311))
                                )
                                else
                                    {6325}let v_5314: bool = (Sess_4247 = C) in
                                    (
                                        {6326}if v_5314 then
                                        (
                                            {6327}let pkSess_5315: bitstring = pub(skC) in
                                            {6328}in(c, =GetEndpointRequest);
                                            {6329}new SPs_5316: bitstring;
                                            {6330}new UP_5317: bitstring;
                                            {6331}out(c, (SPs_5316,Sign,UP_5317,pkSess_5315))
                                        )
                                        else
                                            {6332}let pkSess_5318: bitstring = pub(skI) in
                                            {6333}in(c, =GetEndpointRequest);
                                            {6334}new SPs_5319: bitstring;
                                            {6335}new UP_5320: bitstring;
                                            {6336}out(c, (SPs_5319,Sign,UP_5320,pkSess_5318))
                                    )
                                    else
                                        {6337}let pkSess_5321: bitstring = fail-any in
                                        {6338}in(c, =GetEndpointRequest);
                                        {6339}new SPs_5322: bitstring;
                                        {6340}new UP_5323: bitstring;
                                        {6341}out(c, (SPs_5322,Sign,UP_5323,pkSess_5321))
                            )
                            else
                                {6342}let pkSess_5324: bitstring = fail-any in
                                {6343}in(c, =GetEndpointRequest);
                                {6344}new SPs_5325: bitstring;
                                {6345}new UP_5326: bitstring;
                                {6346}out(c, (SPs_5325,Sign,UP_5326,pkSess_5324))
                    )
                    else
                        {6347}let pkSess_5327: bitstring = fail-any in
                        {6348}in(c, =GetEndpointRequest);
                        {6349}new SPs_5328: bitstring;
                        {6350}new UP_5329: bitstring;
                        {6351}out(c, (SPs_5328,Sign,UP_5329,pkSess_5327))
    )
    else
        {6352}let skDisco_5330: bitstring = fail-any in
        {6353}let pkDisco_5331: bitstring = pub(skDisco_5330) in
        {6354}let v_5332: bool = (Cli_4245 = A) in
        (
            {6355}if v_5332 then
            (
                {6356}let pkCli_5333: bitstring = pub(skA) in
                {6357}let v_5334: bool = (Sess_4247 = A) in
                (
                    {6358}if v_5334 then
                    (
                        {6359}let pkSess_5335: bitstring = pub(skA) in
                        {6360}in(c, =GetEndpointRequest);
                        {6361}new SPs_5336: bitstring;
                        {6362}new UP_5337: bitstring;
                        {6363}out(c, (SPs_5336,Sign,UP_5337,pkSess_5335))
                    )
                    else
                        {6364}let v_5338: bool = (Sess_4247 = B) in
                        (
                            {6365}if v_5338 then
                            (
                                {6366}let pkSess_5339: bitstring = pub(skB) in
                                {6367}in(c, =GetEndpointRequest);
                                {6368}new SPs_5340: bitstring;
                                {6369}new UP_5341: bitstring;
                                {6370}out(c, (SPs_5340,Sign,UP_5341,pkSess_5339))
                            )
                            else
                                {6371}let v_5342: bool = (Sess_4247 = C) in
                                (
                                    {6372}if v_5342 then
                                    (
                                        {6373}let pkSess_5343: bitstring = pub(skC) in
                                        {6374}in(c, =GetEndpointRequest);
                                        {6375}new SPs_5344: bitstring;
                                        {6376}new UP_5345: bitstring;
                                        {6377}out(c, (SPs_5344,Sign,UP_5345,pkSess_5343))
                                    )
                                    else
                                        {6378}let pkSess_5346: bitstring = pub(skI) in
                                        {6379}in(c, =GetEndpointRequest);
                                        {6380}new SPs_5347: bitstring;
                                        {6381}new UP_5348: bitstring;
                                        {6382}out(c, (SPs_5347,Sign,UP_5348,pkSess_5346))
                                )
                                else
                                    {6383}let pkSess_5349: bitstring = fail-any in
                                    {6384}in(c, =GetEndpointRequest);
                                    {6385}new SPs_5350: bitstring;
                                    {6386}new UP_5351: bitstring;
                                    {6387}out(c, (SPs_5350,Sign,UP_5351,pkSess_5349))
                        )
                        else
                            {6388}let pkSess_5352: bitstring = fail-any in
                            {6389}in(c, =GetEndpointRequest);
                            {6390}new SPs_5353: bitstring;
                            {6391}new UP_5354: bitstring;
                            {6392}out(c, (SPs_5353,Sign,UP_5354,pkSess_5352))
                )
                else
                    {6393}let pkSess_5355: bitstring = fail-any in
                    {6394}in(c, =GetEndpointRequest);
                    {6395}new SPs_5356: bitstring;
                    {6396}new UP_5357: bitstring;
                    {6397}out(c, (SPs_5356,Sign,UP_5357,pkSess_5355))
            )
            else
                {6398}let v_5358: bool = (Cli_4245 = B) in
                (
                    {6399}if v_5358 then
                    (
                        {6400}let pkCli_5359: bitstring = pub(skB) in
                        {6401}let v_5360: bool = (Sess_4247 = A) in
                        (
                            {6402}if v_5360 then
                            (
                                {6403}let pkSess_5361: bitstring = pub(skA) in
                                {6404}in(c, =GetEndpointRequest);
                                {6405}new SPs_5362: bitstring;
                                {6406}new UP_5363: bitstring;
                                {6407}out(c, (SPs_5362,Sign,UP_5363,pkSess_5361))
                            )
                            else
                                {6408}let v_5364: bool = (Sess_4247 = B) in
                                (
                                    {6409}if v_5364 then
                                    (
                                        {6410}let pkSess_5365: bitstring = pub(skB) in
                                        {6411}in(c, =GetEndpointRequest);
                                        {6412}new SPs_5366: bitstring;
                                        {6413}new UP_5367: bitstring;
                                        {6414}out(c, (SPs_5366,Sign,UP_5367,pkSess_5365))
                                    )
                                    else
                                        {6415}let v_5368: bool = (Sess_4247 = C) in
                                        (
                                            {6416}if v_5368 then
                                            (
                                                {6417}let pkSess_5369: bitstring = pub(skC) in
                                                {6418}in(c, =GetEndpointRequest);
                                                {6419}new SPs_5370: bitstring;
                                                {6420}new UP_5371: bitstring;
                                                {6421}out(c, (SPs_5370,Sign,UP_5371,pkSess_5369))
                                            )
                                            else
                                                {6422}let pkSess_5372: bitstring = pub(skI) in
                                                {6423}in(c, =GetEndpointRequest);
                                                {6424}new SPs_5373: bitstring;
                                                {6425}new UP_5374: bitstring;
                                                {6426}out(c, (SPs_5373,Sign,UP_5374,pkSess_5372))
                                        )
                                        else
                                            {6427}let pkSess_5375: bitstring = fail-any in
                                            {6428}in(c, =GetEndpointRequest);
                                            {6429}new SPs_5376: bitstring;
                                            {6430}new UP_5377: bitstring;
                                            {6431}out(c, (SPs_5376,Sign,UP_5377,pkSess_5375))
                                )
                                else
                                    {6432}let pkSess_5378: bitstring = fail-any in
                                    {6433}in(c, =GetEndpointRequest);
                                    {6434}new SPs_5379: bitstring;
                                    {6435}new UP_5380: bitstring;
                                    {6436}out(c, (SPs_5379,Sign,UP_5380,pkSess_5378))
                        )
                        else
                            {6437}let pkSess_5381: bitstring = fail-any in
                            {6438}in(c, =GetEndpointRequest);
                            {6439}new SPs_5382: bitstring;
                            {6440}new UP_5383: bitstring;
                            {6441}out(c, (SPs_5382,Sign,UP_5383,pkSess_5381))
                    )
                    else
                        {6442}let v_5384: bool = (Cli_4245 = C) in
                        (
                            {6443}if v_5384 then
                            (
                                {6444}let pkCli_5385: bitstring = pub(skC) in
                                {6445}let v_5386: bool = (Sess_4247 = A) in
                                (
                                    {6446}if v_5386 then
                                    (
                                        {6447}let pkSess_5387: bitstring = pub(skA) in
                                        {6448}in(c, =GetEndpointRequest);
                                        {6449}new SPs_5388: bitstring;
                                        {6450}new UP_5389: bitstring;
                                        {6451}out(c, (SPs_5388,Sign,UP_5389,pkSess_5387))
                                    )
                                    else
                                        {6452}let v_5390: bool = (Sess_4247 = B) in
                                        (
                                            {6453}if v_5390 then
                                            (
                                                {6454}let pkSess_5391: bitstring = pub(skB) in
                                                {6455}in(c, =GetEndpointRequest);
                                                {6456}new SPs_5392: bitstring;
                                                {6457}new UP_5393: bitstring;
                                                {6458}out(c, (SPs_5392,Sign,UP_5393,pkSess_5391))
                                            )
                                            else
                                                {6459}let v_5394: bool = (Sess_4247 = C) in
                                                (
                                                    {6460}if v_5394 then
                                                    (
                                                        {6461}let pkSess_5395: bitstring = pub(skC) in
                                                        {6462}in(c, =GetEndpointRequest);
                                                        {6463}new SPs_5396: bitstring;
                                                        {6464}new UP_5397: bitstring;
                                                        {6465}out(c, (SPs_5396,Sign,UP_5397,pkSess_5395))
                                                    )
                                                    else
                                                        {6466}let pkSess_5398: bitstring = pub(skI) in
                                                        {6467}in(c, =GetEndpointRequest);
                                                        {6468}new SPs_5399: bitstring;
                                                        {6469}new UP_5400: bitstring;
                                                        {6470}out(c, (SPs_5399,Sign,UP_5400,pkSess_5398))
                                                )
                                                else
                                                    {6471}let pkSess_5401: bitstring = fail-any in
                                                    {6472}in(c, =GetEndpointRequest);
                                                    {6473}new SPs_5402: bitstring;
                                                    {6474}new UP_5403: bitstring;
                                                    {6475}out(c, (SPs_5402,Sign,UP_5403,pkSess_5401))
                                        )
                                        else
                                            {6476}let pkSess_5404: bitstring = fail-any in
                                            {6477}in(c, =GetEndpointRequest);
                                            {6478}new SPs_5405: bitstring;
                                            {6479}new UP_5406: bitstring;
                                            {6480}out(c, (SPs_5405,Sign,UP_5406,pkSess_5404))
                                )
                                else
                                    {6481}let pkSess_5407: bitstring = fail-any in
                                    {6482}in(c, =GetEndpointRequest);
                                    {6483}new SPs_5408: bitstring;
                                    {6484}new UP_5409: bitstring;
                                    {6485}out(c, (SPs_5408,Sign,UP_5409,pkSess_5407))
                            )
                            else
                                {6486}let pkCli_5410: bitstring = pub(skI) in
                                {6487}let v_5411: bool = (Sess_4247 = A) in
                                (
                                    {6488}if v_5411 then
                                    (
                                        {6489}let pkSess_5412: bitstring = pub(skA) in
                                        {6490}in(c, =GetEndpointRequest);
                                        {6491}new SPs_5413: bitstring;
                                        {6492}new UP_5414: bitstring;
                                        {6493}out(c, (SPs_5413,Sign,UP_5414,pkSess_5412))
                                    )
                                    else
                                        {6494}let v_5415: bool = (Sess_4247 = B) in
                                        (
                                            {6495}if v_5415 then
                                            (
                                                {6496}let pkSess_5416: bitstring = pub(skB) in
                                                {6497}in(c, =GetEndpointRequest);
                                                {6498}new SPs_5417: bitstring;
                                                {6499}new UP_5418: bitstring;
                                                {6500}out(c, (SPs_5417,Sign,UP_5418,pkSess_5416))
                                            )
                                            else
                                                {6501}let v_5419: bool = (Sess_4247 = C) in
                                                (
                                                    {6502}if v_5419 then
                                                    (
                                                        {6503}let pkSess_5420: bitstring = pub(skC) in
                                                        {6504}in(c, =GetEndpointRequest);
                                                        {6505}new SPs_5421: bitstring;
                                                        {6506}new UP_5422: bitstring;
                                                        {6507}out(c, (SPs_5421,Sign,UP_5422,pkSess_5420))
                                                    )
                                                    else
                                                        {6508}let pkSess_5423: bitstring = pub(skI) in
                                                        {6509}in(c, =GetEndpointRequest);
                                                        {6510}new SPs_5424: bitstring;
                                                        {6511}new UP_5425: bitstring;
                                                        {6512}out(c, (SPs_5424,Sign,UP_5425,pkSess_5423))
                                                )
                                                else
                                                    {6513}let pkSess_5426: bitstring = fail-any in
                                                    {6514}in(c, =GetEndpointRequest);
                                                    {6515}new SPs_5427: bitstring;
                                                    {6516}new UP_5428: bitstring;
                                                    {6517}out(c, (SPs_5427,Sign,UP_5428,pkSess_5426))
                                        )
                                        else
                                            {6518}let pkSess_5429: bitstring = fail-any in
                                            {6519}in(c, =GetEndpointRequest);
                                            {6520}new SPs_5430: bitstring;
                                            {6521}new UP_5431: bitstring;
                                            {6522}out(c, (SPs_5430,Sign,UP_5431,pkSess_5429))
                                )
                                else
                                    {6523}let pkSess_5432: bitstring = fail-any in
                                    {6524}in(c, =GetEndpointRequest);
                                    {6525}new SPs_5433: bitstring;
                                    {6526}new UP_5434: bitstring;
                                    {6527}out(c, (SPs_5433,Sign,UP_5434,pkSess_5432))
                        )
                        else
                            {6528}let pkCli_5435: bitstring = fail-any in
                            {6529}let v_5436: bool = (Sess_4247 = A) in
                            (
                                {6530}if v_5436 then
                                (
                                    {6531}let pkSess_5437: bitstring = pub(skA) in
                                    {6532}in(c, =GetEndpointRequest);
                                    {6533}new SPs_5438: bitstring;
                                    {6534}new UP_5439: bitstring;
                                    {6535}out(c, (SPs_5438,Sign,UP_5439,pkSess_5437))
                                )
                                else
                                    {6536}let v_5440: bool = (Sess_4247 = B) in
                                    (
                                        {6537}if v_5440 then
                                        (
                                            {6538}let pkSess_5441: bitstring = pub(skB) in
                                            {6539}in(c, =GetEndpointRequest);
                                            {6540}new SPs_5442: bitstring;
                                            {6541}new UP_5443: bitstring;
                                            {6542}out(c, (SPs_5442,Sign,UP_5443,pkSess_5441))
                                        )
                                        else
                                            {6543}let v_5444: bool = (Sess_4247 = C) in
                                            (
                                                {6544}if v_5444 then
                                                (
                                                    {6545}let pkSess_5445: bitstring = pub(skC) in
                                                    {6546}in(c, =GetEndpointRequest);
                                                    {6547}new SPs_5446: bitstring;
                                                    {6548}new UP_5447: bitstring;
                                                    {6549}out(c, (SPs_5446,Sign,UP_5447,pkSess_5445))
                                                )
                                                else
                                                    {6550}let pkSess_5448: bitstring = pub(skI) in
                                                    {6551}in(c, =GetEndpointRequest);
                                                    {6552}new SPs_5449: bitstring;
                                                    {6553}new UP_5450: bitstring;
                                                    {6554}out(c, (SPs_5449,Sign,UP_5450,pkSess_5448))
                                            )
                                            else
                                                {6555}let pkSess_5451: bitstring = fail-any in
                                                {6556}in(c, =GetEndpointRequest);
                                                {6557}new SPs_5452: bitstring;
                                                {6558}new UP_5453: bitstring;
                                                {6559}out(c, (SPs_5452,Sign,UP_5453,pkSess_5451))
                                    )
                                    else
                                        {6560}let pkSess_5454: bitstring = fail-any in
                                        {6561}in(c, =GetEndpointRequest);
                                        {6562}new SPs_5455: bitstring;
                                        {6563}new UP_5456: bitstring;
                                        {6564}out(c, (SPs_5455,Sign,UP_5456,pkSess_5454))
                            )
                            else
                                {6565}let pkSess_5457: bitstring = fail-any in
                                {6566}in(c, =GetEndpointRequest);
                                {6567}new SPs_5458: bitstring;
                                {6568}new UP_5459: bitstring;
                                {6569}out(c, (SPs_5458,Sign,UP_5459,pkSess_5457))
                )
                else
                    {6570}let pkCli_5460: bitstring = fail-any in
                    {6571}let v_5461: bool = (Sess_4247 = A) in
                    (
                        {6572}if v_5461 then
                        (
                            {6573}let pkSess_5462: bitstring = pub(skA) in
                            {6574}in(c, =GetEndpointRequest);
                            {6575}new SPs_5463: bitstring;
                            {6576}new UP_5464: bitstring;
                            {6577}out(c, (SPs_5463,Sign,UP_5464,pkSess_5462))
                        )
                        else
                            {6578}let v_5465: bool = (Sess_4247 = B) in
                            (
                                {6579}if v_5465 then
                                (
                                    {6580}let pkSess_5466: bitstring = pub(skB) in
                                    {6581}in(c, =GetEndpointRequest);
                                    {6582}new SPs_5467: bitstring;
                                    {6583}new UP_5468: bitstring;
                                    {6584}out(c, (SPs_5467,Sign,UP_5468,pkSess_5466))
                                )
                                else
                                    {6585}let v_5469: bool = (Sess_4247 = C) in
                                    (
                                        {6586}if v_5469 then
                                        (
                                            {6587}let pkSess_5470: bitstring = pub(skC) in
                                            {6588}in(c, =GetEndpointRequest);
                                            {6589}new SPs_5471: bitstring;
                                            {6590}new UP_5472: bitstring;
                                            {6591}out(c, (SPs_5471,Sign,UP_5472,pkSess_5470))
                                        )
                                        else
                                            {6592}let pkSess_5473: bitstring = pub(skI) in
                                            {6593}in(c, =GetEndpointRequest);
                                            {6594}new SPs_5474: bitstring;
                                            {6595}new UP_5475: bitstring;
                                            {6596}out(c, (SPs_5474,Sign,UP_5475,pkSess_5473))
                                    )
                                    else
                                        {6597}let pkSess_5476: bitstring = fail-any in
                                        {6598}in(c, =GetEndpointRequest);
                                        {6599}new SPs_5477: bitstring;
                                        {6600}new UP_5478: bitstring;
                                        {6601}out(c, (SPs_5477,Sign,UP_5478,pkSess_5476))
                            )
                            else
                                {6602}let pkSess_5479: bitstring = fail-any in
                                {6603}in(c, =GetEndpointRequest);
                                {6604}new SPs_5480: bitstring;
                                {6605}new UP_5481: bitstring;
                                {6606}out(c, (SPs_5480,Sign,UP_5481,pkSess_5479))
                    )
                    else
                        {6607}let pkSess_5482: bitstring = fail-any in
                        {6608}in(c, =GetEndpointRequest);
                        {6609}new SPs_5483: bitstring;
                        {6610}new UP_5484: bitstring;
                        {6611}out(c, (SPs_5483,Sign,UP_5484,pkSess_5482))
        )
        else
            {6612}let pkCli_5485: bitstring = fail-any in
            {6613}let v_5486: bool = (Sess_4247 = A) in
            (
                {6614}if v_5486 then
                (
                    {6615}let pkSess_5487: bitstring = pub(skA) in
                    {6616}in(c, =GetEndpointRequest);
                    {6617}new SPs_5488: bitstring;
                    {6618}new UP_5489: bitstring;
                    {6619}out(c, (SPs_5488,Sign,UP_5489,pkSess_5487))
                )
                else
                    {6620}let v_5490: bool = (Sess_4247 = B) in
                    (
                        {6621}if v_5490 then
                        (
                            {6622}let pkSess_5491: bitstring = pub(skB) in
                            {6623}in(c, =GetEndpointRequest);
                            {6624}new SPs_5492: bitstring;
                            {6625}new UP_5493: bitstring;
                            {6626}out(c, (SPs_5492,Sign,UP_5493,pkSess_5491))
                        )
                        else
                            {6627}let v_5494: bool = (Sess_4247 = C) in
                            (
                                {6628}if v_5494 then
                                (
                                    {6629}let pkSess_5495: bitstring = pub(skC) in
                                    {6630}in(c, =GetEndpointRequest);
                                    {6631}new SPs_5496: bitstring;
                                    {6632}new UP_5497: bitstring;
                                    {6633}out(c, (SPs_5496,Sign,UP_5497,pkSess_5495))
                                )
                                else
                                    {6634}let pkSess_5498: bitstring = pub(skI) in
                                    {6635}in(c, =GetEndpointRequest);
                                    {6636}new SPs_5499: bitstring;
                                    {6637}new UP_5500: bitstring;
                                    {6638}out(c, (SPs_5499,Sign,UP_5500,pkSess_5498))
                            )
                            else
                                {6639}let pkSess_5501: bitstring = fail-any in
                                {6640}in(c, =GetEndpointRequest);
                                {6641}new SPs_5502: bitstring;
                                {6642}new UP_5503: bitstring;
                                {6643}out(c, (SPs_5502,Sign,UP_5503,pkSess_5501))
                    )
                    else
                        {6644}let pkSess_5504: bitstring = fail-any in
                        {6645}in(c, =GetEndpointRequest);
                        {6646}new SPs_5505: bitstring;
                        {6647}new UP_5506: bitstring;
                        {6648}out(c, (SPs_5505,Sign,UP_5506,pkSess_5504))
            )
            else
                {6649}let pkSess_5507: bitstring = fail-any in
                {6650}in(c, =GetEndpointRequest);
                {6651}new SPs_5508: bitstring;
                {6652}new UP_5509: bitstring;
                {6653}out(c, (SPs_5508,Sign,UP_5509,pkSess_5507))
) | (
    {6654}!
    {6655}in(c, (Cli_5510: host,Disco_5511: host,Sess_5512: host));
    {6656}let v_5513: bool = (Sess_5512 = A) in
    (
        {6657}if v_5513 then
        (
            {6658}let skSess: bitstring = skA in
            {6659}let pkSess_5514: bitstring = pub(skSess) in
            {6660}let v_5515: bool = (Cli_5510 = A) in
            (
                {6661}if v_5515 then
                (
                    {6662}let pkCli_5516: bitstring = pub(skA) in
                    {6663}let v_5517: bool = (Disco_5511 = A) in
                    (
                        {6664}if v_5517 then
                        (
                            {6665}let pkDisco_5518: bitstring = pub(skA) in
                            {6666}in(c, (=pkCli_5516,m1_5519: bitstring,sigM1: bitstring));
                            {6667}if (verify(m1_5519,sigM1,pkCli_5516) <> true) then
                                0
                            else
                                {6668}let (=Sess_5512,SPc_5520: bitstring,PartC: bitstring) = m1_5519 in
                                {6669}new Ns: bitstring;
                                {6670}let m2: bitstring = (Cli_5510,exp(g,Ns)) in
                                {6671}out(c, (m2,sign(m2,skSess)));
                                {6672}let Ksrv: bitstring = exp(PartC,Ns) in
                                {6673}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv))
                        )
                        else
                            {6674}let v_5521: bool = (Disco_5511 = B) in
                            (
                                {6675}if v_5521 then
                                (
                                    {6676}let pkDisco_5522: bitstring = pub(skB) in
                                    {6677}in(c, (=pkCli_5516,m1_5523: bitstring,sigM1_5524: bitstring));
                                    {6678}if (verify(m1_5523,sigM1_5524,pkCli_5516) <> true) then
                                        0
                                    else
                                        {6679}let (=Sess_5512,SPc_5525: bitstring,PartC_5526: bitstring) = m1_5523 in
                                        {6680}new Ns_5527: bitstring;
                                        {6681}let m2_5528: bitstring = (Cli_5510,exp(g,Ns_5527)) in
                                        {6682}out(c, (m2_5528,sign(m2_5528,skSess)));
                                        {6683}let Ksrv_5529: bitstring = exp(PartC_5526,Ns_5527) in
                                        {6684}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv_5529))
                                )
                                else
                                    {6685}let v_5530: bool = (Disco_5511 = C) in
                                    (
                                        {6686}if v_5530 then
                                        (
                                            {6687}let pkDisco_5531: bitstring = pub(skC) in
                                            {6688}in(c, (=pkCli_5516,m1_5532: bitstring,sigM1_5533: bitstring));
                                            {6689}if (verify(m1_5532,sigM1_5533,pkCli_5516) <> true) then
                                                0
                                            else
                                                {6690}let (=Sess_5512,SPc_5534: bitstring,PartC_5535: bitstring) = m1_5532 in
                                                {6691}new Ns_5536: bitstring;
                                                {6692}let m2_5537: bitstring = (Cli_5510,exp(g,Ns_5536)) in
                                                {6693}out(c, (m2_5537,sign(m2_5537,skSess)));
                                                {6694}let Ksrv_5538: bitstring = exp(PartC_5535,Ns_5536) in
                                                {6695}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv_5538))
                                        )
                                        else
                                            {6696}let pkDisco_5539: bitstring = pub(skI) in
                                            {6697}in(c, (=pkCli_5516,m1_5540: bitstring,sigM1_5541: bitstring));
                                            {6698}if (verify(m1_5540,sigM1_5541,pkCli_5516) <> true) then
                                                0
                                            else
                                                {6699}let (=Sess_5512,SPc_5542: bitstring,PartC_5543: bitstring) = m1_5540 in
                                                {6700}new Ns_5544: bitstring;
                                                {6701}let m2_5545: bitstring = (Cli_5510,exp(g,Ns_5544)) in
                                                {6702}out(c, (m2_5545,sign(m2_5545,skSess)));
                                                {6703}let Ksrv_5546: bitstring = exp(PartC_5543,Ns_5544) in
                                                {6704}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv_5546))
                                    )
                                    else
                                        {6705}let pkDisco_5547: bitstring = fail-any in
                                        {6706}in(c, (=pkCli_5516,m1_5548: bitstring,sigM1_5549: bitstring));
                                        {6707}if (verify(m1_5548,sigM1_5549,pkCli_5516) <> true) then
                                            0
                                        else
                                            {6708}let (=Sess_5512,SPc_5550: bitstring,PartC_5551: bitstring) = m1_5548 in
                                            {6709}new Ns_5552: bitstring;
                                            {6710}let m2_5553: bitstring = (Cli_5510,exp(g,Ns_5552)) in
                                            {6711}out(c, (m2_5553,sign(m2_5553,skSess)));
                                            {6712}let Ksrv_5554: bitstring = exp(PartC_5551,Ns_5552) in
                                            {6713}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv_5554))
                            )
                            else
                                {6714}let pkDisco_5555: bitstring = fail-any in
                                {6715}in(c, (=pkCli_5516,m1_5556: bitstring,sigM1_5557: bitstring));
                                {6716}if (verify(m1_5556,sigM1_5557,pkCli_5516) <> true) then
                                    0
                                else
                                    {6717}let (=Sess_5512,SPc_5558: bitstring,PartC_5559: bitstring) = m1_5556 in
                                    {6718}new Ns_5560: bitstring;
                                    {6719}let m2_5561: bitstring = (Cli_5510,exp(g,Ns_5560)) in
                                    {6720}out(c, (m2_5561,sign(m2_5561,skSess)));
                                    {6721}let Ksrv_5562: bitstring = exp(PartC_5559,Ns_5560) in
                                    {6722}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv_5562))
                    )
                    else
                        {6723}let pkDisco_5563: bitstring = fail-any in
                        {6724}in(c, (=pkCli_5516,m1_5564: bitstring,sigM1_5565: bitstring));
                        {6725}if (verify(m1_5564,sigM1_5565,pkCli_5516) <> true) then
                            0
                        else
                            {6726}let (=Sess_5512,SPc_5566: bitstring,PartC_5567: bitstring) = m1_5564 in
                            {6727}new Ns_5568: bitstring;
                            {6728}let m2_5569: bitstring = (Cli_5510,exp(g,Ns_5568)) in
                            {6729}out(c, (m2_5569,sign(m2_5569,skSess)));
                            {6730}let Ksrv_5570: bitstring = exp(PartC_5567,Ns_5568) in
                            {6731}out(c, senc(mSrv(pkCli_5516,pkSess_5514),Ksrv_5570))
                )
                else
                    {6732}let v_5571: bool = (Cli_5510 = B) in
                    (
                        {6733}if v_5571 then
                        (
                            {6734}let pkCli_5572: bitstring = pub(skB) in
                            {6735}let v_5573: bool = (Disco_5511 = A) in
                            (
                                {6736}if v_5573 then
                                (
                                    {6737}let pkDisco_5574: bitstring = pub(skA) in
                                    {6738}in(c, (=pkCli_5572,m1_5575: bitstring,sigM1_5576: bitstring));
                                    {6739}if (verify(m1_5575,sigM1_5576,pkCli_5572) <> true) then
                                        0
                                    else
                                        {6740}let (=Sess_5512,SPc_5577: bitstring,PartC_5578: bitstring) = m1_5575 in
                                        {6741}new Ns_5579: bitstring;
                                        {6742}let m2_5580: bitstring = (Cli_5510,exp(g,Ns_5579)) in
                                        {6743}out(c, (m2_5580,sign(m2_5580,skSess)));
                                        {6744}let Ksrv_5581: bitstring = exp(PartC_5578,Ns_5579) in
                                        {6745}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5581))
                                )
                                else
                                    {6746}let v_5582: bool = (Disco_5511 = B) in
                                    (
                                        {6747}if v_5582 then
                                        (
                                            {6748}let pkDisco_5583: bitstring = pub(skB) in
                                            {6749}in(c, (=pkCli_5572,m1_5584: bitstring,sigM1_5585: bitstring));
                                            {6750}if (verify(m1_5584,sigM1_5585,pkCli_5572) <> true) then
                                                0
                                            else
                                                {6751}let (=Sess_5512,SPc_5586: bitstring,PartC_5587: bitstring) = m1_5584 in
                                                {6752}new Ns_5588: bitstring;
                                                {6753}let m2_5589: bitstring = (Cli_5510,exp(g,Ns_5588)) in
                                                {6754}out(c, (m2_5589,sign(m2_5589,skSess)));
                                                {6755}let Ksrv_5590: bitstring = exp(PartC_5587,Ns_5588) in
                                                {6756}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5590))
                                        )
                                        else
                                            {6757}let v_5591: bool = (Disco_5511 = C) in
                                            (
                                                {6758}if v_5591 then
                                                (
                                                    {6759}let pkDisco_5592: bitstring = pub(skC) in
                                                    {6760}in(c, (=pkCli_5572,m1_5593: bitstring,sigM1_5594: bitstring));
                                                    {6761}if (verify(m1_5593,sigM1_5594,pkCli_5572) <> true) then
                                                        0
                                                    else
                                                        {6762}let (=Sess_5512,SPc_5595: bitstring,PartC_5596: bitstring) = m1_5593 in
                                                        {6763}new Ns_5597: bitstring;
                                                        {6764}let m2_5598: bitstring = (Cli_5510,exp(g,Ns_5597)) in
                                                        {6765}out(c, (m2_5598,sign(m2_5598,skSess)));
                                                        {6766}let Ksrv_5599: bitstring = exp(PartC_5596,Ns_5597) in
                                                        {6767}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5599))
                                                )
                                                else
                                                    {6768}let pkDisco_5600: bitstring = pub(skI) in
                                                    {6769}in(c, (=pkCli_5572,m1_5601: bitstring,sigM1_5602: bitstring));
                                                    {6770}if (verify(m1_5601,sigM1_5602,pkCli_5572) <> true) then
                                                        0
                                                    else
                                                        {6771}let (=Sess_5512,SPc_5603: bitstring,PartC_5604: bitstring) = m1_5601 in
                                                        {6772}new Ns_5605: bitstring;
                                                        {6773}let m2_5606: bitstring = (Cli_5510,exp(g,Ns_5605)) in
                                                        {6774}out(c, (m2_5606,sign(m2_5606,skSess)));
                                                        {6775}let Ksrv_5607: bitstring = exp(PartC_5604,Ns_5605) in
                                                        {6776}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5607))
                                            )
                                            else
                                                {6777}let pkDisco_5608: bitstring = fail-any in
                                                {6778}in(c, (=pkCli_5572,m1_5609: bitstring,sigM1_5610: bitstring));
                                                {6779}if (verify(m1_5609,sigM1_5610,pkCli_5572) <> true) then
                                                    0
                                                else
                                                    {6780}let (=Sess_5512,SPc_5611: bitstring,PartC_5612: bitstring) = m1_5609 in
                                                    {6781}new Ns_5613: bitstring;
                                                    {6782}let m2_5614: bitstring = (Cli_5510,exp(g,Ns_5613)) in
                                                    {6783}out(c, (m2_5614,sign(m2_5614,skSess)));
                                                    {6784}let Ksrv_5615: bitstring = exp(PartC_5612,Ns_5613) in
                                                    {6785}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5615))
                                    )
                                    else
                                        {6786}let pkDisco_5616: bitstring = fail-any in
                                        {6787}in(c, (=pkCli_5572,m1_5617: bitstring,sigM1_5618: bitstring));
                                        {6788}if (verify(m1_5617,sigM1_5618,pkCli_5572) <> true) then
                                            0
                                        else
                                            {6789}let (=Sess_5512,SPc_5619: bitstring,PartC_5620: bitstring) = m1_5617 in
                                            {6790}new Ns_5621: bitstring;
                                            {6791}let m2_5622: bitstring = (Cli_5510,exp(g,Ns_5621)) in
                                            {6792}out(c, (m2_5622,sign(m2_5622,skSess)));
                                            {6793}let Ksrv_5623: bitstring = exp(PartC_5620,Ns_5621) in
                                            {6794}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5623))
                            )
                            else
                                {6795}let pkDisco_5624: bitstring = fail-any in
                                {6796}in(c, (=pkCli_5572,m1_5625: bitstring,sigM1_5626: bitstring));
                                {6797}if (verify(m1_5625,sigM1_5626,pkCli_5572) <> true) then
                                    0
                                else
                                    {6798}let (=Sess_5512,SPc_5627: bitstring,PartC_5628: bitstring) = m1_5625 in
                                    {6799}new Ns_5629: bitstring;
                                    {6800}let m2_5630: bitstring = (Cli_5510,exp(g,Ns_5629)) in
                                    {6801}out(c, (m2_5630,sign(m2_5630,skSess)));
                                    {6802}let Ksrv_5631: bitstring = exp(PartC_5628,Ns_5629) in
                                    {6803}out(c, senc(mSrv(pkCli_5572,pkSess_5514),Ksrv_5631))
                        )
                        else
                            {6804}let v_5632: bool = (Cli_5510 = C) in
                            (
                                {6805}if v_5632 then
                                (
                                    {6806}let pkCli_5633: bitstring = pub(skC) in
                                    {6807}let v_5634: bool = (Disco_5511 = A) in
                                    (
                                        {6808}if v_5634 then
                                        (
                                            {6809}let pkDisco_5635: bitstring = pub(skA) in
                                            {6810}in(c, (=pkCli_5633,m1_5636: bitstring,sigM1_5637: bitstring));
                                            {6811}if (verify(m1_5636,sigM1_5637,pkCli_5633) <> true) then
                                                0
                                            else
                                                {6812}let (=Sess_5512,SPc_5638: bitstring,PartC_5639: bitstring) = m1_5636 in
                                                {6813}new Ns_5640: bitstring;
                                                {6814}let m2_5641: bitstring = (Cli_5510,exp(g,Ns_5640)) in
                                                {6815}out(c, (m2_5641,sign(m2_5641,skSess)));
                                                {6816}let Ksrv_5642: bitstring = exp(PartC_5639,Ns_5640) in
                                                {6817}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5642))
                                        )
                                        else
                                            {6818}let v_5643: bool = (Disco_5511 = B) in
                                            (
                                                {6819}if v_5643 then
                                                (
                                                    {6820}let pkDisco_5644: bitstring = pub(skB) in
                                                    {6821}in(c, (=pkCli_5633,m1_5645: bitstring,sigM1_5646: bitstring));
                                                    {6822}if (verify(m1_5645,sigM1_5646,pkCli_5633) <> true) then
                                                        0
                                                    else
                                                        {6823}let (=Sess_5512,SPc_5647: bitstring,PartC_5648: bitstring) = m1_5645 in
                                                        {6824}new Ns_5649: bitstring;
                                                        {6825}let m2_5650: bitstring = (Cli_5510,exp(g,Ns_5649)) in
                                                        {6826}out(c, (m2_5650,sign(m2_5650,skSess)));
                                                        {6827}let Ksrv_5651: bitstring = exp(PartC_5648,Ns_5649) in
                                                        {6828}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5651))
                                                )
                                                else
                                                    {6829}let v_5652: bool = (Disco_5511 = C) in
                                                    (
                                                        {6830}if v_5652 then
                                                        (
                                                            {6831}let pkDisco_5653: bitstring = pub(skC) in
                                                            {6832}in(c, (=pkCli_5633,m1_5654: bitstring,sigM1_5655: bitstring));
                                                            {6833}if (verify(m1_5654,sigM1_5655,pkCli_5633) <> true) then
                                                                0
                                                            else
                                                                {6834}let (=Sess_5512,SPc_5656: bitstring,PartC_5657: bitstring) = m1_5654 in
                                                                {6835}new Ns_5658: bitstring;
                                                                {6836}let m2_5659: bitstring = (Cli_5510,exp(g,Ns_5658)) in
                                                                {6837}out(c, (m2_5659,sign(m2_5659,skSess)));
                                                                {6838}let Ksrv_5660: bitstring = exp(PartC_5657,Ns_5658) in
                                                                {6839}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5660))
                                                        )
                                                        else
                                                            {6840}let pkDisco_5661: bitstring = pub(skI) in
                                                            {6841}in(c, (=pkCli_5633,m1_5662: bitstring,sigM1_5663: bitstring));
                                                            {6842}if (verify(m1_5662,sigM1_5663,pkCli_5633) <> true) then
                                                                0
                                                            else
                                                                {6843}let (=Sess_5512,SPc_5664: bitstring,PartC_5665: bitstring) = m1_5662 in
                                                                {6844}new Ns_5666: bitstring;
                                                                {6845}let m2_5667: bitstring = (Cli_5510,exp(g,Ns_5666)) in
                                                                {6846}out(c, (m2_5667,sign(m2_5667,skSess)));
                                                                {6847}let Ksrv_5668: bitstring = exp(PartC_5665,Ns_5666) in
                                                                {6848}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5668))
                                                    )
                                                    else
                                                        {6849}let pkDisco_5669: bitstring = fail-any in
                                                        {6850}in(c, (=pkCli_5633,m1_5670: bitstring,sigM1_5671: bitstring));
                                                        {6851}if (verify(m1_5670,sigM1_5671,pkCli_5633) <> true) then
                                                            0
                                                        else
                                                            {6852}let (=Sess_5512,SPc_5672: bitstring,PartC_5673: bitstring) = m1_5670 in
                                                            {6853}new Ns_5674: bitstring;
                                                            {6854}let m2_5675: bitstring = (Cli_5510,exp(g,Ns_5674)) in
                                                            {6855}out(c, (m2_5675,sign(m2_5675,skSess)));
                                                            {6856}let Ksrv_5676: bitstring = exp(PartC_5673,Ns_5674) in
                                                            {6857}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5676))
                                            )
                                            else
                                                {6858}let pkDisco_5677: bitstring = fail-any in
                                                {6859}in(c, (=pkCli_5633,m1_5678: bitstring,sigM1_5679: bitstring));
                                                {6860}if (verify(m1_5678,sigM1_5679,pkCli_5633) <> true) then
                                                    0
                                                else
                                                    {6861}let (=Sess_5512,SPc_5680: bitstring,PartC_5681: bitstring) = m1_5678 in
                                                    {6862}new Ns_5682: bitstring;
                                                    {6863}let m2_5683: bitstring = (Cli_5510,exp(g,Ns_5682)) in
                                                    {6864}out(c, (m2_5683,sign(m2_5683,skSess)));
                                                    {6865}let Ksrv_5684: bitstring = exp(PartC_5681,Ns_5682) in
                                                    {6866}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5684))
                                    )
                                    else
                                        {6867}let pkDisco_5685: bitstring = fail-any in
                                        {6868}in(c, (=pkCli_5633,m1_5686: bitstring,sigM1_5687: bitstring));
                                        {6869}if (verify(m1_5686,sigM1_5687,pkCli_5633) <> true) then
                                            0
                                        else
                                            {6870}let (=Sess_5512,SPc_5688: bitstring,PartC_5689: bitstring) = m1_5686 in
                                            {6871}new Ns_5690: bitstring;
                                            {6872}let m2_5691: bitstring = (Cli_5510,exp(g,Ns_5690)) in
                                            {6873}out(c, (m2_5691,sign(m2_5691,skSess)));
                                            {6874}let Ksrv_5692: bitstring = exp(PartC_5689,Ns_5690) in
                                            {6875}out(c, senc(mSrv(pkCli_5633,pkSess_5514),Ksrv_5692))
                                )
                                else
                                    {6876}let pkCli_5693: bitstring = pub(skI) in
                                    {6877}let v_5694: bool = (Disco_5511 = A) in
                                    (
                                        {6878}if v_5694 then
                                        (
                                            {6879}let pkDisco_5695: bitstring = pub(skA) in
                                            {6880}in(c, (=pkCli_5693,m1_5696: bitstring,sigM1_5697: bitstring));
                                            {6881}if (verify(m1_5696,sigM1_5697,pkCli_5693) <> true) then
                                                0
                                            else
                                                {6882}let (=Sess_5512,SPc_5698: bitstring,PartC_5699: bitstring) = m1_5696 in
                                                {6883}new Ns_5700: bitstring;
                                                {6884}let m2_5701: bitstring = (Cli_5510,exp(g,Ns_5700)) in
                                                {6885}out(c, (m2_5701,sign(m2_5701,skSess)));
                                                {6886}let Ksrv_5702: bitstring = exp(PartC_5699,Ns_5700) in
                                                {6887}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5702))
                                        )
                                        else
                                            {6888}let v_5703: bool = (Disco_5511 = B) in
                                            (
                                                {6889}if v_5703 then
                                                (
                                                    {6890}let pkDisco_5704: bitstring = pub(skB) in
                                                    {6891}in(c, (=pkCli_5693,m1_5705: bitstring,sigM1_5706: bitstring));
                                                    {6892}if (verify(m1_5705,sigM1_5706,pkCli_5693) <> true) then
                                                        0
                                                    else
                                                        {6893}let (=Sess_5512,SPc_5707: bitstring,PartC_5708: bitstring) = m1_5705 in
                                                        {6894}new Ns_5709: bitstring;
                                                        {6895}let m2_5710: bitstring = (Cli_5510,exp(g,Ns_5709)) in
                                                        {6896}out(c, (m2_5710,sign(m2_5710,skSess)));
                                                        {6897}let Ksrv_5711: bitstring = exp(PartC_5708,Ns_5709) in
                                                        {6898}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5711))
                                                )
                                                else
                                                    {6899}let v_5712: bool = (Disco_5511 = C) in
                                                    (
                                                        {6900}if v_5712 then
                                                        (
                                                            {6901}let pkDisco_5713: bitstring = pub(skC) in
                                                            {6902}in(c, (=pkCli_5693,m1_5714: bitstring,sigM1_5715: bitstring));
                                                            {6903}if (verify(m1_5714,sigM1_5715,pkCli_5693) <> true) then
                                                                0
                                                            else
                                                                {6904}let (=Sess_5512,SPc_5716: bitstring,PartC_5717: bitstring) = m1_5714 in
                                                                {6905}new Ns_5718: bitstring;
                                                                {6906}let m2_5719: bitstring = (Cli_5510,exp(g,Ns_5718)) in
                                                                {6907}out(c, (m2_5719,sign(m2_5719,skSess)));
                                                                {6908}let Ksrv_5720: bitstring = exp(PartC_5717,Ns_5718) in
                                                                {6909}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5720))
                                                        )
                                                        else
                                                            {6910}let pkDisco_5721: bitstring = pub(skI) in
                                                            {6911}in(c, (=pkCli_5693,m1_5722: bitstring,sigM1_5723: bitstring));
                                                            {6912}if (verify(m1_5722,sigM1_5723,pkCli_5693) <> true) then
                                                                0
                                                            else
                                                                {6913}let (=Sess_5512,SPc_5724: bitstring,PartC_5725: bitstring) = m1_5722 in
                                                                {6914}new Ns_5726: bitstring;
                                                                {6915}let m2_5727: bitstring = (Cli_5510,exp(g,Ns_5726)) in
                                                                {6916}out(c, (m2_5727,sign(m2_5727,skSess)));
                                                                {6917}let Ksrv_5728: bitstring = exp(PartC_5725,Ns_5726) in
                                                                {6918}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5728))
                                                    )
                                                    else
                                                        {6919}let pkDisco_5729: bitstring = fail-any in
                                                        {6920}in(c, (=pkCli_5693,m1_5730: bitstring,sigM1_5731: bitstring));
                                                        {6921}if (verify(m1_5730,sigM1_5731,pkCli_5693) <> true) then
                                                            0
                                                        else
                                                            {6922}let (=Sess_5512,SPc_5732: bitstring,PartC_5733: bitstring) = m1_5730 in
                                                            {6923}new Ns_5734: bitstring;
                                                            {6924}let m2_5735: bitstring = (Cli_5510,exp(g,Ns_5734)) in
                                                            {6925}out(c, (m2_5735,sign(m2_5735,skSess)));
                                                            {6926}let Ksrv_5736: bitstring = exp(PartC_5733,Ns_5734) in
                                                            {6927}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5736))
                                            )
                                            else
                                                {6928}let pkDisco_5737: bitstring = fail-any in
                                                {6929}in(c, (=pkCli_5693,m1_5738: bitstring,sigM1_5739: bitstring));
                                                {6930}if (verify(m1_5738,sigM1_5739,pkCli_5693) <> true) then
                                                    0
                                                else
                                                    {6931}let (=Sess_5512,SPc_5740: bitstring,PartC_5741: bitstring) = m1_5738 in
                                                    {6932}new Ns_5742: bitstring;
                                                    {6933}let m2_5743: bitstring = (Cli_5510,exp(g,Ns_5742)) in
                                                    {6934}out(c, (m2_5743,sign(m2_5743,skSess)));
                                                    {6935}let Ksrv_5744: bitstring = exp(PartC_5741,Ns_5742) in
                                                    {6936}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5744))
                                    )
                                    else
                                        {6937}let pkDisco_5745: bitstring = fail-any in
                                        {6938}in(c, (=pkCli_5693,m1_5746: bitstring,sigM1_5747: bitstring));
                                        {6939}if (verify(m1_5746,sigM1_5747,pkCli_5693) <> true) then
                                            0
                                        else
                                            {6940}let (=Sess_5512,SPc_5748: bitstring,PartC_5749: bitstring) = m1_5746 in
                                            {6941}new Ns_5750: bitstring;
                                            {6942}let m2_5751: bitstring = (Cli_5510,exp(g,Ns_5750)) in
                                            {6943}out(c, (m2_5751,sign(m2_5751,skSess)));
                                            {6944}let Ksrv_5752: bitstring = exp(PartC_5749,Ns_5750) in
                                            {6945}out(c, senc(mSrv(pkCli_5693,pkSess_5514),Ksrv_5752))
                            )
                            else
                                {6946}let pkCli_5753: bitstring = fail-any in
                                {6947}let v_5754: bool = (Disco_5511 = A) in
                                (
                                    {6948}if v_5754 then
                                    (
                                        {6949}let pkDisco_5755: bitstring = pub(skA) in
                                        {6950}in(c, (=pkCli_5753,m1_5756: bitstring,sigM1_5757: bitstring));
                                        {6951}if (verify(m1_5756,sigM1_5757,pkCli_5753) <> true) then
                                            0
                                        else
                                            {6952}let (=Sess_5512,SPc_5758: bitstring,PartC_5759: bitstring) = m1_5756 in
                                            {6953}new Ns_5760: bitstring;
                                            {6954}let m2_5761: bitstring = (Cli_5510,exp(g,Ns_5760)) in
                                            {6955}out(c, (m2_5761,sign(m2_5761,skSess)));
                                            {6956}let Ksrv_5762: bitstring = exp(PartC_5759,Ns_5760) in
                                            {6957}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5762))
                                    )
                                    else
                                        {6958}let v_5763: bool = (Disco_5511 = B) in
                                        (
                                            {6959}if v_5763 then
                                            (
                                                {6960}let pkDisco_5764: bitstring = pub(skB) in
                                                {6961}in(c, (=pkCli_5753,m1_5765: bitstring,sigM1_5766: bitstring));
                                                {6962}if (verify(m1_5765,sigM1_5766,pkCli_5753) <> true) then
                                                    0
                                                else
                                                    {6963}let (=Sess_5512,SPc_5767: bitstring,PartC_5768: bitstring) = m1_5765 in
                                                    {6964}new Ns_5769: bitstring;
                                                    {6965}let m2_5770: bitstring = (Cli_5510,exp(g,Ns_5769)) in
                                                    {6966}out(c, (m2_5770,sign(m2_5770,skSess)));
                                                    {6967}let Ksrv_5771: bitstring = exp(PartC_5768,Ns_5769) in
                                                    {6968}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5771))
                                            )
                                            else
                                                {6969}let v_5772: bool = (Disco_5511 = C) in
                                                (
                                                    {6970}if v_5772 then
                                                    (
                                                        {6971}let pkDisco_5773: bitstring = pub(skC) in
                                                        {6972}in(c, (=pkCli_5753,m1_5774: bitstring,sigM1_5775: bitstring));
                                                        {6973}if (verify(m1_5774,sigM1_5775,pkCli_5753) <> true) then
                                                            0
                                                        else
                                                            {6974}let (=Sess_5512,SPc_5776: bitstring,PartC_5777: bitstring) = m1_5774 in
                                                            {6975}new Ns_5778: bitstring;
                                                            {6976}let m2_5779: bitstring = (Cli_5510,exp(g,Ns_5778)) in
                                                            {6977}out(c, (m2_5779,sign(m2_5779,skSess)));
                                                            {6978}let Ksrv_5780: bitstring = exp(PartC_5777,Ns_5778) in
                                                            {6979}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5780))
                                                    )
                                                    else
                                                        {6980}let pkDisco_5781: bitstring = pub(skI) in
                                                        {6981}in(c, (=pkCli_5753,m1_5782: bitstring,sigM1_5783: bitstring));
                                                        {6982}if (verify(m1_5782,sigM1_5783,pkCli_5753) <> true) then
                                                            0
                                                        else
                                                            {6983}let (=Sess_5512,SPc_5784: bitstring,PartC_5785: bitstring) = m1_5782 in
                                                            {6984}new Ns_5786: bitstring;
                                                            {6985}let m2_5787: bitstring = (Cli_5510,exp(g,Ns_5786)) in
                                                            {6986}out(c, (m2_5787,sign(m2_5787,skSess)));
                                                            {6987}let Ksrv_5788: bitstring = exp(PartC_5785,Ns_5786) in
                                                            {6988}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5788))
                                                )
                                                else
                                                    {6989}let pkDisco_5789: bitstring = fail-any in
                                                    {6990}in(c, (=pkCli_5753,m1_5790: bitstring,sigM1_5791: bitstring));
                                                    {6991}if (verify(m1_5790,sigM1_5791,pkCli_5753) <> true) then
                                                        0
                                                    else
                                                        {6992}let (=Sess_5512,SPc_5792: bitstring,PartC_5793: bitstring) = m1_5790 in
                                                        {6993}new Ns_5794: bitstring;
                                                        {6994}let m2_5795: bitstring = (Cli_5510,exp(g,Ns_5794)) in
                                                        {6995}out(c, (m2_5795,sign(m2_5795,skSess)));
                                                        {6996}let Ksrv_5796: bitstring = exp(PartC_5793,Ns_5794) in
                                                        {6997}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5796))
                                        )
                                        else
                                            {6998}let pkDisco_5797: bitstring = fail-any in
                                            {6999}in(c, (=pkCli_5753,m1_5798: bitstring,sigM1_5799: bitstring));
                                            {7000}if (verify(m1_5798,sigM1_5799,pkCli_5753) <> true) then
                                                0
                                            else
                                                {7001}let (=Sess_5512,SPc_5800: bitstring,PartC_5801: bitstring) = m1_5798 in
                                                {7002}new Ns_5802: bitstring;
                                                {7003}let m2_5803: bitstring = (Cli_5510,exp(g,Ns_5802)) in
                                                {7004}out(c, (m2_5803,sign(m2_5803,skSess)));
                                                {7005}let Ksrv_5804: bitstring = exp(PartC_5801,Ns_5802) in
                                                {7006}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5804))
                                )
                                else
                                    {7007}let pkDisco_5805: bitstring = fail-any in
                                    {7008}in(c, (=pkCli_5753,m1_5806: bitstring,sigM1_5807: bitstring));
                                    {7009}if (verify(m1_5806,sigM1_5807,pkCli_5753) <> true) then
                                        0
                                    else
                                        {7010}let (=Sess_5512,SPc_5808: bitstring,PartC_5809: bitstring) = m1_5806 in
                                        {7011}new Ns_5810: bitstring;
                                        {7012}let m2_5811: bitstring = (Cli_5510,exp(g,Ns_5810)) in
                                        {7013}out(c, (m2_5811,sign(m2_5811,skSess)));
                                        {7014}let Ksrv_5812: bitstring = exp(PartC_5809,Ns_5810) in
                                        {7015}out(c, senc(mSrv(pkCli_5753,pkSess_5514),Ksrv_5812))
                    )
                    else
                        {7016}let pkCli_5813: bitstring = fail-any in
                        {7017}let v_5814: bool = (Disco_5511 = A) in
                        (
                            {7018}if v_5814 then
                            (
                                {7019}let pkDisco_5815: bitstring = pub(skA) in
                                {7020}in(c, (=pkCli_5813,m1_5816: bitstring,sigM1_5817: bitstring));
                                {7021}if (verify(m1_5816,sigM1_5817,pkCli_5813) <> true) then
                                    0
                                else
                                    {7022}let (=Sess_5512,SPc_5818: bitstring,PartC_5819: bitstring) = m1_5816 in
                                    {7023}new Ns_5820: bitstring;
                                    {7024}let m2_5821: bitstring = (Cli_5510,exp(g,Ns_5820)) in
                                    {7025}out(c, (m2_5821,sign(m2_5821,skSess)));
                                    {7026}let Ksrv_5822: bitstring = exp(PartC_5819,Ns_5820) in
                                    {7027}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5822))
                            )
                            else
                                {7028}let v_5823: bool = (Disco_5511 = B) in
                                (
                                    {7029}if v_5823 then
                                    (
                                        {7030}let pkDisco_5824: bitstring = pub(skB) in
                                        {7031}in(c, (=pkCli_5813,m1_5825: bitstring,sigM1_5826: bitstring));
                                        {7032}if (verify(m1_5825,sigM1_5826,pkCli_5813) <> true) then
                                            0
                                        else
                                            {7033}let (=Sess_5512,SPc_5827: bitstring,PartC_5828: bitstring) = m1_5825 in
                                            {7034}new Ns_5829: bitstring;
                                            {7035}let m2_5830: bitstring = (Cli_5510,exp(g,Ns_5829)) in
                                            {7036}out(c, (m2_5830,sign(m2_5830,skSess)));
                                            {7037}let Ksrv_5831: bitstring = exp(PartC_5828,Ns_5829) in
                                            {7038}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5831))
                                    )
                                    else
                                        {7039}let v_5832: bool = (Disco_5511 = C) in
                                        (
                                            {7040}if v_5832 then
                                            (
                                                {7041}let pkDisco_5833: bitstring = pub(skC) in
                                                {7042}in(c, (=pkCli_5813,m1_5834: bitstring,sigM1_5835: bitstring));
                                                {7043}if (verify(m1_5834,sigM1_5835,pkCli_5813) <> true) then
                                                    0
                                                else
                                                    {7044}let (=Sess_5512,SPc_5836: bitstring,PartC_5837: bitstring) = m1_5834 in
                                                    {7045}new Ns_5838: bitstring;
                                                    {7046}let m2_5839: bitstring = (Cli_5510,exp(g,Ns_5838)) in
                                                    {7047}out(c, (m2_5839,sign(m2_5839,skSess)));
                                                    {7048}let Ksrv_5840: bitstring = exp(PartC_5837,Ns_5838) in
                                                    {7049}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5840))
                                            )
                                            else
                                                {7050}let pkDisco_5841: bitstring = pub(skI) in
                                                {7051}in(c, (=pkCli_5813,m1_5842: bitstring,sigM1_5843: bitstring));
                                                {7052}if (verify(m1_5842,sigM1_5843,pkCli_5813) <> true) then
                                                    0
                                                else
                                                    {7053}let (=Sess_5512,SPc_5844: bitstring,PartC_5845: bitstring) = m1_5842 in
                                                    {7054}new Ns_5846: bitstring;
                                                    {7055}let m2_5847: bitstring = (Cli_5510,exp(g,Ns_5846)) in
                                                    {7056}out(c, (m2_5847,sign(m2_5847,skSess)));
                                                    {7057}let Ksrv_5848: bitstring = exp(PartC_5845,Ns_5846) in
                                                    {7058}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5848))
                                        )
                                        else
                                            {7059}let pkDisco_5849: bitstring = fail-any in
                                            {7060}in(c, (=pkCli_5813,m1_5850: bitstring,sigM1_5851: bitstring));
                                            {7061}if (verify(m1_5850,sigM1_5851,pkCli_5813) <> true) then
                                                0
                                            else
                                                {7062}let (=Sess_5512,SPc_5852: bitstring,PartC_5853: bitstring) = m1_5850 in
                                                {7063}new Ns_5854: bitstring;
                                                {7064}let m2_5855: bitstring = (Cli_5510,exp(g,Ns_5854)) in
                                                {7065}out(c, (m2_5855,sign(m2_5855,skSess)));
                                                {7066}let Ksrv_5856: bitstring = exp(PartC_5853,Ns_5854) in
                                                {7067}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5856))
                                )
                                else
                                    {7068}let pkDisco_5857: bitstring = fail-any in
                                    {7069}in(c, (=pkCli_5813,m1_5858: bitstring,sigM1_5859: bitstring));
                                    {7070}if (verify(m1_5858,sigM1_5859,pkCli_5813) <> true) then
                                        0
                                    else
                                        {7071}let (=Sess_5512,SPc_5860: bitstring,PartC_5861: bitstring) = m1_5858 in
                                        {7072}new Ns_5862: bitstring;
                                        {7073}let m2_5863: bitstring = (Cli_5510,exp(g,Ns_5862)) in
                                        {7074}out(c, (m2_5863,sign(m2_5863,skSess)));
                                        {7075}let Ksrv_5864: bitstring = exp(PartC_5861,Ns_5862) in
                                        {7076}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5864))
                        )
                        else
                            {7077}let pkDisco_5865: bitstring = fail-any in
                            {7078}in(c, (=pkCli_5813,m1_5866: bitstring,sigM1_5867: bitstring));
                            {7079}if (verify(m1_5866,sigM1_5867,pkCli_5813) <> true) then
                                0
                            else
                                {7080}let (=Sess_5512,SPc_5868: bitstring,PartC_5869: bitstring) = m1_5866 in
                                {7081}new Ns_5870: bitstring;
                                {7082}let m2_5871: bitstring = (Cli_5510,exp(g,Ns_5870)) in
                                {7083}out(c, (m2_5871,sign(m2_5871,skSess)));
                                {7084}let Ksrv_5872: bitstring = exp(PartC_5869,Ns_5870) in
                                {7085}out(c, senc(mSrv(pkCli_5813,pkSess_5514),Ksrv_5872))
            )
            else
                {7086}let pkCli_5873: bitstring = fail-any in
                {7087}let v_5874: bool = (Disco_5511 = A) in
                (
                    {7088}if v_5874 then
                    (
                        {7089}let pkDisco_5875: bitstring = pub(skA) in
                        {7090}in(c, (=pkCli_5873,m1_5876: bitstring,sigM1_5877: bitstring));
                        {7091}if (verify(m1_5876,sigM1_5877,pkCli_5873) <> true) then
                            0
                        else
                            {7092}let (=Sess_5512,SPc_5878: bitstring,PartC_5879: bitstring) = m1_5876 in
                            {7093}new Ns_5880: bitstring;
                            {7094}let m2_5881: bitstring = (Cli_5510,exp(g,Ns_5880)) in
                            {7095}out(c, (m2_5881,sign(m2_5881,skSess)));
                            {7096}let Ksrv_5882: bitstring = exp(PartC_5879,Ns_5880) in
                            {7097}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5882))
                    )
                    else
                        {7098}let v_5883: bool = (Disco_5511 = B) in
                        (
                            {7099}if v_5883 then
                            (
                                {7100}let pkDisco_5884: bitstring = pub(skB) in
                                {7101}in(c, (=pkCli_5873,m1_5885: bitstring,sigM1_5886: bitstring));
                                {7102}if (verify(m1_5885,sigM1_5886,pkCli_5873) <> true) then
                                    0
                                else
                                    {7103}let (=Sess_5512,SPc_5887: bitstring,PartC_5888: bitstring) = m1_5885 in
                                    {7104}new Ns_5889: bitstring;
                                    {7105}let m2_5890: bitstring = (Cli_5510,exp(g,Ns_5889)) in
                                    {7106}out(c, (m2_5890,sign(m2_5890,skSess)));
                                    {7107}let Ksrv_5891: bitstring = exp(PartC_5888,Ns_5889) in
                                    {7108}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5891))
                            )
                            else
                                {7109}let v_5892: bool = (Disco_5511 = C) in
                                (
                                    {7110}if v_5892 then
                                    (
                                        {7111}let pkDisco_5893: bitstring = pub(skC) in
                                        {7112}in(c, (=pkCli_5873,m1_5894: bitstring,sigM1_5895: bitstring));
                                        {7113}if (verify(m1_5894,sigM1_5895,pkCli_5873) <> true) then
                                            0
                                        else
                                            {7114}let (=Sess_5512,SPc_5896: bitstring,PartC_5897: bitstring) = m1_5894 in
                                            {7115}new Ns_5898: bitstring;
                                            {7116}let m2_5899: bitstring = (Cli_5510,exp(g,Ns_5898)) in
                                            {7117}out(c, (m2_5899,sign(m2_5899,skSess)));
                                            {7118}let Ksrv_5900: bitstring = exp(PartC_5897,Ns_5898) in
                                            {7119}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5900))
                                    )
                                    else
                                        {7120}let pkDisco_5901: bitstring = pub(skI) in
                                        {7121}in(c, (=pkCli_5873,m1_5902: bitstring,sigM1_5903: bitstring));
                                        {7122}if (verify(m1_5902,sigM1_5903,pkCli_5873) <> true) then
                                            0
                                        else
                                            {7123}let (=Sess_5512,SPc_5904: bitstring,PartC_5905: bitstring) = m1_5902 in
                                            {7124}new Ns_5906: bitstring;
                                            {7125}let m2_5907: bitstring = (Cli_5510,exp(g,Ns_5906)) in
                                            {7126}out(c, (m2_5907,sign(m2_5907,skSess)));
                                            {7127}let Ksrv_5908: bitstring = exp(PartC_5905,Ns_5906) in
                                            {7128}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5908))
                                )
                                else
                                    {7129}let pkDisco_5909: bitstring = fail-any in
                                    {7130}in(c, (=pkCli_5873,m1_5910: bitstring,sigM1_5911: bitstring));
                                    {7131}if (verify(m1_5910,sigM1_5911,pkCli_5873) <> true) then
                                        0
                                    else
                                        {7132}let (=Sess_5512,SPc_5912: bitstring,PartC_5913: bitstring) = m1_5910 in
                                        {7133}new Ns_5914: bitstring;
                                        {7134}let m2_5915: bitstring = (Cli_5510,exp(g,Ns_5914)) in
                                        {7135}out(c, (m2_5915,sign(m2_5915,skSess)));
                                        {7136}let Ksrv_5916: bitstring = exp(PartC_5913,Ns_5914) in
                                        {7137}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5916))
                        )
                        else
                            {7138}let pkDisco_5917: bitstring = fail-any in
                            {7139}in(c, (=pkCli_5873,m1_5918: bitstring,sigM1_5919: bitstring));
                            {7140}if (verify(m1_5918,sigM1_5919,pkCli_5873) <> true) then
                                0
                            else
                                {7141}let (=Sess_5512,SPc_5920: bitstring,PartC_5921: bitstring) = m1_5918 in
                                {7142}new Ns_5922: bitstring;
                                {7143}let m2_5923: bitstring = (Cli_5510,exp(g,Ns_5922)) in
                                {7144}out(c, (m2_5923,sign(m2_5923,skSess)));
                                {7145}let Ksrv_5924: bitstring = exp(PartC_5921,Ns_5922) in
                                {7146}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5924))
                )
                else
                    {7147}let pkDisco_5925: bitstring = fail-any in
                    {7148}in(c, (=pkCli_5873,m1_5926: bitstring,sigM1_5927: bitstring));
                    {7149}if (verify(m1_5926,sigM1_5927,pkCli_5873) <> true) then
                        0
                    else
                        {7150}let (=Sess_5512,SPc_5928: bitstring,PartC_5929: bitstring) = m1_5926 in
                        {7151}new Ns_5930: bitstring;
                        {7152}let m2_5931: bitstring = (Cli_5510,exp(g,Ns_5930)) in
                        {7153}out(c, (m2_5931,sign(m2_5931,skSess)));
                        {7154}let Ksrv_5932: bitstring = exp(PartC_5929,Ns_5930) in
                        {7155}out(c, senc(mSrv(pkCli_5873,pkSess_5514),Ksrv_5932))
        )
        else
            {7156}let v_5933: bool = (Sess_5512 = B) in
            (
                {7157}if v_5933 then
                (
                    {7158}let skSess_5934: bitstring = skB in
                    {7159}let pkSess_5935: bitstring = pub(skSess_5934) in
                    {7160}let v_5936: bool = (Cli_5510 = A) in
                    (
                        {7161}if v_5936 then
                        (
                            {7162}let pkCli_5937: bitstring = pub(skA) in
                            {7163}let v_5938: bool = (Disco_5511 = A) in
                            (
                                {7164}if v_5938 then
                                (
                                    {7165}let pkDisco_5939: bitstring = pub(skA) in
                                    {7166}in(c, (=pkCli_5937,m1_5940: bitstring,sigM1_5941: bitstring));
                                    {7167}if (verify(m1_5940,sigM1_5941,pkCli_5937) <> true) then
                                        0
                                    else
                                        {7168}let (=Sess_5512,SPc_5942: bitstring,PartC_5943: bitstring) = m1_5940 in
                                        {7169}new Ns_5944: bitstring;
                                        {7170}let m2_5945: bitstring = (Cli_5510,exp(g,Ns_5944)) in
                                        {7171}out(c, (m2_5945,sign(m2_5945,skSess_5934)));
                                        {7172}let Ksrv_5946: bitstring = exp(PartC_5943,Ns_5944) in
                                        {7173}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5946))
                                )
                                else
                                    {7174}let v_5947: bool = (Disco_5511 = B) in
                                    (
                                        {7175}if v_5947 then
                                        (
                                            {7176}let pkDisco_5948: bitstring = pub(skB) in
                                            {7177}in(c, (=pkCli_5937,m1_5949: bitstring,sigM1_5950: bitstring));
                                            {7178}if (verify(m1_5949,sigM1_5950,pkCli_5937) <> true) then
                                                0
                                            else
                                                {7179}let (=Sess_5512,SPc_5951: bitstring,PartC_5952: bitstring) = m1_5949 in
                                                {7180}new Ns_5953: bitstring;
                                                {7181}let m2_5954: bitstring = (Cli_5510,exp(g,Ns_5953)) in
                                                {7182}out(c, (m2_5954,sign(m2_5954,skSess_5934)));
                                                {7183}let Ksrv_5955: bitstring = exp(PartC_5952,Ns_5953) in
                                                {7184}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5955))
                                        )
                                        else
                                            {7185}let v_5956: bool = (Disco_5511 = C) in
                                            (
                                                {7186}if v_5956 then
                                                (
                                                    {7187}let pkDisco_5957: bitstring = pub(skC) in
                                                    {7188}in(c, (=pkCli_5937,m1_5958: bitstring,sigM1_5959: bitstring));
                                                    {7189}if (verify(m1_5958,sigM1_5959,pkCli_5937) <> true) then
                                                        0
                                                    else
                                                        {7190}let (=Sess_5512,SPc_5960: bitstring,PartC_5961: bitstring) = m1_5958 in
                                                        {7191}new Ns_5962: bitstring;
                                                        {7192}let m2_5963: bitstring = (Cli_5510,exp(g,Ns_5962)) in
                                                        {7193}out(c, (m2_5963,sign(m2_5963,skSess_5934)));
                                                        {7194}let Ksrv_5964: bitstring = exp(PartC_5961,Ns_5962) in
                                                        {7195}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5964))
                                                )
                                                else
                                                    {7196}let pkDisco_5965: bitstring = pub(skI) in
                                                    {7197}in(c, (=pkCli_5937,m1_5966: bitstring,sigM1_5967: bitstring));
                                                    {7198}if (verify(m1_5966,sigM1_5967,pkCli_5937) <> true) then
                                                        0
                                                    else
                                                        {7199}let (=Sess_5512,SPc_5968: bitstring,PartC_5969: bitstring) = m1_5966 in
                                                        {7200}new Ns_5970: bitstring;
                                                        {7201}let m2_5971: bitstring = (Cli_5510,exp(g,Ns_5970)) in
                                                        {7202}out(c, (m2_5971,sign(m2_5971,skSess_5934)));
                                                        {7203}let Ksrv_5972: bitstring = exp(PartC_5969,Ns_5970) in
                                                        {7204}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5972))
                                            )
                                            else
                                                {7205}let pkDisco_5973: bitstring = fail-any in
                                                {7206}in(c, (=pkCli_5937,m1_5974: bitstring,sigM1_5975: bitstring));
                                                {7207}if (verify(m1_5974,sigM1_5975,pkCli_5937) <> true) then
                                                    0
                                                else
                                                    {7208}let (=Sess_5512,SPc_5976: bitstring,PartC_5977: bitstring) = m1_5974 in
                                                    {7209}new Ns_5978: bitstring;
                                                    {7210}let m2_5979: bitstring = (Cli_5510,exp(g,Ns_5978)) in
                                                    {7211}out(c, (m2_5979,sign(m2_5979,skSess_5934)));
                                                    {7212}let Ksrv_5980: bitstring = exp(PartC_5977,Ns_5978) in
                                                    {7213}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5980))
                                    )
                                    else
                                        {7214}let pkDisco_5981: bitstring = fail-any in
                                        {7215}in(c, (=pkCli_5937,m1_5982: bitstring,sigM1_5983: bitstring));
                                        {7216}if (verify(m1_5982,sigM1_5983,pkCli_5937) <> true) then
                                            0
                                        else
                                            {7217}let (=Sess_5512,SPc_5984: bitstring,PartC_5985: bitstring) = m1_5982 in
                                            {7218}new Ns_5986: bitstring;
                                            {7219}let m2_5987: bitstring = (Cli_5510,exp(g,Ns_5986)) in
                                            {7220}out(c, (m2_5987,sign(m2_5987,skSess_5934)));
                                            {7221}let Ksrv_5988: bitstring = exp(PartC_5985,Ns_5986) in
                                            {7222}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5988))
                            )
                            else
                                {7223}let pkDisco_5989: bitstring = fail-any in
                                {7224}in(c, (=pkCli_5937,m1_5990: bitstring,sigM1_5991: bitstring));
                                {7225}if (verify(m1_5990,sigM1_5991,pkCli_5937) <> true) then
                                    0
                                else
                                    {7226}let (=Sess_5512,SPc_5992: bitstring,PartC_5993: bitstring) = m1_5990 in
                                    {7227}new Ns_5994: bitstring;
                                    {7228}let m2_5995: bitstring = (Cli_5510,exp(g,Ns_5994)) in
                                    {7229}out(c, (m2_5995,sign(m2_5995,skSess_5934)));
                                    {7230}let Ksrv_5996: bitstring = exp(PartC_5993,Ns_5994) in
                                    {7231}out(c, senc(mSrv(pkCli_5937,pkSess_5935),Ksrv_5996))
                        )
                        else
                            {7232}let v_5997: bool = (Cli_5510 = B) in
                            (
                                {7233}if v_5997 then
                                (
                                    {7234}let pkCli_5998: bitstring = pub(skB) in
                                    {7235}let v_5999: bool = (Disco_5511 = A) in
                                    (
                                        {7236}if v_5999 then
                                        (
                                            {7237}let pkDisco_6000: bitstring = pub(skA) in
                                            {7238}in(c, (=pkCli_5998,m1_6001: bitstring,sigM1_6002: bitstring));
                                            {7239}if (verify(m1_6001,sigM1_6002,pkCli_5998) <> true) then
                                                0
                                            else
                                                {7240}let (=Sess_5512,SPc_6003: bitstring,PartC_6004: bitstring) = m1_6001 in
                                                {7241}new Ns_6005: bitstring;
                                                {7242}let m2_6006: bitstring = (Cli_5510,exp(g,Ns_6005)) in
                                                {7243}out(c, (m2_6006,sign(m2_6006,skSess_5934)));
                                                {7244}let Ksrv_6007: bitstring = exp(PartC_6004,Ns_6005) in
                                                {7245}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6007))
                                        )
                                        else
                                            {7246}let v_6008: bool = (Disco_5511 = B) in
                                            (
                                                {7247}if v_6008 then
                                                (
                                                    {7248}let pkDisco_6009: bitstring = pub(skB) in
                                                    {7249}in(c, (=pkCli_5998,m1_6010: bitstring,sigM1_6011: bitstring));
                                                    {7250}if (verify(m1_6010,sigM1_6011,pkCli_5998) <> true) then
                                                        0
                                                    else
                                                        {7251}let (=Sess_5512,SPc_6012: bitstring,PartC_6013: bitstring) = m1_6010 in
                                                        {7252}new Ns_6014: bitstring;
                                                        {7253}let m2_6015: bitstring = (Cli_5510,exp(g,Ns_6014)) in
                                                        {7254}out(c, (m2_6015,sign(m2_6015,skSess_5934)));
                                                        {7255}let Ksrv_6016: bitstring = exp(PartC_6013,Ns_6014) in
                                                        {7256}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6016))
                                                )
                                                else
                                                    {7257}let v_6017: bool = (Disco_5511 = C) in
                                                    (
                                                        {7258}if v_6017 then
                                                        (
                                                            {7259}let pkDisco_6018: bitstring = pub(skC) in
                                                            {7260}in(c, (=pkCli_5998,m1_6019: bitstring,sigM1_6020: bitstring));
                                                            {7261}if (verify(m1_6019,sigM1_6020,pkCli_5998) <> true) then
                                                                0
                                                            else
                                                                {7262}let (=Sess_5512,SPc_6021: bitstring,PartC_6022: bitstring) = m1_6019 in
                                                                {7263}new Ns_6023: bitstring;
                                                                {7264}let m2_6024: bitstring = (Cli_5510,exp(g,Ns_6023)) in
                                                                {7265}out(c, (m2_6024,sign(m2_6024,skSess_5934)));
                                                                {7266}let Ksrv_6025: bitstring = exp(PartC_6022,Ns_6023) in
                                                                {7267}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6025))
                                                        )
                                                        else
                                                            {7268}let pkDisco_6026: bitstring = pub(skI) in
                                                            {7269}in(c, (=pkCli_5998,m1_6027: bitstring,sigM1_6028: bitstring));
                                                            {7270}if (verify(m1_6027,sigM1_6028,pkCli_5998) <> true) then
                                                                0
                                                            else
                                                                {7271}let (=Sess_5512,SPc_6029: bitstring,PartC_6030: bitstring) = m1_6027 in
                                                                {7272}new Ns_6031: bitstring;
                                                                {7273}let m2_6032: bitstring = (Cli_5510,exp(g,Ns_6031)) in
                                                                {7274}out(c, (m2_6032,sign(m2_6032,skSess_5934)));
                                                                {7275}let Ksrv_6033: bitstring = exp(PartC_6030,Ns_6031) in
                                                                {7276}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6033))
                                                    )
                                                    else
                                                        {7277}let pkDisco_6034: bitstring = fail-any in
                                                        {7278}in(c, (=pkCli_5998,m1_6035: bitstring,sigM1_6036: bitstring));
                                                        {7279}if (verify(m1_6035,sigM1_6036,pkCli_5998) <> true) then
                                                            0
                                                        else
                                                            {7280}let (=Sess_5512,SPc_6037: bitstring,PartC_6038: bitstring) = m1_6035 in
                                                            {7281}new Ns_6039: bitstring;
                                                            {7282}let m2_6040: bitstring = (Cli_5510,exp(g,Ns_6039)) in
                                                            {7283}out(c, (m2_6040,sign(m2_6040,skSess_5934)));
                                                            {7284}let Ksrv_6041: bitstring = exp(PartC_6038,Ns_6039) in
                                                            {7285}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6041))
                                            )
                                            else
                                                {7286}let pkDisco_6042: bitstring = fail-any in
                                                {7287}in(c, (=pkCli_5998,m1_6043: bitstring,sigM1_6044: bitstring));
                                                {7288}if (verify(m1_6043,sigM1_6044,pkCli_5998) <> true) then
                                                    0
                                                else
                                                    {7289}let (=Sess_5512,SPc_6045: bitstring,PartC_6046: bitstring) = m1_6043 in
                                                    {7290}new Ns_6047: bitstring;
                                                    {7291}let m2_6048: bitstring = (Cli_5510,exp(g,Ns_6047)) in
                                                    {7292}out(c, (m2_6048,sign(m2_6048,skSess_5934)));
                                                    {7293}let Ksrv_6049: bitstring = exp(PartC_6046,Ns_6047) in
                                                    {7294}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6049))
                                    )
                                    else
                                        {7295}let pkDisco_6050: bitstring = fail-any in
                                        {7296}in(c, (=pkCli_5998,m1_6051: bitstring,sigM1_6052: bitstring));
                                        {7297}if (verify(m1_6051,sigM1_6052,pkCli_5998) <> true) then
                                            0
                                        else
                                            {7298}let (=Sess_5512,SPc_6053: bitstring,PartC_6054: bitstring) = m1_6051 in
                                            {7299}new Ns_6055: bitstring;
                                            {7300}let m2_6056: bitstring = (Cli_5510,exp(g,Ns_6055)) in
                                            {7301}out(c, (m2_6056,sign(m2_6056,skSess_5934)));
                                            {7302}let Ksrv_6057: bitstring = exp(PartC_6054,Ns_6055) in
                                            {7303}out(c, senc(mSrv(pkCli_5998,pkSess_5935),Ksrv_6057))
                                )
                                else
                                    {7304}let v_6058: bool = (Cli_5510 = C) in
                                    (
                                        {7305}if v_6058 then
                                        (
                                            {7306}let pkCli_6059: bitstring = pub(skC) in
                                            {7307}let v_6060: bool = (Disco_5511 = A) in
                                            (
                                                {7308}if v_6060 then
                                                (
                                                    {7309}let pkDisco_6061: bitstring = pub(skA) in
                                                    {7310}in(c, (=pkCli_6059,m1_6062: bitstring,sigM1_6063: bitstring));
                                                    {7311}if (verify(m1_6062,sigM1_6063,pkCli_6059) <> true) then
                                                        0
                                                    else
                                                        {7312}let (=Sess_5512,SPc_6064: bitstring,PartC_6065: bitstring) = m1_6062 in
                                                        {7313}new Ns_6066: bitstring;
                                                        {7314}let m2_6067: bitstring = (Cli_5510,exp(g,Ns_6066)) in
                                                        {7315}out(c, (m2_6067,sign(m2_6067,skSess_5934)));
                                                        {7316}let Ksrv_6068: bitstring = exp(PartC_6065,Ns_6066) in
                                                        {7317}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6068))
                                                )
                                                else
                                                    {7318}let v_6069: bool = (Disco_5511 = B) in
                                                    (
                                                        {7319}if v_6069 then
                                                        (
                                                            {7320}let pkDisco_6070: bitstring = pub(skB) in
                                                            {7321}in(c, (=pkCli_6059,m1_6071: bitstring,sigM1_6072: bitstring));
                                                            {7322}if (verify(m1_6071,sigM1_6072,pkCli_6059) <> true) then
                                                                0
                                                            else
                                                                {7323}let (=Sess_5512,SPc_6073: bitstring,PartC_6074: bitstring) = m1_6071 in
                                                                {7324}new Ns_6075: bitstring;
                                                                {7325}let m2_6076: bitstring = (Cli_5510,exp(g,Ns_6075)) in
                                                                {7326}out(c, (m2_6076,sign(m2_6076,skSess_5934)));
                                                                {7327}let Ksrv_6077: bitstring = exp(PartC_6074,Ns_6075) in
                                                                {7328}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6077))
                                                        )
                                                        else
                                                            {7329}let v_6078: bool = (Disco_5511 = C) in
                                                            (
                                                                {7330}if v_6078 then
                                                                (
                                                                    {7331}let pkDisco_6079: bitstring = pub(skC) in
                                                                    {7332}in(c, (=pkCli_6059,m1_6080: bitstring,sigM1_6081: bitstring));
                                                                    {7333}if (verify(m1_6080,sigM1_6081,pkCli_6059) <> true) then
                                                                        0
                                                                    else
                                                                        {7334}let (=Sess_5512,SPc_6082: bitstring,PartC_6083: bitstring) = m1_6080 in
                                                                        {7335}new Ns_6084: bitstring;
                                                                        {7336}let m2_6085: bitstring = (Cli_5510,exp(g,Ns_6084)) in
                                                                        {7337}out(c, (m2_6085,sign(m2_6085,skSess_5934)));
                                                                        {7338}let Ksrv_6086: bitstring = exp(PartC_6083,Ns_6084) in
                                                                        {7339}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6086))
                                                                )
                                                                else
                                                                    {7340}let pkDisco_6087: bitstring = pub(skI) in
                                                                    {7341}in(c, (=pkCli_6059,m1_6088: bitstring,sigM1_6089: bitstring));
                                                                    {7342}if (verify(m1_6088,sigM1_6089,pkCli_6059) <> true) then
                                                                        0
                                                                    else
                                                                        {7343}let (=Sess_5512,SPc_6090: bitstring,PartC_6091: bitstring) = m1_6088 in
                                                                        {7344}new Ns_6092: bitstring;
                                                                        {7345}let m2_6093: bitstring = (Cli_5510,exp(g,Ns_6092)) in
                                                                        {7346}out(c, (m2_6093,sign(m2_6093,skSess_5934)));
                                                                        {7347}let Ksrv_6094: bitstring = exp(PartC_6091,Ns_6092) in
                                                                        {7348}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6094))
                                                            )
                                                            else
                                                                {7349}let pkDisco_6095: bitstring = fail-any in
                                                                {7350}in(c, (=pkCli_6059,m1_6096: bitstring,sigM1_6097: bitstring));
                                                                {7351}if (verify(m1_6096,sigM1_6097,pkCli_6059) <> true) then
                                                                    0
                                                                else
                                                                    {7352}let (=Sess_5512,SPc_6098: bitstring,PartC_6099: bitstring) = m1_6096 in
                                                                    {7353}new Ns_6100: bitstring;
                                                                    {7354}let m2_6101: bitstring = (Cli_5510,exp(g,Ns_6100)) in
                                                                    {7355}out(c, (m2_6101,sign(m2_6101,skSess_5934)));
                                                                    {7356}let Ksrv_6102: bitstring = exp(PartC_6099,Ns_6100) in
                                                                    {7357}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6102))
                                                    )
                                                    else
                                                        {7358}let pkDisco_6103: bitstring = fail-any in
                                                        {7359}in(c, (=pkCli_6059,m1_6104: bitstring,sigM1_6105: bitstring));
                                                        {7360}if (verify(m1_6104,sigM1_6105,pkCli_6059) <> true) then
                                                            0
                                                        else
                                                            {7361}let (=Sess_5512,SPc_6106: bitstring,PartC_6107: bitstring) = m1_6104 in
                                                            {7362}new Ns_6108: bitstring;
                                                            {7363}let m2_6109: bitstring = (Cli_5510,exp(g,Ns_6108)) in
                                                            {7364}out(c, (m2_6109,sign(m2_6109,skSess_5934)));
                                                            {7365}let Ksrv_6110: bitstring = exp(PartC_6107,Ns_6108) in
                                                            {7366}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6110))
                                            )
                                            else
                                                {7367}let pkDisco_6111: bitstring = fail-any in
                                                {7368}in(c, (=pkCli_6059,m1_6112: bitstring,sigM1_6113: bitstring));
                                                {7369}if (verify(m1_6112,sigM1_6113,pkCli_6059) <> true) then
                                                    0
                                                else
                                                    {7370}let (=Sess_5512,SPc_6114: bitstring,PartC_6115: bitstring) = m1_6112 in
                                                    {7371}new Ns_6116: bitstring;
                                                    {7372}let m2_6117: bitstring = (Cli_5510,exp(g,Ns_6116)) in
                                                    {7373}out(c, (m2_6117,sign(m2_6117,skSess_5934)));
                                                    {7374}let Ksrv_6118: bitstring = exp(PartC_6115,Ns_6116) in
                                                    {7375}out(c, senc(mSrv(pkCli_6059,pkSess_5935),Ksrv_6118))
                                        )
                                        else
                                            {7376}let pkCli_6119: bitstring = pub(skI) in
                                            {7377}let v_6120: bool = (Disco_5511 = A) in
                                            (
                                                {7378}if v_6120 then
                                                (
                                                    {7379}let pkDisco_6121: bitstring = pub(skA) in
                                                    {7380}in(c, (=pkCli_6119,m1_6122: bitstring,sigM1_6123: bitstring));
                                                    {7381}if (verify(m1_6122,sigM1_6123,pkCli_6119) <> true) then
                                                        0
                                                    else
                                                        {7382}let (=Sess_5512,SPc_6124: bitstring,PartC_6125: bitstring) = m1_6122 in
                                                        {7383}new Ns_6126: bitstring;
                                                        {7384}let m2_6127: bitstring = (Cli_5510,exp(g,Ns_6126)) in
                                                        {7385}out(c, (m2_6127,sign(m2_6127,skSess_5934)));
                                                        {7386}let Ksrv_6128: bitstring = exp(PartC_6125,Ns_6126) in
                                                        {7387}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6128))
                                                )
                                                else
                                                    {7388}let v_6129: bool = (Disco_5511 = B) in
                                                    (
                                                        {7389}if v_6129 then
                                                        (
                                                            {7390}let pkDisco_6130: bitstring = pub(skB) in
                                                            {7391}in(c, (=pkCli_6119,m1_6131: bitstring,sigM1_6132: bitstring));
                                                            {7392}if (verify(m1_6131,sigM1_6132,pkCli_6119) <> true) then
                                                                0
                                                            else
                                                                {7393}let (=Sess_5512,SPc_6133: bitstring,PartC_6134: bitstring) = m1_6131 in
                                                                {7394}new Ns_6135: bitstring;
                                                                {7395}let m2_6136: bitstring = (Cli_5510,exp(g,Ns_6135)) in
                                                                {7396}out(c, (m2_6136,sign(m2_6136,skSess_5934)));
                                                                {7397}let Ksrv_6137: bitstring = exp(PartC_6134,Ns_6135) in
                                                                {7398}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6137))
                                                        )
                                                        else
                                                            {7399}let v_6138: bool = (Disco_5511 = C) in
                                                            (
                                                                {7400}if v_6138 then
                                                                (
                                                                    {7401}let pkDisco_6139: bitstring = pub(skC) in
                                                                    {7402}in(c, (=pkCli_6119,m1_6140: bitstring,sigM1_6141: bitstring));
                                                                    {7403}if (verify(m1_6140,sigM1_6141,pkCli_6119) <> true) then
                                                                        0
                                                                    else
                                                                        {7404}let (=Sess_5512,SPc_6142: bitstring,PartC_6143: bitstring) = m1_6140 in
                                                                        {7405}new Ns_6144: bitstring;
                                                                        {7406}let m2_6145: bitstring = (Cli_5510,exp(g,Ns_6144)) in
                                                                        {7407}out(c, (m2_6145,sign(m2_6145,skSess_5934)));
                                                                        {7408}let Ksrv_6146: bitstring = exp(PartC_6143,Ns_6144) in
                                                                        {7409}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6146))
                                                                )
                                                                else
                                                                    {7410}let pkDisco_6147: bitstring = pub(skI) in
                                                                    {7411}in(c, (=pkCli_6119,m1_6148: bitstring,sigM1_6149: bitstring));
                                                                    {7412}if (verify(m1_6148,sigM1_6149,pkCli_6119) <> true) then
                                                                        0
                                                                    else
                                                                        {7413}let (=Sess_5512,SPc_6150: bitstring,PartC_6151: bitstring) = m1_6148 in
                                                                        {7414}new Ns_6152: bitstring;
                                                                        {7415}let m2_6153: bitstring = (Cli_5510,exp(g,Ns_6152)) in
                                                                        {7416}out(c, (m2_6153,sign(m2_6153,skSess_5934)));
                                                                        {7417}let Ksrv_6154: bitstring = exp(PartC_6151,Ns_6152) in
                                                                        {7418}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6154))
                                                            )
                                                            else
                                                                {7419}let pkDisco_6155: bitstring = fail-any in
                                                                {7420}in(c, (=pkCli_6119,m1_6156: bitstring,sigM1_6157: bitstring));
                                                                {7421}if (verify(m1_6156,sigM1_6157,pkCli_6119) <> true) then
                                                                    0
                                                                else
                                                                    {7422}let (=Sess_5512,SPc_6158: bitstring,PartC_6159: bitstring) = m1_6156 in
                                                                    {7423}new Ns_6160: bitstring;
                                                                    {7424}let m2_6161: bitstring = (Cli_5510,exp(g,Ns_6160)) in
                                                                    {7425}out(c, (m2_6161,sign(m2_6161,skSess_5934)));
                                                                    {7426}let Ksrv_6162: bitstring = exp(PartC_6159,Ns_6160) in
                                                                    {7427}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6162))
                                                    )
                                                    else
                                                        {7428}let pkDisco_6163: bitstring = fail-any in
                                                        {7429}in(c, (=pkCli_6119,m1_6164: bitstring,sigM1_6165: bitstring));
                                                        {7430}if (verify(m1_6164,sigM1_6165,pkCli_6119) <> true) then
                                                            0
                                                        else
                                                            {7431}let (=Sess_5512,SPc_6166: bitstring,PartC_6167: bitstring) = m1_6164 in
                                                            {7432}new Ns_6168: bitstring;
                                                            {7433}let m2_6169: bitstring = (Cli_5510,exp(g,Ns_6168)) in
                                                            {7434}out(c, (m2_6169,sign(m2_6169,skSess_5934)));
                                                            {7435}let Ksrv_6170: bitstring = exp(PartC_6167,Ns_6168) in
                                                            {7436}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6170))
                                            )
                                            else
                                                {7437}let pkDisco_6171: bitstring = fail-any in
                                                {7438}in(c, (=pkCli_6119,m1_6172: bitstring,sigM1_6173: bitstring));
                                                {7439}if (verify(m1_6172,sigM1_6173,pkCli_6119) <> true) then
                                                    0
                                                else
                                                    {7440}let (=Sess_5512,SPc_6174: bitstring,PartC_6175: bitstring) = m1_6172 in
                                                    {7441}new Ns_6176: bitstring;
                                                    {7442}let m2_6177: bitstring = (Cli_5510,exp(g,Ns_6176)) in
                                                    {7443}out(c, (m2_6177,sign(m2_6177,skSess_5934)));
                                                    {7444}let Ksrv_6178: bitstring = exp(PartC_6175,Ns_6176) in
                                                    {7445}out(c, senc(mSrv(pkCli_6119,pkSess_5935),Ksrv_6178))
                                    )
                                    else
                                        {7446}let pkCli_6179: bitstring = fail-any in
                                        {7447}let v_6180: bool = (Disco_5511 = A) in
                                        (
                                            {7448}if v_6180 then
                                            (
                                                {7449}let pkDisco_6181: bitstring = pub(skA) in
                                                {7450}in(c, (=pkCli_6179,m1_6182: bitstring,sigM1_6183: bitstring));
                                                {7451}if (verify(m1_6182,sigM1_6183,pkCli_6179) <> true) then
                                                    0
                                                else
                                                    {7452}let (=Sess_5512,SPc_6184: bitstring,PartC_6185: bitstring) = m1_6182 in
                                                    {7453}new Ns_6186: bitstring;
                                                    {7454}let m2_6187: bitstring = (Cli_5510,exp(g,Ns_6186)) in
                                                    {7455}out(c, (m2_6187,sign(m2_6187,skSess_5934)));
                                                    {7456}let Ksrv_6188: bitstring = exp(PartC_6185,Ns_6186) in
                                                    {7457}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6188))
                                            )
                                            else
                                                {7458}let v_6189: bool = (Disco_5511 = B) in
                                                (
                                                    {7459}if v_6189 then
                                                    (
                                                        {7460}let pkDisco_6190: bitstring = pub(skB) in
                                                        {7461}in(c, (=pkCli_6179,m1_6191: bitstring,sigM1_6192: bitstring));
                                                        {7462}if (verify(m1_6191,sigM1_6192,pkCli_6179) <> true) then
                                                            0
                                                        else
                                                            {7463}let (=Sess_5512,SPc_6193: bitstring,PartC_6194: bitstring) = m1_6191 in
                                                            {7464}new Ns_6195: bitstring;
                                                            {7465}let m2_6196: bitstring = (Cli_5510,exp(g,Ns_6195)) in
                                                            {7466}out(c, (m2_6196,sign(m2_6196,skSess_5934)));
                                                            {7467}let Ksrv_6197: bitstring = exp(PartC_6194,Ns_6195) in
                                                            {7468}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6197))
                                                    )
                                                    else
                                                        {7469}let v_6198: bool = (Disco_5511 = C) in
                                                        (
                                                            {7470}if v_6198 then
                                                            (
                                                                {7471}let pkDisco_6199: bitstring = pub(skC) in
                                                                {7472}in(c, (=pkCli_6179,m1_6200: bitstring,sigM1_6201: bitstring));
                                                                {7473}if (verify(m1_6200,sigM1_6201,pkCli_6179) <> true) then
                                                                    0
                                                                else
                                                                    {7474}let (=Sess_5512,SPc_6202: bitstring,PartC_6203: bitstring) = m1_6200 in
                                                                    {7475}new Ns_6204: bitstring;
                                                                    {7476}let m2_6205: bitstring = (Cli_5510,exp(g,Ns_6204)) in
                                                                    {7477}out(c, (m2_6205,sign(m2_6205,skSess_5934)));
                                                                    {7478}let Ksrv_6206: bitstring = exp(PartC_6203,Ns_6204) in
                                                                    {7479}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6206))
                                                            )
                                                            else
                                                                {7480}let pkDisco_6207: bitstring = pub(skI) in
                                                                {7481}in(c, (=pkCli_6179,m1_6208: bitstring,sigM1_6209: bitstring));
                                                                {7482}if (verify(m1_6208,sigM1_6209,pkCli_6179) <> true) then
                                                                    0
                                                                else
                                                                    {7483}let (=Sess_5512,SPc_6210: bitstring,PartC_6211: bitstring) = m1_6208 in
                                                                    {7484}new Ns_6212: bitstring;
                                                                    {7485}let m2_6213: bitstring = (Cli_5510,exp(g,Ns_6212)) in
                                                                    {7486}out(c, (m2_6213,sign(m2_6213,skSess_5934)));
                                                                    {7487}let Ksrv_6214: bitstring = exp(PartC_6211,Ns_6212) in
                                                                    {7488}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6214))
                                                        )
                                                        else
                                                            {7489}let pkDisco_6215: bitstring = fail-any in
                                                            {7490}in(c, (=pkCli_6179,m1_6216: bitstring,sigM1_6217: bitstring));
                                                            {7491}if (verify(m1_6216,sigM1_6217,pkCli_6179) <> true) then
                                                                0
                                                            else
                                                                {7492}let (=Sess_5512,SPc_6218: bitstring,PartC_6219: bitstring) = m1_6216 in
                                                                {7493}new Ns_6220: bitstring;
                                                                {7494}let m2_6221: bitstring = (Cli_5510,exp(g,Ns_6220)) in
                                                                {7495}out(c, (m2_6221,sign(m2_6221,skSess_5934)));
                                                                {7496}let Ksrv_6222: bitstring = exp(PartC_6219,Ns_6220) in
                                                                {7497}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6222))
                                                )
                                                else
                                                    {7498}let pkDisco_6223: bitstring = fail-any in
                                                    {7499}in(c, (=pkCli_6179,m1_6224: bitstring,sigM1_6225: bitstring));
                                                    {7500}if (verify(m1_6224,sigM1_6225,pkCli_6179) <> true) then
                                                        0
                                                    else
                                                        {7501}let (=Sess_5512,SPc_6226: bitstring,PartC_6227: bitstring) = m1_6224 in
                                                        {7502}new Ns_6228: bitstring;
                                                        {7503}let m2_6229: bitstring = (Cli_5510,exp(g,Ns_6228)) in
                                                        {7504}out(c, (m2_6229,sign(m2_6229,skSess_5934)));
                                                        {7505}let Ksrv_6230: bitstring = exp(PartC_6227,Ns_6228) in
                                                        {7506}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6230))
                                        )
                                        else
                                            {7507}let pkDisco_6231: bitstring = fail-any in
                                            {7508}in(c, (=pkCli_6179,m1_6232: bitstring,sigM1_6233: bitstring));
                                            {7509}if (verify(m1_6232,sigM1_6233,pkCli_6179) <> true) then
                                                0
                                            else
                                                {7510}let (=Sess_5512,SPc_6234: bitstring,PartC_6235: bitstring) = m1_6232 in
                                                {7511}new Ns_6236: bitstring;
                                                {7512}let m2_6237: bitstring = (Cli_5510,exp(g,Ns_6236)) in
                                                {7513}out(c, (m2_6237,sign(m2_6237,skSess_5934)));
                                                {7514}let Ksrv_6238: bitstring = exp(PartC_6235,Ns_6236) in
                                                {7515}out(c, senc(mSrv(pkCli_6179,pkSess_5935),Ksrv_6238))
                            )
                            else
                                {7516}let pkCli_6239: bitstring = fail-any in
                                {7517}let v_6240: bool = (Disco_5511 = A) in
                                (
                                    {7518}if v_6240 then
                                    (
                                        {7519}let pkDisco_6241: bitstring = pub(skA) in
                                        {7520}in(c, (=pkCli_6239,m1_6242: bitstring,sigM1_6243: bitstring));
                                        {7521}if (verify(m1_6242,sigM1_6243,pkCli_6239) <> true) then
                                            0
                                        else
                                            {7522}let (=Sess_5512,SPc_6244: bitstring,PartC_6245: bitstring) = m1_6242 in
                                            {7523}new Ns_6246: bitstring;
                                            {7524}let m2_6247: bitstring = (Cli_5510,exp(g,Ns_6246)) in
                                            {7525}out(c, (m2_6247,sign(m2_6247,skSess_5934)));
                                            {7526}let Ksrv_6248: bitstring = exp(PartC_6245,Ns_6246) in
                                            {7527}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6248))
                                    )
                                    else
                                        {7528}let v_6249: bool = (Disco_5511 = B) in
                                        (
                                            {7529}if v_6249 then
                                            (
                                                {7530}let pkDisco_6250: bitstring = pub(skB) in
                                                {7531}in(c, (=pkCli_6239,m1_6251: bitstring,sigM1_6252: bitstring));
                                                {7532}if (verify(m1_6251,sigM1_6252,pkCli_6239) <> true) then
                                                    0
                                                else
                                                    {7533}let (=Sess_5512,SPc_6253: bitstring,PartC_6254: bitstring) = m1_6251 in
                                                    {7534}new Ns_6255: bitstring;
                                                    {7535}let m2_6256: bitstring = (Cli_5510,exp(g,Ns_6255)) in
                                                    {7536}out(c, (m2_6256,sign(m2_6256,skSess_5934)));
                                                    {7537}let Ksrv_6257: bitstring = exp(PartC_6254,Ns_6255) in
                                                    {7538}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6257))
                                            )
                                            else
                                                {7539}let v_6258: bool = (Disco_5511 = C) in
                                                (
                                                    {7540}if v_6258 then
                                                    (
                                                        {7541}let pkDisco_6259: bitstring = pub(skC) in
                                                        {7542}in(c, (=pkCli_6239,m1_6260: bitstring,sigM1_6261: bitstring));
                                                        {7543}if (verify(m1_6260,sigM1_6261,pkCli_6239) <> true) then
                                                            0
                                                        else
                                                            {7544}let (=Sess_5512,SPc_6262: bitstring,PartC_6263: bitstring) = m1_6260 in
                                                            {7545}new Ns_6264: bitstring;
                                                            {7546}let m2_6265: bitstring = (Cli_5510,exp(g,Ns_6264)) in
                                                            {7547}out(c, (m2_6265,sign(m2_6265,skSess_5934)));
                                                            {7548}let Ksrv_6266: bitstring = exp(PartC_6263,Ns_6264) in
                                                            {7549}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6266))
                                                    )
                                                    else
                                                        {7550}let pkDisco_6267: bitstring = pub(skI) in
                                                        {7551}in(c, (=pkCli_6239,m1_6268: bitstring,sigM1_6269: bitstring));
                                                        {7552}if (verify(m1_6268,sigM1_6269,pkCli_6239) <> true) then
                                                            0
                                                        else
                                                            {7553}let (=Sess_5512,SPc_6270: bitstring,PartC_6271: bitstring) = m1_6268 in
                                                            {7554}new Ns_6272: bitstring;
                                                            {7555}let m2_6273: bitstring = (Cli_5510,exp(g,Ns_6272)) in
                                                            {7556}out(c, (m2_6273,sign(m2_6273,skSess_5934)));
                                                            {7557}let Ksrv_6274: bitstring = exp(PartC_6271,Ns_6272) in
                                                            {7558}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6274))
                                                )
                                                else
                                                    {7559}let pkDisco_6275: bitstring = fail-any in
                                                    {7560}in(c, (=pkCli_6239,m1_6276: bitstring,sigM1_6277: bitstring));
                                                    {7561}if (verify(m1_6276,sigM1_6277,pkCli_6239) <> true) then
                                                        0
                                                    else
                                                        {7562}let (=Sess_5512,SPc_6278: bitstring,PartC_6279: bitstring) = m1_6276 in
                                                        {7563}new Ns_6280: bitstring;
                                                        {7564}let m2_6281: bitstring = (Cli_5510,exp(g,Ns_6280)) in
                                                        {7565}out(c, (m2_6281,sign(m2_6281,skSess_5934)));
                                                        {7566}let Ksrv_6282: bitstring = exp(PartC_6279,Ns_6280) in
                                                        {7567}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6282))
                                        )
                                        else
                                            {7568}let pkDisco_6283: bitstring = fail-any in
                                            {7569}in(c, (=pkCli_6239,m1_6284: bitstring,sigM1_6285: bitstring));
                                            {7570}if (verify(m1_6284,sigM1_6285,pkCli_6239) <> true) then
                                                0
                                            else
                                                {7571}let (=Sess_5512,SPc_6286: bitstring,PartC_6287: bitstring) = m1_6284 in
                                                {7572}new Ns_6288: bitstring;
                                                {7573}let m2_6289: bitstring = (Cli_5510,exp(g,Ns_6288)) in
                                                {7574}out(c, (m2_6289,sign(m2_6289,skSess_5934)));
                                                {7575}let Ksrv_6290: bitstring = exp(PartC_6287,Ns_6288) in
                                                {7576}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6290))
                                )
                                else
                                    {7577}let pkDisco_6291: bitstring = fail-any in
                                    {7578}in(c, (=pkCli_6239,m1_6292: bitstring,sigM1_6293: bitstring));
                                    {7579}if (verify(m1_6292,sigM1_6293,pkCli_6239) <> true) then
                                        0
                                    else
                                        {7580}let (=Sess_5512,SPc_6294: bitstring,PartC_6295: bitstring) = m1_6292 in
                                        {7581}new Ns_6296: bitstring;
                                        {7582}let m2_6297: bitstring = (Cli_5510,exp(g,Ns_6296)) in
                                        {7583}out(c, (m2_6297,sign(m2_6297,skSess_5934)));
                                        {7584}let Ksrv_6298: bitstring = exp(PartC_6295,Ns_6296) in
                                        {7585}out(c, senc(mSrv(pkCli_6239,pkSess_5935),Ksrv_6298))
                    )
                    else
                        {7586}let pkCli_6299: bitstring = fail-any in
                        {7587}let v_6300: bool = (Disco_5511 = A) in
                        (
                            {7588}if v_6300 then
                            (
                                {7589}let pkDisco_6301: bitstring = pub(skA) in
                                {7590}in(c, (=pkCli_6299,m1_6302: bitstring,sigM1_6303: bitstring));
                                {7591}if (verify(m1_6302,sigM1_6303,pkCli_6299) <> true) then
                                    0
                                else
                                    {7592}let (=Sess_5512,SPc_6304: bitstring,PartC_6305: bitstring) = m1_6302 in
                                    {7593}new Ns_6306: bitstring;
                                    {7594}let m2_6307: bitstring = (Cli_5510,exp(g,Ns_6306)) in
                                    {7595}out(c, (m2_6307,sign(m2_6307,skSess_5934)));
                                    {7596}let Ksrv_6308: bitstring = exp(PartC_6305,Ns_6306) in
                                    {7597}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6308))
                            )
                            else
                                {7598}let v_6309: bool = (Disco_5511 = B) in
                                (
                                    {7599}if v_6309 then
                                    (
                                        {7600}let pkDisco_6310: bitstring = pub(skB) in
                                        {7601}in(c, (=pkCli_6299,m1_6311: bitstring,sigM1_6312: bitstring));
                                        {7602}if (verify(m1_6311,sigM1_6312,pkCli_6299) <> true) then
                                            0
                                        else
                                            {7603}let (=Sess_5512,SPc_6313: bitstring,PartC_6314: bitstring) = m1_6311 in
                                            {7604}new Ns_6315: bitstring;
                                            {7605}let m2_6316: bitstring = (Cli_5510,exp(g,Ns_6315)) in
                                            {7606}out(c, (m2_6316,sign(m2_6316,skSess_5934)));
                                            {7607}let Ksrv_6317: bitstring = exp(PartC_6314,Ns_6315) in
                                            {7608}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6317))
                                    )
                                    else
                                        {7609}let v_6318: bool = (Disco_5511 = C) in
                                        (
                                            {7610}if v_6318 then
                                            (
                                                {7611}let pkDisco_6319: bitstring = pub(skC) in
                                                {7612}in(c, (=pkCli_6299,m1_6320: bitstring,sigM1_6321: bitstring));
                                                {7613}if (verify(m1_6320,sigM1_6321,pkCli_6299) <> true) then
                                                    0
                                                else
                                                    {7614}let (=Sess_5512,SPc_6322: bitstring,PartC_6323: bitstring) = m1_6320 in
                                                    {7615}new Ns_6324: bitstring;
                                                    {7616}let m2_6325: bitstring = (Cli_5510,exp(g,Ns_6324)) in
                                                    {7617}out(c, (m2_6325,sign(m2_6325,skSess_5934)));
                                                    {7618}let Ksrv_6326: bitstring = exp(PartC_6323,Ns_6324) in
                                                    {7619}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6326))
                                            )
                                            else
                                                {7620}let pkDisco_6327: bitstring = pub(skI) in
                                                {7621}in(c, (=pkCli_6299,m1_6328: bitstring,sigM1_6329: bitstring));
                                                {7622}if (verify(m1_6328,sigM1_6329,pkCli_6299) <> true) then
                                                    0
                                                else
                                                    {7623}let (=Sess_5512,SPc_6330: bitstring,PartC_6331: bitstring) = m1_6328 in
                                                    {7624}new Ns_6332: bitstring;
                                                    {7625}let m2_6333: bitstring = (Cli_5510,exp(g,Ns_6332)) in
                                                    {7626}out(c, (m2_6333,sign(m2_6333,skSess_5934)));
                                                    {7627}let Ksrv_6334: bitstring = exp(PartC_6331,Ns_6332) in
                                                    {7628}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6334))
                                        )
                                        else
                                            {7629}let pkDisco_6335: bitstring = fail-any in
                                            {7630}in(c, (=pkCli_6299,m1_6336: bitstring,sigM1_6337: bitstring));
                                            {7631}if (verify(m1_6336,sigM1_6337,pkCli_6299) <> true) then
                                                0
                                            else
                                                {7632}let (=Sess_5512,SPc_6338: bitstring,PartC_6339: bitstring) = m1_6336 in
                                                {7633}new Ns_6340: bitstring;
                                                {7634}let m2_6341: bitstring = (Cli_5510,exp(g,Ns_6340)) in
                                                {7635}out(c, (m2_6341,sign(m2_6341,skSess_5934)));
                                                {7636}let Ksrv_6342: bitstring = exp(PartC_6339,Ns_6340) in
                                                {7637}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6342))
                                )
                                else
                                    {7638}let pkDisco_6343: bitstring = fail-any in
                                    {7639}in(c, (=pkCli_6299,m1_6344: bitstring,sigM1_6345: bitstring));
                                    {7640}if (verify(m1_6344,sigM1_6345,pkCli_6299) <> true) then
                                        0
                                    else
                                        {7641}let (=Sess_5512,SPc_6346: bitstring,PartC_6347: bitstring) = m1_6344 in
                                        {7642}new Ns_6348: bitstring;
                                        {7643}let m2_6349: bitstring = (Cli_5510,exp(g,Ns_6348)) in
                                        {7644}out(c, (m2_6349,sign(m2_6349,skSess_5934)));
                                        {7645}let Ksrv_6350: bitstring = exp(PartC_6347,Ns_6348) in
                                        {7646}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6350))
                        )
                        else
                            {7647}let pkDisco_6351: bitstring = fail-any in
                            {7648}in(c, (=pkCli_6299,m1_6352: bitstring,sigM1_6353: bitstring));
                            {7649}if (verify(m1_6352,sigM1_6353,pkCli_6299) <> true) then
                                0
                            else
                                {7650}let (=Sess_5512,SPc_6354: bitstring,PartC_6355: bitstring) = m1_6352 in
                                {7651}new Ns_6356: bitstring;
                                {7652}let m2_6357: bitstring = (Cli_5510,exp(g,Ns_6356)) in
                                {7653}out(c, (m2_6357,sign(m2_6357,skSess_5934)));
                                {7654}let Ksrv_6358: bitstring = exp(PartC_6355,Ns_6356) in
                                {7655}out(c, senc(mSrv(pkCli_6299,pkSess_5935),Ksrv_6358))
                )
                else
                    {7656}let v_6359: bool = (Sess_5512 = C) in
                    (
                        {7657}if v_6359 then
                        (
                            {7658}let skSess_6360: bitstring = skC in
                            {7659}let pkSess_6361: bitstring = pub(skSess_6360) in
                            {7660}let v_6362: bool = (Cli_5510 = A) in
                            (
                                {7661}if v_6362 then
                                (
                                    {7662}let pkCli_6363: bitstring = pub(skA) in
                                    {7663}let v_6364: bool = (Disco_5511 = A) in
                                    (
                                        {7664}if v_6364 then
                                        (
                                            {7665}let pkDisco_6365: bitstring = pub(skA) in
                                            {7666}in(c, (=pkCli_6363,m1_6366: bitstring,sigM1_6367: bitstring));
                                            {7667}if (verify(m1_6366,sigM1_6367,pkCli_6363) <> true) then
                                                0
                                            else
                                                {7668}let (=Sess_5512,SPc_6368: bitstring,PartC_6369: bitstring) = m1_6366 in
                                                {7669}new Ns_6370: bitstring;
                                                {7670}let m2_6371: bitstring = (Cli_5510,exp(g,Ns_6370)) in
                                                {7671}out(c, (m2_6371,sign(m2_6371,skSess_6360)));
                                                {7672}let Ksrv_6372: bitstring = exp(PartC_6369,Ns_6370) in
                                                {7673}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6372))
                                        )
                                        else
                                            {7674}let v_6373: bool = (Disco_5511 = B) in
                                            (
                                                {7675}if v_6373 then
                                                (
                                                    {7676}let pkDisco_6374: bitstring = pub(skB) in
                                                    {7677}in(c, (=pkCli_6363,m1_6375: bitstring,sigM1_6376: bitstring));
                                                    {7678}if (verify(m1_6375,sigM1_6376,pkCli_6363) <> true) then
                                                        0
                                                    else
                                                        {7679}let (=Sess_5512,SPc_6377: bitstring,PartC_6378: bitstring) = m1_6375 in
                                                        {7680}new Ns_6379: bitstring;
                                                        {7681}let m2_6380: bitstring = (Cli_5510,exp(g,Ns_6379)) in
                                                        {7682}out(c, (m2_6380,sign(m2_6380,skSess_6360)));
                                                        {7683}let Ksrv_6381: bitstring = exp(PartC_6378,Ns_6379) in
                                                        {7684}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6381))
                                                )
                                                else
                                                    {7685}let v_6382: bool = (Disco_5511 = C) in
                                                    (
                                                        {7686}if v_6382 then
                                                        (
                                                            {7687}let pkDisco_6383: bitstring = pub(skC) in
                                                            {7688}in(c, (=pkCli_6363,m1_6384: bitstring,sigM1_6385: bitstring));
                                                            {7689}if (verify(m1_6384,sigM1_6385,pkCli_6363) <> true) then
                                                                0
                                                            else
                                                                {7690}let (=Sess_5512,SPc_6386: bitstring,PartC_6387: bitstring) = m1_6384 in
                                                                {7691}new Ns_6388: bitstring;
                                                                {7692}let m2_6389: bitstring = (Cli_5510,exp(g,Ns_6388)) in
                                                                {7693}out(c, (m2_6389,sign(m2_6389,skSess_6360)));
                                                                {7694}let Ksrv_6390: bitstring = exp(PartC_6387,Ns_6388) in
                                                                {7695}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6390))
                                                        )
                                                        else
                                                            {7696}let pkDisco_6391: bitstring = pub(skI) in
                                                            {7697}in(c, (=pkCli_6363,m1_6392: bitstring,sigM1_6393: bitstring));
                                                            {7698}if (verify(m1_6392,sigM1_6393,pkCli_6363) <> true) then
                                                                0
                                                            else
                                                                {7699}let (=Sess_5512,SPc_6394: bitstring,PartC_6395: bitstring) = m1_6392 in
                                                                {7700}new Ns_6396: bitstring;
                                                                {7701}let m2_6397: bitstring = (Cli_5510,exp(g,Ns_6396)) in
                                                                {7702}out(c, (m2_6397,sign(m2_6397,skSess_6360)));
                                                                {7703}let Ksrv_6398: bitstring = exp(PartC_6395,Ns_6396) in
                                                                {7704}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6398))
                                                    )
                                                    else
                                                        {7705}let pkDisco_6399: bitstring = fail-any in
                                                        {7706}in(c, (=pkCli_6363,m1_6400: bitstring,sigM1_6401: bitstring));
                                                        {7707}if (verify(m1_6400,sigM1_6401,pkCli_6363) <> true) then
                                                            0
                                                        else
                                                            {7708}let (=Sess_5512,SPc_6402: bitstring,PartC_6403: bitstring) = m1_6400 in
                                                            {7709}new Ns_6404: bitstring;
                                                            {7710}let m2_6405: bitstring = (Cli_5510,exp(g,Ns_6404)) in
                                                            {7711}out(c, (m2_6405,sign(m2_6405,skSess_6360)));
                                                            {7712}let Ksrv_6406: bitstring = exp(PartC_6403,Ns_6404) in
                                                            {7713}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6406))
                                            )
                                            else
                                                {7714}let pkDisco_6407: bitstring = fail-any in
                                                {7715}in(c, (=pkCli_6363,m1_6408: bitstring,sigM1_6409: bitstring));
                                                {7716}if (verify(m1_6408,sigM1_6409,pkCli_6363) <> true) then
                                                    0
                                                else
                                                    {7717}let (=Sess_5512,SPc_6410: bitstring,PartC_6411: bitstring) = m1_6408 in
                                                    {7718}new Ns_6412: bitstring;
                                                    {7719}let m2_6413: bitstring = (Cli_5510,exp(g,Ns_6412)) in
                                                    {7720}out(c, (m2_6413,sign(m2_6413,skSess_6360)));
                                                    {7721}let Ksrv_6414: bitstring = exp(PartC_6411,Ns_6412) in
                                                    {7722}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6414))
                                    )
                                    else
                                        {7723}let pkDisco_6415: bitstring = fail-any in
                                        {7724}in(c, (=pkCli_6363,m1_6416: bitstring,sigM1_6417: bitstring));
                                        {7725}if (verify(m1_6416,sigM1_6417,pkCli_6363) <> true) then
                                            0
                                        else
                                            {7726}let (=Sess_5512,SPc_6418: bitstring,PartC_6419: bitstring) = m1_6416 in
                                            {7727}new Ns_6420: bitstring;
                                            {7728}let m2_6421: bitstring = (Cli_5510,exp(g,Ns_6420)) in
                                            {7729}out(c, (m2_6421,sign(m2_6421,skSess_6360)));
                                            {7730}let Ksrv_6422: bitstring = exp(PartC_6419,Ns_6420) in
                                            {7731}out(c, senc(mSrv(pkCli_6363,pkSess_6361),Ksrv_6422))
                                )
                                else
                                    {7732}let v_6423: bool = (Cli_5510 = B) in
                                    (
                                        {7733}if v_6423 then
                                        (
                                            {7734}let pkCli_6424: bitstring = pub(skB) in
                                            {7735}let v_6425: bool = (Disco_5511 = A) in
                                            (
                                                {7736}if v_6425 then
                                                (
                                                    {7737}let pkDisco_6426: bitstring = pub(skA) in
                                                    {7738}in(c, (=pkCli_6424,m1_6427: bitstring,sigM1_6428: bitstring));
                                                    {7739}if (verify(m1_6427,sigM1_6428,pkCli_6424) <> true) then
                                                        0
                                                    else
                                                        {7740}let (=Sess_5512,SPc_6429: bitstring,PartC_6430: bitstring) = m1_6427 in
                                                        {7741}new Ns_6431: bitstring;
                                                        {7742}let m2_6432: bitstring = (Cli_5510,exp(g,Ns_6431)) in
                                                        {7743}out(c, (m2_6432,sign(m2_6432,skSess_6360)));
                                                        {7744}let Ksrv_6433: bitstring = exp(PartC_6430,Ns_6431) in
                                                        {7745}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6433))
                                                )
                                                else
                                                    {7746}let v_6434: bool = (Disco_5511 = B) in
                                                    (
                                                        {7747}if v_6434 then
                                                        (
                                                            {7748}let pkDisco_6435: bitstring = pub(skB) in
                                                            {7749}in(c, (=pkCli_6424,m1_6436: bitstring,sigM1_6437: bitstring));
                                                            {7750}if (verify(m1_6436,sigM1_6437,pkCli_6424) <> true) then
                                                                0
                                                            else
                                                                {7751}let (=Sess_5512,SPc_6438: bitstring,PartC_6439: bitstring) = m1_6436 in
                                                                {7752}new Ns_6440: bitstring;
                                                                {7753}let m2_6441: bitstring = (Cli_5510,exp(g,Ns_6440)) in
                                                                {7754}out(c, (m2_6441,sign(m2_6441,skSess_6360)));
                                                                {7755}let Ksrv_6442: bitstring = exp(PartC_6439,Ns_6440) in
                                                                {7756}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6442))
                                                        )
                                                        else
                                                            {7757}let v_6443: bool = (Disco_5511 = C) in
                                                            (
                                                                {7758}if v_6443 then
                                                                (
                                                                    {7759}let pkDisco_6444: bitstring = pub(skC) in
                                                                    {7760}in(c, (=pkCli_6424,m1_6445: bitstring,sigM1_6446: bitstring));
                                                                    {7761}if (verify(m1_6445,sigM1_6446,pkCli_6424) <> true) then
                                                                        0
                                                                    else
                                                                        {7762}let (=Sess_5512,SPc_6447: bitstring,PartC_6448: bitstring) = m1_6445 in
                                                                        {7763}new Ns_6449: bitstring;
                                                                        {7764}let m2_6450: bitstring = (Cli_5510,exp(g,Ns_6449)) in
                                                                        {7765}out(c, (m2_6450,sign(m2_6450,skSess_6360)));
                                                                        {7766}let Ksrv_6451: bitstring = exp(PartC_6448,Ns_6449) in
                                                                        {7767}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6451))
                                                                )
                                                                else
                                                                    {7768}let pkDisco_6452: bitstring = pub(skI) in
                                                                    {7769}in(c, (=pkCli_6424,m1_6453: bitstring,sigM1_6454: bitstring));
                                                                    {7770}if (verify(m1_6453,sigM1_6454,pkCli_6424) <> true) then
                                                                        0
                                                                    else
                                                                        {7771}let (=Sess_5512,SPc_6455: bitstring,PartC_6456: bitstring) = m1_6453 in
                                                                        {7772}new Ns_6457: bitstring;
                                                                        {7773}let m2_6458: bitstring = (Cli_5510,exp(g,Ns_6457)) in
                                                                        {7774}out(c, (m2_6458,sign(m2_6458,skSess_6360)));
                                                                        {7775}let Ksrv_6459: bitstring = exp(PartC_6456,Ns_6457) in
                                                                        {7776}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6459))
                                                            )
                                                            else
                                                                {7777}let pkDisco_6460: bitstring = fail-any in
                                                                {7778}in(c, (=pkCli_6424,m1_6461: bitstring,sigM1_6462: bitstring));
                                                                {7779}if (verify(m1_6461,sigM1_6462,pkCli_6424) <> true) then
                                                                    0
                                                                else
                                                                    {7780}let (=Sess_5512,SPc_6463: bitstring,PartC_6464: bitstring) = m1_6461 in
                                                                    {7781}new Ns_6465: bitstring;
                                                                    {7782}let m2_6466: bitstring = (Cli_5510,exp(g,Ns_6465)) in
                                                                    {7783}out(c, (m2_6466,sign(m2_6466,skSess_6360)));
                                                                    {7784}let Ksrv_6467: bitstring = exp(PartC_6464,Ns_6465) in
                                                                    {7785}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6467))
                                                    )
                                                    else
                                                        {7786}let pkDisco_6468: bitstring = fail-any in
                                                        {7787}in(c, (=pkCli_6424,m1_6469: bitstring,sigM1_6470: bitstring));
                                                        {7788}if (verify(m1_6469,sigM1_6470,pkCli_6424) <> true) then
                                                            0
                                                        else
                                                            {7789}let (=Sess_5512,SPc_6471: bitstring,PartC_6472: bitstring) = m1_6469 in
                                                            {7790}new Ns_6473: bitstring;
                                                            {7791}let m2_6474: bitstring = (Cli_5510,exp(g,Ns_6473)) in
                                                            {7792}out(c, (m2_6474,sign(m2_6474,skSess_6360)));
                                                            {7793}let Ksrv_6475: bitstring = exp(PartC_6472,Ns_6473) in
                                                            {7794}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6475))
                                            )
                                            else
                                                {7795}let pkDisco_6476: bitstring = fail-any in
                                                {7796}in(c, (=pkCli_6424,m1_6477: bitstring,sigM1_6478: bitstring));
                                                {7797}if (verify(m1_6477,sigM1_6478,pkCli_6424) <> true) then
                                                    0
                                                else
                                                    {7798}let (=Sess_5512,SPc_6479: bitstring,PartC_6480: bitstring) = m1_6477 in
                                                    {7799}new Ns_6481: bitstring;
                                                    {7800}let m2_6482: bitstring = (Cli_5510,exp(g,Ns_6481)) in
                                                    {7801}out(c, (m2_6482,sign(m2_6482,skSess_6360)));
                                                    {7802}let Ksrv_6483: bitstring = exp(PartC_6480,Ns_6481) in
                                                    {7803}out(c, senc(mSrv(pkCli_6424,pkSess_6361),Ksrv_6483))
                                        )
                                        else
                                            {7804}let v_6484: bool = (Cli_5510 = C) in
                                            (
                                                {7805}if v_6484 then
                                                (
                                                    {7806}let pkCli_6485: bitstring = pub(skC) in
                                                    {7807}let v_6486: bool = (Disco_5511 = A) in
                                                    (
                                                        {7808}if v_6486 then
                                                        (
                                                            {7809}let pkDisco_6487: bitstring = pub(skA) in
                                                            {7810}in(c, (=pkCli_6485,m1_6488: bitstring,sigM1_6489: bitstring));
                                                            {7811}if (verify(m1_6488,sigM1_6489,pkCli_6485) <> true) then
                                                                0
                                                            else
                                                                {7812}let (=Sess_5512,SPc_6490: bitstring,PartC_6491: bitstring) = m1_6488 in
                                                                {7813}new Ns_6492: bitstring;
                                                                {7814}let m2_6493: bitstring = (Cli_5510,exp(g,Ns_6492)) in
                                                                {7815}out(c, (m2_6493,sign(m2_6493,skSess_6360)));
                                                                {7816}let Ksrv_6494: bitstring = exp(PartC_6491,Ns_6492) in
                                                                {7817}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6494))
                                                        )
                                                        else
                                                            {7818}let v_6495: bool = (Disco_5511 = B) in
                                                            (
                                                                {7819}if v_6495 then
                                                                (
                                                                    {7820}let pkDisco_6496: bitstring = pub(skB) in
                                                                    {7821}in(c, (=pkCli_6485,m1_6497: bitstring,sigM1_6498: bitstring));
                                                                    {7822}if (verify(m1_6497,sigM1_6498,pkCli_6485) <> true) then
                                                                        0
                                                                    else
                                                                        {7823}let (=Sess_5512,SPc_6499: bitstring,PartC_6500: bitstring) = m1_6497 in
                                                                        {7824}new Ns_6501: bitstring;
                                                                        {7825}let m2_6502: bitstring = (Cli_5510,exp(g,Ns_6501)) in
                                                                        {7826}out(c, (m2_6502,sign(m2_6502,skSess_6360)));
                                                                        {7827}let Ksrv_6503: bitstring = exp(PartC_6500,Ns_6501) in
                                                                        {7828}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6503))
                                                                )
                                                                else
                                                                    {7829}let v_6504: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {7830}if v_6504 then
                                                                        (
                                                                            {7831}let pkDisco_6505: bitstring = pub(skC) in
                                                                            {7832}in(c, (=pkCli_6485,m1_6506: bitstring,sigM1_6507: bitstring));
                                                                            {7833}if (verify(m1_6506,sigM1_6507,pkCli_6485) <> true) then
                                                                                0
                                                                            else
                                                                                {7834}let (=Sess_5512,SPc_6508: bitstring,PartC_6509: bitstring) = m1_6506 in
                                                                                {7835}new Ns_6510: bitstring;
                                                                                {7836}let m2_6511: bitstring = (Cli_5510,exp(g,Ns_6510)) in
                                                                                {7837}out(c, (m2_6511,sign(m2_6511,skSess_6360)));
                                                                                {7838}let Ksrv_6512: bitstring = exp(PartC_6509,Ns_6510) in
                                                                                {7839}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6512))
                                                                        )
                                                                        else
                                                                            {7840}let pkDisco_6513: bitstring = pub(skI) in
                                                                            {7841}in(c, (=pkCli_6485,m1_6514: bitstring,sigM1_6515: bitstring));
                                                                            {7842}if (verify(m1_6514,sigM1_6515,pkCli_6485) <> true) then
                                                                                0
                                                                            else
                                                                                {7843}let (=Sess_5512,SPc_6516: bitstring,PartC_6517: bitstring) = m1_6514 in
                                                                                {7844}new Ns_6518: bitstring;
                                                                                {7845}let m2_6519: bitstring = (Cli_5510,exp(g,Ns_6518)) in
                                                                                {7846}out(c, (m2_6519,sign(m2_6519,skSess_6360)));
                                                                                {7847}let Ksrv_6520: bitstring = exp(PartC_6517,Ns_6518) in
                                                                                {7848}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6520))
                                                                    )
                                                                    else
                                                                        {7849}let pkDisco_6521: bitstring = fail-any in
                                                                        {7850}in(c, (=pkCli_6485,m1_6522: bitstring,sigM1_6523: bitstring));
                                                                        {7851}if (verify(m1_6522,sigM1_6523,pkCli_6485) <> true) then
                                                                            0
                                                                        else
                                                                            {7852}let (=Sess_5512,SPc_6524: bitstring,PartC_6525: bitstring) = m1_6522 in
                                                                            {7853}new Ns_6526: bitstring;
                                                                            {7854}let m2_6527: bitstring = (Cli_5510,exp(g,Ns_6526)) in
                                                                            {7855}out(c, (m2_6527,sign(m2_6527,skSess_6360)));
                                                                            {7856}let Ksrv_6528: bitstring = exp(PartC_6525,Ns_6526) in
                                                                            {7857}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6528))
                                                            )
                                                            else
                                                                {7858}let pkDisco_6529: bitstring = fail-any in
                                                                {7859}in(c, (=pkCli_6485,m1_6530: bitstring,sigM1_6531: bitstring));
                                                                {7860}if (verify(m1_6530,sigM1_6531,pkCli_6485) <> true) then
                                                                    0
                                                                else
                                                                    {7861}let (=Sess_5512,SPc_6532: bitstring,PartC_6533: bitstring) = m1_6530 in
                                                                    {7862}new Ns_6534: bitstring;
                                                                    {7863}let m2_6535: bitstring = (Cli_5510,exp(g,Ns_6534)) in
                                                                    {7864}out(c, (m2_6535,sign(m2_6535,skSess_6360)));
                                                                    {7865}let Ksrv_6536: bitstring = exp(PartC_6533,Ns_6534) in
                                                                    {7866}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6536))
                                                    )
                                                    else
                                                        {7867}let pkDisco_6537: bitstring = fail-any in
                                                        {7868}in(c, (=pkCli_6485,m1_6538: bitstring,sigM1_6539: bitstring));
                                                        {7869}if (verify(m1_6538,sigM1_6539,pkCli_6485) <> true) then
                                                            0
                                                        else
                                                            {7870}let (=Sess_5512,SPc_6540: bitstring,PartC_6541: bitstring) = m1_6538 in
                                                            {7871}new Ns_6542: bitstring;
                                                            {7872}let m2_6543: bitstring = (Cli_5510,exp(g,Ns_6542)) in
                                                            {7873}out(c, (m2_6543,sign(m2_6543,skSess_6360)));
                                                            {7874}let Ksrv_6544: bitstring = exp(PartC_6541,Ns_6542) in
                                                            {7875}out(c, senc(mSrv(pkCli_6485,pkSess_6361),Ksrv_6544))
                                                )
                                                else
                                                    {7876}let pkCli_6545: bitstring = pub(skI) in
                                                    {7877}let v_6546: bool = (Disco_5511 = A) in
                                                    (
                                                        {7878}if v_6546 then
                                                        (
                                                            {7879}let pkDisco_6547: bitstring = pub(skA) in
                                                            {7880}in(c, (=pkCli_6545,m1_6548: bitstring,sigM1_6549: bitstring));
                                                            {7881}if (verify(m1_6548,sigM1_6549,pkCli_6545) <> true) then
                                                                0
                                                            else
                                                                {7882}let (=Sess_5512,SPc_6550: bitstring,PartC_6551: bitstring) = m1_6548 in
                                                                {7883}new Ns_6552: bitstring;
                                                                {7884}let m2_6553: bitstring = (Cli_5510,exp(g,Ns_6552)) in
                                                                {7885}out(c, (m2_6553,sign(m2_6553,skSess_6360)));
                                                                {7886}let Ksrv_6554: bitstring = exp(PartC_6551,Ns_6552) in
                                                                {7887}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6554))
                                                        )
                                                        else
                                                            {7888}let v_6555: bool = (Disco_5511 = B) in
                                                            (
                                                                {7889}if v_6555 then
                                                                (
                                                                    {7890}let pkDisco_6556: bitstring = pub(skB) in
                                                                    {7891}in(c, (=pkCli_6545,m1_6557: bitstring,sigM1_6558: bitstring));
                                                                    {7892}if (verify(m1_6557,sigM1_6558,pkCli_6545) <> true) then
                                                                        0
                                                                    else
                                                                        {7893}let (=Sess_5512,SPc_6559: bitstring,PartC_6560: bitstring) = m1_6557 in
                                                                        {7894}new Ns_6561: bitstring;
                                                                        {7895}let m2_6562: bitstring = (Cli_5510,exp(g,Ns_6561)) in
                                                                        {7896}out(c, (m2_6562,sign(m2_6562,skSess_6360)));
                                                                        {7897}let Ksrv_6563: bitstring = exp(PartC_6560,Ns_6561) in
                                                                        {7898}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6563))
                                                                )
                                                                else
                                                                    {7899}let v_6564: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {7900}if v_6564 then
                                                                        (
                                                                            {7901}let pkDisco_6565: bitstring = pub(skC) in
                                                                            {7902}in(c, (=pkCli_6545,m1_6566: bitstring,sigM1_6567: bitstring));
                                                                            {7903}if (verify(m1_6566,sigM1_6567,pkCli_6545) <> true) then
                                                                                0
                                                                            else
                                                                                {7904}let (=Sess_5512,SPc_6568: bitstring,PartC_6569: bitstring) = m1_6566 in
                                                                                {7905}new Ns_6570: bitstring;
                                                                                {7906}let m2_6571: bitstring = (Cli_5510,exp(g,Ns_6570)) in
                                                                                {7907}out(c, (m2_6571,sign(m2_6571,skSess_6360)));
                                                                                {7908}let Ksrv_6572: bitstring = exp(PartC_6569,Ns_6570) in
                                                                                {7909}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6572))
                                                                        )
                                                                        else
                                                                            {7910}let pkDisco_6573: bitstring = pub(skI) in
                                                                            {7911}in(c, (=pkCli_6545,m1_6574: bitstring,sigM1_6575: bitstring));
                                                                            {7912}if (verify(m1_6574,sigM1_6575,pkCli_6545) <> true) then
                                                                                0
                                                                            else
                                                                                {7913}let (=Sess_5512,SPc_6576: bitstring,PartC_6577: bitstring) = m1_6574 in
                                                                                {7914}new Ns_6578: bitstring;
                                                                                {7915}let m2_6579: bitstring = (Cli_5510,exp(g,Ns_6578)) in
                                                                                {7916}out(c, (m2_6579,sign(m2_6579,skSess_6360)));
                                                                                {7917}let Ksrv_6580: bitstring = exp(PartC_6577,Ns_6578) in
                                                                                {7918}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6580))
                                                                    )
                                                                    else
                                                                        {7919}let pkDisco_6581: bitstring = fail-any in
                                                                        {7920}in(c, (=pkCli_6545,m1_6582: bitstring,sigM1_6583: bitstring));
                                                                        {7921}if (verify(m1_6582,sigM1_6583,pkCli_6545) <> true) then
                                                                            0
                                                                        else
                                                                            {7922}let (=Sess_5512,SPc_6584: bitstring,PartC_6585: bitstring) = m1_6582 in
                                                                            {7923}new Ns_6586: bitstring;
                                                                            {7924}let m2_6587: bitstring = (Cli_5510,exp(g,Ns_6586)) in
                                                                            {7925}out(c, (m2_6587,sign(m2_6587,skSess_6360)));
                                                                            {7926}let Ksrv_6588: bitstring = exp(PartC_6585,Ns_6586) in
                                                                            {7927}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6588))
                                                            )
                                                            else
                                                                {7928}let pkDisco_6589: bitstring = fail-any in
                                                                {7929}in(c, (=pkCli_6545,m1_6590: bitstring,sigM1_6591: bitstring));
                                                                {7930}if (verify(m1_6590,sigM1_6591,pkCli_6545) <> true) then
                                                                    0
                                                                else
                                                                    {7931}let (=Sess_5512,SPc_6592: bitstring,PartC_6593: bitstring) = m1_6590 in
                                                                    {7932}new Ns_6594: bitstring;
                                                                    {7933}let m2_6595: bitstring = (Cli_5510,exp(g,Ns_6594)) in
                                                                    {7934}out(c, (m2_6595,sign(m2_6595,skSess_6360)));
                                                                    {7935}let Ksrv_6596: bitstring = exp(PartC_6593,Ns_6594) in
                                                                    {7936}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6596))
                                                    )
                                                    else
                                                        {7937}let pkDisco_6597: bitstring = fail-any in
                                                        {7938}in(c, (=pkCli_6545,m1_6598: bitstring,sigM1_6599: bitstring));
                                                        {7939}if (verify(m1_6598,sigM1_6599,pkCli_6545) <> true) then
                                                            0
                                                        else
                                                            {7940}let (=Sess_5512,SPc_6600: bitstring,PartC_6601: bitstring) = m1_6598 in
                                                            {7941}new Ns_6602: bitstring;
                                                            {7942}let m2_6603: bitstring = (Cli_5510,exp(g,Ns_6602)) in
                                                            {7943}out(c, (m2_6603,sign(m2_6603,skSess_6360)));
                                                            {7944}let Ksrv_6604: bitstring = exp(PartC_6601,Ns_6602) in
                                                            {7945}out(c, senc(mSrv(pkCli_6545,pkSess_6361),Ksrv_6604))
                                            )
                                            else
                                                {7946}let pkCli_6605: bitstring = fail-any in
                                                {7947}let v_6606: bool = (Disco_5511 = A) in
                                                (
                                                    {7948}if v_6606 then
                                                    (
                                                        {7949}let pkDisco_6607: bitstring = pub(skA) in
                                                        {7950}in(c, (=pkCli_6605,m1_6608: bitstring,sigM1_6609: bitstring));
                                                        {7951}if (verify(m1_6608,sigM1_6609,pkCli_6605) <> true) then
                                                            0
                                                        else
                                                            {7952}let (=Sess_5512,SPc_6610: bitstring,PartC_6611: bitstring) = m1_6608 in
                                                            {7953}new Ns_6612: bitstring;
                                                            {7954}let m2_6613: bitstring = (Cli_5510,exp(g,Ns_6612)) in
                                                            {7955}out(c, (m2_6613,sign(m2_6613,skSess_6360)));
                                                            {7956}let Ksrv_6614: bitstring = exp(PartC_6611,Ns_6612) in
                                                            {7957}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6614))
                                                    )
                                                    else
                                                        {7958}let v_6615: bool = (Disco_5511 = B) in
                                                        (
                                                            {7959}if v_6615 then
                                                            (
                                                                {7960}let pkDisco_6616: bitstring = pub(skB) in
                                                                {7961}in(c, (=pkCli_6605,m1_6617: bitstring,sigM1_6618: bitstring));
                                                                {7962}if (verify(m1_6617,sigM1_6618,pkCli_6605) <> true) then
                                                                    0
                                                                else
                                                                    {7963}let (=Sess_5512,SPc_6619: bitstring,PartC_6620: bitstring) = m1_6617 in
                                                                    {7964}new Ns_6621: bitstring;
                                                                    {7965}let m2_6622: bitstring = (Cli_5510,exp(g,Ns_6621)) in
                                                                    {7966}out(c, (m2_6622,sign(m2_6622,skSess_6360)));
                                                                    {7967}let Ksrv_6623: bitstring = exp(PartC_6620,Ns_6621) in
                                                                    {7968}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6623))
                                                            )
                                                            else
                                                                {7969}let v_6624: bool = (Disco_5511 = C) in
                                                                (
                                                                    {7970}if v_6624 then
                                                                    (
                                                                        {7971}let pkDisco_6625: bitstring = pub(skC) in
                                                                        {7972}in(c, (=pkCli_6605,m1_6626: bitstring,sigM1_6627: bitstring));
                                                                        {7973}if (verify(m1_6626,sigM1_6627,pkCli_6605) <> true) then
                                                                            0
                                                                        else
                                                                            {7974}let (=Sess_5512,SPc_6628: bitstring,PartC_6629: bitstring) = m1_6626 in
                                                                            {7975}new Ns_6630: bitstring;
                                                                            {7976}let m2_6631: bitstring = (Cli_5510,exp(g,Ns_6630)) in
                                                                            {7977}out(c, (m2_6631,sign(m2_6631,skSess_6360)));
                                                                            {7978}let Ksrv_6632: bitstring = exp(PartC_6629,Ns_6630) in
                                                                            {7979}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6632))
                                                                    )
                                                                    else
                                                                        {7980}let pkDisco_6633: bitstring = pub(skI) in
                                                                        {7981}in(c, (=pkCli_6605,m1_6634: bitstring,sigM1_6635: bitstring));
                                                                        {7982}if (verify(m1_6634,sigM1_6635,pkCli_6605) <> true) then
                                                                            0
                                                                        else
                                                                            {7983}let (=Sess_5512,SPc_6636: bitstring,PartC_6637: bitstring) = m1_6634 in
                                                                            {7984}new Ns_6638: bitstring;
                                                                            {7985}let m2_6639: bitstring = (Cli_5510,exp(g,Ns_6638)) in
                                                                            {7986}out(c, (m2_6639,sign(m2_6639,skSess_6360)));
                                                                            {7987}let Ksrv_6640: bitstring = exp(PartC_6637,Ns_6638) in
                                                                            {7988}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6640))
                                                                )
                                                                else
                                                                    {7989}let pkDisco_6641: bitstring = fail-any in
                                                                    {7990}in(c, (=pkCli_6605,m1_6642: bitstring,sigM1_6643: bitstring));
                                                                    {7991}if (verify(m1_6642,sigM1_6643,pkCli_6605) <> true) then
                                                                        0
                                                                    else
                                                                        {7992}let (=Sess_5512,SPc_6644: bitstring,PartC_6645: bitstring) = m1_6642 in
                                                                        {7993}new Ns_6646: bitstring;
                                                                        {7994}let m2_6647: bitstring = (Cli_5510,exp(g,Ns_6646)) in
                                                                        {7995}out(c, (m2_6647,sign(m2_6647,skSess_6360)));
                                                                        {7996}let Ksrv_6648: bitstring = exp(PartC_6645,Ns_6646) in
                                                                        {7997}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6648))
                                                        )
                                                        else
                                                            {7998}let pkDisco_6649: bitstring = fail-any in
                                                            {7999}in(c, (=pkCli_6605,m1_6650: bitstring,sigM1_6651: bitstring));
                                                            {8000}if (verify(m1_6650,sigM1_6651,pkCli_6605) <> true) then
                                                                0
                                                            else
                                                                {8001}let (=Sess_5512,SPc_6652: bitstring,PartC_6653: bitstring) = m1_6650 in
                                                                {8002}new Ns_6654: bitstring;
                                                                {8003}let m2_6655: bitstring = (Cli_5510,exp(g,Ns_6654)) in
                                                                {8004}out(c, (m2_6655,sign(m2_6655,skSess_6360)));
                                                                {8005}let Ksrv_6656: bitstring = exp(PartC_6653,Ns_6654) in
                                                                {8006}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6656))
                                                )
                                                else
                                                    {8007}let pkDisco_6657: bitstring = fail-any in
                                                    {8008}in(c, (=pkCli_6605,m1_6658: bitstring,sigM1_6659: bitstring));
                                                    {8009}if (verify(m1_6658,sigM1_6659,pkCli_6605) <> true) then
                                                        0
                                                    else
                                                        {8010}let (=Sess_5512,SPc_6660: bitstring,PartC_6661: bitstring) = m1_6658 in
                                                        {8011}new Ns_6662: bitstring;
                                                        {8012}let m2_6663: bitstring = (Cli_5510,exp(g,Ns_6662)) in
                                                        {8013}out(c, (m2_6663,sign(m2_6663,skSess_6360)));
                                                        {8014}let Ksrv_6664: bitstring = exp(PartC_6661,Ns_6662) in
                                                        {8015}out(c, senc(mSrv(pkCli_6605,pkSess_6361),Ksrv_6664))
                                    )
                                    else
                                        {8016}let pkCli_6665: bitstring = fail-any in
                                        {8017}let v_6666: bool = (Disco_5511 = A) in
                                        (
                                            {8018}if v_6666 then
                                            (
                                                {8019}let pkDisco_6667: bitstring = pub(skA) in
                                                {8020}in(c, (=pkCli_6665,m1_6668: bitstring,sigM1_6669: bitstring));
                                                {8021}if (verify(m1_6668,sigM1_6669,pkCli_6665) <> true) then
                                                    0
                                                else
                                                    {8022}let (=Sess_5512,SPc_6670: bitstring,PartC_6671: bitstring) = m1_6668 in
                                                    {8023}new Ns_6672: bitstring;
                                                    {8024}let m2_6673: bitstring = (Cli_5510,exp(g,Ns_6672)) in
                                                    {8025}out(c, (m2_6673,sign(m2_6673,skSess_6360)));
                                                    {8026}let Ksrv_6674: bitstring = exp(PartC_6671,Ns_6672) in
                                                    {8027}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6674))
                                            )
                                            else
                                                {8028}let v_6675: bool = (Disco_5511 = B) in
                                                (
                                                    {8029}if v_6675 then
                                                    (
                                                        {8030}let pkDisco_6676: bitstring = pub(skB) in
                                                        {8031}in(c, (=pkCli_6665,m1_6677: bitstring,sigM1_6678: bitstring));
                                                        {8032}if (verify(m1_6677,sigM1_6678,pkCli_6665) <> true) then
                                                            0
                                                        else
                                                            {8033}let (=Sess_5512,SPc_6679: bitstring,PartC_6680: bitstring) = m1_6677 in
                                                            {8034}new Ns_6681: bitstring;
                                                            {8035}let m2_6682: bitstring = (Cli_5510,exp(g,Ns_6681)) in
                                                            {8036}out(c, (m2_6682,sign(m2_6682,skSess_6360)));
                                                            {8037}let Ksrv_6683: bitstring = exp(PartC_6680,Ns_6681) in
                                                            {8038}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6683))
                                                    )
                                                    else
                                                        {8039}let v_6684: bool = (Disco_5511 = C) in
                                                        (
                                                            {8040}if v_6684 then
                                                            (
                                                                {8041}let pkDisco_6685: bitstring = pub(skC) in
                                                                {8042}in(c, (=pkCli_6665,m1_6686: bitstring,sigM1_6687: bitstring));
                                                                {8043}if (verify(m1_6686,sigM1_6687,pkCli_6665) <> true) then
                                                                    0
                                                                else
                                                                    {8044}let (=Sess_5512,SPc_6688: bitstring,PartC_6689: bitstring) = m1_6686 in
                                                                    {8045}new Ns_6690: bitstring;
                                                                    {8046}let m2_6691: bitstring = (Cli_5510,exp(g,Ns_6690)) in
                                                                    {8047}out(c, (m2_6691,sign(m2_6691,skSess_6360)));
                                                                    {8048}let Ksrv_6692: bitstring = exp(PartC_6689,Ns_6690) in
                                                                    {8049}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6692))
                                                            )
                                                            else
                                                                {8050}let pkDisco_6693: bitstring = pub(skI) in
                                                                {8051}in(c, (=pkCli_6665,m1_6694: bitstring,sigM1_6695: bitstring));
                                                                {8052}if (verify(m1_6694,sigM1_6695,pkCli_6665) <> true) then
                                                                    0
                                                                else
                                                                    {8053}let (=Sess_5512,SPc_6696: bitstring,PartC_6697: bitstring) = m1_6694 in
                                                                    {8054}new Ns_6698: bitstring;
                                                                    {8055}let m2_6699: bitstring = (Cli_5510,exp(g,Ns_6698)) in
                                                                    {8056}out(c, (m2_6699,sign(m2_6699,skSess_6360)));
                                                                    {8057}let Ksrv_6700: bitstring = exp(PartC_6697,Ns_6698) in
                                                                    {8058}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6700))
                                                        )
                                                        else
                                                            {8059}let pkDisco_6701: bitstring = fail-any in
                                                            {8060}in(c, (=pkCli_6665,m1_6702: bitstring,sigM1_6703: bitstring));
                                                            {8061}if (verify(m1_6702,sigM1_6703,pkCli_6665) <> true) then
                                                                0
                                                            else
                                                                {8062}let (=Sess_5512,SPc_6704: bitstring,PartC_6705: bitstring) = m1_6702 in
                                                                {8063}new Ns_6706: bitstring;
                                                                {8064}let m2_6707: bitstring = (Cli_5510,exp(g,Ns_6706)) in
                                                                {8065}out(c, (m2_6707,sign(m2_6707,skSess_6360)));
                                                                {8066}let Ksrv_6708: bitstring = exp(PartC_6705,Ns_6706) in
                                                                {8067}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6708))
                                                )
                                                else
                                                    {8068}let pkDisco_6709: bitstring = fail-any in
                                                    {8069}in(c, (=pkCli_6665,m1_6710: bitstring,sigM1_6711: bitstring));
                                                    {8070}if (verify(m1_6710,sigM1_6711,pkCli_6665) <> true) then
                                                        0
                                                    else
                                                        {8071}let (=Sess_5512,SPc_6712: bitstring,PartC_6713: bitstring) = m1_6710 in
                                                        {8072}new Ns_6714: bitstring;
                                                        {8073}let m2_6715: bitstring = (Cli_5510,exp(g,Ns_6714)) in
                                                        {8074}out(c, (m2_6715,sign(m2_6715,skSess_6360)));
                                                        {8075}let Ksrv_6716: bitstring = exp(PartC_6713,Ns_6714) in
                                                        {8076}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6716))
                                        )
                                        else
                                            {8077}let pkDisco_6717: bitstring = fail-any in
                                            {8078}in(c, (=pkCli_6665,m1_6718: bitstring,sigM1_6719: bitstring));
                                            {8079}if (verify(m1_6718,sigM1_6719,pkCli_6665) <> true) then
                                                0
                                            else
                                                {8080}let (=Sess_5512,SPc_6720: bitstring,PartC_6721: bitstring) = m1_6718 in
                                                {8081}new Ns_6722: bitstring;
                                                {8082}let m2_6723: bitstring = (Cli_5510,exp(g,Ns_6722)) in
                                                {8083}out(c, (m2_6723,sign(m2_6723,skSess_6360)));
                                                {8084}let Ksrv_6724: bitstring = exp(PartC_6721,Ns_6722) in
                                                {8085}out(c, senc(mSrv(pkCli_6665,pkSess_6361),Ksrv_6724))
                            )
                            else
                                {8086}let pkCli_6725: bitstring = fail-any in
                                {8087}let v_6726: bool = (Disco_5511 = A) in
                                (
                                    {8088}if v_6726 then
                                    (
                                        {8089}let pkDisco_6727: bitstring = pub(skA) in
                                        {8090}in(c, (=pkCli_6725,m1_6728: bitstring,sigM1_6729: bitstring));
                                        {8091}if (verify(m1_6728,sigM1_6729,pkCli_6725) <> true) then
                                            0
                                        else
                                            {8092}let (=Sess_5512,SPc_6730: bitstring,PartC_6731: bitstring) = m1_6728 in
                                            {8093}new Ns_6732: bitstring;
                                            {8094}let m2_6733: bitstring = (Cli_5510,exp(g,Ns_6732)) in
                                            {8095}out(c, (m2_6733,sign(m2_6733,skSess_6360)));
                                            {8096}let Ksrv_6734: bitstring = exp(PartC_6731,Ns_6732) in
                                            {8097}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6734))
                                    )
                                    else
                                        {8098}let v_6735: bool = (Disco_5511 = B) in
                                        (
                                            {8099}if v_6735 then
                                            (
                                                {8100}let pkDisco_6736: bitstring = pub(skB) in
                                                {8101}in(c, (=pkCli_6725,m1_6737: bitstring,sigM1_6738: bitstring));
                                                {8102}if (verify(m1_6737,sigM1_6738,pkCli_6725) <> true) then
                                                    0
                                                else
                                                    {8103}let (=Sess_5512,SPc_6739: bitstring,PartC_6740: bitstring) = m1_6737 in
                                                    {8104}new Ns_6741: bitstring;
                                                    {8105}let m2_6742: bitstring = (Cli_5510,exp(g,Ns_6741)) in
                                                    {8106}out(c, (m2_6742,sign(m2_6742,skSess_6360)));
                                                    {8107}let Ksrv_6743: bitstring = exp(PartC_6740,Ns_6741) in
                                                    {8108}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6743))
                                            )
                                            else
                                                {8109}let v_6744: bool = (Disco_5511 = C) in
                                                (
                                                    {8110}if v_6744 then
                                                    (
                                                        {8111}let pkDisco_6745: bitstring = pub(skC) in
                                                        {8112}in(c, (=pkCli_6725,m1_6746: bitstring,sigM1_6747: bitstring));
                                                        {8113}if (verify(m1_6746,sigM1_6747,pkCli_6725) <> true) then
                                                            0
                                                        else
                                                            {8114}let (=Sess_5512,SPc_6748: bitstring,PartC_6749: bitstring) = m1_6746 in
                                                            {8115}new Ns_6750: bitstring;
                                                            {8116}let m2_6751: bitstring = (Cli_5510,exp(g,Ns_6750)) in
                                                            {8117}out(c, (m2_6751,sign(m2_6751,skSess_6360)));
                                                            {8118}let Ksrv_6752: bitstring = exp(PartC_6749,Ns_6750) in
                                                            {8119}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6752))
                                                    )
                                                    else
                                                        {8120}let pkDisco_6753: bitstring = pub(skI) in
                                                        {8121}in(c, (=pkCli_6725,m1_6754: bitstring,sigM1_6755: bitstring));
                                                        {8122}if (verify(m1_6754,sigM1_6755,pkCli_6725) <> true) then
                                                            0
                                                        else
                                                            {8123}let (=Sess_5512,SPc_6756: bitstring,PartC_6757: bitstring) = m1_6754 in
                                                            {8124}new Ns_6758: bitstring;
                                                            {8125}let m2_6759: bitstring = (Cli_5510,exp(g,Ns_6758)) in
                                                            {8126}out(c, (m2_6759,sign(m2_6759,skSess_6360)));
                                                            {8127}let Ksrv_6760: bitstring = exp(PartC_6757,Ns_6758) in
                                                            {8128}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6760))
                                                )
                                                else
                                                    {8129}let pkDisco_6761: bitstring = fail-any in
                                                    {8130}in(c, (=pkCli_6725,m1_6762: bitstring,sigM1_6763: bitstring));
                                                    {8131}if (verify(m1_6762,sigM1_6763,pkCli_6725) <> true) then
                                                        0
                                                    else
                                                        {8132}let (=Sess_5512,SPc_6764: bitstring,PartC_6765: bitstring) = m1_6762 in
                                                        {8133}new Ns_6766: bitstring;
                                                        {8134}let m2_6767: bitstring = (Cli_5510,exp(g,Ns_6766)) in
                                                        {8135}out(c, (m2_6767,sign(m2_6767,skSess_6360)));
                                                        {8136}let Ksrv_6768: bitstring = exp(PartC_6765,Ns_6766) in
                                                        {8137}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6768))
                                        )
                                        else
                                            {8138}let pkDisco_6769: bitstring = fail-any in
                                            {8139}in(c, (=pkCli_6725,m1_6770: bitstring,sigM1_6771: bitstring));
                                            {8140}if (verify(m1_6770,sigM1_6771,pkCli_6725) <> true) then
                                                0
                                            else
                                                {8141}let (=Sess_5512,SPc_6772: bitstring,PartC_6773: bitstring) = m1_6770 in
                                                {8142}new Ns_6774: bitstring;
                                                {8143}let m2_6775: bitstring = (Cli_5510,exp(g,Ns_6774)) in
                                                {8144}out(c, (m2_6775,sign(m2_6775,skSess_6360)));
                                                {8145}let Ksrv_6776: bitstring = exp(PartC_6773,Ns_6774) in
                                                {8146}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6776))
                                )
                                else
                                    {8147}let pkDisco_6777: bitstring = fail-any in
                                    {8148}in(c, (=pkCli_6725,m1_6778: bitstring,sigM1_6779: bitstring));
                                    {8149}if (verify(m1_6778,sigM1_6779,pkCli_6725) <> true) then
                                        0
                                    else
                                        {8150}let (=Sess_5512,SPc_6780: bitstring,PartC_6781: bitstring) = m1_6778 in
                                        {8151}new Ns_6782: bitstring;
                                        {8152}let m2_6783: bitstring = (Cli_5510,exp(g,Ns_6782)) in
                                        {8153}out(c, (m2_6783,sign(m2_6783,skSess_6360)));
                                        {8154}let Ksrv_6784: bitstring = exp(PartC_6781,Ns_6782) in
                                        {8155}out(c, senc(mSrv(pkCli_6725,pkSess_6361),Ksrv_6784))
                        )
                        else
                            {8156}let skSess_6785: bitstring = skI in
                            {8157}let pkSess_6786: bitstring = pub(skSess_6785) in
                            {8158}let v_6787: bool = (Cli_5510 = A) in
                            (
                                {8159}if v_6787 then
                                (
                                    {8160}let pkCli_6788: bitstring = pub(skA) in
                                    {8161}let v_6789: bool = (Disco_5511 = A) in
                                    (
                                        {8162}if v_6789 then
                                        (
                                            {8163}let pkDisco_6790: bitstring = pub(skA) in
                                            {8164}in(c, (=pkCli_6788,m1_6791: bitstring,sigM1_6792: bitstring));
                                            {8165}if (verify(m1_6791,sigM1_6792,pkCli_6788) <> true) then
                                                0
                                            else
                                                {8166}let (=Sess_5512,SPc_6793: bitstring,PartC_6794: bitstring) = m1_6791 in
                                                {8167}new Ns_6795: bitstring;
                                                {8168}let m2_6796: bitstring = (Cli_5510,exp(g,Ns_6795)) in
                                                {8169}out(c, (m2_6796,sign(m2_6796,skSess_6785)));
                                                {8170}let Ksrv_6797: bitstring = exp(PartC_6794,Ns_6795) in
                                                {8171}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6797))
                                        )
                                        else
                                            {8172}let v_6798: bool = (Disco_5511 = B) in
                                            (
                                                {8173}if v_6798 then
                                                (
                                                    {8174}let pkDisco_6799: bitstring = pub(skB) in
                                                    {8175}in(c, (=pkCli_6788,m1_6800: bitstring,sigM1_6801: bitstring));
                                                    {8176}if (verify(m1_6800,sigM1_6801,pkCli_6788) <> true) then
                                                        0
                                                    else
                                                        {8177}let (=Sess_5512,SPc_6802: bitstring,PartC_6803: bitstring) = m1_6800 in
                                                        {8178}new Ns_6804: bitstring;
                                                        {8179}let m2_6805: bitstring = (Cli_5510,exp(g,Ns_6804)) in
                                                        {8180}out(c, (m2_6805,sign(m2_6805,skSess_6785)));
                                                        {8181}let Ksrv_6806: bitstring = exp(PartC_6803,Ns_6804) in
                                                        {8182}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6806))
                                                )
                                                else
                                                    {8183}let v_6807: bool = (Disco_5511 = C) in
                                                    (
                                                        {8184}if v_6807 then
                                                        (
                                                            {8185}let pkDisco_6808: bitstring = pub(skC) in
                                                            {8186}in(c, (=pkCli_6788,m1_6809: bitstring,sigM1_6810: bitstring));
                                                            {8187}if (verify(m1_6809,sigM1_6810,pkCli_6788) <> true) then
                                                                0
                                                            else
                                                                {8188}let (=Sess_5512,SPc_6811: bitstring,PartC_6812: bitstring) = m1_6809 in
                                                                {8189}new Ns_6813: bitstring;
                                                                {8190}let m2_6814: bitstring = (Cli_5510,exp(g,Ns_6813)) in
                                                                {8191}out(c, (m2_6814,sign(m2_6814,skSess_6785)));
                                                                {8192}let Ksrv_6815: bitstring = exp(PartC_6812,Ns_6813) in
                                                                {8193}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6815))
                                                        )
                                                        else
                                                            {8194}let pkDisco_6816: bitstring = pub(skI) in
                                                            {8195}in(c, (=pkCli_6788,m1_6817: bitstring,sigM1_6818: bitstring));
                                                            {8196}if (verify(m1_6817,sigM1_6818,pkCli_6788) <> true) then
                                                                0
                                                            else
                                                                {8197}let (=Sess_5512,SPc_6819: bitstring,PartC_6820: bitstring) = m1_6817 in
                                                                {8198}new Ns_6821: bitstring;
                                                                {8199}let m2_6822: bitstring = (Cli_5510,exp(g,Ns_6821)) in
                                                                {8200}out(c, (m2_6822,sign(m2_6822,skSess_6785)));
                                                                {8201}let Ksrv_6823: bitstring = exp(PartC_6820,Ns_6821) in
                                                                {8202}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6823))
                                                    )
                                                    else
                                                        {8203}let pkDisco_6824: bitstring = fail-any in
                                                        {8204}in(c, (=pkCli_6788,m1_6825: bitstring,sigM1_6826: bitstring));
                                                        {8205}if (verify(m1_6825,sigM1_6826,pkCli_6788) <> true) then
                                                            0
                                                        else
                                                            {8206}let (=Sess_5512,SPc_6827: bitstring,PartC_6828: bitstring) = m1_6825 in
                                                            {8207}new Ns_6829: bitstring;
                                                            {8208}let m2_6830: bitstring = (Cli_5510,exp(g,Ns_6829)) in
                                                            {8209}out(c, (m2_6830,sign(m2_6830,skSess_6785)));
                                                            {8210}let Ksrv_6831: bitstring = exp(PartC_6828,Ns_6829) in
                                                            {8211}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6831))
                                            )
                                            else
                                                {8212}let pkDisco_6832: bitstring = fail-any in
                                                {8213}in(c, (=pkCli_6788,m1_6833: bitstring,sigM1_6834: bitstring));
                                                {8214}if (verify(m1_6833,sigM1_6834,pkCli_6788) <> true) then
                                                    0
                                                else
                                                    {8215}let (=Sess_5512,SPc_6835: bitstring,PartC_6836: bitstring) = m1_6833 in
                                                    {8216}new Ns_6837: bitstring;
                                                    {8217}let m2_6838: bitstring = (Cli_5510,exp(g,Ns_6837)) in
                                                    {8218}out(c, (m2_6838,sign(m2_6838,skSess_6785)));
                                                    {8219}let Ksrv_6839: bitstring = exp(PartC_6836,Ns_6837) in
                                                    {8220}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6839))
                                    )
                                    else
                                        {8221}let pkDisco_6840: bitstring = fail-any in
                                        {8222}in(c, (=pkCli_6788,m1_6841: bitstring,sigM1_6842: bitstring));
                                        {8223}if (verify(m1_6841,sigM1_6842,pkCli_6788) <> true) then
                                            0
                                        else
                                            {8224}let (=Sess_5512,SPc_6843: bitstring,PartC_6844: bitstring) = m1_6841 in
                                            {8225}new Ns_6845: bitstring;
                                            {8226}let m2_6846: bitstring = (Cli_5510,exp(g,Ns_6845)) in
                                            {8227}out(c, (m2_6846,sign(m2_6846,skSess_6785)));
                                            {8228}let Ksrv_6847: bitstring = exp(PartC_6844,Ns_6845) in
                                            {8229}out(c, senc(mSrv(pkCli_6788,pkSess_6786),Ksrv_6847))
                                )
                                else
                                    {8230}let v_6848: bool = (Cli_5510 = B) in
                                    (
                                        {8231}if v_6848 then
                                        (
                                            {8232}let pkCli_6849: bitstring = pub(skB) in
                                            {8233}let v_6850: bool = (Disco_5511 = A) in
                                            (
                                                {8234}if v_6850 then
                                                (
                                                    {8235}let pkDisco_6851: bitstring = pub(skA) in
                                                    {8236}in(c, (=pkCli_6849,m1_6852: bitstring,sigM1_6853: bitstring));
                                                    {8237}if (verify(m1_6852,sigM1_6853,pkCli_6849) <> true) then
                                                        0
                                                    else
                                                        {8238}let (=Sess_5512,SPc_6854: bitstring,PartC_6855: bitstring) = m1_6852 in
                                                        {8239}new Ns_6856: bitstring;
                                                        {8240}let m2_6857: bitstring = (Cli_5510,exp(g,Ns_6856)) in
                                                        {8241}out(c, (m2_6857,sign(m2_6857,skSess_6785)));
                                                        {8242}let Ksrv_6858: bitstring = exp(PartC_6855,Ns_6856) in
                                                        {8243}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6858))
                                                )
                                                else
                                                    {8244}let v_6859: bool = (Disco_5511 = B) in
                                                    (
                                                        {8245}if v_6859 then
                                                        (
                                                            {8246}let pkDisco_6860: bitstring = pub(skB) in
                                                            {8247}in(c, (=pkCli_6849,m1_6861: bitstring,sigM1_6862: bitstring));
                                                            {8248}if (verify(m1_6861,sigM1_6862,pkCli_6849) <> true) then
                                                                0
                                                            else
                                                                {8249}let (=Sess_5512,SPc_6863: bitstring,PartC_6864: bitstring) = m1_6861 in
                                                                {8250}new Ns_6865: bitstring;
                                                                {8251}let m2_6866: bitstring = (Cli_5510,exp(g,Ns_6865)) in
                                                                {8252}out(c, (m2_6866,sign(m2_6866,skSess_6785)));
                                                                {8253}let Ksrv_6867: bitstring = exp(PartC_6864,Ns_6865) in
                                                                {8254}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6867))
                                                        )
                                                        else
                                                            {8255}let v_6868: bool = (Disco_5511 = C) in
                                                            (
                                                                {8256}if v_6868 then
                                                                (
                                                                    {8257}let pkDisco_6869: bitstring = pub(skC) in
                                                                    {8258}in(c, (=pkCli_6849,m1_6870: bitstring,sigM1_6871: bitstring));
                                                                    {8259}if (verify(m1_6870,sigM1_6871,pkCli_6849) <> true) then
                                                                        0
                                                                    else
                                                                        {8260}let (=Sess_5512,SPc_6872: bitstring,PartC_6873: bitstring) = m1_6870 in
                                                                        {8261}new Ns_6874: bitstring;
                                                                        {8262}let m2_6875: bitstring = (Cli_5510,exp(g,Ns_6874)) in
                                                                        {8263}out(c, (m2_6875,sign(m2_6875,skSess_6785)));
                                                                        {8264}let Ksrv_6876: bitstring = exp(PartC_6873,Ns_6874) in
                                                                        {8265}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6876))
                                                                )
                                                                else
                                                                    {8266}let pkDisco_6877: bitstring = pub(skI) in
                                                                    {8267}in(c, (=pkCli_6849,m1_6878: bitstring,sigM1_6879: bitstring));
                                                                    {8268}if (verify(m1_6878,sigM1_6879,pkCli_6849) <> true) then
                                                                        0
                                                                    else
                                                                        {8269}let (=Sess_5512,SPc_6880: bitstring,PartC_6881: bitstring) = m1_6878 in
                                                                        {8270}new Ns_6882: bitstring;
                                                                        {8271}let m2_6883: bitstring = (Cli_5510,exp(g,Ns_6882)) in
                                                                        {8272}out(c, (m2_6883,sign(m2_6883,skSess_6785)));
                                                                        {8273}let Ksrv_6884: bitstring = exp(PartC_6881,Ns_6882) in
                                                                        {8274}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6884))
                                                            )
                                                            else
                                                                {8275}let pkDisco_6885: bitstring = fail-any in
                                                                {8276}in(c, (=pkCli_6849,m1_6886: bitstring,sigM1_6887: bitstring));
                                                                {8277}if (verify(m1_6886,sigM1_6887,pkCli_6849) <> true) then
                                                                    0
                                                                else
                                                                    {8278}let (=Sess_5512,SPc_6888: bitstring,PartC_6889: bitstring) = m1_6886 in
                                                                    {8279}new Ns_6890: bitstring;
                                                                    {8280}let m2_6891: bitstring = (Cli_5510,exp(g,Ns_6890)) in
                                                                    {8281}out(c, (m2_6891,sign(m2_6891,skSess_6785)));
                                                                    {8282}let Ksrv_6892: bitstring = exp(PartC_6889,Ns_6890) in
                                                                    {8283}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6892))
                                                    )
                                                    else
                                                        {8284}let pkDisco_6893: bitstring = fail-any in
                                                        {8285}in(c, (=pkCli_6849,m1_6894: bitstring,sigM1_6895: bitstring));
                                                        {8286}if (verify(m1_6894,sigM1_6895,pkCli_6849) <> true) then
                                                            0
                                                        else
                                                            {8287}let (=Sess_5512,SPc_6896: bitstring,PartC_6897: bitstring) = m1_6894 in
                                                            {8288}new Ns_6898: bitstring;
                                                            {8289}let m2_6899: bitstring = (Cli_5510,exp(g,Ns_6898)) in
                                                            {8290}out(c, (m2_6899,sign(m2_6899,skSess_6785)));
                                                            {8291}let Ksrv_6900: bitstring = exp(PartC_6897,Ns_6898) in
                                                            {8292}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6900))
                                            )
                                            else
                                                {8293}let pkDisco_6901: bitstring = fail-any in
                                                {8294}in(c, (=pkCli_6849,m1_6902: bitstring,sigM1_6903: bitstring));
                                                {8295}if (verify(m1_6902,sigM1_6903,pkCli_6849) <> true) then
                                                    0
                                                else
                                                    {8296}let (=Sess_5512,SPc_6904: bitstring,PartC_6905: bitstring) = m1_6902 in
                                                    {8297}new Ns_6906: bitstring;
                                                    {8298}let m2_6907: bitstring = (Cli_5510,exp(g,Ns_6906)) in
                                                    {8299}out(c, (m2_6907,sign(m2_6907,skSess_6785)));
                                                    {8300}let Ksrv_6908: bitstring = exp(PartC_6905,Ns_6906) in
                                                    {8301}out(c, senc(mSrv(pkCli_6849,pkSess_6786),Ksrv_6908))
                                        )
                                        else
                                            {8302}let v_6909: bool = (Cli_5510 = C) in
                                            (
                                                {8303}if v_6909 then
                                                (
                                                    {8304}let pkCli_6910: bitstring = pub(skC) in
                                                    {8305}let v_6911: bool = (Disco_5511 = A) in
                                                    (
                                                        {8306}if v_6911 then
                                                        (
                                                            {8307}let pkDisco_6912: bitstring = pub(skA) in
                                                            {8308}in(c, (=pkCli_6910,m1_6913: bitstring,sigM1_6914: bitstring));
                                                            {8309}if (verify(m1_6913,sigM1_6914,pkCli_6910) <> true) then
                                                                0
                                                            else
                                                                {8310}let (=Sess_5512,SPc_6915: bitstring,PartC_6916: bitstring) = m1_6913 in
                                                                {8311}new Ns_6917: bitstring;
                                                                {8312}let m2_6918: bitstring = (Cli_5510,exp(g,Ns_6917)) in
                                                                {8313}out(c, (m2_6918,sign(m2_6918,skSess_6785)));
                                                                {8314}let Ksrv_6919: bitstring = exp(PartC_6916,Ns_6917) in
                                                                {8315}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6919))
                                                        )
                                                        else
                                                            {8316}let v_6920: bool = (Disco_5511 = B) in
                                                            (
                                                                {8317}if v_6920 then
                                                                (
                                                                    {8318}let pkDisco_6921: bitstring = pub(skB) in
                                                                    {8319}in(c, (=pkCli_6910,m1_6922: bitstring,sigM1_6923: bitstring));
                                                                    {8320}if (verify(m1_6922,sigM1_6923,pkCli_6910) <> true) then
                                                                        0
                                                                    else
                                                                        {8321}let (=Sess_5512,SPc_6924: bitstring,PartC_6925: bitstring) = m1_6922 in
                                                                        {8322}new Ns_6926: bitstring;
                                                                        {8323}let m2_6927: bitstring = (Cli_5510,exp(g,Ns_6926)) in
                                                                        {8324}out(c, (m2_6927,sign(m2_6927,skSess_6785)));
                                                                        {8325}let Ksrv_6928: bitstring = exp(PartC_6925,Ns_6926) in
                                                                        {8326}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6928))
                                                                )
                                                                else
                                                                    {8327}let v_6929: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8328}if v_6929 then
                                                                        (
                                                                            {8329}let pkDisco_6930: bitstring = pub(skC) in
                                                                            {8330}in(c, (=pkCli_6910,m1_6931: bitstring,sigM1_6932: bitstring));
                                                                            {8331}if (verify(m1_6931,sigM1_6932,pkCli_6910) <> true) then
                                                                                0
                                                                            else
                                                                                {8332}let (=Sess_5512,SPc_6933: bitstring,PartC_6934: bitstring) = m1_6931 in
                                                                                {8333}new Ns_6935: bitstring;
                                                                                {8334}let m2_6936: bitstring = (Cli_5510,exp(g,Ns_6935)) in
                                                                                {8335}out(c, (m2_6936,sign(m2_6936,skSess_6785)));
                                                                                {8336}let Ksrv_6937: bitstring = exp(PartC_6934,Ns_6935) in
                                                                                {8337}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6937))
                                                                        )
                                                                        else
                                                                            {8338}let pkDisco_6938: bitstring = pub(skI) in
                                                                            {8339}in(c, (=pkCli_6910,m1_6939: bitstring,sigM1_6940: bitstring));
                                                                            {8340}if (verify(m1_6939,sigM1_6940,pkCli_6910) <> true) then
                                                                                0
                                                                            else
                                                                                {8341}let (=Sess_5512,SPc_6941: bitstring,PartC_6942: bitstring) = m1_6939 in
                                                                                {8342}new Ns_6943: bitstring;
                                                                                {8343}let m2_6944: bitstring = (Cli_5510,exp(g,Ns_6943)) in
                                                                                {8344}out(c, (m2_6944,sign(m2_6944,skSess_6785)));
                                                                                {8345}let Ksrv_6945: bitstring = exp(PartC_6942,Ns_6943) in
                                                                                {8346}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6945))
                                                                    )
                                                                    else
                                                                        {8347}let pkDisco_6946: bitstring = fail-any in
                                                                        {8348}in(c, (=pkCli_6910,m1_6947: bitstring,sigM1_6948: bitstring));
                                                                        {8349}if (verify(m1_6947,sigM1_6948,pkCli_6910) <> true) then
                                                                            0
                                                                        else
                                                                            {8350}let (=Sess_5512,SPc_6949: bitstring,PartC_6950: bitstring) = m1_6947 in
                                                                            {8351}new Ns_6951: bitstring;
                                                                            {8352}let m2_6952: bitstring = (Cli_5510,exp(g,Ns_6951)) in
                                                                            {8353}out(c, (m2_6952,sign(m2_6952,skSess_6785)));
                                                                            {8354}let Ksrv_6953: bitstring = exp(PartC_6950,Ns_6951) in
                                                                            {8355}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6953))
                                                            )
                                                            else
                                                                {8356}let pkDisco_6954: bitstring = fail-any in
                                                                {8357}in(c, (=pkCli_6910,m1_6955: bitstring,sigM1_6956: bitstring));
                                                                {8358}if (verify(m1_6955,sigM1_6956,pkCli_6910) <> true) then
                                                                    0
                                                                else
                                                                    {8359}let (=Sess_5512,SPc_6957: bitstring,PartC_6958: bitstring) = m1_6955 in
                                                                    {8360}new Ns_6959: bitstring;
                                                                    {8361}let m2_6960: bitstring = (Cli_5510,exp(g,Ns_6959)) in
                                                                    {8362}out(c, (m2_6960,sign(m2_6960,skSess_6785)));
                                                                    {8363}let Ksrv_6961: bitstring = exp(PartC_6958,Ns_6959) in
                                                                    {8364}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6961))
                                                    )
                                                    else
                                                        {8365}let pkDisco_6962: bitstring = fail-any in
                                                        {8366}in(c, (=pkCli_6910,m1_6963: bitstring,sigM1_6964: bitstring));
                                                        {8367}if (verify(m1_6963,sigM1_6964,pkCli_6910) <> true) then
                                                            0
                                                        else
                                                            {8368}let (=Sess_5512,SPc_6965: bitstring,PartC_6966: bitstring) = m1_6963 in
                                                            {8369}new Ns_6967: bitstring;
                                                            {8370}let m2_6968: bitstring = (Cli_5510,exp(g,Ns_6967)) in
                                                            {8371}out(c, (m2_6968,sign(m2_6968,skSess_6785)));
                                                            {8372}let Ksrv_6969: bitstring = exp(PartC_6966,Ns_6967) in
                                                            {8373}out(c, senc(mSrv(pkCli_6910,pkSess_6786),Ksrv_6969))
                                                )
                                                else
                                                    {8374}let pkCli_6970: bitstring = pub(skI) in
                                                    {8375}let v_6971: bool = (Disco_5511 = A) in
                                                    (
                                                        {8376}if v_6971 then
                                                        (
                                                            {8377}let pkDisco_6972: bitstring = pub(skA) in
                                                            {8378}in(c, (=pkCli_6970,m1_6973: bitstring,sigM1_6974: bitstring));
                                                            {8379}if (verify(m1_6973,sigM1_6974,pkCli_6970) <> true) then
                                                                0
                                                            else
                                                                {8380}let (=Sess_5512,SPc_6975: bitstring,PartC_6976: bitstring) = m1_6973 in
                                                                {8381}new Ns_6977: bitstring;
                                                                {8382}let m2_6978: bitstring = (Cli_5510,exp(g,Ns_6977)) in
                                                                {8383}out(c, (m2_6978,sign(m2_6978,skSess_6785)));
                                                                {8384}let Ksrv_6979: bitstring = exp(PartC_6976,Ns_6977) in
                                                                {8385}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_6979))
                                                        )
                                                        else
                                                            {8386}let v_6980: bool = (Disco_5511 = B) in
                                                            (
                                                                {8387}if v_6980 then
                                                                (
                                                                    {8388}let pkDisco_6981: bitstring = pub(skB) in
                                                                    {8389}in(c, (=pkCli_6970,m1_6982: bitstring,sigM1_6983: bitstring));
                                                                    {8390}if (verify(m1_6982,sigM1_6983,pkCli_6970) <> true) then
                                                                        0
                                                                    else
                                                                        {8391}let (=Sess_5512,SPc_6984: bitstring,PartC_6985: bitstring) = m1_6982 in
                                                                        {8392}new Ns_6986: bitstring;
                                                                        {8393}let m2_6987: bitstring = (Cli_5510,exp(g,Ns_6986)) in
                                                                        {8394}out(c, (m2_6987,sign(m2_6987,skSess_6785)));
                                                                        {8395}let Ksrv_6988: bitstring = exp(PartC_6985,Ns_6986) in
                                                                        {8396}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_6988))
                                                                )
                                                                else
                                                                    {8397}let v_6989: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8398}if v_6989 then
                                                                        (
                                                                            {8399}let pkDisco_6990: bitstring = pub(skC) in
                                                                            {8400}in(c, (=pkCli_6970,m1_6991: bitstring,sigM1_6992: bitstring));
                                                                            {8401}if (verify(m1_6991,sigM1_6992,pkCli_6970) <> true) then
                                                                                0
                                                                            else
                                                                                {8402}let (=Sess_5512,SPc_6993: bitstring,PartC_6994: bitstring) = m1_6991 in
                                                                                {8403}new Ns_6995: bitstring;
                                                                                {8404}let m2_6996: bitstring = (Cli_5510,exp(g,Ns_6995)) in
                                                                                {8405}out(c, (m2_6996,sign(m2_6996,skSess_6785)));
                                                                                {8406}let Ksrv_6997: bitstring = exp(PartC_6994,Ns_6995) in
                                                                                {8407}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_6997))
                                                                        )
                                                                        else
                                                                            {8408}let pkDisco_6998: bitstring = pub(skI) in
                                                                            {8409}in(c, (=pkCli_6970,m1_6999: bitstring,sigM1_7000: bitstring));
                                                                            {8410}if (verify(m1_6999,sigM1_7000,pkCli_6970) <> true) then
                                                                                0
                                                                            else
                                                                                {8411}let (=Sess_5512,SPc_7001: bitstring,PartC_7002: bitstring) = m1_6999 in
                                                                                {8412}new Ns_7003: bitstring;
                                                                                {8413}let m2_7004: bitstring = (Cli_5510,exp(g,Ns_7003)) in
                                                                                {8414}out(c, (m2_7004,sign(m2_7004,skSess_6785)));
                                                                                {8415}let Ksrv_7005: bitstring = exp(PartC_7002,Ns_7003) in
                                                                                {8416}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_7005))
                                                                    )
                                                                    else
                                                                        {8417}let pkDisco_7006: bitstring = fail-any in
                                                                        {8418}in(c, (=pkCli_6970,m1_7007: bitstring,sigM1_7008: bitstring));
                                                                        {8419}if (verify(m1_7007,sigM1_7008,pkCli_6970) <> true) then
                                                                            0
                                                                        else
                                                                            {8420}let (=Sess_5512,SPc_7009: bitstring,PartC_7010: bitstring) = m1_7007 in
                                                                            {8421}new Ns_7011: bitstring;
                                                                            {8422}let m2_7012: bitstring = (Cli_5510,exp(g,Ns_7011)) in
                                                                            {8423}out(c, (m2_7012,sign(m2_7012,skSess_6785)));
                                                                            {8424}let Ksrv_7013: bitstring = exp(PartC_7010,Ns_7011) in
                                                                            {8425}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_7013))
                                                            )
                                                            else
                                                                {8426}let pkDisco_7014: bitstring = fail-any in
                                                                {8427}in(c, (=pkCli_6970,m1_7015: bitstring,sigM1_7016: bitstring));
                                                                {8428}if (verify(m1_7015,sigM1_7016,pkCli_6970) <> true) then
                                                                    0
                                                                else
                                                                    {8429}let (=Sess_5512,SPc_7017: bitstring,PartC_7018: bitstring) = m1_7015 in
                                                                    {8430}new Ns_7019: bitstring;
                                                                    {8431}let m2_7020: bitstring = (Cli_5510,exp(g,Ns_7019)) in
                                                                    {8432}out(c, (m2_7020,sign(m2_7020,skSess_6785)));
                                                                    {8433}let Ksrv_7021: bitstring = exp(PartC_7018,Ns_7019) in
                                                                    {8434}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_7021))
                                                    )
                                                    else
                                                        {8435}let pkDisco_7022: bitstring = fail-any in
                                                        {8436}in(c, (=pkCli_6970,m1_7023: bitstring,sigM1_7024: bitstring));
                                                        {8437}if (verify(m1_7023,sigM1_7024,pkCli_6970) <> true) then
                                                            0
                                                        else
                                                            {8438}let (=Sess_5512,SPc_7025: bitstring,PartC_7026: bitstring) = m1_7023 in
                                                            {8439}new Ns_7027: bitstring;
                                                            {8440}let m2_7028: bitstring = (Cli_5510,exp(g,Ns_7027)) in
                                                            {8441}out(c, (m2_7028,sign(m2_7028,skSess_6785)));
                                                            {8442}let Ksrv_7029: bitstring = exp(PartC_7026,Ns_7027) in
                                                            {8443}out(c, senc(mSrv(pkCli_6970,pkSess_6786),Ksrv_7029))
                                            )
                                            else
                                                {8444}let pkCli_7030: bitstring = fail-any in
                                                {8445}let v_7031: bool = (Disco_5511 = A) in
                                                (
                                                    {8446}if v_7031 then
                                                    (
                                                        {8447}let pkDisco_7032: bitstring = pub(skA) in
                                                        {8448}in(c, (=pkCli_7030,m1_7033: bitstring,sigM1_7034: bitstring));
                                                        {8449}if (verify(m1_7033,sigM1_7034,pkCli_7030) <> true) then
                                                            0
                                                        else
                                                            {8450}let (=Sess_5512,SPc_7035: bitstring,PartC_7036: bitstring) = m1_7033 in
                                                            {8451}new Ns_7037: bitstring;
                                                            {8452}let m2_7038: bitstring = (Cli_5510,exp(g,Ns_7037)) in
                                                            {8453}out(c, (m2_7038,sign(m2_7038,skSess_6785)));
                                                            {8454}let Ksrv_7039: bitstring = exp(PartC_7036,Ns_7037) in
                                                            {8455}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7039))
                                                    )
                                                    else
                                                        {8456}let v_7040: bool = (Disco_5511 = B) in
                                                        (
                                                            {8457}if v_7040 then
                                                            (
                                                                {8458}let pkDisco_7041: bitstring = pub(skB) in
                                                                {8459}in(c, (=pkCli_7030,m1_7042: bitstring,sigM1_7043: bitstring));
                                                                {8460}if (verify(m1_7042,sigM1_7043,pkCli_7030) <> true) then
                                                                    0
                                                                else
                                                                    {8461}let (=Sess_5512,SPc_7044: bitstring,PartC_7045: bitstring) = m1_7042 in
                                                                    {8462}new Ns_7046: bitstring;
                                                                    {8463}let m2_7047: bitstring = (Cli_5510,exp(g,Ns_7046)) in
                                                                    {8464}out(c, (m2_7047,sign(m2_7047,skSess_6785)));
                                                                    {8465}let Ksrv_7048: bitstring = exp(PartC_7045,Ns_7046) in
                                                                    {8466}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7048))
                                                            )
                                                            else
                                                                {8467}let v_7049: bool = (Disco_5511 = C) in
                                                                (
                                                                    {8468}if v_7049 then
                                                                    (
                                                                        {8469}let pkDisco_7050: bitstring = pub(skC) in
                                                                        {8470}in(c, (=pkCli_7030,m1_7051: bitstring,sigM1_7052: bitstring));
                                                                        {8471}if (verify(m1_7051,sigM1_7052,pkCli_7030) <> true) then
                                                                            0
                                                                        else
                                                                            {8472}let (=Sess_5512,SPc_7053: bitstring,PartC_7054: bitstring) = m1_7051 in
                                                                            {8473}new Ns_7055: bitstring;
                                                                            {8474}let m2_7056: bitstring = (Cli_5510,exp(g,Ns_7055)) in
                                                                            {8475}out(c, (m2_7056,sign(m2_7056,skSess_6785)));
                                                                            {8476}let Ksrv_7057: bitstring = exp(PartC_7054,Ns_7055) in
                                                                            {8477}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7057))
                                                                    )
                                                                    else
                                                                        {8478}let pkDisco_7058: bitstring = pub(skI) in
                                                                        {8479}in(c, (=pkCli_7030,m1_7059: bitstring,sigM1_7060: bitstring));
                                                                        {8480}if (verify(m1_7059,sigM1_7060,pkCli_7030) <> true) then
                                                                            0
                                                                        else
                                                                            {8481}let (=Sess_5512,SPc_7061: bitstring,PartC_7062: bitstring) = m1_7059 in
                                                                            {8482}new Ns_7063: bitstring;
                                                                            {8483}let m2_7064: bitstring = (Cli_5510,exp(g,Ns_7063)) in
                                                                            {8484}out(c, (m2_7064,sign(m2_7064,skSess_6785)));
                                                                            {8485}let Ksrv_7065: bitstring = exp(PartC_7062,Ns_7063) in
                                                                            {8486}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7065))
                                                                )
                                                                else
                                                                    {8487}let pkDisco_7066: bitstring = fail-any in
                                                                    {8488}in(c, (=pkCli_7030,m1_7067: bitstring,sigM1_7068: bitstring));
                                                                    {8489}if (verify(m1_7067,sigM1_7068,pkCli_7030) <> true) then
                                                                        0
                                                                    else
                                                                        {8490}let (=Sess_5512,SPc_7069: bitstring,PartC_7070: bitstring) = m1_7067 in
                                                                        {8491}new Ns_7071: bitstring;
                                                                        {8492}let m2_7072: bitstring = (Cli_5510,exp(g,Ns_7071)) in
                                                                        {8493}out(c, (m2_7072,sign(m2_7072,skSess_6785)));
                                                                        {8494}let Ksrv_7073: bitstring = exp(PartC_7070,Ns_7071) in
                                                                        {8495}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7073))
                                                        )
                                                        else
                                                            {8496}let pkDisco_7074: bitstring = fail-any in
                                                            {8497}in(c, (=pkCli_7030,m1_7075: bitstring,sigM1_7076: bitstring));
                                                            {8498}if (verify(m1_7075,sigM1_7076,pkCli_7030) <> true) then
                                                                0
                                                            else
                                                                {8499}let (=Sess_5512,SPc_7077: bitstring,PartC_7078: bitstring) = m1_7075 in
                                                                {8500}new Ns_7079: bitstring;
                                                                {8501}let m2_7080: bitstring = (Cli_5510,exp(g,Ns_7079)) in
                                                                {8502}out(c, (m2_7080,sign(m2_7080,skSess_6785)));
                                                                {8503}let Ksrv_7081: bitstring = exp(PartC_7078,Ns_7079) in
                                                                {8504}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7081))
                                                )
                                                else
                                                    {8505}let pkDisco_7082: bitstring = fail-any in
                                                    {8506}in(c, (=pkCli_7030,m1_7083: bitstring,sigM1_7084: bitstring));
                                                    {8507}if (verify(m1_7083,sigM1_7084,pkCli_7030) <> true) then
                                                        0
                                                    else
                                                        {8508}let (=Sess_5512,SPc_7085: bitstring,PartC_7086: bitstring) = m1_7083 in
                                                        {8509}new Ns_7087: bitstring;
                                                        {8510}let m2_7088: bitstring = (Cli_5510,exp(g,Ns_7087)) in
                                                        {8511}out(c, (m2_7088,sign(m2_7088,skSess_6785)));
                                                        {8512}let Ksrv_7089: bitstring = exp(PartC_7086,Ns_7087) in
                                                        {8513}out(c, senc(mSrv(pkCli_7030,pkSess_6786),Ksrv_7089))
                                    )
                                    else
                                        {8514}let pkCli_7090: bitstring = fail-any in
                                        {8515}let v_7091: bool = (Disco_5511 = A) in
                                        (
                                            {8516}if v_7091 then
                                            (
                                                {8517}let pkDisco_7092: bitstring = pub(skA) in
                                                {8518}in(c, (=pkCli_7090,m1_7093: bitstring,sigM1_7094: bitstring));
                                                {8519}if (verify(m1_7093,sigM1_7094,pkCli_7090) <> true) then
                                                    0
                                                else
                                                    {8520}let (=Sess_5512,SPc_7095: bitstring,PartC_7096: bitstring) = m1_7093 in
                                                    {8521}new Ns_7097: bitstring;
                                                    {8522}let m2_7098: bitstring = (Cli_5510,exp(g,Ns_7097)) in
                                                    {8523}out(c, (m2_7098,sign(m2_7098,skSess_6785)));
                                                    {8524}let Ksrv_7099: bitstring = exp(PartC_7096,Ns_7097) in
                                                    {8525}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7099))
                                            )
                                            else
                                                {8526}let v_7100: bool = (Disco_5511 = B) in
                                                (
                                                    {8527}if v_7100 then
                                                    (
                                                        {8528}let pkDisco_7101: bitstring = pub(skB) in
                                                        {8529}in(c, (=pkCli_7090,m1_7102: bitstring,sigM1_7103: bitstring));
                                                        {8530}if (verify(m1_7102,sigM1_7103,pkCli_7090) <> true) then
                                                            0
                                                        else
                                                            {8531}let (=Sess_5512,SPc_7104: bitstring,PartC_7105: bitstring) = m1_7102 in
                                                            {8532}new Ns_7106: bitstring;
                                                            {8533}let m2_7107: bitstring = (Cli_5510,exp(g,Ns_7106)) in
                                                            {8534}out(c, (m2_7107,sign(m2_7107,skSess_6785)));
                                                            {8535}let Ksrv_7108: bitstring = exp(PartC_7105,Ns_7106) in
                                                            {8536}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7108))
                                                    )
                                                    else
                                                        {8537}let v_7109: bool = (Disco_5511 = C) in
                                                        (
                                                            {8538}if v_7109 then
                                                            (
                                                                {8539}let pkDisco_7110: bitstring = pub(skC) in
                                                                {8540}in(c, (=pkCli_7090,m1_7111: bitstring,sigM1_7112: bitstring));
                                                                {8541}if (verify(m1_7111,sigM1_7112,pkCli_7090) <> true) then
                                                                    0
                                                                else
                                                                    {8542}let (=Sess_5512,SPc_7113: bitstring,PartC_7114: bitstring) = m1_7111 in
                                                                    {8543}new Ns_7115: bitstring;
                                                                    {8544}let m2_7116: bitstring = (Cli_5510,exp(g,Ns_7115)) in
                                                                    {8545}out(c, (m2_7116,sign(m2_7116,skSess_6785)));
                                                                    {8546}let Ksrv_7117: bitstring = exp(PartC_7114,Ns_7115) in
                                                                    {8547}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7117))
                                                            )
                                                            else
                                                                {8548}let pkDisco_7118: bitstring = pub(skI) in
                                                                {8549}in(c, (=pkCli_7090,m1_7119: bitstring,sigM1_7120: bitstring));
                                                                {8550}if (verify(m1_7119,sigM1_7120,pkCli_7090) <> true) then
                                                                    0
                                                                else
                                                                    {8551}let (=Sess_5512,SPc_7121: bitstring,PartC_7122: bitstring) = m1_7119 in
                                                                    {8552}new Ns_7123: bitstring;
                                                                    {8553}let m2_7124: bitstring = (Cli_5510,exp(g,Ns_7123)) in
                                                                    {8554}out(c, (m2_7124,sign(m2_7124,skSess_6785)));
                                                                    {8555}let Ksrv_7125: bitstring = exp(PartC_7122,Ns_7123) in
                                                                    {8556}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7125))
                                                        )
                                                        else
                                                            {8557}let pkDisco_7126: bitstring = fail-any in
                                                            {8558}in(c, (=pkCli_7090,m1_7127: bitstring,sigM1_7128: bitstring));
                                                            {8559}if (verify(m1_7127,sigM1_7128,pkCli_7090) <> true) then
                                                                0
                                                            else
                                                                {8560}let (=Sess_5512,SPc_7129: bitstring,PartC_7130: bitstring) = m1_7127 in
                                                                {8561}new Ns_7131: bitstring;
                                                                {8562}let m2_7132: bitstring = (Cli_5510,exp(g,Ns_7131)) in
                                                                {8563}out(c, (m2_7132,sign(m2_7132,skSess_6785)));
                                                                {8564}let Ksrv_7133: bitstring = exp(PartC_7130,Ns_7131) in
                                                                {8565}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7133))
                                                )
                                                else
                                                    {8566}let pkDisco_7134: bitstring = fail-any in
                                                    {8567}in(c, (=pkCli_7090,m1_7135: bitstring,sigM1_7136: bitstring));
                                                    {8568}if (verify(m1_7135,sigM1_7136,pkCli_7090) <> true) then
                                                        0
                                                    else
                                                        {8569}let (=Sess_5512,SPc_7137: bitstring,PartC_7138: bitstring) = m1_7135 in
                                                        {8570}new Ns_7139: bitstring;
                                                        {8571}let m2_7140: bitstring = (Cli_5510,exp(g,Ns_7139)) in
                                                        {8572}out(c, (m2_7140,sign(m2_7140,skSess_6785)));
                                                        {8573}let Ksrv_7141: bitstring = exp(PartC_7138,Ns_7139) in
                                                        {8574}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7141))
                                        )
                                        else
                                            {8575}let pkDisco_7142: bitstring = fail-any in
                                            {8576}in(c, (=pkCli_7090,m1_7143: bitstring,sigM1_7144: bitstring));
                                            {8577}if (verify(m1_7143,sigM1_7144,pkCli_7090) <> true) then
                                                0
                                            else
                                                {8578}let (=Sess_5512,SPc_7145: bitstring,PartC_7146: bitstring) = m1_7143 in
                                                {8579}new Ns_7147: bitstring;
                                                {8580}let m2_7148: bitstring = (Cli_5510,exp(g,Ns_7147)) in
                                                {8581}out(c, (m2_7148,sign(m2_7148,skSess_6785)));
                                                {8582}let Ksrv_7149: bitstring = exp(PartC_7146,Ns_7147) in
                                                {8583}out(c, senc(mSrv(pkCli_7090,pkSess_6786),Ksrv_7149))
                            )
                            else
                                {8584}let pkCli_7150: bitstring = fail-any in
                                {8585}let v_7151: bool = (Disco_5511 = A) in
                                (
                                    {8586}if v_7151 then
                                    (
                                        {8587}let pkDisco_7152: bitstring = pub(skA) in
                                        {8588}in(c, (=pkCli_7150,m1_7153: bitstring,sigM1_7154: bitstring));
                                        {8589}if (verify(m1_7153,sigM1_7154,pkCli_7150) <> true) then
                                            0
                                        else
                                            {8590}let (=Sess_5512,SPc_7155: bitstring,PartC_7156: bitstring) = m1_7153 in
                                            {8591}new Ns_7157: bitstring;
                                            {8592}let m2_7158: bitstring = (Cli_5510,exp(g,Ns_7157)) in
                                            {8593}out(c, (m2_7158,sign(m2_7158,skSess_6785)));
                                            {8594}let Ksrv_7159: bitstring = exp(PartC_7156,Ns_7157) in
                                            {8595}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7159))
                                    )
                                    else
                                        {8596}let v_7160: bool = (Disco_5511 = B) in
                                        (
                                            {8597}if v_7160 then
                                            (
                                                {8598}let pkDisco_7161: bitstring = pub(skB) in
                                                {8599}in(c, (=pkCli_7150,m1_7162: bitstring,sigM1_7163: bitstring));
                                                {8600}if (verify(m1_7162,sigM1_7163,pkCli_7150) <> true) then
                                                    0
                                                else
                                                    {8601}let (=Sess_5512,SPc_7164: bitstring,PartC_7165: bitstring) = m1_7162 in
                                                    {8602}new Ns_7166: bitstring;
                                                    {8603}let m2_7167: bitstring = (Cli_5510,exp(g,Ns_7166)) in
                                                    {8604}out(c, (m2_7167,sign(m2_7167,skSess_6785)));
                                                    {8605}let Ksrv_7168: bitstring = exp(PartC_7165,Ns_7166) in
                                                    {8606}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7168))
                                            )
                                            else
                                                {8607}let v_7169: bool = (Disco_5511 = C) in
                                                (
                                                    {8608}if v_7169 then
                                                    (
                                                        {8609}let pkDisco_7170: bitstring = pub(skC) in
                                                        {8610}in(c, (=pkCli_7150,m1_7171: bitstring,sigM1_7172: bitstring));
                                                        {8611}if (verify(m1_7171,sigM1_7172,pkCli_7150) <> true) then
                                                            0
                                                        else
                                                            {8612}let (=Sess_5512,SPc_7173: bitstring,PartC_7174: bitstring) = m1_7171 in
                                                            {8613}new Ns_7175: bitstring;
                                                            {8614}let m2_7176: bitstring = (Cli_5510,exp(g,Ns_7175)) in
                                                            {8615}out(c, (m2_7176,sign(m2_7176,skSess_6785)));
                                                            {8616}let Ksrv_7177: bitstring = exp(PartC_7174,Ns_7175) in
                                                            {8617}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7177))
                                                    )
                                                    else
                                                        {8618}let pkDisco_7178: bitstring = pub(skI) in
                                                        {8619}in(c, (=pkCli_7150,m1_7179: bitstring,sigM1_7180: bitstring));
                                                        {8620}if (verify(m1_7179,sigM1_7180,pkCli_7150) <> true) then
                                                            0
                                                        else
                                                            {8621}let (=Sess_5512,SPc_7181: bitstring,PartC_7182: bitstring) = m1_7179 in
                                                            {8622}new Ns_7183: bitstring;
                                                            {8623}let m2_7184: bitstring = (Cli_5510,exp(g,Ns_7183)) in
                                                            {8624}out(c, (m2_7184,sign(m2_7184,skSess_6785)));
                                                            {8625}let Ksrv_7185: bitstring = exp(PartC_7182,Ns_7183) in
                                                            {8626}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7185))
                                                )
                                                else
                                                    {8627}let pkDisco_7186: bitstring = fail-any in
                                                    {8628}in(c, (=pkCli_7150,m1_7187: bitstring,sigM1_7188: bitstring));
                                                    {8629}if (verify(m1_7187,sigM1_7188,pkCli_7150) <> true) then
                                                        0
                                                    else
                                                        {8630}let (=Sess_5512,SPc_7189: bitstring,PartC_7190: bitstring) = m1_7187 in
                                                        {8631}new Ns_7191: bitstring;
                                                        {8632}let m2_7192: bitstring = (Cli_5510,exp(g,Ns_7191)) in
                                                        {8633}out(c, (m2_7192,sign(m2_7192,skSess_6785)));
                                                        {8634}let Ksrv_7193: bitstring = exp(PartC_7190,Ns_7191) in
                                                        {8635}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7193))
                                        )
                                        else
                                            {8636}let pkDisco_7194: bitstring = fail-any in
                                            {8637}in(c, (=pkCli_7150,m1_7195: bitstring,sigM1_7196: bitstring));
                                            {8638}if (verify(m1_7195,sigM1_7196,pkCli_7150) <> true) then
                                                0
                                            else
                                                {8639}let (=Sess_5512,SPc_7197: bitstring,PartC_7198: bitstring) = m1_7195 in
                                                {8640}new Ns_7199: bitstring;
                                                {8641}let m2_7200: bitstring = (Cli_5510,exp(g,Ns_7199)) in
                                                {8642}out(c, (m2_7200,sign(m2_7200,skSess_6785)));
                                                {8643}let Ksrv_7201: bitstring = exp(PartC_7198,Ns_7199) in
                                                {8644}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7201))
                                )
                                else
                                    {8645}let pkDisco_7202: bitstring = fail-any in
                                    {8646}in(c, (=pkCli_7150,m1_7203: bitstring,sigM1_7204: bitstring));
                                    {8647}if (verify(m1_7203,sigM1_7204,pkCli_7150) <> true) then
                                        0
                                    else
                                        {8648}let (=Sess_5512,SPc_7205: bitstring,PartC_7206: bitstring) = m1_7203 in
                                        {8649}new Ns_7207: bitstring;
                                        {8650}let m2_7208: bitstring = (Cli_5510,exp(g,Ns_7207)) in
                                        {8651}out(c, (m2_7208,sign(m2_7208,skSess_6785)));
                                        {8652}let Ksrv_7209: bitstring = exp(PartC_7206,Ns_7207) in
                                        {8653}out(c, senc(mSrv(pkCli_7150,pkSess_6786),Ksrv_7209))
                    )
                    else
                        {8654}let skSess_7210: bitstring = fail-any in
                        {8655}let pkSess_7211: bitstring = pub(skSess_7210) in
                        {8656}let v_7212: bool = (Cli_5510 = A) in
                        (
                            {8657}if v_7212 then
                            (
                                {8658}let pkCli_7213: bitstring = pub(skA) in
                                {8659}let v_7214: bool = (Disco_5511 = A) in
                                (
                                    {8660}if v_7214 then
                                    (
                                        {8661}let pkDisco_7215: bitstring = pub(skA) in
                                        {8662}in(c, (=pkCli_7213,m1_7216: bitstring,sigM1_7217: bitstring));
                                        {8663}if (verify(m1_7216,sigM1_7217,pkCli_7213) <> true) then
                                            0
                                        else
                                            {8664}let (=Sess_5512,SPc_7218: bitstring,PartC_7219: bitstring) = m1_7216 in
                                            {8665}new Ns_7220: bitstring;
                                            {8666}let m2_7221: bitstring = (Cli_5510,exp(g,Ns_7220)) in
                                            {8667}out(c, (m2_7221,sign(m2_7221,skSess_7210)));
                                            {8668}let Ksrv_7222: bitstring = exp(PartC_7219,Ns_7220) in
                                            {8669}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7222))
                                    )
                                    else
                                        {8670}let v_7223: bool = (Disco_5511 = B) in
                                        (
                                            {8671}if v_7223 then
                                            (
                                                {8672}let pkDisco_7224: bitstring = pub(skB) in
                                                {8673}in(c, (=pkCli_7213,m1_7225: bitstring,sigM1_7226: bitstring));
                                                {8674}if (verify(m1_7225,sigM1_7226,pkCli_7213) <> true) then
                                                    0
                                                else
                                                    {8675}let (=Sess_5512,SPc_7227: bitstring,PartC_7228: bitstring) = m1_7225 in
                                                    {8676}new Ns_7229: bitstring;
                                                    {8677}let m2_7230: bitstring = (Cli_5510,exp(g,Ns_7229)) in
                                                    {8678}out(c, (m2_7230,sign(m2_7230,skSess_7210)));
                                                    {8679}let Ksrv_7231: bitstring = exp(PartC_7228,Ns_7229) in
                                                    {8680}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7231))
                                            )
                                            else
                                                {8681}let v_7232: bool = (Disco_5511 = C) in
                                                (
                                                    {8682}if v_7232 then
                                                    (
                                                        {8683}let pkDisco_7233: bitstring = pub(skC) in
                                                        {8684}in(c, (=pkCli_7213,m1_7234: bitstring,sigM1_7235: bitstring));
                                                        {8685}if (verify(m1_7234,sigM1_7235,pkCli_7213) <> true) then
                                                            0
                                                        else
                                                            {8686}let (=Sess_5512,SPc_7236: bitstring,PartC_7237: bitstring) = m1_7234 in
                                                            {8687}new Ns_7238: bitstring;
                                                            {8688}let m2_7239: bitstring = (Cli_5510,exp(g,Ns_7238)) in
                                                            {8689}out(c, (m2_7239,sign(m2_7239,skSess_7210)));
                                                            {8690}let Ksrv_7240: bitstring = exp(PartC_7237,Ns_7238) in
                                                            {8691}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7240))
                                                    )
                                                    else
                                                        {8692}let pkDisco_7241: bitstring = pub(skI) in
                                                        {8693}in(c, (=pkCli_7213,m1_7242: bitstring,sigM1_7243: bitstring));
                                                        {8694}if (verify(m1_7242,sigM1_7243,pkCli_7213) <> true) then
                                                            0
                                                        else
                                                            {8695}let (=Sess_5512,SPc_7244: bitstring,PartC_7245: bitstring) = m1_7242 in
                                                            {8696}new Ns_7246: bitstring;
                                                            {8697}let m2_7247: bitstring = (Cli_5510,exp(g,Ns_7246)) in
                                                            {8698}out(c, (m2_7247,sign(m2_7247,skSess_7210)));
                                                            {8699}let Ksrv_7248: bitstring = exp(PartC_7245,Ns_7246) in
                                                            {8700}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7248))
                                                )
                                                else
                                                    {8701}let pkDisco_7249: bitstring = fail-any in
                                                    {8702}in(c, (=pkCli_7213,m1_7250: bitstring,sigM1_7251: bitstring));
                                                    {8703}if (verify(m1_7250,sigM1_7251,pkCli_7213) <> true) then
                                                        0
                                                    else
                                                        {8704}let (=Sess_5512,SPc_7252: bitstring,PartC_7253: bitstring) = m1_7250 in
                                                        {8705}new Ns_7254: bitstring;
                                                        {8706}let m2_7255: bitstring = (Cli_5510,exp(g,Ns_7254)) in
                                                        {8707}out(c, (m2_7255,sign(m2_7255,skSess_7210)));
                                                        {8708}let Ksrv_7256: bitstring = exp(PartC_7253,Ns_7254) in
                                                        {8709}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7256))
                                        )
                                        else
                                            {8710}let pkDisco_7257: bitstring = fail-any in
                                            {8711}in(c, (=pkCli_7213,m1_7258: bitstring,sigM1_7259: bitstring));
                                            {8712}if (verify(m1_7258,sigM1_7259,pkCli_7213) <> true) then
                                                0
                                            else
                                                {8713}let (=Sess_5512,SPc_7260: bitstring,PartC_7261: bitstring) = m1_7258 in
                                                {8714}new Ns_7262: bitstring;
                                                {8715}let m2_7263: bitstring = (Cli_5510,exp(g,Ns_7262)) in
                                                {8716}out(c, (m2_7263,sign(m2_7263,skSess_7210)));
                                                {8717}let Ksrv_7264: bitstring = exp(PartC_7261,Ns_7262) in
                                                {8718}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7264))
                                )
                                else
                                    {8719}let pkDisco_7265: bitstring = fail-any in
                                    {8720}in(c, (=pkCli_7213,m1_7266: bitstring,sigM1_7267: bitstring));
                                    {8721}if (verify(m1_7266,sigM1_7267,pkCli_7213) <> true) then
                                        0
                                    else
                                        {8722}let (=Sess_5512,SPc_7268: bitstring,PartC_7269: bitstring) = m1_7266 in
                                        {8723}new Ns_7270: bitstring;
                                        {8724}let m2_7271: bitstring = (Cli_5510,exp(g,Ns_7270)) in
                                        {8725}out(c, (m2_7271,sign(m2_7271,skSess_7210)));
                                        {8726}let Ksrv_7272: bitstring = exp(PartC_7269,Ns_7270) in
                                        {8727}out(c, senc(mSrv(pkCli_7213,pkSess_7211),Ksrv_7272))
                            )
                            else
                                {8728}let v_7273: bool = (Cli_5510 = B) in
                                (
                                    {8729}if v_7273 then
                                    (
                                        {8730}let pkCli_7274: bitstring = pub(skB) in
                                        {8731}let v_7275: bool = (Disco_5511 = A) in
                                        (
                                            {8732}if v_7275 then
                                            (
                                                {8733}let pkDisco_7276: bitstring = pub(skA) in
                                                {8734}in(c, (=pkCli_7274,m1_7277: bitstring,sigM1_7278: bitstring));
                                                {8735}if (verify(m1_7277,sigM1_7278,pkCli_7274) <> true) then
                                                    0
                                                else
                                                    {8736}let (=Sess_5512,SPc_7279: bitstring,PartC_7280: bitstring) = m1_7277 in
                                                    {8737}new Ns_7281: bitstring;
                                                    {8738}let m2_7282: bitstring = (Cli_5510,exp(g,Ns_7281)) in
                                                    {8739}out(c, (m2_7282,sign(m2_7282,skSess_7210)));
                                                    {8740}let Ksrv_7283: bitstring = exp(PartC_7280,Ns_7281) in
                                                    {8741}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7283))
                                            )
                                            else
                                                {8742}let v_7284: bool = (Disco_5511 = B) in
                                                (
                                                    {8743}if v_7284 then
                                                    (
                                                        {8744}let pkDisco_7285: bitstring = pub(skB) in
                                                        {8745}in(c, (=pkCli_7274,m1_7286: bitstring,sigM1_7287: bitstring));
                                                        {8746}if (verify(m1_7286,sigM1_7287,pkCli_7274) <> true) then
                                                            0
                                                        else
                                                            {8747}let (=Sess_5512,SPc_7288: bitstring,PartC_7289: bitstring) = m1_7286 in
                                                            {8748}new Ns_7290: bitstring;
                                                            {8749}let m2_7291: bitstring = (Cli_5510,exp(g,Ns_7290)) in
                                                            {8750}out(c, (m2_7291,sign(m2_7291,skSess_7210)));
                                                            {8751}let Ksrv_7292: bitstring = exp(PartC_7289,Ns_7290) in
                                                            {8752}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7292))
                                                    )
                                                    else
                                                        {8753}let v_7293: bool = (Disco_5511 = C) in
                                                        (
                                                            {8754}if v_7293 then
                                                            (
                                                                {8755}let pkDisco_7294: bitstring = pub(skC) in
                                                                {8756}in(c, (=pkCli_7274,m1_7295: bitstring,sigM1_7296: bitstring));
                                                                {8757}if (verify(m1_7295,sigM1_7296,pkCli_7274) <> true) then
                                                                    0
                                                                else
                                                                    {8758}let (=Sess_5512,SPc_7297: bitstring,PartC_7298: bitstring) = m1_7295 in
                                                                    {8759}new Ns_7299: bitstring;
                                                                    {8760}let m2_7300: bitstring = (Cli_5510,exp(g,Ns_7299)) in
                                                                    {8761}out(c, (m2_7300,sign(m2_7300,skSess_7210)));
                                                                    {8762}let Ksrv_7301: bitstring = exp(PartC_7298,Ns_7299) in
                                                                    {8763}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7301))
                                                            )
                                                            else
                                                                {8764}let pkDisco_7302: bitstring = pub(skI) in
                                                                {8765}in(c, (=pkCli_7274,m1_7303: bitstring,sigM1_7304: bitstring));
                                                                {8766}if (verify(m1_7303,sigM1_7304,pkCli_7274) <> true) then
                                                                    0
                                                                else
                                                                    {8767}let (=Sess_5512,SPc_7305: bitstring,PartC_7306: bitstring) = m1_7303 in
                                                                    {8768}new Ns_7307: bitstring;
                                                                    {8769}let m2_7308: bitstring = (Cli_5510,exp(g,Ns_7307)) in
                                                                    {8770}out(c, (m2_7308,sign(m2_7308,skSess_7210)));
                                                                    {8771}let Ksrv_7309: bitstring = exp(PartC_7306,Ns_7307) in
                                                                    {8772}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7309))
                                                        )
                                                        else
                                                            {8773}let pkDisco_7310: bitstring = fail-any in
                                                            {8774}in(c, (=pkCli_7274,m1_7311: bitstring,sigM1_7312: bitstring));
                                                            {8775}if (verify(m1_7311,sigM1_7312,pkCli_7274) <> true) then
                                                                0
                                                            else
                                                                {8776}let (=Sess_5512,SPc_7313: bitstring,PartC_7314: bitstring) = m1_7311 in
                                                                {8777}new Ns_7315: bitstring;
                                                                {8778}let m2_7316: bitstring = (Cli_5510,exp(g,Ns_7315)) in
                                                                {8779}out(c, (m2_7316,sign(m2_7316,skSess_7210)));
                                                                {8780}let Ksrv_7317: bitstring = exp(PartC_7314,Ns_7315) in
                                                                {8781}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7317))
                                                )
                                                else
                                                    {8782}let pkDisco_7318: bitstring = fail-any in
                                                    {8783}in(c, (=pkCli_7274,m1_7319: bitstring,sigM1_7320: bitstring));
                                                    {8784}if (verify(m1_7319,sigM1_7320,pkCli_7274) <> true) then
                                                        0
                                                    else
                                                        {8785}let (=Sess_5512,SPc_7321: bitstring,PartC_7322: bitstring) = m1_7319 in
                                                        {8786}new Ns_7323: bitstring;
                                                        {8787}let m2_7324: bitstring = (Cli_5510,exp(g,Ns_7323)) in
                                                        {8788}out(c, (m2_7324,sign(m2_7324,skSess_7210)));
                                                        {8789}let Ksrv_7325: bitstring = exp(PartC_7322,Ns_7323) in
                                                        {8790}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7325))
                                        )
                                        else
                                            {8791}let pkDisco_7326: bitstring = fail-any in
                                            {8792}in(c, (=pkCli_7274,m1_7327: bitstring,sigM1_7328: bitstring));
                                            {8793}if (verify(m1_7327,sigM1_7328,pkCli_7274) <> true) then
                                                0
                                            else
                                                {8794}let (=Sess_5512,SPc_7329: bitstring,PartC_7330: bitstring) = m1_7327 in
                                                {8795}new Ns_7331: bitstring;
                                                {8796}let m2_7332: bitstring = (Cli_5510,exp(g,Ns_7331)) in
                                                {8797}out(c, (m2_7332,sign(m2_7332,skSess_7210)));
                                                {8798}let Ksrv_7333: bitstring = exp(PartC_7330,Ns_7331) in
                                                {8799}out(c, senc(mSrv(pkCli_7274,pkSess_7211),Ksrv_7333))
                                    )
                                    else
                                        {8800}let v_7334: bool = (Cli_5510 = C) in
                                        (
                                            {8801}if v_7334 then
                                            (
                                                {8802}let pkCli_7335: bitstring = pub(skC) in
                                                {8803}let v_7336: bool = (Disco_5511 = A) in
                                                (
                                                    {8804}if v_7336 then
                                                    (
                                                        {8805}let pkDisco_7337: bitstring = pub(skA) in
                                                        {8806}in(c, (=pkCli_7335,m1_7338: bitstring,sigM1_7339: bitstring));
                                                        {8807}if (verify(m1_7338,sigM1_7339,pkCli_7335) <> true) then
                                                            0
                                                        else
                                                            {8808}let (=Sess_5512,SPc_7340: bitstring,PartC_7341: bitstring) = m1_7338 in
                                                            {8809}new Ns_7342: bitstring;
                                                            {8810}let m2_7343: bitstring = (Cli_5510,exp(g,Ns_7342)) in
                                                            {8811}out(c, (m2_7343,sign(m2_7343,skSess_7210)));
                                                            {8812}let Ksrv_7344: bitstring = exp(PartC_7341,Ns_7342) in
                                                            {8813}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7344))
                                                    )
                                                    else
                                                        {8814}let v_7345: bool = (Disco_5511 = B) in
                                                        (
                                                            {8815}if v_7345 then
                                                            (
                                                                {8816}let pkDisco_7346: bitstring = pub(skB) in
                                                                {8817}in(c, (=pkCli_7335,m1_7347: bitstring,sigM1_7348: bitstring));
                                                                {8818}if (verify(m1_7347,sigM1_7348,pkCli_7335) <> true) then
                                                                    0
                                                                else
                                                                    {8819}let (=Sess_5512,SPc_7349: bitstring,PartC_7350: bitstring) = m1_7347 in
                                                                    {8820}new Ns_7351: bitstring;
                                                                    {8821}let m2_7352: bitstring = (Cli_5510,exp(g,Ns_7351)) in
                                                                    {8822}out(c, (m2_7352,sign(m2_7352,skSess_7210)));
                                                                    {8823}let Ksrv_7353: bitstring = exp(PartC_7350,Ns_7351) in
                                                                    {8824}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7353))
                                                            )
                                                            else
                                                                {8825}let v_7354: bool = (Disco_5511 = C) in
                                                                (
                                                                    {8826}if v_7354 then
                                                                    (
                                                                        {8827}let pkDisco_7355: bitstring = pub(skC) in
                                                                        {8828}in(c, (=pkCli_7335,m1_7356: bitstring,sigM1_7357: bitstring));
                                                                        {8829}if (verify(m1_7356,sigM1_7357,pkCli_7335) <> true) then
                                                                            0
                                                                        else
                                                                            {8830}let (=Sess_5512,SPc_7358: bitstring,PartC_7359: bitstring) = m1_7356 in
                                                                            {8831}new Ns_7360: bitstring;
                                                                            {8832}let m2_7361: bitstring = (Cli_5510,exp(g,Ns_7360)) in
                                                                            {8833}out(c, (m2_7361,sign(m2_7361,skSess_7210)));
                                                                            {8834}let Ksrv_7362: bitstring = exp(PartC_7359,Ns_7360) in
                                                                            {8835}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7362))
                                                                    )
                                                                    else
                                                                        {8836}let pkDisco_7363: bitstring = pub(skI) in
                                                                        {8837}in(c, (=pkCli_7335,m1_7364: bitstring,sigM1_7365: bitstring));
                                                                        {8838}if (verify(m1_7364,sigM1_7365,pkCli_7335) <> true) then
                                                                            0
                                                                        else
                                                                            {8839}let (=Sess_5512,SPc_7366: bitstring,PartC_7367: bitstring) = m1_7364 in
                                                                            {8840}new Ns_7368: bitstring;
                                                                            {8841}let m2_7369: bitstring = (Cli_5510,exp(g,Ns_7368)) in
                                                                            {8842}out(c, (m2_7369,sign(m2_7369,skSess_7210)));
                                                                            {8843}let Ksrv_7370: bitstring = exp(PartC_7367,Ns_7368) in
                                                                            {8844}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7370))
                                                                )
                                                                else
                                                                    {8845}let pkDisco_7371: bitstring = fail-any in
                                                                    {8846}in(c, (=pkCli_7335,m1_7372: bitstring,sigM1_7373: bitstring));
                                                                    {8847}if (verify(m1_7372,sigM1_7373,pkCli_7335) <> true) then
                                                                        0
                                                                    else
                                                                        {8848}let (=Sess_5512,SPc_7374: bitstring,PartC_7375: bitstring) = m1_7372 in
                                                                        {8849}new Ns_7376: bitstring;
                                                                        {8850}let m2_7377: bitstring = (Cli_5510,exp(g,Ns_7376)) in
                                                                        {8851}out(c, (m2_7377,sign(m2_7377,skSess_7210)));
                                                                        {8852}let Ksrv_7378: bitstring = exp(PartC_7375,Ns_7376) in
                                                                        {8853}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7378))
                                                        )
                                                        else
                                                            {8854}let pkDisco_7379: bitstring = fail-any in
                                                            {8855}in(c, (=pkCli_7335,m1_7380: bitstring,sigM1_7381: bitstring));
                                                            {8856}if (verify(m1_7380,sigM1_7381,pkCli_7335) <> true) then
                                                                0
                                                            else
                                                                {8857}let (=Sess_5512,SPc_7382: bitstring,PartC_7383: bitstring) = m1_7380 in
                                                                {8858}new Ns_7384: bitstring;
                                                                {8859}let m2_7385: bitstring = (Cli_5510,exp(g,Ns_7384)) in
                                                                {8860}out(c, (m2_7385,sign(m2_7385,skSess_7210)));
                                                                {8861}let Ksrv_7386: bitstring = exp(PartC_7383,Ns_7384) in
                                                                {8862}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7386))
                                                )
                                                else
                                                    {8863}let pkDisco_7387: bitstring = fail-any in
                                                    {8864}in(c, (=pkCli_7335,m1_7388: bitstring,sigM1_7389: bitstring));
                                                    {8865}if (verify(m1_7388,sigM1_7389,pkCli_7335) <> true) then
                                                        0
                                                    else
                                                        {8866}let (=Sess_5512,SPc_7390: bitstring,PartC_7391: bitstring) = m1_7388 in
                                                        {8867}new Ns_7392: bitstring;
                                                        {8868}let m2_7393: bitstring = (Cli_5510,exp(g,Ns_7392)) in
                                                        {8869}out(c, (m2_7393,sign(m2_7393,skSess_7210)));
                                                        {8870}let Ksrv_7394: bitstring = exp(PartC_7391,Ns_7392) in
                                                        {8871}out(c, senc(mSrv(pkCli_7335,pkSess_7211),Ksrv_7394))
                                            )
                                            else
                                                {8872}let pkCli_7395: bitstring = pub(skI) in
                                                {8873}let v_7396: bool = (Disco_5511 = A) in
                                                (
                                                    {8874}if v_7396 then
                                                    (
                                                        {8875}let pkDisco_7397: bitstring = pub(skA) in
                                                        {8876}in(c, (=pkCli_7395,m1_7398: bitstring,sigM1_7399: bitstring));
                                                        {8877}if (verify(m1_7398,sigM1_7399,pkCli_7395) <> true) then
                                                            0
                                                        else
                                                            {8878}let (=Sess_5512,SPc_7400: bitstring,PartC_7401: bitstring) = m1_7398 in
                                                            {8879}new Ns_7402: bitstring;
                                                            {8880}let m2_7403: bitstring = (Cli_5510,exp(g,Ns_7402)) in
                                                            {8881}out(c, (m2_7403,sign(m2_7403,skSess_7210)));
                                                            {8882}let Ksrv_7404: bitstring = exp(PartC_7401,Ns_7402) in
                                                            {8883}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7404))
                                                    )
                                                    else
                                                        {8884}let v_7405: bool = (Disco_5511 = B) in
                                                        (
                                                            {8885}if v_7405 then
                                                            (
                                                                {8886}let pkDisco_7406: bitstring = pub(skB) in
                                                                {8887}in(c, (=pkCli_7395,m1_7407: bitstring,sigM1_7408: bitstring));
                                                                {8888}if (verify(m1_7407,sigM1_7408,pkCli_7395) <> true) then
                                                                    0
                                                                else
                                                                    {8889}let (=Sess_5512,SPc_7409: bitstring,PartC_7410: bitstring) = m1_7407 in
                                                                    {8890}new Ns_7411: bitstring;
                                                                    {8891}let m2_7412: bitstring = (Cli_5510,exp(g,Ns_7411)) in
                                                                    {8892}out(c, (m2_7412,sign(m2_7412,skSess_7210)));
                                                                    {8893}let Ksrv_7413: bitstring = exp(PartC_7410,Ns_7411) in
                                                                    {8894}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7413))
                                                            )
                                                            else
                                                                {8895}let v_7414: bool = (Disco_5511 = C) in
                                                                (
                                                                    {8896}if v_7414 then
                                                                    (
                                                                        {8897}let pkDisco_7415: bitstring = pub(skC) in
                                                                        {8898}in(c, (=pkCli_7395,m1_7416: bitstring,sigM1_7417: bitstring));
                                                                        {8899}if (verify(m1_7416,sigM1_7417,pkCli_7395) <> true) then
                                                                            0
                                                                        else
                                                                            {8900}let (=Sess_5512,SPc_7418: bitstring,PartC_7419: bitstring) = m1_7416 in
                                                                            {8901}new Ns_7420: bitstring;
                                                                            {8902}let m2_7421: bitstring = (Cli_5510,exp(g,Ns_7420)) in
                                                                            {8903}out(c, (m2_7421,sign(m2_7421,skSess_7210)));
                                                                            {8904}let Ksrv_7422: bitstring = exp(PartC_7419,Ns_7420) in
                                                                            {8905}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7422))
                                                                    )
                                                                    else
                                                                        {8906}let pkDisco_7423: bitstring = pub(skI) in
                                                                        {8907}in(c, (=pkCli_7395,m1_7424: bitstring,sigM1_7425: bitstring));
                                                                        {8908}if (verify(m1_7424,sigM1_7425,pkCli_7395) <> true) then
                                                                            0
                                                                        else
                                                                            {8909}let (=Sess_5512,SPc_7426: bitstring,PartC_7427: bitstring) = m1_7424 in
                                                                            {8910}new Ns_7428: bitstring;
                                                                            {8911}let m2_7429: bitstring = (Cli_5510,exp(g,Ns_7428)) in
                                                                            {8912}out(c, (m2_7429,sign(m2_7429,skSess_7210)));
                                                                            {8913}let Ksrv_7430: bitstring = exp(PartC_7427,Ns_7428) in
                                                                            {8914}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7430))
                                                                )
                                                                else
                                                                    {8915}let pkDisco_7431: bitstring = fail-any in
                                                                    {8916}in(c, (=pkCli_7395,m1_7432: bitstring,sigM1_7433: bitstring));
                                                                    {8917}if (verify(m1_7432,sigM1_7433,pkCli_7395) <> true) then
                                                                        0
                                                                    else
                                                                        {8918}let (=Sess_5512,SPc_7434: bitstring,PartC_7435: bitstring) = m1_7432 in
                                                                        {8919}new Ns_7436: bitstring;
                                                                        {8920}let m2_7437: bitstring = (Cli_5510,exp(g,Ns_7436)) in
                                                                        {8921}out(c, (m2_7437,sign(m2_7437,skSess_7210)));
                                                                        {8922}let Ksrv_7438: bitstring = exp(PartC_7435,Ns_7436) in
                                                                        {8923}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7438))
                                                        )
                                                        else
                                                            {8924}let pkDisco_7439: bitstring = fail-any in
                                                            {8925}in(c, (=pkCli_7395,m1_7440: bitstring,sigM1_7441: bitstring));
                                                            {8926}if (verify(m1_7440,sigM1_7441,pkCli_7395) <> true) then
                                                                0
                                                            else
                                                                {8927}let (=Sess_5512,SPc_7442: bitstring,PartC_7443: bitstring) = m1_7440 in
                                                                {8928}new Ns_7444: bitstring;
                                                                {8929}let m2_7445: bitstring = (Cli_5510,exp(g,Ns_7444)) in
                                                                {8930}out(c, (m2_7445,sign(m2_7445,skSess_7210)));
                                                                {8931}let Ksrv_7446: bitstring = exp(PartC_7443,Ns_7444) in
                                                                {8932}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7446))
                                                )
                                                else
                                                    {8933}let pkDisco_7447: bitstring = fail-any in
                                                    {8934}in(c, (=pkCli_7395,m1_7448: bitstring,sigM1_7449: bitstring));
                                                    {8935}if (verify(m1_7448,sigM1_7449,pkCli_7395) <> true) then
                                                        0
                                                    else
                                                        {8936}let (=Sess_5512,SPc_7450: bitstring,PartC_7451: bitstring) = m1_7448 in
                                                        {8937}new Ns_7452: bitstring;
                                                        {8938}let m2_7453: bitstring = (Cli_5510,exp(g,Ns_7452)) in
                                                        {8939}out(c, (m2_7453,sign(m2_7453,skSess_7210)));
                                                        {8940}let Ksrv_7454: bitstring = exp(PartC_7451,Ns_7452) in
                                                        {8941}out(c, senc(mSrv(pkCli_7395,pkSess_7211),Ksrv_7454))
                                        )
                                        else
                                            {8942}let pkCli_7455: bitstring = fail-any in
                                            {8943}let v_7456: bool = (Disco_5511 = A) in
                                            (
                                                {8944}if v_7456 then
                                                (
                                                    {8945}let pkDisco_7457: bitstring = pub(skA) in
                                                    {8946}in(c, (=pkCli_7455,m1_7458: bitstring,sigM1_7459: bitstring));
                                                    {8947}if (verify(m1_7458,sigM1_7459,pkCli_7455) <> true) then
                                                        0
                                                    else
                                                        {8948}let (=Sess_5512,SPc_7460: bitstring,PartC_7461: bitstring) = m1_7458 in
                                                        {8949}new Ns_7462: bitstring;
                                                        {8950}let m2_7463: bitstring = (Cli_5510,exp(g,Ns_7462)) in
                                                        {8951}out(c, (m2_7463,sign(m2_7463,skSess_7210)));
                                                        {8952}let Ksrv_7464: bitstring = exp(PartC_7461,Ns_7462) in
                                                        {8953}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7464))
                                                )
                                                else
                                                    {8954}let v_7465: bool = (Disco_5511 = B) in
                                                    (
                                                        {8955}if v_7465 then
                                                        (
                                                            {8956}let pkDisco_7466: bitstring = pub(skB) in
                                                            {8957}in(c, (=pkCli_7455,m1_7467: bitstring,sigM1_7468: bitstring));
                                                            {8958}if (verify(m1_7467,sigM1_7468,pkCli_7455) <> true) then
                                                                0
                                                            else
                                                                {8959}let (=Sess_5512,SPc_7469: bitstring,PartC_7470: bitstring) = m1_7467 in
                                                                {8960}new Ns_7471: bitstring;
                                                                {8961}let m2_7472: bitstring = (Cli_5510,exp(g,Ns_7471)) in
                                                                {8962}out(c, (m2_7472,sign(m2_7472,skSess_7210)));
                                                                {8963}let Ksrv_7473: bitstring = exp(PartC_7470,Ns_7471) in
                                                                {8964}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7473))
                                                        )
                                                        else
                                                            {8965}let v_7474: bool = (Disco_5511 = C) in
                                                            (
                                                                {8966}if v_7474 then
                                                                (
                                                                    {8967}let pkDisco_7475: bitstring = pub(skC) in
                                                                    {8968}in(c, (=pkCli_7455,m1_7476: bitstring,sigM1_7477: bitstring));
                                                                    {8969}if (verify(m1_7476,sigM1_7477,pkCli_7455) <> true) then
                                                                        0
                                                                    else
                                                                        {8970}let (=Sess_5512,SPc_7478: bitstring,PartC_7479: bitstring) = m1_7476 in
                                                                        {8971}new Ns_7480: bitstring;
                                                                        {8972}let m2_7481: bitstring = (Cli_5510,exp(g,Ns_7480)) in
                                                                        {8973}out(c, (m2_7481,sign(m2_7481,skSess_7210)));
                                                                        {8974}let Ksrv_7482: bitstring = exp(PartC_7479,Ns_7480) in
                                                                        {8975}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7482))
                                                                )
                                                                else
                                                                    {8976}let pkDisco_7483: bitstring = pub(skI) in
                                                                    {8977}in(c, (=pkCli_7455,m1_7484: bitstring,sigM1_7485: bitstring));
                                                                    {8978}if (verify(m1_7484,sigM1_7485,pkCli_7455) <> true) then
                                                                        0
                                                                    else
                                                                        {8979}let (=Sess_5512,SPc_7486: bitstring,PartC_7487: bitstring) = m1_7484 in
                                                                        {8980}new Ns_7488: bitstring;
                                                                        {8981}let m2_7489: bitstring = (Cli_5510,exp(g,Ns_7488)) in
                                                                        {8982}out(c, (m2_7489,sign(m2_7489,skSess_7210)));
                                                                        {8983}let Ksrv_7490: bitstring = exp(PartC_7487,Ns_7488) in
                                                                        {8984}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7490))
                                                            )
                                                            else
                                                                {8985}let pkDisco_7491: bitstring = fail-any in
                                                                {8986}in(c, (=pkCli_7455,m1_7492: bitstring,sigM1_7493: bitstring));
                                                                {8987}if (verify(m1_7492,sigM1_7493,pkCli_7455) <> true) then
                                                                    0
                                                                else
                                                                    {8988}let (=Sess_5512,SPc_7494: bitstring,PartC_7495: bitstring) = m1_7492 in
                                                                    {8989}new Ns_7496: bitstring;
                                                                    {8990}let m2_7497: bitstring = (Cli_5510,exp(g,Ns_7496)) in
                                                                    {8991}out(c, (m2_7497,sign(m2_7497,skSess_7210)));
                                                                    {8992}let Ksrv_7498: bitstring = exp(PartC_7495,Ns_7496) in
                                                                    {8993}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7498))
                                                    )
                                                    else
                                                        {8994}let pkDisco_7499: bitstring = fail-any in
                                                        {8995}in(c, (=pkCli_7455,m1_7500: bitstring,sigM1_7501: bitstring));
                                                        {8996}if (verify(m1_7500,sigM1_7501,pkCli_7455) <> true) then
                                                            0
                                                        else
                                                            {8997}let (=Sess_5512,SPc_7502: bitstring,PartC_7503: bitstring) = m1_7500 in
                                                            {8998}new Ns_7504: bitstring;
                                                            {8999}let m2_7505: bitstring = (Cli_5510,exp(g,Ns_7504)) in
                                                            {9000}out(c, (m2_7505,sign(m2_7505,skSess_7210)));
                                                            {9001}let Ksrv_7506: bitstring = exp(PartC_7503,Ns_7504) in
                                                            {9002}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7506))
                                            )
                                            else
                                                {9003}let pkDisco_7507: bitstring = fail-any in
                                                {9004}in(c, (=pkCli_7455,m1_7508: bitstring,sigM1_7509: bitstring));
                                                {9005}if (verify(m1_7508,sigM1_7509,pkCli_7455) <> true) then
                                                    0
                                                else
                                                    {9006}let (=Sess_5512,SPc_7510: bitstring,PartC_7511: bitstring) = m1_7508 in
                                                    {9007}new Ns_7512: bitstring;
                                                    {9008}let m2_7513: bitstring = (Cli_5510,exp(g,Ns_7512)) in
                                                    {9009}out(c, (m2_7513,sign(m2_7513,skSess_7210)));
                                                    {9010}let Ksrv_7514: bitstring = exp(PartC_7511,Ns_7512) in
                                                    {9011}out(c, senc(mSrv(pkCli_7455,pkSess_7211),Ksrv_7514))
                                )
                                else
                                    {9012}let pkCli_7515: bitstring = fail-any in
                                    {9013}let v_7516: bool = (Disco_5511 = A) in
                                    (
                                        {9014}if v_7516 then
                                        (
                                            {9015}let pkDisco_7517: bitstring = pub(skA) in
                                            {9016}in(c, (=pkCli_7515,m1_7518: bitstring,sigM1_7519: bitstring));
                                            {9017}if (verify(m1_7518,sigM1_7519,pkCli_7515) <> true) then
                                                0
                                            else
                                                {9018}let (=Sess_5512,SPc_7520: bitstring,PartC_7521: bitstring) = m1_7518 in
                                                {9019}new Ns_7522: bitstring;
                                                {9020}let m2_7523: bitstring = (Cli_5510,exp(g,Ns_7522)) in
                                                {9021}out(c, (m2_7523,sign(m2_7523,skSess_7210)));
                                                {9022}let Ksrv_7524: bitstring = exp(PartC_7521,Ns_7522) in
                                                {9023}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7524))
                                        )
                                        else
                                            {9024}let v_7525: bool = (Disco_5511 = B) in
                                            (
                                                {9025}if v_7525 then
                                                (
                                                    {9026}let pkDisco_7526: bitstring = pub(skB) in
                                                    {9027}in(c, (=pkCli_7515,m1_7527: bitstring,sigM1_7528: bitstring));
                                                    {9028}if (verify(m1_7527,sigM1_7528,pkCli_7515) <> true) then
                                                        0
                                                    else
                                                        {9029}let (=Sess_5512,SPc_7529: bitstring,PartC_7530: bitstring) = m1_7527 in
                                                        {9030}new Ns_7531: bitstring;
                                                        {9031}let m2_7532: bitstring = (Cli_5510,exp(g,Ns_7531)) in
                                                        {9032}out(c, (m2_7532,sign(m2_7532,skSess_7210)));
                                                        {9033}let Ksrv_7533: bitstring = exp(PartC_7530,Ns_7531) in
                                                        {9034}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7533))
                                                )
                                                else
                                                    {9035}let v_7534: bool = (Disco_5511 = C) in
                                                    (
                                                        {9036}if v_7534 then
                                                        (
                                                            {9037}let pkDisco_7535: bitstring = pub(skC) in
                                                            {9038}in(c, (=pkCli_7515,m1_7536: bitstring,sigM1_7537: bitstring));
                                                            {9039}if (verify(m1_7536,sigM1_7537,pkCli_7515) <> true) then
                                                                0
                                                            else
                                                                {9040}let (=Sess_5512,SPc_7538: bitstring,PartC_7539: bitstring) = m1_7536 in
                                                                {9041}new Ns_7540: bitstring;
                                                                {9042}let m2_7541: bitstring = (Cli_5510,exp(g,Ns_7540)) in
                                                                {9043}out(c, (m2_7541,sign(m2_7541,skSess_7210)));
                                                                {9044}let Ksrv_7542: bitstring = exp(PartC_7539,Ns_7540) in
                                                                {9045}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7542))
                                                        )
                                                        else
                                                            {9046}let pkDisco_7543: bitstring = pub(skI) in
                                                            {9047}in(c, (=pkCli_7515,m1_7544: bitstring,sigM1_7545: bitstring));
                                                            {9048}if (verify(m1_7544,sigM1_7545,pkCli_7515) <> true) then
                                                                0
                                                            else
                                                                {9049}let (=Sess_5512,SPc_7546: bitstring,PartC_7547: bitstring) = m1_7544 in
                                                                {9050}new Ns_7548: bitstring;
                                                                {9051}let m2_7549: bitstring = (Cli_5510,exp(g,Ns_7548)) in
                                                                {9052}out(c, (m2_7549,sign(m2_7549,skSess_7210)));
                                                                {9053}let Ksrv_7550: bitstring = exp(PartC_7547,Ns_7548) in
                                                                {9054}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7550))
                                                    )
                                                    else
                                                        {9055}let pkDisco_7551: bitstring = fail-any in
                                                        {9056}in(c, (=pkCli_7515,m1_7552: bitstring,sigM1_7553: bitstring));
                                                        {9057}if (verify(m1_7552,sigM1_7553,pkCli_7515) <> true) then
                                                            0
                                                        else
                                                            {9058}let (=Sess_5512,SPc_7554: bitstring,PartC_7555: bitstring) = m1_7552 in
                                                            {9059}new Ns_7556: bitstring;
                                                            {9060}let m2_7557: bitstring = (Cli_5510,exp(g,Ns_7556)) in
                                                            {9061}out(c, (m2_7557,sign(m2_7557,skSess_7210)));
                                                            {9062}let Ksrv_7558: bitstring = exp(PartC_7555,Ns_7556) in
                                                            {9063}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7558))
                                            )
                                            else
                                                {9064}let pkDisco_7559: bitstring = fail-any in
                                                {9065}in(c, (=pkCli_7515,m1_7560: bitstring,sigM1_7561: bitstring));
                                                {9066}if (verify(m1_7560,sigM1_7561,pkCli_7515) <> true) then
                                                    0
                                                else
                                                    {9067}let (=Sess_5512,SPc_7562: bitstring,PartC_7563: bitstring) = m1_7560 in
                                                    {9068}new Ns_7564: bitstring;
                                                    {9069}let m2_7565: bitstring = (Cli_5510,exp(g,Ns_7564)) in
                                                    {9070}out(c, (m2_7565,sign(m2_7565,skSess_7210)));
                                                    {9071}let Ksrv_7566: bitstring = exp(PartC_7563,Ns_7564) in
                                                    {9072}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7566))
                                    )
                                    else
                                        {9073}let pkDisco_7567: bitstring = fail-any in
                                        {9074}in(c, (=pkCli_7515,m1_7568: bitstring,sigM1_7569: bitstring));
                                        {9075}if (verify(m1_7568,sigM1_7569,pkCli_7515) <> true) then
                                            0
                                        else
                                            {9076}let (=Sess_5512,SPc_7570: bitstring,PartC_7571: bitstring) = m1_7568 in
                                            {9077}new Ns_7572: bitstring;
                                            {9078}let m2_7573: bitstring = (Cli_5510,exp(g,Ns_7572)) in
                                            {9079}out(c, (m2_7573,sign(m2_7573,skSess_7210)));
                                            {9080}let Ksrv_7574: bitstring = exp(PartC_7571,Ns_7572) in
                                            {9081}out(c, senc(mSrv(pkCli_7515,pkSess_7211),Ksrv_7574))
                        )
                        else
                            {9082}let pkCli_7575: bitstring = fail-any in
                            {9083}let v_7576: bool = (Disco_5511 = A) in
                            (
                                {9084}if v_7576 then
                                (
                                    {9085}let pkDisco_7577: bitstring = pub(skA) in
                                    {9086}in(c, (=pkCli_7575,m1_7578: bitstring,sigM1_7579: bitstring));
                                    {9087}if (verify(m1_7578,sigM1_7579,pkCli_7575) <> true) then
                                        0
                                    else
                                        {9088}let (=Sess_5512,SPc_7580: bitstring,PartC_7581: bitstring) = m1_7578 in
                                        {9089}new Ns_7582: bitstring;
                                        {9090}let m2_7583: bitstring = (Cli_5510,exp(g,Ns_7582)) in
                                        {9091}out(c, (m2_7583,sign(m2_7583,skSess_7210)));
                                        {9092}let Ksrv_7584: bitstring = exp(PartC_7581,Ns_7582) in
                                        {9093}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7584))
                                )
                                else
                                    {9094}let v_7585: bool = (Disco_5511 = B) in
                                    (
                                        {9095}if v_7585 then
                                        (
                                            {9096}let pkDisco_7586: bitstring = pub(skB) in
                                            {9097}in(c, (=pkCli_7575,m1_7587: bitstring,sigM1_7588: bitstring));
                                            {9098}if (verify(m1_7587,sigM1_7588,pkCli_7575) <> true) then
                                                0
                                            else
                                                {9099}let (=Sess_5512,SPc_7589: bitstring,PartC_7590: bitstring) = m1_7587 in
                                                {9100}new Ns_7591: bitstring;
                                                {9101}let m2_7592: bitstring = (Cli_5510,exp(g,Ns_7591)) in
                                                {9102}out(c, (m2_7592,sign(m2_7592,skSess_7210)));
                                                {9103}let Ksrv_7593: bitstring = exp(PartC_7590,Ns_7591) in
                                                {9104}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7593))
                                        )
                                        else
                                            {9105}let v_7594: bool = (Disco_5511 = C) in
                                            (
                                                {9106}if v_7594 then
                                                (
                                                    {9107}let pkDisco_7595: bitstring = pub(skC) in
                                                    {9108}in(c, (=pkCli_7575,m1_7596: bitstring,sigM1_7597: bitstring));
                                                    {9109}if (verify(m1_7596,sigM1_7597,pkCli_7575) <> true) then
                                                        0
                                                    else
                                                        {9110}let (=Sess_5512,SPc_7598: bitstring,PartC_7599: bitstring) = m1_7596 in
                                                        {9111}new Ns_7600: bitstring;
                                                        {9112}let m2_7601: bitstring = (Cli_5510,exp(g,Ns_7600)) in
                                                        {9113}out(c, (m2_7601,sign(m2_7601,skSess_7210)));
                                                        {9114}let Ksrv_7602: bitstring = exp(PartC_7599,Ns_7600) in
                                                        {9115}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7602))
                                                )
                                                else
                                                    {9116}let pkDisco_7603: bitstring = pub(skI) in
                                                    {9117}in(c, (=pkCli_7575,m1_7604: bitstring,sigM1_7605: bitstring));
                                                    {9118}if (verify(m1_7604,sigM1_7605,pkCli_7575) <> true) then
                                                        0
                                                    else
                                                        {9119}let (=Sess_5512,SPc_7606: bitstring,PartC_7607: bitstring) = m1_7604 in
                                                        {9120}new Ns_7608: bitstring;
                                                        {9121}let m2_7609: bitstring = (Cli_5510,exp(g,Ns_7608)) in
                                                        {9122}out(c, (m2_7609,sign(m2_7609,skSess_7210)));
                                                        {9123}let Ksrv_7610: bitstring = exp(PartC_7607,Ns_7608) in
                                                        {9124}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7610))
                                            )
                                            else
                                                {9125}let pkDisco_7611: bitstring = fail-any in
                                                {9126}in(c, (=pkCli_7575,m1_7612: bitstring,sigM1_7613: bitstring));
                                                {9127}if (verify(m1_7612,sigM1_7613,pkCli_7575) <> true) then
                                                    0
                                                else
                                                    {9128}let (=Sess_5512,SPc_7614: bitstring,PartC_7615: bitstring) = m1_7612 in
                                                    {9129}new Ns_7616: bitstring;
                                                    {9130}let m2_7617: bitstring = (Cli_5510,exp(g,Ns_7616)) in
                                                    {9131}out(c, (m2_7617,sign(m2_7617,skSess_7210)));
                                                    {9132}let Ksrv_7618: bitstring = exp(PartC_7615,Ns_7616) in
                                                    {9133}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7618))
                                    )
                                    else
                                        {9134}let pkDisco_7619: bitstring = fail-any in
                                        {9135}in(c, (=pkCli_7575,m1_7620: bitstring,sigM1_7621: bitstring));
                                        {9136}if (verify(m1_7620,sigM1_7621,pkCli_7575) <> true) then
                                            0
                                        else
                                            {9137}let (=Sess_5512,SPc_7622: bitstring,PartC_7623: bitstring) = m1_7620 in
                                            {9138}new Ns_7624: bitstring;
                                            {9139}let m2_7625: bitstring = (Cli_5510,exp(g,Ns_7624)) in
                                            {9140}out(c, (m2_7625,sign(m2_7625,skSess_7210)));
                                            {9141}let Ksrv_7626: bitstring = exp(PartC_7623,Ns_7624) in
                                            {9142}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7626))
                            )
                            else
                                {9143}let pkDisco_7627: bitstring = fail-any in
                                {9144}in(c, (=pkCli_7575,m1_7628: bitstring,sigM1_7629: bitstring));
                                {9145}if (verify(m1_7628,sigM1_7629,pkCli_7575) <> true) then
                                    0
                                else
                                    {9146}let (=Sess_5512,SPc_7630: bitstring,PartC_7631: bitstring) = m1_7628 in
                                    {9147}new Ns_7632: bitstring;
                                    {9148}let m2_7633: bitstring = (Cli_5510,exp(g,Ns_7632)) in
                                    {9149}out(c, (m2_7633,sign(m2_7633,skSess_7210)));
                                    {9150}let Ksrv_7634: bitstring = exp(PartC_7631,Ns_7632) in
                                    {9151}out(c, senc(mSrv(pkCli_7575,pkSess_7211),Ksrv_7634))
            )
            else
                {9152}let skSess_7635: bitstring = fail-any in
                {9153}let pkSess_7636: bitstring = pub(skSess_7635) in
                {9154}let v_7637: bool = (Cli_5510 = A) in
                (
                    {9155}if v_7637 then
                    (
                        {9156}let pkCli_7638: bitstring = pub(skA) in
                        {9157}let v_7639: bool = (Disco_5511 = A) in
                        (
                            {9158}if v_7639 then
                            (
                                {9159}let pkDisco_7640: bitstring = pub(skA) in
                                {9160}in(c, (=pkCli_7638,m1_7641: bitstring,sigM1_7642: bitstring));
                                {9161}if (verify(m1_7641,sigM1_7642,pkCli_7638) <> true) then
                                    0
                                else
                                    {9162}let (=Sess_5512,SPc_7643: bitstring,PartC_7644: bitstring) = m1_7641 in
                                    {9163}new Ns_7645: bitstring;
                                    {9164}let m2_7646: bitstring = (Cli_5510,exp(g,Ns_7645)) in
                                    {9165}out(c, (m2_7646,sign(m2_7646,skSess_7635)));
                                    {9166}let Ksrv_7647: bitstring = exp(PartC_7644,Ns_7645) in
                                    {9167}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7647))
                            )
                            else
                                {9168}let v_7648: bool = (Disco_5511 = B) in
                                (
                                    {9169}if v_7648 then
                                    (
                                        {9170}let pkDisco_7649: bitstring = pub(skB) in
                                        {9171}in(c, (=pkCli_7638,m1_7650: bitstring,sigM1_7651: bitstring));
                                        {9172}if (verify(m1_7650,sigM1_7651,pkCli_7638) <> true) then
                                            0
                                        else
                                            {9173}let (=Sess_5512,SPc_7652: bitstring,PartC_7653: bitstring) = m1_7650 in
                                            {9174}new Ns_7654: bitstring;
                                            {9175}let m2_7655: bitstring = (Cli_5510,exp(g,Ns_7654)) in
                                            {9176}out(c, (m2_7655,sign(m2_7655,skSess_7635)));
                                            {9177}let Ksrv_7656: bitstring = exp(PartC_7653,Ns_7654) in
                                            {9178}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7656))
                                    )
                                    else
                                        {9179}let v_7657: bool = (Disco_5511 = C) in
                                        (
                                            {9180}if v_7657 then
                                            (
                                                {9181}let pkDisco_7658: bitstring = pub(skC) in
                                                {9182}in(c, (=pkCli_7638,m1_7659: bitstring,sigM1_7660: bitstring));
                                                {9183}if (verify(m1_7659,sigM1_7660,pkCli_7638) <> true) then
                                                    0
                                                else
                                                    {9184}let (=Sess_5512,SPc_7661: bitstring,PartC_7662: bitstring) = m1_7659 in
                                                    {9185}new Ns_7663: bitstring;
                                                    {9186}let m2_7664: bitstring = (Cli_5510,exp(g,Ns_7663)) in
                                                    {9187}out(c, (m2_7664,sign(m2_7664,skSess_7635)));
                                                    {9188}let Ksrv_7665: bitstring = exp(PartC_7662,Ns_7663) in
                                                    {9189}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7665))
                                            )
                                            else
                                                {9190}let pkDisco_7666: bitstring = pub(skI) in
                                                {9191}in(c, (=pkCli_7638,m1_7667: bitstring,sigM1_7668: bitstring));
                                                {9192}if (verify(m1_7667,sigM1_7668,pkCli_7638) <> true) then
                                                    0
                                                else
                                                    {9193}let (=Sess_5512,SPc_7669: bitstring,PartC_7670: bitstring) = m1_7667 in
                                                    {9194}new Ns_7671: bitstring;
                                                    {9195}let m2_7672: bitstring = (Cli_5510,exp(g,Ns_7671)) in
                                                    {9196}out(c, (m2_7672,sign(m2_7672,skSess_7635)));
                                                    {9197}let Ksrv_7673: bitstring = exp(PartC_7670,Ns_7671) in
                                                    {9198}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7673))
                                        )
                                        else
                                            {9199}let pkDisco_7674: bitstring = fail-any in
                                            {9200}in(c, (=pkCli_7638,m1_7675: bitstring,sigM1_7676: bitstring));
                                            {9201}if (verify(m1_7675,sigM1_7676,pkCli_7638) <> true) then
                                                0
                                            else
                                                {9202}let (=Sess_5512,SPc_7677: bitstring,PartC_7678: bitstring) = m1_7675 in
                                                {9203}new Ns_7679: bitstring;
                                                {9204}let m2_7680: bitstring = (Cli_5510,exp(g,Ns_7679)) in
                                                {9205}out(c, (m2_7680,sign(m2_7680,skSess_7635)));
                                                {9206}let Ksrv_7681: bitstring = exp(PartC_7678,Ns_7679) in
                                                {9207}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7681))
                                )
                                else
                                    {9208}let pkDisco_7682: bitstring = fail-any in
                                    {9209}in(c, (=pkCli_7638,m1_7683: bitstring,sigM1_7684: bitstring));
                                    {9210}if (verify(m1_7683,sigM1_7684,pkCli_7638) <> true) then
                                        0
                                    else
                                        {9211}let (=Sess_5512,SPc_7685: bitstring,PartC_7686: bitstring) = m1_7683 in
                                        {9212}new Ns_7687: bitstring;
                                        {9213}let m2_7688: bitstring = (Cli_5510,exp(g,Ns_7687)) in
                                        {9214}out(c, (m2_7688,sign(m2_7688,skSess_7635)));
                                        {9215}let Ksrv_7689: bitstring = exp(PartC_7686,Ns_7687) in
                                        {9216}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7689))
                        )
                        else
                            {9217}let pkDisco_7690: bitstring = fail-any in
                            {9218}in(c, (=pkCli_7638,m1_7691: bitstring,sigM1_7692: bitstring));
                            {9219}if (verify(m1_7691,sigM1_7692,pkCli_7638) <> true) then
                                0
                            else
                                {9220}let (=Sess_5512,SPc_7693: bitstring,PartC_7694: bitstring) = m1_7691 in
                                {9221}new Ns_7695: bitstring;
                                {9222}let m2_7696: bitstring = (Cli_5510,exp(g,Ns_7695)) in
                                {9223}out(c, (m2_7696,sign(m2_7696,skSess_7635)));
                                {9224}let Ksrv_7697: bitstring = exp(PartC_7694,Ns_7695) in
                                {9225}out(c, senc(mSrv(pkCli_7638,pkSess_7636),Ksrv_7697))
                    )
                    else
                        {9226}let v_7698: bool = (Cli_5510 = B) in
                        (
                            {9227}if v_7698 then
                            (
                                {9228}let pkCli_7699: bitstring = pub(skB) in
                                {9229}let v_7700: bool = (Disco_5511 = A) in
                                (
                                    {9230}if v_7700 then
                                    (
                                        {9231}let pkDisco_7701: bitstring = pub(skA) in
                                        {9232}in(c, (=pkCli_7699,m1_7702: bitstring,sigM1_7703: bitstring));
                                        {9233}if (verify(m1_7702,sigM1_7703,pkCli_7699) <> true) then
                                            0
                                        else
                                            {9234}let (=Sess_5512,SPc_7704: bitstring,PartC_7705: bitstring) = m1_7702 in
                                            {9235}new Ns_7706: bitstring;
                                            {9236}let m2_7707: bitstring = (Cli_5510,exp(g,Ns_7706)) in
                                            {9237}out(c, (m2_7707,sign(m2_7707,skSess_7635)));
                                            {9238}let Ksrv_7708: bitstring = exp(PartC_7705,Ns_7706) in
                                            {9239}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7708))
                                    )
                                    else
                                        {9240}let v_7709: bool = (Disco_5511 = B) in
                                        (
                                            {9241}if v_7709 then
                                            (
                                                {9242}let pkDisco_7710: bitstring = pub(skB) in
                                                {9243}in(c, (=pkCli_7699,m1_7711: bitstring,sigM1_7712: bitstring));
                                                {9244}if (verify(m1_7711,sigM1_7712,pkCli_7699) <> true) then
                                                    0
                                                else
                                                    {9245}let (=Sess_5512,SPc_7713: bitstring,PartC_7714: bitstring) = m1_7711 in
                                                    {9246}new Ns_7715: bitstring;
                                                    {9247}let m2_7716: bitstring = (Cli_5510,exp(g,Ns_7715)) in
                                                    {9248}out(c, (m2_7716,sign(m2_7716,skSess_7635)));
                                                    {9249}let Ksrv_7717: bitstring = exp(PartC_7714,Ns_7715) in
                                                    {9250}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7717))
                                            )
                                            else
                                                {9251}let v_7718: bool = (Disco_5511 = C) in
                                                (
                                                    {9252}if v_7718 then
                                                    (
                                                        {9253}let pkDisco_7719: bitstring = pub(skC) in
                                                        {9254}in(c, (=pkCli_7699,m1_7720: bitstring,sigM1_7721: bitstring));
                                                        {9255}if (verify(m1_7720,sigM1_7721,pkCli_7699) <> true) then
                                                            0
                                                        else
                                                            {9256}let (=Sess_5512,SPc_7722: bitstring,PartC_7723: bitstring) = m1_7720 in
                                                            {9257}new Ns_7724: bitstring;
                                                            {9258}let m2_7725: bitstring = (Cli_5510,exp(g,Ns_7724)) in
                                                            {9259}out(c, (m2_7725,sign(m2_7725,skSess_7635)));
                                                            {9260}let Ksrv_7726: bitstring = exp(PartC_7723,Ns_7724) in
                                                            {9261}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7726))
                                                    )
                                                    else
                                                        {9262}let pkDisco_7727: bitstring = pub(skI) in
                                                        {9263}in(c, (=pkCli_7699,m1_7728: bitstring,sigM1_7729: bitstring));
                                                        {9264}if (verify(m1_7728,sigM1_7729,pkCli_7699) <> true) then
                                                            0
                                                        else
                                                            {9265}let (=Sess_5512,SPc_7730: bitstring,PartC_7731: bitstring) = m1_7728 in
                                                            {9266}new Ns_7732: bitstring;
                                                            {9267}let m2_7733: bitstring = (Cli_5510,exp(g,Ns_7732)) in
                                                            {9268}out(c, (m2_7733,sign(m2_7733,skSess_7635)));
                                                            {9269}let Ksrv_7734: bitstring = exp(PartC_7731,Ns_7732) in
                                                            {9270}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7734))
                                                )
                                                else
                                                    {9271}let pkDisco_7735: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_7699,m1_7736: bitstring,sigM1_7737: bitstring));
                                                    {9273}if (verify(m1_7736,sigM1_7737,pkCli_7699) <> true) then
                                                        0
                                                    else
                                                        {9274}let (=Sess_5512,SPc_7738: bitstring,PartC_7739: bitstring) = m1_7736 in
                                                        {9275}new Ns_7740: bitstring;
                                                        {9276}let m2_7741: bitstring = (Cli_5510,exp(g,Ns_7740)) in
                                                        {9277}out(c, (m2_7741,sign(m2_7741,skSess_7635)));
                                                        {9278}let Ksrv_7742: bitstring = exp(PartC_7739,Ns_7740) in
                                                        {9279}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7742))
                                        )
                                        else
                                            {9280}let pkDisco_7743: bitstring = fail-any in
                                            {9281}in(c, (=pkCli_7699,m1_7744: bitstring,sigM1_7745: bitstring));
                                            {9282}if (verify(m1_7744,sigM1_7745,pkCli_7699) <> true) then
                                                0
                                            else
                                                {9283}let (=Sess_5512,SPc_7746: bitstring,PartC_7747: bitstring) = m1_7744 in
                                                {9284}new Ns_7748: bitstring;
                                                {9285}let m2_7749: bitstring = (Cli_5510,exp(g,Ns_7748)) in
                                                {9286}out(c, (m2_7749,sign(m2_7749,skSess_7635)));
                                                {9287}let Ksrv_7750: bitstring = exp(PartC_7747,Ns_7748) in
                                                {9288}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7750))
                                )
                                else
                                    {9289}let pkDisco_7751: bitstring = fail-any in
                                    {9290}in(c, (=pkCli_7699,m1_7752: bitstring,sigM1_7753: bitstring));
                                    {9291}if (verify(m1_7752,sigM1_7753,pkCli_7699) <> true) then
                                        0
                                    else
                                        {9292}let (=Sess_5512,SPc_7754: bitstring,PartC_7755: bitstring) = m1_7752 in
                                        {9293}new Ns_7756: bitstring;
                                        {9294}let m2_7757: bitstring = (Cli_5510,exp(g,Ns_7756)) in
                                        {9295}out(c, (m2_7757,sign(m2_7757,skSess_7635)));
                                        {9296}let Ksrv_7758: bitstring = exp(PartC_7755,Ns_7756) in
                                        {9297}out(c, senc(mSrv(pkCli_7699,pkSess_7636),Ksrv_7758))
                            )
                            else
                                {9298}let v_7759: bool = (Cli_5510 = C) in
                                (
                                    {9299}if v_7759 then
                                    (
                                        {9300}let pkCli_7760: bitstring = pub(skC) in
                                        {9301}let v_7761: bool = (Disco_5511 = A) in
                                        (
                                            {9302}if v_7761 then
                                            (
                                                {9303}let pkDisco_7762: bitstring = pub(skA) in
                                                {9304}in(c, (=pkCli_7760,m1_7763: bitstring,sigM1_7764: bitstring));
                                                {9305}if (verify(m1_7763,sigM1_7764,pkCli_7760) <> true) then
                                                    0
                                                else
                                                    {9306}let (=Sess_5512,SPc_7765: bitstring,PartC_7766: bitstring) = m1_7763 in
                                                    {9307}new Ns_7767: bitstring;
                                                    {9308}let m2_7768: bitstring = (Cli_5510,exp(g,Ns_7767)) in
                                                    {9309}out(c, (m2_7768,sign(m2_7768,skSess_7635)));
                                                    {9310}let Ksrv_7769: bitstring = exp(PartC_7766,Ns_7767) in
                                                    {9311}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7769))
                                            )
                                            else
                                                {9312}let v_7770: bool = (Disco_5511 = B) in
                                                (
                                                    {9313}if v_7770 then
                                                    (
                                                        {9314}let pkDisco_7771: bitstring = pub(skB) in
                                                        {9315}in(c, (=pkCli_7760,m1_7772: bitstring,sigM1_7773: bitstring));
                                                        {9316}if (verify(m1_7772,sigM1_7773,pkCli_7760) <> true) then
                                                            0
                                                        else
                                                            {9317}let (=Sess_5512,SPc_7774: bitstring,PartC_7775: bitstring) = m1_7772 in
                                                            {9318}new Ns_7776: bitstring;
                                                            {9319}let m2_7777: bitstring = (Cli_5510,exp(g,Ns_7776)) in
                                                            {9320}out(c, (m2_7777,sign(m2_7777,skSess_7635)));
                                                            {9321}let Ksrv_7778: bitstring = exp(PartC_7775,Ns_7776) in
                                                            {9322}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7778))
                                                    )
                                                    else
                                                        {9323}let v_7779: bool = (Disco_5511 = C) in
                                                        (
                                                            {9324}if v_7779 then
                                                            (
                                                                {9325}let pkDisco_7780: bitstring = pub(skC) in
                                                                {9326}in(c, (=pkCli_7760,m1_7781: bitstring,sigM1_7782: bitstring));
                                                                {9327}if (verify(m1_7781,sigM1_7782,pkCli_7760) <> true) then
                                                                    0
                                                                else
                                                                    {9328}let (=Sess_5512,SPc_7783: bitstring,PartC_7784: bitstring) = m1_7781 in
                                                                    {9329}new Ns_7785: bitstring;
                                                                    {9330}let m2_7786: bitstring = (Cli_5510,exp(g,Ns_7785)) in
                                                                    {9331}out(c, (m2_7786,sign(m2_7786,skSess_7635)));
                                                                    {9332}let Ksrv_7787: bitstring = exp(PartC_7784,Ns_7785) in
                                                                    {9333}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7787))
                                                            )
                                                            else
                                                                {9334}let pkDisco_7788: bitstring = pub(skI) in
                                                                {9335}in(c, (=pkCli_7760,m1_7789: bitstring,sigM1_7790: bitstring));
                                                                {9336}if (verify(m1_7789,sigM1_7790,pkCli_7760) <> true) then
                                                                    0
                                                                else
                                                                    {9337}let (=Sess_5512,SPc_7791: bitstring,PartC_7792: bitstring) = m1_7789 in
                                                                    {9338}new Ns_7793: bitstring;
                                                                    {9339}let m2_7794: bitstring = (Cli_5510,exp(g,Ns_7793)) in
                                                                    {9340}out(c, (m2_7794,sign(m2_7794,skSess_7635)));
                                                                    {9341}let Ksrv_7795: bitstring = exp(PartC_7792,Ns_7793) in
                                                                    {9342}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7795))
                                                        )
                                                        else
                                                            {9343}let pkDisco_7796: bitstring = fail-any in
                                                            {9344}in(c, (=pkCli_7760,m1_7797: bitstring,sigM1_7798: bitstring));
                                                            {9345}if (verify(m1_7797,sigM1_7798,pkCli_7760) <> true) then
                                                                0
                                                            else
                                                                {9346}let (=Sess_5512,SPc_7799: bitstring,PartC_7800: bitstring) = m1_7797 in
                                                                {9347}new Ns_7801: bitstring;
                                                                {9348}let m2_7802: bitstring = (Cli_5510,exp(g,Ns_7801)) in
                                                                {9349}out(c, (m2_7802,sign(m2_7802,skSess_7635)));
                                                                {9350}let Ksrv_7803: bitstring = exp(PartC_7800,Ns_7801) in
                                                                {9351}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7803))
                                                )
                                                else
                                                    {9352}let pkDisco_7804: bitstring = fail-any in
                                                    {9353}in(c, (=pkCli_7760,m1_7805: bitstring,sigM1_7806: bitstring));
                                                    {9354}if (verify(m1_7805,sigM1_7806,pkCli_7760) <> true) then
                                                        0
                                                    else
                                                        {9355}let (=Sess_5512,SPc_7807: bitstring,PartC_7808: bitstring) = m1_7805 in
                                                        {9356}new Ns_7809: bitstring;
                                                        {9357}let m2_7810: bitstring = (Cli_5510,exp(g,Ns_7809)) in
                                                        {9358}out(c, (m2_7810,sign(m2_7810,skSess_7635)));
                                                        {9359}let Ksrv_7811: bitstring = exp(PartC_7808,Ns_7809) in
                                                        {9360}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7811))
                                        )
                                        else
                                            {9361}let pkDisco_7812: bitstring = fail-any in
                                            {9362}in(c, (=pkCli_7760,m1_7813: bitstring,sigM1_7814: bitstring));
                                            {9363}if (verify(m1_7813,sigM1_7814,pkCli_7760) <> true) then
                                                0
                                            else
                                                {9364}let (=Sess_5512,SPc_7815: bitstring,PartC_7816: bitstring) = m1_7813 in
                                                {9365}new Ns_7817: bitstring;
                                                {9366}let m2_7818: bitstring = (Cli_5510,exp(g,Ns_7817)) in
                                                {9367}out(c, (m2_7818,sign(m2_7818,skSess_7635)));
                                                {9368}let Ksrv_7819: bitstring = exp(PartC_7816,Ns_7817) in
                                                {9369}out(c, senc(mSrv(pkCli_7760,pkSess_7636),Ksrv_7819))
                                    )
                                    else
                                        {9370}let pkCli_7820: bitstring = pub(skI) in
                                        {9371}let v_7821: bool = (Disco_5511 = A) in
                                        (
                                            {9372}if v_7821 then
                                            (
                                                {9373}let pkDisco_7822: bitstring = pub(skA) in
                                                {9374}in(c, (=pkCli_7820,m1_7823: bitstring,sigM1_7824: bitstring));
                                                {9375}if (verify(m1_7823,sigM1_7824,pkCli_7820) <> true) then
                                                    0
                                                else
                                                    {9376}let (=Sess_5512,SPc_7825: bitstring,PartC_7826: bitstring) = m1_7823 in
                                                    {9377}new Ns_7827: bitstring;
                                                    {9378}let m2_7828: bitstring = (Cli_5510,exp(g,Ns_7827)) in
                                                    {9379}out(c, (m2_7828,sign(m2_7828,skSess_7635)));
                                                    {9380}let Ksrv_7829: bitstring = exp(PartC_7826,Ns_7827) in
                                                    {9381}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7829))
                                            )
                                            else
                                                {9382}let v_7830: bool = (Disco_5511 = B) in
                                                (
                                                    {9383}if v_7830 then
                                                    (
                                                        {9384}let pkDisco_7831: bitstring = pub(skB) in
                                                        {9385}in(c, (=pkCli_7820,m1_7832: bitstring,sigM1_7833: bitstring));
                                                        {9386}if (verify(m1_7832,sigM1_7833,pkCli_7820) <> true) then
                                                            0
                                                        else
                                                            {9387}let (=Sess_5512,SPc_7834: bitstring,PartC_7835: bitstring) = m1_7832 in
                                                            {9388}new Ns_7836: bitstring;
                                                            {9389}let m2_7837: bitstring = (Cli_5510,exp(g,Ns_7836)) in
                                                            {9390}out(c, (m2_7837,sign(m2_7837,skSess_7635)));
                                                            {9391}let Ksrv_7838: bitstring = exp(PartC_7835,Ns_7836) in
                                                            {9392}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7838))
                                                    )
                                                    else
                                                        {9393}let v_7839: bool = (Disco_5511 = C) in
                                                        (
                                                            {9394}if v_7839 then
                                                            (
                                                                {9395}let pkDisco_7840: bitstring = pub(skC) in
                                                                {9396}in(c, (=pkCli_7820,m1_7841: bitstring,sigM1_7842: bitstring));
                                                                {9397}if (verify(m1_7841,sigM1_7842,pkCli_7820) <> true) then
                                                                    0
                                                                else
                                                                    {9398}let (=Sess_5512,SPc_7843: bitstring,PartC_7844: bitstring) = m1_7841 in
                                                                    {9399}new Ns_7845: bitstring;
                                                                    {9400}let m2_7846: bitstring = (Cli_5510,exp(g,Ns_7845)) in
                                                                    {9401}out(c, (m2_7846,sign(m2_7846,skSess_7635)));
                                                                    {9402}let Ksrv_7847: bitstring = exp(PartC_7844,Ns_7845) in
                                                                    {9403}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7847))
                                                            )
                                                            else
                                                                {9404}let pkDisco_7848: bitstring = pub(skI) in
                                                                {9405}in(c, (=pkCli_7820,m1_7849: bitstring,sigM1_7850: bitstring));
                                                                {9406}if (verify(m1_7849,sigM1_7850,pkCli_7820) <> true) then
                                                                    0
                                                                else
                                                                    {9407}let (=Sess_5512,SPc_7851: bitstring,PartC_7852: bitstring) = m1_7849 in
                                                                    {9408}new Ns_7853: bitstring;
                                                                    {9409}let m2_7854: bitstring = (Cli_5510,exp(g,Ns_7853)) in
                                                                    {9410}out(c, (m2_7854,sign(m2_7854,skSess_7635)));
                                                                    {9411}let Ksrv_7855: bitstring = exp(PartC_7852,Ns_7853) in
                                                                    {9412}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7855))
                                                        )
                                                        else
                                                            {9413}let pkDisco_7856: bitstring = fail-any in
                                                            {9414}in(c, (=pkCli_7820,m1_7857: bitstring,sigM1_7858: bitstring));
                                                            {9415}if (verify(m1_7857,sigM1_7858,pkCli_7820) <> true) then
                                                                0
                                                            else
                                                                {9416}let (=Sess_5512,SPc_7859: bitstring,PartC_7860: bitstring) = m1_7857 in
                                                                {9417}new Ns_7861: bitstring;
                                                                {9418}let m2_7862: bitstring = (Cli_5510,exp(g,Ns_7861)) in
                                                                {9419}out(c, (m2_7862,sign(m2_7862,skSess_7635)));
                                                                {9420}let Ksrv_7863: bitstring = exp(PartC_7860,Ns_7861) in
                                                                {9421}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7863))
                                                )
                                                else
                                                    {9422}let pkDisco_7864: bitstring = fail-any in
                                                    {9423}in(c, (=pkCli_7820,m1_7865: bitstring,sigM1_7866: bitstring));
                                                    {9424}if (verify(m1_7865,sigM1_7866,pkCli_7820) <> true) then
                                                        0
                                                    else
                                                        {9425}let (=Sess_5512,SPc_7867: bitstring,PartC_7868: bitstring) = m1_7865 in
                                                        {9426}new Ns_7869: bitstring;
                                                        {9427}let m2_7870: bitstring = (Cli_5510,exp(g,Ns_7869)) in
                                                        {9428}out(c, (m2_7870,sign(m2_7870,skSess_7635)));
                                                        {9429}let Ksrv_7871: bitstring = exp(PartC_7868,Ns_7869) in
                                                        {9430}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7871))
                                        )
                                        else
                                            {9431}let pkDisco_7872: bitstring = fail-any in
                                            {9432}in(c, (=pkCli_7820,m1_7873: bitstring,sigM1_7874: bitstring));
                                            {9433}if (verify(m1_7873,sigM1_7874,pkCli_7820) <> true) then
                                                0
                                            else
                                                {9434}let (=Sess_5512,SPc_7875: bitstring,PartC_7876: bitstring) = m1_7873 in
                                                {9435}new Ns_7877: bitstring;
                                                {9436}let m2_7878: bitstring = (Cli_5510,exp(g,Ns_7877)) in
                                                {9437}out(c, (m2_7878,sign(m2_7878,skSess_7635)));
                                                {9438}let Ksrv_7879: bitstring = exp(PartC_7876,Ns_7877) in
                                                {9439}out(c, senc(mSrv(pkCli_7820,pkSess_7636),Ksrv_7879))
                                )
                                else
                                    {9440}let pkCli_7880: bitstring = fail-any in
                                    {9441}let v_7881: bool = (Disco_5511 = A) in
                                    (
                                        {9442}if v_7881 then
                                        (
                                            {9443}let pkDisco_7882: bitstring = pub(skA) in
                                            {9444}in(c, (=pkCli_7880,m1_7883: bitstring,sigM1_7884: bitstring));
                                            {9445}if (verify(m1_7883,sigM1_7884,pkCli_7880) <> true) then
                                                0
                                            else
                                                {9446}let (=Sess_5512,SPc_7885: bitstring,PartC_7886: bitstring) = m1_7883 in
                                                {9447}new Ns_7887: bitstring;
                                                {9448}let m2_7888: bitstring = (Cli_5510,exp(g,Ns_7887)) in
                                                {9449}out(c, (m2_7888,sign(m2_7888,skSess_7635)));
                                                {9450}let Ksrv_7889: bitstring = exp(PartC_7886,Ns_7887) in
                                                {9451}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7889))
                                        )
                                        else
                                            {9452}let v_7890: bool = (Disco_5511 = B) in
                                            (
                                                {9453}if v_7890 then
                                                (
                                                    {9454}let pkDisco_7891: bitstring = pub(skB) in
                                                    {9455}in(c, (=pkCli_7880,m1_7892: bitstring,sigM1_7893: bitstring));
                                                    {9456}if (verify(m1_7892,sigM1_7893,pkCli_7880) <> true) then
                                                        0
                                                    else
                                                        {9457}let (=Sess_5512,SPc_7894: bitstring,PartC_7895: bitstring) = m1_7892 in
                                                        {9458}new Ns_7896: bitstring;
                                                        {9459}let m2_7897: bitstring = (Cli_5510,exp(g,Ns_7896)) in
                                                        {9460}out(c, (m2_7897,sign(m2_7897,skSess_7635)));
                                                        {9461}let Ksrv_7898: bitstring = exp(PartC_7895,Ns_7896) in
                                                        {9462}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7898))
                                                )
                                                else
                                                    {9463}let v_7899: bool = (Disco_5511 = C) in
                                                    (
                                                        {9464}if v_7899 then
                                                        (
                                                            {9465}let pkDisco_7900: bitstring = pub(skC) in
                                                            {9466}in(c, (=pkCli_7880,m1_7901: bitstring,sigM1_7902: bitstring));
                                                            {9467}if (verify(m1_7901,sigM1_7902,pkCli_7880) <> true) then
                                                                0
                                                            else
                                                                {9468}let (=Sess_5512,SPc_7903: bitstring,PartC_7904: bitstring) = m1_7901 in
                                                                {9469}new Ns_7905: bitstring;
                                                                {9470}let m2_7906: bitstring = (Cli_5510,exp(g,Ns_7905)) in
                                                                {9471}out(c, (m2_7906,sign(m2_7906,skSess_7635)));
                                                                {9472}let Ksrv_7907: bitstring = exp(PartC_7904,Ns_7905) in
                                                                {9473}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7907))
                                                        )
                                                        else
                                                            {9474}let pkDisco_7908: bitstring = pub(skI) in
                                                            {9475}in(c, (=pkCli_7880,m1_7909: bitstring,sigM1_7910: bitstring));
                                                            {9476}if (verify(m1_7909,sigM1_7910,pkCli_7880) <> true) then
                                                                0
                                                            else
                                                                {9477}let (=Sess_5512,SPc_7911: bitstring,PartC_7912: bitstring) = m1_7909 in
                                                                {9478}new Ns_7913: bitstring;
                                                                {9479}let m2_7914: bitstring = (Cli_5510,exp(g,Ns_7913)) in
                                                                {9480}out(c, (m2_7914,sign(m2_7914,skSess_7635)));
                                                                {9481}let Ksrv_7915: bitstring = exp(PartC_7912,Ns_7913) in
                                                                {9482}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7915))
                                                    )
                                                    else
                                                        {9483}let pkDisco_7916: bitstring = fail-any in
                                                        {9484}in(c, (=pkCli_7880,m1_7917: bitstring,sigM1_7918: bitstring));
                                                        {9485}if (verify(m1_7917,sigM1_7918,pkCli_7880) <> true) then
                                                            0
                                                        else
                                                            {9486}let (=Sess_5512,SPc_7919: bitstring,PartC_7920: bitstring) = m1_7917 in
                                                            {9487}new Ns_7921: bitstring;
                                                            {9488}let m2_7922: bitstring = (Cli_5510,exp(g,Ns_7921)) in
                                                            {9489}out(c, (m2_7922,sign(m2_7922,skSess_7635)));
                                                            {9490}let Ksrv_7923: bitstring = exp(PartC_7920,Ns_7921) in
                                                            {9491}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7923))
                                            )
                                            else
                                                {9492}let pkDisco_7924: bitstring = fail-any in
                                                {9493}in(c, (=pkCli_7880,m1_7925: bitstring,sigM1_7926: bitstring));
                                                {9494}if (verify(m1_7925,sigM1_7926,pkCli_7880) <> true) then
                                                    0
                                                else
                                                    {9495}let (=Sess_5512,SPc_7927: bitstring,PartC_7928: bitstring) = m1_7925 in
                                                    {9496}new Ns_7929: bitstring;
                                                    {9497}let m2_7930: bitstring = (Cli_5510,exp(g,Ns_7929)) in
                                                    {9498}out(c, (m2_7930,sign(m2_7930,skSess_7635)));
                                                    {9499}let Ksrv_7931: bitstring = exp(PartC_7928,Ns_7929) in
                                                    {9500}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7931))
                                    )
                                    else
                                        {9501}let pkDisco_7932: bitstring = fail-any in
                                        {9502}in(c, (=pkCli_7880,m1_7933: bitstring,sigM1_7934: bitstring));
                                        {9503}if (verify(m1_7933,sigM1_7934,pkCli_7880) <> true) then
                                            0
                                        else
                                            {9504}let (=Sess_5512,SPc_7935: bitstring,PartC_7936: bitstring) = m1_7933 in
                                            {9505}new Ns_7937: bitstring;
                                            {9506}let m2_7938: bitstring = (Cli_5510,exp(g,Ns_7937)) in
                                            {9507}out(c, (m2_7938,sign(m2_7938,skSess_7635)));
                                            {9508}let Ksrv_7939: bitstring = exp(PartC_7936,Ns_7937) in
                                            {9509}out(c, senc(mSrv(pkCli_7880,pkSess_7636),Ksrv_7939))
                        )
                        else
                            {9510}let pkCli_7940: bitstring = fail-any in
                            {9511}let v_7941: bool = (Disco_5511 = A) in
                            (
                                {9512}if v_7941 then
                                (
                                    {9513}let pkDisco_7942: bitstring = pub(skA) in
                                    {9514}in(c, (=pkCli_7940,m1_7943: bitstring,sigM1_7944: bitstring));
                                    {9515}if (verify(m1_7943,sigM1_7944,pkCli_7940) <> true) then
                                        0
                                    else
                                        {9516}let (=Sess_5512,SPc_7945: bitstring,PartC_7946: bitstring) = m1_7943 in
                                        {9517}new Ns_7947: bitstring;
                                        {9518}let m2_7948: bitstring = (Cli_5510,exp(g,Ns_7947)) in
                                        {9519}out(c, (m2_7948,sign(m2_7948,skSess_7635)));
                                        {9520}let Ksrv_7949: bitstring = exp(PartC_7946,Ns_7947) in
                                        {9521}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7949))
                                )
                                else
                                    {9522}let v_7950: bool = (Disco_5511 = B) in
                                    (
                                        {9523}if v_7950 then
                                        (
                                            {9524}let pkDisco_7951: bitstring = pub(skB) in
                                            {9525}in(c, (=pkCli_7940,m1_7952: bitstring,sigM1_7953: bitstring));
                                            {9526}if (verify(m1_7952,sigM1_7953,pkCli_7940) <> true) then
                                                0
                                            else
                                                {9527}let (=Sess_5512,SPc_7954: bitstring,PartC_7955: bitstring) = m1_7952 in
                                                {9528}new Ns_7956: bitstring;
                                                {9529}let m2_7957: bitstring = (Cli_5510,exp(g,Ns_7956)) in
                                                {9530}out(c, (m2_7957,sign(m2_7957,skSess_7635)));
                                                {9531}let Ksrv_7958: bitstring = exp(PartC_7955,Ns_7956) in
                                                {9532}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7958))
                                        )
                                        else
                                            {9533}let v_7959: bool = (Disco_5511 = C) in
                                            (
                                                {9534}if v_7959 then
                                                (
                                                    {9535}let pkDisco_7960: bitstring = pub(skC) in
                                                    {9536}in(c, (=pkCli_7940,m1_7961: bitstring,sigM1_7962: bitstring));
                                                    {9537}if (verify(m1_7961,sigM1_7962,pkCli_7940) <> true) then
                                                        0
                                                    else
                                                        {9538}let (=Sess_5512,SPc_7963: bitstring,PartC_7964: bitstring) = m1_7961 in
                                                        {9539}new Ns_7965: bitstring;
                                                        {9540}let m2_7966: bitstring = (Cli_5510,exp(g,Ns_7965)) in
                                                        {9541}out(c, (m2_7966,sign(m2_7966,skSess_7635)));
                                                        {9542}let Ksrv_7967: bitstring = exp(PartC_7964,Ns_7965) in
                                                        {9543}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7967))
                                                )
                                                else
                                                    {9544}let pkDisco_7968: bitstring = pub(skI) in
                                                    {9545}in(c, (=pkCli_7940,m1_7969: bitstring,sigM1_7970: bitstring));
                                                    {9546}if (verify(m1_7969,sigM1_7970,pkCli_7940) <> true) then
                                                        0
                                                    else
                                                        {9547}let (=Sess_5512,SPc_7971: bitstring,PartC_7972: bitstring) = m1_7969 in
                                                        {9548}new Ns_7973: bitstring;
                                                        {9549}let m2_7974: bitstring = (Cli_5510,exp(g,Ns_7973)) in
                                                        {9550}out(c, (m2_7974,sign(m2_7974,skSess_7635)));
                                                        {9551}let Ksrv_7975: bitstring = exp(PartC_7972,Ns_7973) in
                                                        {9552}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7975))
                                            )
                                            else
                                                {9553}let pkDisco_7976: bitstring = fail-any in
                                                {9554}in(c, (=pkCli_7940,m1_7977: bitstring,sigM1_7978: bitstring));
                                                {9555}if (verify(m1_7977,sigM1_7978,pkCli_7940) <> true) then
                                                    0
                                                else
                                                    {9556}let (=Sess_5512,SPc_7979: bitstring,PartC_7980: bitstring) = m1_7977 in
                                                    {9557}new Ns_7981: bitstring;
                                                    {9558}let m2_7982: bitstring = (Cli_5510,exp(g,Ns_7981)) in
                                                    {9559}out(c, (m2_7982,sign(m2_7982,skSess_7635)));
                                                    {9560}let Ksrv_7983: bitstring = exp(PartC_7980,Ns_7981) in
                                                    {9561}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7983))
                                    )
                                    else
                                        {9562}let pkDisco_7984: bitstring = fail-any in
                                        {9563}in(c, (=pkCli_7940,m1_7985: bitstring,sigM1_7986: bitstring));
                                        {9564}if (verify(m1_7985,sigM1_7986,pkCli_7940) <> true) then
                                            0
                                        else
                                            {9565}let (=Sess_5512,SPc_7987: bitstring,PartC_7988: bitstring) = m1_7985 in
                                            {9566}new Ns_7989: bitstring;
                                            {9567}let m2_7990: bitstring = (Cli_5510,exp(g,Ns_7989)) in
                                            {9568}out(c, (m2_7990,sign(m2_7990,skSess_7635)));
                                            {9569}let Ksrv_7991: bitstring = exp(PartC_7988,Ns_7989) in
                                            {9570}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7991))
                            )
                            else
                                {9571}let pkDisco_7992: bitstring = fail-any in
                                {9572}in(c, (=pkCli_7940,m1_7993: bitstring,sigM1_7994: bitstring));
                                {9573}if (verify(m1_7993,sigM1_7994,pkCli_7940) <> true) then
                                    0
                                else
                                    {9574}let (=Sess_5512,SPc_7995: bitstring,PartC_7996: bitstring) = m1_7993 in
                                    {9575}new Ns_7997: bitstring;
                                    {9576}let m2_7998: bitstring = (Cli_5510,exp(g,Ns_7997)) in
                                    {9577}out(c, (m2_7998,sign(m2_7998,skSess_7635)));
                                    {9578}let Ksrv_7999: bitstring = exp(PartC_7996,Ns_7997) in
                                    {9579}out(c, senc(mSrv(pkCli_7940,pkSess_7636),Ksrv_7999))
                )
                else
                    {9580}let pkCli_8000: bitstring = fail-any in
                    {9581}let v_8001: bool = (Disco_5511 = A) in
                    (
                        {9582}if v_8001 then
                        (
                            {9583}let pkDisco_8002: bitstring = pub(skA) in
                            {9584}in(c, (=pkCli_8000,m1_8003: bitstring,sigM1_8004: bitstring));
                            {9585}if (verify(m1_8003,sigM1_8004,pkCli_8000) <> true) then
                                0
                            else
                                {9586}let (=Sess_5512,SPc_8005: bitstring,PartC_8006: bitstring) = m1_8003 in
                                {9587}new Ns_8007: bitstring;
                                {9588}let m2_8008: bitstring = (Cli_5510,exp(g,Ns_8007)) in
                                {9589}out(c, (m2_8008,sign(m2_8008,skSess_7635)));
                                {9590}let Ksrv_8009: bitstring = exp(PartC_8006,Ns_8007) in
                                {9591}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8009))
                        )
                        else
                            {9592}let v_8010: bool = (Disco_5511 = B) in
                            (
                                {9593}if v_8010 then
                                (
                                    {9594}let pkDisco_8011: bitstring = pub(skB) in
                                    {9595}in(c, (=pkCli_8000,m1_8012: bitstring,sigM1_8013: bitstring));
                                    {9596}if (verify(m1_8012,sigM1_8013,pkCli_8000) <> true) then
                                        0
                                    else
                                        {9597}let (=Sess_5512,SPc_8014: bitstring,PartC_8015: bitstring) = m1_8012 in
                                        {9598}new Ns_8016: bitstring;
                                        {9599}let m2_8017: bitstring = (Cli_5510,exp(g,Ns_8016)) in
                                        {9600}out(c, (m2_8017,sign(m2_8017,skSess_7635)));
                                        {9601}let Ksrv_8018: bitstring = exp(PartC_8015,Ns_8016) in
                                        {9602}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8018))
                                )
                                else
                                    {9603}let v_8019: bool = (Disco_5511 = C) in
                                    (
                                        {9604}if v_8019 then
                                        (
                                            {9605}let pkDisco_8020: bitstring = pub(skC) in
                                            {9606}in(c, (=pkCli_8000,m1_8021: bitstring,sigM1_8022: bitstring));
                                            {9607}if (verify(m1_8021,sigM1_8022,pkCli_8000) <> true) then
                                                0
                                            else
                                                {9608}let (=Sess_5512,SPc_8023: bitstring,PartC_8024: bitstring) = m1_8021 in
                                                {9609}new Ns_8025: bitstring;
                                                {9610}let m2_8026: bitstring = (Cli_5510,exp(g,Ns_8025)) in
                                                {9611}out(c, (m2_8026,sign(m2_8026,skSess_7635)));
                                                {9612}let Ksrv_8027: bitstring = exp(PartC_8024,Ns_8025) in
                                                {9613}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8027))
                                        )
                                        else
                                            {9614}let pkDisco_8028: bitstring = pub(skI) in
                                            {9615}in(c, (=pkCli_8000,m1_8029: bitstring,sigM1_8030: bitstring));
                                            {9616}if (verify(m1_8029,sigM1_8030,pkCli_8000) <> true) then
                                                0
                                            else
                                                {9617}let (=Sess_5512,SPc_8031: bitstring,PartC_8032: bitstring) = m1_8029 in
                                                {9618}new Ns_8033: bitstring;
                                                {9619}let m2_8034: bitstring = (Cli_5510,exp(g,Ns_8033)) in
                                                {9620}out(c, (m2_8034,sign(m2_8034,skSess_7635)));
                                                {9621}let Ksrv_8035: bitstring = exp(PartC_8032,Ns_8033) in
                                                {9622}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8035))
                                    )
                                    else
                                        {9623}let pkDisco_8036: bitstring = fail-any in
                                        {9624}in(c, (=pkCli_8000,m1_8037: bitstring,sigM1_8038: bitstring));
                                        {9625}if (verify(m1_8037,sigM1_8038,pkCli_8000) <> true) then
                                            0
                                        else
                                            {9626}let (=Sess_5512,SPc_8039: bitstring,PartC_8040: bitstring) = m1_8037 in
                                            {9627}new Ns_8041: bitstring;
                                            {9628}let m2_8042: bitstring = (Cli_5510,exp(g,Ns_8041)) in
                                            {9629}out(c, (m2_8042,sign(m2_8042,skSess_7635)));
                                            {9630}let Ksrv_8043: bitstring = exp(PartC_8040,Ns_8041) in
                                            {9631}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8043))
                            )
                            else
                                {9632}let pkDisco_8044: bitstring = fail-any in
                                {9633}in(c, (=pkCli_8000,m1_8045: bitstring,sigM1_8046: bitstring));
                                {9634}if (verify(m1_8045,sigM1_8046,pkCli_8000) <> true) then
                                    0
                                else
                                    {9635}let (=Sess_5512,SPc_8047: bitstring,PartC_8048: bitstring) = m1_8045 in
                                    {9636}new Ns_8049: bitstring;
                                    {9637}let m2_8050: bitstring = (Cli_5510,exp(g,Ns_8049)) in
                                    {9638}out(c, (m2_8050,sign(m2_8050,skSess_7635)));
                                    {9639}let Ksrv_8051: bitstring = exp(PartC_8048,Ns_8049) in
                                    {9640}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8051))
                    )
                    else
                        {9641}let pkDisco_8052: bitstring = fail-any in
                        {9642}in(c, (=pkCli_8000,m1_8053: bitstring,sigM1_8054: bitstring));
                        {9643}if (verify(m1_8053,sigM1_8054,pkCli_8000) <> true) then
                            0
                        else
                            {9644}let (=Sess_5512,SPc_8055: bitstring,PartC_8056: bitstring) = m1_8053 in
                            {9645}new Ns_8057: bitstring;
                            {9646}let m2_8058: bitstring = (Cli_5510,exp(g,Ns_8057)) in
                            {9647}out(c, (m2_8058,sign(m2_8058,skSess_7635)));
                            {9648}let Ksrv_8059: bitstring = exp(PartC_8056,Ns_8057) in
                            {9649}out(c, senc(mSrv(pkCli_8000,pkSess_7636),Ksrv_8059))
    )
    else
        {9650}let skSess_8060: bitstring = fail-any in
        {9651}let pkSess_8061: bitstring = pub(skSess_8060) in
        {9652}let v_8062: bool = (Cli_5510 = A) in
        (
            {9653}if v_8062 then
            (
                {9654}let pkCli_8063: bitstring = pub(skA) in
                {9655}let v_8064: bool = (Disco_5511 = A) in
                (
                    {9656}if v_8064 then
                    (
                        {9657}let pkDisco_8065: bitstring = pub(skA) in
                        {9658}in(c, (=pkCli_8063,m1_8066: bitstring,sigM1_8067: bitstring));
                        {9659}if (verify(m1_8066,sigM1_8067,pkCli_8063) <> true) then
                            0
                        else
                            {9660}let (=Sess_5512,SPc_8068: bitstring,PartC_8069: bitstring) = m1_8066 in
                            {9661}new Ns_8070: bitstring;
                            {9662}let m2_8071: bitstring = (Cli_5510,exp(g,Ns_8070)) in
                            {9663}out(c, (m2_8071,sign(m2_8071,skSess_8060)));
                            {9664}let Ksrv_8072: bitstring = exp(PartC_8069,Ns_8070) in
                            {9665}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8072))
                    )
                    else
                        {9666}let v_8073: bool = (Disco_5511 = B) in
                        (
                            {9667}if v_8073 then
                            (
                                {9668}let pkDisco_8074: bitstring = pub(skB) in
                                {9669}in(c, (=pkCli_8063,m1_8075: bitstring,sigM1_8076: bitstring));
                                {9670}if (verify(m1_8075,sigM1_8076,pkCli_8063) <> true) then
                                    0
                                else
                                    {9671}let (=Sess_5512,SPc_8077: bitstring,PartC_8078: bitstring) = m1_8075 in
                                    {9672}new Ns_8079: bitstring;
                                    {9673}let m2_8080: bitstring = (Cli_5510,exp(g,Ns_8079)) in
                                    {9674}out(c, (m2_8080,sign(m2_8080,skSess_8060)));
                                    {9675}let Ksrv_8081: bitstring = exp(PartC_8078,Ns_8079) in
                                    {9676}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8081))
                            )
                            else
                                {9677}let v_8082: bool = (Disco_5511 = C) in
                                (
                                    {9678}if v_8082 then
                                    (
                                        {9679}let pkDisco_8083: bitstring = pub(skC) in
                                        {9680}in(c, (=pkCli_8063,m1_8084: bitstring,sigM1_8085: bitstring));
                                        {9681}if (verify(m1_8084,sigM1_8085,pkCli_8063) <> true) then
                                            0
                                        else
                                            {9682}let (=Sess_5512,SPc_8086: bitstring,PartC_8087: bitstring) = m1_8084 in
                                            {9683}new Ns_8088: bitstring;
                                            {9684}let m2_8089: bitstring = (Cli_5510,exp(g,Ns_8088)) in
                                            {9685}out(c, (m2_8089,sign(m2_8089,skSess_8060)));
                                            {9686}let Ksrv_8090: bitstring = exp(PartC_8087,Ns_8088) in
                                            {9687}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8090))
                                    )
                                    else
                                        {9688}let pkDisco_8091: bitstring = pub(skI) in
                                        {9689}in(c, (=pkCli_8063,m1_8092: bitstring,sigM1_8093: bitstring));
                                        {9690}if (verify(m1_8092,sigM1_8093,pkCli_8063) <> true) then
                                            0
                                        else
                                            {9691}let (=Sess_5512,SPc_8094: bitstring,PartC_8095: bitstring) = m1_8092 in
                                            {9692}new Ns_8096: bitstring;
                                            {9693}let m2_8097: bitstring = (Cli_5510,exp(g,Ns_8096)) in
                                            {9694}out(c, (m2_8097,sign(m2_8097,skSess_8060)));
                                            {9695}let Ksrv_8098: bitstring = exp(PartC_8095,Ns_8096) in
                                            {9696}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8098))
                                )
                                else
                                    {9697}let pkDisco_8099: bitstring = fail-any in
                                    {9698}in(c, (=pkCli_8063,m1_8100: bitstring,sigM1_8101: bitstring));
                                    {9699}if (verify(m1_8100,sigM1_8101,pkCli_8063) <> true) then
                                        0
                                    else
                                        {9700}let (=Sess_5512,SPc_8102: bitstring,PartC_8103: bitstring) = m1_8100 in
                                        {9701}new Ns_8104: bitstring;
                                        {9702}let m2_8105: bitstring = (Cli_5510,exp(g,Ns_8104)) in
                                        {9703}out(c, (m2_8105,sign(m2_8105,skSess_8060)));
                                        {9704}let Ksrv_8106: bitstring = exp(PartC_8103,Ns_8104) in
                                        {9705}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8106))
                        )
                        else
                            {9706}let pkDisco_8107: bitstring = fail-any in
                            {9707}in(c, (=pkCli_8063,m1_8108: bitstring,sigM1_8109: bitstring));
                            {9708}if (verify(m1_8108,sigM1_8109,pkCli_8063) <> true) then
                                0
                            else
                                {9709}let (=Sess_5512,SPc_8110: bitstring,PartC_8111: bitstring) = m1_8108 in
                                {9710}new Ns_8112: bitstring;
                                {9711}let m2_8113: bitstring = (Cli_5510,exp(g,Ns_8112)) in
                                {9712}out(c, (m2_8113,sign(m2_8113,skSess_8060)));
                                {9713}let Ksrv_8114: bitstring = exp(PartC_8111,Ns_8112) in
                                {9714}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8114))
                )
                else
                    {9715}let pkDisco_8115: bitstring = fail-any in
                    {9716}in(c, (=pkCli_8063,m1_8116: bitstring,sigM1_8117: bitstring));
                    {9717}if (verify(m1_8116,sigM1_8117,pkCli_8063) <> true) then
                        0
                    else
                        {9718}let (=Sess_5512,SPc_8118: bitstring,PartC_8119: bitstring) = m1_8116 in
                        {9719}new Ns_8120: bitstring;
                        {9720}let m2_8121: bitstring = (Cli_5510,exp(g,Ns_8120)) in
                        {9721}out(c, (m2_8121,sign(m2_8121,skSess_8060)));
                        {9722}let Ksrv_8122: bitstring = exp(PartC_8119,Ns_8120) in
                        {9723}out(c, senc(mSrv(pkCli_8063,pkSess_8061),Ksrv_8122))
            )
            else
                {9724}let v_8123: bool = (Cli_5510 = B) in
                (
                    {9725}if v_8123 then
                    (
                        {9726}let pkCli_8124: bitstring = pub(skB) in
                        {9727}let v_8125: bool = (Disco_5511 = A) in
                        (
                            {9728}if v_8125 then
                            (
                                {9729}let pkDisco_8126: bitstring = pub(skA) in
                                {9730}in(c, (=pkCli_8124,m1_8127: bitstring,sigM1_8128: bitstring));
                                {9731}if (verify(m1_8127,sigM1_8128,pkCli_8124) <> true) then
                                    0
                                else
                                    {9732}let (=Sess_5512,SPc_8129: bitstring,PartC_8130: bitstring) = m1_8127 in
                                    {9733}new Ns_8131: bitstring;
                                    {9734}let m2_8132: bitstring = (Cli_5510,exp(g,Ns_8131)) in
                                    {9735}out(c, (m2_8132,sign(m2_8132,skSess_8060)));
                                    {9736}let Ksrv_8133: bitstring = exp(PartC_8130,Ns_8131) in
                                    {9737}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8133))
                            )
                            else
                                {9738}let v_8134: bool = (Disco_5511 = B) in
                                (
                                    {9739}if v_8134 then
                                    (
                                        {9740}let pkDisco_8135: bitstring = pub(skB) in
                                        {9741}in(c, (=pkCli_8124,m1_8136: bitstring,sigM1_8137: bitstring));
                                        {9742}if (verify(m1_8136,sigM1_8137,pkCli_8124) <> true) then
                                            0
                                        else
                                            {9743}let (=Sess_5512,SPc_8138: bitstring,PartC_8139: bitstring) = m1_8136 in
                                            {9744}new Ns_8140: bitstring;
                                            {9745}let m2_8141: bitstring = (Cli_5510,exp(g,Ns_8140)) in
                                            {9746}out(c, (m2_8141,sign(m2_8141,skSess_8060)));
                                            {9747}let Ksrv_8142: bitstring = exp(PartC_8139,Ns_8140) in
                                            {9748}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8142))
                                    )
                                    else
                                        {9749}let v_8143: bool = (Disco_5511 = C) in
                                        (
                                            {9750}if v_8143 then
                                            (
                                                {9751}let pkDisco_8144: bitstring = pub(skC) in
                                                {9752}in(c, (=pkCli_8124,m1_8145: bitstring,sigM1_8146: bitstring));
                                                {9753}if (verify(m1_8145,sigM1_8146,pkCli_8124) <> true) then
                                                    0
                                                else
                                                    {9754}let (=Sess_5512,SPc_8147: bitstring,PartC_8148: bitstring) = m1_8145 in
                                                    {9755}new Ns_8149: bitstring;
                                                    {9756}let m2_8150: bitstring = (Cli_5510,exp(g,Ns_8149)) in
                                                    {9757}out(c, (m2_8150,sign(m2_8150,skSess_8060)));
                                                    {9758}let Ksrv_8151: bitstring = exp(PartC_8148,Ns_8149) in
                                                    {9759}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8151))
                                            )
                                            else
                                                {9760}let pkDisco_8152: bitstring = pub(skI) in
                                                {9761}in(c, (=pkCli_8124,m1_8153: bitstring,sigM1_8154: bitstring));
                                                {9762}if (verify(m1_8153,sigM1_8154,pkCli_8124) <> true) then
                                                    0
                                                else
                                                    {9763}let (=Sess_5512,SPc_8155: bitstring,PartC_8156: bitstring) = m1_8153 in
                                                    {9764}new Ns_8157: bitstring;
                                                    {9765}let m2_8158: bitstring = (Cli_5510,exp(g,Ns_8157)) in
                                                    {9766}out(c, (m2_8158,sign(m2_8158,skSess_8060)));
                                                    {9767}let Ksrv_8159: bitstring = exp(PartC_8156,Ns_8157) in
                                                    {9768}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8159))
                                        )
                                        else
                                            {9769}let pkDisco_8160: bitstring = fail-any in
                                            {9770}in(c, (=pkCli_8124,m1_8161: bitstring,sigM1_8162: bitstring));
                                            {9771}if (verify(m1_8161,sigM1_8162,pkCli_8124) <> true) then
                                                0
                                            else
                                                {9772}let (=Sess_5512,SPc_8163: bitstring,PartC_8164: bitstring) = m1_8161 in
                                                {9773}new Ns_8165: bitstring;
                                                {9774}let m2_8166: bitstring = (Cli_5510,exp(g,Ns_8165)) in
                                                {9775}out(c, (m2_8166,sign(m2_8166,skSess_8060)));
                                                {9776}let Ksrv_8167: bitstring = exp(PartC_8164,Ns_8165) in
                                                {9777}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8167))
                                )
                                else
                                    {9778}let pkDisco_8168: bitstring = fail-any in
                                    {9779}in(c, (=pkCli_8124,m1_8169: bitstring,sigM1_8170: bitstring));
                                    {9780}if (verify(m1_8169,sigM1_8170,pkCli_8124) <> true) then
                                        0
                                    else
                                        {9781}let (=Sess_5512,SPc_8171: bitstring,PartC_8172: bitstring) = m1_8169 in
                                        {9782}new Ns_8173: bitstring;
                                        {9783}let m2_8174: bitstring = (Cli_5510,exp(g,Ns_8173)) in
                                        {9784}out(c, (m2_8174,sign(m2_8174,skSess_8060)));
                                        {9785}let Ksrv_8175: bitstring = exp(PartC_8172,Ns_8173) in
                                        {9786}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8175))
                        )
                        else
                            {9787}let pkDisco_8176: bitstring = fail-any in
                            {9788}in(c, (=pkCli_8124,m1_8177: bitstring,sigM1_8178: bitstring));
                            {9789}if (verify(m1_8177,sigM1_8178,pkCli_8124) <> true) then
                                0
                            else
                                {9790}let (=Sess_5512,SPc_8179: bitstring,PartC_8180: bitstring) = m1_8177 in
                                {9791}new Ns_8181: bitstring;
                                {9792}let m2_8182: bitstring = (Cli_5510,exp(g,Ns_8181)) in
                                {9793}out(c, (m2_8182,sign(m2_8182,skSess_8060)));
                                {9794}let Ksrv_8183: bitstring = exp(PartC_8180,Ns_8181) in
                                {9795}out(c, senc(mSrv(pkCli_8124,pkSess_8061),Ksrv_8183))
                    )
                    else
                        {9796}let v_8184: bool = (Cli_5510 = C) in
                        (
                            {9797}if v_8184 then
                            (
                                {9798}let pkCli_8185: bitstring = pub(skC) in
                                {9799}let v_8186: bool = (Disco_5511 = A) in
                                (
                                    {9800}if v_8186 then
                                    (
                                        {9801}let pkDisco_8187: bitstring = pub(skA) in
                                        {9802}in(c, (=pkCli_8185,m1_8188: bitstring,sigM1_8189: bitstring));
                                        {9803}if (verify(m1_8188,sigM1_8189,pkCli_8185) <> true) then
                                            0
                                        else
                                            {9804}let (=Sess_5512,SPc_8190: bitstring,PartC_8191: bitstring) = m1_8188 in
                                            {9805}new Ns_8192: bitstring;
                                            {9806}let m2_8193: bitstring = (Cli_5510,exp(g,Ns_8192)) in
                                            {9807}out(c, (m2_8193,sign(m2_8193,skSess_8060)));
                                            {9808}let Ksrv_8194: bitstring = exp(PartC_8191,Ns_8192) in
                                            {9809}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8194))
                                    )
                                    else
                                        {9810}let v_8195: bool = (Disco_5511 = B) in
                                        (
                                            {9811}if v_8195 then
                                            (
                                                {9812}let pkDisco_8196: bitstring = pub(skB) in
                                                {9813}in(c, (=pkCli_8185,m1_8197: bitstring,sigM1_8198: bitstring));
                                                {9814}if (verify(m1_8197,sigM1_8198,pkCli_8185) <> true) then
                                                    0
                                                else
                                                    {9815}let (=Sess_5512,SPc_8199: bitstring,PartC_8200: bitstring) = m1_8197 in
                                                    {9816}new Ns_8201: bitstring;
                                                    {9817}let m2_8202: bitstring = (Cli_5510,exp(g,Ns_8201)) in
                                                    {9818}out(c, (m2_8202,sign(m2_8202,skSess_8060)));
                                                    {9819}let Ksrv_8203: bitstring = exp(PartC_8200,Ns_8201) in
                                                    {9820}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8203))
                                            )
                                            else
                                                {9821}let v_8204: bool = (Disco_5511 = C) in
                                                (
                                                    {9822}if v_8204 then
                                                    (
                                                        {9823}let pkDisco_8205: bitstring = pub(skC) in
                                                        {9824}in(c, (=pkCli_8185,m1_8206: bitstring,sigM1_8207: bitstring));
                                                        {9825}if (verify(m1_8206,sigM1_8207,pkCli_8185) <> true) then
                                                            0
                                                        else
                                                            {9826}let (=Sess_5512,SPc_8208: bitstring,PartC_8209: bitstring) = m1_8206 in
                                                            {9827}new Ns_8210: bitstring;
                                                            {9828}let m2_8211: bitstring = (Cli_5510,exp(g,Ns_8210)) in
                                                            {9829}out(c, (m2_8211,sign(m2_8211,skSess_8060)));
                                                            {9830}let Ksrv_8212: bitstring = exp(PartC_8209,Ns_8210) in
                                                            {9831}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8212))
                                                    )
                                                    else
                                                        {9832}let pkDisco_8213: bitstring = pub(skI) in
                                                        {9833}in(c, (=pkCli_8185,m1_8214: bitstring,sigM1_8215: bitstring));
                                                        {9834}if (verify(m1_8214,sigM1_8215,pkCli_8185) <> true) then
                                                            0
                                                        else
                                                            {9835}let (=Sess_5512,SPc_8216: bitstring,PartC_8217: bitstring) = m1_8214 in
                                                            {9836}new Ns_8218: bitstring;
                                                            {9837}let m2_8219: bitstring = (Cli_5510,exp(g,Ns_8218)) in
                                                            {9838}out(c, (m2_8219,sign(m2_8219,skSess_8060)));
                                                            {9839}let Ksrv_8220: bitstring = exp(PartC_8217,Ns_8218) in
                                                            {9840}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8220))
                                                )
                                                else
                                                    {9841}let pkDisco_8221: bitstring = fail-any in
                                                    {9842}in(c, (=pkCli_8185,m1_8222: bitstring,sigM1_8223: bitstring));
                                                    {9843}if (verify(m1_8222,sigM1_8223,pkCli_8185) <> true) then
                                                        0
                                                    else
                                                        {9844}let (=Sess_5512,SPc_8224: bitstring,PartC_8225: bitstring) = m1_8222 in
                                                        {9845}new Ns_8226: bitstring;
                                                        {9846}let m2_8227: bitstring = (Cli_5510,exp(g,Ns_8226)) in
                                                        {9847}out(c, (m2_8227,sign(m2_8227,skSess_8060)));
                                                        {9848}let Ksrv_8228: bitstring = exp(PartC_8225,Ns_8226) in
                                                        {9849}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8228))
                                        )
                                        else
                                            {9850}let pkDisco_8229: bitstring = fail-any in
                                            {9851}in(c, (=pkCli_8185,m1_8230: bitstring,sigM1_8231: bitstring));
                                            {9852}if (verify(m1_8230,sigM1_8231,pkCli_8185) <> true) then
                                                0
                                            else
                                                {9853}let (=Sess_5512,SPc_8232: bitstring,PartC_8233: bitstring) = m1_8230 in
                                                {9854}new Ns_8234: bitstring;
                                                {9855}let m2_8235: bitstring = (Cli_5510,exp(g,Ns_8234)) in
                                                {9856}out(c, (m2_8235,sign(m2_8235,skSess_8060)));
                                                {9857}let Ksrv_8236: bitstring = exp(PartC_8233,Ns_8234) in
                                                {9858}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8236))
                                )
                                else
                                    {9859}let pkDisco_8237: bitstring = fail-any in
                                    {9860}in(c, (=pkCli_8185,m1_8238: bitstring,sigM1_8239: bitstring));
                                    {9861}if (verify(m1_8238,sigM1_8239,pkCli_8185) <> true) then
                                        0
                                    else
                                        {9862}let (=Sess_5512,SPc_8240: bitstring,PartC_8241: bitstring) = m1_8238 in
                                        {9863}new Ns_8242: bitstring;
                                        {9864}let m2_8243: bitstring = (Cli_5510,exp(g,Ns_8242)) in
                                        {9865}out(c, (m2_8243,sign(m2_8243,skSess_8060)));
                                        {9866}let Ksrv_8244: bitstring = exp(PartC_8241,Ns_8242) in
                                        {9867}out(c, senc(mSrv(pkCli_8185,pkSess_8061),Ksrv_8244))
                            )
                            else
                                {9868}let pkCli_8245: bitstring = pub(skI) in
                                {9869}let v_8246: bool = (Disco_5511 = A) in
                                (
                                    {9870}if v_8246 then
                                    (
                                        {9871}let pkDisco_8247: bitstring = pub(skA) in
                                        {9872}in(c, (=pkCli_8245,m1_8248: bitstring,sigM1_8249: bitstring));
                                        {9873}if (verify(m1_8248,sigM1_8249,pkCli_8245) <> true) then
                                            0
                                        else
                                            {9874}let (=Sess_5512,SPc_8250: bitstring,PartC_8251: bitstring) = m1_8248 in
                                            {9875}new Ns_8252: bitstring;
                                            {9876}let m2_8253: bitstring = (Cli_5510,exp(g,Ns_8252)) in
                                            {9877}out(c, (m2_8253,sign(m2_8253,skSess_8060)));
                                            {9878}let Ksrv_8254: bitstring = exp(PartC_8251,Ns_8252) in
                                            {9879}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8254))
                                    )
                                    else
                                        {9880}let v_8255: bool = (Disco_5511 = B) in
                                        (
                                            {9881}if v_8255 then
                                            (
                                                {9882}let pkDisco_8256: bitstring = pub(skB) in
                                                {9883}in(c, (=pkCli_8245,m1_8257: bitstring,sigM1_8258: bitstring));
                                                {9884}if (verify(m1_8257,sigM1_8258,pkCli_8245) <> true) then
                                                    0
                                                else
                                                    {9885}let (=Sess_5512,SPc_8259: bitstring,PartC_8260: bitstring) = m1_8257 in
                                                    {9886}new Ns_8261: bitstring;
                                                    {9887}let m2_8262: bitstring = (Cli_5510,exp(g,Ns_8261)) in
                                                    {9888}out(c, (m2_8262,sign(m2_8262,skSess_8060)));
                                                    {9889}let Ksrv_8263: bitstring = exp(PartC_8260,Ns_8261) in
                                                    {9890}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8263))
                                            )
                                            else
                                                {9891}let v_8264: bool = (Disco_5511 = C) in
                                                (
                                                    {9892}if v_8264 then
                                                    (
                                                        {9893}let pkDisco_8265: bitstring = pub(skC) in
                                                        {9894}in(c, (=pkCli_8245,m1_8266: bitstring,sigM1_8267: bitstring));
                                                        {9895}if (verify(m1_8266,sigM1_8267,pkCli_8245) <> true) then
                                                            0
                                                        else
                                                            {9896}let (=Sess_5512,SPc_8268: bitstring,PartC_8269: bitstring) = m1_8266 in
                                                            {9897}new Ns_8270: bitstring;
                                                            {9898}let m2_8271: bitstring = (Cli_5510,exp(g,Ns_8270)) in
                                                            {9899}out(c, (m2_8271,sign(m2_8271,skSess_8060)));
                                                            {9900}let Ksrv_8272: bitstring = exp(PartC_8269,Ns_8270) in
                                                            {9901}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8272))
                                                    )
                                                    else
                                                        {9902}let pkDisco_8273: bitstring = pub(skI) in
                                                        {9903}in(c, (=pkCli_8245,m1_8274: bitstring,sigM1_8275: bitstring));
                                                        {9904}if (verify(m1_8274,sigM1_8275,pkCli_8245) <> true) then
                                                            0
                                                        else
                                                            {9905}let (=Sess_5512,SPc_8276: bitstring,PartC_8277: bitstring) = m1_8274 in
                                                            {9906}new Ns_8278: bitstring;
                                                            {9907}let m2_8279: bitstring = (Cli_5510,exp(g,Ns_8278)) in
                                                            {9908}out(c, (m2_8279,sign(m2_8279,skSess_8060)));
                                                            {9909}let Ksrv_8280: bitstring = exp(PartC_8277,Ns_8278) in
                                                            {9910}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8280))
                                                )
                                                else
                                                    {9911}let pkDisco_8281: bitstring = fail-any in
                                                    {9912}in(c, (=pkCli_8245,m1_8282: bitstring,sigM1_8283: bitstring));
                                                    {9913}if (verify(m1_8282,sigM1_8283,pkCli_8245) <> true) then
                                                        0
                                                    else
                                                        {9914}let (=Sess_5512,SPc_8284: bitstring,PartC_8285: bitstring) = m1_8282 in
                                                        {9915}new Ns_8286: bitstring;
                                                        {9916}let m2_8287: bitstring = (Cli_5510,exp(g,Ns_8286)) in
                                                        {9917}out(c, (m2_8287,sign(m2_8287,skSess_8060)));
                                                        {9918}let Ksrv_8288: bitstring = exp(PartC_8285,Ns_8286) in
                                                        {9919}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8288))
                                        )
                                        else
                                            {9920}let pkDisco_8289: bitstring = fail-any in
                                            {9921}in(c, (=pkCli_8245,m1_8290: bitstring,sigM1_8291: bitstring));
                                            {9922}if (verify(m1_8290,sigM1_8291,pkCli_8245) <> true) then
                                                0
                                            else
                                                {9923}let (=Sess_5512,SPc_8292: bitstring,PartC_8293: bitstring) = m1_8290 in
                                                {9924}new Ns_8294: bitstring;
                                                {9925}let m2_8295: bitstring = (Cli_5510,exp(g,Ns_8294)) in
                                                {9926}out(c, (m2_8295,sign(m2_8295,skSess_8060)));
                                                {9927}let Ksrv_8296: bitstring = exp(PartC_8293,Ns_8294) in
                                                {9928}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8296))
                                )
                                else
                                    {9929}let pkDisco_8297: bitstring = fail-any in
                                    {9930}in(c, (=pkCli_8245,m1_8298: bitstring,sigM1_8299: bitstring));
                                    {9931}if (verify(m1_8298,sigM1_8299,pkCli_8245) <> true) then
                                        0
                                    else
                                        {9932}let (=Sess_5512,SPc_8300: bitstring,PartC_8301: bitstring) = m1_8298 in
                                        {9933}new Ns_8302: bitstring;
                                        {9934}let m2_8303: bitstring = (Cli_5510,exp(g,Ns_8302)) in
                                        {9935}out(c, (m2_8303,sign(m2_8303,skSess_8060)));
                                        {9936}let Ksrv_8304: bitstring = exp(PartC_8301,Ns_8302) in
                                        {9937}out(c, senc(mSrv(pkCli_8245,pkSess_8061),Ksrv_8304))
                        )
                        else
                            {9938}let pkCli_8305: bitstring = fail-any in
                            {9939}let v_8306: bool = (Disco_5511 = A) in
                            (
                                {9940}if v_8306 then
                                (
                                    {9941}let pkDisco_8307: bitstring = pub(skA) in
                                    {9942}in(c, (=pkCli_8305,m1_8308: bitstring,sigM1_8309: bitstring));
                                    {9943}if (verify(m1_8308,sigM1_8309,pkCli_8305) <> true) then
                                        0
                                    else
                                        {9944}let (=Sess_5512,SPc_8310: bitstring,PartC_8311: bitstring) = m1_8308 in
                                        {9945}new Ns_8312: bitstring;
                                        {9946}let m2_8313: bitstring = (Cli_5510,exp(g,Ns_8312)) in
                                        {9947}out(c, (m2_8313,sign(m2_8313,skSess_8060)));
                                        {9948}let Ksrv_8314: bitstring = exp(PartC_8311,Ns_8312) in
                                        {9949}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8314))
                                )
                                else
                                    {9950}let v_8315: bool = (Disco_5511 = B) in
                                    (
                                        {9951}if v_8315 then
                                        (
                                            {9952}let pkDisco_8316: bitstring = pub(skB) in
                                            {9953}in(c, (=pkCli_8305,m1_8317: bitstring,sigM1_8318: bitstring));
                                            {9954}if (verify(m1_8317,sigM1_8318,pkCli_8305) <> true) then
                                                0
                                            else
                                                {9955}let (=Sess_5512,SPc_8319: bitstring,PartC_8320: bitstring) = m1_8317 in
                                                {9956}new Ns_8321: bitstring;
                                                {9957}let m2_8322: bitstring = (Cli_5510,exp(g,Ns_8321)) in
                                                {9958}out(c, (m2_8322,sign(m2_8322,skSess_8060)));
                                                {9959}let Ksrv_8323: bitstring = exp(PartC_8320,Ns_8321) in
                                                {9960}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8323))
                                        )
                                        else
                                            {9961}let v_8324: bool = (Disco_5511 = C) in
                                            (
                                                {9962}if v_8324 then
                                                (
                                                    {9963}let pkDisco_8325: bitstring = pub(skC) in
                                                    {9964}in(c, (=pkCli_8305,m1_8326: bitstring,sigM1_8327: bitstring));
                                                    {9965}if (verify(m1_8326,sigM1_8327,pkCli_8305) <> true) then
                                                        0
                                                    else
                                                        {9966}let (=Sess_5512,SPc_8328: bitstring,PartC_8329: bitstring) = m1_8326 in
                                                        {9967}new Ns_8330: bitstring;
                                                        {9968}let m2_8331: bitstring = (Cli_5510,exp(g,Ns_8330)) in
                                                        {9969}out(c, (m2_8331,sign(m2_8331,skSess_8060)));
                                                        {9970}let Ksrv_8332: bitstring = exp(PartC_8329,Ns_8330) in
                                                        {9971}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8332))
                                                )
                                                else
                                                    {9972}let pkDisco_8333: bitstring = pub(skI) in
                                                    {9973}in(c, (=pkCli_8305,m1_8334: bitstring,sigM1_8335: bitstring));
                                                    {9974}if (verify(m1_8334,sigM1_8335,pkCli_8305) <> true) then
                                                        0
                                                    else
                                                        {9975}let (=Sess_5512,SPc_8336: bitstring,PartC_8337: bitstring) = m1_8334 in
                                                        {9976}new Ns_8338: bitstring;
                                                        {9977}let m2_8339: bitstring = (Cli_5510,exp(g,Ns_8338)) in
                                                        {9978}out(c, (m2_8339,sign(m2_8339,skSess_8060)));
                                                        {9979}let Ksrv_8340: bitstring = exp(PartC_8337,Ns_8338) in
                                                        {9980}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8340))
                                            )
                                            else
                                                {9981}let pkDisco_8341: bitstring = fail-any in
                                                {9982}in(c, (=pkCli_8305,m1_8342: bitstring,sigM1_8343: bitstring));
                                                {9983}if (verify(m1_8342,sigM1_8343,pkCli_8305) <> true) then
                                                    0
                                                else
                                                    {9984}let (=Sess_5512,SPc_8344: bitstring,PartC_8345: bitstring) = m1_8342 in
                                                    {9985}new Ns_8346: bitstring;
                                                    {9986}let m2_8347: bitstring = (Cli_5510,exp(g,Ns_8346)) in
                                                    {9987}out(c, (m2_8347,sign(m2_8347,skSess_8060)));
                                                    {9988}let Ksrv_8348: bitstring = exp(PartC_8345,Ns_8346) in
                                                    {9989}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8348))
                                    )
                                    else
                                        {9990}let pkDisco_8349: bitstring = fail-any in
                                        {9991}in(c, (=pkCli_8305,m1_8350: bitstring,sigM1_8351: bitstring));
                                        {9992}if (verify(m1_8350,sigM1_8351,pkCli_8305) <> true) then
                                            0
                                        else
                                            {9993}let (=Sess_5512,SPc_8352: bitstring,PartC_8353: bitstring) = m1_8350 in
                                            {9994}new Ns_8354: bitstring;
                                            {9995}let m2_8355: bitstring = (Cli_5510,exp(g,Ns_8354)) in
                                            {9996}out(c, (m2_8355,sign(m2_8355,skSess_8060)));
                                            {9997}let Ksrv_8356: bitstring = exp(PartC_8353,Ns_8354) in
                                            {9998}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8356))
                            )
                            else
                                {9999}let pkDisco_8357: bitstring = fail-any in
                                {10000}in(c, (=pkCli_8305,m1_8358: bitstring,sigM1_8359: bitstring));
                                {10001}if (verify(m1_8358,sigM1_8359,pkCli_8305) <> true) then
                                    0
                                else
                                    {10002}let (=Sess_5512,SPc_8360: bitstring,PartC_8361: bitstring) = m1_8358 in
                                    {10003}new Ns_8362: bitstring;
                                    {10004}let m2_8363: bitstring = (Cli_5510,exp(g,Ns_8362)) in
                                    {10005}out(c, (m2_8363,sign(m2_8363,skSess_8060)));
                                    {10006}let Ksrv_8364: bitstring = exp(PartC_8361,Ns_8362) in
                                    {10007}out(c, senc(mSrv(pkCli_8305,pkSess_8061),Ksrv_8364))
                )
                else
                    {10008}let pkCli_8365: bitstring = fail-any in
                    {10009}let v_8366: bool = (Disco_5511 = A) in
                    (
                        {10010}if v_8366 then
                        (
                            {10011}let pkDisco_8367: bitstring = pub(skA) in
                            {10012}in(c, (=pkCli_8365,m1_8368: bitstring,sigM1_8369: bitstring));
                            {10013}if (verify(m1_8368,sigM1_8369,pkCli_8365) <> true) then
                                0
                            else
                                {10014}let (=Sess_5512,SPc_8370: bitstring,PartC_8371: bitstring) = m1_8368 in
                                {10015}new Ns_8372: bitstring;
                                {10016}let m2_8373: bitstring = (Cli_5510,exp(g,Ns_8372)) in
                                {10017}out(c, (m2_8373,sign(m2_8373,skSess_8060)));
                                {10018}let Ksrv_8374: bitstring = exp(PartC_8371,Ns_8372) in
                                {10019}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8374))
                        )
                        else
                            {10020}let v_8375: bool = (Disco_5511 = B) in
                            (
                                {10021}if v_8375 then
                                (
                                    {10022}let pkDisco_8376: bitstring = pub(skB) in
                                    {10023}in(c, (=pkCli_8365,m1_8377: bitstring,sigM1_8378: bitstring));
                                    {10024}if (verify(m1_8377,sigM1_8378,pkCli_8365) <> true) then
                                        0
                                    else
                                        {10025}let (=Sess_5512,SPc_8379: bitstring,PartC_8380: bitstring) = m1_8377 in
                                        {10026}new Ns_8381: bitstring;
                                        {10027}let m2_8382: bitstring = (Cli_5510,exp(g,Ns_8381)) in
                                        {10028}out(c, (m2_8382,sign(m2_8382,skSess_8060)));
                                        {10029}let Ksrv_8383: bitstring = exp(PartC_8380,Ns_8381) in
                                        {10030}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8383))
                                )
                                else
                                    {10031}let v_8384: bool = (Disco_5511 = C) in
                                    (
                                        {10032}if v_8384 then
                                        (
                                            {10033}let pkDisco_8385: bitstring = pub(skC) in
                                            {10034}in(c, (=pkCli_8365,m1_8386: bitstring,sigM1_8387: bitstring));
                                            {10035}if (verify(m1_8386,sigM1_8387,pkCli_8365) <> true) then
                                                0
                                            else
                                                {10036}let (=Sess_5512,SPc_8388: bitstring,PartC_8389: bitstring) = m1_8386 in
                                                {10037}new Ns_8390: bitstring;
                                                {10038}let m2_8391: bitstring = (Cli_5510,exp(g,Ns_8390)) in
                                                {10039}out(c, (m2_8391,sign(m2_8391,skSess_8060)));
                                                {10040}let Ksrv_8392: bitstring = exp(PartC_8389,Ns_8390) in
                                                {10041}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8392))
                                        )
                                        else
                                            {10042}let pkDisco_8393: bitstring = pub(skI) in
                                            {10043}in(c, (=pkCli_8365,m1_8394: bitstring,sigM1_8395: bitstring));
                                            {10044}if (verify(m1_8394,sigM1_8395,pkCli_8365) <> true) then
                                                0
                                            else
                                                {10045}let (=Sess_5512,SPc_8396: bitstring,PartC_8397: bitstring) = m1_8394 in
                                                {10046}new Ns_8398: bitstring;
                                                {10047}let m2_8399: bitstring = (Cli_5510,exp(g,Ns_8398)) in
                                                {10048}out(c, (m2_8399,sign(m2_8399,skSess_8060)));
                                                {10049}let Ksrv_8400: bitstring = exp(PartC_8397,Ns_8398) in
                                                {10050}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8400))
                                    )
                                    else
                                        {10051}let pkDisco_8401: bitstring = fail-any in
                                        {10052}in(c, (=pkCli_8365,m1_8402: bitstring,sigM1_8403: bitstring));
                                        {10053}if (verify(m1_8402,sigM1_8403,pkCli_8365) <> true) then
                                            0
                                        else
                                            {10054}let (=Sess_5512,SPc_8404: bitstring,PartC_8405: bitstring) = m1_8402 in
                                            {10055}new Ns_8406: bitstring;
                                            {10056}let m2_8407: bitstring = (Cli_5510,exp(g,Ns_8406)) in
                                            {10057}out(c, (m2_8407,sign(m2_8407,skSess_8060)));
                                            {10058}let Ksrv_8408: bitstring = exp(PartC_8405,Ns_8406) in
                                            {10059}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8408))
                            )
                            else
                                {10060}let pkDisco_8409: bitstring = fail-any in
                                {10061}in(c, (=pkCli_8365,m1_8410: bitstring,sigM1_8411: bitstring));
                                {10062}if (verify(m1_8410,sigM1_8411,pkCli_8365) <> true) then
                                    0
                                else
                                    {10063}let (=Sess_5512,SPc_8412: bitstring,PartC_8413: bitstring) = m1_8410 in
                                    {10064}new Ns_8414: bitstring;
                                    {10065}let m2_8415: bitstring = (Cli_5510,exp(g,Ns_8414)) in
                                    {10066}out(c, (m2_8415,sign(m2_8415,skSess_8060)));
                                    {10067}let Ksrv_8416: bitstring = exp(PartC_8413,Ns_8414) in
                                    {10068}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8416))
                    )
                    else
                        {10069}let pkDisco_8417: bitstring = fail-any in
                        {10070}in(c, (=pkCli_8365,m1_8418: bitstring,sigM1_8419: bitstring));
                        {10071}if (verify(m1_8418,sigM1_8419,pkCli_8365) <> true) then
                            0
                        else
                            {10072}let (=Sess_5512,SPc_8420: bitstring,PartC_8421: bitstring) = m1_8418 in
                            {10073}new Ns_8422: bitstring;
                            {10074}let m2_8423: bitstring = (Cli_5510,exp(g,Ns_8422)) in
                            {10075}out(c, (m2_8423,sign(m2_8423,skSess_8060)));
                            {10076}let Ksrv_8424: bitstring = exp(PartC_8421,Ns_8422) in
                            {10077}out(c, senc(mSrv(pkCli_8365,pkSess_8061),Ksrv_8424))
        )
        else
            {10078}let pkCli_8425: bitstring = fail-any in
            {10079}let v_8426: bool = (Disco_5511 = A) in
            (
                {10080}if v_8426 then
                (
                    {10081}let pkDisco_8427: bitstring = pub(skA) in
                    {10082}in(c, (=pkCli_8425,m1_8428: bitstring,sigM1_8429: bitstring));
                    {10083}if (verify(m1_8428,sigM1_8429,pkCli_8425) <> true) then
                        0
                    else
                        {10084}let (=Sess_5512,SPc_8430: bitstring,PartC_8431: bitstring) = m1_8428 in
                        {10085}new Ns_8432: bitstring;
                        {10086}let m2_8433: bitstring = (Cli_5510,exp(g,Ns_8432)) in
                        {10087}out(c, (m2_8433,sign(m2_8433,skSess_8060)));
                        {10088}let Ksrv_8434: bitstring = exp(PartC_8431,Ns_8432) in
                        {10089}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8434))
                )
                else
                    {10090}let v_8435: bool = (Disco_5511 = B) in
                    (
                        {10091}if v_8435 then
                        (
                            {10092}let pkDisco_8436: bitstring = pub(skB) in
                            {10093}in(c, (=pkCli_8425,m1_8437: bitstring,sigM1_8438: bitstring));
                            {10094}if (verify(m1_8437,sigM1_8438,pkCli_8425) <> true) then
                                0
                            else
                                {10095}let (=Sess_5512,SPc_8439: bitstring,PartC_8440: bitstring) = m1_8437 in
                                {10096}new Ns_8441: bitstring;
                                {10097}let m2_8442: bitstring = (Cli_5510,exp(g,Ns_8441)) in
                                {10098}out(c, (m2_8442,sign(m2_8442,skSess_8060)));
                                {10099}let Ksrv_8443: bitstring = exp(PartC_8440,Ns_8441) in
                                {10100}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8443))
                        )
                        else
                            {10101}let v_8444: bool = (Disco_5511 = C) in
                            (
                                {10102}if v_8444 then
                                (
                                    {10103}let pkDisco_8445: bitstring = pub(skC) in
                                    {10104}in(c, (=pkCli_8425,m1_8446: bitstring,sigM1_8447: bitstring));
                                    {10105}if (verify(m1_8446,sigM1_8447,pkCli_8425) <> true) then
                                        0
                                    else
                                        {10106}let (=Sess_5512,SPc_8448: bitstring,PartC_8449: bitstring) = m1_8446 in
                                        {10107}new Ns_8450: bitstring;
                                        {10108}let m2_8451: bitstring = (Cli_5510,exp(g,Ns_8450)) in
                                        {10109}out(c, (m2_8451,sign(m2_8451,skSess_8060)));
                                        {10110}let Ksrv_8452: bitstring = exp(PartC_8449,Ns_8450) in
                                        {10111}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8452))
                                )
                                else
                                    {10112}let pkDisco_8453: bitstring = pub(skI) in
                                    {10113}in(c, (=pkCli_8425,m1_8454: bitstring,sigM1_8455: bitstring));
                                    {10114}if (verify(m1_8454,sigM1_8455,pkCli_8425) <> true) then
                                        0
                                    else
                                        {10115}let (=Sess_5512,SPc_8456: bitstring,PartC_8457: bitstring) = m1_8454 in
                                        {10116}new Ns_8458: bitstring;
                                        {10117}let m2_8459: bitstring = (Cli_5510,exp(g,Ns_8458)) in
                                        {10118}out(c, (m2_8459,sign(m2_8459,skSess_8060)));
                                        {10119}let Ksrv_8460: bitstring = exp(PartC_8457,Ns_8458) in
                                        {10120}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8460))
                            )
                            else
                                {10121}let pkDisco_8461: bitstring = fail-any in
                                {10122}in(c, (=pkCli_8425,m1_8462: bitstring,sigM1_8463: bitstring));
                                {10123}if (verify(m1_8462,sigM1_8463,pkCli_8425) <> true) then
                                    0
                                else
                                    {10124}let (=Sess_5512,SPc_8464: bitstring,PartC_8465: bitstring) = m1_8462 in
                                    {10125}new Ns_8466: bitstring;
                                    {10126}let m2_8467: bitstring = (Cli_5510,exp(g,Ns_8466)) in
                                    {10127}out(c, (m2_8467,sign(m2_8467,skSess_8060)));
                                    {10128}let Ksrv_8468: bitstring = exp(PartC_8465,Ns_8466) in
                                    {10129}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8468))
                    )
                    else
                        {10130}let pkDisco_8469: bitstring = fail-any in
                        {10131}in(c, (=pkCli_8425,m1_8470: bitstring,sigM1_8471: bitstring));
                        {10132}if (verify(m1_8470,sigM1_8471,pkCli_8425) <> true) then
                            0
                        else
                            {10133}let (=Sess_5512,SPc_8472: bitstring,PartC_8473: bitstring) = m1_8470 in
                            {10134}new Ns_8474: bitstring;
                            {10135}let m2_8475: bitstring = (Cli_5510,exp(g,Ns_8474)) in
                            {10136}out(c, (m2_8475,sign(m2_8475,skSess_8060)));
                            {10137}let Ksrv_8476: bitstring = exp(PartC_8473,Ns_8474) in
                            {10138}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8476))
            )
            else
                {10139}let pkDisco_8477: bitstring = fail-any in
                {10140}in(c, (=pkCli_8425,m1_8478: bitstring,sigM1_8479: bitstring));
                {10141}if (verify(m1_8478,sigM1_8479,pkCli_8425) <> true) then
                    0
                else
                    {10142}let (=Sess_5512,SPc_8480: bitstring,PartC_8481: bitstring) = m1_8478 in
                    {10143}new Ns_8482: bitstring;
                    {10144}let m2_8483: bitstring = (Cli_5510,exp(g,Ns_8482)) in
                    {10145}out(c, (m2_8483,sign(m2_8483,skSess_8060)));
                    {10146}let Ksrv_8484: bitstring = exp(PartC_8481,Ns_8482) in
                    {10147}out(c, senc(mSrv(pkCli_8425,pkSess_8061),Ksrv_8484))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 140 rules. 645 rules in the queue.
400 rules inserted. The rule base contains 201 rules. 645 rules in the queue.
600 rules inserted. The rule base contains 372 rules. 642 rules in the queue.
800 rules inserted. The rule base contains 513 rules. 642 rules in the queue.
1000 rules inserted. The rule base contains 585 rules. 642 rules in the queue.
1200 rules inserted. The rule base contains 587 rules. 639 rules in the queue.
1400 rules inserted. The rule base contains 584 rules. 638 rules in the queue.
1600 rules inserted. The rule base contains 599 rules. 634 rules in the queue.
1800 rules inserted. The rule base contains 703 rules. 540 rules in the queue.
2000 rules inserted. The rule base contains 807 rules. 466 rules in the queue.
2200 rules inserted. The rule base contains 871 rules. 548 rules in the queue.
2400 rules inserted. The rule base contains 955 rules. 492 rules in the queue.
2600 rules inserted. The rule base contains 1086 rules. 923 rules in the queue.
2800 rules inserted. The rule base contains 1206 rules. 1077 rules in the queue.
3000 rules inserted. The rule base contains 1309 rules. 2177 rules in the queue.
3200 rules inserted. The rule base contains 1475 rules. 2177 rules in the queue.
3400 rules inserted. The rule base contains 1653 rules. 2177 rules in the queue.
3600 rules inserted. The rule base contains 1833 rules. 2224 rules in the queue.
3800 rules inserted. The rule base contains 2007 rules. 2165 rules in the queue.
4000 rules inserted. The rule base contains 2092 rules. 2489 rules in the queue.
4200 rules inserted. The rule base contains 2146 rules. 2574 rules in the queue.
4400 rules inserted. The rule base contains 2244 rules. 2617 rules in the queue.
4600 rules inserted. The rule base contains 2304 rules. 2837 rules in the queue.
4800 rules inserted. The rule base contains 2383 rules. 2759 rules in the queue.
5000 rules inserted. The rule base contains 2454 rules. 2690 rules in the queue.
5200 rules inserted. The rule base contains 2543 rules. 2597 rules in the queue.
5400 rules inserted. The rule base contains 2701 rules. 2616 rules in the queue.
5600 rules inserted. The rule base contains 2829 rules. 2778 rules in the queue.
5800 rules inserted. The rule base contains 2987 rules. 2813 rules in the queue.
6000 rules inserted. The rule base contains 3071 rules. 3381 rules in the queue.
6200 rules inserted. The rule base contains 3164 rules. 3299 rules in the queue.
6400 rules inserted. The rule base contains 3214 rules. 3242 rules in the queue.
6600 rules inserted. The rule base contains 3309 rules. 3155 rules in the queue.
6800 rules inserted. The rule base contains 3402 rules. 3063 rules in the queue.
7000 rules inserted. The rule base contains 3484 rules. 2989 rules in the queue.
7200 rules inserted. The rule base contains 3547 rules. 2927 rules in the queue.
7400 rules inserted. The rule base contains 3643 rules. 2835 rules in the queue.
7600 rules inserted. The rule base contains 3740 rules. 2750 rules in the queue.
7800 rules inserted. The rule base contains 3833 rules. 2661 rules in the queue.
8000 rules inserted. The rule base contains 3914 rules. 2694 rules in the queue.
8200 rules inserted. The rule base contains 3967 rules. 2755 rules in the queue.
8400 rules inserted. The rule base contains 3991 rules. 2958 rules in the queue.
8600 rules inserted. The rule base contains 4055 rules. 3008 rules in the queue.
8800 rules inserted. The rule base contains 4095 rules. 3082 rules in the queue.
9000 rules inserted. The rule base contains 4159 rules. 3023 rules in the queue.
9200 rules inserted. The rule base contains 4257 rules. 2930 rules in the queue.
9400 rules inserted. The rule base contains 4337 rules. 2852 rules in the queue.
9600 rules inserted. The rule base contains 4424 rules. 2771 rules in the queue.
9800 rules inserted. The rule base contains 4520 rules. 2682 rules in the queue.
10000 rules inserted. The rule base contains 4616 rules. 2593 rules in the queue.
10200 rules inserted. The rule base contains 4720 rules. 2505 rules in the queue.
10400 rules inserted. The rule base contains 4805 rules. 2420 rules in the queue.
10600 rules inserted. The rule base contains 4855 rules. 2369 rules in the queue.
10800 rules inserted. The rule base contains 4936 rules. 2289 rules in the queue.
11000 rules inserted. The rule base contains 4993 rules. 2218 rules in the queue.
11200 rules inserted. The rule base contains 5081 rules. 2134 rules in the queue.
11400 rules inserted. The rule base contains 5137 rules. 2063 rules in the queue.
11600 rules inserted. The rule base contains 5217 rules. 1984 rules in the queue.
11800 rules inserted. The rule base contains 5281 rules. 1922 rules in the queue.
12000 rules inserted. The rule base contains 5357 rules. 1834 rules in the queue.
12200 rules inserted. The rule base contains 5446 rules. 1745 rules in the queue.
12400 rules inserted. The rule base contains 5522 rules. 1661 rules in the queue.
12600 rules inserted. The rule base contains 5561 rules. 1598 rules in the queue.
12800 rules inserted. The rule base contains 5603 rules. 1532 rules in the queue.
13000 rules inserted. The rule base contains 5666 rules. 1461 rules in the queue.
13200 rules inserted. The rule base contains 5737 rules. 1390 rules in the queue.
13400 rules inserted. The rule base contains 5817 rules. 1301 rules in the queue.
13600 rules inserted. The rule base contains 5889 rules. 1230 rules in the queue.
13800 rules inserted. The rule base contains 5966 rules. 1143 rules in the queue.
14000 rules inserted. The rule base contains 6026 rules. 1062 rules in the queue.
14200 rules inserted. The rule base contains 6048 rules. 1007 rules in the queue.
14400 rules inserted. The rule base contains 6121 rules. 1190 rules in the queue.
14600 rules inserted. The rule base contains 6196 rules. 1383 rules in the queue.
14800 rules inserted. The rule base contains 6272 rules. 1846 rules in the queue.
15000 rules inserted. The rule base contains 6339 rules. 2315 rules in the queue.
15200 rules inserted. The rule base contains 6413 rules. 2233 rules in the queue.
15400 rules inserted. The rule base contains 6501 rules. 2136 rules in the queue.
15600 rules inserted. The rule base contains 6584 rules. 2594 rules in the queue.
15800 rules inserted. The rule base contains 6663 rules. 3055 rules in the queue.
16000 rules inserted. The rule base contains 6742 rules. 3382 rules in the queue.
16200 rules inserted. The rule base contains 6808 rules. 3453 rules in the queue.
16400 rules inserted. The rule base contains 6889 rules. 3776 rules in the queue.
16600 rules inserted. The rule base contains 6981 rules. 3822 rules in the queue.
16800 rules inserted. The rule base contains 7061 rules. 4550 rules in the queue.
17000 rules inserted. The rule base contains 7142 rules. 4740 rules in the queue.
17200 rules inserted. The rule base contains 7207 rules. 4677 rules in the queue.
17400 rules inserted. The rule base contains 7305 rules. 4572 rules in the queue.
17600 rules inserted. The rule base contains 7374 rules. 4515 rules in the queue.
17800 rules inserted. The rule base contains 7468 rules. 4422 rules in the queue.
18000 rules inserted. The rule base contains 7542 rules. 4347 rules in the queue.
18200 rules inserted. The rule base contains 7632 rules. 4530 rules in the queue.
18400 rules inserted. The rule base contains 7694 rules. 4738 rules in the queue.
18600 rules inserted. The rule base contains 7791 rules. 4640 rules in the queue.
18800 rules inserted. The rule base contains 7860 rules. 4572 rules in the queue.
19000 rules inserted. The rule base contains 7939 rules. 4627 rules in the queue.
19200 rules inserted. The rule base contains 8035 rules. 4668 rules in the queue.
19400 rules inserted. The rule base contains 8108 rules. 4595 rules in the queue.
19600 rules inserted. The rule base contains 8193 rules. 4511 rules in the queue.
19800 rules inserted. The rule base contains 8279 rules. 4558 rules in the queue.
20000 rules inserted. The rule base contains 8352 rules. 4621 rules in the queue.
20200 rules inserted. The rule base contains 8440 rules. 4534 rules in the queue.
20400 rules inserted. The rule base contains 8518 rules. 4457 rules in the queue.
20600 rules inserted. The rule base contains 8594 rules. 4651 rules in the queue.
20800 rules inserted. The rule base contains 8672 rules. 4842 rules in the queue.
21000 rules inserted. The rule base contains 8762 rules. 4754 rules in the queue.
21200 rules inserted. The rule base contains 8820 rules. 4696 rules in the queue.
21400 rules inserted. The rule base contains 8919 rules. 4598 rules in the queue.
21600 rules inserted. The rule base contains 9003 rules. 4513 rules in the queue.
21800 rules inserted. The rule base contains 9079 rules. 4438 rules in the queue.
22000 rules inserted. The rule base contains 9207 rules. 4358 rules in the queue.
22200 rules inserted. The rule base contains 9304 rules. 4273 rules in the queue.
22400 rules inserted. The rule base contains 9382 rules. 4191 rules in the queue.
22600 rules inserted. The rule base contains 9462 rules. 4112 rules in the queue.
22800 rules inserted. The rule base contains 9551 rules. 4022 rules in the queue.
23000 rules inserted. The rule base contains 9616 rules. 3958 rules in the queue.
23200 rules inserted. The rule base contains 9725 rules. 3848 rules in the queue.
23400 rules inserted. The rule base contains 9809 rules. 3760 rules in the queue.
23600 rules inserted. The rule base contains 9881 rules. 3685 rules in the queue.
23800 rules inserted. The rule base contains 9968 rules. 3599 rules in the queue.
24000 rules inserted. The rule base contains 10060 rules. 3501 rules in the queue.
24200 rules inserted. The rule base contains 10128 rules. 3429 rules in the queue.
24400 rules inserted. The rule base contains 10218 rules. 3340 rules in the queue.
24600 rules inserted. The rule base contains 10309 rules. 3248 rules in the queue.
24800 rules inserted. The rule base contains 10395 rules. 3158 rules in the queue.
25000 rules inserted. The rule base contains 10479 rules. 3071 rules in the queue.
25200 rules inserted. The rule base contains 10556 rules. 2995 rules in the queue.
25400 rules inserted. The rule base contains 10636 rules. 2913 rules in the queue.
25600 rules inserted. The rule base contains 10714 rules. 2837 rules in the queue.
25800 rules inserted. The rule base contains 10811 rules. 2738 rules in the queue.
26000 rules inserted. The rule base contains 10904 rules. 2637 rules in the queue.
26200 rules inserted. The rule base contains 10995 rules. 2546 rules in the queue.
26400 rules inserted. The rule base contains 11128 rules. 2459 rules in the queue.
26600 rules inserted. The rule base contains 11212 rules. 2363 rules in the queue.
26800 rules inserted. The rule base contains 11311 rules. 2260 rules in the queue.
27000 rules inserted. The rule base contains 11395 rules. 2172 rules in the queue.
27200 rules inserted. The rule base contains 11470 rules. 2085 rules in the queue.
27400 rules inserted. The rule base contains 11567 rules. 1984 rules in the queue.
27600 rules inserted. The rule base contains 11643 rules. 1896 rules in the queue.
27800 rules inserted. The rule base contains 11739 rules. 1796 rules in the queue.
28000 rules inserted. The rule base contains 11817 rules. 1706 rules in the queue.
28200 rules inserted. The rule base contains 11914 rules. 1605 rules in the queue.
28400 rules inserted. The rule base contains 11998 rules. 1517 rules in the queue.
28600 rules inserted. The rule base contains 12093 rules. 1406 rules in the queue.
28800 rules inserted. The rule base contains 12175 rules. 1318 rules in the queue.
29000 rules inserted. The rule base contains 12292 rules. 1207 rules in the queue.
29200 rules inserted. The rule base contains 12366 rules. 1121 rules in the queue.
29400 rules inserted. The rule base contains 12448 rules. 1031 rules in the queue.
29600 rules inserted. The rule base contains 12532 rules. 939 rules in the queue.
29800 rules inserted. The rule base contains 12615 rules. 848 rules in the queue.
30000 rules inserted. The rule base contains 12690 rules. 765 rules in the queue.
30200 rules inserted. The rule base contains 12801 rules. 654 rules in the queue.
30400 rules inserted. The rule base contains 12899 rules. 556 rules in the queue.
30600 rules inserted. The rule base contains 13007 rules. 448 rules in the queue.
30800 rules inserted. The rule base contains 13112 rules. 343 rules in the queue.
31000 rules inserted. The rule base contains 13265 rules. 190 rules in the queue.
31200 rules inserted. The rule base contains 13435 rules. 20 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is true.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 140 rules. 645 rules in the queue.
400 rules inserted. The rule base contains 201 rules. 645 rules in the queue.
600 rules inserted. The rule base contains 372 rules. 642 rules in the queue.
800 rules inserted. The rule base contains 513 rules. 642 rules in the queue.
1000 rules inserted. The rule base contains 585 rules. 642 rules in the queue.
1200 rules inserted. The rule base contains 587 rules. 639 rules in the queue.
1400 rules inserted. The rule base contains 584 rules. 638 rules in the queue.
1600 rules inserted. The rule base contains 599 rules. 634 rules in the queue.
1800 rules inserted. The rule base contains 703 rules. 540 rules in the queue.
2000 rules inserted. The rule base contains 807 rules. 466 rules in the queue.
2200 rules inserted. The rule base contains 871 rules. 548 rules in the queue.
2400 rules inserted. The rule base contains 955 rules. 492 rules in the queue.
2600 rules inserted. The rule base contains 1086 rules. 923 rules in the queue.
2800 rules inserted. The rule base contains 1206 rules. 1077 rules in the queue.
3000 rules inserted. The rule base contains 1309 rules. 2177 rules in the queue.
3200 rules inserted. The rule base contains 1475 rules. 2177 rules in the queue.
3400 rules inserted. The rule base contains 1653 rules. 2177 rules in the queue.
3600 rules inserted. The rule base contains 1833 rules. 2224 rules in the queue.
3800 rules inserted. The rule base contains 2007 rules. 2165 rules in the queue.
4000 rules inserted. The rule base contains 2092 rules. 2489 rules in the queue.
4200 rules inserted. The rule base contains 2146 rules. 2574 rules in the queue.
4400 rules inserted. The rule base contains 2244 rules. 2617 rules in the queue.
4600 rules inserted. The rule base contains 2304 rules. 2837 rules in the queue.
4800 rules inserted. The rule base contains 2383 rules. 2759 rules in the queue.
5000 rules inserted. The rule base contains 2454 rules. 2690 rules in the queue.
5200 rules inserted. The rule base contains 2543 rules. 2597 rules in the queue.
5400 rules inserted. The rule base contains 2701 rules. 2616 rules in the queue.
5600 rules inserted. The rule base contains 2829 rules. 2778 rules in the queue.
5800 rules inserted. The rule base contains 2987 rules. 2813 rules in the queue.
6000 rules inserted. The rule base contains 3071 rules. 3381 rules in the queue.
6200 rules inserted. The rule base contains 3164 rules. 3299 rules in the queue.
6400 rules inserted. The rule base contains 3214 rules. 3242 rules in the queue.
6600 rules inserted. The rule base contains 3309 rules. 3155 rules in the queue.
6800 rules inserted. The rule base contains 3402 rules. 3063 rules in the queue.
7000 rules inserted. The rule base contains 3484 rules. 2989 rules in the queue.
7200 rules inserted. The rule base contains 3547 rules. 2927 rules in the queue.
7400 rules inserted. The rule base contains 3643 rules. 2835 rules in the queue.
7600 rules inserted. The rule base contains 3740 rules. 2750 rules in the queue.
7800 rules inserted. The rule base contains 3833 rules. 2661 rules in the queue.
8000 rules inserted. The rule base contains 3914 rules. 2694 rules in the queue.
8200 rules inserted. The rule base contains 3967 rules. 2755 rules in the queue.
8400 rules inserted. The rule base contains 3991 rules. 2958 rules in the queue.
8600 rules inserted. The rule base contains 4055 rules. 3008 rules in the queue.
8800 rules inserted. The rule base contains 4095 rules. 3082 rules in the queue.
9000 rules inserted. The rule base contains 4159 rules. 3023 rules in the queue.
9200 rules inserted. The rule base contains 4257 rules. 2930 rules in the queue.
9400 rules inserted. The rule base contains 4337 rules. 2852 rules in the queue.
9600 rules inserted. The rule base contains 4424 rules. 2771 rules in the queue.
9800 rules inserted. The rule base contains 4520 rules. 2682 rules in the queue.
10000 rules inserted. The rule base contains 4616 rules. 2593 rules in the queue.
10200 rules inserted. The rule base contains 4720 rules. 2505 rules in the queue.
10400 rules inserted. The rule base contains 4805 rules. 2420 rules in the queue.
10600 rules inserted. The rule base contains 4855 rules. 2369 rules in the queue.
10800 rules inserted. The rule base contains 4936 rules. 2289 rules in the queue.
11000 rules inserted. The rule base contains 4993 rules. 2218 rules in the queue.
11200 rules inserted. The rule base contains 5081 rules. 2134 rules in the queue.
11400 rules inserted. The rule base contains 5137 rules. 2063 rules in the queue.
11600 rules inserted. The rule base contains 5217 rules. 1984 rules in the queue.
11800 rules inserted. The rule base contains 5281 rules. 1922 rules in the queue.
12000 rules inserted. The rule base contains 5357 rules. 1834 rules in the queue.
12200 rules inserted. The rule base contains 5446 rules. 1745 rules in the queue.
12400 rules inserted. The rule base contains 5522 rules. 1661 rules in the queue.
12600 rules inserted. The rule base contains 5561 rules. 1598 rules in the queue.
12800 rules inserted. The rule base contains 5603 rules. 1532 rules in the queue.
13000 rules inserted. The rule base contains 5666 rules. 1461 rules in the queue.
13200 rules inserted. The rule base contains 5737 rules. 1390 rules in the queue.
13400 rules inserted. The rule base contains 5817 rules. 1301 rules in the queue.
13600 rules inserted. The rule base contains 5889 rules. 1230 rules in the queue.
13800 rules inserted. The rule base contains 5966 rules. 1143 rules in the queue.
14000 rules inserted. The rule base contains 6026 rules. 1062 rules in the queue.
14200 rules inserted. The rule base contains 6048 rules. 1007 rules in the queue.
14400 rules inserted. The rule base contains 6121 rules. 1190 rules in the queue.
14600 rules inserted. The rule base contains 6196 rules. 1383 rules in the queue.
14800 rules inserted. The rule base contains 6272 rules. 1846 rules in the queue.
15000 rules inserted. The rule base contains 6339 rules. 2315 rules in the queue.
15200 rules inserted. The rule base contains 6413 rules. 2233 rules in the queue.
15400 rules inserted. The rule base contains 6501 rules. 2136 rules in the queue.
15600 rules inserted. The rule base contains 6584 rules. 2594 rules in the queue.
15800 rules inserted. The rule base contains 6663 rules. 3055 rules in the queue.
16000 rules inserted. The rule base contains 6742 rules. 3382 rules in the queue.
16200 rules inserted. The rule base contains 6808 rules. 3453 rules in the queue.
16400 rules inserted. The rule base contains 6889 rules. 3776 rules in the queue.
16600 rules inserted. The rule base contains 6981 rules. 3822 rules in the queue.
16800 rules inserted. The rule base contains 7061 rules. 4550 rules in the queue.
17000 rules inserted. The rule base contains 7142 rules. 4740 rules in the queue.
17200 rules inserted. The rule base contains 7207 rules. 4677 rules in the queue.
17400 rules inserted. The rule base contains 7305 rules. 4572 rules in the queue.
17600 rules inserted. The rule base contains 7374 rules. 4515 rules in the queue.
17800 rules inserted. The rule base contains 7468 rules. 4422 rules in the queue.
18000 rules inserted. The rule base contains 7542 rules. 4347 rules in the queue.
18200 rules inserted. The rule base contains 7632 rules. 4530 rules in the queue.
18400 rules inserted. The rule base contains 7694 rules. 4738 rules in the queue.
18600 rules inserted. The rule base contains 7791 rules. 4640 rules in the queue.
18800 rules inserted. The rule base contains 7860 rules. 4572 rules in the queue.
19000 rules inserted. The rule base contains 7939 rules. 4627 rules in the queue.
19200 rules inserted. The rule base contains 8035 rules. 4668 rules in the queue.
19400 rules inserted. The rule base contains 8108 rules. 4595 rules in the queue.
19600 rules inserted. The rule base contains 8193 rules. 4511 rules in the queue.
19800 rules inserted. The rule base contains 8279 rules. 4558 rules in the queue.
20000 rules inserted. The rule base contains 8352 rules. 4621 rules in the queue.
20200 rules inserted. The rule base contains 8440 rules. 4534 rules in the queue.
20400 rules inserted. The rule base contains 8518 rules. 4457 rules in the queue.
20600 rules inserted. The rule base contains 8594 rules. 4651 rules in the queue.
20800 rules inserted. The rule base contains 8672 rules. 4842 rules in the queue.
21000 rules inserted. The rule base contains 8762 rules. 4754 rules in the queue.
21200 rules inserted. The rule base contains 8820 rules. 4696 rules in the queue.
21400 rules inserted. The rule base contains 8919 rules. 4598 rules in the queue.
21600 rules inserted. The rule base contains 9003 rules. 4513 rules in the queue.
21800 rules inserted. The rule base contains 9079 rules. 4438 rules in the queue.
22000 rules inserted. The rule base contains 9207 rules. 4358 rules in the queue.
22200 rules inserted. The rule base contains 9304 rules. 4273 rules in the queue.
22400 rules inserted. The rule base contains 9382 rules. 4191 rules in the queue.
22600 rules inserted. The rule base contains 9462 rules. 4112 rules in the queue.
22800 rules inserted. The rule base contains 9551 rules. 4022 rules in the queue.
23000 rules inserted. The rule base contains 9616 rules. 3958 rules in the queue.
23200 rules inserted. The rule base contains 9725 rules. 3848 rules in the queue.
23400 rules inserted. The rule base contains 9809 rules. 3760 rules in the queue.
23600 rules inserted. The rule base contains 9881 rules. 3685 rules in the queue.
23800 rules inserted. The rule base contains 9968 rules. 3599 rules in the queue.
24000 rules inserted. The rule base contains 10060 rules. 3501 rules in the queue.
24200 rules inserted. The rule base contains 10128 rules. 3429 rules in the queue.
24400 rules inserted. The rule base contains 10218 rules. 3340 rules in the queue.
24600 rules inserted. The rule base contains 10309 rules. 3248 rules in the queue.
24800 rules inserted. The rule base contains 10395 rules. 3158 rules in the queue.
25000 rules inserted. The rule base contains 10479 rules. 3071 rules in the queue.
25200 rules inserted. The rule base contains 10556 rules. 2995 rules in the queue.
25400 rules inserted. The rule base contains 10636 rules. 2913 rules in the queue.
25600 rules inserted. The rule base contains 10714 rules. 2837 rules in the queue.
25800 rules inserted. The rule base contains 10811 rules. 2738 rules in the queue.
26000 rules inserted. The rule base contains 10904 rules. 2637 rules in the queue.
26200 rules inserted. The rule base contains 10995 rules. 2546 rules in the queue.
26400 rules inserted. The rule base contains 11128 rules. 2459 rules in the queue.
26600 rules inserted. The rule base contains 11212 rules. 2363 rules in the queue.
26800 rules inserted. The rule base contains 11311 rules. 2260 rules in the queue.
27000 rules inserted. The rule base contains 11395 rules. 2172 rules in the queue.
27200 rules inserted. The rule base contains 11470 rules. 2085 rules in the queue.
27400 rules inserted. The rule base contains 11567 rules. 1984 rules in the queue.
27600 rules inserted. The rule base contains 11643 rules. 1896 rules in the queue.
27800 rules inserted. The rule base contains 11739 rules. 1796 rules in the queue.
28000 rules inserted. The rule base contains 11817 rules. 1706 rules in the queue.
28200 rules inserted. The rule base contains 11914 rules. 1605 rules in the queue.
28400 rules inserted. The rule base contains 11998 rules. 1517 rules in the queue.
28600 rules inserted. The rule base contains 12093 rules. 1406 rules in the queue.
28800 rules inserted. The rule base contains 12175 rules. 1318 rules in the queue.
29000 rules inserted. The rule base contains 12292 rules. 1207 rules in the queue.
29200 rules inserted. The rule base contains 12366 rules. 1121 rules in the queue.
29400 rules inserted. The rule base contains 12448 rules. 1031 rules in the queue.
29600 rules inserted. The rule base contains 12532 rules. 939 rules in the queue.
29800 rules inserted. The rule base contains 12615 rules. 848 rules in the queue.
30000 rules inserted. The rule base contains 12690 rules. 765 rules in the queue.
30200 rules inserted. The rule base contains 12801 rules. 654 rules in the queue.
30400 rules inserted. The rule base contains 12899 rules. 556 rules in the queue.
30600 rules inserted. The rule base contains 13007 rules. 448 rules in the queue.
30800 rules inserted. The rule base contains 13112 rules. 343 rules in the queue.
31000 rules inserted. The rule base contains 13265 rules. 190 rules in the queue.
31200 rules inserted. The rule base contains 13435 rules. 20 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is true.
