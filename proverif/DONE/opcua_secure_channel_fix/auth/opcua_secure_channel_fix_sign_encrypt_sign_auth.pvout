Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
{7}new skI: bitstring;
{8}out(c, skI);
(
    {9}!
    {10}in(c, (Cli: host,Disco: host,Sess: host));
    {11}let v_594: bool = (Cli = A) in
    (
        {12}if v_594 then
        (
            {13}let skCli: bitstring = skA in
            {14}let pkCli: bitstring = pub(skCli) in
            {15}let v_595: bool = (Disco = A) in
            (
                {16}if v_595 then
                (
                    {17}let pkDisco: bitstring = pub(skA) in
                    {18}let v_596: bool = (Sess = A) in
                    (
                        {19}if v_596 then
                        (
                            {20}let pkSess: bitstring = pub(skA) in
                            {21}out(c, GetEndpointRequest);
                            {22}in(c, (SPs: bitstring,=SignAndEncrypt,UP: bitstring,=pkSess));
                            {23}new SPc: bitstring;
                            {24}new Nc: bitstring;
                            {25}let gNc: bitstring = exp(g,Nc) in
                            {26}let m1: bitstring = (Sess,SPc,gNc) in
                            {27}event beginCli(Cli,Sess,gNc);
                            {28}out(c, (pkCli,enc(m1,pkSess),sign(h(m1),skCli)));
                            {29}in(c, (ePartS: bitstring,sigPartS: bitstring));
                            {30}let (=Cli,PartS: bitstring) = dec(ePartS,skCli) in
                            {31}if (verify(h((Cli,PartS)),sigPartS,pkSess) <> true) then
                                0
                            else
                                {32}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {33}let v_597: bool = (Sess = B) in
                            (
                                {34}if v_597 then
                                (
                                    {35}let pkSess_598: bitstring = pub(skB) in
                                    {36}out(c, GetEndpointRequest);
                                    {37}in(c, (SPs_599: bitstring,=SignAndEncrypt,UP_600: bitstring,=pkSess_598));
                                    {38}new SPc_601: bitstring;
                                    {39}new Nc_602: bitstring;
                                    {40}let gNc_603: bitstring = exp(g,Nc_602) in
                                    {41}let m1_604: bitstring = (Sess,SPc_601,gNc_603) in
                                    {42}event beginCli(Cli,Sess,gNc_603);
                                    {43}out(c, (pkCli,enc(m1_604,pkSess_598),sign(h(m1_604),skCli)));
                                    {44}in(c, (ePartS_605: bitstring,sigPartS_606: bitstring));
                                    {45}let (=Cli,PartS_607: bitstring) = dec(ePartS_605,skCli) in
                                    {46}if (verify(h((Cli,PartS_607)),sigPartS_606,pkSess_598) <> true) then
                                        0
                                    else
                                        {47}event endCli(Sess,Cli,PartS_607)
                                )
                                else
                                    {48}let v_608: bool = (Sess = C) in
                                    (
                                        {49}if v_608 then
                                        (
                                            {50}let pkSess_609: bitstring = pub(skC) in
                                            {51}out(c, GetEndpointRequest);
                                            {52}in(c, (SPs_610: bitstring,=SignAndEncrypt,UP_611: bitstring,=pkSess_609));
                                            {53}new SPc_612: bitstring;
                                            {54}new Nc_613: bitstring;
                                            {55}let gNc_614: bitstring = exp(g,Nc_613) in
                                            {56}let m1_615: bitstring = (Sess,SPc_612,gNc_614) in
                                            {57}event beginCli(Cli,Sess,gNc_614);
                                            {58}out(c, (pkCli,enc(m1_615,pkSess_609),sign(h(m1_615),skCli)));
                                            {59}in(c, (ePartS_616: bitstring,sigPartS_617: bitstring));
                                            {60}let (=Cli,PartS_618: bitstring) = dec(ePartS_616,skCli) in
                                            {61}if (verify(h((Cli,PartS_618)),sigPartS_617,pkSess_609) <> true) then
                                                0
                                            else
                                                {62}event endCli(Sess,Cli,PartS_618)
                                        )
                                        else
                                            {63}let pkSess_619: bitstring = pub(skI) in
                                            {64}out(c, GetEndpointRequest);
                                            {65}in(c, (SPs_620: bitstring,=SignAndEncrypt,UP_621: bitstring,=pkSess_619));
                                            {66}new SPc_622: bitstring;
                                            {67}new Nc_623: bitstring;
                                            {68}let gNc_624: bitstring = exp(g,Nc_623) in
                                            {69}let m1_625: bitstring = (Sess,SPc_622,gNc_624) in
                                            {70}event beginCli(Cli,Sess,gNc_624);
                                            {71}out(c, (pkCli,enc(m1_625,pkSess_619),sign(h(m1_625),skCli)));
                                            {72}in(c, (ePartS_626: bitstring,sigPartS_627: bitstring));
                                            {73}let (=Cli,PartS_628: bitstring) = dec(ePartS_626,skCli) in
                                            {74}if (verify(h((Cli,PartS_628)),sigPartS_627,pkSess_619) <> true) then
                                                0
                                            else
                                                {75}event endCli(Sess,Cli,PartS_628)
                                    )
                                    else
                                        {76}let pkSess_629: bitstring = fail-any in
                                        {77}out(c, GetEndpointRequest);
                                        {78}in(c, (SPs_630: bitstring,=SignAndEncrypt,UP_631: bitstring,=pkSess_629));
                                        {79}new SPc_632: bitstring;
                                        {80}new Nc_633: bitstring;
                                        {81}let gNc_634: bitstring = exp(g,Nc_633) in
                                        {82}let m1_635: bitstring = (Sess,SPc_632,gNc_634) in
                                        {83}event beginCli(Cli,Sess,gNc_634);
                                        {84}out(c, (pkCli,enc(m1_635,pkSess_629),sign(h(m1_635),skCli)));
                                        {85}in(c, (ePartS_636: bitstring,sigPartS_637: bitstring));
                                        {86}let (=Cli,PartS_638: bitstring) = dec(ePartS_636,skCli) in
                                        {87}if (verify(h((Cli,PartS_638)),sigPartS_637,pkSess_629) <> true) then
                                            0
                                        else
                                            {88}event endCli(Sess,Cli,PartS_638)
                            )
                            else
                                {89}let pkSess_639: bitstring = fail-any in
                                {90}out(c, GetEndpointRequest);
                                {91}in(c, (SPs_640: bitstring,=SignAndEncrypt,UP_641: bitstring,=pkSess_639));
                                {92}new SPc_642: bitstring;
                                {93}new Nc_643: bitstring;
                                {94}let gNc_644: bitstring = exp(g,Nc_643) in
                                {95}let m1_645: bitstring = (Sess,SPc_642,gNc_644) in
                                {96}event beginCli(Cli,Sess,gNc_644);
                                {97}out(c, (pkCli,enc(m1_645,pkSess_639),sign(h(m1_645),skCli)));
                                {98}in(c, (ePartS_646: bitstring,sigPartS_647: bitstring));
                                {99}let (=Cli,PartS_648: bitstring) = dec(ePartS_646,skCli) in
                                {100}if (verify(h((Cli,PartS_648)),sigPartS_647,pkSess_639) <> true) then
                                    0
                                else
                                    {101}event endCli(Sess,Cli,PartS_648)
                    )
                    else
                        {102}let pkSess_649: bitstring = fail-any in
                        {103}out(c, GetEndpointRequest);
                        {104}in(c, (SPs_650: bitstring,=SignAndEncrypt,UP_651: bitstring,=pkSess_649));
                        {105}new SPc_652: bitstring;
                        {106}new Nc_653: bitstring;
                        {107}let gNc_654: bitstring = exp(g,Nc_653) in
                        {108}let m1_655: bitstring = (Sess,SPc_652,gNc_654) in
                        {109}event beginCli(Cli,Sess,gNc_654);
                        {110}out(c, (pkCli,enc(m1_655,pkSess_649),sign(h(m1_655),skCli)));
                        {111}in(c, (ePartS_656: bitstring,sigPartS_657: bitstring));
                        {112}let (=Cli,PartS_658: bitstring) = dec(ePartS_656,skCli) in
                        {113}if (verify(h((Cli,PartS_658)),sigPartS_657,pkSess_649) <> true) then
                            0
                        else
                            {114}event endCli(Sess,Cli,PartS_658)
                )
                else
                    {115}let v_659: bool = (Disco = B) in
                    (
                        {116}if v_659 then
                        (
                            {117}let pkDisco_660: bitstring = pub(skB) in
                            {118}let v_661: bool = (Sess = A) in
                            (
                                {119}if v_661 then
                                (
                                    {120}let pkSess_662: bitstring = pub(skA) in
                                    {121}out(c, GetEndpointRequest);
                                    {122}in(c, (SPs_663: bitstring,=SignAndEncrypt,UP_664: bitstring,=pkSess_662));
                                    {123}new SPc_665: bitstring;
                                    {124}new Nc_666: bitstring;
                                    {125}let gNc_667: bitstring = exp(g,Nc_666) in
                                    {126}let m1_668: bitstring = (Sess,SPc_665,gNc_667) in
                                    {127}event beginCli(Cli,Sess,gNc_667);
                                    {128}out(c, (pkCli,enc(m1_668,pkSess_662),sign(h(m1_668),skCli)));
                                    {129}in(c, (ePartS_669: bitstring,sigPartS_670: bitstring));
                                    {130}let (=Cli,PartS_671: bitstring) = dec(ePartS_669,skCli) in
                                    {131}if (verify(h((Cli,PartS_671)),sigPartS_670,pkSess_662) <> true) then
                                        0
                                    else
                                        {132}event endCli(Sess,Cli,PartS_671)
                                )
                                else
                                    {133}let v_672: bool = (Sess = B) in
                                    (
                                        {134}if v_672 then
                                        (
                                            {135}let pkSess_673: bitstring = pub(skB) in
                                            {136}out(c, GetEndpointRequest);
                                            {137}in(c, (SPs_674: bitstring,=SignAndEncrypt,UP_675: bitstring,=pkSess_673));
                                            {138}new SPc_676: bitstring;
                                            {139}new Nc_677: bitstring;
                                            {140}let gNc_678: bitstring = exp(g,Nc_677) in
                                            {141}let m1_679: bitstring = (Sess,SPc_676,gNc_678) in
                                            {142}event beginCli(Cli,Sess,gNc_678);
                                            {143}out(c, (pkCli,enc(m1_679,pkSess_673),sign(h(m1_679),skCli)));
                                            {144}in(c, (ePartS_680: bitstring,sigPartS_681: bitstring));
                                            {145}let (=Cli,PartS_682: bitstring) = dec(ePartS_680,skCli) in
                                            {146}if (verify(h((Cli,PartS_682)),sigPartS_681,pkSess_673) <> true) then
                                                0
                                            else
                                                {147}event endCli(Sess,Cli,PartS_682)
                                        )
                                        else
                                            {148}let v_683: bool = (Sess = C) in
                                            (
                                                {149}if v_683 then
                                                (
                                                    {150}let pkSess_684: bitstring = pub(skC) in
                                                    {151}out(c, GetEndpointRequest);
                                                    {152}in(c, (SPs_685: bitstring,=SignAndEncrypt,UP_686: bitstring,=pkSess_684));
                                                    {153}new SPc_687: bitstring;
                                                    {154}new Nc_688: bitstring;
                                                    {155}let gNc_689: bitstring = exp(g,Nc_688) in
                                                    {156}let m1_690: bitstring = (Sess,SPc_687,gNc_689) in
                                                    {157}event beginCli(Cli,Sess,gNc_689);
                                                    {158}out(c, (pkCli,enc(m1_690,pkSess_684),sign(h(m1_690),skCli)));
                                                    {159}in(c, (ePartS_691: bitstring,sigPartS_692: bitstring));
                                                    {160}let (=Cli,PartS_693: bitstring) = dec(ePartS_691,skCli) in
                                                    {161}if (verify(h((Cli,PartS_693)),sigPartS_692,pkSess_684) <> true) then
                                                        0
                                                    else
                                                        {162}event endCli(Sess,Cli,PartS_693)
                                                )
                                                else
                                                    {163}let pkSess_694: bitstring = pub(skI) in
                                                    {164}out(c, GetEndpointRequest);
                                                    {165}in(c, (SPs_695: bitstring,=SignAndEncrypt,UP_696: bitstring,=pkSess_694));
                                                    {166}new SPc_697: bitstring;
                                                    {167}new Nc_698: bitstring;
                                                    {168}let gNc_699: bitstring = exp(g,Nc_698) in
                                                    {169}let m1_700: bitstring = (Sess,SPc_697,gNc_699) in
                                                    {170}event beginCli(Cli,Sess,gNc_699);
                                                    {171}out(c, (pkCli,enc(m1_700,pkSess_694),sign(h(m1_700),skCli)));
                                                    {172}in(c, (ePartS_701: bitstring,sigPartS_702: bitstring));
                                                    {173}let (=Cli,PartS_703: bitstring) = dec(ePartS_701,skCli) in
                                                    {174}if (verify(h((Cli,PartS_703)),sigPartS_702,pkSess_694) <> true) then
                                                        0
                                                    else
                                                        {175}event endCli(Sess,Cli,PartS_703)
                                            )
                                            else
                                                {176}let pkSess_704: bitstring = fail-any in
                                                {177}out(c, GetEndpointRequest);
                                                {178}in(c, (SPs_705: bitstring,=SignAndEncrypt,UP_706: bitstring,=pkSess_704));
                                                {179}new SPc_707: bitstring;
                                                {180}new Nc_708: bitstring;
                                                {181}let gNc_709: bitstring = exp(g,Nc_708) in
                                                {182}let m1_710: bitstring = (Sess,SPc_707,gNc_709) in
                                                {183}event beginCli(Cli,Sess,gNc_709);
                                                {184}out(c, (pkCli,enc(m1_710,pkSess_704),sign(h(m1_710),skCli)));
                                                {185}in(c, (ePartS_711: bitstring,sigPartS_712: bitstring));
                                                {186}let (=Cli,PartS_713: bitstring) = dec(ePartS_711,skCli) in
                                                {187}if (verify(h((Cli,PartS_713)),sigPartS_712,pkSess_704) <> true) then
                                                    0
                                                else
                                                    {188}event endCli(Sess,Cli,PartS_713)
                                    )
                                    else
                                        {189}let pkSess_714: bitstring = fail-any in
                                        {190}out(c, GetEndpointRequest);
                                        {191}in(c, (SPs_715: bitstring,=SignAndEncrypt,UP_716: bitstring,=pkSess_714));
                                        {192}new SPc_717: bitstring;
                                        {193}new Nc_718: bitstring;
                                        {194}let gNc_719: bitstring = exp(g,Nc_718) in
                                        {195}let m1_720: bitstring = (Sess,SPc_717,gNc_719) in
                                        {196}event beginCli(Cli,Sess,gNc_719);
                                        {197}out(c, (pkCli,enc(m1_720,pkSess_714),sign(h(m1_720),skCli)));
                                        {198}in(c, (ePartS_721: bitstring,sigPartS_722: bitstring));
                                        {199}let (=Cli,PartS_723: bitstring) = dec(ePartS_721,skCli) in
                                        {200}if (verify(h((Cli,PartS_723)),sigPartS_722,pkSess_714) <> true) then
                                            0
                                        else
                                            {201}event endCli(Sess,Cli,PartS_723)
                            )
                            else
                                {202}let pkSess_724: bitstring = fail-any in
                                {203}out(c, GetEndpointRequest);
                                {204}in(c, (SPs_725: bitstring,=SignAndEncrypt,UP_726: bitstring,=pkSess_724));
                                {205}new SPc_727: bitstring;
                                {206}new Nc_728: bitstring;
                                {207}let gNc_729: bitstring = exp(g,Nc_728) in
                                {208}let m1_730: bitstring = (Sess,SPc_727,gNc_729) in
                                {209}event beginCli(Cli,Sess,gNc_729);
                                {210}out(c, (pkCli,enc(m1_730,pkSess_724),sign(h(m1_730),skCli)));
                                {211}in(c, (ePartS_731: bitstring,sigPartS_732: bitstring));
                                {212}let (=Cli,PartS_733: bitstring) = dec(ePartS_731,skCli) in
                                {213}if (verify(h((Cli,PartS_733)),sigPartS_732,pkSess_724) <> true) then
                                    0
                                else
                                    {214}event endCli(Sess,Cli,PartS_733)
                        )
                        else
                            {215}let v_734: bool = (Disco = C) in
                            (
                                {216}if v_734 then
                                (
                                    {217}let pkDisco_735: bitstring = pub(skC) in
                                    {218}let v_736: bool = (Sess = A) in
                                    (
                                        {219}if v_736 then
                                        (
                                            {220}let pkSess_737: bitstring = pub(skA) in
                                            {221}out(c, GetEndpointRequest);
                                            {222}in(c, (SPs_738: bitstring,=SignAndEncrypt,UP_739: bitstring,=pkSess_737));
                                            {223}new SPc_740: bitstring;
                                            {224}new Nc_741: bitstring;
                                            {225}let gNc_742: bitstring = exp(g,Nc_741) in
                                            {226}let m1_743: bitstring = (Sess,SPc_740,gNc_742) in
                                            {227}event beginCli(Cli,Sess,gNc_742);
                                            {228}out(c, (pkCli,enc(m1_743,pkSess_737),sign(h(m1_743),skCli)));
                                            {229}in(c, (ePartS_744: bitstring,sigPartS_745: bitstring));
                                            {230}let (=Cli,PartS_746: bitstring) = dec(ePartS_744,skCli) in
                                            {231}if (verify(h((Cli,PartS_746)),sigPartS_745,pkSess_737) <> true) then
                                                0
                                            else
                                                {232}event endCli(Sess,Cli,PartS_746)
                                        )
                                        else
                                            {233}let v_747: bool = (Sess = B) in
                                            (
                                                {234}if v_747 then
                                                (
                                                    {235}let pkSess_748: bitstring = pub(skB) in
                                                    {236}out(c, GetEndpointRequest);
                                                    {237}in(c, (SPs_749: bitstring,=SignAndEncrypt,UP_750: bitstring,=pkSess_748));
                                                    {238}new SPc_751: bitstring;
                                                    {239}new Nc_752: bitstring;
                                                    {240}let gNc_753: bitstring = exp(g,Nc_752) in
                                                    {241}let m1_754: bitstring = (Sess,SPc_751,gNc_753) in
                                                    {242}event beginCli(Cli,Sess,gNc_753);
                                                    {243}out(c, (pkCli,enc(m1_754,pkSess_748),sign(h(m1_754),skCli)));
                                                    {244}in(c, (ePartS_755: bitstring,sigPartS_756: bitstring));
                                                    {245}let (=Cli,PartS_757: bitstring) = dec(ePartS_755,skCli) in
                                                    {246}if (verify(h((Cli,PartS_757)),sigPartS_756,pkSess_748) <> true) then
                                                        0
                                                    else
                                                        {247}event endCli(Sess,Cli,PartS_757)
                                                )
                                                else
                                                    {248}let v_758: bool = (Sess = C) in
                                                    (
                                                        {249}if v_758 then
                                                        (
                                                            {250}let pkSess_759: bitstring = pub(skC) in
                                                            {251}out(c, GetEndpointRequest);
                                                            {252}in(c, (SPs_760: bitstring,=SignAndEncrypt,UP_761: bitstring,=pkSess_759));
                                                            {253}new SPc_762: bitstring;
                                                            {254}new Nc_763: bitstring;
                                                            {255}let gNc_764: bitstring = exp(g,Nc_763) in
                                                            {256}let m1_765: bitstring = (Sess,SPc_762,gNc_764) in
                                                            {257}event beginCli(Cli,Sess,gNc_764);
                                                            {258}out(c, (pkCli,enc(m1_765,pkSess_759),sign(h(m1_765),skCli)));
                                                            {259}in(c, (ePartS_766: bitstring,sigPartS_767: bitstring));
                                                            {260}let (=Cli,PartS_768: bitstring) = dec(ePartS_766,skCli) in
                                                            {261}if (verify(h((Cli,PartS_768)),sigPartS_767,pkSess_759) <> true) then
                                                                0
                                                            else
                                                                {262}event endCli(Sess,Cli,PartS_768)
                                                        )
                                                        else
                                                            {263}let pkSess_769: bitstring = pub(skI) in
                                                            {264}out(c, GetEndpointRequest);
                                                            {265}in(c, (SPs_770: bitstring,=SignAndEncrypt,UP_771: bitstring,=pkSess_769));
                                                            {266}new SPc_772: bitstring;
                                                            {267}new Nc_773: bitstring;
                                                            {268}let gNc_774: bitstring = exp(g,Nc_773) in
                                                            {269}let m1_775: bitstring = (Sess,SPc_772,gNc_774) in
                                                            {270}event beginCli(Cli,Sess,gNc_774);
                                                            {271}out(c, (pkCli,enc(m1_775,pkSess_769),sign(h(m1_775),skCli)));
                                                            {272}in(c, (ePartS_776: bitstring,sigPartS_777: bitstring));
                                                            {273}let (=Cli,PartS_778: bitstring) = dec(ePartS_776,skCli) in
                                                            {274}if (verify(h((Cli,PartS_778)),sigPartS_777,pkSess_769) <> true) then
                                                                0
                                                            else
                                                                {275}event endCli(Sess,Cli,PartS_778)
                                                    )
                                                    else
                                                        {276}let pkSess_779: bitstring = fail-any in
                                                        {277}out(c, GetEndpointRequest);
                                                        {278}in(c, (SPs_780: bitstring,=SignAndEncrypt,UP_781: bitstring,=pkSess_779));
                                                        {279}new SPc_782: bitstring;
                                                        {280}new Nc_783: bitstring;
                                                        {281}let gNc_784: bitstring = exp(g,Nc_783) in
                                                        {282}let m1_785: bitstring = (Sess,SPc_782,gNc_784) in
                                                        {283}event beginCli(Cli,Sess,gNc_784);
                                                        {284}out(c, (pkCli,enc(m1_785,pkSess_779),sign(h(m1_785),skCli)));
                                                        {285}in(c, (ePartS_786: bitstring,sigPartS_787: bitstring));
                                                        {286}let (=Cli,PartS_788: bitstring) = dec(ePartS_786,skCli) in
                                                        {287}if (verify(h((Cli,PartS_788)),sigPartS_787,pkSess_779) <> true) then
                                                            0
                                                        else
                                                            {288}event endCli(Sess,Cli,PartS_788)
                                            )
                                            else
                                                {289}let pkSess_789: bitstring = fail-any in
                                                {290}out(c, GetEndpointRequest);
                                                {291}in(c, (SPs_790: bitstring,=SignAndEncrypt,UP_791: bitstring,=pkSess_789));
                                                {292}new SPc_792: bitstring;
                                                {293}new Nc_793: bitstring;
                                                {294}let gNc_794: bitstring = exp(g,Nc_793) in
                                                {295}let m1_795: bitstring = (Sess,SPc_792,gNc_794) in
                                                {296}event beginCli(Cli,Sess,gNc_794);
                                                {297}out(c, (pkCli,enc(m1_795,pkSess_789),sign(h(m1_795),skCli)));
                                                {298}in(c, (ePartS_796: bitstring,sigPartS_797: bitstring));
                                                {299}let (=Cli,PartS_798: bitstring) = dec(ePartS_796,skCli) in
                                                {300}if (verify(h((Cli,PartS_798)),sigPartS_797,pkSess_789) <> true) then
                                                    0
                                                else
                                                    {301}event endCli(Sess,Cli,PartS_798)
                                    )
                                    else
                                        {302}let pkSess_799: bitstring = fail-any in
                                        {303}out(c, GetEndpointRequest);
                                        {304}in(c, (SPs_800: bitstring,=SignAndEncrypt,UP_801: bitstring,=pkSess_799));
                                        {305}new SPc_802: bitstring;
                                        {306}new Nc_803: bitstring;
                                        {307}let gNc_804: bitstring = exp(g,Nc_803) in
                                        {308}let m1_805: bitstring = (Sess,SPc_802,gNc_804) in
                                        {309}event beginCli(Cli,Sess,gNc_804);
                                        {310}out(c, (pkCli,enc(m1_805,pkSess_799),sign(h(m1_805),skCli)));
                                        {311}in(c, (ePartS_806: bitstring,sigPartS_807: bitstring));
                                        {312}let (=Cli,PartS_808: bitstring) = dec(ePartS_806,skCli) in
                                        {313}if (verify(h((Cli,PartS_808)),sigPartS_807,pkSess_799) <> true) then
                                            0
                                        else
                                            {314}event endCli(Sess,Cli,PartS_808)
                                )
                                else
                                    {315}let pkDisco_809: bitstring = pub(skI) in
                                    {316}let v_810: bool = (Sess = A) in
                                    (
                                        {317}if v_810 then
                                        (
                                            {318}let pkSess_811: bitstring = pub(skA) in
                                            {319}out(c, GetEndpointRequest);
                                            {320}in(c, (SPs_812: bitstring,=SignAndEncrypt,UP_813: bitstring,=pkSess_811));
                                            {321}new SPc_814: bitstring;
                                            {322}new Nc_815: bitstring;
                                            {323}let gNc_816: bitstring = exp(g,Nc_815) in
                                            {324}let m1_817: bitstring = (Sess,SPc_814,gNc_816) in
                                            {325}event beginCli(Cli,Sess,gNc_816);
                                            {326}out(c, (pkCli,enc(m1_817,pkSess_811),sign(h(m1_817),skCli)));
                                            {327}in(c, (ePartS_818: bitstring,sigPartS_819: bitstring));
                                            {328}let (=Cli,PartS_820: bitstring) = dec(ePartS_818,skCli) in
                                            {329}if (verify(h((Cli,PartS_820)),sigPartS_819,pkSess_811) <> true) then
                                                0
                                            else
                                                {330}event endCli(Sess,Cli,PartS_820)
                                        )
                                        else
                                            {331}let v_821: bool = (Sess = B) in
                                            (
                                                {332}if v_821 then
                                                (
                                                    {333}let pkSess_822: bitstring = pub(skB) in
                                                    {334}out(c, GetEndpointRequest);
                                                    {335}in(c, (SPs_823: bitstring,=SignAndEncrypt,UP_824: bitstring,=pkSess_822));
                                                    {336}new SPc_825: bitstring;
                                                    {337}new Nc_826: bitstring;
                                                    {338}let gNc_827: bitstring = exp(g,Nc_826) in
                                                    {339}let m1_828: bitstring = (Sess,SPc_825,gNc_827) in
                                                    {340}event beginCli(Cli,Sess,gNc_827);
                                                    {341}out(c, (pkCli,enc(m1_828,pkSess_822),sign(h(m1_828),skCli)));
                                                    {342}in(c, (ePartS_829: bitstring,sigPartS_830: bitstring));
                                                    {343}let (=Cli,PartS_831: bitstring) = dec(ePartS_829,skCli) in
                                                    {344}if (verify(h((Cli,PartS_831)),sigPartS_830,pkSess_822) <> true) then
                                                        0
                                                    else
                                                        {345}event endCli(Sess,Cli,PartS_831)
                                                )
                                                else
                                                    {346}let v_832: bool = (Sess = C) in
                                                    (
                                                        {347}if v_832 then
                                                        (
                                                            {348}let pkSess_833: bitstring = pub(skC) in
                                                            {349}out(c, GetEndpointRequest);
                                                            {350}in(c, (SPs_834: bitstring,=SignAndEncrypt,UP_835: bitstring,=pkSess_833));
                                                            {351}new SPc_836: bitstring;
                                                            {352}new Nc_837: bitstring;
                                                            {353}let gNc_838: bitstring = exp(g,Nc_837) in
                                                            {354}let m1_839: bitstring = (Sess,SPc_836,gNc_838) in
                                                            {355}event beginCli(Cli,Sess,gNc_838);
                                                            {356}out(c, (pkCli,enc(m1_839,pkSess_833),sign(h(m1_839),skCli)));
                                                            {357}in(c, (ePartS_840: bitstring,sigPartS_841: bitstring));
                                                            {358}let (=Cli,PartS_842: bitstring) = dec(ePartS_840,skCli) in
                                                            {359}if (verify(h((Cli,PartS_842)),sigPartS_841,pkSess_833) <> true) then
                                                                0
                                                            else
                                                                {360}event endCli(Sess,Cli,PartS_842)
                                                        )
                                                        else
                                                            {361}let pkSess_843: bitstring = pub(skI) in
                                                            {362}out(c, GetEndpointRequest);
                                                            {363}in(c, (SPs_844: bitstring,=SignAndEncrypt,UP_845: bitstring,=pkSess_843));
                                                            {364}new SPc_846: bitstring;
                                                            {365}new Nc_847: bitstring;
                                                            {366}let gNc_848: bitstring = exp(g,Nc_847) in
                                                            {367}let m1_849: bitstring = (Sess,SPc_846,gNc_848) in
                                                            {368}event beginCli(Cli,Sess,gNc_848);
                                                            {369}out(c, (pkCli,enc(m1_849,pkSess_843),sign(h(m1_849),skCli)));
                                                            {370}in(c, (ePartS_850: bitstring,sigPartS_851: bitstring));
                                                            {371}let (=Cli,PartS_852: bitstring) = dec(ePartS_850,skCli) in
                                                            {372}if (verify(h((Cli,PartS_852)),sigPartS_851,pkSess_843) <> true) then
                                                                0
                                                            else
                                                                {373}event endCli(Sess,Cli,PartS_852)
                                                    )
                                                    else
                                                        {374}let pkSess_853: bitstring = fail-any in
                                                        {375}out(c, GetEndpointRequest);
                                                        {376}in(c, (SPs_854: bitstring,=SignAndEncrypt,UP_855: bitstring,=pkSess_853));
                                                        {377}new SPc_856: bitstring;
                                                        {378}new Nc_857: bitstring;
                                                        {379}let gNc_858: bitstring = exp(g,Nc_857) in
                                                        {380}let m1_859: bitstring = (Sess,SPc_856,gNc_858) in
                                                        {381}event beginCli(Cli,Sess,gNc_858);
                                                        {382}out(c, (pkCli,enc(m1_859,pkSess_853),sign(h(m1_859),skCli)));
                                                        {383}in(c, (ePartS_860: bitstring,sigPartS_861: bitstring));
                                                        {384}let (=Cli,PartS_862: bitstring) = dec(ePartS_860,skCli) in
                                                        {385}if (verify(h((Cli,PartS_862)),sigPartS_861,pkSess_853) <> true) then
                                                            0
                                                        else
                                                            {386}event endCli(Sess,Cli,PartS_862)
                                            )
                                            else
                                                {387}let pkSess_863: bitstring = fail-any in
                                                {388}out(c, GetEndpointRequest);
                                                {389}in(c, (SPs_864: bitstring,=SignAndEncrypt,UP_865: bitstring,=pkSess_863));
                                                {390}new SPc_866: bitstring;
                                                {391}new Nc_867: bitstring;
                                                {392}let gNc_868: bitstring = exp(g,Nc_867) in
                                                {393}let m1_869: bitstring = (Sess,SPc_866,gNc_868) in
                                                {394}event beginCli(Cli,Sess,gNc_868);
                                                {395}out(c, (pkCli,enc(m1_869,pkSess_863),sign(h(m1_869),skCli)));
                                                {396}in(c, (ePartS_870: bitstring,sigPartS_871: bitstring));
                                                {397}let (=Cli,PartS_872: bitstring) = dec(ePartS_870,skCli) in
                                                {398}if (verify(h((Cli,PartS_872)),sigPartS_871,pkSess_863) <> true) then
                                                    0
                                                else
                                                    {399}event endCli(Sess,Cli,PartS_872)
                                    )
                                    else
                                        {400}let pkSess_873: bitstring = fail-any in
                                        {401}out(c, GetEndpointRequest);
                                        {402}in(c, (SPs_874: bitstring,=SignAndEncrypt,UP_875: bitstring,=pkSess_873));
                                        {403}new SPc_876: bitstring;
                                        {404}new Nc_877: bitstring;
                                        {405}let gNc_878: bitstring = exp(g,Nc_877) in
                                        {406}let m1_879: bitstring = (Sess,SPc_876,gNc_878) in
                                        {407}event beginCli(Cli,Sess,gNc_878);
                                        {408}out(c, (pkCli,enc(m1_879,pkSess_873),sign(h(m1_879),skCli)));
                                        {409}in(c, (ePartS_880: bitstring,sigPartS_881: bitstring));
                                        {410}let (=Cli,PartS_882: bitstring) = dec(ePartS_880,skCli) in
                                        {411}if (verify(h((Cli,PartS_882)),sigPartS_881,pkSess_873) <> true) then
                                            0
                                        else
                                            {412}event endCli(Sess,Cli,PartS_882)
                            )
                            else
                                {413}let pkDisco_883: bitstring = fail-any in
                                {414}let v_884: bool = (Sess = A) in
                                (
                                    {415}if v_884 then
                                    (
                                        {416}let pkSess_885: bitstring = pub(skA) in
                                        {417}out(c, GetEndpointRequest);
                                        {418}in(c, (SPs_886: bitstring,=SignAndEncrypt,UP_887: bitstring,=pkSess_885));
                                        {419}new SPc_888: bitstring;
                                        {420}new Nc_889: bitstring;
                                        {421}let gNc_890: bitstring = exp(g,Nc_889) in
                                        {422}let m1_891: bitstring = (Sess,SPc_888,gNc_890) in
                                        {423}event beginCli(Cli,Sess,gNc_890);
                                        {424}out(c, (pkCli,enc(m1_891,pkSess_885),sign(h(m1_891),skCli)));
                                        {425}in(c, (ePartS_892: bitstring,sigPartS_893: bitstring));
                                        {426}let (=Cli,PartS_894: bitstring) = dec(ePartS_892,skCli) in
                                        {427}if (verify(h((Cli,PartS_894)),sigPartS_893,pkSess_885) <> true) then
                                            0
                                        else
                                            {428}event endCli(Sess,Cli,PartS_894)
                                    )
                                    else
                                        {429}let v_895: bool = (Sess = B) in
                                        (
                                            {430}if v_895 then
                                            (
                                                {431}let pkSess_896: bitstring = pub(skB) in
                                                {432}out(c, GetEndpointRequest);
                                                {433}in(c, (SPs_897: bitstring,=SignAndEncrypt,UP_898: bitstring,=pkSess_896));
                                                {434}new SPc_899: bitstring;
                                                {435}new Nc_900: bitstring;
                                                {436}let gNc_901: bitstring = exp(g,Nc_900) in
                                                {437}let m1_902: bitstring = (Sess,SPc_899,gNc_901) in
                                                {438}event beginCli(Cli,Sess,gNc_901);
                                                {439}out(c, (pkCli,enc(m1_902,pkSess_896),sign(h(m1_902),skCli)));
                                                {440}in(c, (ePartS_903: bitstring,sigPartS_904: bitstring));
                                                {441}let (=Cli,PartS_905: bitstring) = dec(ePartS_903,skCli) in
                                                {442}if (verify(h((Cli,PartS_905)),sigPartS_904,pkSess_896) <> true) then
                                                    0
                                                else
                                                    {443}event endCli(Sess,Cli,PartS_905)
                                            )
                                            else
                                                {444}let v_906: bool = (Sess = C) in
                                                (
                                                    {445}if v_906 then
                                                    (
                                                        {446}let pkSess_907: bitstring = pub(skC) in
                                                        {447}out(c, GetEndpointRequest);
                                                        {448}in(c, (SPs_908: bitstring,=SignAndEncrypt,UP_909: bitstring,=pkSess_907));
                                                        {449}new SPc_910: bitstring;
                                                        {450}new Nc_911: bitstring;
                                                        {451}let gNc_912: bitstring = exp(g,Nc_911) in
                                                        {452}let m1_913: bitstring = (Sess,SPc_910,gNc_912) in
                                                        {453}event beginCli(Cli,Sess,gNc_912);
                                                        {454}out(c, (pkCli,enc(m1_913,pkSess_907),sign(h(m1_913),skCli)));
                                                        {455}in(c, (ePartS_914: bitstring,sigPartS_915: bitstring));
                                                        {456}let (=Cli,PartS_916: bitstring) = dec(ePartS_914,skCli) in
                                                        {457}if (verify(h((Cli,PartS_916)),sigPartS_915,pkSess_907) <> true) then
                                                            0
                                                        else
                                                            {458}event endCli(Sess,Cli,PartS_916)
                                                    )
                                                    else
                                                        {459}let pkSess_917: bitstring = pub(skI) in
                                                        {460}out(c, GetEndpointRequest);
                                                        {461}in(c, (SPs_918: bitstring,=SignAndEncrypt,UP_919: bitstring,=pkSess_917));
                                                        {462}new SPc_920: bitstring;
                                                        {463}new Nc_921: bitstring;
                                                        {464}let gNc_922: bitstring = exp(g,Nc_921) in
                                                        {465}let m1_923: bitstring = (Sess,SPc_920,gNc_922) in
                                                        {466}event beginCli(Cli,Sess,gNc_922);
                                                        {467}out(c, (pkCli,enc(m1_923,pkSess_917),sign(h(m1_923),skCli)));
                                                        {468}in(c, (ePartS_924: bitstring,sigPartS_925: bitstring));
                                                        {469}let (=Cli,PartS_926: bitstring) = dec(ePartS_924,skCli) in
                                                        {470}if (verify(h((Cli,PartS_926)),sigPartS_925,pkSess_917) <> true) then
                                                            0
                                                        else
                                                            {471}event endCli(Sess,Cli,PartS_926)
                                                )
                                                else
                                                    {472}let pkSess_927: bitstring = fail-any in
                                                    {473}out(c, GetEndpointRequest);
                                                    {474}in(c, (SPs_928: bitstring,=SignAndEncrypt,UP_929: bitstring,=pkSess_927));
                                                    {475}new SPc_930: bitstring;
                                                    {476}new Nc_931: bitstring;
                                                    {477}let gNc_932: bitstring = exp(g,Nc_931) in
                                                    {478}let m1_933: bitstring = (Sess,SPc_930,gNc_932) in
                                                    {479}event beginCli(Cli,Sess,gNc_932);
                                                    {480}out(c, (pkCli,enc(m1_933,pkSess_927),sign(h(m1_933),skCli)));
                                                    {481}in(c, (ePartS_934: bitstring,sigPartS_935: bitstring));
                                                    {482}let (=Cli,PartS_936: bitstring) = dec(ePartS_934,skCli) in
                                                    {483}if (verify(h((Cli,PartS_936)),sigPartS_935,pkSess_927) <> true) then
                                                        0
                                                    else
                                                        {484}event endCli(Sess,Cli,PartS_936)
                                        )
                                        else
                                            {485}let pkSess_937: bitstring = fail-any in
                                            {486}out(c, GetEndpointRequest);
                                            {487}in(c, (SPs_938: bitstring,=SignAndEncrypt,UP_939: bitstring,=pkSess_937));
                                            {488}new SPc_940: bitstring;
                                            {489}new Nc_941: bitstring;
                                            {490}let gNc_942: bitstring = exp(g,Nc_941) in
                                            {491}let m1_943: bitstring = (Sess,SPc_940,gNc_942) in
                                            {492}event beginCli(Cli,Sess,gNc_942);
                                            {493}out(c, (pkCli,enc(m1_943,pkSess_937),sign(h(m1_943),skCli)));
                                            {494}in(c, (ePartS_944: bitstring,sigPartS_945: bitstring));
                                            {495}let (=Cli,PartS_946: bitstring) = dec(ePartS_944,skCli) in
                                            {496}if (verify(h((Cli,PartS_946)),sigPartS_945,pkSess_937) <> true) then
                                                0
                                            else
                                                {497}event endCli(Sess,Cli,PartS_946)
                                )
                                else
                                    {498}let pkSess_947: bitstring = fail-any in
                                    {499}out(c, GetEndpointRequest);
                                    {500}in(c, (SPs_948: bitstring,=SignAndEncrypt,UP_949: bitstring,=pkSess_947));
                                    {501}new SPc_950: bitstring;
                                    {502}new Nc_951: bitstring;
                                    {503}let gNc_952: bitstring = exp(g,Nc_951) in
                                    {504}let m1_953: bitstring = (Sess,SPc_950,gNc_952) in
                                    {505}event beginCli(Cli,Sess,gNc_952);
                                    {506}out(c, (pkCli,enc(m1_953,pkSess_947),sign(h(m1_953),skCli)));
                                    {507}in(c, (ePartS_954: bitstring,sigPartS_955: bitstring));
                                    {508}let (=Cli,PartS_956: bitstring) = dec(ePartS_954,skCli) in
                                    {509}if (verify(h((Cli,PartS_956)),sigPartS_955,pkSess_947) <> true) then
                                        0
                                    else
                                        {510}event endCli(Sess,Cli,PartS_956)
                    )
                    else
                        {511}let pkDisco_957: bitstring = fail-any in
                        {512}let v_958: bool = (Sess = A) in
                        (
                            {513}if v_958 then
                            (
                                {514}let pkSess_959: bitstring = pub(skA) in
                                {515}out(c, GetEndpointRequest);
                                {516}in(c, (SPs_960: bitstring,=SignAndEncrypt,UP_961: bitstring,=pkSess_959));
                                {517}new SPc_962: bitstring;
                                {518}new Nc_963: bitstring;
                                {519}let gNc_964: bitstring = exp(g,Nc_963) in
                                {520}let m1_965: bitstring = (Sess,SPc_962,gNc_964) in
                                {521}event beginCli(Cli,Sess,gNc_964);
                                {522}out(c, (pkCli,enc(m1_965,pkSess_959),sign(h(m1_965),skCli)));
                                {523}in(c, (ePartS_966: bitstring,sigPartS_967: bitstring));
                                {524}let (=Cli,PartS_968: bitstring) = dec(ePartS_966,skCli) in
                                {525}if (verify(h((Cli,PartS_968)),sigPartS_967,pkSess_959) <> true) then
                                    0
                                else
                                    {526}event endCli(Sess,Cli,PartS_968)
                            )
                            else
                                {527}let v_969: bool = (Sess = B) in
                                (
                                    {528}if v_969 then
                                    (
                                        {529}let pkSess_970: bitstring = pub(skB) in
                                        {530}out(c, GetEndpointRequest);
                                        {531}in(c, (SPs_971: bitstring,=SignAndEncrypt,UP_972: bitstring,=pkSess_970));
                                        {532}new SPc_973: bitstring;
                                        {533}new Nc_974: bitstring;
                                        {534}let gNc_975: bitstring = exp(g,Nc_974) in
                                        {535}let m1_976: bitstring = (Sess,SPc_973,gNc_975) in
                                        {536}event beginCli(Cli,Sess,gNc_975);
                                        {537}out(c, (pkCli,enc(m1_976,pkSess_970),sign(h(m1_976),skCli)));
                                        {538}in(c, (ePartS_977: bitstring,sigPartS_978: bitstring));
                                        {539}let (=Cli,PartS_979: bitstring) = dec(ePartS_977,skCli) in
                                        {540}if (verify(h((Cli,PartS_979)),sigPartS_978,pkSess_970) <> true) then
                                            0
                                        else
                                            {541}event endCli(Sess,Cli,PartS_979)
                                    )
                                    else
                                        {542}let v_980: bool = (Sess = C) in
                                        (
                                            {543}if v_980 then
                                            (
                                                {544}let pkSess_981: bitstring = pub(skC) in
                                                {545}out(c, GetEndpointRequest);
                                                {546}in(c, (SPs_982: bitstring,=SignAndEncrypt,UP_983: bitstring,=pkSess_981));
                                                {547}new SPc_984: bitstring;
                                                {548}new Nc_985: bitstring;
                                                {549}let gNc_986: bitstring = exp(g,Nc_985) in
                                                {550}let m1_987: bitstring = (Sess,SPc_984,gNc_986) in
                                                {551}event beginCli(Cli,Sess,gNc_986);
                                                {552}out(c, (pkCli,enc(m1_987,pkSess_981),sign(h(m1_987),skCli)));
                                                {553}in(c, (ePartS_988: bitstring,sigPartS_989: bitstring));
                                                {554}let (=Cli,PartS_990: bitstring) = dec(ePartS_988,skCli) in
                                                {555}if (verify(h((Cli,PartS_990)),sigPartS_989,pkSess_981) <> true) then
                                                    0
                                                else
                                                    {556}event endCli(Sess,Cli,PartS_990)
                                            )
                                            else
                                                {557}let pkSess_991: bitstring = pub(skI) in
                                                {558}out(c, GetEndpointRequest);
                                                {559}in(c, (SPs_992: bitstring,=SignAndEncrypt,UP_993: bitstring,=pkSess_991));
                                                {560}new SPc_994: bitstring;
                                                {561}new Nc_995: bitstring;
                                                {562}let gNc_996: bitstring = exp(g,Nc_995) in
                                                {563}let m1_997: bitstring = (Sess,SPc_994,gNc_996) in
                                                {564}event beginCli(Cli,Sess,gNc_996);
                                                {565}out(c, (pkCli,enc(m1_997,pkSess_991),sign(h(m1_997),skCli)));
                                                {566}in(c, (ePartS_998: bitstring,sigPartS_999: bitstring));
                                                {567}let (=Cli,PartS_1000: bitstring) = dec(ePartS_998,skCli) in
                                                {568}if (verify(h((Cli,PartS_1000)),sigPartS_999,pkSess_991) <> true) then
                                                    0
                                                else
                                                    {569}event endCli(Sess,Cli,PartS_1000)
                                        )
                                        else
                                            {570}let pkSess_1001: bitstring = fail-any in
                                            {571}out(c, GetEndpointRequest);
                                            {572}in(c, (SPs_1002: bitstring,=SignAndEncrypt,UP_1003: bitstring,=pkSess_1001));
                                            {573}new SPc_1004: bitstring;
                                            {574}new Nc_1005: bitstring;
                                            {575}let gNc_1006: bitstring = exp(g,Nc_1005) in
                                            {576}let m1_1007: bitstring = (Sess,SPc_1004,gNc_1006) in
                                            {577}event beginCli(Cli,Sess,gNc_1006);
                                            {578}out(c, (pkCli,enc(m1_1007,pkSess_1001),sign(h(m1_1007),skCli)));
                                            {579}in(c, (ePartS_1008: bitstring,sigPartS_1009: bitstring));
                                            {580}let (=Cli,PartS_1010: bitstring) = dec(ePartS_1008,skCli) in
                                            {581}if (verify(h((Cli,PartS_1010)),sigPartS_1009,pkSess_1001) <> true) then
                                                0
                                            else
                                                {582}event endCli(Sess,Cli,PartS_1010)
                                )
                                else
                                    {583}let pkSess_1011: bitstring = fail-any in
                                    {584}out(c, GetEndpointRequest);
                                    {585}in(c, (SPs_1012: bitstring,=SignAndEncrypt,UP_1013: bitstring,=pkSess_1011));
                                    {586}new SPc_1014: bitstring;
                                    {587}new Nc_1015: bitstring;
                                    {588}let gNc_1016: bitstring = exp(g,Nc_1015) in
                                    {589}let m1_1017: bitstring = (Sess,SPc_1014,gNc_1016) in
                                    {590}event beginCli(Cli,Sess,gNc_1016);
                                    {591}out(c, (pkCli,enc(m1_1017,pkSess_1011),sign(h(m1_1017),skCli)));
                                    {592}in(c, (ePartS_1018: bitstring,sigPartS_1019: bitstring));
                                    {593}let (=Cli,PartS_1020: bitstring) = dec(ePartS_1018,skCli) in
                                    {594}if (verify(h((Cli,PartS_1020)),sigPartS_1019,pkSess_1011) <> true) then
                                        0
                                    else
                                        {595}event endCli(Sess,Cli,PartS_1020)
                        )
                        else
                            {596}let pkSess_1021: bitstring = fail-any in
                            {597}out(c, GetEndpointRequest);
                            {598}in(c, (SPs_1022: bitstring,=SignAndEncrypt,UP_1023: bitstring,=pkSess_1021));
                            {599}new SPc_1024: bitstring;
                            {600}new Nc_1025: bitstring;
                            {601}let gNc_1026: bitstring = exp(g,Nc_1025) in
                            {602}let m1_1027: bitstring = (Sess,SPc_1024,gNc_1026) in
                            {603}event beginCli(Cli,Sess,gNc_1026);
                            {604}out(c, (pkCli,enc(m1_1027,pkSess_1021),sign(h(m1_1027),skCli)));
                            {605}in(c, (ePartS_1028: bitstring,sigPartS_1029: bitstring));
                            {606}let (=Cli,PartS_1030: bitstring) = dec(ePartS_1028,skCli) in
                            {607}if (verify(h((Cli,PartS_1030)),sigPartS_1029,pkSess_1021) <> true) then
                                0
                            else
                                {608}event endCli(Sess,Cli,PartS_1030)
            )
            else
                {609}let pkDisco_1031: bitstring = fail-any in
                {610}let v_1032: bool = (Sess = A) in
                (
                    {611}if v_1032 then
                    (
                        {612}let pkSess_1033: bitstring = pub(skA) in
                        {613}out(c, GetEndpointRequest);
                        {614}in(c, (SPs_1034: bitstring,=SignAndEncrypt,UP_1035: bitstring,=pkSess_1033));
                        {615}new SPc_1036: bitstring;
                        {616}new Nc_1037: bitstring;
                        {617}let gNc_1038: bitstring = exp(g,Nc_1037) in
                        {618}let m1_1039: bitstring = (Sess,SPc_1036,gNc_1038) in
                        {619}event beginCli(Cli,Sess,gNc_1038);
                        {620}out(c, (pkCli,enc(m1_1039,pkSess_1033),sign(h(m1_1039),skCli)));
                        {621}in(c, (ePartS_1040: bitstring,sigPartS_1041: bitstring));
                        {622}let (=Cli,PartS_1042: bitstring) = dec(ePartS_1040,skCli) in
                        {623}if (verify(h((Cli,PartS_1042)),sigPartS_1041,pkSess_1033) <> true) then
                            0
                        else
                            {624}event endCli(Sess,Cli,PartS_1042)
                    )
                    else
                        {625}let v_1043: bool = (Sess = B) in
                        (
                            {626}if v_1043 then
                            (
                                {627}let pkSess_1044: bitstring = pub(skB) in
                                {628}out(c, GetEndpointRequest);
                                {629}in(c, (SPs_1045: bitstring,=SignAndEncrypt,UP_1046: bitstring,=pkSess_1044));
                                {630}new SPc_1047: bitstring;
                                {631}new Nc_1048: bitstring;
                                {632}let gNc_1049: bitstring = exp(g,Nc_1048) in
                                {633}let m1_1050: bitstring = (Sess,SPc_1047,gNc_1049) in
                                {634}event beginCli(Cli,Sess,gNc_1049);
                                {635}out(c, (pkCli,enc(m1_1050,pkSess_1044),sign(h(m1_1050),skCli)));
                                {636}in(c, (ePartS_1051: bitstring,sigPartS_1052: bitstring));
                                {637}let (=Cli,PartS_1053: bitstring) = dec(ePartS_1051,skCli) in
                                {638}if (verify(h((Cli,PartS_1053)),sigPartS_1052,pkSess_1044) <> true) then
                                    0
                                else
                                    {639}event endCli(Sess,Cli,PartS_1053)
                            )
                            else
                                {640}let v_1054: bool = (Sess = C) in
                                (
                                    {641}if v_1054 then
                                    (
                                        {642}let pkSess_1055: bitstring = pub(skC) in
                                        {643}out(c, GetEndpointRequest);
                                        {644}in(c, (SPs_1056: bitstring,=SignAndEncrypt,UP_1057: bitstring,=pkSess_1055));
                                        {645}new SPc_1058: bitstring;
                                        {646}new Nc_1059: bitstring;
                                        {647}let gNc_1060: bitstring = exp(g,Nc_1059) in
                                        {648}let m1_1061: bitstring = (Sess,SPc_1058,gNc_1060) in
                                        {649}event beginCli(Cli,Sess,gNc_1060);
                                        {650}out(c, (pkCli,enc(m1_1061,pkSess_1055),sign(h(m1_1061),skCli)));
                                        {651}in(c, (ePartS_1062: bitstring,sigPartS_1063: bitstring));
                                        {652}let (=Cli,PartS_1064: bitstring) = dec(ePartS_1062,skCli) in
                                        {653}if (verify(h((Cli,PartS_1064)),sigPartS_1063,pkSess_1055) <> true) then
                                            0
                                        else
                                            {654}event endCli(Sess,Cli,PartS_1064)
                                    )
                                    else
                                        {655}let pkSess_1065: bitstring = pub(skI) in
                                        {656}out(c, GetEndpointRequest);
                                        {657}in(c, (SPs_1066: bitstring,=SignAndEncrypt,UP_1067: bitstring,=pkSess_1065));
                                        {658}new SPc_1068: bitstring;
                                        {659}new Nc_1069: bitstring;
                                        {660}let gNc_1070: bitstring = exp(g,Nc_1069) in
                                        {661}let m1_1071: bitstring = (Sess,SPc_1068,gNc_1070) in
                                        {662}event beginCli(Cli,Sess,gNc_1070);
                                        {663}out(c, (pkCli,enc(m1_1071,pkSess_1065),sign(h(m1_1071),skCli)));
                                        {664}in(c, (ePartS_1072: bitstring,sigPartS_1073: bitstring));
                                        {665}let (=Cli,PartS_1074: bitstring) = dec(ePartS_1072,skCli) in
                                        {666}if (verify(h((Cli,PartS_1074)),sigPartS_1073,pkSess_1065) <> true) then
                                            0
                                        else
                                            {667}event endCli(Sess,Cli,PartS_1074)
                                )
                                else
                                    {668}let pkSess_1075: bitstring = fail-any in
                                    {669}out(c, GetEndpointRequest);
                                    {670}in(c, (SPs_1076: bitstring,=SignAndEncrypt,UP_1077: bitstring,=pkSess_1075));
                                    {671}new SPc_1078: bitstring;
                                    {672}new Nc_1079: bitstring;
                                    {673}let gNc_1080: bitstring = exp(g,Nc_1079) in
                                    {674}let m1_1081: bitstring = (Sess,SPc_1078,gNc_1080) in
                                    {675}event beginCli(Cli,Sess,gNc_1080);
                                    {676}out(c, (pkCli,enc(m1_1081,pkSess_1075),sign(h(m1_1081),skCli)));
                                    {677}in(c, (ePartS_1082: bitstring,sigPartS_1083: bitstring));
                                    {678}let (=Cli,PartS_1084: bitstring) = dec(ePartS_1082,skCli) in
                                    {679}if (verify(h((Cli,PartS_1084)),sigPartS_1083,pkSess_1075) <> true) then
                                        0
                                    else
                                        {680}event endCli(Sess,Cli,PartS_1084)
                        )
                        else
                            {681}let pkSess_1085: bitstring = fail-any in
                            {682}out(c, GetEndpointRequest);
                            {683}in(c, (SPs_1086: bitstring,=SignAndEncrypt,UP_1087: bitstring,=pkSess_1085));
                            {684}new SPc_1088: bitstring;
                            {685}new Nc_1089: bitstring;
                            {686}let gNc_1090: bitstring = exp(g,Nc_1089) in
                            {687}let m1_1091: bitstring = (Sess,SPc_1088,gNc_1090) in
                            {688}event beginCli(Cli,Sess,gNc_1090);
                            {689}out(c, (pkCli,enc(m1_1091,pkSess_1085),sign(h(m1_1091),skCli)));
                            {690}in(c, (ePartS_1092: bitstring,sigPartS_1093: bitstring));
                            {691}let (=Cli,PartS_1094: bitstring) = dec(ePartS_1092,skCli) in
                            {692}if (verify(h((Cli,PartS_1094)),sigPartS_1093,pkSess_1085) <> true) then
                                0
                            else
                                {693}event endCli(Sess,Cli,PartS_1094)
                )
                else
                    {694}let pkSess_1095: bitstring = fail-any in
                    {695}out(c, GetEndpointRequest);
                    {696}in(c, (SPs_1096: bitstring,=SignAndEncrypt,UP_1097: bitstring,=pkSess_1095));
                    {697}new SPc_1098: bitstring;
                    {698}new Nc_1099: bitstring;
                    {699}let gNc_1100: bitstring = exp(g,Nc_1099) in
                    {700}let m1_1101: bitstring = (Sess,SPc_1098,gNc_1100) in
                    {701}event beginCli(Cli,Sess,gNc_1100);
                    {702}out(c, (pkCli,enc(m1_1101,pkSess_1095),sign(h(m1_1101),skCli)));
                    {703}in(c, (ePartS_1102: bitstring,sigPartS_1103: bitstring));
                    {704}let (=Cli,PartS_1104: bitstring) = dec(ePartS_1102,skCli) in
                    {705}if (verify(h((Cli,PartS_1104)),sigPartS_1103,pkSess_1095) <> true) then
                        0
                    else
                        {706}event endCli(Sess,Cli,PartS_1104)
        )
        else
            {707}let v_1105: bool = (Cli = B) in
            (
                {708}if v_1105 then
                (
                    {709}let skCli_1106: bitstring = skB in
                    {710}let pkCli_1107: bitstring = pub(skCli_1106) in
                    {711}let v_1108: bool = (Disco = A) in
                    (
                        {712}if v_1108 then
                        (
                            {713}let pkDisco_1109: bitstring = pub(skA) in
                            {714}let v_1110: bool = (Sess = A) in
                            (
                                {715}if v_1110 then
                                (
                                    {716}let pkSess_1111: bitstring = pub(skA) in
                                    {717}out(c, GetEndpointRequest);
                                    {718}in(c, (SPs_1112: bitstring,=SignAndEncrypt,UP_1113: bitstring,=pkSess_1111));
                                    {719}new SPc_1114: bitstring;
                                    {720}new Nc_1115: bitstring;
                                    {721}let gNc_1116: bitstring = exp(g,Nc_1115) in
                                    {722}let m1_1117: bitstring = (Sess,SPc_1114,gNc_1116) in
                                    {723}event beginCli(Cli,Sess,gNc_1116);
                                    {724}out(c, (pkCli_1107,enc(m1_1117,pkSess_1111),sign(h(m1_1117),skCli_1106)));
                                    {725}in(c, (ePartS_1118: bitstring,sigPartS_1119: bitstring));
                                    {726}let (=Cli,PartS_1120: bitstring) = dec(ePartS_1118,skCli_1106) in
                                    {727}if (verify(h((Cli,PartS_1120)),sigPartS_1119,pkSess_1111) <> true) then
                                        0
                                    else
                                        {728}event endCli(Sess,Cli,PartS_1120)
                                )
                                else
                                    {729}let v_1121: bool = (Sess = B) in
                                    (
                                        {730}if v_1121 then
                                        (
                                            {731}let pkSess_1122: bitstring = pub(skB) in
                                            {732}out(c, GetEndpointRequest);
                                            {733}in(c, (SPs_1123: bitstring,=SignAndEncrypt,UP_1124: bitstring,=pkSess_1122));
                                            {734}new SPc_1125: bitstring;
                                            {735}new Nc_1126: bitstring;
                                            {736}let gNc_1127: bitstring = exp(g,Nc_1126) in
                                            {737}let m1_1128: bitstring = (Sess,SPc_1125,gNc_1127) in
                                            {738}event beginCli(Cli,Sess,gNc_1127);
                                            {739}out(c, (pkCli_1107,enc(m1_1128,pkSess_1122),sign(h(m1_1128),skCli_1106)));
                                            {740}in(c, (ePartS_1129: bitstring,sigPartS_1130: bitstring));
                                            {741}let (=Cli,PartS_1131: bitstring) = dec(ePartS_1129,skCli_1106) in
                                            {742}if (verify(h((Cli,PartS_1131)),sigPartS_1130,pkSess_1122) <> true) then
                                                0
                                            else
                                                {743}event endCli(Sess,Cli,PartS_1131)
                                        )
                                        else
                                            {744}let v_1132: bool = (Sess = C) in
                                            (
                                                {745}if v_1132 then
                                                (
                                                    {746}let pkSess_1133: bitstring = pub(skC) in
                                                    {747}out(c, GetEndpointRequest);
                                                    {748}in(c, (SPs_1134: bitstring,=SignAndEncrypt,UP_1135: bitstring,=pkSess_1133));
                                                    {749}new SPc_1136: bitstring;
                                                    {750}new Nc_1137: bitstring;
                                                    {751}let gNc_1138: bitstring = exp(g,Nc_1137) in
                                                    {752}let m1_1139: bitstring = (Sess,SPc_1136,gNc_1138) in
                                                    {753}event beginCli(Cli,Sess,gNc_1138);
                                                    {754}out(c, (pkCli_1107,enc(m1_1139,pkSess_1133),sign(h(m1_1139),skCli_1106)));
                                                    {755}in(c, (ePartS_1140: bitstring,sigPartS_1141: bitstring));
                                                    {756}let (=Cli,PartS_1142: bitstring) = dec(ePartS_1140,skCli_1106) in
                                                    {757}if (verify(h((Cli,PartS_1142)),sigPartS_1141,pkSess_1133) <> true) then
                                                        0
                                                    else
                                                        {758}event endCli(Sess,Cli,PartS_1142)
                                                )
                                                else
                                                    {759}let pkSess_1143: bitstring = pub(skI) in
                                                    {760}out(c, GetEndpointRequest);
                                                    {761}in(c, (SPs_1144: bitstring,=SignAndEncrypt,UP_1145: bitstring,=pkSess_1143));
                                                    {762}new SPc_1146: bitstring;
                                                    {763}new Nc_1147: bitstring;
                                                    {764}let gNc_1148: bitstring = exp(g,Nc_1147) in
                                                    {765}let m1_1149: bitstring = (Sess,SPc_1146,gNc_1148) in
                                                    {766}event beginCli(Cli,Sess,gNc_1148);
                                                    {767}out(c, (pkCli_1107,enc(m1_1149,pkSess_1143),sign(h(m1_1149),skCli_1106)));
                                                    {768}in(c, (ePartS_1150: bitstring,sigPartS_1151: bitstring));
                                                    {769}let (=Cli,PartS_1152: bitstring) = dec(ePartS_1150,skCli_1106) in
                                                    {770}if (verify(h((Cli,PartS_1152)),sigPartS_1151,pkSess_1143) <> true) then
                                                        0
                                                    else
                                                        {771}event endCli(Sess,Cli,PartS_1152)
                                            )
                                            else
                                                {772}let pkSess_1153: bitstring = fail-any in
                                                {773}out(c, GetEndpointRequest);
                                                {774}in(c, (SPs_1154: bitstring,=SignAndEncrypt,UP_1155: bitstring,=pkSess_1153));
                                                {775}new SPc_1156: bitstring;
                                                {776}new Nc_1157: bitstring;
                                                {777}let gNc_1158: bitstring = exp(g,Nc_1157) in
                                                {778}let m1_1159: bitstring = (Sess,SPc_1156,gNc_1158) in
                                                {779}event beginCli(Cli,Sess,gNc_1158);
                                                {780}out(c, (pkCli_1107,enc(m1_1159,pkSess_1153),sign(h(m1_1159),skCli_1106)));
                                                {781}in(c, (ePartS_1160: bitstring,sigPartS_1161: bitstring));
                                                {782}let (=Cli,PartS_1162: bitstring) = dec(ePartS_1160,skCli_1106) in
                                                {783}if (verify(h((Cli,PartS_1162)),sigPartS_1161,pkSess_1153) <> true) then
                                                    0
                                                else
                                                    {784}event endCli(Sess,Cli,PartS_1162)
                                    )
                                    else
                                        {785}let pkSess_1163: bitstring = fail-any in
                                        {786}out(c, GetEndpointRequest);
                                        {787}in(c, (SPs_1164: bitstring,=SignAndEncrypt,UP_1165: bitstring,=pkSess_1163));
                                        {788}new SPc_1166: bitstring;
                                        {789}new Nc_1167: bitstring;
                                        {790}let gNc_1168: bitstring = exp(g,Nc_1167) in
                                        {791}let m1_1169: bitstring = (Sess,SPc_1166,gNc_1168) in
                                        {792}event beginCli(Cli,Sess,gNc_1168);
                                        {793}out(c, (pkCli_1107,enc(m1_1169,pkSess_1163),sign(h(m1_1169),skCli_1106)));
                                        {794}in(c, (ePartS_1170: bitstring,sigPartS_1171: bitstring));
                                        {795}let (=Cli,PartS_1172: bitstring) = dec(ePartS_1170,skCli_1106) in
                                        {796}if (verify(h((Cli,PartS_1172)),sigPartS_1171,pkSess_1163) <> true) then
                                            0
                                        else
                                            {797}event endCli(Sess,Cli,PartS_1172)
                            )
                            else
                                {798}let pkSess_1173: bitstring = fail-any in
                                {799}out(c, GetEndpointRequest);
                                {800}in(c, (SPs_1174: bitstring,=SignAndEncrypt,UP_1175: bitstring,=pkSess_1173));
                                {801}new SPc_1176: bitstring;
                                {802}new Nc_1177: bitstring;
                                {803}let gNc_1178: bitstring = exp(g,Nc_1177) in
                                {804}let m1_1179: bitstring = (Sess,SPc_1176,gNc_1178) in
                                {805}event beginCli(Cli,Sess,gNc_1178);
                                {806}out(c, (pkCli_1107,enc(m1_1179,pkSess_1173),sign(h(m1_1179),skCli_1106)));
                                {807}in(c, (ePartS_1180: bitstring,sigPartS_1181: bitstring));
                                {808}let (=Cli,PartS_1182: bitstring) = dec(ePartS_1180,skCli_1106) in
                                {809}if (verify(h((Cli,PartS_1182)),sigPartS_1181,pkSess_1173) <> true) then
                                    0
                                else
                                    {810}event endCli(Sess,Cli,PartS_1182)
                        )
                        else
                            {811}let v_1183: bool = (Disco = B) in
                            (
                                {812}if v_1183 then
                                (
                                    {813}let pkDisco_1184: bitstring = pub(skB) in
                                    {814}let v_1185: bool = (Sess = A) in
                                    (
                                        {815}if v_1185 then
                                        (
                                            {816}let pkSess_1186: bitstring = pub(skA) in
                                            {817}out(c, GetEndpointRequest);
                                            {818}in(c, (SPs_1187: bitstring,=SignAndEncrypt,UP_1188: bitstring,=pkSess_1186));
                                            {819}new SPc_1189: bitstring;
                                            {820}new Nc_1190: bitstring;
                                            {821}let gNc_1191: bitstring = exp(g,Nc_1190) in
                                            {822}let m1_1192: bitstring = (Sess,SPc_1189,gNc_1191) in
                                            {823}event beginCli(Cli,Sess,gNc_1191);
                                            {824}out(c, (pkCli_1107,enc(m1_1192,pkSess_1186),sign(h(m1_1192),skCli_1106)));
                                            {825}in(c, (ePartS_1193: bitstring,sigPartS_1194: bitstring));
                                            {826}let (=Cli,PartS_1195: bitstring) = dec(ePartS_1193,skCli_1106) in
                                            {827}if (verify(h((Cli,PartS_1195)),sigPartS_1194,pkSess_1186) <> true) then
                                                0
                                            else
                                                {828}event endCli(Sess,Cli,PartS_1195)
                                        )
                                        else
                                            {829}let v_1196: bool = (Sess = B) in
                                            (
                                                {830}if v_1196 then
                                                (
                                                    {831}let pkSess_1197: bitstring = pub(skB) in
                                                    {832}out(c, GetEndpointRequest);
                                                    {833}in(c, (SPs_1198: bitstring,=SignAndEncrypt,UP_1199: bitstring,=pkSess_1197));
                                                    {834}new SPc_1200: bitstring;
                                                    {835}new Nc_1201: bitstring;
                                                    {836}let gNc_1202: bitstring = exp(g,Nc_1201) in
                                                    {837}let m1_1203: bitstring = (Sess,SPc_1200,gNc_1202) in
                                                    {838}event beginCli(Cli,Sess,gNc_1202);
                                                    {839}out(c, (pkCli_1107,enc(m1_1203,pkSess_1197),sign(h(m1_1203),skCli_1106)));
                                                    {840}in(c, (ePartS_1204: bitstring,sigPartS_1205: bitstring));
                                                    {841}let (=Cli,PartS_1206: bitstring) = dec(ePartS_1204,skCli_1106) in
                                                    {842}if (verify(h((Cli,PartS_1206)),sigPartS_1205,pkSess_1197) <> true) then
                                                        0
                                                    else
                                                        {843}event endCli(Sess,Cli,PartS_1206)
                                                )
                                                else
                                                    {844}let v_1207: bool = (Sess = C) in
                                                    (
                                                        {845}if v_1207 then
                                                        (
                                                            {846}let pkSess_1208: bitstring = pub(skC) in
                                                            {847}out(c, GetEndpointRequest);
                                                            {848}in(c, (SPs_1209: bitstring,=SignAndEncrypt,UP_1210: bitstring,=pkSess_1208));
                                                            {849}new SPc_1211: bitstring;
                                                            {850}new Nc_1212: bitstring;
                                                            {851}let gNc_1213: bitstring = exp(g,Nc_1212) in
                                                            {852}let m1_1214: bitstring = (Sess,SPc_1211,gNc_1213) in
                                                            {853}event beginCli(Cli,Sess,gNc_1213);
                                                            {854}out(c, (pkCli_1107,enc(m1_1214,pkSess_1208),sign(h(m1_1214),skCli_1106)));
                                                            {855}in(c, (ePartS_1215: bitstring,sigPartS_1216: bitstring));
                                                            {856}let (=Cli,PartS_1217: bitstring) = dec(ePartS_1215,skCli_1106) in
                                                            {857}if (verify(h((Cli,PartS_1217)),sigPartS_1216,pkSess_1208) <> true) then
                                                                0
                                                            else
                                                                {858}event endCli(Sess,Cli,PartS_1217)
                                                        )
                                                        else
                                                            {859}let pkSess_1218: bitstring = pub(skI) in
                                                            {860}out(c, GetEndpointRequest);
                                                            {861}in(c, (SPs_1219: bitstring,=SignAndEncrypt,UP_1220: bitstring,=pkSess_1218));
                                                            {862}new SPc_1221: bitstring;
                                                            {863}new Nc_1222: bitstring;
                                                            {864}let gNc_1223: bitstring = exp(g,Nc_1222) in
                                                            {865}let m1_1224: bitstring = (Sess,SPc_1221,gNc_1223) in
                                                            {866}event beginCli(Cli,Sess,gNc_1223);
                                                            {867}out(c, (pkCli_1107,enc(m1_1224,pkSess_1218),sign(h(m1_1224),skCli_1106)));
                                                            {868}in(c, (ePartS_1225: bitstring,sigPartS_1226: bitstring));
                                                            {869}let (=Cli,PartS_1227: bitstring) = dec(ePartS_1225,skCli_1106) in
                                                            {870}if (verify(h((Cli,PartS_1227)),sigPartS_1226,pkSess_1218) <> true) then
                                                                0
                                                            else
                                                                {871}event endCli(Sess,Cli,PartS_1227)
                                                    )
                                                    else
                                                        {872}let pkSess_1228: bitstring = fail-any in
                                                        {873}out(c, GetEndpointRequest);
                                                        {874}in(c, (SPs_1229: bitstring,=SignAndEncrypt,UP_1230: bitstring,=pkSess_1228));
                                                        {875}new SPc_1231: bitstring;
                                                        {876}new Nc_1232: bitstring;
                                                        {877}let gNc_1233: bitstring = exp(g,Nc_1232) in
                                                        {878}let m1_1234: bitstring = (Sess,SPc_1231,gNc_1233) in
                                                        {879}event beginCli(Cli,Sess,gNc_1233);
                                                        {880}out(c, (pkCli_1107,enc(m1_1234,pkSess_1228),sign(h(m1_1234),skCli_1106)));
                                                        {881}in(c, (ePartS_1235: bitstring,sigPartS_1236: bitstring));
                                                        {882}let (=Cli,PartS_1237: bitstring) = dec(ePartS_1235,skCli_1106) in
                                                        {883}if (verify(h((Cli,PartS_1237)),sigPartS_1236,pkSess_1228) <> true) then
                                                            0
                                                        else
                                                            {884}event endCli(Sess,Cli,PartS_1237)
                                            )
                                            else
                                                {885}let pkSess_1238: bitstring = fail-any in
                                                {886}out(c, GetEndpointRequest);
                                                {887}in(c, (SPs_1239: bitstring,=SignAndEncrypt,UP_1240: bitstring,=pkSess_1238));
                                                {888}new SPc_1241: bitstring;
                                                {889}new Nc_1242: bitstring;
                                                {890}let gNc_1243: bitstring = exp(g,Nc_1242) in
                                                {891}let m1_1244: bitstring = (Sess,SPc_1241,gNc_1243) in
                                                {892}event beginCli(Cli,Sess,gNc_1243);
                                                {893}out(c, (pkCli_1107,enc(m1_1244,pkSess_1238),sign(h(m1_1244),skCli_1106)));
                                                {894}in(c, (ePartS_1245: bitstring,sigPartS_1246: bitstring));
                                                {895}let (=Cli,PartS_1247: bitstring) = dec(ePartS_1245,skCli_1106) in
                                                {896}if (verify(h((Cli,PartS_1247)),sigPartS_1246,pkSess_1238) <> true) then
                                                    0
                                                else
                                                    {897}event endCli(Sess,Cli,PartS_1247)
                                    )
                                    else
                                        {898}let pkSess_1248: bitstring = fail-any in
                                        {899}out(c, GetEndpointRequest);
                                        {900}in(c, (SPs_1249: bitstring,=SignAndEncrypt,UP_1250: bitstring,=pkSess_1248));
                                        {901}new SPc_1251: bitstring;
                                        {902}new Nc_1252: bitstring;
                                        {903}let gNc_1253: bitstring = exp(g,Nc_1252) in
                                        {904}let m1_1254: bitstring = (Sess,SPc_1251,gNc_1253) in
                                        {905}event beginCli(Cli,Sess,gNc_1253);
                                        {906}out(c, (pkCli_1107,enc(m1_1254,pkSess_1248),sign(h(m1_1254),skCli_1106)));
                                        {907}in(c, (ePartS_1255: bitstring,sigPartS_1256: bitstring));
                                        {908}let (=Cli,PartS_1257: bitstring) = dec(ePartS_1255,skCli_1106) in
                                        {909}if (verify(h((Cli,PartS_1257)),sigPartS_1256,pkSess_1248) <> true) then
                                            0
                                        else
                                            {910}event endCli(Sess,Cli,PartS_1257)
                                )
                                else
                                    {911}let v_1258: bool = (Disco = C) in
                                    (
                                        {912}if v_1258 then
                                        (
                                            {913}let pkDisco_1259: bitstring = pub(skC) in
                                            {914}let v_1260: bool = (Sess = A) in
                                            (
                                                {915}if v_1260 then
                                                (
                                                    {916}let pkSess_1261: bitstring = pub(skA) in
                                                    {917}out(c, GetEndpointRequest);
                                                    {918}in(c, (SPs_1262: bitstring,=SignAndEncrypt,UP_1263: bitstring,=pkSess_1261));
                                                    {919}new SPc_1264: bitstring;
                                                    {920}new Nc_1265: bitstring;
                                                    {921}let gNc_1266: bitstring = exp(g,Nc_1265) in
                                                    {922}let m1_1267: bitstring = (Sess,SPc_1264,gNc_1266) in
                                                    {923}event beginCli(Cli,Sess,gNc_1266);
                                                    {924}out(c, (pkCli_1107,enc(m1_1267,pkSess_1261),sign(h(m1_1267),skCli_1106)));
                                                    {925}in(c, (ePartS_1268: bitstring,sigPartS_1269: bitstring));
                                                    {926}let (=Cli,PartS_1270: bitstring) = dec(ePartS_1268,skCli_1106) in
                                                    {927}if (verify(h((Cli,PartS_1270)),sigPartS_1269,pkSess_1261) <> true) then
                                                        0
                                                    else
                                                        {928}event endCli(Sess,Cli,PartS_1270)
                                                )
                                                else
                                                    {929}let v_1271: bool = (Sess = B) in
                                                    (
                                                        {930}if v_1271 then
                                                        (
                                                            {931}let pkSess_1272: bitstring = pub(skB) in
                                                            {932}out(c, GetEndpointRequest);
                                                            {933}in(c, (SPs_1273: bitstring,=SignAndEncrypt,UP_1274: bitstring,=pkSess_1272));
                                                            {934}new SPc_1275: bitstring;
                                                            {935}new Nc_1276: bitstring;
                                                            {936}let gNc_1277: bitstring = exp(g,Nc_1276) in
                                                            {937}let m1_1278: bitstring = (Sess,SPc_1275,gNc_1277) in
                                                            {938}event beginCli(Cli,Sess,gNc_1277);
                                                            {939}out(c, (pkCli_1107,enc(m1_1278,pkSess_1272),sign(h(m1_1278),skCli_1106)));
                                                            {940}in(c, (ePartS_1279: bitstring,sigPartS_1280: bitstring));
                                                            {941}let (=Cli,PartS_1281: bitstring) = dec(ePartS_1279,skCli_1106) in
                                                            {942}if (verify(h((Cli,PartS_1281)),sigPartS_1280,pkSess_1272) <> true) then
                                                                0
                                                            else
                                                                {943}event endCli(Sess,Cli,PartS_1281)
                                                        )
                                                        else
                                                            {944}let v_1282: bool = (Sess = C) in
                                                            (
                                                                {945}if v_1282 then
                                                                (
                                                                    {946}let pkSess_1283: bitstring = pub(skC) in
                                                                    {947}out(c, GetEndpointRequest);
                                                                    {948}in(c, (SPs_1284: bitstring,=SignAndEncrypt,UP_1285: bitstring,=pkSess_1283));
                                                                    {949}new SPc_1286: bitstring;
                                                                    {950}new Nc_1287: bitstring;
                                                                    {951}let gNc_1288: bitstring = exp(g,Nc_1287) in
                                                                    {952}let m1_1289: bitstring = (Sess,SPc_1286,gNc_1288) in
                                                                    {953}event beginCli(Cli,Sess,gNc_1288);
                                                                    {954}out(c, (pkCli_1107,enc(m1_1289,pkSess_1283),sign(h(m1_1289),skCli_1106)));
                                                                    {955}in(c, (ePartS_1290: bitstring,sigPartS_1291: bitstring));
                                                                    {956}let (=Cli,PartS_1292: bitstring) = dec(ePartS_1290,skCli_1106) in
                                                                    {957}if (verify(h((Cli,PartS_1292)),sigPartS_1291,pkSess_1283) <> true) then
                                                                        0
                                                                    else
                                                                        {958}event endCli(Sess,Cli,PartS_1292)
                                                                )
                                                                else
                                                                    {959}let pkSess_1293: bitstring = pub(skI) in
                                                                    {960}out(c, GetEndpointRequest);
                                                                    {961}in(c, (SPs_1294: bitstring,=SignAndEncrypt,UP_1295: bitstring,=pkSess_1293));
                                                                    {962}new SPc_1296: bitstring;
                                                                    {963}new Nc_1297: bitstring;
                                                                    {964}let gNc_1298: bitstring = exp(g,Nc_1297) in
                                                                    {965}let m1_1299: bitstring = (Sess,SPc_1296,gNc_1298) in
                                                                    {966}event beginCli(Cli,Sess,gNc_1298);
                                                                    {967}out(c, (pkCli_1107,enc(m1_1299,pkSess_1293),sign(h(m1_1299),skCli_1106)));
                                                                    {968}in(c, (ePartS_1300: bitstring,sigPartS_1301: bitstring));
                                                                    {969}let (=Cli,PartS_1302: bitstring) = dec(ePartS_1300,skCli_1106) in
                                                                    {970}if (verify(h((Cli,PartS_1302)),sigPartS_1301,pkSess_1293) <> true) then
                                                                        0
                                                                    else
                                                                        {971}event endCli(Sess,Cli,PartS_1302)
                                                            )
                                                            else
                                                                {972}let pkSess_1303: bitstring = fail-any in
                                                                {973}out(c, GetEndpointRequest);
                                                                {974}in(c, (SPs_1304: bitstring,=SignAndEncrypt,UP_1305: bitstring,=pkSess_1303));
                                                                {975}new SPc_1306: bitstring;
                                                                {976}new Nc_1307: bitstring;
                                                                {977}let gNc_1308: bitstring = exp(g,Nc_1307) in
                                                                {978}let m1_1309: bitstring = (Sess,SPc_1306,gNc_1308) in
                                                                {979}event beginCli(Cli,Sess,gNc_1308);
                                                                {980}out(c, (pkCli_1107,enc(m1_1309,pkSess_1303),sign(h(m1_1309),skCli_1106)));
                                                                {981}in(c, (ePartS_1310: bitstring,sigPartS_1311: bitstring));
                                                                {982}let (=Cli,PartS_1312: bitstring) = dec(ePartS_1310,skCli_1106) in
                                                                {983}if (verify(h((Cli,PartS_1312)),sigPartS_1311,pkSess_1303) <> true) then
                                                                    0
                                                                else
                                                                    {984}event endCli(Sess,Cli,PartS_1312)
                                                    )
                                                    else
                                                        {985}let pkSess_1313: bitstring = fail-any in
                                                        {986}out(c, GetEndpointRequest);
                                                        {987}in(c, (SPs_1314: bitstring,=SignAndEncrypt,UP_1315: bitstring,=pkSess_1313));
                                                        {988}new SPc_1316: bitstring;
                                                        {989}new Nc_1317: bitstring;
                                                        {990}let gNc_1318: bitstring = exp(g,Nc_1317) in
                                                        {991}let m1_1319: bitstring = (Sess,SPc_1316,gNc_1318) in
                                                        {992}event beginCli(Cli,Sess,gNc_1318);
                                                        {993}out(c, (pkCli_1107,enc(m1_1319,pkSess_1313),sign(h(m1_1319),skCli_1106)));
                                                        {994}in(c, (ePartS_1320: bitstring,sigPartS_1321: bitstring));
                                                        {995}let (=Cli,PartS_1322: bitstring) = dec(ePartS_1320,skCli_1106) in
                                                        {996}if (verify(h((Cli,PartS_1322)),sigPartS_1321,pkSess_1313) <> true) then
                                                            0
                                                        else
                                                            {997}event endCli(Sess,Cli,PartS_1322)
                                            )
                                            else
                                                {998}let pkSess_1323: bitstring = fail-any in
                                                {999}out(c, GetEndpointRequest);
                                                {1000}in(c, (SPs_1324: bitstring,=SignAndEncrypt,UP_1325: bitstring,=pkSess_1323));
                                                {1001}new SPc_1326: bitstring;
                                                {1002}new Nc_1327: bitstring;
                                                {1003}let gNc_1328: bitstring = exp(g,Nc_1327) in
                                                {1004}let m1_1329: bitstring = (Sess,SPc_1326,gNc_1328) in
                                                {1005}event beginCli(Cli,Sess,gNc_1328);
                                                {1006}out(c, (pkCli_1107,enc(m1_1329,pkSess_1323),sign(h(m1_1329),skCli_1106)));
                                                {1007}in(c, (ePartS_1330: bitstring,sigPartS_1331: bitstring));
                                                {1008}let (=Cli,PartS_1332: bitstring) = dec(ePartS_1330,skCli_1106) in
                                                {1009}if (verify(h((Cli,PartS_1332)),sigPartS_1331,pkSess_1323) <> true) then
                                                    0
                                                else
                                                    {1010}event endCli(Sess,Cli,PartS_1332)
                                        )
                                        else
                                            {1011}let pkDisco_1333: bitstring = pub(skI) in
                                            {1012}let v_1334: bool = (Sess = A) in
                                            (
                                                {1013}if v_1334 then
                                                (
                                                    {1014}let pkSess_1335: bitstring = pub(skA) in
                                                    {1015}out(c, GetEndpointRequest);
                                                    {1016}in(c, (SPs_1336: bitstring,=SignAndEncrypt,UP_1337: bitstring,=pkSess_1335));
                                                    {1017}new SPc_1338: bitstring;
                                                    {1018}new Nc_1339: bitstring;
                                                    {1019}let gNc_1340: bitstring = exp(g,Nc_1339) in
                                                    {1020}let m1_1341: bitstring = (Sess,SPc_1338,gNc_1340) in
                                                    {1021}event beginCli(Cli,Sess,gNc_1340);
                                                    {1022}out(c, (pkCli_1107,enc(m1_1341,pkSess_1335),sign(h(m1_1341),skCli_1106)));
                                                    {1023}in(c, (ePartS_1342: bitstring,sigPartS_1343: bitstring));
                                                    {1024}let (=Cli,PartS_1344: bitstring) = dec(ePartS_1342,skCli_1106) in
                                                    {1025}if (verify(h((Cli,PartS_1344)),sigPartS_1343,pkSess_1335) <> true) then
                                                        0
                                                    else
                                                        {1026}event endCli(Sess,Cli,PartS_1344)
                                                )
                                                else
                                                    {1027}let v_1345: bool = (Sess = B) in
                                                    (
                                                        {1028}if v_1345 then
                                                        (
                                                            {1029}let pkSess_1346: bitstring = pub(skB) in
                                                            {1030}out(c, GetEndpointRequest);
                                                            {1031}in(c, (SPs_1347: bitstring,=SignAndEncrypt,UP_1348: bitstring,=pkSess_1346));
                                                            {1032}new SPc_1349: bitstring;
                                                            {1033}new Nc_1350: bitstring;
                                                            {1034}let gNc_1351: bitstring = exp(g,Nc_1350) in
                                                            {1035}let m1_1352: bitstring = (Sess,SPc_1349,gNc_1351) in
                                                            {1036}event beginCli(Cli,Sess,gNc_1351);
                                                            {1037}out(c, (pkCli_1107,enc(m1_1352,pkSess_1346),sign(h(m1_1352),skCli_1106)));
                                                            {1038}in(c, (ePartS_1353: bitstring,sigPartS_1354: bitstring));
                                                            {1039}let (=Cli,PartS_1355: bitstring) = dec(ePartS_1353,skCli_1106) in
                                                            {1040}if (verify(h((Cli,PartS_1355)),sigPartS_1354,pkSess_1346) <> true) then
                                                                0
                                                            else
                                                                {1041}event endCli(Sess,Cli,PartS_1355)
                                                        )
                                                        else
                                                            {1042}let v_1356: bool = (Sess = C) in
                                                            (
                                                                {1043}if v_1356 then
                                                                (
                                                                    {1044}let pkSess_1357: bitstring = pub(skC) in
                                                                    {1045}out(c, GetEndpointRequest);
                                                                    {1046}in(c, (SPs_1358: bitstring,=SignAndEncrypt,UP_1359: bitstring,=pkSess_1357));
                                                                    {1047}new SPc_1360: bitstring;
                                                                    {1048}new Nc_1361: bitstring;
                                                                    {1049}let gNc_1362: bitstring = exp(g,Nc_1361) in
                                                                    {1050}let m1_1363: bitstring = (Sess,SPc_1360,gNc_1362) in
                                                                    {1051}event beginCli(Cli,Sess,gNc_1362);
                                                                    {1052}out(c, (pkCli_1107,enc(m1_1363,pkSess_1357),sign(h(m1_1363),skCli_1106)));
                                                                    {1053}in(c, (ePartS_1364: bitstring,sigPartS_1365: bitstring));
                                                                    {1054}let (=Cli,PartS_1366: bitstring) = dec(ePartS_1364,skCli_1106) in
                                                                    {1055}if (verify(h((Cli,PartS_1366)),sigPartS_1365,pkSess_1357) <> true) then
                                                                        0
                                                                    else
                                                                        {1056}event endCli(Sess,Cli,PartS_1366)
                                                                )
                                                                else
                                                                    {1057}let pkSess_1367: bitstring = pub(skI) in
                                                                    {1058}out(c, GetEndpointRequest);
                                                                    {1059}in(c, (SPs_1368: bitstring,=SignAndEncrypt,UP_1369: bitstring,=pkSess_1367));
                                                                    {1060}new SPc_1370: bitstring;
                                                                    {1061}new Nc_1371: bitstring;
                                                                    {1062}let gNc_1372: bitstring = exp(g,Nc_1371) in
                                                                    {1063}let m1_1373: bitstring = (Sess,SPc_1370,gNc_1372) in
                                                                    {1064}event beginCli(Cli,Sess,gNc_1372);
                                                                    {1065}out(c, (pkCli_1107,enc(m1_1373,pkSess_1367),sign(h(m1_1373),skCli_1106)));
                                                                    {1066}in(c, (ePartS_1374: bitstring,sigPartS_1375: bitstring));
                                                                    {1067}let (=Cli,PartS_1376: bitstring) = dec(ePartS_1374,skCli_1106) in
                                                                    {1068}if (verify(h((Cli,PartS_1376)),sigPartS_1375,pkSess_1367) <> true) then
                                                                        0
                                                                    else
                                                                        {1069}event endCli(Sess,Cli,PartS_1376)
                                                            )
                                                            else
                                                                {1070}let pkSess_1377: bitstring = fail-any in
                                                                {1071}out(c, GetEndpointRequest);
                                                                {1072}in(c, (SPs_1378: bitstring,=SignAndEncrypt,UP_1379: bitstring,=pkSess_1377));
                                                                {1073}new SPc_1380: bitstring;
                                                                {1074}new Nc_1381: bitstring;
                                                                {1075}let gNc_1382: bitstring = exp(g,Nc_1381) in
                                                                {1076}let m1_1383: bitstring = (Sess,SPc_1380,gNc_1382) in
                                                                {1077}event beginCli(Cli,Sess,gNc_1382);
                                                                {1078}out(c, (pkCli_1107,enc(m1_1383,pkSess_1377),sign(h(m1_1383),skCli_1106)));
                                                                {1079}in(c, (ePartS_1384: bitstring,sigPartS_1385: bitstring));
                                                                {1080}let (=Cli,PartS_1386: bitstring) = dec(ePartS_1384,skCli_1106) in
                                                                {1081}if (verify(h((Cli,PartS_1386)),sigPartS_1385,pkSess_1377) <> true) then
                                                                    0
                                                                else
                                                                    {1082}event endCli(Sess,Cli,PartS_1386)
                                                    )
                                                    else
                                                        {1083}let pkSess_1387: bitstring = fail-any in
                                                        {1084}out(c, GetEndpointRequest);
                                                        {1085}in(c, (SPs_1388: bitstring,=SignAndEncrypt,UP_1389: bitstring,=pkSess_1387));
                                                        {1086}new SPc_1390: bitstring;
                                                        {1087}new Nc_1391: bitstring;
                                                        {1088}let gNc_1392: bitstring = exp(g,Nc_1391) in
                                                        {1089}let m1_1393: bitstring = (Sess,SPc_1390,gNc_1392) in
                                                        {1090}event beginCli(Cli,Sess,gNc_1392);
                                                        {1091}out(c, (pkCli_1107,enc(m1_1393,pkSess_1387),sign(h(m1_1393),skCli_1106)));
                                                        {1092}in(c, (ePartS_1394: bitstring,sigPartS_1395: bitstring));
                                                        {1093}let (=Cli,PartS_1396: bitstring) = dec(ePartS_1394,skCli_1106) in
                                                        {1094}if (verify(h((Cli,PartS_1396)),sigPartS_1395,pkSess_1387) <> true) then
                                                            0
                                                        else
                                                            {1095}event endCli(Sess,Cli,PartS_1396)
                                            )
                                            else
                                                {1096}let pkSess_1397: bitstring = fail-any in
                                                {1097}out(c, GetEndpointRequest);
                                                {1098}in(c, (SPs_1398: bitstring,=SignAndEncrypt,UP_1399: bitstring,=pkSess_1397));
                                                {1099}new SPc_1400: bitstring;
                                                {1100}new Nc_1401: bitstring;
                                                {1101}let gNc_1402: bitstring = exp(g,Nc_1401) in
                                                {1102}let m1_1403: bitstring = (Sess,SPc_1400,gNc_1402) in
                                                {1103}event beginCli(Cli,Sess,gNc_1402);
                                                {1104}out(c, (pkCli_1107,enc(m1_1403,pkSess_1397),sign(h(m1_1403),skCli_1106)));
                                                {1105}in(c, (ePartS_1404: bitstring,sigPartS_1405: bitstring));
                                                {1106}let (=Cli,PartS_1406: bitstring) = dec(ePartS_1404,skCli_1106) in
                                                {1107}if (verify(h((Cli,PartS_1406)),sigPartS_1405,pkSess_1397) <> true) then
                                                    0
                                                else
                                                    {1108}event endCli(Sess,Cli,PartS_1406)
                                    )
                                    else
                                        {1109}let pkDisco_1407: bitstring = fail-any in
                                        {1110}let v_1408: bool = (Sess = A) in
                                        (
                                            {1111}if v_1408 then
                                            (
                                                {1112}let pkSess_1409: bitstring = pub(skA) in
                                                {1113}out(c, GetEndpointRequest);
                                                {1114}in(c, (SPs_1410: bitstring,=SignAndEncrypt,UP_1411: bitstring,=pkSess_1409));
                                                {1115}new SPc_1412: bitstring;
                                                {1116}new Nc_1413: bitstring;
                                                {1117}let gNc_1414: bitstring = exp(g,Nc_1413) in
                                                {1118}let m1_1415: bitstring = (Sess,SPc_1412,gNc_1414) in
                                                {1119}event beginCli(Cli,Sess,gNc_1414);
                                                {1120}out(c, (pkCli_1107,enc(m1_1415,pkSess_1409),sign(h(m1_1415),skCli_1106)));
                                                {1121}in(c, (ePartS_1416: bitstring,sigPartS_1417: bitstring));
                                                {1122}let (=Cli,PartS_1418: bitstring) = dec(ePartS_1416,skCli_1106) in
                                                {1123}if (verify(h((Cli,PartS_1418)),sigPartS_1417,pkSess_1409) <> true) then
                                                    0
                                                else
                                                    {1124}event endCli(Sess,Cli,PartS_1418)
                                            )
                                            else
                                                {1125}let v_1419: bool = (Sess = B) in
                                                (
                                                    {1126}if v_1419 then
                                                    (
                                                        {1127}let pkSess_1420: bitstring = pub(skB) in
                                                        {1128}out(c, GetEndpointRequest);
                                                        {1129}in(c, (SPs_1421: bitstring,=SignAndEncrypt,UP_1422: bitstring,=pkSess_1420));
                                                        {1130}new SPc_1423: bitstring;
                                                        {1131}new Nc_1424: bitstring;
                                                        {1132}let gNc_1425: bitstring = exp(g,Nc_1424) in
                                                        {1133}let m1_1426: bitstring = (Sess,SPc_1423,gNc_1425) in
                                                        {1134}event beginCli(Cli,Sess,gNc_1425);
                                                        {1135}out(c, (pkCli_1107,enc(m1_1426,pkSess_1420),sign(h(m1_1426),skCli_1106)));
                                                        {1136}in(c, (ePartS_1427: bitstring,sigPartS_1428: bitstring));
                                                        {1137}let (=Cli,PartS_1429: bitstring) = dec(ePartS_1427,skCli_1106) in
                                                        {1138}if (verify(h((Cli,PartS_1429)),sigPartS_1428,pkSess_1420) <> true) then
                                                            0
                                                        else
                                                            {1139}event endCli(Sess,Cli,PartS_1429)
                                                    )
                                                    else
                                                        {1140}let v_1430: bool = (Sess = C) in
                                                        (
                                                            {1141}if v_1430 then
                                                            (
                                                                {1142}let pkSess_1431: bitstring = pub(skC) in
                                                                {1143}out(c, GetEndpointRequest);
                                                                {1144}in(c, (SPs_1432: bitstring,=SignAndEncrypt,UP_1433: bitstring,=pkSess_1431));
                                                                {1145}new SPc_1434: bitstring;
                                                                {1146}new Nc_1435: bitstring;
                                                                {1147}let gNc_1436: bitstring = exp(g,Nc_1435) in
                                                                {1148}let m1_1437: bitstring = (Sess,SPc_1434,gNc_1436) in
                                                                {1149}event beginCli(Cli,Sess,gNc_1436);
                                                                {1150}out(c, (pkCli_1107,enc(m1_1437,pkSess_1431),sign(h(m1_1437),skCli_1106)));
                                                                {1151}in(c, (ePartS_1438: bitstring,sigPartS_1439: bitstring));
                                                                {1152}let (=Cli,PartS_1440: bitstring) = dec(ePartS_1438,skCli_1106) in
                                                                {1153}if (verify(h((Cli,PartS_1440)),sigPartS_1439,pkSess_1431) <> true) then
                                                                    0
                                                                else
                                                                    {1154}event endCli(Sess,Cli,PartS_1440)
                                                            )
                                                            else
                                                                {1155}let pkSess_1441: bitstring = pub(skI) in
                                                                {1156}out(c, GetEndpointRequest);
                                                                {1157}in(c, (SPs_1442: bitstring,=SignAndEncrypt,UP_1443: bitstring,=pkSess_1441));
                                                                {1158}new SPc_1444: bitstring;
                                                                {1159}new Nc_1445: bitstring;
                                                                {1160}let gNc_1446: bitstring = exp(g,Nc_1445) in
                                                                {1161}let m1_1447: bitstring = (Sess,SPc_1444,gNc_1446) in
                                                                {1162}event beginCli(Cli,Sess,gNc_1446);
                                                                {1163}out(c, (pkCli_1107,enc(m1_1447,pkSess_1441),sign(h(m1_1447),skCli_1106)));
                                                                {1164}in(c, (ePartS_1448: bitstring,sigPartS_1449: bitstring));
                                                                {1165}let (=Cli,PartS_1450: bitstring) = dec(ePartS_1448,skCli_1106) in
                                                                {1166}if (verify(h((Cli,PartS_1450)),sigPartS_1449,pkSess_1441) <> true) then
                                                                    0
                                                                else
                                                                    {1167}event endCli(Sess,Cli,PartS_1450)
                                                        )
                                                        else
                                                            {1168}let pkSess_1451: bitstring = fail-any in
                                                            {1169}out(c, GetEndpointRequest);
                                                            {1170}in(c, (SPs_1452: bitstring,=SignAndEncrypt,UP_1453: bitstring,=pkSess_1451));
                                                            {1171}new SPc_1454: bitstring;
                                                            {1172}new Nc_1455: bitstring;
                                                            {1173}let gNc_1456: bitstring = exp(g,Nc_1455) in
                                                            {1174}let m1_1457: bitstring = (Sess,SPc_1454,gNc_1456) in
                                                            {1175}event beginCli(Cli,Sess,gNc_1456);
                                                            {1176}out(c, (pkCli_1107,enc(m1_1457,pkSess_1451),sign(h(m1_1457),skCli_1106)));
                                                            {1177}in(c, (ePartS_1458: bitstring,sigPartS_1459: bitstring));
                                                            {1178}let (=Cli,PartS_1460: bitstring) = dec(ePartS_1458,skCli_1106) in
                                                            {1179}if (verify(h((Cli,PartS_1460)),sigPartS_1459,pkSess_1451) <> true) then
                                                                0
                                                            else
                                                                {1180}event endCli(Sess,Cli,PartS_1460)
                                                )
                                                else
                                                    {1181}let pkSess_1461: bitstring = fail-any in
                                                    {1182}out(c, GetEndpointRequest);
                                                    {1183}in(c, (SPs_1462: bitstring,=SignAndEncrypt,UP_1463: bitstring,=pkSess_1461));
                                                    {1184}new SPc_1464: bitstring;
                                                    {1185}new Nc_1465: bitstring;
                                                    {1186}let gNc_1466: bitstring = exp(g,Nc_1465) in
                                                    {1187}let m1_1467: bitstring = (Sess,SPc_1464,gNc_1466) in
                                                    {1188}event beginCli(Cli,Sess,gNc_1466);
                                                    {1189}out(c, (pkCli_1107,enc(m1_1467,pkSess_1461),sign(h(m1_1467),skCli_1106)));
                                                    {1190}in(c, (ePartS_1468: bitstring,sigPartS_1469: bitstring));
                                                    {1191}let (=Cli,PartS_1470: bitstring) = dec(ePartS_1468,skCli_1106) in
                                                    {1192}if (verify(h((Cli,PartS_1470)),sigPartS_1469,pkSess_1461) <> true) then
                                                        0
                                                    else
                                                        {1193}event endCli(Sess,Cli,PartS_1470)
                                        )
                                        else
                                            {1194}let pkSess_1471: bitstring = fail-any in
                                            {1195}out(c, GetEndpointRequest);
                                            {1196}in(c, (SPs_1472: bitstring,=SignAndEncrypt,UP_1473: bitstring,=pkSess_1471));
                                            {1197}new SPc_1474: bitstring;
                                            {1198}new Nc_1475: bitstring;
                                            {1199}let gNc_1476: bitstring = exp(g,Nc_1475) in
                                            {1200}let m1_1477: bitstring = (Sess,SPc_1474,gNc_1476) in
                                            {1201}event beginCli(Cli,Sess,gNc_1476);
                                            {1202}out(c, (pkCli_1107,enc(m1_1477,pkSess_1471),sign(h(m1_1477),skCli_1106)));
                                            {1203}in(c, (ePartS_1478: bitstring,sigPartS_1479: bitstring));
                                            {1204}let (=Cli,PartS_1480: bitstring) = dec(ePartS_1478,skCli_1106) in
                                            {1205}if (verify(h((Cli,PartS_1480)),sigPartS_1479,pkSess_1471) <> true) then
                                                0
                                            else
                                                {1206}event endCli(Sess,Cli,PartS_1480)
                            )
                            else
                                {1207}let pkDisco_1481: bitstring = fail-any in
                                {1208}let v_1482: bool = (Sess = A) in
                                (
                                    {1209}if v_1482 then
                                    (
                                        {1210}let pkSess_1483: bitstring = pub(skA) in
                                        {1211}out(c, GetEndpointRequest);
                                        {1212}in(c, (SPs_1484: bitstring,=SignAndEncrypt,UP_1485: bitstring,=pkSess_1483));
                                        {1213}new SPc_1486: bitstring;
                                        {1214}new Nc_1487: bitstring;
                                        {1215}let gNc_1488: bitstring = exp(g,Nc_1487) in
                                        {1216}let m1_1489: bitstring = (Sess,SPc_1486,gNc_1488) in
                                        {1217}event beginCli(Cli,Sess,gNc_1488);
                                        {1218}out(c, (pkCli_1107,enc(m1_1489,pkSess_1483),sign(h(m1_1489),skCli_1106)));
                                        {1219}in(c, (ePartS_1490: bitstring,sigPartS_1491: bitstring));
                                        {1220}let (=Cli,PartS_1492: bitstring) = dec(ePartS_1490,skCli_1106) in
                                        {1221}if (verify(h((Cli,PartS_1492)),sigPartS_1491,pkSess_1483) <> true) then
                                            0
                                        else
                                            {1222}event endCli(Sess,Cli,PartS_1492)
                                    )
                                    else
                                        {1223}let v_1493: bool = (Sess = B) in
                                        (
                                            {1224}if v_1493 then
                                            (
                                                {1225}let pkSess_1494: bitstring = pub(skB) in
                                                {1226}out(c, GetEndpointRequest);
                                                {1227}in(c, (SPs_1495: bitstring,=SignAndEncrypt,UP_1496: bitstring,=pkSess_1494));
                                                {1228}new SPc_1497: bitstring;
                                                {1229}new Nc_1498: bitstring;
                                                {1230}let gNc_1499: bitstring = exp(g,Nc_1498) in
                                                {1231}let m1_1500: bitstring = (Sess,SPc_1497,gNc_1499) in
                                                {1232}event beginCli(Cli,Sess,gNc_1499);
                                                {1233}out(c, (pkCli_1107,enc(m1_1500,pkSess_1494),sign(h(m1_1500),skCli_1106)));
                                                {1234}in(c, (ePartS_1501: bitstring,sigPartS_1502: bitstring));
                                                {1235}let (=Cli,PartS_1503: bitstring) = dec(ePartS_1501,skCli_1106) in
                                                {1236}if (verify(h((Cli,PartS_1503)),sigPartS_1502,pkSess_1494) <> true) then
                                                    0
                                                else
                                                    {1237}event endCli(Sess,Cli,PartS_1503)
                                            )
                                            else
                                                {1238}let v_1504: bool = (Sess = C) in
                                                (
                                                    {1239}if v_1504 then
                                                    (
                                                        {1240}let pkSess_1505: bitstring = pub(skC) in
                                                        {1241}out(c, GetEndpointRequest);
                                                        {1242}in(c, (SPs_1506: bitstring,=SignAndEncrypt,UP_1507: bitstring,=pkSess_1505));
                                                        {1243}new SPc_1508: bitstring;
                                                        {1244}new Nc_1509: bitstring;
                                                        {1245}let gNc_1510: bitstring = exp(g,Nc_1509) in
                                                        {1246}let m1_1511: bitstring = (Sess,SPc_1508,gNc_1510) in
                                                        {1247}event beginCli(Cli,Sess,gNc_1510);
                                                        {1248}out(c, (pkCli_1107,enc(m1_1511,pkSess_1505),sign(h(m1_1511),skCli_1106)));
                                                        {1249}in(c, (ePartS_1512: bitstring,sigPartS_1513: bitstring));
                                                        {1250}let (=Cli,PartS_1514: bitstring) = dec(ePartS_1512,skCli_1106) in
                                                        {1251}if (verify(h((Cli,PartS_1514)),sigPartS_1513,pkSess_1505) <> true) then
                                                            0
                                                        else
                                                            {1252}event endCli(Sess,Cli,PartS_1514)
                                                    )
                                                    else
                                                        {1253}let pkSess_1515: bitstring = pub(skI) in
                                                        {1254}out(c, GetEndpointRequest);
                                                        {1255}in(c, (SPs_1516: bitstring,=SignAndEncrypt,UP_1517: bitstring,=pkSess_1515));
                                                        {1256}new SPc_1518: bitstring;
                                                        {1257}new Nc_1519: bitstring;
                                                        {1258}let gNc_1520: bitstring = exp(g,Nc_1519) in
                                                        {1259}let m1_1521: bitstring = (Sess,SPc_1518,gNc_1520) in
                                                        {1260}event beginCli(Cli,Sess,gNc_1520);
                                                        {1261}out(c, (pkCli_1107,enc(m1_1521,pkSess_1515),sign(h(m1_1521),skCli_1106)));
                                                        {1262}in(c, (ePartS_1522: bitstring,sigPartS_1523: bitstring));
                                                        {1263}let (=Cli,PartS_1524: bitstring) = dec(ePartS_1522,skCli_1106) in
                                                        {1264}if (verify(h((Cli,PartS_1524)),sigPartS_1523,pkSess_1515) <> true) then
                                                            0
                                                        else
                                                            {1265}event endCli(Sess,Cli,PartS_1524)
                                                )
                                                else
                                                    {1266}let pkSess_1525: bitstring = fail-any in
                                                    {1267}out(c, GetEndpointRequest);
                                                    {1268}in(c, (SPs_1526: bitstring,=SignAndEncrypt,UP_1527: bitstring,=pkSess_1525));
                                                    {1269}new SPc_1528: bitstring;
                                                    {1270}new Nc_1529: bitstring;
                                                    {1271}let gNc_1530: bitstring = exp(g,Nc_1529) in
                                                    {1272}let m1_1531: bitstring = (Sess,SPc_1528,gNc_1530) in
                                                    {1273}event beginCli(Cli,Sess,gNc_1530);
                                                    {1274}out(c, (pkCli_1107,enc(m1_1531,pkSess_1525),sign(h(m1_1531),skCli_1106)));
                                                    {1275}in(c, (ePartS_1532: bitstring,sigPartS_1533: bitstring));
                                                    {1276}let (=Cli,PartS_1534: bitstring) = dec(ePartS_1532,skCli_1106) in
                                                    {1277}if (verify(h((Cli,PartS_1534)),sigPartS_1533,pkSess_1525) <> true) then
                                                        0
                                                    else
                                                        {1278}event endCli(Sess,Cli,PartS_1534)
                                        )
                                        else
                                            {1279}let pkSess_1535: bitstring = fail-any in
                                            {1280}out(c, GetEndpointRequest);
                                            {1281}in(c, (SPs_1536: bitstring,=SignAndEncrypt,UP_1537: bitstring,=pkSess_1535));
                                            {1282}new SPc_1538: bitstring;
                                            {1283}new Nc_1539: bitstring;
                                            {1284}let gNc_1540: bitstring = exp(g,Nc_1539) in
                                            {1285}let m1_1541: bitstring = (Sess,SPc_1538,gNc_1540) in
                                            {1286}event beginCli(Cli,Sess,gNc_1540);
                                            {1287}out(c, (pkCli_1107,enc(m1_1541,pkSess_1535),sign(h(m1_1541),skCli_1106)));
                                            {1288}in(c, (ePartS_1542: bitstring,sigPartS_1543: bitstring));
                                            {1289}let (=Cli,PartS_1544: bitstring) = dec(ePartS_1542,skCli_1106) in
                                            {1290}if (verify(h((Cli,PartS_1544)),sigPartS_1543,pkSess_1535) <> true) then
                                                0
                                            else
                                                {1291}event endCli(Sess,Cli,PartS_1544)
                                )
                                else
                                    {1292}let pkSess_1545: bitstring = fail-any in
                                    {1293}out(c, GetEndpointRequest);
                                    {1294}in(c, (SPs_1546: bitstring,=SignAndEncrypt,UP_1547: bitstring,=pkSess_1545));
                                    {1295}new SPc_1548: bitstring;
                                    {1296}new Nc_1549: bitstring;
                                    {1297}let gNc_1550: bitstring = exp(g,Nc_1549) in
                                    {1298}let m1_1551: bitstring = (Sess,SPc_1548,gNc_1550) in
                                    {1299}event beginCli(Cli,Sess,gNc_1550);
                                    {1300}out(c, (pkCli_1107,enc(m1_1551,pkSess_1545),sign(h(m1_1551),skCli_1106)));
                                    {1301}in(c, (ePartS_1552: bitstring,sigPartS_1553: bitstring));
                                    {1302}let (=Cli,PartS_1554: bitstring) = dec(ePartS_1552,skCli_1106) in
                                    {1303}if (verify(h((Cli,PartS_1554)),sigPartS_1553,pkSess_1545) <> true) then
                                        0
                                    else
                                        {1304}event endCli(Sess,Cli,PartS_1554)
                    )
                    else
                        {1305}let pkDisco_1555: bitstring = fail-any in
                        {1306}let v_1556: bool = (Sess = A) in
                        (
                            {1307}if v_1556 then
                            (
                                {1308}let pkSess_1557: bitstring = pub(skA) in
                                {1309}out(c, GetEndpointRequest);
                                {1310}in(c, (SPs_1558: bitstring,=SignAndEncrypt,UP_1559: bitstring,=pkSess_1557));
                                {1311}new SPc_1560: bitstring;
                                {1312}new Nc_1561: bitstring;
                                {1313}let gNc_1562: bitstring = exp(g,Nc_1561) in
                                {1314}let m1_1563: bitstring = (Sess,SPc_1560,gNc_1562) in
                                {1315}event beginCli(Cli,Sess,gNc_1562);
                                {1316}out(c, (pkCli_1107,enc(m1_1563,pkSess_1557),sign(h(m1_1563),skCli_1106)));
                                {1317}in(c, (ePartS_1564: bitstring,sigPartS_1565: bitstring));
                                {1318}let (=Cli,PartS_1566: bitstring) = dec(ePartS_1564,skCli_1106) in
                                {1319}if (verify(h((Cli,PartS_1566)),sigPartS_1565,pkSess_1557) <> true) then
                                    0
                                else
                                    {1320}event endCli(Sess,Cli,PartS_1566)
                            )
                            else
                                {1321}let v_1567: bool = (Sess = B) in
                                (
                                    {1322}if v_1567 then
                                    (
                                        {1323}let pkSess_1568: bitstring = pub(skB) in
                                        {1324}out(c, GetEndpointRequest);
                                        {1325}in(c, (SPs_1569: bitstring,=SignAndEncrypt,UP_1570: bitstring,=pkSess_1568));
                                        {1326}new SPc_1571: bitstring;
                                        {1327}new Nc_1572: bitstring;
                                        {1328}let gNc_1573: bitstring = exp(g,Nc_1572) in
                                        {1329}let m1_1574: bitstring = (Sess,SPc_1571,gNc_1573) in
                                        {1330}event beginCli(Cli,Sess,gNc_1573);
                                        {1331}out(c, (pkCli_1107,enc(m1_1574,pkSess_1568),sign(h(m1_1574),skCli_1106)));
                                        {1332}in(c, (ePartS_1575: bitstring,sigPartS_1576: bitstring));
                                        {1333}let (=Cli,PartS_1577: bitstring) = dec(ePartS_1575,skCli_1106) in
                                        {1334}if (verify(h((Cli,PartS_1577)),sigPartS_1576,pkSess_1568) <> true) then
                                            0
                                        else
                                            {1335}event endCli(Sess,Cli,PartS_1577)
                                    )
                                    else
                                        {1336}let v_1578: bool = (Sess = C) in
                                        (
                                            {1337}if v_1578 then
                                            (
                                                {1338}let pkSess_1579: bitstring = pub(skC) in
                                                {1339}out(c, GetEndpointRequest);
                                                {1340}in(c, (SPs_1580: bitstring,=SignAndEncrypt,UP_1581: bitstring,=pkSess_1579));
                                                {1341}new SPc_1582: bitstring;
                                                {1342}new Nc_1583: bitstring;
                                                {1343}let gNc_1584: bitstring = exp(g,Nc_1583) in
                                                {1344}let m1_1585: bitstring = (Sess,SPc_1582,gNc_1584) in
                                                {1345}event beginCli(Cli,Sess,gNc_1584);
                                                {1346}out(c, (pkCli_1107,enc(m1_1585,pkSess_1579),sign(h(m1_1585),skCli_1106)));
                                                {1347}in(c, (ePartS_1586: bitstring,sigPartS_1587: bitstring));
                                                {1348}let (=Cli,PartS_1588: bitstring) = dec(ePartS_1586,skCli_1106) in
                                                {1349}if (verify(h((Cli,PartS_1588)),sigPartS_1587,pkSess_1579) <> true) then
                                                    0
                                                else
                                                    {1350}event endCli(Sess,Cli,PartS_1588)
                                            )
                                            else
                                                {1351}let pkSess_1589: bitstring = pub(skI) in
                                                {1352}out(c, GetEndpointRequest);
                                                {1353}in(c, (SPs_1590: bitstring,=SignAndEncrypt,UP_1591: bitstring,=pkSess_1589));
                                                {1354}new SPc_1592: bitstring;
                                                {1355}new Nc_1593: bitstring;
                                                {1356}let gNc_1594: bitstring = exp(g,Nc_1593) in
                                                {1357}let m1_1595: bitstring = (Sess,SPc_1592,gNc_1594) in
                                                {1358}event beginCli(Cli,Sess,gNc_1594);
                                                {1359}out(c, (pkCli_1107,enc(m1_1595,pkSess_1589),sign(h(m1_1595),skCli_1106)));
                                                {1360}in(c, (ePartS_1596: bitstring,sigPartS_1597: bitstring));
                                                {1361}let (=Cli,PartS_1598: bitstring) = dec(ePartS_1596,skCli_1106) in
                                                {1362}if (verify(h((Cli,PartS_1598)),sigPartS_1597,pkSess_1589) <> true) then
                                                    0
                                                else
                                                    {1363}event endCli(Sess,Cli,PartS_1598)
                                        )
                                        else
                                            {1364}let pkSess_1599: bitstring = fail-any in
                                            {1365}out(c, GetEndpointRequest);
                                            {1366}in(c, (SPs_1600: bitstring,=SignAndEncrypt,UP_1601: bitstring,=pkSess_1599));
                                            {1367}new SPc_1602: bitstring;
                                            {1368}new Nc_1603: bitstring;
                                            {1369}let gNc_1604: bitstring = exp(g,Nc_1603) in
                                            {1370}let m1_1605: bitstring = (Sess,SPc_1602,gNc_1604) in
                                            {1371}event beginCli(Cli,Sess,gNc_1604);
                                            {1372}out(c, (pkCli_1107,enc(m1_1605,pkSess_1599),sign(h(m1_1605),skCli_1106)));
                                            {1373}in(c, (ePartS_1606: bitstring,sigPartS_1607: bitstring));
                                            {1374}let (=Cli,PartS_1608: bitstring) = dec(ePartS_1606,skCli_1106) in
                                            {1375}if (verify(h((Cli,PartS_1608)),sigPartS_1607,pkSess_1599) <> true) then
                                                0
                                            else
                                                {1376}event endCli(Sess,Cli,PartS_1608)
                                )
                                else
                                    {1377}let pkSess_1609: bitstring = fail-any in
                                    {1378}out(c, GetEndpointRequest);
                                    {1379}in(c, (SPs_1610: bitstring,=SignAndEncrypt,UP_1611: bitstring,=pkSess_1609));
                                    {1380}new SPc_1612: bitstring;
                                    {1381}new Nc_1613: bitstring;
                                    {1382}let gNc_1614: bitstring = exp(g,Nc_1613) in
                                    {1383}let m1_1615: bitstring = (Sess,SPc_1612,gNc_1614) in
                                    {1384}event beginCli(Cli,Sess,gNc_1614);
                                    {1385}out(c, (pkCli_1107,enc(m1_1615,pkSess_1609),sign(h(m1_1615),skCli_1106)));
                                    {1386}in(c, (ePartS_1616: bitstring,sigPartS_1617: bitstring));
                                    {1387}let (=Cli,PartS_1618: bitstring) = dec(ePartS_1616,skCli_1106) in
                                    {1388}if (verify(h((Cli,PartS_1618)),sigPartS_1617,pkSess_1609) <> true) then
                                        0
                                    else
                                        {1389}event endCli(Sess,Cli,PartS_1618)
                        )
                        else
                            {1390}let pkSess_1619: bitstring = fail-any in
                            {1391}out(c, GetEndpointRequest);
                            {1392}in(c, (SPs_1620: bitstring,=SignAndEncrypt,UP_1621: bitstring,=pkSess_1619));
                            {1393}new SPc_1622: bitstring;
                            {1394}new Nc_1623: bitstring;
                            {1395}let gNc_1624: bitstring = exp(g,Nc_1623) in
                            {1396}let m1_1625: bitstring = (Sess,SPc_1622,gNc_1624) in
                            {1397}event beginCli(Cli,Sess,gNc_1624);
                            {1398}out(c, (pkCli_1107,enc(m1_1625,pkSess_1619),sign(h(m1_1625),skCli_1106)));
                            {1399}in(c, (ePartS_1626: bitstring,sigPartS_1627: bitstring));
                            {1400}let (=Cli,PartS_1628: bitstring) = dec(ePartS_1626,skCli_1106) in
                            {1401}if (verify(h((Cli,PartS_1628)),sigPartS_1627,pkSess_1619) <> true) then
                                0
                            else
                                {1402}event endCli(Sess,Cli,PartS_1628)
                )
                else
                    {1403}let v_1629: bool = (Cli = C) in
                    (
                        {1404}if v_1629 then
                        (
                            {1405}let skCli_1630: bitstring = skC in
                            {1406}let pkCli_1631: bitstring = pub(skCli_1630) in
                            {1407}let v_1632: bool = (Disco = A) in
                            (
                                {1408}if v_1632 then
                                (
                                    {1409}let pkDisco_1633: bitstring = pub(skA) in
                                    {1410}let v_1634: bool = (Sess = A) in
                                    (
                                        {1411}if v_1634 then
                                        (
                                            {1412}let pkSess_1635: bitstring = pub(skA) in
                                            {1413}out(c, GetEndpointRequest);
                                            {1414}in(c, (SPs_1636: bitstring,=SignAndEncrypt,UP_1637: bitstring,=pkSess_1635));
                                            {1415}new SPc_1638: bitstring;
                                            {1416}new Nc_1639: bitstring;
                                            {1417}let gNc_1640: bitstring = exp(g,Nc_1639) in
                                            {1418}let m1_1641: bitstring = (Sess,SPc_1638,gNc_1640) in
                                            {1419}event beginCli(Cli,Sess,gNc_1640);
                                            {1420}out(c, (pkCli_1631,enc(m1_1641,pkSess_1635),sign(h(m1_1641),skCli_1630)));
                                            {1421}in(c, (ePartS_1642: bitstring,sigPartS_1643: bitstring));
                                            {1422}let (=Cli,PartS_1644: bitstring) = dec(ePartS_1642,skCli_1630) in
                                            {1423}if (verify(h((Cli,PartS_1644)),sigPartS_1643,pkSess_1635) <> true) then
                                                0
                                            else
                                                {1424}event endCli(Sess,Cli,PartS_1644)
                                        )
                                        else
                                            {1425}let v_1645: bool = (Sess = B) in
                                            (
                                                {1426}if v_1645 then
                                                (
                                                    {1427}let pkSess_1646: bitstring = pub(skB) in
                                                    {1428}out(c, GetEndpointRequest);
                                                    {1429}in(c, (SPs_1647: bitstring,=SignAndEncrypt,UP_1648: bitstring,=pkSess_1646));
                                                    {1430}new SPc_1649: bitstring;
                                                    {1431}new Nc_1650: bitstring;
                                                    {1432}let gNc_1651: bitstring = exp(g,Nc_1650) in
                                                    {1433}let m1_1652: bitstring = (Sess,SPc_1649,gNc_1651) in
                                                    {1434}event beginCli(Cli,Sess,gNc_1651);
                                                    {1435}out(c, (pkCli_1631,enc(m1_1652,pkSess_1646),sign(h(m1_1652),skCli_1630)));
                                                    {1436}in(c, (ePartS_1653: bitstring,sigPartS_1654: bitstring));
                                                    {1437}let (=Cli,PartS_1655: bitstring) = dec(ePartS_1653,skCli_1630) in
                                                    {1438}if (verify(h((Cli,PartS_1655)),sigPartS_1654,pkSess_1646) <> true) then
                                                        0
                                                    else
                                                        {1439}event endCli(Sess,Cli,PartS_1655)
                                                )
                                                else
                                                    {1440}let v_1656: bool = (Sess = C) in
                                                    (
                                                        {1441}if v_1656 then
                                                        (
                                                            {1442}let pkSess_1657: bitstring = pub(skC) in
                                                            {1443}out(c, GetEndpointRequest);
                                                            {1444}in(c, (SPs_1658: bitstring,=SignAndEncrypt,UP_1659: bitstring,=pkSess_1657));
                                                            {1445}new SPc_1660: bitstring;
                                                            {1446}new Nc_1661: bitstring;
                                                            {1447}let gNc_1662: bitstring = exp(g,Nc_1661) in
                                                            {1448}let m1_1663: bitstring = (Sess,SPc_1660,gNc_1662) in
                                                            {1449}event beginCli(Cli,Sess,gNc_1662);
                                                            {1450}out(c, (pkCli_1631,enc(m1_1663,pkSess_1657),sign(h(m1_1663),skCli_1630)));
                                                            {1451}in(c, (ePartS_1664: bitstring,sigPartS_1665: bitstring));
                                                            {1452}let (=Cli,PartS_1666: bitstring) = dec(ePartS_1664,skCli_1630) in
                                                            {1453}if (verify(h((Cli,PartS_1666)),sigPartS_1665,pkSess_1657) <> true) then
                                                                0
                                                            else
                                                                {1454}event endCli(Sess,Cli,PartS_1666)
                                                        )
                                                        else
                                                            {1455}let pkSess_1667: bitstring = pub(skI) in
                                                            {1456}out(c, GetEndpointRequest);
                                                            {1457}in(c, (SPs_1668: bitstring,=SignAndEncrypt,UP_1669: bitstring,=pkSess_1667));
                                                            {1458}new SPc_1670: bitstring;
                                                            {1459}new Nc_1671: bitstring;
                                                            {1460}let gNc_1672: bitstring = exp(g,Nc_1671) in
                                                            {1461}let m1_1673: bitstring = (Sess,SPc_1670,gNc_1672) in
                                                            {1462}event beginCli(Cli,Sess,gNc_1672);
                                                            {1463}out(c, (pkCli_1631,enc(m1_1673,pkSess_1667),sign(h(m1_1673),skCli_1630)));
                                                            {1464}in(c, (ePartS_1674: bitstring,sigPartS_1675: bitstring));
                                                            {1465}let (=Cli,PartS_1676: bitstring) = dec(ePartS_1674,skCli_1630) in
                                                            {1466}if (verify(h((Cli,PartS_1676)),sigPartS_1675,pkSess_1667) <> true) then
                                                                0
                                                            else
                                                                {1467}event endCli(Sess,Cli,PartS_1676)
                                                    )
                                                    else
                                                        {1468}let pkSess_1677: bitstring = fail-any in
                                                        {1469}out(c, GetEndpointRequest);
                                                        {1470}in(c, (SPs_1678: bitstring,=SignAndEncrypt,UP_1679: bitstring,=pkSess_1677));
                                                        {1471}new SPc_1680: bitstring;
                                                        {1472}new Nc_1681: bitstring;
                                                        {1473}let gNc_1682: bitstring = exp(g,Nc_1681) in
                                                        {1474}let m1_1683: bitstring = (Sess,SPc_1680,gNc_1682) in
                                                        {1475}event beginCli(Cli,Sess,gNc_1682);
                                                        {1476}out(c, (pkCli_1631,enc(m1_1683,pkSess_1677),sign(h(m1_1683),skCli_1630)));
                                                        {1477}in(c, (ePartS_1684: bitstring,sigPartS_1685: bitstring));
                                                        {1478}let (=Cli,PartS_1686: bitstring) = dec(ePartS_1684,skCli_1630) in
                                                        {1479}if (verify(h((Cli,PartS_1686)),sigPartS_1685,pkSess_1677) <> true) then
                                                            0
                                                        else
                                                            {1480}event endCli(Sess,Cli,PartS_1686)
                                            )
                                            else
                                                {1481}let pkSess_1687: bitstring = fail-any in
                                                {1482}out(c, GetEndpointRequest);
                                                {1483}in(c, (SPs_1688: bitstring,=SignAndEncrypt,UP_1689: bitstring,=pkSess_1687));
                                                {1484}new SPc_1690: bitstring;
                                                {1485}new Nc_1691: bitstring;
                                                {1486}let gNc_1692: bitstring = exp(g,Nc_1691) in
                                                {1487}let m1_1693: bitstring = (Sess,SPc_1690,gNc_1692) in
                                                {1488}event beginCli(Cli,Sess,gNc_1692);
                                                {1489}out(c, (pkCli_1631,enc(m1_1693,pkSess_1687),sign(h(m1_1693),skCli_1630)));
                                                {1490}in(c, (ePartS_1694: bitstring,sigPartS_1695: bitstring));
                                                {1491}let (=Cli,PartS_1696: bitstring) = dec(ePartS_1694,skCli_1630) in
                                                {1492}if (verify(h((Cli,PartS_1696)),sigPartS_1695,pkSess_1687) <> true) then
                                                    0
                                                else
                                                    {1493}event endCli(Sess,Cli,PartS_1696)
                                    )
                                    else
                                        {1494}let pkSess_1697: bitstring = fail-any in
                                        {1495}out(c, GetEndpointRequest);
                                        {1496}in(c, (SPs_1698: bitstring,=SignAndEncrypt,UP_1699: bitstring,=pkSess_1697));
                                        {1497}new SPc_1700: bitstring;
                                        {1498}new Nc_1701: bitstring;
                                        {1499}let gNc_1702: bitstring = exp(g,Nc_1701) in
                                        {1500}let m1_1703: bitstring = (Sess,SPc_1700,gNc_1702) in
                                        {1501}event beginCli(Cli,Sess,gNc_1702);
                                        {1502}out(c, (pkCli_1631,enc(m1_1703,pkSess_1697),sign(h(m1_1703),skCli_1630)));
                                        {1503}in(c, (ePartS_1704: bitstring,sigPartS_1705: bitstring));
                                        {1504}let (=Cli,PartS_1706: bitstring) = dec(ePartS_1704,skCli_1630) in
                                        {1505}if (verify(h((Cli,PartS_1706)),sigPartS_1705,pkSess_1697) <> true) then
                                            0
                                        else
                                            {1506}event endCli(Sess,Cli,PartS_1706)
                                )
                                else
                                    {1507}let v_1707: bool = (Disco = B) in
                                    (
                                        {1508}if v_1707 then
                                        (
                                            {1509}let pkDisco_1708: bitstring = pub(skB) in
                                            {1510}let v_1709: bool = (Sess = A) in
                                            (
                                                {1511}if v_1709 then
                                                (
                                                    {1512}let pkSess_1710: bitstring = pub(skA) in
                                                    {1513}out(c, GetEndpointRequest);
                                                    {1514}in(c, (SPs_1711: bitstring,=SignAndEncrypt,UP_1712: bitstring,=pkSess_1710));
                                                    {1515}new SPc_1713: bitstring;
                                                    {1516}new Nc_1714: bitstring;
                                                    {1517}let gNc_1715: bitstring = exp(g,Nc_1714) in
                                                    {1518}let m1_1716: bitstring = (Sess,SPc_1713,gNc_1715) in
                                                    {1519}event beginCli(Cli,Sess,gNc_1715);
                                                    {1520}out(c, (pkCli_1631,enc(m1_1716,pkSess_1710),sign(h(m1_1716),skCli_1630)));
                                                    {1521}in(c, (ePartS_1717: bitstring,sigPartS_1718: bitstring));
                                                    {1522}let (=Cli,PartS_1719: bitstring) = dec(ePartS_1717,skCli_1630) in
                                                    {1523}if (verify(h((Cli,PartS_1719)),sigPartS_1718,pkSess_1710) <> true) then
                                                        0
                                                    else
                                                        {1524}event endCli(Sess,Cli,PartS_1719)
                                                )
                                                else
                                                    {1525}let v_1720: bool = (Sess = B) in
                                                    (
                                                        {1526}if v_1720 then
                                                        (
                                                            {1527}let pkSess_1721: bitstring = pub(skB) in
                                                            {1528}out(c, GetEndpointRequest);
                                                            {1529}in(c, (SPs_1722: bitstring,=SignAndEncrypt,UP_1723: bitstring,=pkSess_1721));
                                                            {1530}new SPc_1724: bitstring;
                                                            {1531}new Nc_1725: bitstring;
                                                            {1532}let gNc_1726: bitstring = exp(g,Nc_1725) in
                                                            {1533}let m1_1727: bitstring = (Sess,SPc_1724,gNc_1726) in
                                                            {1534}event beginCli(Cli,Sess,gNc_1726);
                                                            {1535}out(c, (pkCli_1631,enc(m1_1727,pkSess_1721),sign(h(m1_1727),skCli_1630)));
                                                            {1536}in(c, (ePartS_1728: bitstring,sigPartS_1729: bitstring));
                                                            {1537}let (=Cli,PartS_1730: bitstring) = dec(ePartS_1728,skCli_1630) in
                                                            {1538}if (verify(h((Cli,PartS_1730)),sigPartS_1729,pkSess_1721) <> true) then
                                                                0
                                                            else
                                                                {1539}event endCli(Sess,Cli,PartS_1730)
                                                        )
                                                        else
                                                            {1540}let v_1731: bool = (Sess = C) in
                                                            (
                                                                {1541}if v_1731 then
                                                                (
                                                                    {1542}let pkSess_1732: bitstring = pub(skC) in
                                                                    {1543}out(c, GetEndpointRequest);
                                                                    {1544}in(c, (SPs_1733: bitstring,=SignAndEncrypt,UP_1734: bitstring,=pkSess_1732));
                                                                    {1545}new SPc_1735: bitstring;
                                                                    {1546}new Nc_1736: bitstring;
                                                                    {1547}let gNc_1737: bitstring = exp(g,Nc_1736) in
                                                                    {1548}let m1_1738: bitstring = (Sess,SPc_1735,gNc_1737) in
                                                                    {1549}event beginCli(Cli,Sess,gNc_1737);
                                                                    {1550}out(c, (pkCli_1631,enc(m1_1738,pkSess_1732),sign(h(m1_1738),skCli_1630)));
                                                                    {1551}in(c, (ePartS_1739: bitstring,sigPartS_1740: bitstring));
                                                                    {1552}let (=Cli,PartS_1741: bitstring) = dec(ePartS_1739,skCli_1630) in
                                                                    {1553}if (verify(h((Cli,PartS_1741)),sigPartS_1740,pkSess_1732) <> true) then
                                                                        0
                                                                    else
                                                                        {1554}event endCli(Sess,Cli,PartS_1741)
                                                                )
                                                                else
                                                                    {1555}let pkSess_1742: bitstring = pub(skI) in
                                                                    {1556}out(c, GetEndpointRequest);
                                                                    {1557}in(c, (SPs_1743: bitstring,=SignAndEncrypt,UP_1744: bitstring,=pkSess_1742));
                                                                    {1558}new SPc_1745: bitstring;
                                                                    {1559}new Nc_1746: bitstring;
                                                                    {1560}let gNc_1747: bitstring = exp(g,Nc_1746) in
                                                                    {1561}let m1_1748: bitstring = (Sess,SPc_1745,gNc_1747) in
                                                                    {1562}event beginCli(Cli,Sess,gNc_1747);
                                                                    {1563}out(c, (pkCli_1631,enc(m1_1748,pkSess_1742),sign(h(m1_1748),skCli_1630)));
                                                                    {1564}in(c, (ePartS_1749: bitstring,sigPartS_1750: bitstring));
                                                                    {1565}let (=Cli,PartS_1751: bitstring) = dec(ePartS_1749,skCli_1630) in
                                                                    {1566}if (verify(h((Cli,PartS_1751)),sigPartS_1750,pkSess_1742) <> true) then
                                                                        0
                                                                    else
                                                                        {1567}event endCli(Sess,Cli,PartS_1751)
                                                            )
                                                            else
                                                                {1568}let pkSess_1752: bitstring = fail-any in
                                                                {1569}out(c, GetEndpointRequest);
                                                                {1570}in(c, (SPs_1753: bitstring,=SignAndEncrypt,UP_1754: bitstring,=pkSess_1752));
                                                                {1571}new SPc_1755: bitstring;
                                                                {1572}new Nc_1756: bitstring;
                                                                {1573}let gNc_1757: bitstring = exp(g,Nc_1756) in
                                                                {1574}let m1_1758: bitstring = (Sess,SPc_1755,gNc_1757) in
                                                                {1575}event beginCli(Cli,Sess,gNc_1757);
                                                                {1576}out(c, (pkCli_1631,enc(m1_1758,pkSess_1752),sign(h(m1_1758),skCli_1630)));
                                                                {1577}in(c, (ePartS_1759: bitstring,sigPartS_1760: bitstring));
                                                                {1578}let (=Cli,PartS_1761: bitstring) = dec(ePartS_1759,skCli_1630) in
                                                                {1579}if (verify(h((Cli,PartS_1761)),sigPartS_1760,pkSess_1752) <> true) then
                                                                    0
                                                                else
                                                                    {1580}event endCli(Sess,Cli,PartS_1761)
                                                    )
                                                    else
                                                        {1581}let pkSess_1762: bitstring = fail-any in
                                                        {1582}out(c, GetEndpointRequest);
                                                        {1583}in(c, (SPs_1763: bitstring,=SignAndEncrypt,UP_1764: bitstring,=pkSess_1762));
                                                        {1584}new SPc_1765: bitstring;
                                                        {1585}new Nc_1766: bitstring;
                                                        {1586}let gNc_1767: bitstring = exp(g,Nc_1766) in
                                                        {1587}let m1_1768: bitstring = (Sess,SPc_1765,gNc_1767) in
                                                        {1588}event beginCli(Cli,Sess,gNc_1767);
                                                        {1589}out(c, (pkCli_1631,enc(m1_1768,pkSess_1762),sign(h(m1_1768),skCli_1630)));
                                                        {1590}in(c, (ePartS_1769: bitstring,sigPartS_1770: bitstring));
                                                        {1591}let (=Cli,PartS_1771: bitstring) = dec(ePartS_1769,skCli_1630) in
                                                        {1592}if (verify(h((Cli,PartS_1771)),sigPartS_1770,pkSess_1762) <> true) then
                                                            0
                                                        else
                                                            {1593}event endCli(Sess,Cli,PartS_1771)
                                            )
                                            else
                                                {1594}let pkSess_1772: bitstring = fail-any in
                                                {1595}out(c, GetEndpointRequest);
                                                {1596}in(c, (SPs_1773: bitstring,=SignAndEncrypt,UP_1774: bitstring,=pkSess_1772));
                                                {1597}new SPc_1775: bitstring;
                                                {1598}new Nc_1776: bitstring;
                                                {1599}let gNc_1777: bitstring = exp(g,Nc_1776) in
                                                {1600}let m1_1778: bitstring = (Sess,SPc_1775,gNc_1777) in
                                                {1601}event beginCli(Cli,Sess,gNc_1777);
                                                {1602}out(c, (pkCli_1631,enc(m1_1778,pkSess_1772),sign(h(m1_1778),skCli_1630)));
                                                {1603}in(c, (ePartS_1779: bitstring,sigPartS_1780: bitstring));
                                                {1604}let (=Cli,PartS_1781: bitstring) = dec(ePartS_1779,skCli_1630) in
                                                {1605}if (verify(h((Cli,PartS_1781)),sigPartS_1780,pkSess_1772) <> true) then
                                                    0
                                                else
                                                    {1606}event endCli(Sess,Cli,PartS_1781)
                                        )
                                        else
                                            {1607}let v_1782: bool = (Disco = C) in
                                            (
                                                {1608}if v_1782 then
                                                (
                                                    {1609}let pkDisco_1783: bitstring = pub(skC) in
                                                    {1610}let v_1784: bool = (Sess = A) in
                                                    (
                                                        {1611}if v_1784 then
                                                        (
                                                            {1612}let pkSess_1785: bitstring = pub(skA) in
                                                            {1613}out(c, GetEndpointRequest);
                                                            {1614}in(c, (SPs_1786: bitstring,=SignAndEncrypt,UP_1787: bitstring,=pkSess_1785));
                                                            {1615}new SPc_1788: bitstring;
                                                            {1616}new Nc_1789: bitstring;
                                                            {1617}let gNc_1790: bitstring = exp(g,Nc_1789) in
                                                            {1618}let m1_1791: bitstring = (Sess,SPc_1788,gNc_1790) in
                                                            {1619}event beginCli(Cli,Sess,gNc_1790);
                                                            {1620}out(c, (pkCli_1631,enc(m1_1791,pkSess_1785),sign(h(m1_1791),skCli_1630)));
                                                            {1621}in(c, (ePartS_1792: bitstring,sigPartS_1793: bitstring));
                                                            {1622}let (=Cli,PartS_1794: bitstring) = dec(ePartS_1792,skCli_1630) in
                                                            {1623}if (verify(h((Cli,PartS_1794)),sigPartS_1793,pkSess_1785) <> true) then
                                                                0
                                                            else
                                                                {1624}event endCli(Sess,Cli,PartS_1794)
                                                        )
                                                        else
                                                            {1625}let v_1795: bool = (Sess = B) in
                                                            (
                                                                {1626}if v_1795 then
                                                                (
                                                                    {1627}let pkSess_1796: bitstring = pub(skB) in
                                                                    {1628}out(c, GetEndpointRequest);
                                                                    {1629}in(c, (SPs_1797: bitstring,=SignAndEncrypt,UP_1798: bitstring,=pkSess_1796));
                                                                    {1630}new SPc_1799: bitstring;
                                                                    {1631}new Nc_1800: bitstring;
                                                                    {1632}let gNc_1801: bitstring = exp(g,Nc_1800) in
                                                                    {1633}let m1_1802: bitstring = (Sess,SPc_1799,gNc_1801) in
                                                                    {1634}event beginCli(Cli,Sess,gNc_1801);
                                                                    {1635}out(c, (pkCli_1631,enc(m1_1802,pkSess_1796),sign(h(m1_1802),skCli_1630)));
                                                                    {1636}in(c, (ePartS_1803: bitstring,sigPartS_1804: bitstring));
                                                                    {1637}let (=Cli,PartS_1805: bitstring) = dec(ePartS_1803,skCli_1630) in
                                                                    {1638}if (verify(h((Cli,PartS_1805)),sigPartS_1804,pkSess_1796) <> true) then
                                                                        0
                                                                    else
                                                                        {1639}event endCli(Sess,Cli,PartS_1805)
                                                                )
                                                                else
                                                                    {1640}let v_1806: bool = (Sess = C) in
                                                                    (
                                                                        {1641}if v_1806 then
                                                                        (
                                                                            {1642}let pkSess_1807: bitstring = pub(skC) in
                                                                            {1643}out(c, GetEndpointRequest);
                                                                            {1644}in(c, (SPs_1808: bitstring,=SignAndEncrypt,UP_1809: bitstring,=pkSess_1807));
                                                                            {1645}new SPc_1810: bitstring;
                                                                            {1646}new Nc_1811: bitstring;
                                                                            {1647}let gNc_1812: bitstring = exp(g,Nc_1811) in
                                                                            {1648}let m1_1813: bitstring = (Sess,SPc_1810,gNc_1812) in
                                                                            {1649}event beginCli(Cli,Sess,gNc_1812);
                                                                            {1650}out(c, (pkCli_1631,enc(m1_1813,pkSess_1807),sign(h(m1_1813),skCli_1630)));
                                                                            {1651}in(c, (ePartS_1814: bitstring,sigPartS_1815: bitstring));
                                                                            {1652}let (=Cli,PartS_1816: bitstring) = dec(ePartS_1814,skCli_1630) in
                                                                            {1653}if (verify(h((Cli,PartS_1816)),sigPartS_1815,pkSess_1807) <> true) then
                                                                                0
                                                                            else
                                                                                {1654}event endCli(Sess,Cli,PartS_1816)
                                                                        )
                                                                        else
                                                                            {1655}let pkSess_1817: bitstring = pub(skI) in
                                                                            {1656}out(c, GetEndpointRequest);
                                                                            {1657}in(c, (SPs_1818: bitstring,=SignAndEncrypt,UP_1819: bitstring,=pkSess_1817));
                                                                            {1658}new SPc_1820: bitstring;
                                                                            {1659}new Nc_1821: bitstring;
                                                                            {1660}let gNc_1822: bitstring = exp(g,Nc_1821) in
                                                                            {1661}let m1_1823: bitstring = (Sess,SPc_1820,gNc_1822) in
                                                                            {1662}event beginCli(Cli,Sess,gNc_1822);
                                                                            {1663}out(c, (pkCli_1631,enc(m1_1823,pkSess_1817),sign(h(m1_1823),skCli_1630)));
                                                                            {1664}in(c, (ePartS_1824: bitstring,sigPartS_1825: bitstring));
                                                                            {1665}let (=Cli,PartS_1826: bitstring) = dec(ePartS_1824,skCli_1630) in
                                                                            {1666}if (verify(h((Cli,PartS_1826)),sigPartS_1825,pkSess_1817) <> true) then
                                                                                0
                                                                            else
                                                                                {1667}event endCli(Sess,Cli,PartS_1826)
                                                                    )
                                                                    else
                                                                        {1668}let pkSess_1827: bitstring = fail-any in
                                                                        {1669}out(c, GetEndpointRequest);
                                                                        {1670}in(c, (SPs_1828: bitstring,=SignAndEncrypt,UP_1829: bitstring,=pkSess_1827));
                                                                        {1671}new SPc_1830: bitstring;
                                                                        {1672}new Nc_1831: bitstring;
                                                                        {1673}let gNc_1832: bitstring = exp(g,Nc_1831) in
                                                                        {1674}let m1_1833: bitstring = (Sess,SPc_1830,gNc_1832) in
                                                                        {1675}event beginCli(Cli,Sess,gNc_1832);
                                                                        {1676}out(c, (pkCli_1631,enc(m1_1833,pkSess_1827),sign(h(m1_1833),skCli_1630)));
                                                                        {1677}in(c, (ePartS_1834: bitstring,sigPartS_1835: bitstring));
                                                                        {1678}let (=Cli,PartS_1836: bitstring) = dec(ePartS_1834,skCli_1630) in
                                                                        {1679}if (verify(h((Cli,PartS_1836)),sigPartS_1835,pkSess_1827) <> true) then
                                                                            0
                                                                        else
                                                                            {1680}event endCli(Sess,Cli,PartS_1836)
                                                            )
                                                            else
                                                                {1681}let pkSess_1837: bitstring = fail-any in
                                                                {1682}out(c, GetEndpointRequest);
                                                                {1683}in(c, (SPs_1838: bitstring,=SignAndEncrypt,UP_1839: bitstring,=pkSess_1837));
                                                                {1684}new SPc_1840: bitstring;
                                                                {1685}new Nc_1841: bitstring;
                                                                {1686}let gNc_1842: bitstring = exp(g,Nc_1841) in
                                                                {1687}let m1_1843: bitstring = (Sess,SPc_1840,gNc_1842) in
                                                                {1688}event beginCli(Cli,Sess,gNc_1842);
                                                                {1689}out(c, (pkCli_1631,enc(m1_1843,pkSess_1837),sign(h(m1_1843),skCli_1630)));
                                                                {1690}in(c, (ePartS_1844: bitstring,sigPartS_1845: bitstring));
                                                                {1691}let (=Cli,PartS_1846: bitstring) = dec(ePartS_1844,skCli_1630) in
                                                                {1692}if (verify(h((Cli,PartS_1846)),sigPartS_1845,pkSess_1837) <> true) then
                                                                    0
                                                                else
                                                                    {1693}event endCli(Sess,Cli,PartS_1846)
                                                    )
                                                    else
                                                        {1694}let pkSess_1847: bitstring = fail-any in
                                                        {1695}out(c, GetEndpointRequest);
                                                        {1696}in(c, (SPs_1848: bitstring,=SignAndEncrypt,UP_1849: bitstring,=pkSess_1847));
                                                        {1697}new SPc_1850: bitstring;
                                                        {1698}new Nc_1851: bitstring;
                                                        {1699}let gNc_1852: bitstring = exp(g,Nc_1851) in
                                                        {1700}let m1_1853: bitstring = (Sess,SPc_1850,gNc_1852) in
                                                        {1701}event beginCli(Cli,Sess,gNc_1852);
                                                        {1702}out(c, (pkCli_1631,enc(m1_1853,pkSess_1847),sign(h(m1_1853),skCli_1630)));
                                                        {1703}in(c, (ePartS_1854: bitstring,sigPartS_1855: bitstring));
                                                        {1704}let (=Cli,PartS_1856: bitstring) = dec(ePartS_1854,skCli_1630) in
                                                        {1705}if (verify(h((Cli,PartS_1856)),sigPartS_1855,pkSess_1847) <> true) then
                                                            0
                                                        else
                                                            {1706}event endCli(Sess,Cli,PartS_1856)
                                                )
                                                else
                                                    {1707}let pkDisco_1857: bitstring = pub(skI) in
                                                    {1708}let v_1858: bool = (Sess = A) in
                                                    (
                                                        {1709}if v_1858 then
                                                        (
                                                            {1710}let pkSess_1859: bitstring = pub(skA) in
                                                            {1711}out(c, GetEndpointRequest);
                                                            {1712}in(c, (SPs_1860: bitstring,=SignAndEncrypt,UP_1861: bitstring,=pkSess_1859));
                                                            {1713}new SPc_1862: bitstring;
                                                            {1714}new Nc_1863: bitstring;
                                                            {1715}let gNc_1864: bitstring = exp(g,Nc_1863) in
                                                            {1716}let m1_1865: bitstring = (Sess,SPc_1862,gNc_1864) in
                                                            {1717}event beginCli(Cli,Sess,gNc_1864);
                                                            {1718}out(c, (pkCli_1631,enc(m1_1865,pkSess_1859),sign(h(m1_1865),skCli_1630)));
                                                            {1719}in(c, (ePartS_1866: bitstring,sigPartS_1867: bitstring));
                                                            {1720}let (=Cli,PartS_1868: bitstring) = dec(ePartS_1866,skCli_1630) in
                                                            {1721}if (verify(h((Cli,PartS_1868)),sigPartS_1867,pkSess_1859) <> true) then
                                                                0
                                                            else
                                                                {1722}event endCli(Sess,Cli,PartS_1868)
                                                        )
                                                        else
                                                            {1723}let v_1869: bool = (Sess = B) in
                                                            (
                                                                {1724}if v_1869 then
                                                                (
                                                                    {1725}let pkSess_1870: bitstring = pub(skB) in
                                                                    {1726}out(c, GetEndpointRequest);
                                                                    {1727}in(c, (SPs_1871: bitstring,=SignAndEncrypt,UP_1872: bitstring,=pkSess_1870));
                                                                    {1728}new SPc_1873: bitstring;
                                                                    {1729}new Nc_1874: bitstring;
                                                                    {1730}let gNc_1875: bitstring = exp(g,Nc_1874) in
                                                                    {1731}let m1_1876: bitstring = (Sess,SPc_1873,gNc_1875) in
                                                                    {1732}event beginCli(Cli,Sess,gNc_1875);
                                                                    {1733}out(c, (pkCli_1631,enc(m1_1876,pkSess_1870),sign(h(m1_1876),skCli_1630)));
                                                                    {1734}in(c, (ePartS_1877: bitstring,sigPartS_1878: bitstring));
                                                                    {1735}let (=Cli,PartS_1879: bitstring) = dec(ePartS_1877,skCli_1630) in
                                                                    {1736}if (verify(h((Cli,PartS_1879)),sigPartS_1878,pkSess_1870) <> true) then
                                                                        0
                                                                    else
                                                                        {1737}event endCli(Sess,Cli,PartS_1879)
                                                                )
                                                                else
                                                                    {1738}let v_1880: bool = (Sess = C) in
                                                                    (
                                                                        {1739}if v_1880 then
                                                                        (
                                                                            {1740}let pkSess_1881: bitstring = pub(skC) in
                                                                            {1741}out(c, GetEndpointRequest);
                                                                            {1742}in(c, (SPs_1882: bitstring,=SignAndEncrypt,UP_1883: bitstring,=pkSess_1881));
                                                                            {1743}new SPc_1884: bitstring;
                                                                            {1744}new Nc_1885: bitstring;
                                                                            {1745}let gNc_1886: bitstring = exp(g,Nc_1885) in
                                                                            {1746}let m1_1887: bitstring = (Sess,SPc_1884,gNc_1886) in
                                                                            {1747}event beginCli(Cli,Sess,gNc_1886);
                                                                            {1748}out(c, (pkCli_1631,enc(m1_1887,pkSess_1881),sign(h(m1_1887),skCli_1630)));
                                                                            {1749}in(c, (ePartS_1888: bitstring,sigPartS_1889: bitstring));
                                                                            {1750}let (=Cli,PartS_1890: bitstring) = dec(ePartS_1888,skCli_1630) in
                                                                            {1751}if (verify(h((Cli,PartS_1890)),sigPartS_1889,pkSess_1881) <> true) then
                                                                                0
                                                                            else
                                                                                {1752}event endCli(Sess,Cli,PartS_1890)
                                                                        )
                                                                        else
                                                                            {1753}let pkSess_1891: bitstring = pub(skI) in
                                                                            {1754}out(c, GetEndpointRequest);
                                                                            {1755}in(c, (SPs_1892: bitstring,=SignAndEncrypt,UP_1893: bitstring,=pkSess_1891));
                                                                            {1756}new SPc_1894: bitstring;
                                                                            {1757}new Nc_1895: bitstring;
                                                                            {1758}let gNc_1896: bitstring = exp(g,Nc_1895) in
                                                                            {1759}let m1_1897: bitstring = (Sess,SPc_1894,gNc_1896) in
                                                                            {1760}event beginCli(Cli,Sess,gNc_1896);
                                                                            {1761}out(c, (pkCli_1631,enc(m1_1897,pkSess_1891),sign(h(m1_1897),skCli_1630)));
                                                                            {1762}in(c, (ePartS_1898: bitstring,sigPartS_1899: bitstring));
                                                                            {1763}let (=Cli,PartS_1900: bitstring) = dec(ePartS_1898,skCli_1630) in
                                                                            {1764}if (verify(h((Cli,PartS_1900)),sigPartS_1899,pkSess_1891) <> true) then
                                                                                0
                                                                            else
                                                                                {1765}event endCli(Sess,Cli,PartS_1900)
                                                                    )
                                                                    else
                                                                        {1766}let pkSess_1901: bitstring = fail-any in
                                                                        {1767}out(c, GetEndpointRequest);
                                                                        {1768}in(c, (SPs_1902: bitstring,=SignAndEncrypt,UP_1903: bitstring,=pkSess_1901));
                                                                        {1769}new SPc_1904: bitstring;
                                                                        {1770}new Nc_1905: bitstring;
                                                                        {1771}let gNc_1906: bitstring = exp(g,Nc_1905) in
                                                                        {1772}let m1_1907: bitstring = (Sess,SPc_1904,gNc_1906) in
                                                                        {1773}event beginCli(Cli,Sess,gNc_1906);
                                                                        {1774}out(c, (pkCli_1631,enc(m1_1907,pkSess_1901),sign(h(m1_1907),skCli_1630)));
                                                                        {1775}in(c, (ePartS_1908: bitstring,sigPartS_1909: bitstring));
                                                                        {1776}let (=Cli,PartS_1910: bitstring) = dec(ePartS_1908,skCli_1630) in
                                                                        {1777}if (verify(h((Cli,PartS_1910)),sigPartS_1909,pkSess_1901) <> true) then
                                                                            0
                                                                        else
                                                                            {1778}event endCli(Sess,Cli,PartS_1910)
                                                            )
                                                            else
                                                                {1779}let pkSess_1911: bitstring = fail-any in
                                                                {1780}out(c, GetEndpointRequest);
                                                                {1781}in(c, (SPs_1912: bitstring,=SignAndEncrypt,UP_1913: bitstring,=pkSess_1911));
                                                                {1782}new SPc_1914: bitstring;
                                                                {1783}new Nc_1915: bitstring;
                                                                {1784}let gNc_1916: bitstring = exp(g,Nc_1915) in
                                                                {1785}let m1_1917: bitstring = (Sess,SPc_1914,gNc_1916) in
                                                                {1786}event beginCli(Cli,Sess,gNc_1916);
                                                                {1787}out(c, (pkCli_1631,enc(m1_1917,pkSess_1911),sign(h(m1_1917),skCli_1630)));
                                                                {1788}in(c, (ePartS_1918: bitstring,sigPartS_1919: bitstring));
                                                                {1789}let (=Cli,PartS_1920: bitstring) = dec(ePartS_1918,skCli_1630) in
                                                                {1790}if (verify(h((Cli,PartS_1920)),sigPartS_1919,pkSess_1911) <> true) then
                                                                    0
                                                                else
                                                                    {1791}event endCli(Sess,Cli,PartS_1920)
                                                    )
                                                    else
                                                        {1792}let pkSess_1921: bitstring = fail-any in
                                                        {1793}out(c, GetEndpointRequest);
                                                        {1794}in(c, (SPs_1922: bitstring,=SignAndEncrypt,UP_1923: bitstring,=pkSess_1921));
                                                        {1795}new SPc_1924: bitstring;
                                                        {1796}new Nc_1925: bitstring;
                                                        {1797}let gNc_1926: bitstring = exp(g,Nc_1925) in
                                                        {1798}let m1_1927: bitstring = (Sess,SPc_1924,gNc_1926) in
                                                        {1799}event beginCli(Cli,Sess,gNc_1926);
                                                        {1800}out(c, (pkCli_1631,enc(m1_1927,pkSess_1921),sign(h(m1_1927),skCli_1630)));
                                                        {1801}in(c, (ePartS_1928: bitstring,sigPartS_1929: bitstring));
                                                        {1802}let (=Cli,PartS_1930: bitstring) = dec(ePartS_1928,skCli_1630) in
                                                        {1803}if (verify(h((Cli,PartS_1930)),sigPartS_1929,pkSess_1921) <> true) then
                                                            0
                                                        else
                                                            {1804}event endCli(Sess,Cli,PartS_1930)
                                            )
                                            else
                                                {1805}let pkDisco_1931: bitstring = fail-any in
                                                {1806}let v_1932: bool = (Sess = A) in
                                                (
                                                    {1807}if v_1932 then
                                                    (
                                                        {1808}let pkSess_1933: bitstring = pub(skA) in
                                                        {1809}out(c, GetEndpointRequest);
                                                        {1810}in(c, (SPs_1934: bitstring,=SignAndEncrypt,UP_1935: bitstring,=pkSess_1933));
                                                        {1811}new SPc_1936: bitstring;
                                                        {1812}new Nc_1937: bitstring;
                                                        {1813}let gNc_1938: bitstring = exp(g,Nc_1937) in
                                                        {1814}let m1_1939: bitstring = (Sess,SPc_1936,gNc_1938) in
                                                        {1815}event beginCli(Cli,Sess,gNc_1938);
                                                        {1816}out(c, (pkCli_1631,enc(m1_1939,pkSess_1933),sign(h(m1_1939),skCli_1630)));
                                                        {1817}in(c, (ePartS_1940: bitstring,sigPartS_1941: bitstring));
                                                        {1818}let (=Cli,PartS_1942: bitstring) = dec(ePartS_1940,skCli_1630) in
                                                        {1819}if (verify(h((Cli,PartS_1942)),sigPartS_1941,pkSess_1933) <> true) then
                                                            0
                                                        else
                                                            {1820}event endCli(Sess,Cli,PartS_1942)
                                                    )
                                                    else
                                                        {1821}let v_1943: bool = (Sess = B) in
                                                        (
                                                            {1822}if v_1943 then
                                                            (
                                                                {1823}let pkSess_1944: bitstring = pub(skB) in
                                                                {1824}out(c, GetEndpointRequest);
                                                                {1825}in(c, (SPs_1945: bitstring,=SignAndEncrypt,UP_1946: bitstring,=pkSess_1944));
                                                                {1826}new SPc_1947: bitstring;
                                                                {1827}new Nc_1948: bitstring;
                                                                {1828}let gNc_1949: bitstring = exp(g,Nc_1948) in
                                                                {1829}let m1_1950: bitstring = (Sess,SPc_1947,gNc_1949) in
                                                                {1830}event beginCli(Cli,Sess,gNc_1949);
                                                                {1831}out(c, (pkCli_1631,enc(m1_1950,pkSess_1944),sign(h(m1_1950),skCli_1630)));
                                                                {1832}in(c, (ePartS_1951: bitstring,sigPartS_1952: bitstring));
                                                                {1833}let (=Cli,PartS_1953: bitstring) = dec(ePartS_1951,skCli_1630) in
                                                                {1834}if (verify(h((Cli,PartS_1953)),sigPartS_1952,pkSess_1944) <> true) then
                                                                    0
                                                                else
                                                                    {1835}event endCli(Sess,Cli,PartS_1953)
                                                            )
                                                            else
                                                                {1836}let v_1954: bool = (Sess = C) in
                                                                (
                                                                    {1837}if v_1954 then
                                                                    (
                                                                        {1838}let pkSess_1955: bitstring = pub(skC) in
                                                                        {1839}out(c, GetEndpointRequest);
                                                                        {1840}in(c, (SPs_1956: bitstring,=SignAndEncrypt,UP_1957: bitstring,=pkSess_1955));
                                                                        {1841}new SPc_1958: bitstring;
                                                                        {1842}new Nc_1959: bitstring;
                                                                        {1843}let gNc_1960: bitstring = exp(g,Nc_1959) in
                                                                        {1844}let m1_1961: bitstring = (Sess,SPc_1958,gNc_1960) in
                                                                        {1845}event beginCli(Cli,Sess,gNc_1960);
                                                                        {1846}out(c, (pkCli_1631,enc(m1_1961,pkSess_1955),sign(h(m1_1961),skCli_1630)));
                                                                        {1847}in(c, (ePartS_1962: bitstring,sigPartS_1963: bitstring));
                                                                        {1848}let (=Cli,PartS_1964: bitstring) = dec(ePartS_1962,skCli_1630) in
                                                                        {1849}if (verify(h((Cli,PartS_1964)),sigPartS_1963,pkSess_1955) <> true) then
                                                                            0
                                                                        else
                                                                            {1850}event endCli(Sess,Cli,PartS_1964)
                                                                    )
                                                                    else
                                                                        {1851}let pkSess_1965: bitstring = pub(skI) in
                                                                        {1852}out(c, GetEndpointRequest);
                                                                        {1853}in(c, (SPs_1966: bitstring,=SignAndEncrypt,UP_1967: bitstring,=pkSess_1965));
                                                                        {1854}new SPc_1968: bitstring;
                                                                        {1855}new Nc_1969: bitstring;
                                                                        {1856}let gNc_1970: bitstring = exp(g,Nc_1969) in
                                                                        {1857}let m1_1971: bitstring = (Sess,SPc_1968,gNc_1970) in
                                                                        {1858}event beginCli(Cli,Sess,gNc_1970);
                                                                        {1859}out(c, (pkCli_1631,enc(m1_1971,pkSess_1965),sign(h(m1_1971),skCli_1630)));
                                                                        {1860}in(c, (ePartS_1972: bitstring,sigPartS_1973: bitstring));
                                                                        {1861}let (=Cli,PartS_1974: bitstring) = dec(ePartS_1972,skCli_1630) in
                                                                        {1862}if (verify(h((Cli,PartS_1974)),sigPartS_1973,pkSess_1965) <> true) then
                                                                            0
                                                                        else
                                                                            {1863}event endCli(Sess,Cli,PartS_1974)
                                                                )
                                                                else
                                                                    {1864}let pkSess_1975: bitstring = fail-any in
                                                                    {1865}out(c, GetEndpointRequest);
                                                                    {1866}in(c, (SPs_1976: bitstring,=SignAndEncrypt,UP_1977: bitstring,=pkSess_1975));
                                                                    {1867}new SPc_1978: bitstring;
                                                                    {1868}new Nc_1979: bitstring;
                                                                    {1869}let gNc_1980: bitstring = exp(g,Nc_1979) in
                                                                    {1870}let m1_1981: bitstring = (Sess,SPc_1978,gNc_1980) in
                                                                    {1871}event beginCli(Cli,Sess,gNc_1980);
                                                                    {1872}out(c, (pkCli_1631,enc(m1_1981,pkSess_1975),sign(h(m1_1981),skCli_1630)));
                                                                    {1873}in(c, (ePartS_1982: bitstring,sigPartS_1983: bitstring));
                                                                    {1874}let (=Cli,PartS_1984: bitstring) = dec(ePartS_1982,skCli_1630) in
                                                                    {1875}if (verify(h((Cli,PartS_1984)),sigPartS_1983,pkSess_1975) <> true) then
                                                                        0
                                                                    else
                                                                        {1876}event endCli(Sess,Cli,PartS_1984)
                                                        )
                                                        else
                                                            {1877}let pkSess_1985: bitstring = fail-any in
                                                            {1878}out(c, GetEndpointRequest);
                                                            {1879}in(c, (SPs_1986: bitstring,=SignAndEncrypt,UP_1987: bitstring,=pkSess_1985));
                                                            {1880}new SPc_1988: bitstring;
                                                            {1881}new Nc_1989: bitstring;
                                                            {1882}let gNc_1990: bitstring = exp(g,Nc_1989) in
                                                            {1883}let m1_1991: bitstring = (Sess,SPc_1988,gNc_1990) in
                                                            {1884}event beginCli(Cli,Sess,gNc_1990);
                                                            {1885}out(c, (pkCli_1631,enc(m1_1991,pkSess_1985),sign(h(m1_1991),skCli_1630)));
                                                            {1886}in(c, (ePartS_1992: bitstring,sigPartS_1993: bitstring));
                                                            {1887}let (=Cli,PartS_1994: bitstring) = dec(ePartS_1992,skCli_1630) in
                                                            {1888}if (verify(h((Cli,PartS_1994)),sigPartS_1993,pkSess_1985) <> true) then
                                                                0
                                                            else
                                                                {1889}event endCli(Sess,Cli,PartS_1994)
                                                )
                                                else
                                                    {1890}let pkSess_1995: bitstring = fail-any in
                                                    {1891}out(c, GetEndpointRequest);
                                                    {1892}in(c, (SPs_1996: bitstring,=SignAndEncrypt,UP_1997: bitstring,=pkSess_1995));
                                                    {1893}new SPc_1998: bitstring;
                                                    {1894}new Nc_1999: bitstring;
                                                    {1895}let gNc_2000: bitstring = exp(g,Nc_1999) in
                                                    {1896}let m1_2001: bitstring = (Sess,SPc_1998,gNc_2000) in
                                                    {1897}event beginCli(Cli,Sess,gNc_2000);
                                                    {1898}out(c, (pkCli_1631,enc(m1_2001,pkSess_1995),sign(h(m1_2001),skCli_1630)));
                                                    {1899}in(c, (ePartS_2002: bitstring,sigPartS_2003: bitstring));
                                                    {1900}let (=Cli,PartS_2004: bitstring) = dec(ePartS_2002,skCli_1630) in
                                                    {1901}if (verify(h((Cli,PartS_2004)),sigPartS_2003,pkSess_1995) <> true) then
                                                        0
                                                    else
                                                        {1902}event endCli(Sess,Cli,PartS_2004)
                                    )
                                    else
                                        {1903}let pkDisco_2005: bitstring = fail-any in
                                        {1904}let v_2006: bool = (Sess = A) in
                                        (
                                            {1905}if v_2006 then
                                            (
                                                {1906}let pkSess_2007: bitstring = pub(skA) in
                                                {1907}out(c, GetEndpointRequest);
                                                {1908}in(c, (SPs_2008: bitstring,=SignAndEncrypt,UP_2009: bitstring,=pkSess_2007));
                                                {1909}new SPc_2010: bitstring;
                                                {1910}new Nc_2011: bitstring;
                                                {1911}let gNc_2012: bitstring = exp(g,Nc_2011) in
                                                {1912}let m1_2013: bitstring = (Sess,SPc_2010,gNc_2012) in
                                                {1913}event beginCli(Cli,Sess,gNc_2012);
                                                {1914}out(c, (pkCli_1631,enc(m1_2013,pkSess_2007),sign(h(m1_2013),skCli_1630)));
                                                {1915}in(c, (ePartS_2014: bitstring,sigPartS_2015: bitstring));
                                                {1916}let (=Cli,PartS_2016: bitstring) = dec(ePartS_2014,skCli_1630) in
                                                {1917}if (verify(h((Cli,PartS_2016)),sigPartS_2015,pkSess_2007) <> true) then
                                                    0
                                                else
                                                    {1918}event endCli(Sess,Cli,PartS_2016)
                                            )
                                            else
                                                {1919}let v_2017: bool = (Sess = B) in
                                                (
                                                    {1920}if v_2017 then
                                                    (
                                                        {1921}let pkSess_2018: bitstring = pub(skB) in
                                                        {1922}out(c, GetEndpointRequest);
                                                        {1923}in(c, (SPs_2019: bitstring,=SignAndEncrypt,UP_2020: bitstring,=pkSess_2018));
                                                        {1924}new SPc_2021: bitstring;
                                                        {1925}new Nc_2022: bitstring;
                                                        {1926}let gNc_2023: bitstring = exp(g,Nc_2022) in
                                                        {1927}let m1_2024: bitstring = (Sess,SPc_2021,gNc_2023) in
                                                        {1928}event beginCli(Cli,Sess,gNc_2023);
                                                        {1929}out(c, (pkCli_1631,enc(m1_2024,pkSess_2018),sign(h(m1_2024),skCli_1630)));
                                                        {1930}in(c, (ePartS_2025: bitstring,sigPartS_2026: bitstring));
                                                        {1931}let (=Cli,PartS_2027: bitstring) = dec(ePartS_2025,skCli_1630) in
                                                        {1932}if (verify(h((Cli,PartS_2027)),sigPartS_2026,pkSess_2018) <> true) then
                                                            0
                                                        else
                                                            {1933}event endCli(Sess,Cli,PartS_2027)
                                                    )
                                                    else
                                                        {1934}let v_2028: bool = (Sess = C) in
                                                        (
                                                            {1935}if v_2028 then
                                                            (
                                                                {1936}let pkSess_2029: bitstring = pub(skC) in
                                                                {1937}out(c, GetEndpointRequest);
                                                                {1938}in(c, (SPs_2030: bitstring,=SignAndEncrypt,UP_2031: bitstring,=pkSess_2029));
                                                                {1939}new SPc_2032: bitstring;
                                                                {1940}new Nc_2033: bitstring;
                                                                {1941}let gNc_2034: bitstring = exp(g,Nc_2033) in
                                                                {1942}let m1_2035: bitstring = (Sess,SPc_2032,gNc_2034) in
                                                                {1943}event beginCli(Cli,Sess,gNc_2034);
                                                                {1944}out(c, (pkCli_1631,enc(m1_2035,pkSess_2029),sign(h(m1_2035),skCli_1630)));
                                                                {1945}in(c, (ePartS_2036: bitstring,sigPartS_2037: bitstring));
                                                                {1946}let (=Cli,PartS_2038: bitstring) = dec(ePartS_2036,skCli_1630) in
                                                                {1947}if (verify(h((Cli,PartS_2038)),sigPartS_2037,pkSess_2029) <> true) then
                                                                    0
                                                                else
                                                                    {1948}event endCli(Sess,Cli,PartS_2038)
                                                            )
                                                            else
                                                                {1949}let pkSess_2039: bitstring = pub(skI) in
                                                                {1950}out(c, GetEndpointRequest);
                                                                {1951}in(c, (SPs_2040: bitstring,=SignAndEncrypt,UP_2041: bitstring,=pkSess_2039));
                                                                {1952}new SPc_2042: bitstring;
                                                                {1953}new Nc_2043: bitstring;
                                                                {1954}let gNc_2044: bitstring = exp(g,Nc_2043) in
                                                                {1955}let m1_2045: bitstring = (Sess,SPc_2042,gNc_2044) in
                                                                {1956}event beginCli(Cli,Sess,gNc_2044);
                                                                {1957}out(c, (pkCli_1631,enc(m1_2045,pkSess_2039),sign(h(m1_2045),skCli_1630)));
                                                                {1958}in(c, (ePartS_2046: bitstring,sigPartS_2047: bitstring));
                                                                {1959}let (=Cli,PartS_2048: bitstring) = dec(ePartS_2046,skCli_1630) in
                                                                {1960}if (verify(h((Cli,PartS_2048)),sigPartS_2047,pkSess_2039) <> true) then
                                                                    0
                                                                else
                                                                    {1961}event endCli(Sess,Cli,PartS_2048)
                                                        )
                                                        else
                                                            {1962}let pkSess_2049: bitstring = fail-any in
                                                            {1963}out(c, GetEndpointRequest);
                                                            {1964}in(c, (SPs_2050: bitstring,=SignAndEncrypt,UP_2051: bitstring,=pkSess_2049));
                                                            {1965}new SPc_2052: bitstring;
                                                            {1966}new Nc_2053: bitstring;
                                                            {1967}let gNc_2054: bitstring = exp(g,Nc_2053) in
                                                            {1968}let m1_2055: bitstring = (Sess,SPc_2052,gNc_2054) in
                                                            {1969}event beginCli(Cli,Sess,gNc_2054);
                                                            {1970}out(c, (pkCli_1631,enc(m1_2055,pkSess_2049),sign(h(m1_2055),skCli_1630)));
                                                            {1971}in(c, (ePartS_2056: bitstring,sigPartS_2057: bitstring));
                                                            {1972}let (=Cli,PartS_2058: bitstring) = dec(ePartS_2056,skCli_1630) in
                                                            {1973}if (verify(h((Cli,PartS_2058)),sigPartS_2057,pkSess_2049) <> true) then
                                                                0
                                                            else
                                                                {1974}event endCli(Sess,Cli,PartS_2058)
                                                )
                                                else
                                                    {1975}let pkSess_2059: bitstring = fail-any in
                                                    {1976}out(c, GetEndpointRequest);
                                                    {1977}in(c, (SPs_2060: bitstring,=SignAndEncrypt,UP_2061: bitstring,=pkSess_2059));
                                                    {1978}new SPc_2062: bitstring;
                                                    {1979}new Nc_2063: bitstring;
                                                    {1980}let gNc_2064: bitstring = exp(g,Nc_2063) in
                                                    {1981}let m1_2065: bitstring = (Sess,SPc_2062,gNc_2064) in
                                                    {1982}event beginCli(Cli,Sess,gNc_2064);
                                                    {1983}out(c, (pkCli_1631,enc(m1_2065,pkSess_2059),sign(h(m1_2065),skCli_1630)));
                                                    {1984}in(c, (ePartS_2066: bitstring,sigPartS_2067: bitstring));
                                                    {1985}let (=Cli,PartS_2068: bitstring) = dec(ePartS_2066,skCli_1630) in
                                                    {1986}if (verify(h((Cli,PartS_2068)),sigPartS_2067,pkSess_2059) <> true) then
                                                        0
                                                    else
                                                        {1987}event endCli(Sess,Cli,PartS_2068)
                                        )
                                        else
                                            {1988}let pkSess_2069: bitstring = fail-any in
                                            {1989}out(c, GetEndpointRequest);
                                            {1990}in(c, (SPs_2070: bitstring,=SignAndEncrypt,UP_2071: bitstring,=pkSess_2069));
                                            {1991}new SPc_2072: bitstring;
                                            {1992}new Nc_2073: bitstring;
                                            {1993}let gNc_2074: bitstring = exp(g,Nc_2073) in
                                            {1994}let m1_2075: bitstring = (Sess,SPc_2072,gNc_2074) in
                                            {1995}event beginCli(Cli,Sess,gNc_2074);
                                            {1996}out(c, (pkCli_1631,enc(m1_2075,pkSess_2069),sign(h(m1_2075),skCli_1630)));
                                            {1997}in(c, (ePartS_2076: bitstring,sigPartS_2077: bitstring));
                                            {1998}let (=Cli,PartS_2078: bitstring) = dec(ePartS_2076,skCli_1630) in
                                            {1999}if (verify(h((Cli,PartS_2078)),sigPartS_2077,pkSess_2069) <> true) then
                                                0
                                            else
                                                {2000}event endCli(Sess,Cli,PartS_2078)
                            )
                            else
                                {2001}let pkDisco_2079: bitstring = fail-any in
                                {2002}let v_2080: bool = (Sess = A) in
                                (
                                    {2003}if v_2080 then
                                    (
                                        {2004}let pkSess_2081: bitstring = pub(skA) in
                                        {2005}out(c, GetEndpointRequest);
                                        {2006}in(c, (SPs_2082: bitstring,=SignAndEncrypt,UP_2083: bitstring,=pkSess_2081));
                                        {2007}new SPc_2084: bitstring;
                                        {2008}new Nc_2085: bitstring;
                                        {2009}let gNc_2086: bitstring = exp(g,Nc_2085) in
                                        {2010}let m1_2087: bitstring = (Sess,SPc_2084,gNc_2086) in
                                        {2011}event beginCli(Cli,Sess,gNc_2086);
                                        {2012}out(c, (pkCli_1631,enc(m1_2087,pkSess_2081),sign(h(m1_2087),skCli_1630)));
                                        {2013}in(c, (ePartS_2088: bitstring,sigPartS_2089: bitstring));
                                        {2014}let (=Cli,PartS_2090: bitstring) = dec(ePartS_2088,skCli_1630) in
                                        {2015}if (verify(h((Cli,PartS_2090)),sigPartS_2089,pkSess_2081) <> true) then
                                            0
                                        else
                                            {2016}event endCli(Sess,Cli,PartS_2090)
                                    )
                                    else
                                        {2017}let v_2091: bool = (Sess = B) in
                                        (
                                            {2018}if v_2091 then
                                            (
                                                {2019}let pkSess_2092: bitstring = pub(skB) in
                                                {2020}out(c, GetEndpointRequest);
                                                {2021}in(c, (SPs_2093: bitstring,=SignAndEncrypt,UP_2094: bitstring,=pkSess_2092));
                                                {2022}new SPc_2095: bitstring;
                                                {2023}new Nc_2096: bitstring;
                                                {2024}let gNc_2097: bitstring = exp(g,Nc_2096) in
                                                {2025}let m1_2098: bitstring = (Sess,SPc_2095,gNc_2097) in
                                                {2026}event beginCli(Cli,Sess,gNc_2097);
                                                {2027}out(c, (pkCli_1631,enc(m1_2098,pkSess_2092),sign(h(m1_2098),skCli_1630)));
                                                {2028}in(c, (ePartS_2099: bitstring,sigPartS_2100: bitstring));
                                                {2029}let (=Cli,PartS_2101: bitstring) = dec(ePartS_2099,skCli_1630) in
                                                {2030}if (verify(h((Cli,PartS_2101)),sigPartS_2100,pkSess_2092) <> true) then
                                                    0
                                                else
                                                    {2031}event endCli(Sess,Cli,PartS_2101)
                                            )
                                            else
                                                {2032}let v_2102: bool = (Sess = C) in
                                                (
                                                    {2033}if v_2102 then
                                                    (
                                                        {2034}let pkSess_2103: bitstring = pub(skC) in
                                                        {2035}out(c, GetEndpointRequest);
                                                        {2036}in(c, (SPs_2104: bitstring,=SignAndEncrypt,UP_2105: bitstring,=pkSess_2103));
                                                        {2037}new SPc_2106: bitstring;
                                                        {2038}new Nc_2107: bitstring;
                                                        {2039}let gNc_2108: bitstring = exp(g,Nc_2107) in
                                                        {2040}let m1_2109: bitstring = (Sess,SPc_2106,gNc_2108) in
                                                        {2041}event beginCli(Cli,Sess,gNc_2108);
                                                        {2042}out(c, (pkCli_1631,enc(m1_2109,pkSess_2103),sign(h(m1_2109),skCli_1630)));
                                                        {2043}in(c, (ePartS_2110: bitstring,sigPartS_2111: bitstring));
                                                        {2044}let (=Cli,PartS_2112: bitstring) = dec(ePartS_2110,skCli_1630) in
                                                        {2045}if (verify(h((Cli,PartS_2112)),sigPartS_2111,pkSess_2103) <> true) then
                                                            0
                                                        else
                                                            {2046}event endCli(Sess,Cli,PartS_2112)
                                                    )
                                                    else
                                                        {2047}let pkSess_2113: bitstring = pub(skI) in
                                                        {2048}out(c, GetEndpointRequest);
                                                        {2049}in(c, (SPs_2114: bitstring,=SignAndEncrypt,UP_2115: bitstring,=pkSess_2113));
                                                        {2050}new SPc_2116: bitstring;
                                                        {2051}new Nc_2117: bitstring;
                                                        {2052}let gNc_2118: bitstring = exp(g,Nc_2117) in
                                                        {2053}let m1_2119: bitstring = (Sess,SPc_2116,gNc_2118) in
                                                        {2054}event beginCli(Cli,Sess,gNc_2118);
                                                        {2055}out(c, (pkCli_1631,enc(m1_2119,pkSess_2113),sign(h(m1_2119),skCli_1630)));
                                                        {2056}in(c, (ePartS_2120: bitstring,sigPartS_2121: bitstring));
                                                        {2057}let (=Cli,PartS_2122: bitstring) = dec(ePartS_2120,skCli_1630) in
                                                        {2058}if (verify(h((Cli,PartS_2122)),sigPartS_2121,pkSess_2113) <> true) then
                                                            0
                                                        else
                                                            {2059}event endCli(Sess,Cli,PartS_2122)
                                                )
                                                else
                                                    {2060}let pkSess_2123: bitstring = fail-any in
                                                    {2061}out(c, GetEndpointRequest);
                                                    {2062}in(c, (SPs_2124: bitstring,=SignAndEncrypt,UP_2125: bitstring,=pkSess_2123));
                                                    {2063}new SPc_2126: bitstring;
                                                    {2064}new Nc_2127: bitstring;
                                                    {2065}let gNc_2128: bitstring = exp(g,Nc_2127) in
                                                    {2066}let m1_2129: bitstring = (Sess,SPc_2126,gNc_2128) in
                                                    {2067}event beginCli(Cli,Sess,gNc_2128);
                                                    {2068}out(c, (pkCli_1631,enc(m1_2129,pkSess_2123),sign(h(m1_2129),skCli_1630)));
                                                    {2069}in(c, (ePartS_2130: bitstring,sigPartS_2131: bitstring));
                                                    {2070}let (=Cli,PartS_2132: bitstring) = dec(ePartS_2130,skCli_1630) in
                                                    {2071}if (verify(h((Cli,PartS_2132)),sigPartS_2131,pkSess_2123) <> true) then
                                                        0
                                                    else
                                                        {2072}event endCli(Sess,Cli,PartS_2132)
                                        )
                                        else
                                            {2073}let pkSess_2133: bitstring = fail-any in
                                            {2074}out(c, GetEndpointRequest);
                                            {2075}in(c, (SPs_2134: bitstring,=SignAndEncrypt,UP_2135: bitstring,=pkSess_2133));
                                            {2076}new SPc_2136: bitstring;
                                            {2077}new Nc_2137: bitstring;
                                            {2078}let gNc_2138: bitstring = exp(g,Nc_2137) in
                                            {2079}let m1_2139: bitstring = (Sess,SPc_2136,gNc_2138) in
                                            {2080}event beginCli(Cli,Sess,gNc_2138);
                                            {2081}out(c, (pkCli_1631,enc(m1_2139,pkSess_2133),sign(h(m1_2139),skCli_1630)));
                                            {2082}in(c, (ePartS_2140: bitstring,sigPartS_2141: bitstring));
                                            {2083}let (=Cli,PartS_2142: bitstring) = dec(ePartS_2140,skCli_1630) in
                                            {2084}if (verify(h((Cli,PartS_2142)),sigPartS_2141,pkSess_2133) <> true) then
                                                0
                                            else
                                                {2085}event endCli(Sess,Cli,PartS_2142)
                                )
                                else
                                    {2086}let pkSess_2143: bitstring = fail-any in
                                    {2087}out(c, GetEndpointRequest);
                                    {2088}in(c, (SPs_2144: bitstring,=SignAndEncrypt,UP_2145: bitstring,=pkSess_2143));
                                    {2089}new SPc_2146: bitstring;
                                    {2090}new Nc_2147: bitstring;
                                    {2091}let gNc_2148: bitstring = exp(g,Nc_2147) in
                                    {2092}let m1_2149: bitstring = (Sess,SPc_2146,gNc_2148) in
                                    {2093}event beginCli(Cli,Sess,gNc_2148);
                                    {2094}out(c, (pkCli_1631,enc(m1_2149,pkSess_2143),sign(h(m1_2149),skCli_1630)));
                                    {2095}in(c, (ePartS_2150: bitstring,sigPartS_2151: bitstring));
                                    {2096}let (=Cli,PartS_2152: bitstring) = dec(ePartS_2150,skCli_1630) in
                                    {2097}if (verify(h((Cli,PartS_2152)),sigPartS_2151,pkSess_2143) <> true) then
                                        0
                                    else
                                        {2098}event endCli(Sess,Cli,PartS_2152)
                        )
                        else
                            {2099}let skCli_2153: bitstring = skI in
                            {2100}let pkCli_2154: bitstring = pub(skCli_2153) in
                            {2101}let v_2155: bool = (Disco = A) in
                            (
                                {2102}if v_2155 then
                                (
                                    {2103}let pkDisco_2156: bitstring = pub(skA) in
                                    {2104}let v_2157: bool = (Sess = A) in
                                    (
                                        {2105}if v_2157 then
                                        (
                                            {2106}let pkSess_2158: bitstring = pub(skA) in
                                            {2107}out(c, GetEndpointRequest);
                                            {2108}in(c, (SPs_2159: bitstring,=SignAndEncrypt,UP_2160: bitstring,=pkSess_2158));
                                            {2109}new SPc_2161: bitstring;
                                            {2110}new Nc_2162: bitstring;
                                            {2111}let gNc_2163: bitstring = exp(g,Nc_2162) in
                                            {2112}let m1_2164: bitstring = (Sess,SPc_2161,gNc_2163) in
                                            {2113}event beginCli(Cli,Sess,gNc_2163);
                                            {2114}out(c, (pkCli_2154,enc(m1_2164,pkSess_2158),sign(h(m1_2164),skCli_2153)));
                                            {2115}in(c, (ePartS_2165: bitstring,sigPartS_2166: bitstring));
                                            {2116}let (=Cli,PartS_2167: bitstring) = dec(ePartS_2165,skCli_2153) in
                                            {2117}if (verify(h((Cli,PartS_2167)),sigPartS_2166,pkSess_2158) <> true) then
                                                0
                                            else
                                                {2118}event endCli(Sess,Cli,PartS_2167)
                                        )
                                        else
                                            {2119}let v_2168: bool = (Sess = B) in
                                            (
                                                {2120}if v_2168 then
                                                (
                                                    {2121}let pkSess_2169: bitstring = pub(skB) in
                                                    {2122}out(c, GetEndpointRequest);
                                                    {2123}in(c, (SPs_2170: bitstring,=SignAndEncrypt,UP_2171: bitstring,=pkSess_2169));
                                                    {2124}new SPc_2172: bitstring;
                                                    {2125}new Nc_2173: bitstring;
                                                    {2126}let gNc_2174: bitstring = exp(g,Nc_2173) in
                                                    {2127}let m1_2175: bitstring = (Sess,SPc_2172,gNc_2174) in
                                                    {2128}event beginCli(Cli,Sess,gNc_2174);
                                                    {2129}out(c, (pkCli_2154,enc(m1_2175,pkSess_2169),sign(h(m1_2175),skCli_2153)));
                                                    {2130}in(c, (ePartS_2176: bitstring,sigPartS_2177: bitstring));
                                                    {2131}let (=Cli,PartS_2178: bitstring) = dec(ePartS_2176,skCli_2153) in
                                                    {2132}if (verify(h((Cli,PartS_2178)),sigPartS_2177,pkSess_2169) <> true) then
                                                        0
                                                    else
                                                        {2133}event endCli(Sess,Cli,PartS_2178)
                                                )
                                                else
                                                    {2134}let v_2179: bool = (Sess = C) in
                                                    (
                                                        {2135}if v_2179 then
                                                        (
                                                            {2136}let pkSess_2180: bitstring = pub(skC) in
                                                            {2137}out(c, GetEndpointRequest);
                                                            {2138}in(c, (SPs_2181: bitstring,=SignAndEncrypt,UP_2182: bitstring,=pkSess_2180));
                                                            {2139}new SPc_2183: bitstring;
                                                            {2140}new Nc_2184: bitstring;
                                                            {2141}let gNc_2185: bitstring = exp(g,Nc_2184) in
                                                            {2142}let m1_2186: bitstring = (Sess,SPc_2183,gNc_2185) in
                                                            {2143}event beginCli(Cli,Sess,gNc_2185);
                                                            {2144}out(c, (pkCli_2154,enc(m1_2186,pkSess_2180),sign(h(m1_2186),skCli_2153)));
                                                            {2145}in(c, (ePartS_2187: bitstring,sigPartS_2188: bitstring));
                                                            {2146}let (=Cli,PartS_2189: bitstring) = dec(ePartS_2187,skCli_2153) in
                                                            {2147}if (verify(h((Cli,PartS_2189)),sigPartS_2188,pkSess_2180) <> true) then
                                                                0
                                                            else
                                                                {2148}event endCli(Sess,Cli,PartS_2189)
                                                        )
                                                        else
                                                            {2149}let pkSess_2190: bitstring = pub(skI) in
                                                            {2150}out(c, GetEndpointRequest);
                                                            {2151}in(c, (SPs_2191: bitstring,=SignAndEncrypt,UP_2192: bitstring,=pkSess_2190));
                                                            {2152}new SPc_2193: bitstring;
                                                            {2153}new Nc_2194: bitstring;
                                                            {2154}let gNc_2195: bitstring = exp(g,Nc_2194) in
                                                            {2155}let m1_2196: bitstring = (Sess,SPc_2193,gNc_2195) in
                                                            {2156}event beginCli(Cli,Sess,gNc_2195);
                                                            {2157}out(c, (pkCli_2154,enc(m1_2196,pkSess_2190),sign(h(m1_2196),skCli_2153)));
                                                            {2158}in(c, (ePartS_2197: bitstring,sigPartS_2198: bitstring));
                                                            {2159}let (=Cli,PartS_2199: bitstring) = dec(ePartS_2197,skCli_2153) in
                                                            {2160}if (verify(h((Cli,PartS_2199)),sigPartS_2198,pkSess_2190) <> true) then
                                                                0
                                                            else
                                                                {2161}event endCli(Sess,Cli,PartS_2199)
                                                    )
                                                    else
                                                        {2162}let pkSess_2200: bitstring = fail-any in
                                                        {2163}out(c, GetEndpointRequest);
                                                        {2164}in(c, (SPs_2201: bitstring,=SignAndEncrypt,UP_2202: bitstring,=pkSess_2200));
                                                        {2165}new SPc_2203: bitstring;
                                                        {2166}new Nc_2204: bitstring;
                                                        {2167}let gNc_2205: bitstring = exp(g,Nc_2204) in
                                                        {2168}let m1_2206: bitstring = (Sess,SPc_2203,gNc_2205) in
                                                        {2169}event beginCli(Cli,Sess,gNc_2205);
                                                        {2170}out(c, (pkCli_2154,enc(m1_2206,pkSess_2200),sign(h(m1_2206),skCli_2153)));
                                                        {2171}in(c, (ePartS_2207: bitstring,sigPartS_2208: bitstring));
                                                        {2172}let (=Cli,PartS_2209: bitstring) = dec(ePartS_2207,skCli_2153) in
                                                        {2173}if (verify(h((Cli,PartS_2209)),sigPartS_2208,pkSess_2200) <> true) then
                                                            0
                                                        else
                                                            {2174}event endCli(Sess,Cli,PartS_2209)
                                            )
                                            else
                                                {2175}let pkSess_2210: bitstring = fail-any in
                                                {2176}out(c, GetEndpointRequest);
                                                {2177}in(c, (SPs_2211: bitstring,=SignAndEncrypt,UP_2212: bitstring,=pkSess_2210));
                                                {2178}new SPc_2213: bitstring;
                                                {2179}new Nc_2214: bitstring;
                                                {2180}let gNc_2215: bitstring = exp(g,Nc_2214) in
                                                {2181}let m1_2216: bitstring = (Sess,SPc_2213,gNc_2215) in
                                                {2182}event beginCli(Cli,Sess,gNc_2215);
                                                {2183}out(c, (pkCli_2154,enc(m1_2216,pkSess_2210),sign(h(m1_2216),skCli_2153)));
                                                {2184}in(c, (ePartS_2217: bitstring,sigPartS_2218: bitstring));
                                                {2185}let (=Cli,PartS_2219: bitstring) = dec(ePartS_2217,skCli_2153) in
                                                {2186}if (verify(h((Cli,PartS_2219)),sigPartS_2218,pkSess_2210) <> true) then
                                                    0
                                                else
                                                    {2187}event endCli(Sess,Cli,PartS_2219)
                                    )
                                    else
                                        {2188}let pkSess_2220: bitstring = fail-any in
                                        {2189}out(c, GetEndpointRequest);
                                        {2190}in(c, (SPs_2221: bitstring,=SignAndEncrypt,UP_2222: bitstring,=pkSess_2220));
                                        {2191}new SPc_2223: bitstring;
                                        {2192}new Nc_2224: bitstring;
                                        {2193}let gNc_2225: bitstring = exp(g,Nc_2224) in
                                        {2194}let m1_2226: bitstring = (Sess,SPc_2223,gNc_2225) in
                                        {2195}event beginCli(Cli,Sess,gNc_2225);
                                        {2196}out(c, (pkCli_2154,enc(m1_2226,pkSess_2220),sign(h(m1_2226),skCli_2153)));
                                        {2197}in(c, (ePartS_2227: bitstring,sigPartS_2228: bitstring));
                                        {2198}let (=Cli,PartS_2229: bitstring) = dec(ePartS_2227,skCli_2153) in
                                        {2199}if (verify(h((Cli,PartS_2229)),sigPartS_2228,pkSess_2220) <> true) then
                                            0
                                        else
                                            {2200}event endCli(Sess,Cli,PartS_2229)
                                )
                                else
                                    {2201}let v_2230: bool = (Disco = B) in
                                    (
                                        {2202}if v_2230 then
                                        (
                                            {2203}let pkDisco_2231: bitstring = pub(skB) in
                                            {2204}let v_2232: bool = (Sess = A) in
                                            (
                                                {2205}if v_2232 then
                                                (
                                                    {2206}let pkSess_2233: bitstring = pub(skA) in
                                                    {2207}out(c, GetEndpointRequest);
                                                    {2208}in(c, (SPs_2234: bitstring,=SignAndEncrypt,UP_2235: bitstring,=pkSess_2233));
                                                    {2209}new SPc_2236: bitstring;
                                                    {2210}new Nc_2237: bitstring;
                                                    {2211}let gNc_2238: bitstring = exp(g,Nc_2237) in
                                                    {2212}let m1_2239: bitstring = (Sess,SPc_2236,gNc_2238) in
                                                    {2213}event beginCli(Cli,Sess,gNc_2238);
                                                    {2214}out(c, (pkCli_2154,enc(m1_2239,pkSess_2233),sign(h(m1_2239),skCli_2153)));
                                                    {2215}in(c, (ePartS_2240: bitstring,sigPartS_2241: bitstring));
                                                    {2216}let (=Cli,PartS_2242: bitstring) = dec(ePartS_2240,skCli_2153) in
                                                    {2217}if (verify(h((Cli,PartS_2242)),sigPartS_2241,pkSess_2233) <> true) then
                                                        0
                                                    else
                                                        {2218}event endCli(Sess,Cli,PartS_2242)
                                                )
                                                else
                                                    {2219}let v_2243: bool = (Sess = B) in
                                                    (
                                                        {2220}if v_2243 then
                                                        (
                                                            {2221}let pkSess_2244: bitstring = pub(skB) in
                                                            {2222}out(c, GetEndpointRequest);
                                                            {2223}in(c, (SPs_2245: bitstring,=SignAndEncrypt,UP_2246: bitstring,=pkSess_2244));
                                                            {2224}new SPc_2247: bitstring;
                                                            {2225}new Nc_2248: bitstring;
                                                            {2226}let gNc_2249: bitstring = exp(g,Nc_2248) in
                                                            {2227}let m1_2250: bitstring = (Sess,SPc_2247,gNc_2249) in
                                                            {2228}event beginCli(Cli,Sess,gNc_2249);
                                                            {2229}out(c, (pkCli_2154,enc(m1_2250,pkSess_2244),sign(h(m1_2250),skCli_2153)));
                                                            {2230}in(c, (ePartS_2251: bitstring,sigPartS_2252: bitstring));
                                                            {2231}let (=Cli,PartS_2253: bitstring) = dec(ePartS_2251,skCli_2153) in
                                                            {2232}if (verify(h((Cli,PartS_2253)),sigPartS_2252,pkSess_2244) <> true) then
                                                                0
                                                            else
                                                                {2233}event endCli(Sess,Cli,PartS_2253)
                                                        )
                                                        else
                                                            {2234}let v_2254: bool = (Sess = C) in
                                                            (
                                                                {2235}if v_2254 then
                                                                (
                                                                    {2236}let pkSess_2255: bitstring = pub(skC) in
                                                                    {2237}out(c, GetEndpointRequest);
                                                                    {2238}in(c, (SPs_2256: bitstring,=SignAndEncrypt,UP_2257: bitstring,=pkSess_2255));
                                                                    {2239}new SPc_2258: bitstring;
                                                                    {2240}new Nc_2259: bitstring;
                                                                    {2241}let gNc_2260: bitstring = exp(g,Nc_2259) in
                                                                    {2242}let m1_2261: bitstring = (Sess,SPc_2258,gNc_2260) in
                                                                    {2243}event beginCli(Cli,Sess,gNc_2260);
                                                                    {2244}out(c, (pkCli_2154,enc(m1_2261,pkSess_2255),sign(h(m1_2261),skCli_2153)));
                                                                    {2245}in(c, (ePartS_2262: bitstring,sigPartS_2263: bitstring));
                                                                    {2246}let (=Cli,PartS_2264: bitstring) = dec(ePartS_2262,skCli_2153) in
                                                                    {2247}if (verify(h((Cli,PartS_2264)),sigPartS_2263,pkSess_2255) <> true) then
                                                                        0
                                                                    else
                                                                        {2248}event endCli(Sess,Cli,PartS_2264)
                                                                )
                                                                else
                                                                    {2249}let pkSess_2265: bitstring = pub(skI) in
                                                                    {2250}out(c, GetEndpointRequest);
                                                                    {2251}in(c, (SPs_2266: bitstring,=SignAndEncrypt,UP_2267: bitstring,=pkSess_2265));
                                                                    {2252}new SPc_2268: bitstring;
                                                                    {2253}new Nc_2269: bitstring;
                                                                    {2254}let gNc_2270: bitstring = exp(g,Nc_2269) in
                                                                    {2255}let m1_2271: bitstring = (Sess,SPc_2268,gNc_2270) in
                                                                    {2256}event beginCli(Cli,Sess,gNc_2270);
                                                                    {2257}out(c, (pkCli_2154,enc(m1_2271,pkSess_2265),sign(h(m1_2271),skCli_2153)));
                                                                    {2258}in(c, (ePartS_2272: bitstring,sigPartS_2273: bitstring));
                                                                    {2259}let (=Cli,PartS_2274: bitstring) = dec(ePartS_2272,skCli_2153) in
                                                                    {2260}if (verify(h((Cli,PartS_2274)),sigPartS_2273,pkSess_2265) <> true) then
                                                                        0
                                                                    else
                                                                        {2261}event endCli(Sess,Cli,PartS_2274)
                                                            )
                                                            else
                                                                {2262}let pkSess_2275: bitstring = fail-any in
                                                                {2263}out(c, GetEndpointRequest);
                                                                {2264}in(c, (SPs_2276: bitstring,=SignAndEncrypt,UP_2277: bitstring,=pkSess_2275));
                                                                {2265}new SPc_2278: bitstring;
                                                                {2266}new Nc_2279: bitstring;
                                                                {2267}let gNc_2280: bitstring = exp(g,Nc_2279) in
                                                                {2268}let m1_2281: bitstring = (Sess,SPc_2278,gNc_2280) in
                                                                {2269}event beginCli(Cli,Sess,gNc_2280);
                                                                {2270}out(c, (pkCli_2154,enc(m1_2281,pkSess_2275),sign(h(m1_2281),skCli_2153)));
                                                                {2271}in(c, (ePartS_2282: bitstring,sigPartS_2283: bitstring));
                                                                {2272}let (=Cli,PartS_2284: bitstring) = dec(ePartS_2282,skCli_2153) in
                                                                {2273}if (verify(h((Cli,PartS_2284)),sigPartS_2283,pkSess_2275) <> true) then
                                                                    0
                                                                else
                                                                    {2274}event endCli(Sess,Cli,PartS_2284)
                                                    )
                                                    else
                                                        {2275}let pkSess_2285: bitstring = fail-any in
                                                        {2276}out(c, GetEndpointRequest);
                                                        {2277}in(c, (SPs_2286: bitstring,=SignAndEncrypt,UP_2287: bitstring,=pkSess_2285));
                                                        {2278}new SPc_2288: bitstring;
                                                        {2279}new Nc_2289: bitstring;
                                                        {2280}let gNc_2290: bitstring = exp(g,Nc_2289) in
                                                        {2281}let m1_2291: bitstring = (Sess,SPc_2288,gNc_2290) in
                                                        {2282}event beginCli(Cli,Sess,gNc_2290);
                                                        {2283}out(c, (pkCli_2154,enc(m1_2291,pkSess_2285),sign(h(m1_2291),skCli_2153)));
                                                        {2284}in(c, (ePartS_2292: bitstring,sigPartS_2293: bitstring));
                                                        {2285}let (=Cli,PartS_2294: bitstring) = dec(ePartS_2292,skCli_2153) in
                                                        {2286}if (verify(h((Cli,PartS_2294)),sigPartS_2293,pkSess_2285) <> true) then
                                                            0
                                                        else
                                                            {2287}event endCli(Sess,Cli,PartS_2294)
                                            )
                                            else
                                                {2288}let pkSess_2295: bitstring = fail-any in
                                                {2289}out(c, GetEndpointRequest);
                                                {2290}in(c, (SPs_2296: bitstring,=SignAndEncrypt,UP_2297: bitstring,=pkSess_2295));
                                                {2291}new SPc_2298: bitstring;
                                                {2292}new Nc_2299: bitstring;
                                                {2293}let gNc_2300: bitstring = exp(g,Nc_2299) in
                                                {2294}let m1_2301: bitstring = (Sess,SPc_2298,gNc_2300) in
                                                {2295}event beginCli(Cli,Sess,gNc_2300);
                                                {2296}out(c, (pkCli_2154,enc(m1_2301,pkSess_2295),sign(h(m1_2301),skCli_2153)));
                                                {2297}in(c, (ePartS_2302: bitstring,sigPartS_2303: bitstring));
                                                {2298}let (=Cli,PartS_2304: bitstring) = dec(ePartS_2302,skCli_2153) in
                                                {2299}if (verify(h((Cli,PartS_2304)),sigPartS_2303,pkSess_2295) <> true) then
                                                    0
                                                else
                                                    {2300}event endCli(Sess,Cli,PartS_2304)
                                        )
                                        else
                                            {2301}let v_2305: bool = (Disco = C) in
                                            (
                                                {2302}if v_2305 then
                                                (
                                                    {2303}let pkDisco_2306: bitstring = pub(skC) in
                                                    {2304}let v_2307: bool = (Sess = A) in
                                                    (
                                                        {2305}if v_2307 then
                                                        (
                                                            {2306}let pkSess_2308: bitstring = pub(skA) in
                                                            {2307}out(c, GetEndpointRequest);
                                                            {2308}in(c, (SPs_2309: bitstring,=SignAndEncrypt,UP_2310: bitstring,=pkSess_2308));
                                                            {2309}new SPc_2311: bitstring;
                                                            {2310}new Nc_2312: bitstring;
                                                            {2311}let gNc_2313: bitstring = exp(g,Nc_2312) in
                                                            {2312}let m1_2314: bitstring = (Sess,SPc_2311,gNc_2313) in
                                                            {2313}event beginCli(Cli,Sess,gNc_2313);
                                                            {2314}out(c, (pkCli_2154,enc(m1_2314,pkSess_2308),sign(h(m1_2314),skCli_2153)));
                                                            {2315}in(c, (ePartS_2315: bitstring,sigPartS_2316: bitstring));
                                                            {2316}let (=Cli,PartS_2317: bitstring) = dec(ePartS_2315,skCli_2153) in
                                                            {2317}if (verify(h((Cli,PartS_2317)),sigPartS_2316,pkSess_2308) <> true) then
                                                                0
                                                            else
                                                                {2318}event endCli(Sess,Cli,PartS_2317)
                                                        )
                                                        else
                                                            {2319}let v_2318: bool = (Sess = B) in
                                                            (
                                                                {2320}if v_2318 then
                                                                (
                                                                    {2321}let pkSess_2319: bitstring = pub(skB) in
                                                                    {2322}out(c, GetEndpointRequest);
                                                                    {2323}in(c, (SPs_2320: bitstring,=SignAndEncrypt,UP_2321: bitstring,=pkSess_2319));
                                                                    {2324}new SPc_2322: bitstring;
                                                                    {2325}new Nc_2323: bitstring;
                                                                    {2326}let gNc_2324: bitstring = exp(g,Nc_2323) in
                                                                    {2327}let m1_2325: bitstring = (Sess,SPc_2322,gNc_2324) in
                                                                    {2328}event beginCli(Cli,Sess,gNc_2324);
                                                                    {2329}out(c, (pkCli_2154,enc(m1_2325,pkSess_2319),sign(h(m1_2325),skCli_2153)));
                                                                    {2330}in(c, (ePartS_2326: bitstring,sigPartS_2327: bitstring));
                                                                    {2331}let (=Cli,PartS_2328: bitstring) = dec(ePartS_2326,skCli_2153) in
                                                                    {2332}if (verify(h((Cli,PartS_2328)),sigPartS_2327,pkSess_2319) <> true) then
                                                                        0
                                                                    else
                                                                        {2333}event endCli(Sess,Cli,PartS_2328)
                                                                )
                                                                else
                                                                    {2334}let v_2329: bool = (Sess = C) in
                                                                    (
                                                                        {2335}if v_2329 then
                                                                        (
                                                                            {2336}let pkSess_2330: bitstring = pub(skC) in
                                                                            {2337}out(c, GetEndpointRequest);
                                                                            {2338}in(c, (SPs_2331: bitstring,=SignAndEncrypt,UP_2332: bitstring,=pkSess_2330));
                                                                            {2339}new SPc_2333: bitstring;
                                                                            {2340}new Nc_2334: bitstring;
                                                                            {2341}let gNc_2335: bitstring = exp(g,Nc_2334) in
                                                                            {2342}let m1_2336: bitstring = (Sess,SPc_2333,gNc_2335) in
                                                                            {2343}event beginCli(Cli,Sess,gNc_2335);
                                                                            {2344}out(c, (pkCli_2154,enc(m1_2336,pkSess_2330),sign(h(m1_2336),skCli_2153)));
                                                                            {2345}in(c, (ePartS_2337: bitstring,sigPartS_2338: bitstring));
                                                                            {2346}let (=Cli,PartS_2339: bitstring) = dec(ePartS_2337,skCli_2153) in
                                                                            {2347}if (verify(h((Cli,PartS_2339)),sigPartS_2338,pkSess_2330) <> true) then
                                                                                0
                                                                            else
                                                                                {2348}event endCli(Sess,Cli,PartS_2339)
                                                                        )
                                                                        else
                                                                            {2349}let pkSess_2340: bitstring = pub(skI) in
                                                                            {2350}out(c, GetEndpointRequest);
                                                                            {2351}in(c, (SPs_2341: bitstring,=SignAndEncrypt,UP_2342: bitstring,=pkSess_2340));
                                                                            {2352}new SPc_2343: bitstring;
                                                                            {2353}new Nc_2344: bitstring;
                                                                            {2354}let gNc_2345: bitstring = exp(g,Nc_2344) in
                                                                            {2355}let m1_2346: bitstring = (Sess,SPc_2343,gNc_2345) in
                                                                            {2356}event beginCli(Cli,Sess,gNc_2345);
                                                                            {2357}out(c, (pkCli_2154,enc(m1_2346,pkSess_2340),sign(h(m1_2346),skCli_2153)));
                                                                            {2358}in(c, (ePartS_2347: bitstring,sigPartS_2348: bitstring));
                                                                            {2359}let (=Cli,PartS_2349: bitstring) = dec(ePartS_2347,skCli_2153) in
                                                                            {2360}if (verify(h((Cli,PartS_2349)),sigPartS_2348,pkSess_2340) <> true) then
                                                                                0
                                                                            else
                                                                                {2361}event endCli(Sess,Cli,PartS_2349)
                                                                    )
                                                                    else
                                                                        {2362}let pkSess_2350: bitstring = fail-any in
                                                                        {2363}out(c, GetEndpointRequest);
                                                                        {2364}in(c, (SPs_2351: bitstring,=SignAndEncrypt,UP_2352: bitstring,=pkSess_2350));
                                                                        {2365}new SPc_2353: bitstring;
                                                                        {2366}new Nc_2354: bitstring;
                                                                        {2367}let gNc_2355: bitstring = exp(g,Nc_2354) in
                                                                        {2368}let m1_2356: bitstring = (Sess,SPc_2353,gNc_2355) in
                                                                        {2369}event beginCli(Cli,Sess,gNc_2355);
                                                                        {2370}out(c, (pkCli_2154,enc(m1_2356,pkSess_2350),sign(h(m1_2356),skCli_2153)));
                                                                        {2371}in(c, (ePartS_2357: bitstring,sigPartS_2358: bitstring));
                                                                        {2372}let (=Cli,PartS_2359: bitstring) = dec(ePartS_2357,skCli_2153) in
                                                                        {2373}if (verify(h((Cli,PartS_2359)),sigPartS_2358,pkSess_2350) <> true) then
                                                                            0
                                                                        else
                                                                            {2374}event endCli(Sess,Cli,PartS_2359)
                                                            )
                                                            else
                                                                {2375}let pkSess_2360: bitstring = fail-any in
                                                                {2376}out(c, GetEndpointRequest);
                                                                {2377}in(c, (SPs_2361: bitstring,=SignAndEncrypt,UP_2362: bitstring,=pkSess_2360));
                                                                {2378}new SPc_2363: bitstring;
                                                                {2379}new Nc_2364: bitstring;
                                                                {2380}let gNc_2365: bitstring = exp(g,Nc_2364) in
                                                                {2381}let m1_2366: bitstring = (Sess,SPc_2363,gNc_2365) in
                                                                {2382}event beginCli(Cli,Sess,gNc_2365);
                                                                {2383}out(c, (pkCli_2154,enc(m1_2366,pkSess_2360),sign(h(m1_2366),skCli_2153)));
                                                                {2384}in(c, (ePartS_2367: bitstring,sigPartS_2368: bitstring));
                                                                {2385}let (=Cli,PartS_2369: bitstring) = dec(ePartS_2367,skCli_2153) in
                                                                {2386}if (verify(h((Cli,PartS_2369)),sigPartS_2368,pkSess_2360) <> true) then
                                                                    0
                                                                else
                                                                    {2387}event endCli(Sess,Cli,PartS_2369)
                                                    )
                                                    else
                                                        {2388}let pkSess_2370: bitstring = fail-any in
                                                        {2389}out(c, GetEndpointRequest);
                                                        {2390}in(c, (SPs_2371: bitstring,=SignAndEncrypt,UP_2372: bitstring,=pkSess_2370));
                                                        {2391}new SPc_2373: bitstring;
                                                        {2392}new Nc_2374: bitstring;
                                                        {2393}let gNc_2375: bitstring = exp(g,Nc_2374) in
                                                        {2394}let m1_2376: bitstring = (Sess,SPc_2373,gNc_2375) in
                                                        {2395}event beginCli(Cli,Sess,gNc_2375);
                                                        {2396}out(c, (pkCli_2154,enc(m1_2376,pkSess_2370),sign(h(m1_2376),skCli_2153)));
                                                        {2397}in(c, (ePartS_2377: bitstring,sigPartS_2378: bitstring));
                                                        {2398}let (=Cli,PartS_2379: bitstring) = dec(ePartS_2377,skCli_2153) in
                                                        {2399}if (verify(h((Cli,PartS_2379)),sigPartS_2378,pkSess_2370) <> true) then
                                                            0
                                                        else
                                                            {2400}event endCli(Sess,Cli,PartS_2379)
                                                )
                                                else
                                                    {2401}let pkDisco_2380: bitstring = pub(skI) in
                                                    {2402}let v_2381: bool = (Sess = A) in
                                                    (
                                                        {2403}if v_2381 then
                                                        (
                                                            {2404}let pkSess_2382: bitstring = pub(skA) in
                                                            {2405}out(c, GetEndpointRequest);
                                                            {2406}in(c, (SPs_2383: bitstring,=SignAndEncrypt,UP_2384: bitstring,=pkSess_2382));
                                                            {2407}new SPc_2385: bitstring;
                                                            {2408}new Nc_2386: bitstring;
                                                            {2409}let gNc_2387: bitstring = exp(g,Nc_2386) in
                                                            {2410}let m1_2388: bitstring = (Sess,SPc_2385,gNc_2387) in
                                                            {2411}event beginCli(Cli,Sess,gNc_2387);
                                                            {2412}out(c, (pkCli_2154,enc(m1_2388,pkSess_2382),sign(h(m1_2388),skCli_2153)));
                                                            {2413}in(c, (ePartS_2389: bitstring,sigPartS_2390: bitstring));
                                                            {2414}let (=Cli,PartS_2391: bitstring) = dec(ePartS_2389,skCli_2153) in
                                                            {2415}if (verify(h((Cli,PartS_2391)),sigPartS_2390,pkSess_2382) <> true) then
                                                                0
                                                            else
                                                                {2416}event endCli(Sess,Cli,PartS_2391)
                                                        )
                                                        else
                                                            {2417}let v_2392: bool = (Sess = B) in
                                                            (
                                                                {2418}if v_2392 then
                                                                (
                                                                    {2419}let pkSess_2393: bitstring = pub(skB) in
                                                                    {2420}out(c, GetEndpointRequest);
                                                                    {2421}in(c, (SPs_2394: bitstring,=SignAndEncrypt,UP_2395: bitstring,=pkSess_2393));
                                                                    {2422}new SPc_2396: bitstring;
                                                                    {2423}new Nc_2397: bitstring;
                                                                    {2424}let gNc_2398: bitstring = exp(g,Nc_2397) in
                                                                    {2425}let m1_2399: bitstring = (Sess,SPc_2396,gNc_2398) in
                                                                    {2426}event beginCli(Cli,Sess,gNc_2398);
                                                                    {2427}out(c, (pkCli_2154,enc(m1_2399,pkSess_2393),sign(h(m1_2399),skCli_2153)));
                                                                    {2428}in(c, (ePartS_2400: bitstring,sigPartS_2401: bitstring));
                                                                    {2429}let (=Cli,PartS_2402: bitstring) = dec(ePartS_2400,skCli_2153) in
                                                                    {2430}if (verify(h((Cli,PartS_2402)),sigPartS_2401,pkSess_2393) <> true) then
                                                                        0
                                                                    else
                                                                        {2431}event endCli(Sess,Cli,PartS_2402)
                                                                )
                                                                else
                                                                    {2432}let v_2403: bool = (Sess = C) in
                                                                    (
                                                                        {2433}if v_2403 then
                                                                        (
                                                                            {2434}let pkSess_2404: bitstring = pub(skC) in
                                                                            {2435}out(c, GetEndpointRequest);
                                                                            {2436}in(c, (SPs_2405: bitstring,=SignAndEncrypt,UP_2406: bitstring,=pkSess_2404));
                                                                            {2437}new SPc_2407: bitstring;
                                                                            {2438}new Nc_2408: bitstring;
                                                                            {2439}let gNc_2409: bitstring = exp(g,Nc_2408) in
                                                                            {2440}let m1_2410: bitstring = (Sess,SPc_2407,gNc_2409) in
                                                                            {2441}event beginCli(Cli,Sess,gNc_2409);
                                                                            {2442}out(c, (pkCli_2154,enc(m1_2410,pkSess_2404),sign(h(m1_2410),skCli_2153)));
                                                                            {2443}in(c, (ePartS_2411: bitstring,sigPartS_2412: bitstring));
                                                                            {2444}let (=Cli,PartS_2413: bitstring) = dec(ePartS_2411,skCli_2153) in
                                                                            {2445}if (verify(h((Cli,PartS_2413)),sigPartS_2412,pkSess_2404) <> true) then
                                                                                0
                                                                            else
                                                                                {2446}event endCli(Sess,Cli,PartS_2413)
                                                                        )
                                                                        else
                                                                            {2447}let pkSess_2414: bitstring = pub(skI) in
                                                                            {2448}out(c, GetEndpointRequest);
                                                                            {2449}in(c, (SPs_2415: bitstring,=SignAndEncrypt,UP_2416: bitstring,=pkSess_2414));
                                                                            {2450}new SPc_2417: bitstring;
                                                                            {2451}new Nc_2418: bitstring;
                                                                            {2452}let gNc_2419: bitstring = exp(g,Nc_2418) in
                                                                            {2453}let m1_2420: bitstring = (Sess,SPc_2417,gNc_2419) in
                                                                            {2454}event beginCli(Cli,Sess,gNc_2419);
                                                                            {2455}out(c, (pkCli_2154,enc(m1_2420,pkSess_2414),sign(h(m1_2420),skCli_2153)));
                                                                            {2456}in(c, (ePartS_2421: bitstring,sigPartS_2422: bitstring));
                                                                            {2457}let (=Cli,PartS_2423: bitstring) = dec(ePartS_2421,skCli_2153) in
                                                                            {2458}if (verify(h((Cli,PartS_2423)),sigPartS_2422,pkSess_2414) <> true) then
                                                                                0
                                                                            else
                                                                                {2459}event endCli(Sess,Cli,PartS_2423)
                                                                    )
                                                                    else
                                                                        {2460}let pkSess_2424: bitstring = fail-any in
                                                                        {2461}out(c, GetEndpointRequest);
                                                                        {2462}in(c, (SPs_2425: bitstring,=SignAndEncrypt,UP_2426: bitstring,=pkSess_2424));
                                                                        {2463}new SPc_2427: bitstring;
                                                                        {2464}new Nc_2428: bitstring;
                                                                        {2465}let gNc_2429: bitstring = exp(g,Nc_2428) in
                                                                        {2466}let m1_2430: bitstring = (Sess,SPc_2427,gNc_2429) in
                                                                        {2467}event beginCli(Cli,Sess,gNc_2429);
                                                                        {2468}out(c, (pkCli_2154,enc(m1_2430,pkSess_2424),sign(h(m1_2430),skCli_2153)));
                                                                        {2469}in(c, (ePartS_2431: bitstring,sigPartS_2432: bitstring));
                                                                        {2470}let (=Cli,PartS_2433: bitstring) = dec(ePartS_2431,skCli_2153) in
                                                                        {2471}if (verify(h((Cli,PartS_2433)),sigPartS_2432,pkSess_2424) <> true) then
                                                                            0
                                                                        else
                                                                            {2472}event endCli(Sess,Cli,PartS_2433)
                                                            )
                                                            else
                                                                {2473}let pkSess_2434: bitstring = fail-any in
                                                                {2474}out(c, GetEndpointRequest);
                                                                {2475}in(c, (SPs_2435: bitstring,=SignAndEncrypt,UP_2436: bitstring,=pkSess_2434));
                                                                {2476}new SPc_2437: bitstring;
                                                                {2477}new Nc_2438: bitstring;
                                                                {2478}let gNc_2439: bitstring = exp(g,Nc_2438) in
                                                                {2479}let m1_2440: bitstring = (Sess,SPc_2437,gNc_2439) in
                                                                {2480}event beginCli(Cli,Sess,gNc_2439);
                                                                {2481}out(c, (pkCli_2154,enc(m1_2440,pkSess_2434),sign(h(m1_2440),skCli_2153)));
                                                                {2482}in(c, (ePartS_2441: bitstring,sigPartS_2442: bitstring));
                                                                {2483}let (=Cli,PartS_2443: bitstring) = dec(ePartS_2441,skCli_2153) in
                                                                {2484}if (verify(h((Cli,PartS_2443)),sigPartS_2442,pkSess_2434) <> true) then
                                                                    0
                                                                else
                                                                    {2485}event endCli(Sess,Cli,PartS_2443)
                                                    )
                                                    else
                                                        {2486}let pkSess_2444: bitstring = fail-any in
                                                        {2487}out(c, GetEndpointRequest);
                                                        {2488}in(c, (SPs_2445: bitstring,=SignAndEncrypt,UP_2446: bitstring,=pkSess_2444));
                                                        {2489}new SPc_2447: bitstring;
                                                        {2490}new Nc_2448: bitstring;
                                                        {2491}let gNc_2449: bitstring = exp(g,Nc_2448) in
                                                        {2492}let m1_2450: bitstring = (Sess,SPc_2447,gNc_2449) in
                                                        {2493}event beginCli(Cli,Sess,gNc_2449);
                                                        {2494}out(c, (pkCli_2154,enc(m1_2450,pkSess_2444),sign(h(m1_2450),skCli_2153)));
                                                        {2495}in(c, (ePartS_2451: bitstring,sigPartS_2452: bitstring));
                                                        {2496}let (=Cli,PartS_2453: bitstring) = dec(ePartS_2451,skCli_2153) in
                                                        {2497}if (verify(h((Cli,PartS_2453)),sigPartS_2452,pkSess_2444) <> true) then
                                                            0
                                                        else
                                                            {2498}event endCli(Sess,Cli,PartS_2453)
                                            )
                                            else
                                                {2499}let pkDisco_2454: bitstring = fail-any in
                                                {2500}let v_2455: bool = (Sess = A) in
                                                (
                                                    {2501}if v_2455 then
                                                    (
                                                        {2502}let pkSess_2456: bitstring = pub(skA) in
                                                        {2503}out(c, GetEndpointRequest);
                                                        {2504}in(c, (SPs_2457: bitstring,=SignAndEncrypt,UP_2458: bitstring,=pkSess_2456));
                                                        {2505}new SPc_2459: bitstring;
                                                        {2506}new Nc_2460: bitstring;
                                                        {2507}let gNc_2461: bitstring = exp(g,Nc_2460) in
                                                        {2508}let m1_2462: bitstring = (Sess,SPc_2459,gNc_2461) in
                                                        {2509}event beginCli(Cli,Sess,gNc_2461);
                                                        {2510}out(c, (pkCli_2154,enc(m1_2462,pkSess_2456),sign(h(m1_2462),skCli_2153)));
                                                        {2511}in(c, (ePartS_2463: bitstring,sigPartS_2464: bitstring));
                                                        {2512}let (=Cli,PartS_2465: bitstring) = dec(ePartS_2463,skCli_2153) in
                                                        {2513}if (verify(h((Cli,PartS_2465)),sigPartS_2464,pkSess_2456) <> true) then
                                                            0
                                                        else
                                                            {2514}event endCli(Sess,Cli,PartS_2465)
                                                    )
                                                    else
                                                        {2515}let v_2466: bool = (Sess = B) in
                                                        (
                                                            {2516}if v_2466 then
                                                            (
                                                                {2517}let pkSess_2467: bitstring = pub(skB) in
                                                                {2518}out(c, GetEndpointRequest);
                                                                {2519}in(c, (SPs_2468: bitstring,=SignAndEncrypt,UP_2469: bitstring,=pkSess_2467));
                                                                {2520}new SPc_2470: bitstring;
                                                                {2521}new Nc_2471: bitstring;
                                                                {2522}let gNc_2472: bitstring = exp(g,Nc_2471) in
                                                                {2523}let m1_2473: bitstring = (Sess,SPc_2470,gNc_2472) in
                                                                {2524}event beginCli(Cli,Sess,gNc_2472);
                                                                {2525}out(c, (pkCli_2154,enc(m1_2473,pkSess_2467),sign(h(m1_2473),skCli_2153)));
                                                                {2526}in(c, (ePartS_2474: bitstring,sigPartS_2475: bitstring));
                                                                {2527}let (=Cli,PartS_2476: bitstring) = dec(ePartS_2474,skCli_2153) in
                                                                {2528}if (verify(h((Cli,PartS_2476)),sigPartS_2475,pkSess_2467) <> true) then
                                                                    0
                                                                else
                                                                    {2529}event endCli(Sess,Cli,PartS_2476)
                                                            )
                                                            else
                                                                {2530}let v_2477: bool = (Sess = C) in
                                                                (
                                                                    {2531}if v_2477 then
                                                                    (
                                                                        {2532}let pkSess_2478: bitstring = pub(skC) in
                                                                        {2533}out(c, GetEndpointRequest);
                                                                        {2534}in(c, (SPs_2479: bitstring,=SignAndEncrypt,UP_2480: bitstring,=pkSess_2478));
                                                                        {2535}new SPc_2481: bitstring;
                                                                        {2536}new Nc_2482: bitstring;
                                                                        {2537}let gNc_2483: bitstring = exp(g,Nc_2482) in
                                                                        {2538}let m1_2484: bitstring = (Sess,SPc_2481,gNc_2483) in
                                                                        {2539}event beginCli(Cli,Sess,gNc_2483);
                                                                        {2540}out(c, (pkCli_2154,enc(m1_2484,pkSess_2478),sign(h(m1_2484),skCli_2153)));
                                                                        {2541}in(c, (ePartS_2485: bitstring,sigPartS_2486: bitstring));
                                                                        {2542}let (=Cli,PartS_2487: bitstring) = dec(ePartS_2485,skCli_2153) in
                                                                        {2543}if (verify(h((Cli,PartS_2487)),sigPartS_2486,pkSess_2478) <> true) then
                                                                            0
                                                                        else
                                                                            {2544}event endCli(Sess,Cli,PartS_2487)
                                                                    )
                                                                    else
                                                                        {2545}let pkSess_2488: bitstring = pub(skI) in
                                                                        {2546}out(c, GetEndpointRequest);
                                                                        {2547}in(c, (SPs_2489: bitstring,=SignAndEncrypt,UP_2490: bitstring,=pkSess_2488));
                                                                        {2548}new SPc_2491: bitstring;
                                                                        {2549}new Nc_2492: bitstring;
                                                                        {2550}let gNc_2493: bitstring = exp(g,Nc_2492) in
                                                                        {2551}let m1_2494: bitstring = (Sess,SPc_2491,gNc_2493) in
                                                                        {2552}event beginCli(Cli,Sess,gNc_2493);
                                                                        {2553}out(c, (pkCli_2154,enc(m1_2494,pkSess_2488),sign(h(m1_2494),skCli_2153)));
                                                                        {2554}in(c, (ePartS_2495: bitstring,sigPartS_2496: bitstring));
                                                                        {2555}let (=Cli,PartS_2497: bitstring) = dec(ePartS_2495,skCli_2153) in
                                                                        {2556}if (verify(h((Cli,PartS_2497)),sigPartS_2496,pkSess_2488) <> true) then
                                                                            0
                                                                        else
                                                                            {2557}event endCli(Sess,Cli,PartS_2497)
                                                                )
                                                                else
                                                                    {2558}let pkSess_2498: bitstring = fail-any in
                                                                    {2559}out(c, GetEndpointRequest);
                                                                    {2560}in(c, (SPs_2499: bitstring,=SignAndEncrypt,UP_2500: bitstring,=pkSess_2498));
                                                                    {2561}new SPc_2501: bitstring;
                                                                    {2562}new Nc_2502: bitstring;
                                                                    {2563}let gNc_2503: bitstring = exp(g,Nc_2502) in
                                                                    {2564}let m1_2504: bitstring = (Sess,SPc_2501,gNc_2503) in
                                                                    {2565}event beginCli(Cli,Sess,gNc_2503);
                                                                    {2566}out(c, (pkCli_2154,enc(m1_2504,pkSess_2498),sign(h(m1_2504),skCli_2153)));
                                                                    {2567}in(c, (ePartS_2505: bitstring,sigPartS_2506: bitstring));
                                                                    {2568}let (=Cli,PartS_2507: bitstring) = dec(ePartS_2505,skCli_2153) in
                                                                    {2569}if (verify(h((Cli,PartS_2507)),sigPartS_2506,pkSess_2498) <> true) then
                                                                        0
                                                                    else
                                                                        {2570}event endCli(Sess,Cli,PartS_2507)
                                                        )
                                                        else
                                                            {2571}let pkSess_2508: bitstring = fail-any in
                                                            {2572}out(c, GetEndpointRequest);
                                                            {2573}in(c, (SPs_2509: bitstring,=SignAndEncrypt,UP_2510: bitstring,=pkSess_2508));
                                                            {2574}new SPc_2511: bitstring;
                                                            {2575}new Nc_2512: bitstring;
                                                            {2576}let gNc_2513: bitstring = exp(g,Nc_2512) in
                                                            {2577}let m1_2514: bitstring = (Sess,SPc_2511,gNc_2513) in
                                                            {2578}event beginCli(Cli,Sess,gNc_2513);
                                                            {2579}out(c, (pkCli_2154,enc(m1_2514,pkSess_2508),sign(h(m1_2514),skCli_2153)));
                                                            {2580}in(c, (ePartS_2515: bitstring,sigPartS_2516: bitstring));
                                                            {2581}let (=Cli,PartS_2517: bitstring) = dec(ePartS_2515,skCli_2153) in
                                                            {2582}if (verify(h((Cli,PartS_2517)),sigPartS_2516,pkSess_2508) <> true) then
                                                                0
                                                            else
                                                                {2583}event endCli(Sess,Cli,PartS_2517)
                                                )
                                                else
                                                    {2584}let pkSess_2518: bitstring = fail-any in
                                                    {2585}out(c, GetEndpointRequest);
                                                    {2586}in(c, (SPs_2519: bitstring,=SignAndEncrypt,UP_2520: bitstring,=pkSess_2518));
                                                    {2587}new SPc_2521: bitstring;
                                                    {2588}new Nc_2522: bitstring;
                                                    {2589}let gNc_2523: bitstring = exp(g,Nc_2522) in
                                                    {2590}let m1_2524: bitstring = (Sess,SPc_2521,gNc_2523) in
                                                    {2591}event beginCli(Cli,Sess,gNc_2523);
                                                    {2592}out(c, (pkCli_2154,enc(m1_2524,pkSess_2518),sign(h(m1_2524),skCli_2153)));
                                                    {2593}in(c, (ePartS_2525: bitstring,sigPartS_2526: bitstring));
                                                    {2594}let (=Cli,PartS_2527: bitstring) = dec(ePartS_2525,skCli_2153) in
                                                    {2595}if (verify(h((Cli,PartS_2527)),sigPartS_2526,pkSess_2518) <> true) then
                                                        0
                                                    else
                                                        {2596}event endCli(Sess,Cli,PartS_2527)
                                    )
                                    else
                                        {2597}let pkDisco_2528: bitstring = fail-any in
                                        {2598}let v_2529: bool = (Sess = A) in
                                        (
                                            {2599}if v_2529 then
                                            (
                                                {2600}let pkSess_2530: bitstring = pub(skA) in
                                                {2601}out(c, GetEndpointRequest);
                                                {2602}in(c, (SPs_2531: bitstring,=SignAndEncrypt,UP_2532: bitstring,=pkSess_2530));
                                                {2603}new SPc_2533: bitstring;
                                                {2604}new Nc_2534: bitstring;
                                                {2605}let gNc_2535: bitstring = exp(g,Nc_2534) in
                                                {2606}let m1_2536: bitstring = (Sess,SPc_2533,gNc_2535) in
                                                {2607}event beginCli(Cli,Sess,gNc_2535);
                                                {2608}out(c, (pkCli_2154,enc(m1_2536,pkSess_2530),sign(h(m1_2536),skCli_2153)));
                                                {2609}in(c, (ePartS_2537: bitstring,sigPartS_2538: bitstring));
                                                {2610}let (=Cli,PartS_2539: bitstring) = dec(ePartS_2537,skCli_2153) in
                                                {2611}if (verify(h((Cli,PartS_2539)),sigPartS_2538,pkSess_2530) <> true) then
                                                    0
                                                else
                                                    {2612}event endCli(Sess,Cli,PartS_2539)
                                            )
                                            else
                                                {2613}let v_2540: bool = (Sess = B) in
                                                (
                                                    {2614}if v_2540 then
                                                    (
                                                        {2615}let pkSess_2541: bitstring = pub(skB) in
                                                        {2616}out(c, GetEndpointRequest);
                                                        {2617}in(c, (SPs_2542: bitstring,=SignAndEncrypt,UP_2543: bitstring,=pkSess_2541));
                                                        {2618}new SPc_2544: bitstring;
                                                        {2619}new Nc_2545: bitstring;
                                                        {2620}let gNc_2546: bitstring = exp(g,Nc_2545) in
                                                        {2621}let m1_2547: bitstring = (Sess,SPc_2544,gNc_2546) in
                                                        {2622}event beginCli(Cli,Sess,gNc_2546);
                                                        {2623}out(c, (pkCli_2154,enc(m1_2547,pkSess_2541),sign(h(m1_2547),skCli_2153)));
                                                        {2624}in(c, (ePartS_2548: bitstring,sigPartS_2549: bitstring));
                                                        {2625}let (=Cli,PartS_2550: bitstring) = dec(ePartS_2548,skCli_2153) in
                                                        {2626}if (verify(h((Cli,PartS_2550)),sigPartS_2549,pkSess_2541) <> true) then
                                                            0
                                                        else
                                                            {2627}event endCli(Sess,Cli,PartS_2550)
                                                    )
                                                    else
                                                        {2628}let v_2551: bool = (Sess = C) in
                                                        (
                                                            {2629}if v_2551 then
                                                            (
                                                                {2630}let pkSess_2552: bitstring = pub(skC) in
                                                                {2631}out(c, GetEndpointRequest);
                                                                {2632}in(c, (SPs_2553: bitstring,=SignAndEncrypt,UP_2554: bitstring,=pkSess_2552));
                                                                {2633}new SPc_2555: bitstring;
                                                                {2634}new Nc_2556: bitstring;
                                                                {2635}let gNc_2557: bitstring = exp(g,Nc_2556) in
                                                                {2636}let m1_2558: bitstring = (Sess,SPc_2555,gNc_2557) in
                                                                {2637}event beginCli(Cli,Sess,gNc_2557);
                                                                {2638}out(c, (pkCli_2154,enc(m1_2558,pkSess_2552),sign(h(m1_2558),skCli_2153)));
                                                                {2639}in(c, (ePartS_2559: bitstring,sigPartS_2560: bitstring));
                                                                {2640}let (=Cli,PartS_2561: bitstring) = dec(ePartS_2559,skCli_2153) in
                                                                {2641}if (verify(h((Cli,PartS_2561)),sigPartS_2560,pkSess_2552) <> true) then
                                                                    0
                                                                else
                                                                    {2642}event endCli(Sess,Cli,PartS_2561)
                                                            )
                                                            else
                                                                {2643}let pkSess_2562: bitstring = pub(skI) in
                                                                {2644}out(c, GetEndpointRequest);
                                                                {2645}in(c, (SPs_2563: bitstring,=SignAndEncrypt,UP_2564: bitstring,=pkSess_2562));
                                                                {2646}new SPc_2565: bitstring;
                                                                {2647}new Nc_2566: bitstring;
                                                                {2648}let gNc_2567: bitstring = exp(g,Nc_2566) in
                                                                {2649}let m1_2568: bitstring = (Sess,SPc_2565,gNc_2567) in
                                                                {2650}event beginCli(Cli,Sess,gNc_2567);
                                                                {2651}out(c, (pkCli_2154,enc(m1_2568,pkSess_2562),sign(h(m1_2568),skCli_2153)));
                                                                {2652}in(c, (ePartS_2569: bitstring,sigPartS_2570: bitstring));
                                                                {2653}let (=Cli,PartS_2571: bitstring) = dec(ePartS_2569,skCli_2153) in
                                                                {2654}if (verify(h((Cli,PartS_2571)),sigPartS_2570,pkSess_2562) <> true) then
                                                                    0
                                                                else
                                                                    {2655}event endCli(Sess,Cli,PartS_2571)
                                                        )
                                                        else
                                                            {2656}let pkSess_2572: bitstring = fail-any in
                                                            {2657}out(c, GetEndpointRequest);
                                                            {2658}in(c, (SPs_2573: bitstring,=SignAndEncrypt,UP_2574: bitstring,=pkSess_2572));
                                                            {2659}new SPc_2575: bitstring;
                                                            {2660}new Nc_2576: bitstring;
                                                            {2661}let gNc_2577: bitstring = exp(g,Nc_2576) in
                                                            {2662}let m1_2578: bitstring = (Sess,SPc_2575,gNc_2577) in
                                                            {2663}event beginCli(Cli,Sess,gNc_2577);
                                                            {2664}out(c, (pkCli_2154,enc(m1_2578,pkSess_2572),sign(h(m1_2578),skCli_2153)));
                                                            {2665}in(c, (ePartS_2579: bitstring,sigPartS_2580: bitstring));
                                                            {2666}let (=Cli,PartS_2581: bitstring) = dec(ePartS_2579,skCli_2153) in
                                                            {2667}if (verify(h((Cli,PartS_2581)),sigPartS_2580,pkSess_2572) <> true) then
                                                                0
                                                            else
                                                                {2668}event endCli(Sess,Cli,PartS_2581)
                                                )
                                                else
                                                    {2669}let pkSess_2582: bitstring = fail-any in
                                                    {2670}out(c, GetEndpointRequest);
                                                    {2671}in(c, (SPs_2583: bitstring,=SignAndEncrypt,UP_2584: bitstring,=pkSess_2582));
                                                    {2672}new SPc_2585: bitstring;
                                                    {2673}new Nc_2586: bitstring;
                                                    {2674}let gNc_2587: bitstring = exp(g,Nc_2586) in
                                                    {2675}let m1_2588: bitstring = (Sess,SPc_2585,gNc_2587) in
                                                    {2676}event beginCli(Cli,Sess,gNc_2587);
                                                    {2677}out(c, (pkCli_2154,enc(m1_2588,pkSess_2582),sign(h(m1_2588),skCli_2153)));
                                                    {2678}in(c, (ePartS_2589: bitstring,sigPartS_2590: bitstring));
                                                    {2679}let (=Cli,PartS_2591: bitstring) = dec(ePartS_2589,skCli_2153) in
                                                    {2680}if (verify(h((Cli,PartS_2591)),sigPartS_2590,pkSess_2582) <> true) then
                                                        0
                                                    else
                                                        {2681}event endCli(Sess,Cli,PartS_2591)
                                        )
                                        else
                                            {2682}let pkSess_2592: bitstring = fail-any in
                                            {2683}out(c, GetEndpointRequest);
                                            {2684}in(c, (SPs_2593: bitstring,=SignAndEncrypt,UP_2594: bitstring,=pkSess_2592));
                                            {2685}new SPc_2595: bitstring;
                                            {2686}new Nc_2596: bitstring;
                                            {2687}let gNc_2597: bitstring = exp(g,Nc_2596) in
                                            {2688}let m1_2598: bitstring = (Sess,SPc_2595,gNc_2597) in
                                            {2689}event beginCli(Cli,Sess,gNc_2597);
                                            {2690}out(c, (pkCli_2154,enc(m1_2598,pkSess_2592),sign(h(m1_2598),skCli_2153)));
                                            {2691}in(c, (ePartS_2599: bitstring,sigPartS_2600: bitstring));
                                            {2692}let (=Cli,PartS_2601: bitstring) = dec(ePartS_2599,skCli_2153) in
                                            {2693}if (verify(h((Cli,PartS_2601)),sigPartS_2600,pkSess_2592) <> true) then
                                                0
                                            else
                                                {2694}event endCli(Sess,Cli,PartS_2601)
                            )
                            else
                                {2695}let pkDisco_2602: bitstring = fail-any in
                                {2696}let v_2603: bool = (Sess = A) in
                                (
                                    {2697}if v_2603 then
                                    (
                                        {2698}let pkSess_2604: bitstring = pub(skA) in
                                        {2699}out(c, GetEndpointRequest);
                                        {2700}in(c, (SPs_2605: bitstring,=SignAndEncrypt,UP_2606: bitstring,=pkSess_2604));
                                        {2701}new SPc_2607: bitstring;
                                        {2702}new Nc_2608: bitstring;
                                        {2703}let gNc_2609: bitstring = exp(g,Nc_2608) in
                                        {2704}let m1_2610: bitstring = (Sess,SPc_2607,gNc_2609) in
                                        {2705}event beginCli(Cli,Sess,gNc_2609);
                                        {2706}out(c, (pkCli_2154,enc(m1_2610,pkSess_2604),sign(h(m1_2610),skCli_2153)));
                                        {2707}in(c, (ePartS_2611: bitstring,sigPartS_2612: bitstring));
                                        {2708}let (=Cli,PartS_2613: bitstring) = dec(ePartS_2611,skCli_2153) in
                                        {2709}if (verify(h((Cli,PartS_2613)),sigPartS_2612,pkSess_2604) <> true) then
                                            0
                                        else
                                            {2710}event endCli(Sess,Cli,PartS_2613)
                                    )
                                    else
                                        {2711}let v_2614: bool = (Sess = B) in
                                        (
                                            {2712}if v_2614 then
                                            (
                                                {2713}let pkSess_2615: bitstring = pub(skB) in
                                                {2714}out(c, GetEndpointRequest);
                                                {2715}in(c, (SPs_2616: bitstring,=SignAndEncrypt,UP_2617: bitstring,=pkSess_2615));
                                                {2716}new SPc_2618: bitstring;
                                                {2717}new Nc_2619: bitstring;
                                                {2718}let gNc_2620: bitstring = exp(g,Nc_2619) in
                                                {2719}let m1_2621: bitstring = (Sess,SPc_2618,gNc_2620) in
                                                {2720}event beginCli(Cli,Sess,gNc_2620);
                                                {2721}out(c, (pkCli_2154,enc(m1_2621,pkSess_2615),sign(h(m1_2621),skCli_2153)));
                                                {2722}in(c, (ePartS_2622: bitstring,sigPartS_2623: bitstring));
                                                {2723}let (=Cli,PartS_2624: bitstring) = dec(ePartS_2622,skCli_2153) in
                                                {2724}if (verify(h((Cli,PartS_2624)),sigPartS_2623,pkSess_2615) <> true) then
                                                    0
                                                else
                                                    {2725}event endCli(Sess,Cli,PartS_2624)
                                            )
                                            else
                                                {2726}let v_2625: bool = (Sess = C) in
                                                (
                                                    {2727}if v_2625 then
                                                    (
                                                        {2728}let pkSess_2626: bitstring = pub(skC) in
                                                        {2729}out(c, GetEndpointRequest);
                                                        {2730}in(c, (SPs_2627: bitstring,=SignAndEncrypt,UP_2628: bitstring,=pkSess_2626));
                                                        {2731}new SPc_2629: bitstring;
                                                        {2732}new Nc_2630: bitstring;
                                                        {2733}let gNc_2631: bitstring = exp(g,Nc_2630) in
                                                        {2734}let m1_2632: bitstring = (Sess,SPc_2629,gNc_2631) in
                                                        {2735}event beginCli(Cli,Sess,gNc_2631);
                                                        {2736}out(c, (pkCli_2154,enc(m1_2632,pkSess_2626),sign(h(m1_2632),skCli_2153)));
                                                        {2737}in(c, (ePartS_2633: bitstring,sigPartS_2634: bitstring));
                                                        {2738}let (=Cli,PartS_2635: bitstring) = dec(ePartS_2633,skCli_2153) in
                                                        {2739}if (verify(h((Cli,PartS_2635)),sigPartS_2634,pkSess_2626) <> true) then
                                                            0
                                                        else
                                                            {2740}event endCli(Sess,Cli,PartS_2635)
                                                    )
                                                    else
                                                        {2741}let pkSess_2636: bitstring = pub(skI) in
                                                        {2742}out(c, GetEndpointRequest);
                                                        {2743}in(c, (SPs_2637: bitstring,=SignAndEncrypt,UP_2638: bitstring,=pkSess_2636));
                                                        {2744}new SPc_2639: bitstring;
                                                        {2745}new Nc_2640: bitstring;
                                                        {2746}let gNc_2641: bitstring = exp(g,Nc_2640) in
                                                        {2747}let m1_2642: bitstring = (Sess,SPc_2639,gNc_2641) in
                                                        {2748}event beginCli(Cli,Sess,gNc_2641);
                                                        {2749}out(c, (pkCli_2154,enc(m1_2642,pkSess_2636),sign(h(m1_2642),skCli_2153)));
                                                        {2750}in(c, (ePartS_2643: bitstring,sigPartS_2644: bitstring));
                                                        {2751}let (=Cli,PartS_2645: bitstring) = dec(ePartS_2643,skCli_2153) in
                                                        {2752}if (verify(h((Cli,PartS_2645)),sigPartS_2644,pkSess_2636) <> true) then
                                                            0
                                                        else
                                                            {2753}event endCli(Sess,Cli,PartS_2645)
                                                )
                                                else
                                                    {2754}let pkSess_2646: bitstring = fail-any in
                                                    {2755}out(c, GetEndpointRequest);
                                                    {2756}in(c, (SPs_2647: bitstring,=SignAndEncrypt,UP_2648: bitstring,=pkSess_2646));
                                                    {2757}new SPc_2649: bitstring;
                                                    {2758}new Nc_2650: bitstring;
                                                    {2759}let gNc_2651: bitstring = exp(g,Nc_2650) in
                                                    {2760}let m1_2652: bitstring = (Sess,SPc_2649,gNc_2651) in
                                                    {2761}event beginCli(Cli,Sess,gNc_2651);
                                                    {2762}out(c, (pkCli_2154,enc(m1_2652,pkSess_2646),sign(h(m1_2652),skCli_2153)));
                                                    {2763}in(c, (ePartS_2653: bitstring,sigPartS_2654: bitstring));
                                                    {2764}let (=Cli,PartS_2655: bitstring) = dec(ePartS_2653,skCli_2153) in
                                                    {2765}if (verify(h((Cli,PartS_2655)),sigPartS_2654,pkSess_2646) <> true) then
                                                        0
                                                    else
                                                        {2766}event endCli(Sess,Cli,PartS_2655)
                                        )
                                        else
                                            {2767}let pkSess_2656: bitstring = fail-any in
                                            {2768}out(c, GetEndpointRequest);
                                            {2769}in(c, (SPs_2657: bitstring,=SignAndEncrypt,UP_2658: bitstring,=pkSess_2656));
                                            {2770}new SPc_2659: bitstring;
                                            {2771}new Nc_2660: bitstring;
                                            {2772}let gNc_2661: bitstring = exp(g,Nc_2660) in
                                            {2773}let m1_2662: bitstring = (Sess,SPc_2659,gNc_2661) in
                                            {2774}event beginCli(Cli,Sess,gNc_2661);
                                            {2775}out(c, (pkCli_2154,enc(m1_2662,pkSess_2656),sign(h(m1_2662),skCli_2153)));
                                            {2776}in(c, (ePartS_2663: bitstring,sigPartS_2664: bitstring));
                                            {2777}let (=Cli,PartS_2665: bitstring) = dec(ePartS_2663,skCli_2153) in
                                            {2778}if (verify(h((Cli,PartS_2665)),sigPartS_2664,pkSess_2656) <> true) then
                                                0
                                            else
                                                {2779}event endCli(Sess,Cli,PartS_2665)
                                )
                                else
                                    {2780}let pkSess_2666: bitstring = fail-any in
                                    {2781}out(c, GetEndpointRequest);
                                    {2782}in(c, (SPs_2667: bitstring,=SignAndEncrypt,UP_2668: bitstring,=pkSess_2666));
                                    {2783}new SPc_2669: bitstring;
                                    {2784}new Nc_2670: bitstring;
                                    {2785}let gNc_2671: bitstring = exp(g,Nc_2670) in
                                    {2786}let m1_2672: bitstring = (Sess,SPc_2669,gNc_2671) in
                                    {2787}event beginCli(Cli,Sess,gNc_2671);
                                    {2788}out(c, (pkCli_2154,enc(m1_2672,pkSess_2666),sign(h(m1_2672),skCli_2153)));
                                    {2789}in(c, (ePartS_2673: bitstring,sigPartS_2674: bitstring));
                                    {2790}let (=Cli,PartS_2675: bitstring) = dec(ePartS_2673,skCli_2153) in
                                    {2791}if (verify(h((Cli,PartS_2675)),sigPartS_2674,pkSess_2666) <> true) then
                                        0
                                    else
                                        {2792}event endCli(Sess,Cli,PartS_2675)
                    )
                    else
                        {2793}let skCli_2676: bitstring = fail-any in
                        {2794}let pkCli_2677: bitstring = pub(skCli_2676) in
                        {2795}let v_2678: bool = (Disco = A) in
                        (
                            {2796}if v_2678 then
                            (
                                {2797}let pkDisco_2679: bitstring = pub(skA) in
                                {2798}let v_2680: bool = (Sess = A) in
                                (
                                    {2799}if v_2680 then
                                    (
                                        {2800}let pkSess_2681: bitstring = pub(skA) in
                                        {2801}out(c, GetEndpointRequest);
                                        {2802}in(c, (SPs_2682: bitstring,=SignAndEncrypt,UP_2683: bitstring,=pkSess_2681));
                                        {2803}new SPc_2684: bitstring;
                                        {2804}new Nc_2685: bitstring;
                                        {2805}let gNc_2686: bitstring = exp(g,Nc_2685) in
                                        {2806}let m1_2687: bitstring = (Sess,SPc_2684,gNc_2686) in
                                        {2807}event beginCli(Cli,Sess,gNc_2686);
                                        {2808}out(c, (pkCli_2677,enc(m1_2687,pkSess_2681),sign(h(m1_2687),skCli_2676)));
                                        {2809}in(c, (ePartS_2688: bitstring,sigPartS_2689: bitstring));
                                        {2810}let (=Cli,PartS_2690: bitstring) = dec(ePartS_2688,skCli_2676) in
                                        {2811}if (verify(h((Cli,PartS_2690)),sigPartS_2689,pkSess_2681) <> true) then
                                            0
                                        else
                                            {2812}event endCli(Sess,Cli,PartS_2690)
                                    )
                                    else
                                        {2813}let v_2691: bool = (Sess = B) in
                                        (
                                            {2814}if v_2691 then
                                            (
                                                {2815}let pkSess_2692: bitstring = pub(skB) in
                                                {2816}out(c, GetEndpointRequest);
                                                {2817}in(c, (SPs_2693: bitstring,=SignAndEncrypt,UP_2694: bitstring,=pkSess_2692));
                                                {2818}new SPc_2695: bitstring;
                                                {2819}new Nc_2696: bitstring;
                                                {2820}let gNc_2697: bitstring = exp(g,Nc_2696) in
                                                {2821}let m1_2698: bitstring = (Sess,SPc_2695,gNc_2697) in
                                                {2822}event beginCli(Cli,Sess,gNc_2697);
                                                {2823}out(c, (pkCli_2677,enc(m1_2698,pkSess_2692),sign(h(m1_2698),skCli_2676)));
                                                {2824}in(c, (ePartS_2699: bitstring,sigPartS_2700: bitstring));
                                                {2825}let (=Cli,PartS_2701: bitstring) = dec(ePartS_2699,skCli_2676) in
                                                {2826}if (verify(h((Cli,PartS_2701)),sigPartS_2700,pkSess_2692) <> true) then
                                                    0
                                                else
                                                    {2827}event endCli(Sess,Cli,PartS_2701)
                                            )
                                            else
                                                {2828}let v_2702: bool = (Sess = C) in
                                                (
                                                    {2829}if v_2702 then
                                                    (
                                                        {2830}let pkSess_2703: bitstring = pub(skC) in
                                                        {2831}out(c, GetEndpointRequest);
                                                        {2832}in(c, (SPs_2704: bitstring,=SignAndEncrypt,UP_2705: bitstring,=pkSess_2703));
                                                        {2833}new SPc_2706: bitstring;
                                                        {2834}new Nc_2707: bitstring;
                                                        {2835}let gNc_2708: bitstring = exp(g,Nc_2707) in
                                                        {2836}let m1_2709: bitstring = (Sess,SPc_2706,gNc_2708) in
                                                        {2837}event beginCli(Cli,Sess,gNc_2708);
                                                        {2838}out(c, (pkCli_2677,enc(m1_2709,pkSess_2703),sign(h(m1_2709),skCli_2676)));
                                                        {2839}in(c, (ePartS_2710: bitstring,sigPartS_2711: bitstring));
                                                        {2840}let (=Cli,PartS_2712: bitstring) = dec(ePartS_2710,skCli_2676) in
                                                        {2841}if (verify(h((Cli,PartS_2712)),sigPartS_2711,pkSess_2703) <> true) then
                                                            0
                                                        else
                                                            {2842}event endCli(Sess,Cli,PartS_2712)
                                                    )
                                                    else
                                                        {2843}let pkSess_2713: bitstring = pub(skI) in
                                                        {2844}out(c, GetEndpointRequest);
                                                        {2845}in(c, (SPs_2714: bitstring,=SignAndEncrypt,UP_2715: bitstring,=pkSess_2713));
                                                        {2846}new SPc_2716: bitstring;
                                                        {2847}new Nc_2717: bitstring;
                                                        {2848}let gNc_2718: bitstring = exp(g,Nc_2717) in
                                                        {2849}let m1_2719: bitstring = (Sess,SPc_2716,gNc_2718) in
                                                        {2850}event beginCli(Cli,Sess,gNc_2718);
                                                        {2851}out(c, (pkCli_2677,enc(m1_2719,pkSess_2713),sign(h(m1_2719),skCli_2676)));
                                                        {2852}in(c, (ePartS_2720: bitstring,sigPartS_2721: bitstring));
                                                        {2853}let (=Cli,PartS_2722: bitstring) = dec(ePartS_2720,skCli_2676) in
                                                        {2854}if (verify(h((Cli,PartS_2722)),sigPartS_2721,pkSess_2713) <> true) then
                                                            0
                                                        else
                                                            {2855}event endCli(Sess,Cli,PartS_2722)
                                                )
                                                else
                                                    {2856}let pkSess_2723: bitstring = fail-any in
                                                    {2857}out(c, GetEndpointRequest);
                                                    {2858}in(c, (SPs_2724: bitstring,=SignAndEncrypt,UP_2725: bitstring,=pkSess_2723));
                                                    {2859}new SPc_2726: bitstring;
                                                    {2860}new Nc_2727: bitstring;
                                                    {2861}let gNc_2728: bitstring = exp(g,Nc_2727) in
                                                    {2862}let m1_2729: bitstring = (Sess,SPc_2726,gNc_2728) in
                                                    {2863}event beginCli(Cli,Sess,gNc_2728);
                                                    {2864}out(c, (pkCli_2677,enc(m1_2729,pkSess_2723),sign(h(m1_2729),skCli_2676)));
                                                    {2865}in(c, (ePartS_2730: bitstring,sigPartS_2731: bitstring));
                                                    {2866}let (=Cli,PartS_2732: bitstring) = dec(ePartS_2730,skCli_2676) in
                                                    {2867}if (verify(h((Cli,PartS_2732)),sigPartS_2731,pkSess_2723) <> true) then
                                                        0
                                                    else
                                                        {2868}event endCli(Sess,Cli,PartS_2732)
                                        )
                                        else
                                            {2869}let pkSess_2733: bitstring = fail-any in
                                            {2870}out(c, GetEndpointRequest);
                                            {2871}in(c, (SPs_2734: bitstring,=SignAndEncrypt,UP_2735: bitstring,=pkSess_2733));
                                            {2872}new SPc_2736: bitstring;
                                            {2873}new Nc_2737: bitstring;
                                            {2874}let gNc_2738: bitstring = exp(g,Nc_2737) in
                                            {2875}let m1_2739: bitstring = (Sess,SPc_2736,gNc_2738) in
                                            {2876}event beginCli(Cli,Sess,gNc_2738);
                                            {2877}out(c, (pkCli_2677,enc(m1_2739,pkSess_2733),sign(h(m1_2739),skCli_2676)));
                                            {2878}in(c, (ePartS_2740: bitstring,sigPartS_2741: bitstring));
                                            {2879}let (=Cli,PartS_2742: bitstring) = dec(ePartS_2740,skCli_2676) in
                                            {2880}if (verify(h((Cli,PartS_2742)),sigPartS_2741,pkSess_2733) <> true) then
                                                0
                                            else
                                                {2881}event endCli(Sess,Cli,PartS_2742)
                                )
                                else
                                    {2882}let pkSess_2743: bitstring = fail-any in
                                    {2883}out(c, GetEndpointRequest);
                                    {2884}in(c, (SPs_2744: bitstring,=SignAndEncrypt,UP_2745: bitstring,=pkSess_2743));
                                    {2885}new SPc_2746: bitstring;
                                    {2886}new Nc_2747: bitstring;
                                    {2887}let gNc_2748: bitstring = exp(g,Nc_2747) in
                                    {2888}let m1_2749: bitstring = (Sess,SPc_2746,gNc_2748) in
                                    {2889}event beginCli(Cli,Sess,gNc_2748);
                                    {2890}out(c, (pkCli_2677,enc(m1_2749,pkSess_2743),sign(h(m1_2749),skCli_2676)));
                                    {2891}in(c, (ePartS_2750: bitstring,sigPartS_2751: bitstring));
                                    {2892}let (=Cli,PartS_2752: bitstring) = dec(ePartS_2750,skCli_2676) in
                                    {2893}if (verify(h((Cli,PartS_2752)),sigPartS_2751,pkSess_2743) <> true) then
                                        0
                                    else
                                        {2894}event endCli(Sess,Cli,PartS_2752)
                            )
                            else
                                {2895}let v_2753: bool = (Disco = B) in
                                (
                                    {2896}if v_2753 then
                                    (
                                        {2897}let pkDisco_2754: bitstring = pub(skB) in
                                        {2898}let v_2755: bool = (Sess = A) in
                                        (
                                            {2899}if v_2755 then
                                            (
                                                {2900}let pkSess_2756: bitstring = pub(skA) in
                                                {2901}out(c, GetEndpointRequest);
                                                {2902}in(c, (SPs_2757: bitstring,=SignAndEncrypt,UP_2758: bitstring,=pkSess_2756));
                                                {2903}new SPc_2759: bitstring;
                                                {2904}new Nc_2760: bitstring;
                                                {2905}let gNc_2761: bitstring = exp(g,Nc_2760) in
                                                {2906}let m1_2762: bitstring = (Sess,SPc_2759,gNc_2761) in
                                                {2907}event beginCli(Cli,Sess,gNc_2761);
                                                {2908}out(c, (pkCli_2677,enc(m1_2762,pkSess_2756),sign(h(m1_2762),skCli_2676)));
                                                {2909}in(c, (ePartS_2763: bitstring,sigPartS_2764: bitstring));
                                                {2910}let (=Cli,PartS_2765: bitstring) = dec(ePartS_2763,skCli_2676) in
                                                {2911}if (verify(h((Cli,PartS_2765)),sigPartS_2764,pkSess_2756) <> true) then
                                                    0
                                                else
                                                    {2912}event endCli(Sess,Cli,PartS_2765)
                                            )
                                            else
                                                {2913}let v_2766: bool = (Sess = B) in
                                                (
                                                    {2914}if v_2766 then
                                                    (
                                                        {2915}let pkSess_2767: bitstring = pub(skB) in
                                                        {2916}out(c, GetEndpointRequest);
                                                        {2917}in(c, (SPs_2768: bitstring,=SignAndEncrypt,UP_2769: bitstring,=pkSess_2767));
                                                        {2918}new SPc_2770: bitstring;
                                                        {2919}new Nc_2771: bitstring;
                                                        {2920}let gNc_2772: bitstring = exp(g,Nc_2771) in
                                                        {2921}let m1_2773: bitstring = (Sess,SPc_2770,gNc_2772) in
                                                        {2922}event beginCli(Cli,Sess,gNc_2772);
                                                        {2923}out(c, (pkCli_2677,enc(m1_2773,pkSess_2767),sign(h(m1_2773),skCli_2676)));
                                                        {2924}in(c, (ePartS_2774: bitstring,sigPartS_2775: bitstring));
                                                        {2925}let (=Cli,PartS_2776: bitstring) = dec(ePartS_2774,skCli_2676) in
                                                        {2926}if (verify(h((Cli,PartS_2776)),sigPartS_2775,pkSess_2767) <> true) then
                                                            0
                                                        else
                                                            {2927}event endCli(Sess,Cli,PartS_2776)
                                                    )
                                                    else
                                                        {2928}let v_2777: bool = (Sess = C) in
                                                        (
                                                            {2929}if v_2777 then
                                                            (
                                                                {2930}let pkSess_2778: bitstring = pub(skC) in
                                                                {2931}out(c, GetEndpointRequest);
                                                                {2932}in(c, (SPs_2779: bitstring,=SignAndEncrypt,UP_2780: bitstring,=pkSess_2778));
                                                                {2933}new SPc_2781: bitstring;
                                                                {2934}new Nc_2782: bitstring;
                                                                {2935}let gNc_2783: bitstring = exp(g,Nc_2782) in
                                                                {2936}let m1_2784: bitstring = (Sess,SPc_2781,gNc_2783) in
                                                                {2937}event beginCli(Cli,Sess,gNc_2783);
                                                                {2938}out(c, (pkCli_2677,enc(m1_2784,pkSess_2778),sign(h(m1_2784),skCli_2676)));
                                                                {2939}in(c, (ePartS_2785: bitstring,sigPartS_2786: bitstring));
                                                                {2940}let (=Cli,PartS_2787: bitstring) = dec(ePartS_2785,skCli_2676) in
                                                                {2941}if (verify(h((Cli,PartS_2787)),sigPartS_2786,pkSess_2778) <> true) then
                                                                    0
                                                                else
                                                                    {2942}event endCli(Sess,Cli,PartS_2787)
                                                            )
                                                            else
                                                                {2943}let pkSess_2788: bitstring = pub(skI) in
                                                                {2944}out(c, GetEndpointRequest);
                                                                {2945}in(c, (SPs_2789: bitstring,=SignAndEncrypt,UP_2790: bitstring,=pkSess_2788));
                                                                {2946}new SPc_2791: bitstring;
                                                                {2947}new Nc_2792: bitstring;
                                                                {2948}let gNc_2793: bitstring = exp(g,Nc_2792) in
                                                                {2949}let m1_2794: bitstring = (Sess,SPc_2791,gNc_2793) in
                                                                {2950}event beginCli(Cli,Sess,gNc_2793);
                                                                {2951}out(c, (pkCli_2677,enc(m1_2794,pkSess_2788),sign(h(m1_2794),skCli_2676)));
                                                                {2952}in(c, (ePartS_2795: bitstring,sigPartS_2796: bitstring));
                                                                {2953}let (=Cli,PartS_2797: bitstring) = dec(ePartS_2795,skCli_2676) in
                                                                {2954}if (verify(h((Cli,PartS_2797)),sigPartS_2796,pkSess_2788) <> true) then
                                                                    0
                                                                else
                                                                    {2955}event endCli(Sess,Cli,PartS_2797)
                                                        )
                                                        else
                                                            {2956}let pkSess_2798: bitstring = fail-any in
                                                            {2957}out(c, GetEndpointRequest);
                                                            {2958}in(c, (SPs_2799: bitstring,=SignAndEncrypt,UP_2800: bitstring,=pkSess_2798));
                                                            {2959}new SPc_2801: bitstring;
                                                            {2960}new Nc_2802: bitstring;
                                                            {2961}let gNc_2803: bitstring = exp(g,Nc_2802) in
                                                            {2962}let m1_2804: bitstring = (Sess,SPc_2801,gNc_2803) in
                                                            {2963}event beginCli(Cli,Sess,gNc_2803);
                                                            {2964}out(c, (pkCli_2677,enc(m1_2804,pkSess_2798),sign(h(m1_2804),skCli_2676)));
                                                            {2965}in(c, (ePartS_2805: bitstring,sigPartS_2806: bitstring));
                                                            {2966}let (=Cli,PartS_2807: bitstring) = dec(ePartS_2805,skCli_2676) in
                                                            {2967}if (verify(h((Cli,PartS_2807)),sigPartS_2806,pkSess_2798) <> true) then
                                                                0
                                                            else
                                                                {2968}event endCli(Sess,Cli,PartS_2807)
                                                )
                                                else
                                                    {2969}let pkSess_2808: bitstring = fail-any in
                                                    {2970}out(c, GetEndpointRequest);
                                                    {2971}in(c, (SPs_2809: bitstring,=SignAndEncrypt,UP_2810: bitstring,=pkSess_2808));
                                                    {2972}new SPc_2811: bitstring;
                                                    {2973}new Nc_2812: bitstring;
                                                    {2974}let gNc_2813: bitstring = exp(g,Nc_2812) in
                                                    {2975}let m1_2814: bitstring = (Sess,SPc_2811,gNc_2813) in
                                                    {2976}event beginCli(Cli,Sess,gNc_2813);
                                                    {2977}out(c, (pkCli_2677,enc(m1_2814,pkSess_2808),sign(h(m1_2814),skCli_2676)));
                                                    {2978}in(c, (ePartS_2815: bitstring,sigPartS_2816: bitstring));
                                                    {2979}let (=Cli,PartS_2817: bitstring) = dec(ePartS_2815,skCli_2676) in
                                                    {2980}if (verify(h((Cli,PartS_2817)),sigPartS_2816,pkSess_2808) <> true) then
                                                        0
                                                    else
                                                        {2981}event endCli(Sess,Cli,PartS_2817)
                                        )
                                        else
                                            {2982}let pkSess_2818: bitstring = fail-any in
                                            {2983}out(c, GetEndpointRequest);
                                            {2984}in(c, (SPs_2819: bitstring,=SignAndEncrypt,UP_2820: bitstring,=pkSess_2818));
                                            {2985}new SPc_2821: bitstring;
                                            {2986}new Nc_2822: bitstring;
                                            {2987}let gNc_2823: bitstring = exp(g,Nc_2822) in
                                            {2988}let m1_2824: bitstring = (Sess,SPc_2821,gNc_2823) in
                                            {2989}event beginCli(Cli,Sess,gNc_2823);
                                            {2990}out(c, (pkCli_2677,enc(m1_2824,pkSess_2818),sign(h(m1_2824),skCli_2676)));
                                            {2991}in(c, (ePartS_2825: bitstring,sigPartS_2826: bitstring));
                                            {2992}let (=Cli,PartS_2827: bitstring) = dec(ePartS_2825,skCli_2676) in
                                            {2993}if (verify(h((Cli,PartS_2827)),sigPartS_2826,pkSess_2818) <> true) then
                                                0
                                            else
                                                {2994}event endCli(Sess,Cli,PartS_2827)
                                    )
                                    else
                                        {2995}let v_2828: bool = (Disco = C) in
                                        (
                                            {2996}if v_2828 then
                                            (
                                                {2997}let pkDisco_2829: bitstring = pub(skC) in
                                                {2998}let v_2830: bool = (Sess = A) in
                                                (
                                                    {2999}if v_2830 then
                                                    (
                                                        {3000}let pkSess_2831: bitstring = pub(skA) in
                                                        {3001}out(c, GetEndpointRequest);
                                                        {3002}in(c, (SPs_2832: bitstring,=SignAndEncrypt,UP_2833: bitstring,=pkSess_2831));
                                                        {3003}new SPc_2834: bitstring;
                                                        {3004}new Nc_2835: bitstring;
                                                        {3005}let gNc_2836: bitstring = exp(g,Nc_2835) in
                                                        {3006}let m1_2837: bitstring = (Sess,SPc_2834,gNc_2836) in
                                                        {3007}event beginCli(Cli,Sess,gNc_2836);
                                                        {3008}out(c, (pkCli_2677,enc(m1_2837,pkSess_2831),sign(h(m1_2837),skCli_2676)));
                                                        {3009}in(c, (ePartS_2838: bitstring,sigPartS_2839: bitstring));
                                                        {3010}let (=Cli,PartS_2840: bitstring) = dec(ePartS_2838,skCli_2676) in
                                                        {3011}if (verify(h((Cli,PartS_2840)),sigPartS_2839,pkSess_2831) <> true) then
                                                            0
                                                        else
                                                            {3012}event endCli(Sess,Cli,PartS_2840)
                                                    )
                                                    else
                                                        {3013}let v_2841: bool = (Sess = B) in
                                                        (
                                                            {3014}if v_2841 then
                                                            (
                                                                {3015}let pkSess_2842: bitstring = pub(skB) in
                                                                {3016}out(c, GetEndpointRequest);
                                                                {3017}in(c, (SPs_2843: bitstring,=SignAndEncrypt,UP_2844: bitstring,=pkSess_2842));
                                                                {3018}new SPc_2845: bitstring;
                                                                {3019}new Nc_2846: bitstring;
                                                                {3020}let gNc_2847: bitstring = exp(g,Nc_2846) in
                                                                {3021}let m1_2848: bitstring = (Sess,SPc_2845,gNc_2847) in
                                                                {3022}event beginCli(Cli,Sess,gNc_2847);
                                                                {3023}out(c, (pkCli_2677,enc(m1_2848,pkSess_2842),sign(h(m1_2848),skCli_2676)));
                                                                {3024}in(c, (ePartS_2849: bitstring,sigPartS_2850: bitstring));
                                                                {3025}let (=Cli,PartS_2851: bitstring) = dec(ePartS_2849,skCli_2676) in
                                                                {3026}if (verify(h((Cli,PartS_2851)),sigPartS_2850,pkSess_2842) <> true) then
                                                                    0
                                                                else
                                                                    {3027}event endCli(Sess,Cli,PartS_2851)
                                                            )
                                                            else
                                                                {3028}let v_2852: bool = (Sess = C) in
                                                                (
                                                                    {3029}if v_2852 then
                                                                    (
                                                                        {3030}let pkSess_2853: bitstring = pub(skC) in
                                                                        {3031}out(c, GetEndpointRequest);
                                                                        {3032}in(c, (SPs_2854: bitstring,=SignAndEncrypt,UP_2855: bitstring,=pkSess_2853));
                                                                        {3033}new SPc_2856: bitstring;
                                                                        {3034}new Nc_2857: bitstring;
                                                                        {3035}let gNc_2858: bitstring = exp(g,Nc_2857) in
                                                                        {3036}let m1_2859: bitstring = (Sess,SPc_2856,gNc_2858) in
                                                                        {3037}event beginCli(Cli,Sess,gNc_2858);
                                                                        {3038}out(c, (pkCli_2677,enc(m1_2859,pkSess_2853),sign(h(m1_2859),skCli_2676)));
                                                                        {3039}in(c, (ePartS_2860: bitstring,sigPartS_2861: bitstring));
                                                                        {3040}let (=Cli,PartS_2862: bitstring) = dec(ePartS_2860,skCli_2676) in
                                                                        {3041}if (verify(h((Cli,PartS_2862)),sigPartS_2861,pkSess_2853) <> true) then
                                                                            0
                                                                        else
                                                                            {3042}event endCli(Sess,Cli,PartS_2862)
                                                                    )
                                                                    else
                                                                        {3043}let pkSess_2863: bitstring = pub(skI) in
                                                                        {3044}out(c, GetEndpointRequest);
                                                                        {3045}in(c, (SPs_2864: bitstring,=SignAndEncrypt,UP_2865: bitstring,=pkSess_2863));
                                                                        {3046}new SPc_2866: bitstring;
                                                                        {3047}new Nc_2867: bitstring;
                                                                        {3048}let gNc_2868: bitstring = exp(g,Nc_2867) in
                                                                        {3049}let m1_2869: bitstring = (Sess,SPc_2866,gNc_2868) in
                                                                        {3050}event beginCli(Cli,Sess,gNc_2868);
                                                                        {3051}out(c, (pkCli_2677,enc(m1_2869,pkSess_2863),sign(h(m1_2869),skCli_2676)));
                                                                        {3052}in(c, (ePartS_2870: bitstring,sigPartS_2871: bitstring));
                                                                        {3053}let (=Cli,PartS_2872: bitstring) = dec(ePartS_2870,skCli_2676) in
                                                                        {3054}if (verify(h((Cli,PartS_2872)),sigPartS_2871,pkSess_2863) <> true) then
                                                                            0
                                                                        else
                                                                            {3055}event endCli(Sess,Cli,PartS_2872)
                                                                )
                                                                else
                                                                    {3056}let pkSess_2873: bitstring = fail-any in
                                                                    {3057}out(c, GetEndpointRequest);
                                                                    {3058}in(c, (SPs_2874: bitstring,=SignAndEncrypt,UP_2875: bitstring,=pkSess_2873));
                                                                    {3059}new SPc_2876: bitstring;
                                                                    {3060}new Nc_2877: bitstring;
                                                                    {3061}let gNc_2878: bitstring = exp(g,Nc_2877) in
                                                                    {3062}let m1_2879: bitstring = (Sess,SPc_2876,gNc_2878) in
                                                                    {3063}event beginCli(Cli,Sess,gNc_2878);
                                                                    {3064}out(c, (pkCli_2677,enc(m1_2879,pkSess_2873),sign(h(m1_2879),skCli_2676)));
                                                                    {3065}in(c, (ePartS_2880: bitstring,sigPartS_2881: bitstring));
                                                                    {3066}let (=Cli,PartS_2882: bitstring) = dec(ePartS_2880,skCli_2676) in
                                                                    {3067}if (verify(h((Cli,PartS_2882)),sigPartS_2881,pkSess_2873) <> true) then
                                                                        0
                                                                    else
                                                                        {3068}event endCli(Sess,Cli,PartS_2882)
                                                        )
                                                        else
                                                            {3069}let pkSess_2883: bitstring = fail-any in
                                                            {3070}out(c, GetEndpointRequest);
                                                            {3071}in(c, (SPs_2884: bitstring,=SignAndEncrypt,UP_2885: bitstring,=pkSess_2883));
                                                            {3072}new SPc_2886: bitstring;
                                                            {3073}new Nc_2887: bitstring;
                                                            {3074}let gNc_2888: bitstring = exp(g,Nc_2887) in
                                                            {3075}let m1_2889: bitstring = (Sess,SPc_2886,gNc_2888) in
                                                            {3076}event beginCli(Cli,Sess,gNc_2888);
                                                            {3077}out(c, (pkCli_2677,enc(m1_2889,pkSess_2883),sign(h(m1_2889),skCli_2676)));
                                                            {3078}in(c, (ePartS_2890: bitstring,sigPartS_2891: bitstring));
                                                            {3079}let (=Cli,PartS_2892: bitstring) = dec(ePartS_2890,skCli_2676) in
                                                            {3080}if (verify(h((Cli,PartS_2892)),sigPartS_2891,pkSess_2883) <> true) then
                                                                0
                                                            else
                                                                {3081}event endCli(Sess,Cli,PartS_2892)
                                                )
                                                else
                                                    {3082}let pkSess_2893: bitstring = fail-any in
                                                    {3083}out(c, GetEndpointRequest);
                                                    {3084}in(c, (SPs_2894: bitstring,=SignAndEncrypt,UP_2895: bitstring,=pkSess_2893));
                                                    {3085}new SPc_2896: bitstring;
                                                    {3086}new Nc_2897: bitstring;
                                                    {3087}let gNc_2898: bitstring = exp(g,Nc_2897) in
                                                    {3088}let m1_2899: bitstring = (Sess,SPc_2896,gNc_2898) in
                                                    {3089}event beginCli(Cli,Sess,gNc_2898);
                                                    {3090}out(c, (pkCli_2677,enc(m1_2899,pkSess_2893),sign(h(m1_2899),skCli_2676)));
                                                    {3091}in(c, (ePartS_2900: bitstring,sigPartS_2901: bitstring));
                                                    {3092}let (=Cli,PartS_2902: bitstring) = dec(ePartS_2900,skCli_2676) in
                                                    {3093}if (verify(h((Cli,PartS_2902)),sigPartS_2901,pkSess_2893) <> true) then
                                                        0
                                                    else
                                                        {3094}event endCli(Sess,Cli,PartS_2902)
                                            )
                                            else
                                                {3095}let pkDisco_2903: bitstring = pub(skI) in
                                                {3096}let v_2904: bool = (Sess = A) in
                                                (
                                                    {3097}if v_2904 then
                                                    (
                                                        {3098}let pkSess_2905: bitstring = pub(skA) in
                                                        {3099}out(c, GetEndpointRequest);
                                                        {3100}in(c, (SPs_2906: bitstring,=SignAndEncrypt,UP_2907: bitstring,=pkSess_2905));
                                                        {3101}new SPc_2908: bitstring;
                                                        {3102}new Nc_2909: bitstring;
                                                        {3103}let gNc_2910: bitstring = exp(g,Nc_2909) in
                                                        {3104}let m1_2911: bitstring = (Sess,SPc_2908,gNc_2910) in
                                                        {3105}event beginCli(Cli,Sess,gNc_2910);
                                                        {3106}out(c, (pkCli_2677,enc(m1_2911,pkSess_2905),sign(h(m1_2911),skCli_2676)));
                                                        {3107}in(c, (ePartS_2912: bitstring,sigPartS_2913: bitstring));
                                                        {3108}let (=Cli,PartS_2914: bitstring) = dec(ePartS_2912,skCli_2676) in
                                                        {3109}if (verify(h((Cli,PartS_2914)),sigPartS_2913,pkSess_2905) <> true) then
                                                            0
                                                        else
                                                            {3110}event endCli(Sess,Cli,PartS_2914)
                                                    )
                                                    else
                                                        {3111}let v_2915: bool = (Sess = B) in
                                                        (
                                                            {3112}if v_2915 then
                                                            (
                                                                {3113}let pkSess_2916: bitstring = pub(skB) in
                                                                {3114}out(c, GetEndpointRequest);
                                                                {3115}in(c, (SPs_2917: bitstring,=SignAndEncrypt,UP_2918: bitstring,=pkSess_2916));
                                                                {3116}new SPc_2919: bitstring;
                                                                {3117}new Nc_2920: bitstring;
                                                                {3118}let gNc_2921: bitstring = exp(g,Nc_2920) in
                                                                {3119}let m1_2922: bitstring = (Sess,SPc_2919,gNc_2921) in
                                                                {3120}event beginCli(Cli,Sess,gNc_2921);
                                                                {3121}out(c, (pkCli_2677,enc(m1_2922,pkSess_2916),sign(h(m1_2922),skCli_2676)));
                                                                {3122}in(c, (ePartS_2923: bitstring,sigPartS_2924: bitstring));
                                                                {3123}let (=Cli,PartS_2925: bitstring) = dec(ePartS_2923,skCli_2676) in
                                                                {3124}if (verify(h((Cli,PartS_2925)),sigPartS_2924,pkSess_2916) <> true) then
                                                                    0
                                                                else
                                                                    {3125}event endCli(Sess,Cli,PartS_2925)
                                                            )
                                                            else
                                                                {3126}let v_2926: bool = (Sess = C) in
                                                                (
                                                                    {3127}if v_2926 then
                                                                    (
                                                                        {3128}let pkSess_2927: bitstring = pub(skC) in
                                                                        {3129}out(c, GetEndpointRequest);
                                                                        {3130}in(c, (SPs_2928: bitstring,=SignAndEncrypt,UP_2929: bitstring,=pkSess_2927));
                                                                        {3131}new SPc_2930: bitstring;
                                                                        {3132}new Nc_2931: bitstring;
                                                                        {3133}let gNc_2932: bitstring = exp(g,Nc_2931) in
                                                                        {3134}let m1_2933: bitstring = (Sess,SPc_2930,gNc_2932) in
                                                                        {3135}event beginCli(Cli,Sess,gNc_2932);
                                                                        {3136}out(c, (pkCli_2677,enc(m1_2933,pkSess_2927),sign(h(m1_2933),skCli_2676)));
                                                                        {3137}in(c, (ePartS_2934: bitstring,sigPartS_2935: bitstring));
                                                                        {3138}let (=Cli,PartS_2936: bitstring) = dec(ePartS_2934,skCli_2676) in
                                                                        {3139}if (verify(h((Cli,PartS_2936)),sigPartS_2935,pkSess_2927) <> true) then
                                                                            0
                                                                        else
                                                                            {3140}event endCli(Sess,Cli,PartS_2936)
                                                                    )
                                                                    else
                                                                        {3141}let pkSess_2937: bitstring = pub(skI) in
                                                                        {3142}out(c, GetEndpointRequest);
                                                                        {3143}in(c, (SPs_2938: bitstring,=SignAndEncrypt,UP_2939: bitstring,=pkSess_2937));
                                                                        {3144}new SPc_2940: bitstring;
                                                                        {3145}new Nc_2941: bitstring;
                                                                        {3146}let gNc_2942: bitstring = exp(g,Nc_2941) in
                                                                        {3147}let m1_2943: bitstring = (Sess,SPc_2940,gNc_2942) in
                                                                        {3148}event beginCli(Cli,Sess,gNc_2942);
                                                                        {3149}out(c, (pkCli_2677,enc(m1_2943,pkSess_2937),sign(h(m1_2943),skCli_2676)));
                                                                        {3150}in(c, (ePartS_2944: bitstring,sigPartS_2945: bitstring));
                                                                        {3151}let (=Cli,PartS_2946: bitstring) = dec(ePartS_2944,skCli_2676) in
                                                                        {3152}if (verify(h((Cli,PartS_2946)),sigPartS_2945,pkSess_2937) <> true) then
                                                                            0
                                                                        else
                                                                            {3153}event endCli(Sess,Cli,PartS_2946)
                                                                )
                                                                else
                                                                    {3154}let pkSess_2947: bitstring = fail-any in
                                                                    {3155}out(c, GetEndpointRequest);
                                                                    {3156}in(c, (SPs_2948: bitstring,=SignAndEncrypt,UP_2949: bitstring,=pkSess_2947));
                                                                    {3157}new SPc_2950: bitstring;
                                                                    {3158}new Nc_2951: bitstring;
                                                                    {3159}let gNc_2952: bitstring = exp(g,Nc_2951) in
                                                                    {3160}let m1_2953: bitstring = (Sess,SPc_2950,gNc_2952) in
                                                                    {3161}event beginCli(Cli,Sess,gNc_2952);
                                                                    {3162}out(c, (pkCli_2677,enc(m1_2953,pkSess_2947),sign(h(m1_2953),skCli_2676)));
                                                                    {3163}in(c, (ePartS_2954: bitstring,sigPartS_2955: bitstring));
                                                                    {3164}let (=Cli,PartS_2956: bitstring) = dec(ePartS_2954,skCli_2676) in
                                                                    {3165}if (verify(h((Cli,PartS_2956)),sigPartS_2955,pkSess_2947) <> true) then
                                                                        0
                                                                    else
                                                                        {3166}event endCli(Sess,Cli,PartS_2956)
                                                        )
                                                        else
                                                            {3167}let pkSess_2957: bitstring = fail-any in
                                                            {3168}out(c, GetEndpointRequest);
                                                            {3169}in(c, (SPs_2958: bitstring,=SignAndEncrypt,UP_2959: bitstring,=pkSess_2957));
                                                            {3170}new SPc_2960: bitstring;
                                                            {3171}new Nc_2961: bitstring;
                                                            {3172}let gNc_2962: bitstring = exp(g,Nc_2961) in
                                                            {3173}let m1_2963: bitstring = (Sess,SPc_2960,gNc_2962) in
                                                            {3174}event beginCli(Cli,Sess,gNc_2962);
                                                            {3175}out(c, (pkCli_2677,enc(m1_2963,pkSess_2957),sign(h(m1_2963),skCli_2676)));
                                                            {3176}in(c, (ePartS_2964: bitstring,sigPartS_2965: bitstring));
                                                            {3177}let (=Cli,PartS_2966: bitstring) = dec(ePartS_2964,skCli_2676) in
                                                            {3178}if (verify(h((Cli,PartS_2966)),sigPartS_2965,pkSess_2957) <> true) then
                                                                0
                                                            else
                                                                {3179}event endCli(Sess,Cli,PartS_2966)
                                                )
                                                else
                                                    {3180}let pkSess_2967: bitstring = fail-any in
                                                    {3181}out(c, GetEndpointRequest);
                                                    {3182}in(c, (SPs_2968: bitstring,=SignAndEncrypt,UP_2969: bitstring,=pkSess_2967));
                                                    {3183}new SPc_2970: bitstring;
                                                    {3184}new Nc_2971: bitstring;
                                                    {3185}let gNc_2972: bitstring = exp(g,Nc_2971) in
                                                    {3186}let m1_2973: bitstring = (Sess,SPc_2970,gNc_2972) in
                                                    {3187}event beginCli(Cli,Sess,gNc_2972);
                                                    {3188}out(c, (pkCli_2677,enc(m1_2973,pkSess_2967),sign(h(m1_2973),skCli_2676)));
                                                    {3189}in(c, (ePartS_2974: bitstring,sigPartS_2975: bitstring));
                                                    {3190}let (=Cli,PartS_2976: bitstring) = dec(ePartS_2974,skCli_2676) in
                                                    {3191}if (verify(h((Cli,PartS_2976)),sigPartS_2975,pkSess_2967) <> true) then
                                                        0
                                                    else
                                                        {3192}event endCli(Sess,Cli,PartS_2976)
                                        )
                                        else
                                            {3193}let pkDisco_2977: bitstring = fail-any in
                                            {3194}let v_2978: bool = (Sess = A) in
                                            (
                                                {3195}if v_2978 then
                                                (
                                                    {3196}let pkSess_2979: bitstring = pub(skA) in
                                                    {3197}out(c, GetEndpointRequest);
                                                    {3198}in(c, (SPs_2980: bitstring,=SignAndEncrypt,UP_2981: bitstring,=pkSess_2979));
                                                    {3199}new SPc_2982: bitstring;
                                                    {3200}new Nc_2983: bitstring;
                                                    {3201}let gNc_2984: bitstring = exp(g,Nc_2983) in
                                                    {3202}let m1_2985: bitstring = (Sess,SPc_2982,gNc_2984) in
                                                    {3203}event beginCli(Cli,Sess,gNc_2984);
                                                    {3204}out(c, (pkCli_2677,enc(m1_2985,pkSess_2979),sign(h(m1_2985),skCli_2676)));
                                                    {3205}in(c, (ePartS_2986: bitstring,sigPartS_2987: bitstring));
                                                    {3206}let (=Cli,PartS_2988: bitstring) = dec(ePartS_2986,skCli_2676) in
                                                    {3207}if (verify(h((Cli,PartS_2988)),sigPartS_2987,pkSess_2979) <> true) then
                                                        0
                                                    else
                                                        {3208}event endCli(Sess,Cli,PartS_2988)
                                                )
                                                else
                                                    {3209}let v_2989: bool = (Sess = B) in
                                                    (
                                                        {3210}if v_2989 then
                                                        (
                                                            {3211}let pkSess_2990: bitstring = pub(skB) in
                                                            {3212}out(c, GetEndpointRequest);
                                                            {3213}in(c, (SPs_2991: bitstring,=SignAndEncrypt,UP_2992: bitstring,=pkSess_2990));
                                                            {3214}new SPc_2993: bitstring;
                                                            {3215}new Nc_2994: bitstring;
                                                            {3216}let gNc_2995: bitstring = exp(g,Nc_2994) in
                                                            {3217}let m1_2996: bitstring = (Sess,SPc_2993,gNc_2995) in
                                                            {3218}event beginCli(Cli,Sess,gNc_2995);
                                                            {3219}out(c, (pkCli_2677,enc(m1_2996,pkSess_2990),sign(h(m1_2996),skCli_2676)));
                                                            {3220}in(c, (ePartS_2997: bitstring,sigPartS_2998: bitstring));
                                                            {3221}let (=Cli,PartS_2999: bitstring) = dec(ePartS_2997,skCli_2676) in
                                                            {3222}if (verify(h((Cli,PartS_2999)),sigPartS_2998,pkSess_2990) <> true) then
                                                                0
                                                            else
                                                                {3223}event endCli(Sess,Cli,PartS_2999)
                                                        )
                                                        else
                                                            {3224}let v_3000: bool = (Sess = C) in
                                                            (
                                                                {3225}if v_3000 then
                                                                (
                                                                    {3226}let pkSess_3001: bitstring = pub(skC) in
                                                                    {3227}out(c, GetEndpointRequest);
                                                                    {3228}in(c, (SPs_3002: bitstring,=SignAndEncrypt,UP_3003: bitstring,=pkSess_3001));
                                                                    {3229}new SPc_3004: bitstring;
                                                                    {3230}new Nc_3005: bitstring;
                                                                    {3231}let gNc_3006: bitstring = exp(g,Nc_3005) in
                                                                    {3232}let m1_3007: bitstring = (Sess,SPc_3004,gNc_3006) in
                                                                    {3233}event beginCli(Cli,Sess,gNc_3006);
                                                                    {3234}out(c, (pkCli_2677,enc(m1_3007,pkSess_3001),sign(h(m1_3007),skCli_2676)));
                                                                    {3235}in(c, (ePartS_3008: bitstring,sigPartS_3009: bitstring));
                                                                    {3236}let (=Cli,PartS_3010: bitstring) = dec(ePartS_3008,skCli_2676) in
                                                                    {3237}if (verify(h((Cli,PartS_3010)),sigPartS_3009,pkSess_3001) <> true) then
                                                                        0
                                                                    else
                                                                        {3238}event endCli(Sess,Cli,PartS_3010)
                                                                )
                                                                else
                                                                    {3239}let pkSess_3011: bitstring = pub(skI) in
                                                                    {3240}out(c, GetEndpointRequest);
                                                                    {3241}in(c, (SPs_3012: bitstring,=SignAndEncrypt,UP_3013: bitstring,=pkSess_3011));
                                                                    {3242}new SPc_3014: bitstring;
                                                                    {3243}new Nc_3015: bitstring;
                                                                    {3244}let gNc_3016: bitstring = exp(g,Nc_3015) in
                                                                    {3245}let m1_3017: bitstring = (Sess,SPc_3014,gNc_3016) in
                                                                    {3246}event beginCli(Cli,Sess,gNc_3016);
                                                                    {3247}out(c, (pkCli_2677,enc(m1_3017,pkSess_3011),sign(h(m1_3017),skCli_2676)));
                                                                    {3248}in(c, (ePartS_3018: bitstring,sigPartS_3019: bitstring));
                                                                    {3249}let (=Cli,PartS_3020: bitstring) = dec(ePartS_3018,skCli_2676) in
                                                                    {3250}if (verify(h((Cli,PartS_3020)),sigPartS_3019,pkSess_3011) <> true) then
                                                                        0
                                                                    else
                                                                        {3251}event endCli(Sess,Cli,PartS_3020)
                                                            )
                                                            else
                                                                {3252}let pkSess_3021: bitstring = fail-any in
                                                                {3253}out(c, GetEndpointRequest);
                                                                {3254}in(c, (SPs_3022: bitstring,=SignAndEncrypt,UP_3023: bitstring,=pkSess_3021));
                                                                {3255}new SPc_3024: bitstring;
                                                                {3256}new Nc_3025: bitstring;
                                                                {3257}let gNc_3026: bitstring = exp(g,Nc_3025) in
                                                                {3258}let m1_3027: bitstring = (Sess,SPc_3024,gNc_3026) in
                                                                {3259}event beginCli(Cli,Sess,gNc_3026);
                                                                {3260}out(c, (pkCli_2677,enc(m1_3027,pkSess_3021),sign(h(m1_3027),skCli_2676)));
                                                                {3261}in(c, (ePartS_3028: bitstring,sigPartS_3029: bitstring));
                                                                {3262}let (=Cli,PartS_3030: bitstring) = dec(ePartS_3028,skCli_2676) in
                                                                {3263}if (verify(h((Cli,PartS_3030)),sigPartS_3029,pkSess_3021) <> true) then
                                                                    0
                                                                else
                                                                    {3264}event endCli(Sess,Cli,PartS_3030)
                                                    )
                                                    else
                                                        {3265}let pkSess_3031: bitstring = fail-any in
                                                        {3266}out(c, GetEndpointRequest);
                                                        {3267}in(c, (SPs_3032: bitstring,=SignAndEncrypt,UP_3033: bitstring,=pkSess_3031));
                                                        {3268}new SPc_3034: bitstring;
                                                        {3269}new Nc_3035: bitstring;
                                                        {3270}let gNc_3036: bitstring = exp(g,Nc_3035) in
                                                        {3271}let m1_3037: bitstring = (Sess,SPc_3034,gNc_3036) in
                                                        {3272}event beginCli(Cli,Sess,gNc_3036);
                                                        {3273}out(c, (pkCli_2677,enc(m1_3037,pkSess_3031),sign(h(m1_3037),skCli_2676)));
                                                        {3274}in(c, (ePartS_3038: bitstring,sigPartS_3039: bitstring));
                                                        {3275}let (=Cli,PartS_3040: bitstring) = dec(ePartS_3038,skCli_2676) in
                                                        {3276}if (verify(h((Cli,PartS_3040)),sigPartS_3039,pkSess_3031) <> true) then
                                                            0
                                                        else
                                                            {3277}event endCli(Sess,Cli,PartS_3040)
                                            )
                                            else
                                                {3278}let pkSess_3041: bitstring = fail-any in
                                                {3279}out(c, GetEndpointRequest);
                                                {3280}in(c, (SPs_3042: bitstring,=SignAndEncrypt,UP_3043: bitstring,=pkSess_3041));
                                                {3281}new SPc_3044: bitstring;
                                                {3282}new Nc_3045: bitstring;
                                                {3283}let gNc_3046: bitstring = exp(g,Nc_3045) in
                                                {3284}let m1_3047: bitstring = (Sess,SPc_3044,gNc_3046) in
                                                {3285}event beginCli(Cli,Sess,gNc_3046);
                                                {3286}out(c, (pkCli_2677,enc(m1_3047,pkSess_3041),sign(h(m1_3047),skCli_2676)));
                                                {3287}in(c, (ePartS_3048: bitstring,sigPartS_3049: bitstring));
                                                {3288}let (=Cli,PartS_3050: bitstring) = dec(ePartS_3048,skCli_2676) in
                                                {3289}if (verify(h((Cli,PartS_3050)),sigPartS_3049,pkSess_3041) <> true) then
                                                    0
                                                else
                                                    {3290}event endCli(Sess,Cli,PartS_3050)
                                )
                                else
                                    {3291}let pkDisco_3051: bitstring = fail-any in
                                    {3292}let v_3052: bool = (Sess = A) in
                                    (
                                        {3293}if v_3052 then
                                        (
                                            {3294}let pkSess_3053: bitstring = pub(skA) in
                                            {3295}out(c, GetEndpointRequest);
                                            {3296}in(c, (SPs_3054: bitstring,=SignAndEncrypt,UP_3055: bitstring,=pkSess_3053));
                                            {3297}new SPc_3056: bitstring;
                                            {3298}new Nc_3057: bitstring;
                                            {3299}let gNc_3058: bitstring = exp(g,Nc_3057) in
                                            {3300}let m1_3059: bitstring = (Sess,SPc_3056,gNc_3058) in
                                            {3301}event beginCli(Cli,Sess,gNc_3058);
                                            {3302}out(c, (pkCli_2677,enc(m1_3059,pkSess_3053),sign(h(m1_3059),skCli_2676)));
                                            {3303}in(c, (ePartS_3060: bitstring,sigPartS_3061: bitstring));
                                            {3304}let (=Cli,PartS_3062: bitstring) = dec(ePartS_3060,skCli_2676) in
                                            {3305}if (verify(h((Cli,PartS_3062)),sigPartS_3061,pkSess_3053) <> true) then
                                                0
                                            else
                                                {3306}event endCli(Sess,Cli,PartS_3062)
                                        )
                                        else
                                            {3307}let v_3063: bool = (Sess = B) in
                                            (
                                                {3308}if v_3063 then
                                                (
                                                    {3309}let pkSess_3064: bitstring = pub(skB) in
                                                    {3310}out(c, GetEndpointRequest);
                                                    {3311}in(c, (SPs_3065: bitstring,=SignAndEncrypt,UP_3066: bitstring,=pkSess_3064));
                                                    {3312}new SPc_3067: bitstring;
                                                    {3313}new Nc_3068: bitstring;
                                                    {3314}let gNc_3069: bitstring = exp(g,Nc_3068) in
                                                    {3315}let m1_3070: bitstring = (Sess,SPc_3067,gNc_3069) in
                                                    {3316}event beginCli(Cli,Sess,gNc_3069);
                                                    {3317}out(c, (pkCli_2677,enc(m1_3070,pkSess_3064),sign(h(m1_3070),skCli_2676)));
                                                    {3318}in(c, (ePartS_3071: bitstring,sigPartS_3072: bitstring));
                                                    {3319}let (=Cli,PartS_3073: bitstring) = dec(ePartS_3071,skCli_2676) in
                                                    {3320}if (verify(h((Cli,PartS_3073)),sigPartS_3072,pkSess_3064) <> true) then
                                                        0
                                                    else
                                                        {3321}event endCli(Sess,Cli,PartS_3073)
                                                )
                                                else
                                                    {3322}let v_3074: bool = (Sess = C) in
                                                    (
                                                        {3323}if v_3074 then
                                                        (
                                                            {3324}let pkSess_3075: bitstring = pub(skC) in
                                                            {3325}out(c, GetEndpointRequest);
                                                            {3326}in(c, (SPs_3076: bitstring,=SignAndEncrypt,UP_3077: bitstring,=pkSess_3075));
                                                            {3327}new SPc_3078: bitstring;
                                                            {3328}new Nc_3079: bitstring;
                                                            {3329}let gNc_3080: bitstring = exp(g,Nc_3079) in
                                                            {3330}let m1_3081: bitstring = (Sess,SPc_3078,gNc_3080) in
                                                            {3331}event beginCli(Cli,Sess,gNc_3080);
                                                            {3332}out(c, (pkCli_2677,enc(m1_3081,pkSess_3075),sign(h(m1_3081),skCli_2676)));
                                                            {3333}in(c, (ePartS_3082: bitstring,sigPartS_3083: bitstring));
                                                            {3334}let (=Cli,PartS_3084: bitstring) = dec(ePartS_3082,skCli_2676) in
                                                            {3335}if (verify(h((Cli,PartS_3084)),sigPartS_3083,pkSess_3075) <> true) then
                                                                0
                                                            else
                                                                {3336}event endCli(Sess,Cli,PartS_3084)
                                                        )
                                                        else
                                                            {3337}let pkSess_3085: bitstring = pub(skI) in
                                                            {3338}out(c, GetEndpointRequest);
                                                            {3339}in(c, (SPs_3086: bitstring,=SignAndEncrypt,UP_3087: bitstring,=pkSess_3085));
                                                            {3340}new SPc_3088: bitstring;
                                                            {3341}new Nc_3089: bitstring;
                                                            {3342}let gNc_3090: bitstring = exp(g,Nc_3089) in
                                                            {3343}let m1_3091: bitstring = (Sess,SPc_3088,gNc_3090) in
                                                            {3344}event beginCli(Cli,Sess,gNc_3090);
                                                            {3345}out(c, (pkCli_2677,enc(m1_3091,pkSess_3085),sign(h(m1_3091),skCli_2676)));
                                                            {3346}in(c, (ePartS_3092: bitstring,sigPartS_3093: bitstring));
                                                            {3347}let (=Cli,PartS_3094: bitstring) = dec(ePartS_3092,skCli_2676) in
                                                            {3348}if (verify(h((Cli,PartS_3094)),sigPartS_3093,pkSess_3085) <> true) then
                                                                0
                                                            else
                                                                {3349}event endCli(Sess,Cli,PartS_3094)
                                                    )
                                                    else
                                                        {3350}let pkSess_3095: bitstring = fail-any in
                                                        {3351}out(c, GetEndpointRequest);
                                                        {3352}in(c, (SPs_3096: bitstring,=SignAndEncrypt,UP_3097: bitstring,=pkSess_3095));
                                                        {3353}new SPc_3098: bitstring;
                                                        {3354}new Nc_3099: bitstring;
                                                        {3355}let gNc_3100: bitstring = exp(g,Nc_3099) in
                                                        {3356}let m1_3101: bitstring = (Sess,SPc_3098,gNc_3100) in
                                                        {3357}event beginCli(Cli,Sess,gNc_3100);
                                                        {3358}out(c, (pkCli_2677,enc(m1_3101,pkSess_3095),sign(h(m1_3101),skCli_2676)));
                                                        {3359}in(c, (ePartS_3102: bitstring,sigPartS_3103: bitstring));
                                                        {3360}let (=Cli,PartS_3104: bitstring) = dec(ePartS_3102,skCli_2676) in
                                                        {3361}if (verify(h((Cli,PartS_3104)),sigPartS_3103,pkSess_3095) <> true) then
                                                            0
                                                        else
                                                            {3362}event endCli(Sess,Cli,PartS_3104)
                                            )
                                            else
                                                {3363}let pkSess_3105: bitstring = fail-any in
                                                {3364}out(c, GetEndpointRequest);
                                                {3365}in(c, (SPs_3106: bitstring,=SignAndEncrypt,UP_3107: bitstring,=pkSess_3105));
                                                {3366}new SPc_3108: bitstring;
                                                {3367}new Nc_3109: bitstring;
                                                {3368}let gNc_3110: bitstring = exp(g,Nc_3109) in
                                                {3369}let m1_3111: bitstring = (Sess,SPc_3108,gNc_3110) in
                                                {3370}event beginCli(Cli,Sess,gNc_3110);
                                                {3371}out(c, (pkCli_2677,enc(m1_3111,pkSess_3105),sign(h(m1_3111),skCli_2676)));
                                                {3372}in(c, (ePartS_3112: bitstring,sigPartS_3113: bitstring));
                                                {3373}let (=Cli,PartS_3114: bitstring) = dec(ePartS_3112,skCli_2676) in
                                                {3374}if (verify(h((Cli,PartS_3114)),sigPartS_3113,pkSess_3105) <> true) then
                                                    0
                                                else
                                                    {3375}event endCli(Sess,Cli,PartS_3114)
                                    )
                                    else
                                        {3376}let pkSess_3115: bitstring = fail-any in
                                        {3377}out(c, GetEndpointRequest);
                                        {3378}in(c, (SPs_3116: bitstring,=SignAndEncrypt,UP_3117: bitstring,=pkSess_3115));
                                        {3379}new SPc_3118: bitstring;
                                        {3380}new Nc_3119: bitstring;
                                        {3381}let gNc_3120: bitstring = exp(g,Nc_3119) in
                                        {3382}let m1_3121: bitstring = (Sess,SPc_3118,gNc_3120) in
                                        {3383}event beginCli(Cli,Sess,gNc_3120);
                                        {3384}out(c, (pkCli_2677,enc(m1_3121,pkSess_3115),sign(h(m1_3121),skCli_2676)));
                                        {3385}in(c, (ePartS_3122: bitstring,sigPartS_3123: bitstring));
                                        {3386}let (=Cli,PartS_3124: bitstring) = dec(ePartS_3122,skCli_2676) in
                                        {3387}if (verify(h((Cli,PartS_3124)),sigPartS_3123,pkSess_3115) <> true) then
                                            0
                                        else
                                            {3388}event endCli(Sess,Cli,PartS_3124)
                        )
                        else
                            {3389}let pkDisco_3125: bitstring = fail-any in
                            {3390}let v_3126: bool = (Sess = A) in
                            (
                                {3391}if v_3126 then
                                (
                                    {3392}let pkSess_3127: bitstring = pub(skA) in
                                    {3393}out(c, GetEndpointRequest);
                                    {3394}in(c, (SPs_3128: bitstring,=SignAndEncrypt,UP_3129: bitstring,=pkSess_3127));
                                    {3395}new SPc_3130: bitstring;
                                    {3396}new Nc_3131: bitstring;
                                    {3397}let gNc_3132: bitstring = exp(g,Nc_3131) in
                                    {3398}let m1_3133: bitstring = (Sess,SPc_3130,gNc_3132) in
                                    {3399}event beginCli(Cli,Sess,gNc_3132);
                                    {3400}out(c, (pkCli_2677,enc(m1_3133,pkSess_3127),sign(h(m1_3133),skCli_2676)));
                                    {3401}in(c, (ePartS_3134: bitstring,sigPartS_3135: bitstring));
                                    {3402}let (=Cli,PartS_3136: bitstring) = dec(ePartS_3134,skCli_2676) in
                                    {3403}if (verify(h((Cli,PartS_3136)),sigPartS_3135,pkSess_3127) <> true) then
                                        0
                                    else
                                        {3404}event endCli(Sess,Cli,PartS_3136)
                                )
                                else
                                    {3405}let v_3137: bool = (Sess = B) in
                                    (
                                        {3406}if v_3137 then
                                        (
                                            {3407}let pkSess_3138: bitstring = pub(skB) in
                                            {3408}out(c, GetEndpointRequest);
                                            {3409}in(c, (SPs_3139: bitstring,=SignAndEncrypt,UP_3140: bitstring,=pkSess_3138));
                                            {3410}new SPc_3141: bitstring;
                                            {3411}new Nc_3142: bitstring;
                                            {3412}let gNc_3143: bitstring = exp(g,Nc_3142) in
                                            {3413}let m1_3144: bitstring = (Sess,SPc_3141,gNc_3143) in
                                            {3414}event beginCli(Cli,Sess,gNc_3143);
                                            {3415}out(c, (pkCli_2677,enc(m1_3144,pkSess_3138),sign(h(m1_3144),skCli_2676)));
                                            {3416}in(c, (ePartS_3145: bitstring,sigPartS_3146: bitstring));
                                            {3417}let (=Cli,PartS_3147: bitstring) = dec(ePartS_3145,skCli_2676) in
                                            {3418}if (verify(h((Cli,PartS_3147)),sigPartS_3146,pkSess_3138) <> true) then
                                                0
                                            else
                                                {3419}event endCli(Sess,Cli,PartS_3147)
                                        )
                                        else
                                            {3420}let v_3148: bool = (Sess = C) in
                                            (
                                                {3421}if v_3148 then
                                                (
                                                    {3422}let pkSess_3149: bitstring = pub(skC) in
                                                    {3423}out(c, GetEndpointRequest);
                                                    {3424}in(c, (SPs_3150: bitstring,=SignAndEncrypt,UP_3151: bitstring,=pkSess_3149));
                                                    {3425}new SPc_3152: bitstring;
                                                    {3426}new Nc_3153: bitstring;
                                                    {3427}let gNc_3154: bitstring = exp(g,Nc_3153) in
                                                    {3428}let m1_3155: bitstring = (Sess,SPc_3152,gNc_3154) in
                                                    {3429}event beginCli(Cli,Sess,gNc_3154);
                                                    {3430}out(c, (pkCli_2677,enc(m1_3155,pkSess_3149),sign(h(m1_3155),skCli_2676)));
                                                    {3431}in(c, (ePartS_3156: bitstring,sigPartS_3157: bitstring));
                                                    {3432}let (=Cli,PartS_3158: bitstring) = dec(ePartS_3156,skCli_2676) in
                                                    {3433}if (verify(h((Cli,PartS_3158)),sigPartS_3157,pkSess_3149) <> true) then
                                                        0
                                                    else
                                                        {3434}event endCli(Sess,Cli,PartS_3158)
                                                )
                                                else
                                                    {3435}let pkSess_3159: bitstring = pub(skI) in
                                                    {3436}out(c, GetEndpointRequest);
                                                    {3437}in(c, (SPs_3160: bitstring,=SignAndEncrypt,UP_3161: bitstring,=pkSess_3159));
                                                    {3438}new SPc_3162: bitstring;
                                                    {3439}new Nc_3163: bitstring;
                                                    {3440}let gNc_3164: bitstring = exp(g,Nc_3163) in
                                                    {3441}let m1_3165: bitstring = (Sess,SPc_3162,gNc_3164) in
                                                    {3442}event beginCli(Cli,Sess,gNc_3164);
                                                    {3443}out(c, (pkCli_2677,enc(m1_3165,pkSess_3159),sign(h(m1_3165),skCli_2676)));
                                                    {3444}in(c, (ePartS_3166: bitstring,sigPartS_3167: bitstring));
                                                    {3445}let (=Cli,PartS_3168: bitstring) = dec(ePartS_3166,skCli_2676) in
                                                    {3446}if (verify(h((Cli,PartS_3168)),sigPartS_3167,pkSess_3159) <> true) then
                                                        0
                                                    else
                                                        {3447}event endCli(Sess,Cli,PartS_3168)
                                            )
                                            else
                                                {3448}let pkSess_3169: bitstring = fail-any in
                                                {3449}out(c, GetEndpointRequest);
                                                {3450}in(c, (SPs_3170: bitstring,=SignAndEncrypt,UP_3171: bitstring,=pkSess_3169));
                                                {3451}new SPc_3172: bitstring;
                                                {3452}new Nc_3173: bitstring;
                                                {3453}let gNc_3174: bitstring = exp(g,Nc_3173) in
                                                {3454}let m1_3175: bitstring = (Sess,SPc_3172,gNc_3174) in
                                                {3455}event beginCli(Cli,Sess,gNc_3174);
                                                {3456}out(c, (pkCli_2677,enc(m1_3175,pkSess_3169),sign(h(m1_3175),skCli_2676)));
                                                {3457}in(c, (ePartS_3176: bitstring,sigPartS_3177: bitstring));
                                                {3458}let (=Cli,PartS_3178: bitstring) = dec(ePartS_3176,skCli_2676) in
                                                {3459}if (verify(h((Cli,PartS_3178)),sigPartS_3177,pkSess_3169) <> true) then
                                                    0
                                                else
                                                    {3460}event endCli(Sess,Cli,PartS_3178)
                                    )
                                    else
                                        {3461}let pkSess_3179: bitstring = fail-any in
                                        {3462}out(c, GetEndpointRequest);
                                        {3463}in(c, (SPs_3180: bitstring,=SignAndEncrypt,UP_3181: bitstring,=pkSess_3179));
                                        {3464}new SPc_3182: bitstring;
                                        {3465}new Nc_3183: bitstring;
                                        {3466}let gNc_3184: bitstring = exp(g,Nc_3183) in
                                        {3467}let m1_3185: bitstring = (Sess,SPc_3182,gNc_3184) in
                                        {3468}event beginCli(Cli,Sess,gNc_3184);
                                        {3469}out(c, (pkCli_2677,enc(m1_3185,pkSess_3179),sign(h(m1_3185),skCli_2676)));
                                        {3470}in(c, (ePartS_3186: bitstring,sigPartS_3187: bitstring));
                                        {3471}let (=Cli,PartS_3188: bitstring) = dec(ePartS_3186,skCli_2676) in
                                        {3472}if (verify(h((Cli,PartS_3188)),sigPartS_3187,pkSess_3179) <> true) then
                                            0
                                        else
                                            {3473}event endCli(Sess,Cli,PartS_3188)
                            )
                            else
                                {3474}let pkSess_3189: bitstring = fail-any in
                                {3475}out(c, GetEndpointRequest);
                                {3476}in(c, (SPs_3190: bitstring,=SignAndEncrypt,UP_3191: bitstring,=pkSess_3189));
                                {3477}new SPc_3192: bitstring;
                                {3478}new Nc_3193: bitstring;
                                {3479}let gNc_3194: bitstring = exp(g,Nc_3193) in
                                {3480}let m1_3195: bitstring = (Sess,SPc_3192,gNc_3194) in
                                {3481}event beginCli(Cli,Sess,gNc_3194);
                                {3482}out(c, (pkCli_2677,enc(m1_3195,pkSess_3189),sign(h(m1_3195),skCli_2676)));
                                {3483}in(c, (ePartS_3196: bitstring,sigPartS_3197: bitstring));
                                {3484}let (=Cli,PartS_3198: bitstring) = dec(ePartS_3196,skCli_2676) in
                                {3485}if (verify(h((Cli,PartS_3198)),sigPartS_3197,pkSess_3189) <> true) then
                                    0
                                else
                                    {3486}event endCli(Sess,Cli,PartS_3198)
            )
            else
                {3487}let skCli_3199: bitstring = fail-any in
                {3488}let pkCli_3200: bitstring = pub(skCli_3199) in
                {3489}let v_3201: bool = (Disco = A) in
                (
                    {3490}if v_3201 then
                    (
                        {3491}let pkDisco_3202: bitstring = pub(skA) in
                        {3492}let v_3203: bool = (Sess = A) in
                        (
                            {3493}if v_3203 then
                            (
                                {3494}let pkSess_3204: bitstring = pub(skA) in
                                {3495}out(c, GetEndpointRequest);
                                {3496}in(c, (SPs_3205: bitstring,=SignAndEncrypt,UP_3206: bitstring,=pkSess_3204));
                                {3497}new SPc_3207: bitstring;
                                {3498}new Nc_3208: bitstring;
                                {3499}let gNc_3209: bitstring = exp(g,Nc_3208) in
                                {3500}let m1_3210: bitstring = (Sess,SPc_3207,gNc_3209) in
                                {3501}event beginCli(Cli,Sess,gNc_3209);
                                {3502}out(c, (pkCli_3200,enc(m1_3210,pkSess_3204),sign(h(m1_3210),skCli_3199)));
                                {3503}in(c, (ePartS_3211: bitstring,sigPartS_3212: bitstring));
                                {3504}let (=Cli,PartS_3213: bitstring) = dec(ePartS_3211,skCli_3199) in
                                {3505}if (verify(h((Cli,PartS_3213)),sigPartS_3212,pkSess_3204) <> true) then
                                    0
                                else
                                    {3506}event endCli(Sess,Cli,PartS_3213)
                            )
                            else
                                {3507}let v_3214: bool = (Sess = B) in
                                (
                                    {3508}if v_3214 then
                                    (
                                        {3509}let pkSess_3215: bitstring = pub(skB) in
                                        {3510}out(c, GetEndpointRequest);
                                        {3511}in(c, (SPs_3216: bitstring,=SignAndEncrypt,UP_3217: bitstring,=pkSess_3215));
                                        {3512}new SPc_3218: bitstring;
                                        {3513}new Nc_3219: bitstring;
                                        {3514}let gNc_3220: bitstring = exp(g,Nc_3219) in
                                        {3515}let m1_3221: bitstring = (Sess,SPc_3218,gNc_3220) in
                                        {3516}event beginCli(Cli,Sess,gNc_3220);
                                        {3517}out(c, (pkCli_3200,enc(m1_3221,pkSess_3215),sign(h(m1_3221),skCli_3199)));
                                        {3518}in(c, (ePartS_3222: bitstring,sigPartS_3223: bitstring));
                                        {3519}let (=Cli,PartS_3224: bitstring) = dec(ePartS_3222,skCli_3199) in
                                        {3520}if (verify(h((Cli,PartS_3224)),sigPartS_3223,pkSess_3215) <> true) then
                                            0
                                        else
                                            {3521}event endCli(Sess,Cli,PartS_3224)
                                    )
                                    else
                                        {3522}let v_3225: bool = (Sess = C) in
                                        (
                                            {3523}if v_3225 then
                                            (
                                                {3524}let pkSess_3226: bitstring = pub(skC) in
                                                {3525}out(c, GetEndpointRequest);
                                                {3526}in(c, (SPs_3227: bitstring,=SignAndEncrypt,UP_3228: bitstring,=pkSess_3226));
                                                {3527}new SPc_3229: bitstring;
                                                {3528}new Nc_3230: bitstring;
                                                {3529}let gNc_3231: bitstring = exp(g,Nc_3230) in
                                                {3530}let m1_3232: bitstring = (Sess,SPc_3229,gNc_3231) in
                                                {3531}event beginCli(Cli,Sess,gNc_3231);
                                                {3532}out(c, (pkCli_3200,enc(m1_3232,pkSess_3226),sign(h(m1_3232),skCli_3199)));
                                                {3533}in(c, (ePartS_3233: bitstring,sigPartS_3234: bitstring));
                                                {3534}let (=Cli,PartS_3235: bitstring) = dec(ePartS_3233,skCli_3199) in
                                                {3535}if (verify(h((Cli,PartS_3235)),sigPartS_3234,pkSess_3226) <> true) then
                                                    0
                                                else
                                                    {3536}event endCli(Sess,Cli,PartS_3235)
                                            )
                                            else
                                                {3537}let pkSess_3236: bitstring = pub(skI) in
                                                {3538}out(c, GetEndpointRequest);
                                                {3539}in(c, (SPs_3237: bitstring,=SignAndEncrypt,UP_3238: bitstring,=pkSess_3236));
                                                {3540}new SPc_3239: bitstring;
                                                {3541}new Nc_3240: bitstring;
                                                {3542}let gNc_3241: bitstring = exp(g,Nc_3240) in
                                                {3543}let m1_3242: bitstring = (Sess,SPc_3239,gNc_3241) in
                                                {3544}event beginCli(Cli,Sess,gNc_3241);
                                                {3545}out(c, (pkCli_3200,enc(m1_3242,pkSess_3236),sign(h(m1_3242),skCli_3199)));
                                                {3546}in(c, (ePartS_3243: bitstring,sigPartS_3244: bitstring));
                                                {3547}let (=Cli,PartS_3245: bitstring) = dec(ePartS_3243,skCli_3199) in
                                                {3548}if (verify(h((Cli,PartS_3245)),sigPartS_3244,pkSess_3236) <> true) then
                                                    0
                                                else
                                                    {3549}event endCli(Sess,Cli,PartS_3245)
                                        )
                                        else
                                            {3550}let pkSess_3246: bitstring = fail-any in
                                            {3551}out(c, GetEndpointRequest);
                                            {3552}in(c, (SPs_3247: bitstring,=SignAndEncrypt,UP_3248: bitstring,=pkSess_3246));
                                            {3553}new SPc_3249: bitstring;
                                            {3554}new Nc_3250: bitstring;
                                            {3555}let gNc_3251: bitstring = exp(g,Nc_3250) in
                                            {3556}let m1_3252: bitstring = (Sess,SPc_3249,gNc_3251) in
                                            {3557}event beginCli(Cli,Sess,gNc_3251);
                                            {3558}out(c, (pkCli_3200,enc(m1_3252,pkSess_3246),sign(h(m1_3252),skCli_3199)));
                                            {3559}in(c, (ePartS_3253: bitstring,sigPartS_3254: bitstring));
                                            {3560}let (=Cli,PartS_3255: bitstring) = dec(ePartS_3253,skCli_3199) in
                                            {3561}if (verify(h((Cli,PartS_3255)),sigPartS_3254,pkSess_3246) <> true) then
                                                0
                                            else
                                                {3562}event endCli(Sess,Cli,PartS_3255)
                                )
                                else
                                    {3563}let pkSess_3256: bitstring = fail-any in
                                    {3564}out(c, GetEndpointRequest);
                                    {3565}in(c, (SPs_3257: bitstring,=SignAndEncrypt,UP_3258: bitstring,=pkSess_3256));
                                    {3566}new SPc_3259: bitstring;
                                    {3567}new Nc_3260: bitstring;
                                    {3568}let gNc_3261: bitstring = exp(g,Nc_3260) in
                                    {3569}let m1_3262: bitstring = (Sess,SPc_3259,gNc_3261) in
                                    {3570}event beginCli(Cli,Sess,gNc_3261);
                                    {3571}out(c, (pkCli_3200,enc(m1_3262,pkSess_3256),sign(h(m1_3262),skCli_3199)));
                                    {3572}in(c, (ePartS_3263: bitstring,sigPartS_3264: bitstring));
                                    {3573}let (=Cli,PartS_3265: bitstring) = dec(ePartS_3263,skCli_3199) in
                                    {3574}if (verify(h((Cli,PartS_3265)),sigPartS_3264,pkSess_3256) <> true) then
                                        0
                                    else
                                        {3575}event endCli(Sess,Cli,PartS_3265)
                        )
                        else
                            {3576}let pkSess_3266: bitstring = fail-any in
                            {3577}out(c, GetEndpointRequest);
                            {3578}in(c, (SPs_3267: bitstring,=SignAndEncrypt,UP_3268: bitstring,=pkSess_3266));
                            {3579}new SPc_3269: bitstring;
                            {3580}new Nc_3270: bitstring;
                            {3581}let gNc_3271: bitstring = exp(g,Nc_3270) in
                            {3582}let m1_3272: bitstring = (Sess,SPc_3269,gNc_3271) in
                            {3583}event beginCli(Cli,Sess,gNc_3271);
                            {3584}out(c, (pkCli_3200,enc(m1_3272,pkSess_3266),sign(h(m1_3272),skCli_3199)));
                            {3585}in(c, (ePartS_3273: bitstring,sigPartS_3274: bitstring));
                            {3586}let (=Cli,PartS_3275: bitstring) = dec(ePartS_3273,skCli_3199) in
                            {3587}if (verify(h((Cli,PartS_3275)),sigPartS_3274,pkSess_3266) <> true) then
                                0
                            else
                                {3588}event endCli(Sess,Cli,PartS_3275)
                    )
                    else
                        {3589}let v_3276: bool = (Disco = B) in
                        (
                            {3590}if v_3276 then
                            (
                                {3591}let pkDisco_3277: bitstring = pub(skB) in
                                {3592}let v_3278: bool = (Sess = A) in
                                (
                                    {3593}if v_3278 then
                                    (
                                        {3594}let pkSess_3279: bitstring = pub(skA) in
                                        {3595}out(c, GetEndpointRequest);
                                        {3596}in(c, (SPs_3280: bitstring,=SignAndEncrypt,UP_3281: bitstring,=pkSess_3279));
                                        {3597}new SPc_3282: bitstring;
                                        {3598}new Nc_3283: bitstring;
                                        {3599}let gNc_3284: bitstring = exp(g,Nc_3283) in
                                        {3600}let m1_3285: bitstring = (Sess,SPc_3282,gNc_3284) in
                                        {3601}event beginCli(Cli,Sess,gNc_3284);
                                        {3602}out(c, (pkCli_3200,enc(m1_3285,pkSess_3279),sign(h(m1_3285),skCli_3199)));
                                        {3603}in(c, (ePartS_3286: bitstring,sigPartS_3287: bitstring));
                                        {3604}let (=Cli,PartS_3288: bitstring) = dec(ePartS_3286,skCli_3199) in
                                        {3605}if (verify(h((Cli,PartS_3288)),sigPartS_3287,pkSess_3279) <> true) then
                                            0
                                        else
                                            {3606}event endCli(Sess,Cli,PartS_3288)
                                    )
                                    else
                                        {3607}let v_3289: bool = (Sess = B) in
                                        (
                                            {3608}if v_3289 then
                                            (
                                                {3609}let pkSess_3290: bitstring = pub(skB) in
                                                {3610}out(c, GetEndpointRequest);
                                                {3611}in(c, (SPs_3291: bitstring,=SignAndEncrypt,UP_3292: bitstring,=pkSess_3290));
                                                {3612}new SPc_3293: bitstring;
                                                {3613}new Nc_3294: bitstring;
                                                {3614}let gNc_3295: bitstring = exp(g,Nc_3294) in
                                                {3615}let m1_3296: bitstring = (Sess,SPc_3293,gNc_3295) in
                                                {3616}event beginCli(Cli,Sess,gNc_3295);
                                                {3617}out(c, (pkCli_3200,enc(m1_3296,pkSess_3290),sign(h(m1_3296),skCli_3199)));
                                                {3618}in(c, (ePartS_3297: bitstring,sigPartS_3298: bitstring));
                                                {3619}let (=Cli,PartS_3299: bitstring) = dec(ePartS_3297,skCli_3199) in
                                                {3620}if (verify(h((Cli,PartS_3299)),sigPartS_3298,pkSess_3290) <> true) then
                                                    0
                                                else
                                                    {3621}event endCli(Sess,Cli,PartS_3299)
                                            )
                                            else
                                                {3622}let v_3300: bool = (Sess = C) in
                                                (
                                                    {3623}if v_3300 then
                                                    (
                                                        {3624}let pkSess_3301: bitstring = pub(skC) in
                                                        {3625}out(c, GetEndpointRequest);
                                                        {3626}in(c, (SPs_3302: bitstring,=SignAndEncrypt,UP_3303: bitstring,=pkSess_3301));
                                                        {3627}new SPc_3304: bitstring;
                                                        {3628}new Nc_3305: bitstring;
                                                        {3629}let gNc_3306: bitstring = exp(g,Nc_3305) in
                                                        {3630}let m1_3307: bitstring = (Sess,SPc_3304,gNc_3306) in
                                                        {3631}event beginCli(Cli,Sess,gNc_3306);
                                                        {3632}out(c, (pkCli_3200,enc(m1_3307,pkSess_3301),sign(h(m1_3307),skCli_3199)));
                                                        {3633}in(c, (ePartS_3308: bitstring,sigPartS_3309: bitstring));
                                                        {3634}let (=Cli,PartS_3310: bitstring) = dec(ePartS_3308,skCli_3199) in
                                                        {3635}if (verify(h((Cli,PartS_3310)),sigPartS_3309,pkSess_3301) <> true) then
                                                            0
                                                        else
                                                            {3636}event endCli(Sess,Cli,PartS_3310)
                                                    )
                                                    else
                                                        {3637}let pkSess_3311: bitstring = pub(skI) in
                                                        {3638}out(c, GetEndpointRequest);
                                                        {3639}in(c, (SPs_3312: bitstring,=SignAndEncrypt,UP_3313: bitstring,=pkSess_3311));
                                                        {3640}new SPc_3314: bitstring;
                                                        {3641}new Nc_3315: bitstring;
                                                        {3642}let gNc_3316: bitstring = exp(g,Nc_3315) in
                                                        {3643}let m1_3317: bitstring = (Sess,SPc_3314,gNc_3316) in
                                                        {3644}event beginCli(Cli,Sess,gNc_3316);
                                                        {3645}out(c, (pkCli_3200,enc(m1_3317,pkSess_3311),sign(h(m1_3317),skCli_3199)));
                                                        {3646}in(c, (ePartS_3318: bitstring,sigPartS_3319: bitstring));
                                                        {3647}let (=Cli,PartS_3320: bitstring) = dec(ePartS_3318,skCli_3199) in
                                                        {3648}if (verify(h((Cli,PartS_3320)),sigPartS_3319,pkSess_3311) <> true) then
                                                            0
                                                        else
                                                            {3649}event endCli(Sess,Cli,PartS_3320)
                                                )
                                                else
                                                    {3650}let pkSess_3321: bitstring = fail-any in
                                                    {3651}out(c, GetEndpointRequest);
                                                    {3652}in(c, (SPs_3322: bitstring,=SignAndEncrypt,UP_3323: bitstring,=pkSess_3321));
                                                    {3653}new SPc_3324: bitstring;
                                                    {3654}new Nc_3325: bitstring;
                                                    {3655}let gNc_3326: bitstring = exp(g,Nc_3325) in
                                                    {3656}let m1_3327: bitstring = (Sess,SPc_3324,gNc_3326) in
                                                    {3657}event beginCli(Cli,Sess,gNc_3326);
                                                    {3658}out(c, (pkCli_3200,enc(m1_3327,pkSess_3321),sign(h(m1_3327),skCli_3199)));
                                                    {3659}in(c, (ePartS_3328: bitstring,sigPartS_3329: bitstring));
                                                    {3660}let (=Cli,PartS_3330: bitstring) = dec(ePartS_3328,skCli_3199) in
                                                    {3661}if (verify(h((Cli,PartS_3330)),sigPartS_3329,pkSess_3321) <> true) then
                                                        0
                                                    else
                                                        {3662}event endCli(Sess,Cli,PartS_3330)
                                        )
                                        else
                                            {3663}let pkSess_3331: bitstring = fail-any in
                                            {3664}out(c, GetEndpointRequest);
                                            {3665}in(c, (SPs_3332: bitstring,=SignAndEncrypt,UP_3333: bitstring,=pkSess_3331));
                                            {3666}new SPc_3334: bitstring;
                                            {3667}new Nc_3335: bitstring;
                                            {3668}let gNc_3336: bitstring = exp(g,Nc_3335) in
                                            {3669}let m1_3337: bitstring = (Sess,SPc_3334,gNc_3336) in
                                            {3670}event beginCli(Cli,Sess,gNc_3336);
                                            {3671}out(c, (pkCli_3200,enc(m1_3337,pkSess_3331),sign(h(m1_3337),skCli_3199)));
                                            {3672}in(c, (ePartS_3338: bitstring,sigPartS_3339: bitstring));
                                            {3673}let (=Cli,PartS_3340: bitstring) = dec(ePartS_3338,skCli_3199) in
                                            {3674}if (verify(h((Cli,PartS_3340)),sigPartS_3339,pkSess_3331) <> true) then
                                                0
                                            else
                                                {3675}event endCli(Sess,Cli,PartS_3340)
                                )
                                else
                                    {3676}let pkSess_3341: bitstring = fail-any in
                                    {3677}out(c, GetEndpointRequest);
                                    {3678}in(c, (SPs_3342: bitstring,=SignAndEncrypt,UP_3343: bitstring,=pkSess_3341));
                                    {3679}new SPc_3344: bitstring;
                                    {3680}new Nc_3345: bitstring;
                                    {3681}let gNc_3346: bitstring = exp(g,Nc_3345) in
                                    {3682}let m1_3347: bitstring = (Sess,SPc_3344,gNc_3346) in
                                    {3683}event beginCli(Cli,Sess,gNc_3346);
                                    {3684}out(c, (pkCli_3200,enc(m1_3347,pkSess_3341),sign(h(m1_3347),skCli_3199)));
                                    {3685}in(c, (ePartS_3348: bitstring,sigPartS_3349: bitstring));
                                    {3686}let (=Cli,PartS_3350: bitstring) = dec(ePartS_3348,skCli_3199) in
                                    {3687}if (verify(h((Cli,PartS_3350)),sigPartS_3349,pkSess_3341) <> true) then
                                        0
                                    else
                                        {3688}event endCli(Sess,Cli,PartS_3350)
                            )
                            else
                                {3689}let v_3351: bool = (Disco = C) in
                                (
                                    {3690}if v_3351 then
                                    (
                                        {3691}let pkDisco_3352: bitstring = pub(skC) in
                                        {3692}let v_3353: bool = (Sess = A) in
                                        (
                                            {3693}if v_3353 then
                                            (
                                                {3694}let pkSess_3354: bitstring = pub(skA) in
                                                {3695}out(c, GetEndpointRequest);
                                                {3696}in(c, (SPs_3355: bitstring,=SignAndEncrypt,UP_3356: bitstring,=pkSess_3354));
                                                {3697}new SPc_3357: bitstring;
                                                {3698}new Nc_3358: bitstring;
                                                {3699}let gNc_3359: bitstring = exp(g,Nc_3358) in
                                                {3700}let m1_3360: bitstring = (Sess,SPc_3357,gNc_3359) in
                                                {3701}event beginCli(Cli,Sess,gNc_3359);
                                                {3702}out(c, (pkCli_3200,enc(m1_3360,pkSess_3354),sign(h(m1_3360),skCli_3199)));
                                                {3703}in(c, (ePartS_3361: bitstring,sigPartS_3362: bitstring));
                                                {3704}let (=Cli,PartS_3363: bitstring) = dec(ePartS_3361,skCli_3199) in
                                                {3705}if (verify(h((Cli,PartS_3363)),sigPartS_3362,pkSess_3354) <> true) then
                                                    0
                                                else
                                                    {3706}event endCli(Sess,Cli,PartS_3363)
                                            )
                                            else
                                                {3707}let v_3364: bool = (Sess = B) in
                                                (
                                                    {3708}if v_3364 then
                                                    (
                                                        {3709}let pkSess_3365: bitstring = pub(skB) in
                                                        {3710}out(c, GetEndpointRequest);
                                                        {3711}in(c, (SPs_3366: bitstring,=SignAndEncrypt,UP_3367: bitstring,=pkSess_3365));
                                                        {3712}new SPc_3368: bitstring;
                                                        {3713}new Nc_3369: bitstring;
                                                        {3714}let gNc_3370: bitstring = exp(g,Nc_3369) in
                                                        {3715}let m1_3371: bitstring = (Sess,SPc_3368,gNc_3370) in
                                                        {3716}event beginCli(Cli,Sess,gNc_3370);
                                                        {3717}out(c, (pkCli_3200,enc(m1_3371,pkSess_3365),sign(h(m1_3371),skCli_3199)));
                                                        {3718}in(c, (ePartS_3372: bitstring,sigPartS_3373: bitstring));
                                                        {3719}let (=Cli,PartS_3374: bitstring) = dec(ePartS_3372,skCli_3199) in
                                                        {3720}if (verify(h((Cli,PartS_3374)),sigPartS_3373,pkSess_3365) <> true) then
                                                            0
                                                        else
                                                            {3721}event endCli(Sess,Cli,PartS_3374)
                                                    )
                                                    else
                                                        {3722}let v_3375: bool = (Sess = C) in
                                                        (
                                                            {3723}if v_3375 then
                                                            (
                                                                {3724}let pkSess_3376: bitstring = pub(skC) in
                                                                {3725}out(c, GetEndpointRequest);
                                                                {3726}in(c, (SPs_3377: bitstring,=SignAndEncrypt,UP_3378: bitstring,=pkSess_3376));
                                                                {3727}new SPc_3379: bitstring;
                                                                {3728}new Nc_3380: bitstring;
                                                                {3729}let gNc_3381: bitstring = exp(g,Nc_3380) in
                                                                {3730}let m1_3382: bitstring = (Sess,SPc_3379,gNc_3381) in
                                                                {3731}event beginCli(Cli,Sess,gNc_3381);
                                                                {3732}out(c, (pkCli_3200,enc(m1_3382,pkSess_3376),sign(h(m1_3382),skCli_3199)));
                                                                {3733}in(c, (ePartS_3383: bitstring,sigPartS_3384: bitstring));
                                                                {3734}let (=Cli,PartS_3385: bitstring) = dec(ePartS_3383,skCli_3199) in
                                                                {3735}if (verify(h((Cli,PartS_3385)),sigPartS_3384,pkSess_3376) <> true) then
                                                                    0
                                                                else
                                                                    {3736}event endCli(Sess,Cli,PartS_3385)
                                                            )
                                                            else
                                                                {3737}let pkSess_3386: bitstring = pub(skI) in
                                                                {3738}out(c, GetEndpointRequest);
                                                                {3739}in(c, (SPs_3387: bitstring,=SignAndEncrypt,UP_3388: bitstring,=pkSess_3386));
                                                                {3740}new SPc_3389: bitstring;
                                                                {3741}new Nc_3390: bitstring;
                                                                {3742}let gNc_3391: bitstring = exp(g,Nc_3390) in
                                                                {3743}let m1_3392: bitstring = (Sess,SPc_3389,gNc_3391) in
                                                                {3744}event beginCli(Cli,Sess,gNc_3391);
                                                                {3745}out(c, (pkCli_3200,enc(m1_3392,pkSess_3386),sign(h(m1_3392),skCli_3199)));
                                                                {3746}in(c, (ePartS_3393: bitstring,sigPartS_3394: bitstring));
                                                                {3747}let (=Cli,PartS_3395: bitstring) = dec(ePartS_3393,skCli_3199) in
                                                                {3748}if (verify(h((Cli,PartS_3395)),sigPartS_3394,pkSess_3386) <> true) then
                                                                    0
                                                                else
                                                                    {3749}event endCli(Sess,Cli,PartS_3395)
                                                        )
                                                        else
                                                            {3750}let pkSess_3396: bitstring = fail-any in
                                                            {3751}out(c, GetEndpointRequest);
                                                            {3752}in(c, (SPs_3397: bitstring,=SignAndEncrypt,UP_3398: bitstring,=pkSess_3396));
                                                            {3753}new SPc_3399: bitstring;
                                                            {3754}new Nc_3400: bitstring;
                                                            {3755}let gNc_3401: bitstring = exp(g,Nc_3400) in
                                                            {3756}let m1_3402: bitstring = (Sess,SPc_3399,gNc_3401) in
                                                            {3757}event beginCli(Cli,Sess,gNc_3401);
                                                            {3758}out(c, (pkCli_3200,enc(m1_3402,pkSess_3396),sign(h(m1_3402),skCli_3199)));
                                                            {3759}in(c, (ePartS_3403: bitstring,sigPartS_3404: bitstring));
                                                            {3760}let (=Cli,PartS_3405: bitstring) = dec(ePartS_3403,skCli_3199) in
                                                            {3761}if (verify(h((Cli,PartS_3405)),sigPartS_3404,pkSess_3396) <> true) then
                                                                0
                                                            else
                                                                {3762}event endCli(Sess,Cli,PartS_3405)
                                                )
                                                else
                                                    {3763}let pkSess_3406: bitstring = fail-any in
                                                    {3764}out(c, GetEndpointRequest);
                                                    {3765}in(c, (SPs_3407: bitstring,=SignAndEncrypt,UP_3408: bitstring,=pkSess_3406));
                                                    {3766}new SPc_3409: bitstring;
                                                    {3767}new Nc_3410: bitstring;
                                                    {3768}let gNc_3411: bitstring = exp(g,Nc_3410) in
                                                    {3769}let m1_3412: bitstring = (Sess,SPc_3409,gNc_3411) in
                                                    {3770}event beginCli(Cli,Sess,gNc_3411);
                                                    {3771}out(c, (pkCli_3200,enc(m1_3412,pkSess_3406),sign(h(m1_3412),skCli_3199)));
                                                    {3772}in(c, (ePartS_3413: bitstring,sigPartS_3414: bitstring));
                                                    {3773}let (=Cli,PartS_3415: bitstring) = dec(ePartS_3413,skCli_3199) in
                                                    {3774}if (verify(h((Cli,PartS_3415)),sigPartS_3414,pkSess_3406) <> true) then
                                                        0
                                                    else
                                                        {3775}event endCli(Sess,Cli,PartS_3415)
                                        )
                                        else
                                            {3776}let pkSess_3416: bitstring = fail-any in
                                            {3777}out(c, GetEndpointRequest);
                                            {3778}in(c, (SPs_3417: bitstring,=SignAndEncrypt,UP_3418: bitstring,=pkSess_3416));
                                            {3779}new SPc_3419: bitstring;
                                            {3780}new Nc_3420: bitstring;
                                            {3781}let gNc_3421: bitstring = exp(g,Nc_3420) in
                                            {3782}let m1_3422: bitstring = (Sess,SPc_3419,gNc_3421) in
                                            {3783}event beginCli(Cli,Sess,gNc_3421);
                                            {3784}out(c, (pkCli_3200,enc(m1_3422,pkSess_3416),sign(h(m1_3422),skCli_3199)));
                                            {3785}in(c, (ePartS_3423: bitstring,sigPartS_3424: bitstring));
                                            {3786}let (=Cli,PartS_3425: bitstring) = dec(ePartS_3423,skCli_3199) in
                                            {3787}if (verify(h((Cli,PartS_3425)),sigPartS_3424,pkSess_3416) <> true) then
                                                0
                                            else
                                                {3788}event endCli(Sess,Cli,PartS_3425)
                                    )
                                    else
                                        {3789}let pkDisco_3426: bitstring = pub(skI) in
                                        {3790}let v_3427: bool = (Sess = A) in
                                        (
                                            {3791}if v_3427 then
                                            (
                                                {3792}let pkSess_3428: bitstring = pub(skA) in
                                                {3793}out(c, GetEndpointRequest);
                                                {3794}in(c, (SPs_3429: bitstring,=SignAndEncrypt,UP_3430: bitstring,=pkSess_3428));
                                                {3795}new SPc_3431: bitstring;
                                                {3796}new Nc_3432: bitstring;
                                                {3797}let gNc_3433: bitstring = exp(g,Nc_3432) in
                                                {3798}let m1_3434: bitstring = (Sess,SPc_3431,gNc_3433) in
                                                {3799}event beginCli(Cli,Sess,gNc_3433);
                                                {3800}out(c, (pkCli_3200,enc(m1_3434,pkSess_3428),sign(h(m1_3434),skCli_3199)));
                                                {3801}in(c, (ePartS_3435: bitstring,sigPartS_3436: bitstring));
                                                {3802}let (=Cli,PartS_3437: bitstring) = dec(ePartS_3435,skCli_3199) in
                                                {3803}if (verify(h((Cli,PartS_3437)),sigPartS_3436,pkSess_3428) <> true) then
                                                    0
                                                else
                                                    {3804}event endCli(Sess,Cli,PartS_3437)
                                            )
                                            else
                                                {3805}let v_3438: bool = (Sess = B) in
                                                (
                                                    {3806}if v_3438 then
                                                    (
                                                        {3807}let pkSess_3439: bitstring = pub(skB) in
                                                        {3808}out(c, GetEndpointRequest);
                                                        {3809}in(c, (SPs_3440: bitstring,=SignAndEncrypt,UP_3441: bitstring,=pkSess_3439));
                                                        {3810}new SPc_3442: bitstring;
                                                        {3811}new Nc_3443: bitstring;
                                                        {3812}let gNc_3444: bitstring = exp(g,Nc_3443) in
                                                        {3813}let m1_3445: bitstring = (Sess,SPc_3442,gNc_3444) in
                                                        {3814}event beginCli(Cli,Sess,gNc_3444);
                                                        {3815}out(c, (pkCli_3200,enc(m1_3445,pkSess_3439),sign(h(m1_3445),skCli_3199)));
                                                        {3816}in(c, (ePartS_3446: bitstring,sigPartS_3447: bitstring));
                                                        {3817}let (=Cli,PartS_3448: bitstring) = dec(ePartS_3446,skCli_3199) in
                                                        {3818}if (verify(h((Cli,PartS_3448)),sigPartS_3447,pkSess_3439) <> true) then
                                                            0
                                                        else
                                                            {3819}event endCli(Sess,Cli,PartS_3448)
                                                    )
                                                    else
                                                        {3820}let v_3449: bool = (Sess = C) in
                                                        (
                                                            {3821}if v_3449 then
                                                            (
                                                                {3822}let pkSess_3450: bitstring = pub(skC) in
                                                                {3823}out(c, GetEndpointRequest);
                                                                {3824}in(c, (SPs_3451: bitstring,=SignAndEncrypt,UP_3452: bitstring,=pkSess_3450));
                                                                {3825}new SPc_3453: bitstring;
                                                                {3826}new Nc_3454: bitstring;
                                                                {3827}let gNc_3455: bitstring = exp(g,Nc_3454) in
                                                                {3828}let m1_3456: bitstring = (Sess,SPc_3453,gNc_3455) in
                                                                {3829}event beginCli(Cli,Sess,gNc_3455);
                                                                {3830}out(c, (pkCli_3200,enc(m1_3456,pkSess_3450),sign(h(m1_3456),skCli_3199)));
                                                                {3831}in(c, (ePartS_3457: bitstring,sigPartS_3458: bitstring));
                                                                {3832}let (=Cli,PartS_3459: bitstring) = dec(ePartS_3457,skCli_3199) in
                                                                {3833}if (verify(h((Cli,PartS_3459)),sigPartS_3458,pkSess_3450) <> true) then
                                                                    0
                                                                else
                                                                    {3834}event endCli(Sess,Cli,PartS_3459)
                                                            )
                                                            else
                                                                {3835}let pkSess_3460: bitstring = pub(skI) in
                                                                {3836}out(c, GetEndpointRequest);
                                                                {3837}in(c, (SPs_3461: bitstring,=SignAndEncrypt,UP_3462: bitstring,=pkSess_3460));
                                                                {3838}new SPc_3463: bitstring;
                                                                {3839}new Nc_3464: bitstring;
                                                                {3840}let gNc_3465: bitstring = exp(g,Nc_3464) in
                                                                {3841}let m1_3466: bitstring = (Sess,SPc_3463,gNc_3465) in
                                                                {3842}event beginCli(Cli,Sess,gNc_3465);
                                                                {3843}out(c, (pkCli_3200,enc(m1_3466,pkSess_3460),sign(h(m1_3466),skCli_3199)));
                                                                {3844}in(c, (ePartS_3467: bitstring,sigPartS_3468: bitstring));
                                                                {3845}let (=Cli,PartS_3469: bitstring) = dec(ePartS_3467,skCli_3199) in
                                                                {3846}if (verify(h((Cli,PartS_3469)),sigPartS_3468,pkSess_3460) <> true) then
                                                                    0
                                                                else
                                                                    {3847}event endCli(Sess,Cli,PartS_3469)
                                                        )
                                                        else
                                                            {3848}let pkSess_3470: bitstring = fail-any in
                                                            {3849}out(c, GetEndpointRequest);
                                                            {3850}in(c, (SPs_3471: bitstring,=SignAndEncrypt,UP_3472: bitstring,=pkSess_3470));
                                                            {3851}new SPc_3473: bitstring;
                                                            {3852}new Nc_3474: bitstring;
                                                            {3853}let gNc_3475: bitstring = exp(g,Nc_3474) in
                                                            {3854}let m1_3476: bitstring = (Sess,SPc_3473,gNc_3475) in
                                                            {3855}event beginCli(Cli,Sess,gNc_3475);
                                                            {3856}out(c, (pkCli_3200,enc(m1_3476,pkSess_3470),sign(h(m1_3476),skCli_3199)));
                                                            {3857}in(c, (ePartS_3477: bitstring,sigPartS_3478: bitstring));
                                                            {3858}let (=Cli,PartS_3479: bitstring) = dec(ePartS_3477,skCli_3199) in
                                                            {3859}if (verify(h((Cli,PartS_3479)),sigPartS_3478,pkSess_3470) <> true) then
                                                                0
                                                            else
                                                                {3860}event endCli(Sess,Cli,PartS_3479)
                                                )
                                                else
                                                    {3861}let pkSess_3480: bitstring = fail-any in
                                                    {3862}out(c, GetEndpointRequest);
                                                    {3863}in(c, (SPs_3481: bitstring,=SignAndEncrypt,UP_3482: bitstring,=pkSess_3480));
                                                    {3864}new SPc_3483: bitstring;
                                                    {3865}new Nc_3484: bitstring;
                                                    {3866}let gNc_3485: bitstring = exp(g,Nc_3484) in
                                                    {3867}let m1_3486: bitstring = (Sess,SPc_3483,gNc_3485) in
                                                    {3868}event beginCli(Cli,Sess,gNc_3485);
                                                    {3869}out(c, (pkCli_3200,enc(m1_3486,pkSess_3480),sign(h(m1_3486),skCli_3199)));
                                                    {3870}in(c, (ePartS_3487: bitstring,sigPartS_3488: bitstring));
                                                    {3871}let (=Cli,PartS_3489: bitstring) = dec(ePartS_3487,skCli_3199) in
                                                    {3872}if (verify(h((Cli,PartS_3489)),sigPartS_3488,pkSess_3480) <> true) then
                                                        0
                                                    else
                                                        {3873}event endCli(Sess,Cli,PartS_3489)
                                        )
                                        else
                                            {3874}let pkSess_3490: bitstring = fail-any in
                                            {3875}out(c, GetEndpointRequest);
                                            {3876}in(c, (SPs_3491: bitstring,=SignAndEncrypt,UP_3492: bitstring,=pkSess_3490));
                                            {3877}new SPc_3493: bitstring;
                                            {3878}new Nc_3494: bitstring;
                                            {3879}let gNc_3495: bitstring = exp(g,Nc_3494) in
                                            {3880}let m1_3496: bitstring = (Sess,SPc_3493,gNc_3495) in
                                            {3881}event beginCli(Cli,Sess,gNc_3495);
                                            {3882}out(c, (pkCli_3200,enc(m1_3496,pkSess_3490),sign(h(m1_3496),skCli_3199)));
                                            {3883}in(c, (ePartS_3497: bitstring,sigPartS_3498: bitstring));
                                            {3884}let (=Cli,PartS_3499: bitstring) = dec(ePartS_3497,skCli_3199) in
                                            {3885}if (verify(h((Cli,PartS_3499)),sigPartS_3498,pkSess_3490) <> true) then
                                                0
                                            else
                                                {3886}event endCli(Sess,Cli,PartS_3499)
                                )
                                else
                                    {3887}let pkDisco_3500: bitstring = fail-any in
                                    {3888}let v_3501: bool = (Sess = A) in
                                    (
                                        {3889}if v_3501 then
                                        (
                                            {3890}let pkSess_3502: bitstring = pub(skA) in
                                            {3891}out(c, GetEndpointRequest);
                                            {3892}in(c, (SPs_3503: bitstring,=SignAndEncrypt,UP_3504: bitstring,=pkSess_3502));
                                            {3893}new SPc_3505: bitstring;
                                            {3894}new Nc_3506: bitstring;
                                            {3895}let gNc_3507: bitstring = exp(g,Nc_3506) in
                                            {3896}let m1_3508: bitstring = (Sess,SPc_3505,gNc_3507) in
                                            {3897}event beginCli(Cli,Sess,gNc_3507);
                                            {3898}out(c, (pkCli_3200,enc(m1_3508,pkSess_3502),sign(h(m1_3508),skCli_3199)));
                                            {3899}in(c, (ePartS_3509: bitstring,sigPartS_3510: bitstring));
                                            {3900}let (=Cli,PartS_3511: bitstring) = dec(ePartS_3509,skCli_3199) in
                                            {3901}if (verify(h((Cli,PartS_3511)),sigPartS_3510,pkSess_3502) <> true) then
                                                0
                                            else
                                                {3902}event endCli(Sess,Cli,PartS_3511)
                                        )
                                        else
                                            {3903}let v_3512: bool = (Sess = B) in
                                            (
                                                {3904}if v_3512 then
                                                (
                                                    {3905}let pkSess_3513: bitstring = pub(skB) in
                                                    {3906}out(c, GetEndpointRequest);
                                                    {3907}in(c, (SPs_3514: bitstring,=SignAndEncrypt,UP_3515: bitstring,=pkSess_3513));
                                                    {3908}new SPc_3516: bitstring;
                                                    {3909}new Nc_3517: bitstring;
                                                    {3910}let gNc_3518: bitstring = exp(g,Nc_3517) in
                                                    {3911}let m1_3519: bitstring = (Sess,SPc_3516,gNc_3518) in
                                                    {3912}event beginCli(Cli,Sess,gNc_3518);
                                                    {3913}out(c, (pkCli_3200,enc(m1_3519,pkSess_3513),sign(h(m1_3519),skCli_3199)));
                                                    {3914}in(c, (ePartS_3520: bitstring,sigPartS_3521: bitstring));
                                                    {3915}let (=Cli,PartS_3522: bitstring) = dec(ePartS_3520,skCli_3199) in
                                                    {3916}if (verify(h((Cli,PartS_3522)),sigPartS_3521,pkSess_3513) <> true) then
                                                        0
                                                    else
                                                        {3917}event endCli(Sess,Cli,PartS_3522)
                                                )
                                                else
                                                    {3918}let v_3523: bool = (Sess = C) in
                                                    (
                                                        {3919}if v_3523 then
                                                        (
                                                            {3920}let pkSess_3524: bitstring = pub(skC) in
                                                            {3921}out(c, GetEndpointRequest);
                                                            {3922}in(c, (SPs_3525: bitstring,=SignAndEncrypt,UP_3526: bitstring,=pkSess_3524));
                                                            {3923}new SPc_3527: bitstring;
                                                            {3924}new Nc_3528: bitstring;
                                                            {3925}let gNc_3529: bitstring = exp(g,Nc_3528) in
                                                            {3926}let m1_3530: bitstring = (Sess,SPc_3527,gNc_3529) in
                                                            {3927}event beginCli(Cli,Sess,gNc_3529);
                                                            {3928}out(c, (pkCli_3200,enc(m1_3530,pkSess_3524),sign(h(m1_3530),skCli_3199)));
                                                            {3929}in(c, (ePartS_3531: bitstring,sigPartS_3532: bitstring));
                                                            {3930}let (=Cli,PartS_3533: bitstring) = dec(ePartS_3531,skCli_3199) in
                                                            {3931}if (verify(h((Cli,PartS_3533)),sigPartS_3532,pkSess_3524) <> true) then
                                                                0
                                                            else
                                                                {3932}event endCli(Sess,Cli,PartS_3533)
                                                        )
                                                        else
                                                            {3933}let pkSess_3534: bitstring = pub(skI) in
                                                            {3934}out(c, GetEndpointRequest);
                                                            {3935}in(c, (SPs_3535: bitstring,=SignAndEncrypt,UP_3536: bitstring,=pkSess_3534));
                                                            {3936}new SPc_3537: bitstring;
                                                            {3937}new Nc_3538: bitstring;
                                                            {3938}let gNc_3539: bitstring = exp(g,Nc_3538) in
                                                            {3939}let m1_3540: bitstring = (Sess,SPc_3537,gNc_3539) in
                                                            {3940}event beginCli(Cli,Sess,gNc_3539);
                                                            {3941}out(c, (pkCli_3200,enc(m1_3540,pkSess_3534),sign(h(m1_3540),skCli_3199)));
                                                            {3942}in(c, (ePartS_3541: bitstring,sigPartS_3542: bitstring));
                                                            {3943}let (=Cli,PartS_3543: bitstring) = dec(ePartS_3541,skCli_3199) in
                                                            {3944}if (verify(h((Cli,PartS_3543)),sigPartS_3542,pkSess_3534) <> true) then
                                                                0
                                                            else
                                                                {3945}event endCli(Sess,Cli,PartS_3543)
                                                    )
                                                    else
                                                        {3946}let pkSess_3544: bitstring = fail-any in
                                                        {3947}out(c, GetEndpointRequest);
                                                        {3948}in(c, (SPs_3545: bitstring,=SignAndEncrypt,UP_3546: bitstring,=pkSess_3544));
                                                        {3949}new SPc_3547: bitstring;
                                                        {3950}new Nc_3548: bitstring;
                                                        {3951}let gNc_3549: bitstring = exp(g,Nc_3548) in
                                                        {3952}let m1_3550: bitstring = (Sess,SPc_3547,gNc_3549) in
                                                        {3953}event beginCli(Cli,Sess,gNc_3549);
                                                        {3954}out(c, (pkCli_3200,enc(m1_3550,pkSess_3544),sign(h(m1_3550),skCli_3199)));
                                                        {3955}in(c, (ePartS_3551: bitstring,sigPartS_3552: bitstring));
                                                        {3956}let (=Cli,PartS_3553: bitstring) = dec(ePartS_3551,skCli_3199) in
                                                        {3957}if (verify(h((Cli,PartS_3553)),sigPartS_3552,pkSess_3544) <> true) then
                                                            0
                                                        else
                                                            {3958}event endCli(Sess,Cli,PartS_3553)
                                            )
                                            else
                                                {3959}let pkSess_3554: bitstring = fail-any in
                                                {3960}out(c, GetEndpointRequest);
                                                {3961}in(c, (SPs_3555: bitstring,=SignAndEncrypt,UP_3556: bitstring,=pkSess_3554));
                                                {3962}new SPc_3557: bitstring;
                                                {3963}new Nc_3558: bitstring;
                                                {3964}let gNc_3559: bitstring = exp(g,Nc_3558) in
                                                {3965}let m1_3560: bitstring = (Sess,SPc_3557,gNc_3559) in
                                                {3966}event beginCli(Cli,Sess,gNc_3559);
                                                {3967}out(c, (pkCli_3200,enc(m1_3560,pkSess_3554),sign(h(m1_3560),skCli_3199)));
                                                {3968}in(c, (ePartS_3561: bitstring,sigPartS_3562: bitstring));
                                                {3969}let (=Cli,PartS_3563: bitstring) = dec(ePartS_3561,skCli_3199) in
                                                {3970}if (verify(h((Cli,PartS_3563)),sigPartS_3562,pkSess_3554) <> true) then
                                                    0
                                                else
                                                    {3971}event endCli(Sess,Cli,PartS_3563)
                                    )
                                    else
                                        {3972}let pkSess_3564: bitstring = fail-any in
                                        {3973}out(c, GetEndpointRequest);
                                        {3974}in(c, (SPs_3565: bitstring,=SignAndEncrypt,UP_3566: bitstring,=pkSess_3564));
                                        {3975}new SPc_3567: bitstring;
                                        {3976}new Nc_3568: bitstring;
                                        {3977}let gNc_3569: bitstring = exp(g,Nc_3568) in
                                        {3978}let m1_3570: bitstring = (Sess,SPc_3567,gNc_3569) in
                                        {3979}event beginCli(Cli,Sess,gNc_3569);
                                        {3980}out(c, (pkCli_3200,enc(m1_3570,pkSess_3564),sign(h(m1_3570),skCli_3199)));
                                        {3981}in(c, (ePartS_3571: bitstring,sigPartS_3572: bitstring));
                                        {3982}let (=Cli,PartS_3573: bitstring) = dec(ePartS_3571,skCli_3199) in
                                        {3983}if (verify(h((Cli,PartS_3573)),sigPartS_3572,pkSess_3564) <> true) then
                                            0
                                        else
                                            {3984}event endCli(Sess,Cli,PartS_3573)
                        )
                        else
                            {3985}let pkDisco_3574: bitstring = fail-any in
                            {3986}let v_3575: bool = (Sess = A) in
                            (
                                {3987}if v_3575 then
                                (
                                    {3988}let pkSess_3576: bitstring = pub(skA) in
                                    {3989}out(c, GetEndpointRequest);
                                    {3990}in(c, (SPs_3577: bitstring,=SignAndEncrypt,UP_3578: bitstring,=pkSess_3576));
                                    {3991}new SPc_3579: bitstring;
                                    {3992}new Nc_3580: bitstring;
                                    {3993}let gNc_3581: bitstring = exp(g,Nc_3580) in
                                    {3994}let m1_3582: bitstring = (Sess,SPc_3579,gNc_3581) in
                                    {3995}event beginCli(Cli,Sess,gNc_3581);
                                    {3996}out(c, (pkCli_3200,enc(m1_3582,pkSess_3576),sign(h(m1_3582),skCli_3199)));
                                    {3997}in(c, (ePartS_3583: bitstring,sigPartS_3584: bitstring));
                                    {3998}let (=Cli,PartS_3585: bitstring) = dec(ePartS_3583,skCli_3199) in
                                    {3999}if (verify(h((Cli,PartS_3585)),sigPartS_3584,pkSess_3576) <> true) then
                                        0
                                    else
                                        {4000}event endCli(Sess,Cli,PartS_3585)
                                )
                                else
                                    {4001}let v_3586: bool = (Sess = B) in
                                    (
                                        {4002}if v_3586 then
                                        (
                                            {4003}let pkSess_3587: bitstring = pub(skB) in
                                            {4004}out(c, GetEndpointRequest);
                                            {4005}in(c, (SPs_3588: bitstring,=SignAndEncrypt,UP_3589: bitstring,=pkSess_3587));
                                            {4006}new SPc_3590: bitstring;
                                            {4007}new Nc_3591: bitstring;
                                            {4008}let gNc_3592: bitstring = exp(g,Nc_3591) in
                                            {4009}let m1_3593: bitstring = (Sess,SPc_3590,gNc_3592) in
                                            {4010}event beginCli(Cli,Sess,gNc_3592);
                                            {4011}out(c, (pkCli_3200,enc(m1_3593,pkSess_3587),sign(h(m1_3593),skCli_3199)));
                                            {4012}in(c, (ePartS_3594: bitstring,sigPartS_3595: bitstring));
                                            {4013}let (=Cli,PartS_3596: bitstring) = dec(ePartS_3594,skCli_3199) in
                                            {4014}if (verify(h((Cli,PartS_3596)),sigPartS_3595,pkSess_3587) <> true) then
                                                0
                                            else
                                                {4015}event endCli(Sess,Cli,PartS_3596)
                                        )
                                        else
                                            {4016}let v_3597: bool = (Sess = C) in
                                            (
                                                {4017}if v_3597 then
                                                (
                                                    {4018}let pkSess_3598: bitstring = pub(skC) in
                                                    {4019}out(c, GetEndpointRequest);
                                                    {4020}in(c, (SPs_3599: bitstring,=SignAndEncrypt,UP_3600: bitstring,=pkSess_3598));
                                                    {4021}new SPc_3601: bitstring;
                                                    {4022}new Nc_3602: bitstring;
                                                    {4023}let gNc_3603: bitstring = exp(g,Nc_3602) in
                                                    {4024}let m1_3604: bitstring = (Sess,SPc_3601,gNc_3603) in
                                                    {4025}event beginCli(Cli,Sess,gNc_3603);
                                                    {4026}out(c, (pkCli_3200,enc(m1_3604,pkSess_3598),sign(h(m1_3604),skCli_3199)));
                                                    {4027}in(c, (ePartS_3605: bitstring,sigPartS_3606: bitstring));
                                                    {4028}let (=Cli,PartS_3607: bitstring) = dec(ePartS_3605,skCli_3199) in
                                                    {4029}if (verify(h((Cli,PartS_3607)),sigPartS_3606,pkSess_3598) <> true) then
                                                        0
                                                    else
                                                        {4030}event endCli(Sess,Cli,PartS_3607)
                                                )
                                                else
                                                    {4031}let pkSess_3608: bitstring = pub(skI) in
                                                    {4032}out(c, GetEndpointRequest);
                                                    {4033}in(c, (SPs_3609: bitstring,=SignAndEncrypt,UP_3610: bitstring,=pkSess_3608));
                                                    {4034}new SPc_3611: bitstring;
                                                    {4035}new Nc_3612: bitstring;
                                                    {4036}let gNc_3613: bitstring = exp(g,Nc_3612) in
                                                    {4037}let m1_3614: bitstring = (Sess,SPc_3611,gNc_3613) in
                                                    {4038}event beginCli(Cli,Sess,gNc_3613);
                                                    {4039}out(c, (pkCli_3200,enc(m1_3614,pkSess_3608),sign(h(m1_3614),skCli_3199)));
                                                    {4040}in(c, (ePartS_3615: bitstring,sigPartS_3616: bitstring));
                                                    {4041}let (=Cli,PartS_3617: bitstring) = dec(ePartS_3615,skCli_3199) in
                                                    {4042}if (verify(h((Cli,PartS_3617)),sigPartS_3616,pkSess_3608) <> true) then
                                                        0
                                                    else
                                                        {4043}event endCli(Sess,Cli,PartS_3617)
                                            )
                                            else
                                                {4044}let pkSess_3618: bitstring = fail-any in
                                                {4045}out(c, GetEndpointRequest);
                                                {4046}in(c, (SPs_3619: bitstring,=SignAndEncrypt,UP_3620: bitstring,=pkSess_3618));
                                                {4047}new SPc_3621: bitstring;
                                                {4048}new Nc_3622: bitstring;
                                                {4049}let gNc_3623: bitstring = exp(g,Nc_3622) in
                                                {4050}let m1_3624: bitstring = (Sess,SPc_3621,gNc_3623) in
                                                {4051}event beginCli(Cli,Sess,gNc_3623);
                                                {4052}out(c, (pkCli_3200,enc(m1_3624,pkSess_3618),sign(h(m1_3624),skCli_3199)));
                                                {4053}in(c, (ePartS_3625: bitstring,sigPartS_3626: bitstring));
                                                {4054}let (=Cli,PartS_3627: bitstring) = dec(ePartS_3625,skCli_3199) in
                                                {4055}if (verify(h((Cli,PartS_3627)),sigPartS_3626,pkSess_3618) <> true) then
                                                    0
                                                else
                                                    {4056}event endCli(Sess,Cli,PartS_3627)
                                    )
                                    else
                                        {4057}let pkSess_3628: bitstring = fail-any in
                                        {4058}out(c, GetEndpointRequest);
                                        {4059}in(c, (SPs_3629: bitstring,=SignAndEncrypt,UP_3630: bitstring,=pkSess_3628));
                                        {4060}new SPc_3631: bitstring;
                                        {4061}new Nc_3632: bitstring;
                                        {4062}let gNc_3633: bitstring = exp(g,Nc_3632) in
                                        {4063}let m1_3634: bitstring = (Sess,SPc_3631,gNc_3633) in
                                        {4064}event beginCli(Cli,Sess,gNc_3633);
                                        {4065}out(c, (pkCli_3200,enc(m1_3634,pkSess_3628),sign(h(m1_3634),skCli_3199)));
                                        {4066}in(c, (ePartS_3635: bitstring,sigPartS_3636: bitstring));
                                        {4067}let (=Cli,PartS_3637: bitstring) = dec(ePartS_3635,skCli_3199) in
                                        {4068}if (verify(h((Cli,PartS_3637)),sigPartS_3636,pkSess_3628) <> true) then
                                            0
                                        else
                                            {4069}event endCli(Sess,Cli,PartS_3637)
                            )
                            else
                                {4070}let pkSess_3638: bitstring = fail-any in
                                {4071}out(c, GetEndpointRequest);
                                {4072}in(c, (SPs_3639: bitstring,=SignAndEncrypt,UP_3640: bitstring,=pkSess_3638));
                                {4073}new SPc_3641: bitstring;
                                {4074}new Nc_3642: bitstring;
                                {4075}let gNc_3643: bitstring = exp(g,Nc_3642) in
                                {4076}let m1_3644: bitstring = (Sess,SPc_3641,gNc_3643) in
                                {4077}event beginCli(Cli,Sess,gNc_3643);
                                {4078}out(c, (pkCli_3200,enc(m1_3644,pkSess_3638),sign(h(m1_3644),skCli_3199)));
                                {4079}in(c, (ePartS_3645: bitstring,sigPartS_3646: bitstring));
                                {4080}let (=Cli,PartS_3647: bitstring) = dec(ePartS_3645,skCli_3199) in
                                {4081}if (verify(h((Cli,PartS_3647)),sigPartS_3646,pkSess_3638) <> true) then
                                    0
                                else
                                    {4082}event endCli(Sess,Cli,PartS_3647)
                )
                else
                    {4083}let pkDisco_3648: bitstring = fail-any in
                    {4084}let v_3649: bool = (Sess = A) in
                    (
                        {4085}if v_3649 then
                        (
                            {4086}let pkSess_3650: bitstring = pub(skA) in
                            {4087}out(c, GetEndpointRequest);
                            {4088}in(c, (SPs_3651: bitstring,=SignAndEncrypt,UP_3652: bitstring,=pkSess_3650));
                            {4089}new SPc_3653: bitstring;
                            {4090}new Nc_3654: bitstring;
                            {4091}let gNc_3655: bitstring = exp(g,Nc_3654) in
                            {4092}let m1_3656: bitstring = (Sess,SPc_3653,gNc_3655) in
                            {4093}event beginCli(Cli,Sess,gNc_3655);
                            {4094}out(c, (pkCli_3200,enc(m1_3656,pkSess_3650),sign(h(m1_3656),skCli_3199)));
                            {4095}in(c, (ePartS_3657: bitstring,sigPartS_3658: bitstring));
                            {4096}let (=Cli,PartS_3659: bitstring) = dec(ePartS_3657,skCli_3199) in
                            {4097}if (verify(h((Cli,PartS_3659)),sigPartS_3658,pkSess_3650) <> true) then
                                0
                            else
                                {4098}event endCli(Sess,Cli,PartS_3659)
                        )
                        else
                            {4099}let v_3660: bool = (Sess = B) in
                            (
                                {4100}if v_3660 then
                                (
                                    {4101}let pkSess_3661: bitstring = pub(skB) in
                                    {4102}out(c, GetEndpointRequest);
                                    {4103}in(c, (SPs_3662: bitstring,=SignAndEncrypt,UP_3663: bitstring,=pkSess_3661));
                                    {4104}new SPc_3664: bitstring;
                                    {4105}new Nc_3665: bitstring;
                                    {4106}let gNc_3666: bitstring = exp(g,Nc_3665) in
                                    {4107}let m1_3667: bitstring = (Sess,SPc_3664,gNc_3666) in
                                    {4108}event beginCli(Cli,Sess,gNc_3666);
                                    {4109}out(c, (pkCli_3200,enc(m1_3667,pkSess_3661),sign(h(m1_3667),skCli_3199)));
                                    {4110}in(c, (ePartS_3668: bitstring,sigPartS_3669: bitstring));
                                    {4111}let (=Cli,PartS_3670: bitstring) = dec(ePartS_3668,skCli_3199) in
                                    {4112}if (verify(h((Cli,PartS_3670)),sigPartS_3669,pkSess_3661) <> true) then
                                        0
                                    else
                                        {4113}event endCli(Sess,Cli,PartS_3670)
                                )
                                else
                                    {4114}let v_3671: bool = (Sess = C) in
                                    (
                                        {4115}if v_3671 then
                                        (
                                            {4116}let pkSess_3672: bitstring = pub(skC) in
                                            {4117}out(c, GetEndpointRequest);
                                            {4118}in(c, (SPs_3673: bitstring,=SignAndEncrypt,UP_3674: bitstring,=pkSess_3672));
                                            {4119}new SPc_3675: bitstring;
                                            {4120}new Nc_3676: bitstring;
                                            {4121}let gNc_3677: bitstring = exp(g,Nc_3676) in
                                            {4122}let m1_3678: bitstring = (Sess,SPc_3675,gNc_3677) in
                                            {4123}event beginCli(Cli,Sess,gNc_3677);
                                            {4124}out(c, (pkCli_3200,enc(m1_3678,pkSess_3672),sign(h(m1_3678),skCli_3199)));
                                            {4125}in(c, (ePartS_3679: bitstring,sigPartS_3680: bitstring));
                                            {4126}let (=Cli,PartS_3681: bitstring) = dec(ePartS_3679,skCli_3199) in
                                            {4127}if (verify(h((Cli,PartS_3681)),sigPartS_3680,pkSess_3672) <> true) then
                                                0
                                            else
                                                {4128}event endCli(Sess,Cli,PartS_3681)
                                        )
                                        else
                                            {4129}let pkSess_3682: bitstring = pub(skI) in
                                            {4130}out(c, GetEndpointRequest);
                                            {4131}in(c, (SPs_3683: bitstring,=SignAndEncrypt,UP_3684: bitstring,=pkSess_3682));
                                            {4132}new SPc_3685: bitstring;
                                            {4133}new Nc_3686: bitstring;
                                            {4134}let gNc_3687: bitstring = exp(g,Nc_3686) in
                                            {4135}let m1_3688: bitstring = (Sess,SPc_3685,gNc_3687) in
                                            {4136}event beginCli(Cli,Sess,gNc_3687);
                                            {4137}out(c, (pkCli_3200,enc(m1_3688,pkSess_3682),sign(h(m1_3688),skCli_3199)));
                                            {4138}in(c, (ePartS_3689: bitstring,sigPartS_3690: bitstring));
                                            {4139}let (=Cli,PartS_3691: bitstring) = dec(ePartS_3689,skCli_3199) in
                                            {4140}if (verify(h((Cli,PartS_3691)),sigPartS_3690,pkSess_3682) <> true) then
                                                0
                                            else
                                                {4141}event endCli(Sess,Cli,PartS_3691)
                                    )
                                    else
                                        {4142}let pkSess_3692: bitstring = fail-any in
                                        {4143}out(c, GetEndpointRequest);
                                        {4144}in(c, (SPs_3693: bitstring,=SignAndEncrypt,UP_3694: bitstring,=pkSess_3692));
                                        {4145}new SPc_3695: bitstring;
                                        {4146}new Nc_3696: bitstring;
                                        {4147}let gNc_3697: bitstring = exp(g,Nc_3696) in
                                        {4148}let m1_3698: bitstring = (Sess,SPc_3695,gNc_3697) in
                                        {4149}event beginCli(Cli,Sess,gNc_3697);
                                        {4150}out(c, (pkCli_3200,enc(m1_3698,pkSess_3692),sign(h(m1_3698),skCli_3199)));
                                        {4151}in(c, (ePartS_3699: bitstring,sigPartS_3700: bitstring));
                                        {4152}let (=Cli,PartS_3701: bitstring) = dec(ePartS_3699,skCli_3199) in
                                        {4153}if (verify(h((Cli,PartS_3701)),sigPartS_3700,pkSess_3692) <> true) then
                                            0
                                        else
                                            {4154}event endCli(Sess,Cli,PartS_3701)
                            )
                            else
                                {4155}let pkSess_3702: bitstring = fail-any in
                                {4156}out(c, GetEndpointRequest);
                                {4157}in(c, (SPs_3703: bitstring,=SignAndEncrypt,UP_3704: bitstring,=pkSess_3702));
                                {4158}new SPc_3705: bitstring;
                                {4159}new Nc_3706: bitstring;
                                {4160}let gNc_3707: bitstring = exp(g,Nc_3706) in
                                {4161}let m1_3708: bitstring = (Sess,SPc_3705,gNc_3707) in
                                {4162}event beginCli(Cli,Sess,gNc_3707);
                                {4163}out(c, (pkCli_3200,enc(m1_3708,pkSess_3702),sign(h(m1_3708),skCli_3199)));
                                {4164}in(c, (ePartS_3709: bitstring,sigPartS_3710: bitstring));
                                {4165}let (=Cli,PartS_3711: bitstring) = dec(ePartS_3709,skCli_3199) in
                                {4166}if (verify(h((Cli,PartS_3711)),sigPartS_3710,pkSess_3702) <> true) then
                                    0
                                else
                                    {4167}event endCli(Sess,Cli,PartS_3711)
                    )
                    else
                        {4168}let pkSess_3712: bitstring = fail-any in
                        {4169}out(c, GetEndpointRequest);
                        {4170}in(c, (SPs_3713: bitstring,=SignAndEncrypt,UP_3714: bitstring,=pkSess_3712));
                        {4171}new SPc_3715: bitstring;
                        {4172}new Nc_3716: bitstring;
                        {4173}let gNc_3717: bitstring = exp(g,Nc_3716) in
                        {4174}let m1_3718: bitstring = (Sess,SPc_3715,gNc_3717) in
                        {4175}event beginCli(Cli,Sess,gNc_3717);
                        {4176}out(c, (pkCli_3200,enc(m1_3718,pkSess_3712),sign(h(m1_3718),skCli_3199)));
                        {4177}in(c, (ePartS_3719: bitstring,sigPartS_3720: bitstring));
                        {4178}let (=Cli,PartS_3721: bitstring) = dec(ePartS_3719,skCli_3199) in
                        {4179}if (verify(h((Cli,PartS_3721)),sigPartS_3720,pkSess_3712) <> true) then
                            0
                        else
                            {4180}event endCli(Sess,Cli,PartS_3721)
    )
    else
        {4181}let skCli_3722: bitstring = fail-any in
        {4182}let pkCli_3723: bitstring = pub(skCli_3722) in
        {4183}let v_3724: bool = (Disco = A) in
        (
            {4184}if v_3724 then
            (
                {4185}let pkDisco_3725: bitstring = pub(skA) in
                {4186}let v_3726: bool = (Sess = A) in
                (
                    {4187}if v_3726 then
                    (
                        {4188}let pkSess_3727: bitstring = pub(skA) in
                        {4189}out(c, GetEndpointRequest);
                        {4190}in(c, (SPs_3728: bitstring,=SignAndEncrypt,UP_3729: bitstring,=pkSess_3727));
                        {4191}new SPc_3730: bitstring;
                        {4192}new Nc_3731: bitstring;
                        {4193}let gNc_3732: bitstring = exp(g,Nc_3731) in
                        {4194}let m1_3733: bitstring = (Sess,SPc_3730,gNc_3732) in
                        {4195}event beginCli(Cli,Sess,gNc_3732);
                        {4196}out(c, (pkCli_3723,enc(m1_3733,pkSess_3727),sign(h(m1_3733),skCli_3722)));
                        {4197}in(c, (ePartS_3734: bitstring,sigPartS_3735: bitstring));
                        {4198}let (=Cli,PartS_3736: bitstring) = dec(ePartS_3734,skCli_3722) in
                        {4199}if (verify(h((Cli,PartS_3736)),sigPartS_3735,pkSess_3727) <> true) then
                            0
                        else
                            {4200}event endCli(Sess,Cli,PartS_3736)
                    )
                    else
                        {4201}let v_3737: bool = (Sess = B) in
                        (
                            {4202}if v_3737 then
                            (
                                {4203}let pkSess_3738: bitstring = pub(skB) in
                                {4204}out(c, GetEndpointRequest);
                                {4205}in(c, (SPs_3739: bitstring,=SignAndEncrypt,UP_3740: bitstring,=pkSess_3738));
                                {4206}new SPc_3741: bitstring;
                                {4207}new Nc_3742: bitstring;
                                {4208}let gNc_3743: bitstring = exp(g,Nc_3742) in
                                {4209}let m1_3744: bitstring = (Sess,SPc_3741,gNc_3743) in
                                {4210}event beginCli(Cli,Sess,gNc_3743);
                                {4211}out(c, (pkCli_3723,enc(m1_3744,pkSess_3738),sign(h(m1_3744),skCli_3722)));
                                {4212}in(c, (ePartS_3745: bitstring,sigPartS_3746: bitstring));
                                {4213}let (=Cli,PartS_3747: bitstring) = dec(ePartS_3745,skCli_3722) in
                                {4214}if (verify(h((Cli,PartS_3747)),sigPartS_3746,pkSess_3738) <> true) then
                                    0
                                else
                                    {4215}event endCli(Sess,Cli,PartS_3747)
                            )
                            else
                                {4216}let v_3748: bool = (Sess = C) in
                                (
                                    {4217}if v_3748 then
                                    (
                                        {4218}let pkSess_3749: bitstring = pub(skC) in
                                        {4219}out(c, GetEndpointRequest);
                                        {4220}in(c, (SPs_3750: bitstring,=SignAndEncrypt,UP_3751: bitstring,=pkSess_3749));
                                        {4221}new SPc_3752: bitstring;
                                        {4222}new Nc_3753: bitstring;
                                        {4223}let gNc_3754: bitstring = exp(g,Nc_3753) in
                                        {4224}let m1_3755: bitstring = (Sess,SPc_3752,gNc_3754) in
                                        {4225}event beginCli(Cli,Sess,gNc_3754);
                                        {4226}out(c, (pkCli_3723,enc(m1_3755,pkSess_3749),sign(h(m1_3755),skCli_3722)));
                                        {4227}in(c, (ePartS_3756: bitstring,sigPartS_3757: bitstring));
                                        {4228}let (=Cli,PartS_3758: bitstring) = dec(ePartS_3756,skCli_3722) in
                                        {4229}if (verify(h((Cli,PartS_3758)),sigPartS_3757,pkSess_3749) <> true) then
                                            0
                                        else
                                            {4230}event endCli(Sess,Cli,PartS_3758)
                                    )
                                    else
                                        {4231}let pkSess_3759: bitstring = pub(skI) in
                                        {4232}out(c, GetEndpointRequest);
                                        {4233}in(c, (SPs_3760: bitstring,=SignAndEncrypt,UP_3761: bitstring,=pkSess_3759));
                                        {4234}new SPc_3762: bitstring;
                                        {4235}new Nc_3763: bitstring;
                                        {4236}let gNc_3764: bitstring = exp(g,Nc_3763) in
                                        {4237}let m1_3765: bitstring = (Sess,SPc_3762,gNc_3764) in
                                        {4238}event beginCli(Cli,Sess,gNc_3764);
                                        {4239}out(c, (pkCli_3723,enc(m1_3765,pkSess_3759),sign(h(m1_3765),skCli_3722)));
                                        {4240}in(c, (ePartS_3766: bitstring,sigPartS_3767: bitstring));
                                        {4241}let (=Cli,PartS_3768: bitstring) = dec(ePartS_3766,skCli_3722) in
                                        {4242}if (verify(h((Cli,PartS_3768)),sigPartS_3767,pkSess_3759) <> true) then
                                            0
                                        else
                                            {4243}event endCli(Sess,Cli,PartS_3768)
                                )
                                else
                                    {4244}let pkSess_3769: bitstring = fail-any in
                                    {4245}out(c, GetEndpointRequest);
                                    {4246}in(c, (SPs_3770: bitstring,=SignAndEncrypt,UP_3771: bitstring,=pkSess_3769));
                                    {4247}new SPc_3772: bitstring;
                                    {4248}new Nc_3773: bitstring;
                                    {4249}let gNc_3774: bitstring = exp(g,Nc_3773) in
                                    {4250}let m1_3775: bitstring = (Sess,SPc_3772,gNc_3774) in
                                    {4251}event beginCli(Cli,Sess,gNc_3774);
                                    {4252}out(c, (pkCli_3723,enc(m1_3775,pkSess_3769),sign(h(m1_3775),skCli_3722)));
                                    {4253}in(c, (ePartS_3776: bitstring,sigPartS_3777: bitstring));
                                    {4254}let (=Cli,PartS_3778: bitstring) = dec(ePartS_3776,skCli_3722) in
                                    {4255}if (verify(h((Cli,PartS_3778)),sigPartS_3777,pkSess_3769) <> true) then
                                        0
                                    else
                                        {4256}event endCli(Sess,Cli,PartS_3778)
                        )
                        else
                            {4257}let pkSess_3779: bitstring = fail-any in
                            {4258}out(c, GetEndpointRequest);
                            {4259}in(c, (SPs_3780: bitstring,=SignAndEncrypt,UP_3781: bitstring,=pkSess_3779));
                            {4260}new SPc_3782: bitstring;
                            {4261}new Nc_3783: bitstring;
                            {4262}let gNc_3784: bitstring = exp(g,Nc_3783) in
                            {4263}let m1_3785: bitstring = (Sess,SPc_3782,gNc_3784) in
                            {4264}event beginCli(Cli,Sess,gNc_3784);
                            {4265}out(c, (pkCli_3723,enc(m1_3785,pkSess_3779),sign(h(m1_3785),skCli_3722)));
                            {4266}in(c, (ePartS_3786: bitstring,sigPartS_3787: bitstring));
                            {4267}let (=Cli,PartS_3788: bitstring) = dec(ePartS_3786,skCli_3722) in
                            {4268}if (verify(h((Cli,PartS_3788)),sigPartS_3787,pkSess_3779) <> true) then
                                0
                            else
                                {4269}event endCli(Sess,Cli,PartS_3788)
                )
                else
                    {4270}let pkSess_3789: bitstring = fail-any in
                    {4271}out(c, GetEndpointRequest);
                    {4272}in(c, (SPs_3790: bitstring,=SignAndEncrypt,UP_3791: bitstring,=pkSess_3789));
                    {4273}new SPc_3792: bitstring;
                    {4274}new Nc_3793: bitstring;
                    {4275}let gNc_3794: bitstring = exp(g,Nc_3793) in
                    {4276}let m1_3795: bitstring = (Sess,SPc_3792,gNc_3794) in
                    {4277}event beginCli(Cli,Sess,gNc_3794);
                    {4278}out(c, (pkCli_3723,enc(m1_3795,pkSess_3789),sign(h(m1_3795),skCli_3722)));
                    {4279}in(c, (ePartS_3796: bitstring,sigPartS_3797: bitstring));
                    {4280}let (=Cli,PartS_3798: bitstring) = dec(ePartS_3796,skCli_3722) in
                    {4281}if (verify(h((Cli,PartS_3798)),sigPartS_3797,pkSess_3789) <> true) then
                        0
                    else
                        {4282}event endCli(Sess,Cli,PartS_3798)
            )
            else
                {4283}let v_3799: bool = (Disco = B) in
                (
                    {4284}if v_3799 then
                    (
                        {4285}let pkDisco_3800: bitstring = pub(skB) in
                        {4286}let v_3801: bool = (Sess = A) in
                        (
                            {4287}if v_3801 then
                            (
                                {4288}let pkSess_3802: bitstring = pub(skA) in
                                {4289}out(c, GetEndpointRequest);
                                {4290}in(c, (SPs_3803: bitstring,=SignAndEncrypt,UP_3804: bitstring,=pkSess_3802));
                                {4291}new SPc_3805: bitstring;
                                {4292}new Nc_3806: bitstring;
                                {4293}let gNc_3807: bitstring = exp(g,Nc_3806) in
                                {4294}let m1_3808: bitstring = (Sess,SPc_3805,gNc_3807) in
                                {4295}event beginCli(Cli,Sess,gNc_3807);
                                {4296}out(c, (pkCli_3723,enc(m1_3808,pkSess_3802),sign(h(m1_3808),skCli_3722)));
                                {4297}in(c, (ePartS_3809: bitstring,sigPartS_3810: bitstring));
                                {4298}let (=Cli,PartS_3811: bitstring) = dec(ePartS_3809,skCli_3722) in
                                {4299}if (verify(h((Cli,PartS_3811)),sigPartS_3810,pkSess_3802) <> true) then
                                    0
                                else
                                    {4300}event endCli(Sess,Cli,PartS_3811)
                            )
                            else
                                {4301}let v_3812: bool = (Sess = B) in
                                (
                                    {4302}if v_3812 then
                                    (
                                        {4303}let pkSess_3813: bitstring = pub(skB) in
                                        {4304}out(c, GetEndpointRequest);
                                        {4305}in(c, (SPs_3814: bitstring,=SignAndEncrypt,UP_3815: bitstring,=pkSess_3813));
                                        {4306}new SPc_3816: bitstring;
                                        {4307}new Nc_3817: bitstring;
                                        {4308}let gNc_3818: bitstring = exp(g,Nc_3817) in
                                        {4309}let m1_3819: bitstring = (Sess,SPc_3816,gNc_3818) in
                                        {4310}event beginCli(Cli,Sess,gNc_3818);
                                        {4311}out(c, (pkCli_3723,enc(m1_3819,pkSess_3813),sign(h(m1_3819),skCli_3722)));
                                        {4312}in(c, (ePartS_3820: bitstring,sigPartS_3821: bitstring));
                                        {4313}let (=Cli,PartS_3822: bitstring) = dec(ePartS_3820,skCli_3722) in
                                        {4314}if (verify(h((Cli,PartS_3822)),sigPartS_3821,pkSess_3813) <> true) then
                                            0
                                        else
                                            {4315}event endCli(Sess,Cli,PartS_3822)
                                    )
                                    else
                                        {4316}let v_3823: bool = (Sess = C) in
                                        (
                                            {4317}if v_3823 then
                                            (
                                                {4318}let pkSess_3824: bitstring = pub(skC) in
                                                {4319}out(c, GetEndpointRequest);
                                                {4320}in(c, (SPs_3825: bitstring,=SignAndEncrypt,UP_3826: bitstring,=pkSess_3824));
                                                {4321}new SPc_3827: bitstring;
                                                {4322}new Nc_3828: bitstring;
                                                {4323}let gNc_3829: bitstring = exp(g,Nc_3828) in
                                                {4324}let m1_3830: bitstring = (Sess,SPc_3827,gNc_3829) in
                                                {4325}event beginCli(Cli,Sess,gNc_3829);
                                                {4326}out(c, (pkCli_3723,enc(m1_3830,pkSess_3824),sign(h(m1_3830),skCli_3722)));
                                                {4327}in(c, (ePartS_3831: bitstring,sigPartS_3832: bitstring));
                                                {4328}let (=Cli,PartS_3833: bitstring) = dec(ePartS_3831,skCli_3722) in
                                                {4329}if (verify(h((Cli,PartS_3833)),sigPartS_3832,pkSess_3824) <> true) then
                                                    0
                                                else
                                                    {4330}event endCli(Sess,Cli,PartS_3833)
                                            )
                                            else
                                                {4331}let pkSess_3834: bitstring = pub(skI) in
                                                {4332}out(c, GetEndpointRequest);
                                                {4333}in(c, (SPs_3835: bitstring,=SignAndEncrypt,UP_3836: bitstring,=pkSess_3834));
                                                {4334}new SPc_3837: bitstring;
                                                {4335}new Nc_3838: bitstring;
                                                {4336}let gNc_3839: bitstring = exp(g,Nc_3838) in
                                                {4337}let m1_3840: bitstring = (Sess,SPc_3837,gNc_3839) in
                                                {4338}event beginCli(Cli,Sess,gNc_3839);
                                                {4339}out(c, (pkCli_3723,enc(m1_3840,pkSess_3834),sign(h(m1_3840),skCli_3722)));
                                                {4340}in(c, (ePartS_3841: bitstring,sigPartS_3842: bitstring));
                                                {4341}let (=Cli,PartS_3843: bitstring) = dec(ePartS_3841,skCli_3722) in
                                                {4342}if (verify(h((Cli,PartS_3843)),sigPartS_3842,pkSess_3834) <> true) then
                                                    0
                                                else
                                                    {4343}event endCli(Sess,Cli,PartS_3843)
                                        )
                                        else
                                            {4344}let pkSess_3844: bitstring = fail-any in
                                            {4345}out(c, GetEndpointRequest);
                                            {4346}in(c, (SPs_3845: bitstring,=SignAndEncrypt,UP_3846: bitstring,=pkSess_3844));
                                            {4347}new SPc_3847: bitstring;
                                            {4348}new Nc_3848: bitstring;
                                            {4349}let gNc_3849: bitstring = exp(g,Nc_3848) in
                                            {4350}let m1_3850: bitstring = (Sess,SPc_3847,gNc_3849) in
                                            {4351}event beginCli(Cli,Sess,gNc_3849);
                                            {4352}out(c, (pkCli_3723,enc(m1_3850,pkSess_3844),sign(h(m1_3850),skCli_3722)));
                                            {4353}in(c, (ePartS_3851: bitstring,sigPartS_3852: bitstring));
                                            {4354}let (=Cli,PartS_3853: bitstring) = dec(ePartS_3851,skCli_3722) in
                                            {4355}if (verify(h((Cli,PartS_3853)),sigPartS_3852,pkSess_3844) <> true) then
                                                0
                                            else
                                                {4356}event endCli(Sess,Cli,PartS_3853)
                                )
                                else
                                    {4357}let pkSess_3854: bitstring = fail-any in
                                    {4358}out(c, GetEndpointRequest);
                                    {4359}in(c, (SPs_3855: bitstring,=SignAndEncrypt,UP_3856: bitstring,=pkSess_3854));
                                    {4360}new SPc_3857: bitstring;
                                    {4361}new Nc_3858: bitstring;
                                    {4362}let gNc_3859: bitstring = exp(g,Nc_3858) in
                                    {4363}let m1_3860: bitstring = (Sess,SPc_3857,gNc_3859) in
                                    {4364}event beginCli(Cli,Sess,gNc_3859);
                                    {4365}out(c, (pkCli_3723,enc(m1_3860,pkSess_3854),sign(h(m1_3860),skCli_3722)));
                                    {4366}in(c, (ePartS_3861: bitstring,sigPartS_3862: bitstring));
                                    {4367}let (=Cli,PartS_3863: bitstring) = dec(ePartS_3861,skCli_3722) in
                                    {4368}if (verify(h((Cli,PartS_3863)),sigPartS_3862,pkSess_3854) <> true) then
                                        0
                                    else
                                        {4369}event endCli(Sess,Cli,PartS_3863)
                        )
                        else
                            {4370}let pkSess_3864: bitstring = fail-any in
                            {4371}out(c, GetEndpointRequest);
                            {4372}in(c, (SPs_3865: bitstring,=SignAndEncrypt,UP_3866: bitstring,=pkSess_3864));
                            {4373}new SPc_3867: bitstring;
                            {4374}new Nc_3868: bitstring;
                            {4375}let gNc_3869: bitstring = exp(g,Nc_3868) in
                            {4376}let m1_3870: bitstring = (Sess,SPc_3867,gNc_3869) in
                            {4377}event beginCli(Cli,Sess,gNc_3869);
                            {4378}out(c, (pkCli_3723,enc(m1_3870,pkSess_3864),sign(h(m1_3870),skCli_3722)));
                            {4379}in(c, (ePartS_3871: bitstring,sigPartS_3872: bitstring));
                            {4380}let (=Cli,PartS_3873: bitstring) = dec(ePartS_3871,skCli_3722) in
                            {4381}if (verify(h((Cli,PartS_3873)),sigPartS_3872,pkSess_3864) <> true) then
                                0
                            else
                                {4382}event endCli(Sess,Cli,PartS_3873)
                    )
                    else
                        {4383}let v_3874: bool = (Disco = C) in
                        (
                            {4384}if v_3874 then
                            (
                                {4385}let pkDisco_3875: bitstring = pub(skC) in
                                {4386}let v_3876: bool = (Sess = A) in
                                (
                                    {4387}if v_3876 then
                                    (
                                        {4388}let pkSess_3877: bitstring = pub(skA) in
                                        {4389}out(c, GetEndpointRequest);
                                        {4390}in(c, (SPs_3878: bitstring,=SignAndEncrypt,UP_3879: bitstring,=pkSess_3877));
                                        {4391}new SPc_3880: bitstring;
                                        {4392}new Nc_3881: bitstring;
                                        {4393}let gNc_3882: bitstring = exp(g,Nc_3881) in
                                        {4394}let m1_3883: bitstring = (Sess,SPc_3880,gNc_3882) in
                                        {4395}event beginCli(Cli,Sess,gNc_3882);
                                        {4396}out(c, (pkCli_3723,enc(m1_3883,pkSess_3877),sign(h(m1_3883),skCli_3722)));
                                        {4397}in(c, (ePartS_3884: bitstring,sigPartS_3885: bitstring));
                                        {4398}let (=Cli,PartS_3886: bitstring) = dec(ePartS_3884,skCli_3722) in
                                        {4399}if (verify(h((Cli,PartS_3886)),sigPartS_3885,pkSess_3877) <> true) then
                                            0
                                        else
                                            {4400}event endCli(Sess,Cli,PartS_3886)
                                    )
                                    else
                                        {4401}let v_3887: bool = (Sess = B) in
                                        (
                                            {4402}if v_3887 then
                                            (
                                                {4403}let pkSess_3888: bitstring = pub(skB) in
                                                {4404}out(c, GetEndpointRequest);
                                                {4405}in(c, (SPs_3889: bitstring,=SignAndEncrypt,UP_3890: bitstring,=pkSess_3888));
                                                {4406}new SPc_3891: bitstring;
                                                {4407}new Nc_3892: bitstring;
                                                {4408}let gNc_3893: bitstring = exp(g,Nc_3892) in
                                                {4409}let m1_3894: bitstring = (Sess,SPc_3891,gNc_3893) in
                                                {4410}event beginCli(Cli,Sess,gNc_3893);
                                                {4411}out(c, (pkCli_3723,enc(m1_3894,pkSess_3888),sign(h(m1_3894),skCli_3722)));
                                                {4412}in(c, (ePartS_3895: bitstring,sigPartS_3896: bitstring));
                                                {4413}let (=Cli,PartS_3897: bitstring) = dec(ePartS_3895,skCli_3722) in
                                                {4414}if (verify(h((Cli,PartS_3897)),sigPartS_3896,pkSess_3888) <> true) then
                                                    0
                                                else
                                                    {4415}event endCli(Sess,Cli,PartS_3897)
                                            )
                                            else
                                                {4416}let v_3898: bool = (Sess = C) in
                                                (
                                                    {4417}if v_3898 then
                                                    (
                                                        {4418}let pkSess_3899: bitstring = pub(skC) in
                                                        {4419}out(c, GetEndpointRequest);
                                                        {4420}in(c, (SPs_3900: bitstring,=SignAndEncrypt,UP_3901: bitstring,=pkSess_3899));
                                                        {4421}new SPc_3902: bitstring;
                                                        {4422}new Nc_3903: bitstring;
                                                        {4423}let gNc_3904: bitstring = exp(g,Nc_3903) in
                                                        {4424}let m1_3905: bitstring = (Sess,SPc_3902,gNc_3904) in
                                                        {4425}event beginCli(Cli,Sess,gNc_3904);
                                                        {4426}out(c, (pkCli_3723,enc(m1_3905,pkSess_3899),sign(h(m1_3905),skCli_3722)));
                                                        {4427}in(c, (ePartS_3906: bitstring,sigPartS_3907: bitstring));
                                                        {4428}let (=Cli,PartS_3908: bitstring) = dec(ePartS_3906,skCli_3722) in
                                                        {4429}if (verify(h((Cli,PartS_3908)),sigPartS_3907,pkSess_3899) <> true) then
                                                            0
                                                        else
                                                            {4430}event endCli(Sess,Cli,PartS_3908)
                                                    )
                                                    else
                                                        {4431}let pkSess_3909: bitstring = pub(skI) in
                                                        {4432}out(c, GetEndpointRequest);
                                                        {4433}in(c, (SPs_3910: bitstring,=SignAndEncrypt,UP_3911: bitstring,=pkSess_3909));
                                                        {4434}new SPc_3912: bitstring;
                                                        {4435}new Nc_3913: bitstring;
                                                        {4436}let gNc_3914: bitstring = exp(g,Nc_3913) in
                                                        {4437}let m1_3915: bitstring = (Sess,SPc_3912,gNc_3914) in
                                                        {4438}event beginCli(Cli,Sess,gNc_3914);
                                                        {4439}out(c, (pkCli_3723,enc(m1_3915,pkSess_3909),sign(h(m1_3915),skCli_3722)));
                                                        {4440}in(c, (ePartS_3916: bitstring,sigPartS_3917: bitstring));
                                                        {4441}let (=Cli,PartS_3918: bitstring) = dec(ePartS_3916,skCli_3722) in
                                                        {4442}if (verify(h((Cli,PartS_3918)),sigPartS_3917,pkSess_3909) <> true) then
                                                            0
                                                        else
                                                            {4443}event endCli(Sess,Cli,PartS_3918)
                                                )
                                                else
                                                    {4444}let pkSess_3919: bitstring = fail-any in
                                                    {4445}out(c, GetEndpointRequest);
                                                    {4446}in(c, (SPs_3920: bitstring,=SignAndEncrypt,UP_3921: bitstring,=pkSess_3919));
                                                    {4447}new SPc_3922: bitstring;
                                                    {4448}new Nc_3923: bitstring;
                                                    {4449}let gNc_3924: bitstring = exp(g,Nc_3923) in
                                                    {4450}let m1_3925: bitstring = (Sess,SPc_3922,gNc_3924) in
                                                    {4451}event beginCli(Cli,Sess,gNc_3924);
                                                    {4452}out(c, (pkCli_3723,enc(m1_3925,pkSess_3919),sign(h(m1_3925),skCli_3722)));
                                                    {4453}in(c, (ePartS_3926: bitstring,sigPartS_3927: bitstring));
                                                    {4454}let (=Cli,PartS_3928: bitstring) = dec(ePartS_3926,skCli_3722) in
                                                    {4455}if (verify(h((Cli,PartS_3928)),sigPartS_3927,pkSess_3919) <> true) then
                                                        0
                                                    else
                                                        {4456}event endCli(Sess,Cli,PartS_3928)
                                        )
                                        else
                                            {4457}let pkSess_3929: bitstring = fail-any in
                                            {4458}out(c, GetEndpointRequest);
                                            {4459}in(c, (SPs_3930: bitstring,=SignAndEncrypt,UP_3931: bitstring,=pkSess_3929));
                                            {4460}new SPc_3932: bitstring;
                                            {4461}new Nc_3933: bitstring;
                                            {4462}let gNc_3934: bitstring = exp(g,Nc_3933) in
                                            {4463}let m1_3935: bitstring = (Sess,SPc_3932,gNc_3934) in
                                            {4464}event beginCli(Cli,Sess,gNc_3934);
                                            {4465}out(c, (pkCli_3723,enc(m1_3935,pkSess_3929),sign(h(m1_3935),skCli_3722)));
                                            {4466}in(c, (ePartS_3936: bitstring,sigPartS_3937: bitstring));
                                            {4467}let (=Cli,PartS_3938: bitstring) = dec(ePartS_3936,skCli_3722) in
                                            {4468}if (verify(h((Cli,PartS_3938)),sigPartS_3937,pkSess_3929) <> true) then
                                                0
                                            else
                                                {4469}event endCli(Sess,Cli,PartS_3938)
                                )
                                else
                                    {4470}let pkSess_3939: bitstring = fail-any in
                                    {4471}out(c, GetEndpointRequest);
                                    {4472}in(c, (SPs_3940: bitstring,=SignAndEncrypt,UP_3941: bitstring,=pkSess_3939));
                                    {4473}new SPc_3942: bitstring;
                                    {4474}new Nc_3943: bitstring;
                                    {4475}let gNc_3944: bitstring = exp(g,Nc_3943) in
                                    {4476}let m1_3945: bitstring = (Sess,SPc_3942,gNc_3944) in
                                    {4477}event beginCli(Cli,Sess,gNc_3944);
                                    {4478}out(c, (pkCli_3723,enc(m1_3945,pkSess_3939),sign(h(m1_3945),skCli_3722)));
                                    {4479}in(c, (ePartS_3946: bitstring,sigPartS_3947: bitstring));
                                    {4480}let (=Cli,PartS_3948: bitstring) = dec(ePartS_3946,skCli_3722) in
                                    {4481}if (verify(h((Cli,PartS_3948)),sigPartS_3947,pkSess_3939) <> true) then
                                        0
                                    else
                                        {4482}event endCli(Sess,Cli,PartS_3948)
                            )
                            else
                                {4483}let pkDisco_3949: bitstring = pub(skI) in
                                {4484}let v_3950: bool = (Sess = A) in
                                (
                                    {4485}if v_3950 then
                                    (
                                        {4486}let pkSess_3951: bitstring = pub(skA) in
                                        {4487}out(c, GetEndpointRequest);
                                        {4488}in(c, (SPs_3952: bitstring,=SignAndEncrypt,UP_3953: bitstring,=pkSess_3951));
                                        {4489}new SPc_3954: bitstring;
                                        {4490}new Nc_3955: bitstring;
                                        {4491}let gNc_3956: bitstring = exp(g,Nc_3955) in
                                        {4492}let m1_3957: bitstring = (Sess,SPc_3954,gNc_3956) in
                                        {4493}event beginCli(Cli,Sess,gNc_3956);
                                        {4494}out(c, (pkCli_3723,enc(m1_3957,pkSess_3951),sign(h(m1_3957),skCli_3722)));
                                        {4495}in(c, (ePartS_3958: bitstring,sigPartS_3959: bitstring));
                                        {4496}let (=Cli,PartS_3960: bitstring) = dec(ePartS_3958,skCli_3722) in
                                        {4497}if (verify(h((Cli,PartS_3960)),sigPartS_3959,pkSess_3951) <> true) then
                                            0
                                        else
                                            {4498}event endCli(Sess,Cli,PartS_3960)
                                    )
                                    else
                                        {4499}let v_3961: bool = (Sess = B) in
                                        (
                                            {4500}if v_3961 then
                                            (
                                                {4501}let pkSess_3962: bitstring = pub(skB) in
                                                {4502}out(c, GetEndpointRequest);
                                                {4503}in(c, (SPs_3963: bitstring,=SignAndEncrypt,UP_3964: bitstring,=pkSess_3962));
                                                {4504}new SPc_3965: bitstring;
                                                {4505}new Nc_3966: bitstring;
                                                {4506}let gNc_3967: bitstring = exp(g,Nc_3966) in
                                                {4507}let m1_3968: bitstring = (Sess,SPc_3965,gNc_3967) in
                                                {4508}event beginCli(Cli,Sess,gNc_3967);
                                                {4509}out(c, (pkCli_3723,enc(m1_3968,pkSess_3962),sign(h(m1_3968),skCli_3722)));
                                                {4510}in(c, (ePartS_3969: bitstring,sigPartS_3970: bitstring));
                                                {4511}let (=Cli,PartS_3971: bitstring) = dec(ePartS_3969,skCli_3722) in
                                                {4512}if (verify(h((Cli,PartS_3971)),sigPartS_3970,pkSess_3962) <> true) then
                                                    0
                                                else
                                                    {4513}event endCli(Sess,Cli,PartS_3971)
                                            )
                                            else
                                                {4514}let v_3972: bool = (Sess = C) in
                                                (
                                                    {4515}if v_3972 then
                                                    (
                                                        {4516}let pkSess_3973: bitstring = pub(skC) in
                                                        {4517}out(c, GetEndpointRequest);
                                                        {4518}in(c, (SPs_3974: bitstring,=SignAndEncrypt,UP_3975: bitstring,=pkSess_3973));
                                                        {4519}new SPc_3976: bitstring;
                                                        {4520}new Nc_3977: bitstring;
                                                        {4521}let gNc_3978: bitstring = exp(g,Nc_3977) in
                                                        {4522}let m1_3979: bitstring = (Sess,SPc_3976,gNc_3978) in
                                                        {4523}event beginCli(Cli,Sess,gNc_3978);
                                                        {4524}out(c, (pkCli_3723,enc(m1_3979,pkSess_3973),sign(h(m1_3979),skCli_3722)));
                                                        {4525}in(c, (ePartS_3980: bitstring,sigPartS_3981: bitstring));
                                                        {4526}let (=Cli,PartS_3982: bitstring) = dec(ePartS_3980,skCli_3722) in
                                                        {4527}if (verify(h((Cli,PartS_3982)),sigPartS_3981,pkSess_3973) <> true) then
                                                            0
                                                        else
                                                            {4528}event endCli(Sess,Cli,PartS_3982)
                                                    )
                                                    else
                                                        {4529}let pkSess_3983: bitstring = pub(skI) in
                                                        {4530}out(c, GetEndpointRequest);
                                                        {4531}in(c, (SPs_3984: bitstring,=SignAndEncrypt,UP_3985: bitstring,=pkSess_3983));
                                                        {4532}new SPc_3986: bitstring;
                                                        {4533}new Nc_3987: bitstring;
                                                        {4534}let gNc_3988: bitstring = exp(g,Nc_3987) in
                                                        {4535}let m1_3989: bitstring = (Sess,SPc_3986,gNc_3988) in
                                                        {4536}event beginCli(Cli,Sess,gNc_3988);
                                                        {4537}out(c, (pkCli_3723,enc(m1_3989,pkSess_3983),sign(h(m1_3989),skCli_3722)));
                                                        {4538}in(c, (ePartS_3990: bitstring,sigPartS_3991: bitstring));
                                                        {4539}let (=Cli,PartS_3992: bitstring) = dec(ePartS_3990,skCli_3722) in
                                                        {4540}if (verify(h((Cli,PartS_3992)),sigPartS_3991,pkSess_3983) <> true) then
                                                            0
                                                        else
                                                            {4541}event endCli(Sess,Cli,PartS_3992)
                                                )
                                                else
                                                    {4542}let pkSess_3993: bitstring = fail-any in
                                                    {4543}out(c, GetEndpointRequest);
                                                    {4544}in(c, (SPs_3994: bitstring,=SignAndEncrypt,UP_3995: bitstring,=pkSess_3993));
                                                    {4545}new SPc_3996: bitstring;
                                                    {4546}new Nc_3997: bitstring;
                                                    {4547}let gNc_3998: bitstring = exp(g,Nc_3997) in
                                                    {4548}let m1_3999: bitstring = (Sess,SPc_3996,gNc_3998) in
                                                    {4549}event beginCli(Cli,Sess,gNc_3998);
                                                    {4550}out(c, (pkCli_3723,enc(m1_3999,pkSess_3993),sign(h(m1_3999),skCli_3722)));
                                                    {4551}in(c, (ePartS_4000: bitstring,sigPartS_4001: bitstring));
                                                    {4552}let (=Cli,PartS_4002: bitstring) = dec(ePartS_4000,skCli_3722) in
                                                    {4553}if (verify(h((Cli,PartS_4002)),sigPartS_4001,pkSess_3993) <> true) then
                                                        0
                                                    else
                                                        {4554}event endCli(Sess,Cli,PartS_4002)
                                        )
                                        else
                                            {4555}let pkSess_4003: bitstring = fail-any in
                                            {4556}out(c, GetEndpointRequest);
                                            {4557}in(c, (SPs_4004: bitstring,=SignAndEncrypt,UP_4005: bitstring,=pkSess_4003));
                                            {4558}new SPc_4006: bitstring;
                                            {4559}new Nc_4007: bitstring;
                                            {4560}let gNc_4008: bitstring = exp(g,Nc_4007) in
                                            {4561}let m1_4009: bitstring = (Sess,SPc_4006,gNc_4008) in
                                            {4562}event beginCli(Cli,Sess,gNc_4008);
                                            {4563}out(c, (pkCli_3723,enc(m1_4009,pkSess_4003),sign(h(m1_4009),skCli_3722)));
                                            {4564}in(c, (ePartS_4010: bitstring,sigPartS_4011: bitstring));
                                            {4565}let (=Cli,PartS_4012: bitstring) = dec(ePartS_4010,skCli_3722) in
                                            {4566}if (verify(h((Cli,PartS_4012)),sigPartS_4011,pkSess_4003) <> true) then
                                                0
                                            else
                                                {4567}event endCli(Sess,Cli,PartS_4012)
                                )
                                else
                                    {4568}let pkSess_4013: bitstring = fail-any in
                                    {4569}out(c, GetEndpointRequest);
                                    {4570}in(c, (SPs_4014: bitstring,=SignAndEncrypt,UP_4015: bitstring,=pkSess_4013));
                                    {4571}new SPc_4016: bitstring;
                                    {4572}new Nc_4017: bitstring;
                                    {4573}let gNc_4018: bitstring = exp(g,Nc_4017) in
                                    {4574}let m1_4019: bitstring = (Sess,SPc_4016,gNc_4018) in
                                    {4575}event beginCli(Cli,Sess,gNc_4018);
                                    {4576}out(c, (pkCli_3723,enc(m1_4019,pkSess_4013),sign(h(m1_4019),skCli_3722)));
                                    {4577}in(c, (ePartS_4020: bitstring,sigPartS_4021: bitstring));
                                    {4578}let (=Cli,PartS_4022: bitstring) = dec(ePartS_4020,skCli_3722) in
                                    {4579}if (verify(h((Cli,PartS_4022)),sigPartS_4021,pkSess_4013) <> true) then
                                        0
                                    else
                                        {4580}event endCli(Sess,Cli,PartS_4022)
                        )
                        else
                            {4581}let pkDisco_4023: bitstring = fail-any in
                            {4582}let v_4024: bool = (Sess = A) in
                            (
                                {4583}if v_4024 then
                                (
                                    {4584}let pkSess_4025: bitstring = pub(skA) in
                                    {4585}out(c, GetEndpointRequest);
                                    {4586}in(c, (SPs_4026: bitstring,=SignAndEncrypt,UP_4027: bitstring,=pkSess_4025));
                                    {4587}new SPc_4028: bitstring;
                                    {4588}new Nc_4029: bitstring;
                                    {4589}let gNc_4030: bitstring = exp(g,Nc_4029) in
                                    {4590}let m1_4031: bitstring = (Sess,SPc_4028,gNc_4030) in
                                    {4591}event beginCli(Cli,Sess,gNc_4030);
                                    {4592}out(c, (pkCli_3723,enc(m1_4031,pkSess_4025),sign(h(m1_4031),skCli_3722)));
                                    {4593}in(c, (ePartS_4032: bitstring,sigPartS_4033: bitstring));
                                    {4594}let (=Cli,PartS_4034: bitstring) = dec(ePartS_4032,skCli_3722) in
                                    {4595}if (verify(h((Cli,PartS_4034)),sigPartS_4033,pkSess_4025) <> true) then
                                        0
                                    else
                                        {4596}event endCli(Sess,Cli,PartS_4034)
                                )
                                else
                                    {4597}let v_4035: bool = (Sess = B) in
                                    (
                                        {4598}if v_4035 then
                                        (
                                            {4599}let pkSess_4036: bitstring = pub(skB) in
                                            {4600}out(c, GetEndpointRequest);
                                            {4601}in(c, (SPs_4037: bitstring,=SignAndEncrypt,UP_4038: bitstring,=pkSess_4036));
                                            {4602}new SPc_4039: bitstring;
                                            {4603}new Nc_4040: bitstring;
                                            {4604}let gNc_4041: bitstring = exp(g,Nc_4040) in
                                            {4605}let m1_4042: bitstring = (Sess,SPc_4039,gNc_4041) in
                                            {4606}event beginCli(Cli,Sess,gNc_4041);
                                            {4607}out(c, (pkCli_3723,enc(m1_4042,pkSess_4036),sign(h(m1_4042),skCli_3722)));
                                            {4608}in(c, (ePartS_4043: bitstring,sigPartS_4044: bitstring));
                                            {4609}let (=Cli,PartS_4045: bitstring) = dec(ePartS_4043,skCli_3722) in
                                            {4610}if (verify(h((Cli,PartS_4045)),sigPartS_4044,pkSess_4036) <> true) then
                                                0
                                            else
                                                {4611}event endCli(Sess,Cli,PartS_4045)
                                        )
                                        else
                                            {4612}let v_4046: bool = (Sess = C) in
                                            (
                                                {4613}if v_4046 then
                                                (
                                                    {4614}let pkSess_4047: bitstring = pub(skC) in
                                                    {4615}out(c, GetEndpointRequest);
                                                    {4616}in(c, (SPs_4048: bitstring,=SignAndEncrypt,UP_4049: bitstring,=pkSess_4047));
                                                    {4617}new SPc_4050: bitstring;
                                                    {4618}new Nc_4051: bitstring;
                                                    {4619}let gNc_4052: bitstring = exp(g,Nc_4051) in
                                                    {4620}let m1_4053: bitstring = (Sess,SPc_4050,gNc_4052) in
                                                    {4621}event beginCli(Cli,Sess,gNc_4052);
                                                    {4622}out(c, (pkCli_3723,enc(m1_4053,pkSess_4047),sign(h(m1_4053),skCli_3722)));
                                                    {4623}in(c, (ePartS_4054: bitstring,sigPartS_4055: bitstring));
                                                    {4624}let (=Cli,PartS_4056: bitstring) = dec(ePartS_4054,skCli_3722) in
                                                    {4625}if (verify(h((Cli,PartS_4056)),sigPartS_4055,pkSess_4047) <> true) then
                                                        0
                                                    else
                                                        {4626}event endCli(Sess,Cli,PartS_4056)
                                                )
                                                else
                                                    {4627}let pkSess_4057: bitstring = pub(skI) in
                                                    {4628}out(c, GetEndpointRequest);
                                                    {4629}in(c, (SPs_4058: bitstring,=SignAndEncrypt,UP_4059: bitstring,=pkSess_4057));
                                                    {4630}new SPc_4060: bitstring;
                                                    {4631}new Nc_4061: bitstring;
                                                    {4632}let gNc_4062: bitstring = exp(g,Nc_4061) in
                                                    {4633}let m1_4063: bitstring = (Sess,SPc_4060,gNc_4062) in
                                                    {4634}event beginCli(Cli,Sess,gNc_4062);
                                                    {4635}out(c, (pkCli_3723,enc(m1_4063,pkSess_4057),sign(h(m1_4063),skCli_3722)));
                                                    {4636}in(c, (ePartS_4064: bitstring,sigPartS_4065: bitstring));
                                                    {4637}let (=Cli,PartS_4066: bitstring) = dec(ePartS_4064,skCli_3722) in
                                                    {4638}if (verify(h((Cli,PartS_4066)),sigPartS_4065,pkSess_4057) <> true) then
                                                        0
                                                    else
                                                        {4639}event endCli(Sess,Cli,PartS_4066)
                                            )
                                            else
                                                {4640}let pkSess_4067: bitstring = fail-any in
                                                {4641}out(c, GetEndpointRequest);
                                                {4642}in(c, (SPs_4068: bitstring,=SignAndEncrypt,UP_4069: bitstring,=pkSess_4067));
                                                {4643}new SPc_4070: bitstring;
                                                {4644}new Nc_4071: bitstring;
                                                {4645}let gNc_4072: bitstring = exp(g,Nc_4071) in
                                                {4646}let m1_4073: bitstring = (Sess,SPc_4070,gNc_4072) in
                                                {4647}event beginCli(Cli,Sess,gNc_4072);
                                                {4648}out(c, (pkCli_3723,enc(m1_4073,pkSess_4067),sign(h(m1_4073),skCli_3722)));
                                                {4649}in(c, (ePartS_4074: bitstring,sigPartS_4075: bitstring));
                                                {4650}let (=Cli,PartS_4076: bitstring) = dec(ePartS_4074,skCli_3722) in
                                                {4651}if (verify(h((Cli,PartS_4076)),sigPartS_4075,pkSess_4067) <> true) then
                                                    0
                                                else
                                                    {4652}event endCli(Sess,Cli,PartS_4076)
                                    )
                                    else
                                        {4653}let pkSess_4077: bitstring = fail-any in
                                        {4654}out(c, GetEndpointRequest);
                                        {4655}in(c, (SPs_4078: bitstring,=SignAndEncrypt,UP_4079: bitstring,=pkSess_4077));
                                        {4656}new SPc_4080: bitstring;
                                        {4657}new Nc_4081: bitstring;
                                        {4658}let gNc_4082: bitstring = exp(g,Nc_4081) in
                                        {4659}let m1_4083: bitstring = (Sess,SPc_4080,gNc_4082) in
                                        {4660}event beginCli(Cli,Sess,gNc_4082);
                                        {4661}out(c, (pkCli_3723,enc(m1_4083,pkSess_4077),sign(h(m1_4083),skCli_3722)));
                                        {4662}in(c, (ePartS_4084: bitstring,sigPartS_4085: bitstring));
                                        {4663}let (=Cli,PartS_4086: bitstring) = dec(ePartS_4084,skCli_3722) in
                                        {4664}if (verify(h((Cli,PartS_4086)),sigPartS_4085,pkSess_4077) <> true) then
                                            0
                                        else
                                            {4665}event endCli(Sess,Cli,PartS_4086)
                            )
                            else
                                {4666}let pkSess_4087: bitstring = fail-any in
                                {4667}out(c, GetEndpointRequest);
                                {4668}in(c, (SPs_4088: bitstring,=SignAndEncrypt,UP_4089: bitstring,=pkSess_4087));
                                {4669}new SPc_4090: bitstring;
                                {4670}new Nc_4091: bitstring;
                                {4671}let gNc_4092: bitstring = exp(g,Nc_4091) in
                                {4672}let m1_4093: bitstring = (Sess,SPc_4090,gNc_4092) in
                                {4673}event beginCli(Cli,Sess,gNc_4092);
                                {4674}out(c, (pkCli_3723,enc(m1_4093,pkSess_4087),sign(h(m1_4093),skCli_3722)));
                                {4675}in(c, (ePartS_4094: bitstring,sigPartS_4095: bitstring));
                                {4676}let (=Cli,PartS_4096: bitstring) = dec(ePartS_4094,skCli_3722) in
                                {4677}if (verify(h((Cli,PartS_4096)),sigPartS_4095,pkSess_4087) <> true) then
                                    0
                                else
                                    {4678}event endCli(Sess,Cli,PartS_4096)
                )
                else
                    {4679}let pkDisco_4097: bitstring = fail-any in
                    {4680}let v_4098: bool = (Sess = A) in
                    (
                        {4681}if v_4098 then
                        (
                            {4682}let pkSess_4099: bitstring = pub(skA) in
                            {4683}out(c, GetEndpointRequest);
                            {4684}in(c, (SPs_4100: bitstring,=SignAndEncrypt,UP_4101: bitstring,=pkSess_4099));
                            {4685}new SPc_4102: bitstring;
                            {4686}new Nc_4103: bitstring;
                            {4687}let gNc_4104: bitstring = exp(g,Nc_4103) in
                            {4688}let m1_4105: bitstring = (Sess,SPc_4102,gNc_4104) in
                            {4689}event beginCli(Cli,Sess,gNc_4104);
                            {4690}out(c, (pkCli_3723,enc(m1_4105,pkSess_4099),sign(h(m1_4105),skCli_3722)));
                            {4691}in(c, (ePartS_4106: bitstring,sigPartS_4107: bitstring));
                            {4692}let (=Cli,PartS_4108: bitstring) = dec(ePartS_4106,skCli_3722) in
                            {4693}if (verify(h((Cli,PartS_4108)),sigPartS_4107,pkSess_4099) <> true) then
                                0
                            else
                                {4694}event endCli(Sess,Cli,PartS_4108)
                        )
                        else
                            {4695}let v_4109: bool = (Sess = B) in
                            (
                                {4696}if v_4109 then
                                (
                                    {4697}let pkSess_4110: bitstring = pub(skB) in
                                    {4698}out(c, GetEndpointRequest);
                                    {4699}in(c, (SPs_4111: bitstring,=SignAndEncrypt,UP_4112: bitstring,=pkSess_4110));
                                    {4700}new SPc_4113: bitstring;
                                    {4701}new Nc_4114: bitstring;
                                    {4702}let gNc_4115: bitstring = exp(g,Nc_4114) in
                                    {4703}let m1_4116: bitstring = (Sess,SPc_4113,gNc_4115) in
                                    {4704}event beginCli(Cli,Sess,gNc_4115);
                                    {4705}out(c, (pkCli_3723,enc(m1_4116,pkSess_4110),sign(h(m1_4116),skCli_3722)));
                                    {4706}in(c, (ePartS_4117: bitstring,sigPartS_4118: bitstring));
                                    {4707}let (=Cli,PartS_4119: bitstring) = dec(ePartS_4117,skCli_3722) in
                                    {4708}if (verify(h((Cli,PartS_4119)),sigPartS_4118,pkSess_4110) <> true) then
                                        0
                                    else
                                        {4709}event endCli(Sess,Cli,PartS_4119)
                                )
                                else
                                    {4710}let v_4120: bool = (Sess = C) in
                                    (
                                        {4711}if v_4120 then
                                        (
                                            {4712}let pkSess_4121: bitstring = pub(skC) in
                                            {4713}out(c, GetEndpointRequest);
                                            {4714}in(c, (SPs_4122: bitstring,=SignAndEncrypt,UP_4123: bitstring,=pkSess_4121));
                                            {4715}new SPc_4124: bitstring;
                                            {4716}new Nc_4125: bitstring;
                                            {4717}let gNc_4126: bitstring = exp(g,Nc_4125) in
                                            {4718}let m1_4127: bitstring = (Sess,SPc_4124,gNc_4126) in
                                            {4719}event beginCli(Cli,Sess,gNc_4126);
                                            {4720}out(c, (pkCli_3723,enc(m1_4127,pkSess_4121),sign(h(m1_4127),skCli_3722)));
                                            {4721}in(c, (ePartS_4128: bitstring,sigPartS_4129: bitstring));
                                            {4722}let (=Cli,PartS_4130: bitstring) = dec(ePartS_4128,skCli_3722) in
                                            {4723}if (verify(h((Cli,PartS_4130)),sigPartS_4129,pkSess_4121) <> true) then
                                                0
                                            else
                                                {4724}event endCli(Sess,Cli,PartS_4130)
                                        )
                                        else
                                            {4725}let pkSess_4131: bitstring = pub(skI) in
                                            {4726}out(c, GetEndpointRequest);
                                            {4727}in(c, (SPs_4132: bitstring,=SignAndEncrypt,UP_4133: bitstring,=pkSess_4131));
                                            {4728}new SPc_4134: bitstring;
                                            {4729}new Nc_4135: bitstring;
                                            {4730}let gNc_4136: bitstring = exp(g,Nc_4135) in
                                            {4731}let m1_4137: bitstring = (Sess,SPc_4134,gNc_4136) in
                                            {4732}event beginCli(Cli,Sess,gNc_4136);
                                            {4733}out(c, (pkCli_3723,enc(m1_4137,pkSess_4131),sign(h(m1_4137),skCli_3722)));
                                            {4734}in(c, (ePartS_4138: bitstring,sigPartS_4139: bitstring));
                                            {4735}let (=Cli,PartS_4140: bitstring) = dec(ePartS_4138,skCli_3722) in
                                            {4736}if (verify(h((Cli,PartS_4140)),sigPartS_4139,pkSess_4131) <> true) then
                                                0
                                            else
                                                {4737}event endCli(Sess,Cli,PartS_4140)
                                    )
                                    else
                                        {4738}let pkSess_4141: bitstring = fail-any in
                                        {4739}out(c, GetEndpointRequest);
                                        {4740}in(c, (SPs_4142: bitstring,=SignAndEncrypt,UP_4143: bitstring,=pkSess_4141));
                                        {4741}new SPc_4144: bitstring;
                                        {4742}new Nc_4145: bitstring;
                                        {4743}let gNc_4146: bitstring = exp(g,Nc_4145) in
                                        {4744}let m1_4147: bitstring = (Sess,SPc_4144,gNc_4146) in
                                        {4745}event beginCli(Cli,Sess,gNc_4146);
                                        {4746}out(c, (pkCli_3723,enc(m1_4147,pkSess_4141),sign(h(m1_4147),skCli_3722)));
                                        {4747}in(c, (ePartS_4148: bitstring,sigPartS_4149: bitstring));
                                        {4748}let (=Cli,PartS_4150: bitstring) = dec(ePartS_4148,skCli_3722) in
                                        {4749}if (verify(h((Cli,PartS_4150)),sigPartS_4149,pkSess_4141) <> true) then
                                            0
                                        else
                                            {4750}event endCli(Sess,Cli,PartS_4150)
                            )
                            else
                                {4751}let pkSess_4151: bitstring = fail-any in
                                {4752}out(c, GetEndpointRequest);
                                {4753}in(c, (SPs_4152: bitstring,=SignAndEncrypt,UP_4153: bitstring,=pkSess_4151));
                                {4754}new SPc_4154: bitstring;
                                {4755}new Nc_4155: bitstring;
                                {4756}let gNc_4156: bitstring = exp(g,Nc_4155) in
                                {4757}let m1_4157: bitstring = (Sess,SPc_4154,gNc_4156) in
                                {4758}event beginCli(Cli,Sess,gNc_4156);
                                {4759}out(c, (pkCli_3723,enc(m1_4157,pkSess_4151),sign(h(m1_4157),skCli_3722)));
                                {4760}in(c, (ePartS_4158: bitstring,sigPartS_4159: bitstring));
                                {4761}let (=Cli,PartS_4160: bitstring) = dec(ePartS_4158,skCli_3722) in
                                {4762}if (verify(h((Cli,PartS_4160)),sigPartS_4159,pkSess_4151) <> true) then
                                    0
                                else
                                    {4763}event endCli(Sess,Cli,PartS_4160)
                    )
                    else
                        {4764}let pkSess_4161: bitstring = fail-any in
                        {4765}out(c, GetEndpointRequest);
                        {4766}in(c, (SPs_4162: bitstring,=SignAndEncrypt,UP_4163: bitstring,=pkSess_4161));
                        {4767}new SPc_4164: bitstring;
                        {4768}new Nc_4165: bitstring;
                        {4769}let gNc_4166: bitstring = exp(g,Nc_4165) in
                        {4770}let m1_4167: bitstring = (Sess,SPc_4164,gNc_4166) in
                        {4771}event beginCli(Cli,Sess,gNc_4166);
                        {4772}out(c, (pkCli_3723,enc(m1_4167,pkSess_4161),sign(h(m1_4167),skCli_3722)));
                        {4773}in(c, (ePartS_4168: bitstring,sigPartS_4169: bitstring));
                        {4774}let (=Cli,PartS_4170: bitstring) = dec(ePartS_4168,skCli_3722) in
                        {4775}if (verify(h((Cli,PartS_4170)),sigPartS_4169,pkSess_4161) <> true) then
                            0
                        else
                            {4776}event endCli(Sess,Cli,PartS_4170)
        )
        else
            {4777}let pkDisco_4171: bitstring = fail-any in
            {4778}let v_4172: bool = (Sess = A) in
            (
                {4779}if v_4172 then
                (
                    {4780}let pkSess_4173: bitstring = pub(skA) in
                    {4781}out(c, GetEndpointRequest);
                    {4782}in(c, (SPs_4174: bitstring,=SignAndEncrypt,UP_4175: bitstring,=pkSess_4173));
                    {4783}new SPc_4176: bitstring;
                    {4784}new Nc_4177: bitstring;
                    {4785}let gNc_4178: bitstring = exp(g,Nc_4177) in
                    {4786}let m1_4179: bitstring = (Sess,SPc_4176,gNc_4178) in
                    {4787}event beginCli(Cli,Sess,gNc_4178);
                    {4788}out(c, (pkCli_3723,enc(m1_4179,pkSess_4173),sign(h(m1_4179),skCli_3722)));
                    {4789}in(c, (ePartS_4180: bitstring,sigPartS_4181: bitstring));
                    {4790}let (=Cli,PartS_4182: bitstring) = dec(ePartS_4180,skCli_3722) in
                    {4791}if (verify(h((Cli,PartS_4182)),sigPartS_4181,pkSess_4173) <> true) then
                        0
                    else
                        {4792}event endCli(Sess,Cli,PartS_4182)
                )
                else
                    {4793}let v_4183: bool = (Sess = B) in
                    (
                        {4794}if v_4183 then
                        (
                            {4795}let pkSess_4184: bitstring = pub(skB) in
                            {4796}out(c, GetEndpointRequest);
                            {4797}in(c, (SPs_4185: bitstring,=SignAndEncrypt,UP_4186: bitstring,=pkSess_4184));
                            {4798}new SPc_4187: bitstring;
                            {4799}new Nc_4188: bitstring;
                            {4800}let gNc_4189: bitstring = exp(g,Nc_4188) in
                            {4801}let m1_4190: bitstring = (Sess,SPc_4187,gNc_4189) in
                            {4802}event beginCli(Cli,Sess,gNc_4189);
                            {4803}out(c, (pkCli_3723,enc(m1_4190,pkSess_4184),sign(h(m1_4190),skCli_3722)));
                            {4804}in(c, (ePartS_4191: bitstring,sigPartS_4192: bitstring));
                            {4805}let (=Cli,PartS_4193: bitstring) = dec(ePartS_4191,skCli_3722) in
                            {4806}if (verify(h((Cli,PartS_4193)),sigPartS_4192,pkSess_4184) <> true) then
                                0
                            else
                                {4807}event endCli(Sess,Cli,PartS_4193)
                        )
                        else
                            {4808}let v_4194: bool = (Sess = C) in
                            (
                                {4809}if v_4194 then
                                (
                                    {4810}let pkSess_4195: bitstring = pub(skC) in
                                    {4811}out(c, GetEndpointRequest);
                                    {4812}in(c, (SPs_4196: bitstring,=SignAndEncrypt,UP_4197: bitstring,=pkSess_4195));
                                    {4813}new SPc_4198: bitstring;
                                    {4814}new Nc_4199: bitstring;
                                    {4815}let gNc_4200: bitstring = exp(g,Nc_4199) in
                                    {4816}let m1_4201: bitstring = (Sess,SPc_4198,gNc_4200) in
                                    {4817}event beginCli(Cli,Sess,gNc_4200);
                                    {4818}out(c, (pkCli_3723,enc(m1_4201,pkSess_4195),sign(h(m1_4201),skCli_3722)));
                                    {4819}in(c, (ePartS_4202: bitstring,sigPartS_4203: bitstring));
                                    {4820}let (=Cli,PartS_4204: bitstring) = dec(ePartS_4202,skCli_3722) in
                                    {4821}if (verify(h((Cli,PartS_4204)),sigPartS_4203,pkSess_4195) <> true) then
                                        0
                                    else
                                        {4822}event endCli(Sess,Cli,PartS_4204)
                                )
                                else
                                    {4823}let pkSess_4205: bitstring = pub(skI) in
                                    {4824}out(c, GetEndpointRequest);
                                    {4825}in(c, (SPs_4206: bitstring,=SignAndEncrypt,UP_4207: bitstring,=pkSess_4205));
                                    {4826}new SPc_4208: bitstring;
                                    {4827}new Nc_4209: bitstring;
                                    {4828}let gNc_4210: bitstring = exp(g,Nc_4209) in
                                    {4829}let m1_4211: bitstring = (Sess,SPc_4208,gNc_4210) in
                                    {4830}event beginCli(Cli,Sess,gNc_4210);
                                    {4831}out(c, (pkCli_3723,enc(m1_4211,pkSess_4205),sign(h(m1_4211),skCli_3722)));
                                    {4832}in(c, (ePartS_4212: bitstring,sigPartS_4213: bitstring));
                                    {4833}let (=Cli,PartS_4214: bitstring) = dec(ePartS_4212,skCli_3722) in
                                    {4834}if (verify(h((Cli,PartS_4214)),sigPartS_4213,pkSess_4205) <> true) then
                                        0
                                    else
                                        {4835}event endCli(Sess,Cli,PartS_4214)
                            )
                            else
                                {4836}let pkSess_4215: bitstring = fail-any in
                                {4837}out(c, GetEndpointRequest);
                                {4838}in(c, (SPs_4216: bitstring,=SignAndEncrypt,UP_4217: bitstring,=pkSess_4215));
                                {4839}new SPc_4218: bitstring;
                                {4840}new Nc_4219: bitstring;
                                {4841}let gNc_4220: bitstring = exp(g,Nc_4219) in
                                {4842}let m1_4221: bitstring = (Sess,SPc_4218,gNc_4220) in
                                {4843}event beginCli(Cli,Sess,gNc_4220);
                                {4844}out(c, (pkCli_3723,enc(m1_4221,pkSess_4215),sign(h(m1_4221),skCli_3722)));
                                {4845}in(c, (ePartS_4222: bitstring,sigPartS_4223: bitstring));
                                {4846}let (=Cli,PartS_4224: bitstring) = dec(ePartS_4222,skCli_3722) in
                                {4847}if (verify(h((Cli,PartS_4224)),sigPartS_4223,pkSess_4215) <> true) then
                                    0
                                else
                                    {4848}event endCli(Sess,Cli,PartS_4224)
                    )
                    else
                        {4849}let pkSess_4225: bitstring = fail-any in
                        {4850}out(c, GetEndpointRequest);
                        {4851}in(c, (SPs_4226: bitstring,=SignAndEncrypt,UP_4227: bitstring,=pkSess_4225));
                        {4852}new SPc_4228: bitstring;
                        {4853}new Nc_4229: bitstring;
                        {4854}let gNc_4230: bitstring = exp(g,Nc_4229) in
                        {4855}let m1_4231: bitstring = (Sess,SPc_4228,gNc_4230) in
                        {4856}event beginCli(Cli,Sess,gNc_4230);
                        {4857}out(c, (pkCli_3723,enc(m1_4231,pkSess_4225),sign(h(m1_4231),skCli_3722)));
                        {4858}in(c, (ePartS_4232: bitstring,sigPartS_4233: bitstring));
                        {4859}let (=Cli,PartS_4234: bitstring) = dec(ePartS_4232,skCli_3722) in
                        {4860}if (verify(h((Cli,PartS_4234)),sigPartS_4233,pkSess_4225) <> true) then
                            0
                        else
                            {4861}event endCli(Sess,Cli,PartS_4234)
            )
            else
                {4862}let pkSess_4235: bitstring = fail-any in
                {4863}out(c, GetEndpointRequest);
                {4864}in(c, (SPs_4236: bitstring,=SignAndEncrypt,UP_4237: bitstring,=pkSess_4235));
                {4865}new SPc_4238: bitstring;
                {4866}new Nc_4239: bitstring;
                {4867}let gNc_4240: bitstring = exp(g,Nc_4239) in
                {4868}let m1_4241: bitstring = (Sess,SPc_4238,gNc_4240) in
                {4869}event beginCli(Cli,Sess,gNc_4240);
                {4870}out(c, (pkCli_3723,enc(m1_4241,pkSess_4235),sign(h(m1_4241),skCli_3722)));
                {4871}in(c, (ePartS_4242: bitstring,sigPartS_4243: bitstring));
                {4872}let (=Cli,PartS_4244: bitstring) = dec(ePartS_4242,skCli_3722) in
                {4873}if (verify(h((Cli,PartS_4244)),sigPartS_4243,pkSess_4235) <> true) then
                    0
                else
                    {4874}event endCli(Sess,Cli,PartS_4244)
) | (
    {4875}!
    {4876}in(c, (Cli_4245: host,Disco_4246: host,Sess_4247: host));
    {4877}let v_4248: bool = (Disco_4246 = A) in
    (
        {4878}if v_4248 then
        (
            {4879}let skDisco: bitstring = skA in
            {4880}let pkDisco_4249: bitstring = pub(skDisco) in
            {4881}let v_4250: bool = (Cli_4245 = A) in
            (
                {4882}if v_4250 then
                (
                    {4883}let pkCli_4251: bitstring = pub(skA) in
                    {4884}let v_4252: bool = (Sess_4247 = A) in
                    (
                        {4885}if v_4252 then
                        (
                            {4886}let pkSess_4253: bitstring = pub(skA) in
                            {4887}in(c, =GetEndpointRequest);
                            {4888}new SPs_4254: bitstring;
                            {4889}new UP_4255: bitstring;
                            {4890}out(c, (SPs_4254,Sign,UP_4255,pkSess_4253))
                        )
                        else
                            {4891}let v_4256: bool = (Sess_4247 = B) in
                            (
                                {4892}if v_4256 then
                                (
                                    {4893}let pkSess_4257: bitstring = pub(skB) in
                                    {4894}in(c, =GetEndpointRequest);
                                    {4895}new SPs_4258: bitstring;
                                    {4896}new UP_4259: bitstring;
                                    {4897}out(c, (SPs_4258,Sign,UP_4259,pkSess_4257))
                                )
                                else
                                    {4898}let v_4260: bool = (Sess_4247 = C) in
                                    (
                                        {4899}if v_4260 then
                                        (
                                            {4900}let pkSess_4261: bitstring = pub(skC) in
                                            {4901}in(c, =GetEndpointRequest);
                                            {4902}new SPs_4262: bitstring;
                                            {4903}new UP_4263: bitstring;
                                            {4904}out(c, (SPs_4262,Sign,UP_4263,pkSess_4261))
                                        )
                                        else
                                            {4905}let pkSess_4264: bitstring = pub(skI) in
                                            {4906}in(c, =GetEndpointRequest);
                                            {4907}new SPs_4265: bitstring;
                                            {4908}new UP_4266: bitstring;
                                            {4909}out(c, (SPs_4265,Sign,UP_4266,pkSess_4264))
                                    )
                                    else
                                        {4910}let pkSess_4267: bitstring = fail-any in
                                        {4911}in(c, =GetEndpointRequest);
                                        {4912}new SPs_4268: bitstring;
                                        {4913}new UP_4269: bitstring;
                                        {4914}out(c, (SPs_4268,Sign,UP_4269,pkSess_4267))
                            )
                            else
                                {4915}let pkSess_4270: bitstring = fail-any in
                                {4916}in(c, =GetEndpointRequest);
                                {4917}new SPs_4271: bitstring;
                                {4918}new UP_4272: bitstring;
                                {4919}out(c, (SPs_4271,Sign,UP_4272,pkSess_4270))
                    )
                    else
                        {4920}let pkSess_4273: bitstring = fail-any in
                        {4921}in(c, =GetEndpointRequest);
                        {4922}new SPs_4274: bitstring;
                        {4923}new UP_4275: bitstring;
                        {4924}out(c, (SPs_4274,Sign,UP_4275,pkSess_4273))
                )
                else
                    {4925}let v_4276: bool = (Cli_4245 = B) in
                    (
                        {4926}if v_4276 then
                        (
                            {4927}let pkCli_4277: bitstring = pub(skB) in
                            {4928}let v_4278: bool = (Sess_4247 = A) in
                            (
                                {4929}if v_4278 then
                                (
                                    {4930}let pkSess_4279: bitstring = pub(skA) in
                                    {4931}in(c, =GetEndpointRequest);
                                    {4932}new SPs_4280: bitstring;
                                    {4933}new UP_4281: bitstring;
                                    {4934}out(c, (SPs_4280,Sign,UP_4281,pkSess_4279))
                                )
                                else
                                    {4935}let v_4282: bool = (Sess_4247 = B) in
                                    (
                                        {4936}if v_4282 then
                                        (
                                            {4937}let pkSess_4283: bitstring = pub(skB) in
                                            {4938}in(c, =GetEndpointRequest);
                                            {4939}new SPs_4284: bitstring;
                                            {4940}new UP_4285: bitstring;
                                            {4941}out(c, (SPs_4284,Sign,UP_4285,pkSess_4283))
                                        )
                                        else
                                            {4942}let v_4286: bool = (Sess_4247 = C) in
                                            (
                                                {4943}if v_4286 then
                                                (
                                                    {4944}let pkSess_4287: bitstring = pub(skC) in
                                                    {4945}in(c, =GetEndpointRequest);
                                                    {4946}new SPs_4288: bitstring;
                                                    {4947}new UP_4289: bitstring;
                                                    {4948}out(c, (SPs_4288,Sign,UP_4289,pkSess_4287))
                                                )
                                                else
                                                    {4949}let pkSess_4290: bitstring = pub(skI) in
                                                    {4950}in(c, =GetEndpointRequest);
                                                    {4951}new SPs_4291: bitstring;
                                                    {4952}new UP_4292: bitstring;
                                                    {4953}out(c, (SPs_4291,Sign,UP_4292,pkSess_4290))
                                            )
                                            else
                                                {4954}let pkSess_4293: bitstring = fail-any in
                                                {4955}in(c, =GetEndpointRequest);
                                                {4956}new SPs_4294: bitstring;
                                                {4957}new UP_4295: bitstring;
                                                {4958}out(c, (SPs_4294,Sign,UP_4295,pkSess_4293))
                                    )
                                    else
                                        {4959}let pkSess_4296: bitstring = fail-any in
                                        {4960}in(c, =GetEndpointRequest);
                                        {4961}new SPs_4297: bitstring;
                                        {4962}new UP_4298: bitstring;
                                        {4963}out(c, (SPs_4297,Sign,UP_4298,pkSess_4296))
                            )
                            else
                                {4964}let pkSess_4299: bitstring = fail-any in
                                {4965}in(c, =GetEndpointRequest);
                                {4966}new SPs_4300: bitstring;
                                {4967}new UP_4301: bitstring;
                                {4968}out(c, (SPs_4300,Sign,UP_4301,pkSess_4299))
                        )
                        else
                            {4969}let v_4302: bool = (Cli_4245 = C) in
                            (
                                {4970}if v_4302 then
                                (
                                    {4971}let pkCli_4303: bitstring = pub(skC) in
                                    {4972}let v_4304: bool = (Sess_4247 = A) in
                                    (
                                        {4973}if v_4304 then
                                        (
                                            {4974}let pkSess_4305: bitstring = pub(skA) in
                                            {4975}in(c, =GetEndpointRequest);
                                            {4976}new SPs_4306: bitstring;
                                            {4977}new UP_4307: bitstring;
                                            {4978}out(c, (SPs_4306,Sign,UP_4307,pkSess_4305))
                                        )
                                        else
                                            {4979}let v_4308: bool = (Sess_4247 = B) in
                                            (
                                                {4980}if v_4308 then
                                                (
                                                    {4981}let pkSess_4309: bitstring = pub(skB) in
                                                    {4982}in(c, =GetEndpointRequest);
                                                    {4983}new SPs_4310: bitstring;
                                                    {4984}new UP_4311: bitstring;
                                                    {4985}out(c, (SPs_4310,Sign,UP_4311,pkSess_4309))
                                                )
                                                else
                                                    {4986}let v_4312: bool = (Sess_4247 = C) in
                                                    (
                                                        {4987}if v_4312 then
                                                        (
                                                            {4988}let pkSess_4313: bitstring = pub(skC) in
                                                            {4989}in(c, =GetEndpointRequest);
                                                            {4990}new SPs_4314: bitstring;
                                                            {4991}new UP_4315: bitstring;
                                                            {4992}out(c, (SPs_4314,Sign,UP_4315,pkSess_4313))
                                                        )
                                                        else
                                                            {4993}let pkSess_4316: bitstring = pub(skI) in
                                                            {4994}in(c, =GetEndpointRequest);
                                                            {4995}new SPs_4317: bitstring;
                                                            {4996}new UP_4318: bitstring;
                                                            {4997}out(c, (SPs_4317,Sign,UP_4318,pkSess_4316))
                                                    )
                                                    else
                                                        {4998}let pkSess_4319: bitstring = fail-any in
                                                        {4999}in(c, =GetEndpointRequest);
                                                        {5000}new SPs_4320: bitstring;
                                                        {5001}new UP_4321: bitstring;
                                                        {5002}out(c, (SPs_4320,Sign,UP_4321,pkSess_4319))
                                            )
                                            else
                                                {5003}let pkSess_4322: bitstring = fail-any in
                                                {5004}in(c, =GetEndpointRequest);
                                                {5005}new SPs_4323: bitstring;
                                                {5006}new UP_4324: bitstring;
                                                {5007}out(c, (SPs_4323,Sign,UP_4324,pkSess_4322))
                                    )
                                    else
                                        {5008}let pkSess_4325: bitstring = fail-any in
                                        {5009}in(c, =GetEndpointRequest);
                                        {5010}new SPs_4326: bitstring;
                                        {5011}new UP_4327: bitstring;
                                        {5012}out(c, (SPs_4326,Sign,UP_4327,pkSess_4325))
                                )
                                else
                                    {5013}let pkCli_4328: bitstring = pub(skI) in
                                    {5014}let v_4329: bool = (Sess_4247 = A) in
                                    (
                                        {5015}if v_4329 then
                                        (
                                            {5016}let pkSess_4330: bitstring = pub(skA) in
                                            {5017}in(c, =GetEndpointRequest);
                                            {5018}new SPs_4331: bitstring;
                                            {5019}new UP_4332: bitstring;
                                            {5020}out(c, (SPs_4331,Sign,UP_4332,pkSess_4330))
                                        )
                                        else
                                            {5021}let v_4333: bool = (Sess_4247 = B) in
                                            (
                                                {5022}if v_4333 then
                                                (
                                                    {5023}let pkSess_4334: bitstring = pub(skB) in
                                                    {5024}in(c, =GetEndpointRequest);
                                                    {5025}new SPs_4335: bitstring;
                                                    {5026}new UP_4336: bitstring;
                                                    {5027}out(c, (SPs_4335,Sign,UP_4336,pkSess_4334))
                                                )
                                                else
                                                    {5028}let v_4337: bool = (Sess_4247 = C) in
                                                    (
                                                        {5029}if v_4337 then
                                                        (
                                                            {5030}let pkSess_4338: bitstring = pub(skC) in
                                                            {5031}in(c, =GetEndpointRequest);
                                                            {5032}new SPs_4339: bitstring;
                                                            {5033}new UP_4340: bitstring;
                                                            {5034}out(c, (SPs_4339,Sign,UP_4340,pkSess_4338))
                                                        )
                                                        else
                                                            {5035}let pkSess_4341: bitstring = pub(skI) in
                                                            {5036}in(c, =GetEndpointRequest);
                                                            {5037}new SPs_4342: bitstring;
                                                            {5038}new UP_4343: bitstring;
                                                            {5039}out(c, (SPs_4342,Sign,UP_4343,pkSess_4341))
                                                    )
                                                    else
                                                        {5040}let pkSess_4344: bitstring = fail-any in
                                                        {5041}in(c, =GetEndpointRequest);
                                                        {5042}new SPs_4345: bitstring;
                                                        {5043}new UP_4346: bitstring;
                                                        {5044}out(c, (SPs_4345,Sign,UP_4346,pkSess_4344))
                                            )
                                            else
                                                {5045}let pkSess_4347: bitstring = fail-any in
                                                {5046}in(c, =GetEndpointRequest);
                                                {5047}new SPs_4348: bitstring;
                                                {5048}new UP_4349: bitstring;
                                                {5049}out(c, (SPs_4348,Sign,UP_4349,pkSess_4347))
                                    )
                                    else
                                        {5050}let pkSess_4350: bitstring = fail-any in
                                        {5051}in(c, =GetEndpointRequest);
                                        {5052}new SPs_4351: bitstring;
                                        {5053}new UP_4352: bitstring;
                                        {5054}out(c, (SPs_4351,Sign,UP_4352,pkSess_4350))
                            )
                            else
                                {5055}let pkCli_4353: bitstring = fail-any in
                                {5056}let v_4354: bool = (Sess_4247 = A) in
                                (
                                    {5057}if v_4354 then
                                    (
                                        {5058}let pkSess_4355: bitstring = pub(skA) in
                                        {5059}in(c, =GetEndpointRequest);
                                        {5060}new SPs_4356: bitstring;
                                        {5061}new UP_4357: bitstring;
                                        {5062}out(c, (SPs_4356,Sign,UP_4357,pkSess_4355))
                                    )
                                    else
                                        {5063}let v_4358: bool = (Sess_4247 = B) in
                                        (
                                            {5064}if v_4358 then
                                            (
                                                {5065}let pkSess_4359: bitstring = pub(skB) in
                                                {5066}in(c, =GetEndpointRequest);
                                                {5067}new SPs_4360: bitstring;
                                                {5068}new UP_4361: bitstring;
                                                {5069}out(c, (SPs_4360,Sign,UP_4361,pkSess_4359))
                                            )
                                            else
                                                {5070}let v_4362: bool = (Sess_4247 = C) in
                                                (
                                                    {5071}if v_4362 then
                                                    (
                                                        {5072}let pkSess_4363: bitstring = pub(skC) in
                                                        {5073}in(c, =GetEndpointRequest);
                                                        {5074}new SPs_4364: bitstring;
                                                        {5075}new UP_4365: bitstring;
                                                        {5076}out(c, (SPs_4364,Sign,UP_4365,pkSess_4363))
                                                    )
                                                    else
                                                        {5077}let pkSess_4366: bitstring = pub(skI) in
                                                        {5078}in(c, =GetEndpointRequest);
                                                        {5079}new SPs_4367: bitstring;
                                                        {5080}new UP_4368: bitstring;
                                                        {5081}out(c, (SPs_4367,Sign,UP_4368,pkSess_4366))
                                                )
                                                else
                                                    {5082}let pkSess_4369: bitstring = fail-any in
                                                    {5083}in(c, =GetEndpointRequest);
                                                    {5084}new SPs_4370: bitstring;
                                                    {5085}new UP_4371: bitstring;
                                                    {5086}out(c, (SPs_4370,Sign,UP_4371,pkSess_4369))
                                        )
                                        else
                                            {5087}let pkSess_4372: bitstring = fail-any in
                                            {5088}in(c, =GetEndpointRequest);
                                            {5089}new SPs_4373: bitstring;
                                            {5090}new UP_4374: bitstring;
                                            {5091}out(c, (SPs_4373,Sign,UP_4374,pkSess_4372))
                                )
                                else
                                    {5092}let pkSess_4375: bitstring = fail-any in
                                    {5093}in(c, =GetEndpointRequest);
                                    {5094}new SPs_4376: bitstring;
                                    {5095}new UP_4377: bitstring;
                                    {5096}out(c, (SPs_4376,Sign,UP_4377,pkSess_4375))
                    )
                    else
                        {5097}let pkCli_4378: bitstring = fail-any in
                        {5098}let v_4379: bool = (Sess_4247 = A) in
                        (
                            {5099}if v_4379 then
                            (
                                {5100}let pkSess_4380: bitstring = pub(skA) in
                                {5101}in(c, =GetEndpointRequest);
                                {5102}new SPs_4381: bitstring;
                                {5103}new UP_4382: bitstring;
                                {5104}out(c, (SPs_4381,Sign,UP_4382,pkSess_4380))
                            )
                            else
                                {5105}let v_4383: bool = (Sess_4247 = B) in
                                (
                                    {5106}if v_4383 then
                                    (
                                        {5107}let pkSess_4384: bitstring = pub(skB) in
                                        {5108}in(c, =GetEndpointRequest);
                                        {5109}new SPs_4385: bitstring;
                                        {5110}new UP_4386: bitstring;
                                        {5111}out(c, (SPs_4385,Sign,UP_4386,pkSess_4384))
                                    )
                                    else
                                        {5112}let v_4387: bool = (Sess_4247 = C) in
                                        (
                                            {5113}if v_4387 then
                                            (
                                                {5114}let pkSess_4388: bitstring = pub(skC) in
                                                {5115}in(c, =GetEndpointRequest);
                                                {5116}new SPs_4389: bitstring;
                                                {5117}new UP_4390: bitstring;
                                                {5118}out(c, (SPs_4389,Sign,UP_4390,pkSess_4388))
                                            )
                                            else
                                                {5119}let pkSess_4391: bitstring = pub(skI) in
                                                {5120}in(c, =GetEndpointRequest);
                                                {5121}new SPs_4392: bitstring;
                                                {5122}new UP_4393: bitstring;
                                                {5123}out(c, (SPs_4392,Sign,UP_4393,pkSess_4391))
                                        )
                                        else
                                            {5124}let pkSess_4394: bitstring = fail-any in
                                            {5125}in(c, =GetEndpointRequest);
                                            {5126}new SPs_4395: bitstring;
                                            {5127}new UP_4396: bitstring;
                                            {5128}out(c, (SPs_4395,Sign,UP_4396,pkSess_4394))
                                )
                                else
                                    {5129}let pkSess_4397: bitstring = fail-any in
                                    {5130}in(c, =GetEndpointRequest);
                                    {5131}new SPs_4398: bitstring;
                                    {5132}new UP_4399: bitstring;
                                    {5133}out(c, (SPs_4398,Sign,UP_4399,pkSess_4397))
                        )
                        else
                            {5134}let pkSess_4400: bitstring = fail-any in
                            {5135}in(c, =GetEndpointRequest);
                            {5136}new SPs_4401: bitstring;
                            {5137}new UP_4402: bitstring;
                            {5138}out(c, (SPs_4401,Sign,UP_4402,pkSess_4400))
            )
            else
                {5139}let pkCli_4403: bitstring = fail-any in
                {5140}let v_4404: bool = (Sess_4247 = A) in
                (
                    {5141}if v_4404 then
                    (
                        {5142}let pkSess_4405: bitstring = pub(skA) in
                        {5143}in(c, =GetEndpointRequest);
                        {5144}new SPs_4406: bitstring;
                        {5145}new UP_4407: bitstring;
                        {5146}out(c, (SPs_4406,Sign,UP_4407,pkSess_4405))
                    )
                    else
                        {5147}let v_4408: bool = (Sess_4247 = B) in
                        (
                            {5148}if v_4408 then
                            (
                                {5149}let pkSess_4409: bitstring = pub(skB) in
                                {5150}in(c, =GetEndpointRequest);
                                {5151}new SPs_4410: bitstring;
                                {5152}new UP_4411: bitstring;
                                {5153}out(c, (SPs_4410,Sign,UP_4411,pkSess_4409))
                            )
                            else
                                {5154}let v_4412: bool = (Sess_4247 = C) in
                                (
                                    {5155}if v_4412 then
                                    (
                                        {5156}let pkSess_4413: bitstring = pub(skC) in
                                        {5157}in(c, =GetEndpointRequest);
                                        {5158}new SPs_4414: bitstring;
                                        {5159}new UP_4415: bitstring;
                                        {5160}out(c, (SPs_4414,Sign,UP_4415,pkSess_4413))
                                    )
                                    else
                                        {5161}let pkSess_4416: bitstring = pub(skI) in
                                        {5162}in(c, =GetEndpointRequest);
                                        {5163}new SPs_4417: bitstring;
                                        {5164}new UP_4418: bitstring;
                                        {5165}out(c, (SPs_4417,Sign,UP_4418,pkSess_4416))
                                )
                                else
                                    {5166}let pkSess_4419: bitstring = fail-any in
                                    {5167}in(c, =GetEndpointRequest);
                                    {5168}new SPs_4420: bitstring;
                                    {5169}new UP_4421: bitstring;
                                    {5170}out(c, (SPs_4420,Sign,UP_4421,pkSess_4419))
                        )
                        else
                            {5171}let pkSess_4422: bitstring = fail-any in
                            {5172}in(c, =GetEndpointRequest);
                            {5173}new SPs_4423: bitstring;
                            {5174}new UP_4424: bitstring;
                            {5175}out(c, (SPs_4423,Sign,UP_4424,pkSess_4422))
                )
                else
                    {5176}let pkSess_4425: bitstring = fail-any in
                    {5177}in(c, =GetEndpointRequest);
                    {5178}new SPs_4426: bitstring;
                    {5179}new UP_4427: bitstring;
                    {5180}out(c, (SPs_4426,Sign,UP_4427,pkSess_4425))
        )
        else
            {5181}let v_4428: bool = (Disco_4246 = B) in
            (
                {5182}if v_4428 then
                (
                    {5183}let skDisco_4429: bitstring = skB in
                    {5184}let pkDisco_4430: bitstring = pub(skDisco_4429) in
                    {5185}let v_4431: bool = (Cli_4245 = A) in
                    (
                        {5186}if v_4431 then
                        (
                            {5187}let pkCli_4432: bitstring = pub(skA) in
                            {5188}let v_4433: bool = (Sess_4247 = A) in
                            (
                                {5189}if v_4433 then
                                (
                                    {5190}let pkSess_4434: bitstring = pub(skA) in
                                    {5191}in(c, =GetEndpointRequest);
                                    {5192}new SPs_4435: bitstring;
                                    {5193}new UP_4436: bitstring;
                                    {5194}out(c, (SPs_4435,Sign,UP_4436,pkSess_4434))
                                )
                                else
                                    {5195}let v_4437: bool = (Sess_4247 = B) in
                                    (
                                        {5196}if v_4437 then
                                        (
                                            {5197}let pkSess_4438: bitstring = pub(skB) in
                                            {5198}in(c, =GetEndpointRequest);
                                            {5199}new SPs_4439: bitstring;
                                            {5200}new UP_4440: bitstring;
                                            {5201}out(c, (SPs_4439,Sign,UP_4440,pkSess_4438))
                                        )
                                        else
                                            {5202}let v_4441: bool = (Sess_4247 = C) in
                                            (
                                                {5203}if v_4441 then
                                                (
                                                    {5204}let pkSess_4442: bitstring = pub(skC) in
                                                    {5205}in(c, =GetEndpointRequest);
                                                    {5206}new SPs_4443: bitstring;
                                                    {5207}new UP_4444: bitstring;
                                                    {5208}out(c, (SPs_4443,Sign,UP_4444,pkSess_4442))
                                                )
                                                else
                                                    {5209}let pkSess_4445: bitstring = pub(skI) in
                                                    {5210}in(c, =GetEndpointRequest);
                                                    {5211}new SPs_4446: bitstring;
                                                    {5212}new UP_4447: bitstring;
                                                    {5213}out(c, (SPs_4446,Sign,UP_4447,pkSess_4445))
                                            )
                                            else
                                                {5214}let pkSess_4448: bitstring = fail-any in
                                                {5215}in(c, =GetEndpointRequest);
                                                {5216}new SPs_4449: bitstring;
                                                {5217}new UP_4450: bitstring;
                                                {5218}out(c, (SPs_4449,Sign,UP_4450,pkSess_4448))
                                    )
                                    else
                                        {5219}let pkSess_4451: bitstring = fail-any in
                                        {5220}in(c, =GetEndpointRequest);
                                        {5221}new SPs_4452: bitstring;
                                        {5222}new UP_4453: bitstring;
                                        {5223}out(c, (SPs_4452,Sign,UP_4453,pkSess_4451))
                            )
                            else
                                {5224}let pkSess_4454: bitstring = fail-any in
                                {5225}in(c, =GetEndpointRequest);
                                {5226}new SPs_4455: bitstring;
                                {5227}new UP_4456: bitstring;
                                {5228}out(c, (SPs_4455,Sign,UP_4456,pkSess_4454))
                        )
                        else
                            {5229}let v_4457: bool = (Cli_4245 = B) in
                            (
                                {5230}if v_4457 then
                                (
                                    {5231}let pkCli_4458: bitstring = pub(skB) in
                                    {5232}let v_4459: bool = (Sess_4247 = A) in
                                    (
                                        {5233}if v_4459 then
                                        (
                                            {5234}let pkSess_4460: bitstring = pub(skA) in
                                            {5235}in(c, =GetEndpointRequest);
                                            {5236}new SPs_4461: bitstring;
                                            {5237}new UP_4462: bitstring;
                                            {5238}out(c, (SPs_4461,Sign,UP_4462,pkSess_4460))
                                        )
                                        else
                                            {5239}let v_4463: bool = (Sess_4247 = B) in
                                            (
                                                {5240}if v_4463 then
                                                (
                                                    {5241}let pkSess_4464: bitstring = pub(skB) in
                                                    {5242}in(c, =GetEndpointRequest);
                                                    {5243}new SPs_4465: bitstring;
                                                    {5244}new UP_4466: bitstring;
                                                    {5245}out(c, (SPs_4465,Sign,UP_4466,pkSess_4464))
                                                )
                                                else
                                                    {5246}let v_4467: bool = (Sess_4247 = C) in
                                                    (
                                                        {5247}if v_4467 then
                                                        (
                                                            {5248}let pkSess_4468: bitstring = pub(skC) in
                                                            {5249}in(c, =GetEndpointRequest);
                                                            {5250}new SPs_4469: bitstring;
                                                            {5251}new UP_4470: bitstring;
                                                            {5252}out(c, (SPs_4469,Sign,UP_4470,pkSess_4468))
                                                        )
                                                        else
                                                            {5253}let pkSess_4471: bitstring = pub(skI) in
                                                            {5254}in(c, =GetEndpointRequest);
                                                            {5255}new SPs_4472: bitstring;
                                                            {5256}new UP_4473: bitstring;
                                                            {5257}out(c, (SPs_4472,Sign,UP_4473,pkSess_4471))
                                                    )
                                                    else
                                                        {5258}let pkSess_4474: bitstring = fail-any in
                                                        {5259}in(c, =GetEndpointRequest);
                                                        {5260}new SPs_4475: bitstring;
                                                        {5261}new UP_4476: bitstring;
                                                        {5262}out(c, (SPs_4475,Sign,UP_4476,pkSess_4474))
                                            )
                                            else
                                                {5263}let pkSess_4477: bitstring = fail-any in
                                                {5264}in(c, =GetEndpointRequest);
                                                {5265}new SPs_4478: bitstring;
                                                {5266}new UP_4479: bitstring;
                                                {5267}out(c, (SPs_4478,Sign,UP_4479,pkSess_4477))
                                    )
                                    else
                                        {5268}let pkSess_4480: bitstring = fail-any in
                                        {5269}in(c, =GetEndpointRequest);
                                        {5270}new SPs_4481: bitstring;
                                        {5271}new UP_4482: bitstring;
                                        {5272}out(c, (SPs_4481,Sign,UP_4482,pkSess_4480))
                                )
                                else
                                    {5273}let v_4483: bool = (Cli_4245 = C) in
                                    (
                                        {5274}if v_4483 then
                                        (
                                            {5275}let pkCli_4484: bitstring = pub(skC) in
                                            {5276}let v_4485: bool = (Sess_4247 = A) in
                                            (
                                                {5277}if v_4485 then
                                                (
                                                    {5278}let pkSess_4486: bitstring = pub(skA) in
                                                    {5279}in(c, =GetEndpointRequest);
                                                    {5280}new SPs_4487: bitstring;
                                                    {5281}new UP_4488: bitstring;
                                                    {5282}out(c, (SPs_4487,Sign,UP_4488,pkSess_4486))
                                                )
                                                else
                                                    {5283}let v_4489: bool = (Sess_4247 = B) in
                                                    (
                                                        {5284}if v_4489 then
                                                        (
                                                            {5285}let pkSess_4490: bitstring = pub(skB) in
                                                            {5286}in(c, =GetEndpointRequest);
                                                            {5287}new SPs_4491: bitstring;
                                                            {5288}new UP_4492: bitstring;
                                                            {5289}out(c, (SPs_4491,Sign,UP_4492,pkSess_4490))
                                                        )
                                                        else
                                                            {5290}let v_4493: bool = (Sess_4247 = C) in
                                                            (
                                                                {5291}if v_4493 then
                                                                (
                                                                    {5292}let pkSess_4494: bitstring = pub(skC) in
                                                                    {5293}in(c, =GetEndpointRequest);
                                                                    {5294}new SPs_4495: bitstring;
                                                                    {5295}new UP_4496: bitstring;
                                                                    {5296}out(c, (SPs_4495,Sign,UP_4496,pkSess_4494))
                                                                )
                                                                else
                                                                    {5297}let pkSess_4497: bitstring = pub(skI) in
                                                                    {5298}in(c, =GetEndpointRequest);
                                                                    {5299}new SPs_4498: bitstring;
                                                                    {5300}new UP_4499: bitstring;
                                                                    {5301}out(c, (SPs_4498,Sign,UP_4499,pkSess_4497))
                                                            )
                                                            else
                                                                {5302}let pkSess_4500: bitstring = fail-any in
                                                                {5303}in(c, =GetEndpointRequest);
                                                                {5304}new SPs_4501: bitstring;
                                                                {5305}new UP_4502: bitstring;
                                                                {5306}out(c, (SPs_4501,Sign,UP_4502,pkSess_4500))
                                                    )
                                                    else
                                                        {5307}let pkSess_4503: bitstring = fail-any in
                                                        {5308}in(c, =GetEndpointRequest);
                                                        {5309}new SPs_4504: bitstring;
                                                        {5310}new UP_4505: bitstring;
                                                        {5311}out(c, (SPs_4504,Sign,UP_4505,pkSess_4503))
                                            )
                                            else
                                                {5312}let pkSess_4506: bitstring = fail-any in
                                                {5313}in(c, =GetEndpointRequest);
                                                {5314}new SPs_4507: bitstring;
                                                {5315}new UP_4508: bitstring;
                                                {5316}out(c, (SPs_4507,Sign,UP_4508,pkSess_4506))
                                        )
                                        else
                                            {5317}let pkCli_4509: bitstring = pub(skI) in
                                            {5318}let v_4510: bool = (Sess_4247 = A) in
                                            (
                                                {5319}if v_4510 then
                                                (
                                                    {5320}let pkSess_4511: bitstring = pub(skA) in
                                                    {5321}in(c, =GetEndpointRequest);
                                                    {5322}new SPs_4512: bitstring;
                                                    {5323}new UP_4513: bitstring;
                                                    {5324}out(c, (SPs_4512,Sign,UP_4513,pkSess_4511))
                                                )
                                                else
                                                    {5325}let v_4514: bool = (Sess_4247 = B) in
                                                    (
                                                        {5326}if v_4514 then
                                                        (
                                                            {5327}let pkSess_4515: bitstring = pub(skB) in
                                                            {5328}in(c, =GetEndpointRequest);
                                                            {5329}new SPs_4516: bitstring;
                                                            {5330}new UP_4517: bitstring;
                                                            {5331}out(c, (SPs_4516,Sign,UP_4517,pkSess_4515))
                                                        )
                                                        else
                                                            {5332}let v_4518: bool = (Sess_4247 = C) in
                                                            (
                                                                {5333}if v_4518 then
                                                                (
                                                                    {5334}let pkSess_4519: bitstring = pub(skC) in
                                                                    {5335}in(c, =GetEndpointRequest);
                                                                    {5336}new SPs_4520: bitstring;
                                                                    {5337}new UP_4521: bitstring;
                                                                    {5338}out(c, (SPs_4520,Sign,UP_4521,pkSess_4519))
                                                                )
                                                                else
                                                                    {5339}let pkSess_4522: bitstring = pub(skI) in
                                                                    {5340}in(c, =GetEndpointRequest);
                                                                    {5341}new SPs_4523: bitstring;
                                                                    {5342}new UP_4524: bitstring;
                                                                    {5343}out(c, (SPs_4523,Sign,UP_4524,pkSess_4522))
                                                            )
                                                            else
                                                                {5344}let pkSess_4525: bitstring = fail-any in
                                                                {5345}in(c, =GetEndpointRequest);
                                                                {5346}new SPs_4526: bitstring;
                                                                {5347}new UP_4527: bitstring;
                                                                {5348}out(c, (SPs_4526,Sign,UP_4527,pkSess_4525))
                                                    )
                                                    else
                                                        {5349}let pkSess_4528: bitstring = fail-any in
                                                        {5350}in(c, =GetEndpointRequest);
                                                        {5351}new SPs_4529: bitstring;
                                                        {5352}new UP_4530: bitstring;
                                                        {5353}out(c, (SPs_4529,Sign,UP_4530,pkSess_4528))
                                            )
                                            else
                                                {5354}let pkSess_4531: bitstring = fail-any in
                                                {5355}in(c, =GetEndpointRequest);
                                                {5356}new SPs_4532: bitstring;
                                                {5357}new UP_4533: bitstring;
                                                {5358}out(c, (SPs_4532,Sign,UP_4533,pkSess_4531))
                                    )
                                    else
                                        {5359}let pkCli_4534: bitstring = fail-any in
                                        {5360}let v_4535: bool = (Sess_4247 = A) in
                                        (
                                            {5361}if v_4535 then
                                            (
                                                {5362}let pkSess_4536: bitstring = pub(skA) in
                                                {5363}in(c, =GetEndpointRequest);
                                                {5364}new SPs_4537: bitstring;
                                                {5365}new UP_4538: bitstring;
                                                {5366}out(c, (SPs_4537,Sign,UP_4538,pkSess_4536))
                                            )
                                            else
                                                {5367}let v_4539: bool = (Sess_4247 = B) in
                                                (
                                                    {5368}if v_4539 then
                                                    (
                                                        {5369}let pkSess_4540: bitstring = pub(skB) in
                                                        {5370}in(c, =GetEndpointRequest);
                                                        {5371}new SPs_4541: bitstring;
                                                        {5372}new UP_4542: bitstring;
                                                        {5373}out(c, (SPs_4541,Sign,UP_4542,pkSess_4540))
                                                    )
                                                    else
                                                        {5374}let v_4543: bool = (Sess_4247 = C) in
                                                        (
                                                            {5375}if v_4543 then
                                                            (
                                                                {5376}let pkSess_4544: bitstring = pub(skC) in
                                                                {5377}in(c, =GetEndpointRequest);
                                                                {5378}new SPs_4545: bitstring;
                                                                {5379}new UP_4546: bitstring;
                                                                {5380}out(c, (SPs_4545,Sign,UP_4546,pkSess_4544))
                                                            )
                                                            else
                                                                {5381}let pkSess_4547: bitstring = pub(skI) in
                                                                {5382}in(c, =GetEndpointRequest);
                                                                {5383}new SPs_4548: bitstring;
                                                                {5384}new UP_4549: bitstring;
                                                                {5385}out(c, (SPs_4548,Sign,UP_4549,pkSess_4547))
                                                        )
                                                        else
                                                            {5386}let pkSess_4550: bitstring = fail-any in
                                                            {5387}in(c, =GetEndpointRequest);
                                                            {5388}new SPs_4551: bitstring;
                                                            {5389}new UP_4552: bitstring;
                                                            {5390}out(c, (SPs_4551,Sign,UP_4552,pkSess_4550))
                                                )
                                                else
                                                    {5391}let pkSess_4553: bitstring = fail-any in
                                                    {5392}in(c, =GetEndpointRequest);
                                                    {5393}new SPs_4554: bitstring;
                                                    {5394}new UP_4555: bitstring;
                                                    {5395}out(c, (SPs_4554,Sign,UP_4555,pkSess_4553))
                                        )
                                        else
                                            {5396}let pkSess_4556: bitstring = fail-any in
                                            {5397}in(c, =GetEndpointRequest);
                                            {5398}new SPs_4557: bitstring;
                                            {5399}new UP_4558: bitstring;
                                            {5400}out(c, (SPs_4557,Sign,UP_4558,pkSess_4556))
                            )
                            else
                                {5401}let pkCli_4559: bitstring = fail-any in
                                {5402}let v_4560: bool = (Sess_4247 = A) in
                                (
                                    {5403}if v_4560 then
                                    (
                                        {5404}let pkSess_4561: bitstring = pub(skA) in
                                        {5405}in(c, =GetEndpointRequest);
                                        {5406}new SPs_4562: bitstring;
                                        {5407}new UP_4563: bitstring;
                                        {5408}out(c, (SPs_4562,Sign,UP_4563,pkSess_4561))
                                    )
                                    else
                                        {5409}let v_4564: bool = (Sess_4247 = B) in
                                        (
                                            {5410}if v_4564 then
                                            (
                                                {5411}let pkSess_4565: bitstring = pub(skB) in
                                                {5412}in(c, =GetEndpointRequest);
                                                {5413}new SPs_4566: bitstring;
                                                {5414}new UP_4567: bitstring;
                                                {5415}out(c, (SPs_4566,Sign,UP_4567,pkSess_4565))
                                            )
                                            else
                                                {5416}let v_4568: bool = (Sess_4247 = C) in
                                                (
                                                    {5417}if v_4568 then
                                                    (
                                                        {5418}let pkSess_4569: bitstring = pub(skC) in
                                                        {5419}in(c, =GetEndpointRequest);
                                                        {5420}new SPs_4570: bitstring;
                                                        {5421}new UP_4571: bitstring;
                                                        {5422}out(c, (SPs_4570,Sign,UP_4571,pkSess_4569))
                                                    )
                                                    else
                                                        {5423}let pkSess_4572: bitstring = pub(skI) in
                                                        {5424}in(c, =GetEndpointRequest);
                                                        {5425}new SPs_4573: bitstring;
                                                        {5426}new UP_4574: bitstring;
                                                        {5427}out(c, (SPs_4573,Sign,UP_4574,pkSess_4572))
                                                )
                                                else
                                                    {5428}let pkSess_4575: bitstring = fail-any in
                                                    {5429}in(c, =GetEndpointRequest);
                                                    {5430}new SPs_4576: bitstring;
                                                    {5431}new UP_4577: bitstring;
                                                    {5432}out(c, (SPs_4576,Sign,UP_4577,pkSess_4575))
                                        )
                                        else
                                            {5433}let pkSess_4578: bitstring = fail-any in
                                            {5434}in(c, =GetEndpointRequest);
                                            {5435}new SPs_4579: bitstring;
                                            {5436}new UP_4580: bitstring;
                                            {5437}out(c, (SPs_4579,Sign,UP_4580,pkSess_4578))
                                )
                                else
                                    {5438}let pkSess_4581: bitstring = fail-any in
                                    {5439}in(c, =GetEndpointRequest);
                                    {5440}new SPs_4582: bitstring;
                                    {5441}new UP_4583: bitstring;
                                    {5442}out(c, (SPs_4582,Sign,UP_4583,pkSess_4581))
                    )
                    else
                        {5443}let pkCli_4584: bitstring = fail-any in
                        {5444}let v_4585: bool = (Sess_4247 = A) in
                        (
                            {5445}if v_4585 then
                            (
                                {5446}let pkSess_4586: bitstring = pub(skA) in
                                {5447}in(c, =GetEndpointRequest);
                                {5448}new SPs_4587: bitstring;
                                {5449}new UP_4588: bitstring;
                                {5450}out(c, (SPs_4587,Sign,UP_4588,pkSess_4586))
                            )
                            else
                                {5451}let v_4589: bool = (Sess_4247 = B) in
                                (
                                    {5452}if v_4589 then
                                    (
                                        {5453}let pkSess_4590: bitstring = pub(skB) in
                                        {5454}in(c, =GetEndpointRequest);
                                        {5455}new SPs_4591: bitstring;
                                        {5456}new UP_4592: bitstring;
                                        {5457}out(c, (SPs_4591,Sign,UP_4592,pkSess_4590))
                                    )
                                    else
                                        {5458}let v_4593: bool = (Sess_4247 = C) in
                                        (
                                            {5459}if v_4593 then
                                            (
                                                {5460}let pkSess_4594: bitstring = pub(skC) in
                                                {5461}in(c, =GetEndpointRequest);
                                                {5462}new SPs_4595: bitstring;
                                                {5463}new UP_4596: bitstring;
                                                {5464}out(c, (SPs_4595,Sign,UP_4596,pkSess_4594))
                                            )
                                            else
                                                {5465}let pkSess_4597: bitstring = pub(skI) in
                                                {5466}in(c, =GetEndpointRequest);
                                                {5467}new SPs_4598: bitstring;
                                                {5468}new UP_4599: bitstring;
                                                {5469}out(c, (SPs_4598,Sign,UP_4599,pkSess_4597))
                                        )
                                        else
                                            {5470}let pkSess_4600: bitstring = fail-any in
                                            {5471}in(c, =GetEndpointRequest);
                                            {5472}new SPs_4601: bitstring;
                                            {5473}new UP_4602: bitstring;
                                            {5474}out(c, (SPs_4601,Sign,UP_4602,pkSess_4600))
                                )
                                else
                                    {5475}let pkSess_4603: bitstring = fail-any in
                                    {5476}in(c, =GetEndpointRequest);
                                    {5477}new SPs_4604: bitstring;
                                    {5478}new UP_4605: bitstring;
                                    {5479}out(c, (SPs_4604,Sign,UP_4605,pkSess_4603))
                        )
                        else
                            {5480}let pkSess_4606: bitstring = fail-any in
                            {5481}in(c, =GetEndpointRequest);
                            {5482}new SPs_4607: bitstring;
                            {5483}new UP_4608: bitstring;
                            {5484}out(c, (SPs_4607,Sign,UP_4608,pkSess_4606))
                )
                else
                    {5485}let v_4609: bool = (Disco_4246 = C) in
                    (
                        {5486}if v_4609 then
                        (
                            {5487}let skDisco_4610: bitstring = skC in
                            {5488}let pkDisco_4611: bitstring = pub(skDisco_4610) in
                            {5489}let v_4612: bool = (Cli_4245 = A) in
                            (
                                {5490}if v_4612 then
                                (
                                    {5491}let pkCli_4613: bitstring = pub(skA) in
                                    {5492}let v_4614: bool = (Sess_4247 = A) in
                                    (
                                        {5493}if v_4614 then
                                        (
                                            {5494}let pkSess_4615: bitstring = pub(skA) in
                                            {5495}in(c, =GetEndpointRequest);
                                            {5496}new SPs_4616: bitstring;
                                            {5497}new UP_4617: bitstring;
                                            {5498}out(c, (SPs_4616,Sign,UP_4617,pkSess_4615))
                                        )
                                        else
                                            {5499}let v_4618: bool = (Sess_4247 = B) in
                                            (
                                                {5500}if v_4618 then
                                                (
                                                    {5501}let pkSess_4619: bitstring = pub(skB) in
                                                    {5502}in(c, =GetEndpointRequest);
                                                    {5503}new SPs_4620: bitstring;
                                                    {5504}new UP_4621: bitstring;
                                                    {5505}out(c, (SPs_4620,Sign,UP_4621,pkSess_4619))
                                                )
                                                else
                                                    {5506}let v_4622: bool = (Sess_4247 = C) in
                                                    (
                                                        {5507}if v_4622 then
                                                        (
                                                            {5508}let pkSess_4623: bitstring = pub(skC) in
                                                            {5509}in(c, =GetEndpointRequest);
                                                            {5510}new SPs_4624: bitstring;
                                                            {5511}new UP_4625: bitstring;
                                                            {5512}out(c, (SPs_4624,Sign,UP_4625,pkSess_4623))
                                                        )
                                                        else
                                                            {5513}let pkSess_4626: bitstring = pub(skI) in
                                                            {5514}in(c, =GetEndpointRequest);
                                                            {5515}new SPs_4627: bitstring;
                                                            {5516}new UP_4628: bitstring;
                                                            {5517}out(c, (SPs_4627,Sign,UP_4628,pkSess_4626))
                                                    )
                                                    else
                                                        {5518}let pkSess_4629: bitstring = fail-any in
                                                        {5519}in(c, =GetEndpointRequest);
                                                        {5520}new SPs_4630: bitstring;
                                                        {5521}new UP_4631: bitstring;
                                                        {5522}out(c, (SPs_4630,Sign,UP_4631,pkSess_4629))
                                            )
                                            else
                                                {5523}let pkSess_4632: bitstring = fail-any in
                                                {5524}in(c, =GetEndpointRequest);
                                                {5525}new SPs_4633: bitstring;
                                                {5526}new UP_4634: bitstring;
                                                {5527}out(c, (SPs_4633,Sign,UP_4634,pkSess_4632))
                                    )
                                    else
                                        {5528}let pkSess_4635: bitstring = fail-any in
                                        {5529}in(c, =GetEndpointRequest);
                                        {5530}new SPs_4636: bitstring;
                                        {5531}new UP_4637: bitstring;
                                        {5532}out(c, (SPs_4636,Sign,UP_4637,pkSess_4635))
                                )
                                else
                                    {5533}let v_4638: bool = (Cli_4245 = B) in
                                    (
                                        {5534}if v_4638 then
                                        (
                                            {5535}let pkCli_4639: bitstring = pub(skB) in
                                            {5536}let v_4640: bool = (Sess_4247 = A) in
                                            (
                                                {5537}if v_4640 then
                                                (
                                                    {5538}let pkSess_4641: bitstring = pub(skA) in
                                                    {5539}in(c, =GetEndpointRequest);
                                                    {5540}new SPs_4642: bitstring;
                                                    {5541}new UP_4643: bitstring;
                                                    {5542}out(c, (SPs_4642,Sign,UP_4643,pkSess_4641))
                                                )
                                                else
                                                    {5543}let v_4644: bool = (Sess_4247 = B) in
                                                    (
                                                        {5544}if v_4644 then
                                                        (
                                                            {5545}let pkSess_4645: bitstring = pub(skB) in
                                                            {5546}in(c, =GetEndpointRequest);
                                                            {5547}new SPs_4646: bitstring;
                                                            {5548}new UP_4647: bitstring;
                                                            {5549}out(c, (SPs_4646,Sign,UP_4647,pkSess_4645))
                                                        )
                                                        else
                                                            {5550}let v_4648: bool = (Sess_4247 = C) in
                                                            (
                                                                {5551}if v_4648 then
                                                                (
                                                                    {5552}let pkSess_4649: bitstring = pub(skC) in
                                                                    {5553}in(c, =GetEndpointRequest);
                                                                    {5554}new SPs_4650: bitstring;
                                                                    {5555}new UP_4651: bitstring;
                                                                    {5556}out(c, (SPs_4650,Sign,UP_4651,pkSess_4649))
                                                                )
                                                                else
                                                                    {5557}let pkSess_4652: bitstring = pub(skI) in
                                                                    {5558}in(c, =GetEndpointRequest);
                                                                    {5559}new SPs_4653: bitstring;
                                                                    {5560}new UP_4654: bitstring;
                                                                    {5561}out(c, (SPs_4653,Sign,UP_4654,pkSess_4652))
                                                            )
                                                            else
                                                                {5562}let pkSess_4655: bitstring = fail-any in
                                                                {5563}in(c, =GetEndpointRequest);
                                                                {5564}new SPs_4656: bitstring;
                                                                {5565}new UP_4657: bitstring;
                                                                {5566}out(c, (SPs_4656,Sign,UP_4657,pkSess_4655))
                                                    )
                                                    else
                                                        {5567}let pkSess_4658: bitstring = fail-any in
                                                        {5568}in(c, =GetEndpointRequest);
                                                        {5569}new SPs_4659: bitstring;
                                                        {5570}new UP_4660: bitstring;
                                                        {5571}out(c, (SPs_4659,Sign,UP_4660,pkSess_4658))
                                            )
                                            else
                                                {5572}let pkSess_4661: bitstring = fail-any in
                                                {5573}in(c, =GetEndpointRequest);
                                                {5574}new SPs_4662: bitstring;
                                                {5575}new UP_4663: bitstring;
                                                {5576}out(c, (SPs_4662,Sign,UP_4663,pkSess_4661))
                                        )
                                        else
                                            {5577}let v_4664: bool = (Cli_4245 = C) in
                                            (
                                                {5578}if v_4664 then
                                                (
                                                    {5579}let pkCli_4665: bitstring = pub(skC) in
                                                    {5580}let v_4666: bool = (Sess_4247 = A) in
                                                    (
                                                        {5581}if v_4666 then
                                                        (
                                                            {5582}let pkSess_4667: bitstring = pub(skA) in
                                                            {5583}in(c, =GetEndpointRequest);
                                                            {5584}new SPs_4668: bitstring;
                                                            {5585}new UP_4669: bitstring;
                                                            {5586}out(c, (SPs_4668,Sign,UP_4669,pkSess_4667))
                                                        )
                                                        else
                                                            {5587}let v_4670: bool = (Sess_4247 = B) in
                                                            (
                                                                {5588}if v_4670 then
                                                                (
                                                                    {5589}let pkSess_4671: bitstring = pub(skB) in
                                                                    {5590}in(c, =GetEndpointRequest);
                                                                    {5591}new SPs_4672: bitstring;
                                                                    {5592}new UP_4673: bitstring;
                                                                    {5593}out(c, (SPs_4672,Sign,UP_4673,pkSess_4671))
                                                                )
                                                                else
                                                                    {5594}let v_4674: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5595}if v_4674 then
                                                                        (
                                                                            {5596}let pkSess_4675: bitstring = pub(skC) in
                                                                            {5597}in(c, =GetEndpointRequest);
                                                                            {5598}new SPs_4676: bitstring;
                                                                            {5599}new UP_4677: bitstring;
                                                                            {5600}out(c, (SPs_4676,Sign,UP_4677,pkSess_4675))
                                                                        )
                                                                        else
                                                                            {5601}let pkSess_4678: bitstring = pub(skI) in
                                                                            {5602}in(c, =GetEndpointRequest);
                                                                            {5603}new SPs_4679: bitstring;
                                                                            {5604}new UP_4680: bitstring;
                                                                            {5605}out(c, (SPs_4679,Sign,UP_4680,pkSess_4678))
                                                                    )
                                                                    else
                                                                        {5606}let pkSess_4681: bitstring = fail-any in
                                                                        {5607}in(c, =GetEndpointRequest);
                                                                        {5608}new SPs_4682: bitstring;
                                                                        {5609}new UP_4683: bitstring;
                                                                        {5610}out(c, (SPs_4682,Sign,UP_4683,pkSess_4681))
                                                            )
                                                            else
                                                                {5611}let pkSess_4684: bitstring = fail-any in
                                                                {5612}in(c, =GetEndpointRequest);
                                                                {5613}new SPs_4685: bitstring;
                                                                {5614}new UP_4686: bitstring;
                                                                {5615}out(c, (SPs_4685,Sign,UP_4686,pkSess_4684))
                                                    )
                                                    else
                                                        {5616}let pkSess_4687: bitstring = fail-any in
                                                        {5617}in(c, =GetEndpointRequest);
                                                        {5618}new SPs_4688: bitstring;
                                                        {5619}new UP_4689: bitstring;
                                                        {5620}out(c, (SPs_4688,Sign,UP_4689,pkSess_4687))
                                                )
                                                else
                                                    {5621}let pkCli_4690: bitstring = pub(skI) in
                                                    {5622}let v_4691: bool = (Sess_4247 = A) in
                                                    (
                                                        {5623}if v_4691 then
                                                        (
                                                            {5624}let pkSess_4692: bitstring = pub(skA) in
                                                            {5625}in(c, =GetEndpointRequest);
                                                            {5626}new SPs_4693: bitstring;
                                                            {5627}new UP_4694: bitstring;
                                                            {5628}out(c, (SPs_4693,Sign,UP_4694,pkSess_4692))
                                                        )
                                                        else
                                                            {5629}let v_4695: bool = (Sess_4247 = B) in
                                                            (
                                                                {5630}if v_4695 then
                                                                (
                                                                    {5631}let pkSess_4696: bitstring = pub(skB) in
                                                                    {5632}in(c, =GetEndpointRequest);
                                                                    {5633}new SPs_4697: bitstring;
                                                                    {5634}new UP_4698: bitstring;
                                                                    {5635}out(c, (SPs_4697,Sign,UP_4698,pkSess_4696))
                                                                )
                                                                else
                                                                    {5636}let v_4699: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5637}if v_4699 then
                                                                        (
                                                                            {5638}let pkSess_4700: bitstring = pub(skC) in
                                                                            {5639}in(c, =GetEndpointRequest);
                                                                            {5640}new SPs_4701: bitstring;
                                                                            {5641}new UP_4702: bitstring;
                                                                            {5642}out(c, (SPs_4701,Sign,UP_4702,pkSess_4700))
                                                                        )
                                                                        else
                                                                            {5643}let pkSess_4703: bitstring = pub(skI) in
                                                                            {5644}in(c, =GetEndpointRequest);
                                                                            {5645}new SPs_4704: bitstring;
                                                                            {5646}new UP_4705: bitstring;
                                                                            {5647}out(c, (SPs_4704,Sign,UP_4705,pkSess_4703))
                                                                    )
                                                                    else
                                                                        {5648}let pkSess_4706: bitstring = fail-any in
                                                                        {5649}in(c, =GetEndpointRequest);
                                                                        {5650}new SPs_4707: bitstring;
                                                                        {5651}new UP_4708: bitstring;
                                                                        {5652}out(c, (SPs_4707,Sign,UP_4708,pkSess_4706))
                                                            )
                                                            else
                                                                {5653}let pkSess_4709: bitstring = fail-any in
                                                                {5654}in(c, =GetEndpointRequest);
                                                                {5655}new SPs_4710: bitstring;
                                                                {5656}new UP_4711: bitstring;
                                                                {5657}out(c, (SPs_4710,Sign,UP_4711,pkSess_4709))
                                                    )
                                                    else
                                                        {5658}let pkSess_4712: bitstring = fail-any in
                                                        {5659}in(c, =GetEndpointRequest);
                                                        {5660}new SPs_4713: bitstring;
                                                        {5661}new UP_4714: bitstring;
                                                        {5662}out(c, (SPs_4713,Sign,UP_4714,pkSess_4712))
                                            )
                                            else
                                                {5663}let pkCli_4715: bitstring = fail-any in
                                                {5664}let v_4716: bool = (Sess_4247 = A) in
                                                (
                                                    {5665}if v_4716 then
                                                    (
                                                        {5666}let pkSess_4717: bitstring = pub(skA) in
                                                        {5667}in(c, =GetEndpointRequest);
                                                        {5668}new SPs_4718: bitstring;
                                                        {5669}new UP_4719: bitstring;
                                                        {5670}out(c, (SPs_4718,Sign,UP_4719,pkSess_4717))
                                                    )
                                                    else
                                                        {5671}let v_4720: bool = (Sess_4247 = B) in
                                                        (
                                                            {5672}if v_4720 then
                                                            (
                                                                {5673}let pkSess_4721: bitstring = pub(skB) in
                                                                {5674}in(c, =GetEndpointRequest);
                                                                {5675}new SPs_4722: bitstring;
                                                                {5676}new UP_4723: bitstring;
                                                                {5677}out(c, (SPs_4722,Sign,UP_4723,pkSess_4721))
                                                            )
                                                            else
                                                                {5678}let v_4724: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5679}if v_4724 then
                                                                    (
                                                                        {5680}let pkSess_4725: bitstring = pub(skC) in
                                                                        {5681}in(c, =GetEndpointRequest);
                                                                        {5682}new SPs_4726: bitstring;
                                                                        {5683}new UP_4727: bitstring;
                                                                        {5684}out(c, (SPs_4726,Sign,UP_4727,pkSess_4725))
                                                                    )
                                                                    else
                                                                        {5685}let pkSess_4728: bitstring = pub(skI) in
                                                                        {5686}in(c, =GetEndpointRequest);
                                                                        {5687}new SPs_4729: bitstring;
                                                                        {5688}new UP_4730: bitstring;
                                                                        {5689}out(c, (SPs_4729,Sign,UP_4730,pkSess_4728))
                                                                )
                                                                else
                                                                    {5690}let pkSess_4731: bitstring = fail-any in
                                                                    {5691}in(c, =GetEndpointRequest);
                                                                    {5692}new SPs_4732: bitstring;
                                                                    {5693}new UP_4733: bitstring;
                                                                    {5694}out(c, (SPs_4732,Sign,UP_4733,pkSess_4731))
                                                        )
                                                        else
                                                            {5695}let pkSess_4734: bitstring = fail-any in
                                                            {5696}in(c, =GetEndpointRequest);
                                                            {5697}new SPs_4735: bitstring;
                                                            {5698}new UP_4736: bitstring;
                                                            {5699}out(c, (SPs_4735,Sign,UP_4736,pkSess_4734))
                                                )
                                                else
                                                    {5700}let pkSess_4737: bitstring = fail-any in
                                                    {5701}in(c, =GetEndpointRequest);
                                                    {5702}new SPs_4738: bitstring;
                                                    {5703}new UP_4739: bitstring;
                                                    {5704}out(c, (SPs_4738,Sign,UP_4739,pkSess_4737))
                                    )
                                    else
                                        {5705}let pkCli_4740: bitstring = fail-any in
                                        {5706}let v_4741: bool = (Sess_4247 = A) in
                                        (
                                            {5707}if v_4741 then
                                            (
                                                {5708}let pkSess_4742: bitstring = pub(skA) in
                                                {5709}in(c, =GetEndpointRequest);
                                                {5710}new SPs_4743: bitstring;
                                                {5711}new UP_4744: bitstring;
                                                {5712}out(c, (SPs_4743,Sign,UP_4744,pkSess_4742))
                                            )
                                            else
                                                {5713}let v_4745: bool = (Sess_4247 = B) in
                                                (
                                                    {5714}if v_4745 then
                                                    (
                                                        {5715}let pkSess_4746: bitstring = pub(skB) in
                                                        {5716}in(c, =GetEndpointRequest);
                                                        {5717}new SPs_4747: bitstring;
                                                        {5718}new UP_4748: bitstring;
                                                        {5719}out(c, (SPs_4747,Sign,UP_4748,pkSess_4746))
                                                    )
                                                    else
                                                        {5720}let v_4749: bool = (Sess_4247 = C) in
                                                        (
                                                            {5721}if v_4749 then
                                                            (
                                                                {5722}let pkSess_4750: bitstring = pub(skC) in
                                                                {5723}in(c, =GetEndpointRequest);
                                                                {5724}new SPs_4751: bitstring;
                                                                {5725}new UP_4752: bitstring;
                                                                {5726}out(c, (SPs_4751,Sign,UP_4752,pkSess_4750))
                                                            )
                                                            else
                                                                {5727}let pkSess_4753: bitstring = pub(skI) in
                                                                {5728}in(c, =GetEndpointRequest);
                                                                {5729}new SPs_4754: bitstring;
                                                                {5730}new UP_4755: bitstring;
                                                                {5731}out(c, (SPs_4754,Sign,UP_4755,pkSess_4753))
                                                        )
                                                        else
                                                            {5732}let pkSess_4756: bitstring = fail-any in
                                                            {5733}in(c, =GetEndpointRequest);
                                                            {5734}new SPs_4757: bitstring;
                                                            {5735}new UP_4758: bitstring;
                                                            {5736}out(c, (SPs_4757,Sign,UP_4758,pkSess_4756))
                                                )
                                                else
                                                    {5737}let pkSess_4759: bitstring = fail-any in
                                                    {5738}in(c, =GetEndpointRequest);
                                                    {5739}new SPs_4760: bitstring;
                                                    {5740}new UP_4761: bitstring;
                                                    {5741}out(c, (SPs_4760,Sign,UP_4761,pkSess_4759))
                                        )
                                        else
                                            {5742}let pkSess_4762: bitstring = fail-any in
                                            {5743}in(c, =GetEndpointRequest);
                                            {5744}new SPs_4763: bitstring;
                                            {5745}new UP_4764: bitstring;
                                            {5746}out(c, (SPs_4763,Sign,UP_4764,pkSess_4762))
                            )
                            else
                                {5747}let pkCli_4765: bitstring = fail-any in
                                {5748}let v_4766: bool = (Sess_4247 = A) in
                                (
                                    {5749}if v_4766 then
                                    (
                                        {5750}let pkSess_4767: bitstring = pub(skA) in
                                        {5751}in(c, =GetEndpointRequest);
                                        {5752}new SPs_4768: bitstring;
                                        {5753}new UP_4769: bitstring;
                                        {5754}out(c, (SPs_4768,Sign,UP_4769,pkSess_4767))
                                    )
                                    else
                                        {5755}let v_4770: bool = (Sess_4247 = B) in
                                        (
                                            {5756}if v_4770 then
                                            (
                                                {5757}let pkSess_4771: bitstring = pub(skB) in
                                                {5758}in(c, =GetEndpointRequest);
                                                {5759}new SPs_4772: bitstring;
                                                {5760}new UP_4773: bitstring;
                                                {5761}out(c, (SPs_4772,Sign,UP_4773,pkSess_4771))
                                            )
                                            else
                                                {5762}let v_4774: bool = (Sess_4247 = C) in
                                                (
                                                    {5763}if v_4774 then
                                                    (
                                                        {5764}let pkSess_4775: bitstring = pub(skC) in
                                                        {5765}in(c, =GetEndpointRequest);
                                                        {5766}new SPs_4776: bitstring;
                                                        {5767}new UP_4777: bitstring;
                                                        {5768}out(c, (SPs_4776,Sign,UP_4777,pkSess_4775))
                                                    )
                                                    else
                                                        {5769}let pkSess_4778: bitstring = pub(skI) in
                                                        {5770}in(c, =GetEndpointRequest);
                                                        {5771}new SPs_4779: bitstring;
                                                        {5772}new UP_4780: bitstring;
                                                        {5773}out(c, (SPs_4779,Sign,UP_4780,pkSess_4778))
                                                )
                                                else
                                                    {5774}let pkSess_4781: bitstring = fail-any in
                                                    {5775}in(c, =GetEndpointRequest);
                                                    {5776}new SPs_4782: bitstring;
                                                    {5777}new UP_4783: bitstring;
                                                    {5778}out(c, (SPs_4782,Sign,UP_4783,pkSess_4781))
                                        )
                                        else
                                            {5779}let pkSess_4784: bitstring = fail-any in
                                            {5780}in(c, =GetEndpointRequest);
                                            {5781}new SPs_4785: bitstring;
                                            {5782}new UP_4786: bitstring;
                                            {5783}out(c, (SPs_4785,Sign,UP_4786,pkSess_4784))
                                )
                                else
                                    {5784}let pkSess_4787: bitstring = fail-any in
                                    {5785}in(c, =GetEndpointRequest);
                                    {5786}new SPs_4788: bitstring;
                                    {5787}new UP_4789: bitstring;
                                    {5788}out(c, (SPs_4788,Sign,UP_4789,pkSess_4787))
                        )
                        else
                            {5789}let skDisco_4790: bitstring = skI in
                            {5790}let pkDisco_4791: bitstring = pub(skDisco_4790) in
                            {5791}let v_4792: bool = (Cli_4245 = A) in
                            (
                                {5792}if v_4792 then
                                (
                                    {5793}let pkCli_4793: bitstring = pub(skA) in
                                    {5794}let v_4794: bool = (Sess_4247 = A) in
                                    (
                                        {5795}if v_4794 then
                                        (
                                            {5796}let pkSess_4795: bitstring = pub(skA) in
                                            {5797}in(c, =GetEndpointRequest);
                                            {5798}new SPs_4796: bitstring;
                                            {5799}new UP_4797: bitstring;
                                            {5800}out(c, (SPs_4796,Sign,UP_4797,pkSess_4795))
                                        )
                                        else
                                            {5801}let v_4798: bool = (Sess_4247 = B) in
                                            (
                                                {5802}if v_4798 then
                                                (
                                                    {5803}let pkSess_4799: bitstring = pub(skB) in
                                                    {5804}in(c, =GetEndpointRequest);
                                                    {5805}new SPs_4800: bitstring;
                                                    {5806}new UP_4801: bitstring;
                                                    {5807}out(c, (SPs_4800,Sign,UP_4801,pkSess_4799))
                                                )
                                                else
                                                    {5808}let v_4802: bool = (Sess_4247 = C) in
                                                    (
                                                        {5809}if v_4802 then
                                                        (
                                                            {5810}let pkSess_4803: bitstring = pub(skC) in
                                                            {5811}in(c, =GetEndpointRequest);
                                                            {5812}new SPs_4804: bitstring;
                                                            {5813}new UP_4805: bitstring;
                                                            {5814}out(c, (SPs_4804,Sign,UP_4805,pkSess_4803))
                                                        )
                                                        else
                                                            {5815}let pkSess_4806: bitstring = pub(skI) in
                                                            {5816}in(c, =GetEndpointRequest);
                                                            {5817}new SPs_4807: bitstring;
                                                            {5818}new UP_4808: bitstring;
                                                            {5819}out(c, (SPs_4807,Sign,UP_4808,pkSess_4806))
                                                    )
                                                    else
                                                        {5820}let pkSess_4809: bitstring = fail-any in
                                                        {5821}in(c, =GetEndpointRequest);
                                                        {5822}new SPs_4810: bitstring;
                                                        {5823}new UP_4811: bitstring;
                                                        {5824}out(c, (SPs_4810,Sign,UP_4811,pkSess_4809))
                                            )
                                            else
                                                {5825}let pkSess_4812: bitstring = fail-any in
                                                {5826}in(c, =GetEndpointRequest);
                                                {5827}new SPs_4813: bitstring;
                                                {5828}new UP_4814: bitstring;
                                                {5829}out(c, (SPs_4813,Sign,UP_4814,pkSess_4812))
                                    )
                                    else
                                        {5830}let pkSess_4815: bitstring = fail-any in
                                        {5831}in(c, =GetEndpointRequest);
                                        {5832}new SPs_4816: bitstring;
                                        {5833}new UP_4817: bitstring;
                                        {5834}out(c, (SPs_4816,Sign,UP_4817,pkSess_4815))
                                )
                                else
                                    {5835}let v_4818: bool = (Cli_4245 = B) in
                                    (
                                        {5836}if v_4818 then
                                        (
                                            {5837}let pkCli_4819: bitstring = pub(skB) in
                                            {5838}let v_4820: bool = (Sess_4247 = A) in
                                            (
                                                {5839}if v_4820 then
                                                (
                                                    {5840}let pkSess_4821: bitstring = pub(skA) in
                                                    {5841}in(c, =GetEndpointRequest);
                                                    {5842}new SPs_4822: bitstring;
                                                    {5843}new UP_4823: bitstring;
                                                    {5844}out(c, (SPs_4822,Sign,UP_4823,pkSess_4821))
                                                )
                                                else
                                                    {5845}let v_4824: bool = (Sess_4247 = B) in
                                                    (
                                                        {5846}if v_4824 then
                                                        (
                                                            {5847}let pkSess_4825: bitstring = pub(skB) in
                                                            {5848}in(c, =GetEndpointRequest);
                                                            {5849}new SPs_4826: bitstring;
                                                            {5850}new UP_4827: bitstring;
                                                            {5851}out(c, (SPs_4826,Sign,UP_4827,pkSess_4825))
                                                        )
                                                        else
                                                            {5852}let v_4828: bool = (Sess_4247 = C) in
                                                            (
                                                                {5853}if v_4828 then
                                                                (
                                                                    {5854}let pkSess_4829: bitstring = pub(skC) in
                                                                    {5855}in(c, =GetEndpointRequest);
                                                                    {5856}new SPs_4830: bitstring;
                                                                    {5857}new UP_4831: bitstring;
                                                                    {5858}out(c, (SPs_4830,Sign,UP_4831,pkSess_4829))
                                                                )
                                                                else
                                                                    {5859}let pkSess_4832: bitstring = pub(skI) in
                                                                    {5860}in(c, =GetEndpointRequest);
                                                                    {5861}new SPs_4833: bitstring;
                                                                    {5862}new UP_4834: bitstring;
                                                                    {5863}out(c, (SPs_4833,Sign,UP_4834,pkSess_4832))
                                                            )
                                                            else
                                                                {5864}let pkSess_4835: bitstring = fail-any in
                                                                {5865}in(c, =GetEndpointRequest);
                                                                {5866}new SPs_4836: bitstring;
                                                                {5867}new UP_4837: bitstring;
                                                                {5868}out(c, (SPs_4836,Sign,UP_4837,pkSess_4835))
                                                    )
                                                    else
                                                        {5869}let pkSess_4838: bitstring = fail-any in
                                                        {5870}in(c, =GetEndpointRequest);
                                                        {5871}new SPs_4839: bitstring;
                                                        {5872}new UP_4840: bitstring;
                                                        {5873}out(c, (SPs_4839,Sign,UP_4840,pkSess_4838))
                                            )
                                            else
                                                {5874}let pkSess_4841: bitstring = fail-any in
                                                {5875}in(c, =GetEndpointRequest);
                                                {5876}new SPs_4842: bitstring;
                                                {5877}new UP_4843: bitstring;
                                                {5878}out(c, (SPs_4842,Sign,UP_4843,pkSess_4841))
                                        )
                                        else
                                            {5879}let v_4844: bool = (Cli_4245 = C) in
                                            (
                                                {5880}if v_4844 then
                                                (
                                                    {5881}let pkCli_4845: bitstring = pub(skC) in
                                                    {5882}let v_4846: bool = (Sess_4247 = A) in
                                                    (
                                                        {5883}if v_4846 then
                                                        (
                                                            {5884}let pkSess_4847: bitstring = pub(skA) in
                                                            {5885}in(c, =GetEndpointRequest);
                                                            {5886}new SPs_4848: bitstring;
                                                            {5887}new UP_4849: bitstring;
                                                            {5888}out(c, (SPs_4848,Sign,UP_4849,pkSess_4847))
                                                        )
                                                        else
                                                            {5889}let v_4850: bool = (Sess_4247 = B) in
                                                            (
                                                                {5890}if v_4850 then
                                                                (
                                                                    {5891}let pkSess_4851: bitstring = pub(skB) in
                                                                    {5892}in(c, =GetEndpointRequest);
                                                                    {5893}new SPs_4852: bitstring;
                                                                    {5894}new UP_4853: bitstring;
                                                                    {5895}out(c, (SPs_4852,Sign,UP_4853,pkSess_4851))
                                                                )
                                                                else
                                                                    {5896}let v_4854: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5897}if v_4854 then
                                                                        (
                                                                            {5898}let pkSess_4855: bitstring = pub(skC) in
                                                                            {5899}in(c, =GetEndpointRequest);
                                                                            {5900}new SPs_4856: bitstring;
                                                                            {5901}new UP_4857: bitstring;
                                                                            {5902}out(c, (SPs_4856,Sign,UP_4857,pkSess_4855))
                                                                        )
                                                                        else
                                                                            {5903}let pkSess_4858: bitstring = pub(skI) in
                                                                            {5904}in(c, =GetEndpointRequest);
                                                                            {5905}new SPs_4859: bitstring;
                                                                            {5906}new UP_4860: bitstring;
                                                                            {5907}out(c, (SPs_4859,Sign,UP_4860,pkSess_4858))
                                                                    )
                                                                    else
                                                                        {5908}let pkSess_4861: bitstring = fail-any in
                                                                        {5909}in(c, =GetEndpointRequest);
                                                                        {5910}new SPs_4862: bitstring;
                                                                        {5911}new UP_4863: bitstring;
                                                                        {5912}out(c, (SPs_4862,Sign,UP_4863,pkSess_4861))
                                                            )
                                                            else
                                                                {5913}let pkSess_4864: bitstring = fail-any in
                                                                {5914}in(c, =GetEndpointRequest);
                                                                {5915}new SPs_4865: bitstring;
                                                                {5916}new UP_4866: bitstring;
                                                                {5917}out(c, (SPs_4865,Sign,UP_4866,pkSess_4864))
                                                    )
                                                    else
                                                        {5918}let pkSess_4867: bitstring = fail-any in
                                                        {5919}in(c, =GetEndpointRequest);
                                                        {5920}new SPs_4868: bitstring;
                                                        {5921}new UP_4869: bitstring;
                                                        {5922}out(c, (SPs_4868,Sign,UP_4869,pkSess_4867))
                                                )
                                                else
                                                    {5923}let pkCli_4870: bitstring = pub(skI) in
                                                    {5924}let v_4871: bool = (Sess_4247 = A) in
                                                    (
                                                        {5925}if v_4871 then
                                                        (
                                                            {5926}let pkSess_4872: bitstring = pub(skA) in
                                                            {5927}in(c, =GetEndpointRequest);
                                                            {5928}new SPs_4873: bitstring;
                                                            {5929}new UP_4874: bitstring;
                                                            {5930}out(c, (SPs_4873,Sign,UP_4874,pkSess_4872))
                                                        )
                                                        else
                                                            {5931}let v_4875: bool = (Sess_4247 = B) in
                                                            (
                                                                {5932}if v_4875 then
                                                                (
                                                                    {5933}let pkSess_4876: bitstring = pub(skB) in
                                                                    {5934}in(c, =GetEndpointRequest);
                                                                    {5935}new SPs_4877: bitstring;
                                                                    {5936}new UP_4878: bitstring;
                                                                    {5937}out(c, (SPs_4877,Sign,UP_4878,pkSess_4876))
                                                                )
                                                                else
                                                                    {5938}let v_4879: bool = (Sess_4247 = C) in
                                                                    (
                                                                        {5939}if v_4879 then
                                                                        (
                                                                            {5940}let pkSess_4880: bitstring = pub(skC) in
                                                                            {5941}in(c, =GetEndpointRequest);
                                                                            {5942}new SPs_4881: bitstring;
                                                                            {5943}new UP_4882: bitstring;
                                                                            {5944}out(c, (SPs_4881,Sign,UP_4882,pkSess_4880))
                                                                        )
                                                                        else
                                                                            {5945}let pkSess_4883: bitstring = pub(skI) in
                                                                            {5946}in(c, =GetEndpointRequest);
                                                                            {5947}new SPs_4884: bitstring;
                                                                            {5948}new UP_4885: bitstring;
                                                                            {5949}out(c, (SPs_4884,Sign,UP_4885,pkSess_4883))
                                                                    )
                                                                    else
                                                                        {5950}let pkSess_4886: bitstring = fail-any in
                                                                        {5951}in(c, =GetEndpointRequest);
                                                                        {5952}new SPs_4887: bitstring;
                                                                        {5953}new UP_4888: bitstring;
                                                                        {5954}out(c, (SPs_4887,Sign,UP_4888,pkSess_4886))
                                                            )
                                                            else
                                                                {5955}let pkSess_4889: bitstring = fail-any in
                                                                {5956}in(c, =GetEndpointRequest);
                                                                {5957}new SPs_4890: bitstring;
                                                                {5958}new UP_4891: bitstring;
                                                                {5959}out(c, (SPs_4890,Sign,UP_4891,pkSess_4889))
                                                    )
                                                    else
                                                        {5960}let pkSess_4892: bitstring = fail-any in
                                                        {5961}in(c, =GetEndpointRequest);
                                                        {5962}new SPs_4893: bitstring;
                                                        {5963}new UP_4894: bitstring;
                                                        {5964}out(c, (SPs_4893,Sign,UP_4894,pkSess_4892))
                                            )
                                            else
                                                {5965}let pkCli_4895: bitstring = fail-any in
                                                {5966}let v_4896: bool = (Sess_4247 = A) in
                                                (
                                                    {5967}if v_4896 then
                                                    (
                                                        {5968}let pkSess_4897: bitstring = pub(skA) in
                                                        {5969}in(c, =GetEndpointRequest);
                                                        {5970}new SPs_4898: bitstring;
                                                        {5971}new UP_4899: bitstring;
                                                        {5972}out(c, (SPs_4898,Sign,UP_4899,pkSess_4897))
                                                    )
                                                    else
                                                        {5973}let v_4900: bool = (Sess_4247 = B) in
                                                        (
                                                            {5974}if v_4900 then
                                                            (
                                                                {5975}let pkSess_4901: bitstring = pub(skB) in
                                                                {5976}in(c, =GetEndpointRequest);
                                                                {5977}new SPs_4902: bitstring;
                                                                {5978}new UP_4903: bitstring;
                                                                {5979}out(c, (SPs_4902,Sign,UP_4903,pkSess_4901))
                                                            )
                                                            else
                                                                {5980}let v_4904: bool = (Sess_4247 = C) in
                                                                (
                                                                    {5981}if v_4904 then
                                                                    (
                                                                        {5982}let pkSess_4905: bitstring = pub(skC) in
                                                                        {5983}in(c, =GetEndpointRequest);
                                                                        {5984}new SPs_4906: bitstring;
                                                                        {5985}new UP_4907: bitstring;
                                                                        {5986}out(c, (SPs_4906,Sign,UP_4907,pkSess_4905))
                                                                    )
                                                                    else
                                                                        {5987}let pkSess_4908: bitstring = pub(skI) in
                                                                        {5988}in(c, =GetEndpointRequest);
                                                                        {5989}new SPs_4909: bitstring;
                                                                        {5990}new UP_4910: bitstring;
                                                                        {5991}out(c, (SPs_4909,Sign,UP_4910,pkSess_4908))
                                                                )
                                                                else
                                                                    {5992}let pkSess_4911: bitstring = fail-any in
                                                                    {5993}in(c, =GetEndpointRequest);
                                                                    {5994}new SPs_4912: bitstring;
                                                                    {5995}new UP_4913: bitstring;
                                                                    {5996}out(c, (SPs_4912,Sign,UP_4913,pkSess_4911))
                                                        )
                                                        else
                                                            {5997}let pkSess_4914: bitstring = fail-any in
                                                            {5998}in(c, =GetEndpointRequest);
                                                            {5999}new SPs_4915: bitstring;
                                                            {6000}new UP_4916: bitstring;
                                                            {6001}out(c, (SPs_4915,Sign,UP_4916,pkSess_4914))
                                                )
                                                else
                                                    {6002}let pkSess_4917: bitstring = fail-any in
                                                    {6003}in(c, =GetEndpointRequest);
                                                    {6004}new SPs_4918: bitstring;
                                                    {6005}new UP_4919: bitstring;
                                                    {6006}out(c, (SPs_4918,Sign,UP_4919,pkSess_4917))
                                    )
                                    else
                                        {6007}let pkCli_4920: bitstring = fail-any in
                                        {6008}let v_4921: bool = (Sess_4247 = A) in
                                        (
                                            {6009}if v_4921 then
                                            (
                                                {6010}let pkSess_4922: bitstring = pub(skA) in
                                                {6011}in(c, =GetEndpointRequest);
                                                {6012}new SPs_4923: bitstring;
                                                {6013}new UP_4924: bitstring;
                                                {6014}out(c, (SPs_4923,Sign,UP_4924,pkSess_4922))
                                            )
                                            else
                                                {6015}let v_4925: bool = (Sess_4247 = B) in
                                                (
                                                    {6016}if v_4925 then
                                                    (
                                                        {6017}let pkSess_4926: bitstring = pub(skB) in
                                                        {6018}in(c, =GetEndpointRequest);
                                                        {6019}new SPs_4927: bitstring;
                                                        {6020}new UP_4928: bitstring;
                                                        {6021}out(c, (SPs_4927,Sign,UP_4928,pkSess_4926))
                                                    )
                                                    else
                                                        {6022}let v_4929: bool = (Sess_4247 = C) in
                                                        (
                                                            {6023}if v_4929 then
                                                            (
                                                                {6024}let pkSess_4930: bitstring = pub(skC) in
                                                                {6025}in(c, =GetEndpointRequest);
                                                                {6026}new SPs_4931: bitstring;
                                                                {6027}new UP_4932: bitstring;
                                                                {6028}out(c, (SPs_4931,Sign,UP_4932,pkSess_4930))
                                                            )
                                                            else
                                                                {6029}let pkSess_4933: bitstring = pub(skI) in
                                                                {6030}in(c, =GetEndpointRequest);
                                                                {6031}new SPs_4934: bitstring;
                                                                {6032}new UP_4935: bitstring;
                                                                {6033}out(c, (SPs_4934,Sign,UP_4935,pkSess_4933))
                                                        )
                                                        else
                                                            {6034}let pkSess_4936: bitstring = fail-any in
                                                            {6035}in(c, =GetEndpointRequest);
                                                            {6036}new SPs_4937: bitstring;
                                                            {6037}new UP_4938: bitstring;
                                                            {6038}out(c, (SPs_4937,Sign,UP_4938,pkSess_4936))
                                                )
                                                else
                                                    {6039}let pkSess_4939: bitstring = fail-any in
                                                    {6040}in(c, =GetEndpointRequest);
                                                    {6041}new SPs_4940: bitstring;
                                                    {6042}new UP_4941: bitstring;
                                                    {6043}out(c, (SPs_4940,Sign,UP_4941,pkSess_4939))
                                        )
                                        else
                                            {6044}let pkSess_4942: bitstring = fail-any in
                                            {6045}in(c, =GetEndpointRequest);
                                            {6046}new SPs_4943: bitstring;
                                            {6047}new UP_4944: bitstring;
                                            {6048}out(c, (SPs_4943,Sign,UP_4944,pkSess_4942))
                            )
                            else
                                {6049}let pkCli_4945: bitstring = fail-any in
                                {6050}let v_4946: bool = (Sess_4247 = A) in
                                (
                                    {6051}if v_4946 then
                                    (
                                        {6052}let pkSess_4947: bitstring = pub(skA) in
                                        {6053}in(c, =GetEndpointRequest);
                                        {6054}new SPs_4948: bitstring;
                                        {6055}new UP_4949: bitstring;
                                        {6056}out(c, (SPs_4948,Sign,UP_4949,pkSess_4947))
                                    )
                                    else
                                        {6057}let v_4950: bool = (Sess_4247 = B) in
                                        (
                                            {6058}if v_4950 then
                                            (
                                                {6059}let pkSess_4951: bitstring = pub(skB) in
                                                {6060}in(c, =GetEndpointRequest);
                                                {6061}new SPs_4952: bitstring;
                                                {6062}new UP_4953: bitstring;
                                                {6063}out(c, (SPs_4952,Sign,UP_4953,pkSess_4951))
                                            )
                                            else
                                                {6064}let v_4954: bool = (Sess_4247 = C) in
                                                (
                                                    {6065}if v_4954 then
                                                    (
                                                        {6066}let pkSess_4955: bitstring = pub(skC) in
                                                        {6067}in(c, =GetEndpointRequest);
                                                        {6068}new SPs_4956: bitstring;
                                                        {6069}new UP_4957: bitstring;
                                                        {6070}out(c, (SPs_4956,Sign,UP_4957,pkSess_4955))
                                                    )
                                                    else
                                                        {6071}let pkSess_4958: bitstring = pub(skI) in
                                                        {6072}in(c, =GetEndpointRequest);
                                                        {6073}new SPs_4959: bitstring;
                                                        {6074}new UP_4960: bitstring;
                                                        {6075}out(c, (SPs_4959,Sign,UP_4960,pkSess_4958))
                                                )
                                                else
                                                    {6076}let pkSess_4961: bitstring = fail-any in
                                                    {6077}in(c, =GetEndpointRequest);
                                                    {6078}new SPs_4962: bitstring;
                                                    {6079}new UP_4963: bitstring;
                                                    {6080}out(c, (SPs_4962,Sign,UP_4963,pkSess_4961))
                                        )
                                        else
                                            {6081}let pkSess_4964: bitstring = fail-any in
                                            {6082}in(c, =GetEndpointRequest);
                                            {6083}new SPs_4965: bitstring;
                                            {6084}new UP_4966: bitstring;
                                            {6085}out(c, (SPs_4965,Sign,UP_4966,pkSess_4964))
                                )
                                else
                                    {6086}let pkSess_4967: bitstring = fail-any in
                                    {6087}in(c, =GetEndpointRequest);
                                    {6088}new SPs_4968: bitstring;
                                    {6089}new UP_4969: bitstring;
                                    {6090}out(c, (SPs_4968,Sign,UP_4969,pkSess_4967))
                    )
                    else
                        {6091}let skDisco_4970: bitstring = fail-any in
                        {6092}let pkDisco_4971: bitstring = pub(skDisco_4970) in
                        {6093}let v_4972: bool = (Cli_4245 = A) in
                        (
                            {6094}if v_4972 then
                            (
                                {6095}let pkCli_4973: bitstring = pub(skA) in
                                {6096}let v_4974: bool = (Sess_4247 = A) in
                                (
                                    {6097}if v_4974 then
                                    (
                                        {6098}let pkSess_4975: bitstring = pub(skA) in
                                        {6099}in(c, =GetEndpointRequest);
                                        {6100}new SPs_4976: bitstring;
                                        {6101}new UP_4977: bitstring;
                                        {6102}out(c, (SPs_4976,Sign,UP_4977,pkSess_4975))
                                    )
                                    else
                                        {6103}let v_4978: bool = (Sess_4247 = B) in
                                        (
                                            {6104}if v_4978 then
                                            (
                                                {6105}let pkSess_4979: bitstring = pub(skB) in
                                                {6106}in(c, =GetEndpointRequest);
                                                {6107}new SPs_4980: bitstring;
                                                {6108}new UP_4981: bitstring;
                                                {6109}out(c, (SPs_4980,Sign,UP_4981,pkSess_4979))
                                            )
                                            else
                                                {6110}let v_4982: bool = (Sess_4247 = C) in
                                                (
                                                    {6111}if v_4982 then
                                                    (
                                                        {6112}let pkSess_4983: bitstring = pub(skC) in
                                                        {6113}in(c, =GetEndpointRequest);
                                                        {6114}new SPs_4984: bitstring;
                                                        {6115}new UP_4985: bitstring;
                                                        {6116}out(c, (SPs_4984,Sign,UP_4985,pkSess_4983))
                                                    )
                                                    else
                                                        {6117}let pkSess_4986: bitstring = pub(skI) in
                                                        {6118}in(c, =GetEndpointRequest);
                                                        {6119}new SPs_4987: bitstring;
                                                        {6120}new UP_4988: bitstring;
                                                        {6121}out(c, (SPs_4987,Sign,UP_4988,pkSess_4986))
                                                )
                                                else
                                                    {6122}let pkSess_4989: bitstring = fail-any in
                                                    {6123}in(c, =GetEndpointRequest);
                                                    {6124}new SPs_4990: bitstring;
                                                    {6125}new UP_4991: bitstring;
                                                    {6126}out(c, (SPs_4990,Sign,UP_4991,pkSess_4989))
                                        )
                                        else
                                            {6127}let pkSess_4992: bitstring = fail-any in
                                            {6128}in(c, =GetEndpointRequest);
                                            {6129}new SPs_4993: bitstring;
                                            {6130}new UP_4994: bitstring;
                                            {6131}out(c, (SPs_4993,Sign,UP_4994,pkSess_4992))
                                )
                                else
                                    {6132}let pkSess_4995: bitstring = fail-any in
                                    {6133}in(c, =GetEndpointRequest);
                                    {6134}new SPs_4996: bitstring;
                                    {6135}new UP_4997: bitstring;
                                    {6136}out(c, (SPs_4996,Sign,UP_4997,pkSess_4995))
                            )
                            else
                                {6137}let v_4998: bool = (Cli_4245 = B) in
                                (
                                    {6138}if v_4998 then
                                    (
                                        {6139}let pkCli_4999: bitstring = pub(skB) in
                                        {6140}let v_5000: bool = (Sess_4247 = A) in
                                        (
                                            {6141}if v_5000 then
                                            (
                                                {6142}let pkSess_5001: bitstring = pub(skA) in
                                                {6143}in(c, =GetEndpointRequest);
                                                {6144}new SPs_5002: bitstring;
                                                {6145}new UP_5003: bitstring;
                                                {6146}out(c, (SPs_5002,Sign,UP_5003,pkSess_5001))
                                            )
                                            else
                                                {6147}let v_5004: bool = (Sess_4247 = B) in
                                                (
                                                    {6148}if v_5004 then
                                                    (
                                                        {6149}let pkSess_5005: bitstring = pub(skB) in
                                                        {6150}in(c, =GetEndpointRequest);
                                                        {6151}new SPs_5006: bitstring;
                                                        {6152}new UP_5007: bitstring;
                                                        {6153}out(c, (SPs_5006,Sign,UP_5007,pkSess_5005))
                                                    )
                                                    else
                                                        {6154}let v_5008: bool = (Sess_4247 = C) in
                                                        (
                                                            {6155}if v_5008 then
                                                            (
                                                                {6156}let pkSess_5009: bitstring = pub(skC) in
                                                                {6157}in(c, =GetEndpointRequest);
                                                                {6158}new SPs_5010: bitstring;
                                                                {6159}new UP_5011: bitstring;
                                                                {6160}out(c, (SPs_5010,Sign,UP_5011,pkSess_5009))
                                                            )
                                                            else
                                                                {6161}let pkSess_5012: bitstring = pub(skI) in
                                                                {6162}in(c, =GetEndpointRequest);
                                                                {6163}new SPs_5013: bitstring;
                                                                {6164}new UP_5014: bitstring;
                                                                {6165}out(c, (SPs_5013,Sign,UP_5014,pkSess_5012))
                                                        )
                                                        else
                                                            {6166}let pkSess_5015: bitstring = fail-any in
                                                            {6167}in(c, =GetEndpointRequest);
                                                            {6168}new SPs_5016: bitstring;
                                                            {6169}new UP_5017: bitstring;
                                                            {6170}out(c, (SPs_5016,Sign,UP_5017,pkSess_5015))
                                                )
                                                else
                                                    {6171}let pkSess_5018: bitstring = fail-any in
                                                    {6172}in(c, =GetEndpointRequest);
                                                    {6173}new SPs_5019: bitstring;
                                                    {6174}new UP_5020: bitstring;
                                                    {6175}out(c, (SPs_5019,Sign,UP_5020,pkSess_5018))
                                        )
                                        else
                                            {6176}let pkSess_5021: bitstring = fail-any in
                                            {6177}in(c, =GetEndpointRequest);
                                            {6178}new SPs_5022: bitstring;
                                            {6179}new UP_5023: bitstring;
                                            {6180}out(c, (SPs_5022,Sign,UP_5023,pkSess_5021))
                                    )
                                    else
                                        {6181}let v_5024: bool = (Cli_4245 = C) in
                                        (
                                            {6182}if v_5024 then
                                            (
                                                {6183}let pkCli_5025: bitstring = pub(skC) in
                                                {6184}let v_5026: bool = (Sess_4247 = A) in
                                                (
                                                    {6185}if v_5026 then
                                                    (
                                                        {6186}let pkSess_5027: bitstring = pub(skA) in
                                                        {6187}in(c, =GetEndpointRequest);
                                                        {6188}new SPs_5028: bitstring;
                                                        {6189}new UP_5029: bitstring;
                                                        {6190}out(c, (SPs_5028,Sign,UP_5029,pkSess_5027))
                                                    )
                                                    else
                                                        {6191}let v_5030: bool = (Sess_4247 = B) in
                                                        (
                                                            {6192}if v_5030 then
                                                            (
                                                                {6193}let pkSess_5031: bitstring = pub(skB) in
                                                                {6194}in(c, =GetEndpointRequest);
                                                                {6195}new SPs_5032: bitstring;
                                                                {6196}new UP_5033: bitstring;
                                                                {6197}out(c, (SPs_5032,Sign,UP_5033,pkSess_5031))
                                                            )
                                                            else
                                                                {6198}let v_5034: bool = (Sess_4247 = C) in
                                                                (
                                                                    {6199}if v_5034 then
                                                                    (
                                                                        {6200}let pkSess_5035: bitstring = pub(skC) in
                                                                        {6201}in(c, =GetEndpointRequest);
                                                                        {6202}new SPs_5036: bitstring;
                                                                        {6203}new UP_5037: bitstring;
                                                                        {6204}out(c, (SPs_5036,Sign,UP_5037,pkSess_5035))
                                                                    )
                                                                    else
                                                                        {6205}let pkSess_5038: bitstring = pub(skI) in
                                                                        {6206}in(c, =GetEndpointRequest);
                                                                        {6207}new SPs_5039: bitstring;
                                                                        {6208}new UP_5040: bitstring;
                                                                        {6209}out(c, (SPs_5039,Sign,UP_5040,pkSess_5038))
                                                                )
                                                                else
                                                                    {6210}let pkSess_5041: bitstring = fail-any in
                                                                    {6211}in(c, =GetEndpointRequest);
                                                                    {6212}new SPs_5042: bitstring;
                                                                    {6213}new UP_5043: bitstring;
                                                                    {6214}out(c, (SPs_5042,Sign,UP_5043,pkSess_5041))
                                                        )
                                                        else
                                                            {6215}let pkSess_5044: bitstring = fail-any in
                                                            {6216}in(c, =GetEndpointRequest);
                                                            {6217}new SPs_5045: bitstring;
                                                            {6218}new UP_5046: bitstring;
                                                            {6219}out(c, (SPs_5045,Sign,UP_5046,pkSess_5044))
                                                )
                                                else
                                                    {6220}let pkSess_5047: bitstring = fail-any in
                                                    {6221}in(c, =GetEndpointRequest);
                                                    {6222}new SPs_5048: bitstring;
                                                    {6223}new UP_5049: bitstring;
                                                    {6224}out(c, (SPs_5048,Sign,UP_5049,pkSess_5047))
                                            )
                                            else
                                                {6225}let pkCli_5050: bitstring = pub(skI) in
                                                {6226}let v_5051: bool = (Sess_4247 = A) in
                                                (
                                                    {6227}if v_5051 then
                                                    (
                                                        {6228}let pkSess_5052: bitstring = pub(skA) in
                                                        {6229}in(c, =GetEndpointRequest);
                                                        {6230}new SPs_5053: bitstring;
                                                        {6231}new UP_5054: bitstring;
                                                        {6232}out(c, (SPs_5053,Sign,UP_5054,pkSess_5052))
                                                    )
                                                    else
                                                        {6233}let v_5055: bool = (Sess_4247 = B) in
                                                        (
                                                            {6234}if v_5055 then
                                                            (
                                                                {6235}let pkSess_5056: bitstring = pub(skB) in
                                                                {6236}in(c, =GetEndpointRequest);
                                                                {6237}new SPs_5057: bitstring;
                                                                {6238}new UP_5058: bitstring;
                                                                {6239}out(c, (SPs_5057,Sign,UP_5058,pkSess_5056))
                                                            )
                                                            else
                                                                {6240}let v_5059: bool = (Sess_4247 = C) in
                                                                (
                                                                    {6241}if v_5059 then
                                                                    (
                                                                        {6242}let pkSess_5060: bitstring = pub(skC) in
                                                                        {6243}in(c, =GetEndpointRequest);
                                                                        {6244}new SPs_5061: bitstring;
                                                                        {6245}new UP_5062: bitstring;
                                                                        {6246}out(c, (SPs_5061,Sign,UP_5062,pkSess_5060))
                                                                    )
                                                                    else
                                                                        {6247}let pkSess_5063: bitstring = pub(skI) in
                                                                        {6248}in(c, =GetEndpointRequest);
                                                                        {6249}new SPs_5064: bitstring;
                                                                        {6250}new UP_5065: bitstring;
                                                                        {6251}out(c, (SPs_5064,Sign,UP_5065,pkSess_5063))
                                                                )
                                                                else
                                                                    {6252}let pkSess_5066: bitstring = fail-any in
                                                                    {6253}in(c, =GetEndpointRequest);
                                                                    {6254}new SPs_5067: bitstring;
                                                                    {6255}new UP_5068: bitstring;
                                                                    {6256}out(c, (SPs_5067,Sign,UP_5068,pkSess_5066))
                                                        )
                                                        else
                                                            {6257}let pkSess_5069: bitstring = fail-any in
                                                            {6258}in(c, =GetEndpointRequest);
                                                            {6259}new SPs_5070: bitstring;
                                                            {6260}new UP_5071: bitstring;
                                                            {6261}out(c, (SPs_5070,Sign,UP_5071,pkSess_5069))
                                                )
                                                else
                                                    {6262}let pkSess_5072: bitstring = fail-any in
                                                    {6263}in(c, =GetEndpointRequest);
                                                    {6264}new SPs_5073: bitstring;
                                                    {6265}new UP_5074: bitstring;
                                                    {6266}out(c, (SPs_5073,Sign,UP_5074,pkSess_5072))
                                        )
                                        else
                                            {6267}let pkCli_5075: bitstring = fail-any in
                                            {6268}let v_5076: bool = (Sess_4247 = A) in
                                            (
                                                {6269}if v_5076 then
                                                (
                                                    {6270}let pkSess_5077: bitstring = pub(skA) in
                                                    {6271}in(c, =GetEndpointRequest);
                                                    {6272}new SPs_5078: bitstring;
                                                    {6273}new UP_5079: bitstring;
                                                    {6274}out(c, (SPs_5078,Sign,UP_5079,pkSess_5077))
                                                )
                                                else
                                                    {6275}let v_5080: bool = (Sess_4247 = B) in
                                                    (
                                                        {6276}if v_5080 then
                                                        (
                                                            {6277}let pkSess_5081: bitstring = pub(skB) in
                                                            {6278}in(c, =GetEndpointRequest);
                                                            {6279}new SPs_5082: bitstring;
                                                            {6280}new UP_5083: bitstring;
                                                            {6281}out(c, (SPs_5082,Sign,UP_5083,pkSess_5081))
                                                        )
                                                        else
                                                            {6282}let v_5084: bool = (Sess_4247 = C) in
                                                            (
                                                                {6283}if v_5084 then
                                                                (
                                                                    {6284}let pkSess_5085: bitstring = pub(skC) in
                                                                    {6285}in(c, =GetEndpointRequest);
                                                                    {6286}new SPs_5086: bitstring;
                                                                    {6287}new UP_5087: bitstring;
                                                                    {6288}out(c, (SPs_5086,Sign,UP_5087,pkSess_5085))
                                                                )
                                                                else
                                                                    {6289}let pkSess_5088: bitstring = pub(skI) in
                                                                    {6290}in(c, =GetEndpointRequest);
                                                                    {6291}new SPs_5089: bitstring;
                                                                    {6292}new UP_5090: bitstring;
                                                                    {6293}out(c, (SPs_5089,Sign,UP_5090,pkSess_5088))
                                                            )
                                                            else
                                                                {6294}let pkSess_5091: bitstring = fail-any in
                                                                {6295}in(c, =GetEndpointRequest);
                                                                {6296}new SPs_5092: bitstring;
                                                                {6297}new UP_5093: bitstring;
                                                                {6298}out(c, (SPs_5092,Sign,UP_5093,pkSess_5091))
                                                    )
                                                    else
                                                        {6299}let pkSess_5094: bitstring = fail-any in
                                                        {6300}in(c, =GetEndpointRequest);
                                                        {6301}new SPs_5095: bitstring;
                                                        {6302}new UP_5096: bitstring;
                                                        {6303}out(c, (SPs_5095,Sign,UP_5096,pkSess_5094))
                                            )
                                            else
                                                {6304}let pkSess_5097: bitstring = fail-any in
                                                {6305}in(c, =GetEndpointRequest);
                                                {6306}new SPs_5098: bitstring;
                                                {6307}new UP_5099: bitstring;
                                                {6308}out(c, (SPs_5098,Sign,UP_5099,pkSess_5097))
                                )
                                else
                                    {6309}let pkCli_5100: bitstring = fail-any in
                                    {6310}let v_5101: bool = (Sess_4247 = A) in
                                    (
                                        {6311}if v_5101 then
                                        (
                                            {6312}let pkSess_5102: bitstring = pub(skA) in
                                            {6313}in(c, =GetEndpointRequest);
                                            {6314}new SPs_5103: bitstring;
                                            {6315}new UP_5104: bitstring;
                                            {6316}out(c, (SPs_5103,Sign,UP_5104,pkSess_5102))
                                        )
                                        else
                                            {6317}let v_5105: bool = (Sess_4247 = B) in
                                            (
                                                {6318}if v_5105 then
                                                (
                                                    {6319}let pkSess_5106: bitstring = pub(skB) in
                                                    {6320}in(c, =GetEndpointRequest);
                                                    {6321}new SPs_5107: bitstring;
                                                    {6322}new UP_5108: bitstring;
                                                    {6323}out(c, (SPs_5107,Sign,UP_5108,pkSess_5106))
                                                )
                                                else
                                                    {6324}let v_5109: bool = (Sess_4247 = C) in
                                                    (
                                                        {6325}if v_5109 then
                                                        (
                                                            {6326}let pkSess_5110: bitstring = pub(skC) in
                                                            {6327}in(c, =GetEndpointRequest);
                                                            {6328}new SPs_5111: bitstring;
                                                            {6329}new UP_5112: bitstring;
                                                            {6330}out(c, (SPs_5111,Sign,UP_5112,pkSess_5110))
                                                        )
                                                        else
                                                            {6331}let pkSess_5113: bitstring = pub(skI) in
                                                            {6332}in(c, =GetEndpointRequest);
                                                            {6333}new SPs_5114: bitstring;
                                                            {6334}new UP_5115: bitstring;
                                                            {6335}out(c, (SPs_5114,Sign,UP_5115,pkSess_5113))
                                                    )
                                                    else
                                                        {6336}let pkSess_5116: bitstring = fail-any in
                                                        {6337}in(c, =GetEndpointRequest);
                                                        {6338}new SPs_5117: bitstring;
                                                        {6339}new UP_5118: bitstring;
                                                        {6340}out(c, (SPs_5117,Sign,UP_5118,pkSess_5116))
                                            )
                                            else
                                                {6341}let pkSess_5119: bitstring = fail-any in
                                                {6342}in(c, =GetEndpointRequest);
                                                {6343}new SPs_5120: bitstring;
                                                {6344}new UP_5121: bitstring;
                                                {6345}out(c, (SPs_5120,Sign,UP_5121,pkSess_5119))
                                    )
                                    else
                                        {6346}let pkSess_5122: bitstring = fail-any in
                                        {6347}in(c, =GetEndpointRequest);
                                        {6348}new SPs_5123: bitstring;
                                        {6349}new UP_5124: bitstring;
                                        {6350}out(c, (SPs_5123,Sign,UP_5124,pkSess_5122))
                        )
                        else
                            {6351}let pkCli_5125: bitstring = fail-any in
                            {6352}let v_5126: bool = (Sess_4247 = A) in
                            (
                                {6353}if v_5126 then
                                (
                                    {6354}let pkSess_5127: bitstring = pub(skA) in
                                    {6355}in(c, =GetEndpointRequest);
                                    {6356}new SPs_5128: bitstring;
                                    {6357}new UP_5129: bitstring;
                                    {6358}out(c, (SPs_5128,Sign,UP_5129,pkSess_5127))
                                )
                                else
                                    {6359}let v_5130: bool = (Sess_4247 = B) in
                                    (
                                        {6360}if v_5130 then
                                        (
                                            {6361}let pkSess_5131: bitstring = pub(skB) in
                                            {6362}in(c, =GetEndpointRequest);
                                            {6363}new SPs_5132: bitstring;
                                            {6364}new UP_5133: bitstring;
                                            {6365}out(c, (SPs_5132,Sign,UP_5133,pkSess_5131))
                                        )
                                        else
                                            {6366}let v_5134: bool = (Sess_4247 = C) in
                                            (
                                                {6367}if v_5134 then
                                                (
                                                    {6368}let pkSess_5135: bitstring = pub(skC) in
                                                    {6369}in(c, =GetEndpointRequest);
                                                    {6370}new SPs_5136: bitstring;
                                                    {6371}new UP_5137: bitstring;
                                                    {6372}out(c, (SPs_5136,Sign,UP_5137,pkSess_5135))
                                                )
                                                else
                                                    {6373}let pkSess_5138: bitstring = pub(skI) in
                                                    {6374}in(c, =GetEndpointRequest);
                                                    {6375}new SPs_5139: bitstring;
                                                    {6376}new UP_5140: bitstring;
                                                    {6377}out(c, (SPs_5139,Sign,UP_5140,pkSess_5138))
                                            )
                                            else
                                                {6378}let pkSess_5141: bitstring = fail-any in
                                                {6379}in(c, =GetEndpointRequest);
                                                {6380}new SPs_5142: bitstring;
                                                {6381}new UP_5143: bitstring;
                                                {6382}out(c, (SPs_5142,Sign,UP_5143,pkSess_5141))
                                    )
                                    else
                                        {6383}let pkSess_5144: bitstring = fail-any in
                                        {6384}in(c, =GetEndpointRequest);
                                        {6385}new SPs_5145: bitstring;
                                        {6386}new UP_5146: bitstring;
                                        {6387}out(c, (SPs_5145,Sign,UP_5146,pkSess_5144))
                            )
                            else
                                {6388}let pkSess_5147: bitstring = fail-any in
                                {6389}in(c, =GetEndpointRequest);
                                {6390}new SPs_5148: bitstring;
                                {6391}new UP_5149: bitstring;
                                {6392}out(c, (SPs_5148,Sign,UP_5149,pkSess_5147))
            )
            else
                {6393}let skDisco_5150: bitstring = fail-any in
                {6394}let pkDisco_5151: bitstring = pub(skDisco_5150) in
                {6395}let v_5152: bool = (Cli_4245 = A) in
                (
                    {6396}if v_5152 then
                    (
                        {6397}let pkCli_5153: bitstring = pub(skA) in
                        {6398}let v_5154: bool = (Sess_4247 = A) in
                        (
                            {6399}if v_5154 then
                            (
                                {6400}let pkSess_5155: bitstring = pub(skA) in
                                {6401}in(c, =GetEndpointRequest);
                                {6402}new SPs_5156: bitstring;
                                {6403}new UP_5157: bitstring;
                                {6404}out(c, (SPs_5156,Sign,UP_5157,pkSess_5155))
                            )
                            else
                                {6405}let v_5158: bool = (Sess_4247 = B) in
                                (
                                    {6406}if v_5158 then
                                    (
                                        {6407}let pkSess_5159: bitstring = pub(skB) in
                                        {6408}in(c, =GetEndpointRequest);
                                        {6409}new SPs_5160: bitstring;
                                        {6410}new UP_5161: bitstring;
                                        {6411}out(c, (SPs_5160,Sign,UP_5161,pkSess_5159))
                                    )
                                    else
                                        {6412}let v_5162: bool = (Sess_4247 = C) in
                                        (
                                            {6413}if v_5162 then
                                            (
                                                {6414}let pkSess_5163: bitstring = pub(skC) in
                                                {6415}in(c, =GetEndpointRequest);
                                                {6416}new SPs_5164: bitstring;
                                                {6417}new UP_5165: bitstring;
                                                {6418}out(c, (SPs_5164,Sign,UP_5165,pkSess_5163))
                                            )
                                            else
                                                {6419}let pkSess_5166: bitstring = pub(skI) in
                                                {6420}in(c, =GetEndpointRequest);
                                                {6421}new SPs_5167: bitstring;
                                                {6422}new UP_5168: bitstring;
                                                {6423}out(c, (SPs_5167,Sign,UP_5168,pkSess_5166))
                                        )
                                        else
                                            {6424}let pkSess_5169: bitstring = fail-any in
                                            {6425}in(c, =GetEndpointRequest);
                                            {6426}new SPs_5170: bitstring;
                                            {6427}new UP_5171: bitstring;
                                            {6428}out(c, (SPs_5170,Sign,UP_5171,pkSess_5169))
                                )
                                else
                                    {6429}let pkSess_5172: bitstring = fail-any in
                                    {6430}in(c, =GetEndpointRequest);
                                    {6431}new SPs_5173: bitstring;
                                    {6432}new UP_5174: bitstring;
                                    {6433}out(c, (SPs_5173,Sign,UP_5174,pkSess_5172))
                        )
                        else
                            {6434}let pkSess_5175: bitstring = fail-any in
                            {6435}in(c, =GetEndpointRequest);
                            {6436}new SPs_5176: bitstring;
                            {6437}new UP_5177: bitstring;
                            {6438}out(c, (SPs_5176,Sign,UP_5177,pkSess_5175))
                    )
                    else
                        {6439}let v_5178: bool = (Cli_4245 = B) in
                        (
                            {6440}if v_5178 then
                            (
                                {6441}let pkCli_5179: bitstring = pub(skB) in
                                {6442}let v_5180: bool = (Sess_4247 = A) in
                                (
                                    {6443}if v_5180 then
                                    (
                                        {6444}let pkSess_5181: bitstring = pub(skA) in
                                        {6445}in(c, =GetEndpointRequest);
                                        {6446}new SPs_5182: bitstring;
                                        {6447}new UP_5183: bitstring;
                                        {6448}out(c, (SPs_5182,Sign,UP_5183,pkSess_5181))
                                    )
                                    else
                                        {6449}let v_5184: bool = (Sess_4247 = B) in
                                        (
                                            {6450}if v_5184 then
                                            (
                                                {6451}let pkSess_5185: bitstring = pub(skB) in
                                                {6452}in(c, =GetEndpointRequest);
                                                {6453}new SPs_5186: bitstring;
                                                {6454}new UP_5187: bitstring;
                                                {6455}out(c, (SPs_5186,Sign,UP_5187,pkSess_5185))
                                            )
                                            else
                                                {6456}let v_5188: bool = (Sess_4247 = C) in
                                                (
                                                    {6457}if v_5188 then
                                                    (
                                                        {6458}let pkSess_5189: bitstring = pub(skC) in
                                                        {6459}in(c, =GetEndpointRequest);
                                                        {6460}new SPs_5190: bitstring;
                                                        {6461}new UP_5191: bitstring;
                                                        {6462}out(c, (SPs_5190,Sign,UP_5191,pkSess_5189))
                                                    )
                                                    else
                                                        {6463}let pkSess_5192: bitstring = pub(skI) in
                                                        {6464}in(c, =GetEndpointRequest);
                                                        {6465}new SPs_5193: bitstring;
                                                        {6466}new UP_5194: bitstring;
                                                        {6467}out(c, (SPs_5193,Sign,UP_5194,pkSess_5192))
                                                )
                                                else
                                                    {6468}let pkSess_5195: bitstring = fail-any in
                                                    {6469}in(c, =GetEndpointRequest);
                                                    {6470}new SPs_5196: bitstring;
                                                    {6471}new UP_5197: bitstring;
                                                    {6472}out(c, (SPs_5196,Sign,UP_5197,pkSess_5195))
                                        )
                                        else
                                            {6473}let pkSess_5198: bitstring = fail-any in
                                            {6474}in(c, =GetEndpointRequest);
                                            {6475}new SPs_5199: bitstring;
                                            {6476}new UP_5200: bitstring;
                                            {6477}out(c, (SPs_5199,Sign,UP_5200,pkSess_5198))
                                )
                                else
                                    {6478}let pkSess_5201: bitstring = fail-any in
                                    {6479}in(c, =GetEndpointRequest);
                                    {6480}new SPs_5202: bitstring;
                                    {6481}new UP_5203: bitstring;
                                    {6482}out(c, (SPs_5202,Sign,UP_5203,pkSess_5201))
                            )
                            else
                                {6483}let v_5204: bool = (Cli_4245 = C) in
                                (
                                    {6484}if v_5204 then
                                    (
                                        {6485}let pkCli_5205: bitstring = pub(skC) in
                                        {6486}let v_5206: bool = (Sess_4247 = A) in
                                        (
                                            {6487}if v_5206 then
                                            (
                                                {6488}let pkSess_5207: bitstring = pub(skA) in
                                                {6489}in(c, =GetEndpointRequest);
                                                {6490}new SPs_5208: bitstring;
                                                {6491}new UP_5209: bitstring;
                                                {6492}out(c, (SPs_5208,Sign,UP_5209,pkSess_5207))
                                            )
                                            else
                                                {6493}let v_5210: bool = (Sess_4247 = B) in
                                                (
                                                    {6494}if v_5210 then
                                                    (
                                                        {6495}let pkSess_5211: bitstring = pub(skB) in
                                                        {6496}in(c, =GetEndpointRequest);
                                                        {6497}new SPs_5212: bitstring;
                                                        {6498}new UP_5213: bitstring;
                                                        {6499}out(c, (SPs_5212,Sign,UP_5213,pkSess_5211))
                                                    )
                                                    else
                                                        {6500}let v_5214: bool = (Sess_4247 = C) in
                                                        (
                                                            {6501}if v_5214 then
                                                            (
                                                                {6502}let pkSess_5215: bitstring = pub(skC) in
                                                                {6503}in(c, =GetEndpointRequest);
                                                                {6504}new SPs_5216: bitstring;
                                                                {6505}new UP_5217: bitstring;
                                                                {6506}out(c, (SPs_5216,Sign,UP_5217,pkSess_5215))
                                                            )
                                                            else
                                                                {6507}let pkSess_5218: bitstring = pub(skI) in
                                                                {6508}in(c, =GetEndpointRequest);
                                                                {6509}new SPs_5219: bitstring;
                                                                {6510}new UP_5220: bitstring;
                                                                {6511}out(c, (SPs_5219,Sign,UP_5220,pkSess_5218))
                                                        )
                                                        else
                                                            {6512}let pkSess_5221: bitstring = fail-any in
                                                            {6513}in(c, =GetEndpointRequest);
                                                            {6514}new SPs_5222: bitstring;
                                                            {6515}new UP_5223: bitstring;
                                                            {6516}out(c, (SPs_5222,Sign,UP_5223,pkSess_5221))
                                                )
                                                else
                                                    {6517}let pkSess_5224: bitstring = fail-any in
                                                    {6518}in(c, =GetEndpointRequest);
                                                    {6519}new SPs_5225: bitstring;
                                                    {6520}new UP_5226: bitstring;
                                                    {6521}out(c, (SPs_5225,Sign,UP_5226,pkSess_5224))
                                        )
                                        else
                                            {6522}let pkSess_5227: bitstring = fail-any in
                                            {6523}in(c, =GetEndpointRequest);
                                            {6524}new SPs_5228: bitstring;
                                            {6525}new UP_5229: bitstring;
                                            {6526}out(c, (SPs_5228,Sign,UP_5229,pkSess_5227))
                                    )
                                    else
                                        {6527}let pkCli_5230: bitstring = pub(skI) in
                                        {6528}let v_5231: bool = (Sess_4247 = A) in
                                        (
                                            {6529}if v_5231 then
                                            (
                                                {6530}let pkSess_5232: bitstring = pub(skA) in
                                                {6531}in(c, =GetEndpointRequest);
                                                {6532}new SPs_5233: bitstring;
                                                {6533}new UP_5234: bitstring;
                                                {6534}out(c, (SPs_5233,Sign,UP_5234,pkSess_5232))
                                            )
                                            else
                                                {6535}let v_5235: bool = (Sess_4247 = B) in
                                                (
                                                    {6536}if v_5235 then
                                                    (
                                                        {6537}let pkSess_5236: bitstring = pub(skB) in
                                                        {6538}in(c, =GetEndpointRequest);
                                                        {6539}new SPs_5237: bitstring;
                                                        {6540}new UP_5238: bitstring;
                                                        {6541}out(c, (SPs_5237,Sign,UP_5238,pkSess_5236))
                                                    )
                                                    else
                                                        {6542}let v_5239: bool = (Sess_4247 = C) in
                                                        (
                                                            {6543}if v_5239 then
                                                            (
                                                                {6544}let pkSess_5240: bitstring = pub(skC) in
                                                                {6545}in(c, =GetEndpointRequest);
                                                                {6546}new SPs_5241: bitstring;
                                                                {6547}new UP_5242: bitstring;
                                                                {6548}out(c, (SPs_5241,Sign,UP_5242,pkSess_5240))
                                                            )
                                                            else
                                                                {6549}let pkSess_5243: bitstring = pub(skI) in
                                                                {6550}in(c, =GetEndpointRequest);
                                                                {6551}new SPs_5244: bitstring;
                                                                {6552}new UP_5245: bitstring;
                                                                {6553}out(c, (SPs_5244,Sign,UP_5245,pkSess_5243))
                                                        )
                                                        else
                                                            {6554}let pkSess_5246: bitstring = fail-any in
                                                            {6555}in(c, =GetEndpointRequest);
                                                            {6556}new SPs_5247: bitstring;
                                                            {6557}new UP_5248: bitstring;
                                                            {6558}out(c, (SPs_5247,Sign,UP_5248,pkSess_5246))
                                                )
                                                else
                                                    {6559}let pkSess_5249: bitstring = fail-any in
                                                    {6560}in(c, =GetEndpointRequest);
                                                    {6561}new SPs_5250: bitstring;
                                                    {6562}new UP_5251: bitstring;
                                                    {6563}out(c, (SPs_5250,Sign,UP_5251,pkSess_5249))
                                        )
                                        else
                                            {6564}let pkSess_5252: bitstring = fail-any in
                                            {6565}in(c, =GetEndpointRequest);
                                            {6566}new SPs_5253: bitstring;
                                            {6567}new UP_5254: bitstring;
                                            {6568}out(c, (SPs_5253,Sign,UP_5254,pkSess_5252))
                                )
                                else
                                    {6569}let pkCli_5255: bitstring = fail-any in
                                    {6570}let v_5256: bool = (Sess_4247 = A) in
                                    (
                                        {6571}if v_5256 then
                                        (
                                            {6572}let pkSess_5257: bitstring = pub(skA) in
                                            {6573}in(c, =GetEndpointRequest);
                                            {6574}new SPs_5258: bitstring;
                                            {6575}new UP_5259: bitstring;
                                            {6576}out(c, (SPs_5258,Sign,UP_5259,pkSess_5257))
                                        )
                                        else
                                            {6577}let v_5260: bool = (Sess_4247 = B) in
                                            (
                                                {6578}if v_5260 then
                                                (
                                                    {6579}let pkSess_5261: bitstring = pub(skB) in
                                                    {6580}in(c, =GetEndpointRequest);
                                                    {6581}new SPs_5262: bitstring;
                                                    {6582}new UP_5263: bitstring;
                                                    {6583}out(c, (SPs_5262,Sign,UP_5263,pkSess_5261))
                                                )
                                                else
                                                    {6584}let v_5264: bool = (Sess_4247 = C) in
                                                    (
                                                        {6585}if v_5264 then
                                                        (
                                                            {6586}let pkSess_5265: bitstring = pub(skC) in
                                                            {6587}in(c, =GetEndpointRequest);
                                                            {6588}new SPs_5266: bitstring;
                                                            {6589}new UP_5267: bitstring;
                                                            {6590}out(c, (SPs_5266,Sign,UP_5267,pkSess_5265))
                                                        )
                                                        else
                                                            {6591}let pkSess_5268: bitstring = pub(skI) in
                                                            {6592}in(c, =GetEndpointRequest);
                                                            {6593}new SPs_5269: bitstring;
                                                            {6594}new UP_5270: bitstring;
                                                            {6595}out(c, (SPs_5269,Sign,UP_5270,pkSess_5268))
                                                    )
                                                    else
                                                        {6596}let pkSess_5271: bitstring = fail-any in
                                                        {6597}in(c, =GetEndpointRequest);
                                                        {6598}new SPs_5272: bitstring;
                                                        {6599}new UP_5273: bitstring;
                                                        {6600}out(c, (SPs_5272,Sign,UP_5273,pkSess_5271))
                                            )
                                            else
                                                {6601}let pkSess_5274: bitstring = fail-any in
                                                {6602}in(c, =GetEndpointRequest);
                                                {6603}new SPs_5275: bitstring;
                                                {6604}new UP_5276: bitstring;
                                                {6605}out(c, (SPs_5275,Sign,UP_5276,pkSess_5274))
                                    )
                                    else
                                        {6606}let pkSess_5277: bitstring = fail-any in
                                        {6607}in(c, =GetEndpointRequest);
                                        {6608}new SPs_5278: bitstring;
                                        {6609}new UP_5279: bitstring;
                                        {6610}out(c, (SPs_5278,Sign,UP_5279,pkSess_5277))
                        )
                        else
                            {6611}let pkCli_5280: bitstring = fail-any in
                            {6612}let v_5281: bool = (Sess_4247 = A) in
                            (
                                {6613}if v_5281 then
                                (
                                    {6614}let pkSess_5282: bitstring = pub(skA) in
                                    {6615}in(c, =GetEndpointRequest);
                                    {6616}new SPs_5283: bitstring;
                                    {6617}new UP_5284: bitstring;
                                    {6618}out(c, (SPs_5283,Sign,UP_5284,pkSess_5282))
                                )
                                else
                                    {6619}let v_5285: bool = (Sess_4247 = B) in
                                    (
                                        {6620}if v_5285 then
                                        (
                                            {6621}let pkSess_5286: bitstring = pub(skB) in
                                            {6622}in(c, =GetEndpointRequest);
                                            {6623}new SPs_5287: bitstring;
                                            {6624}new UP_5288: bitstring;
                                            {6625}out(c, (SPs_5287,Sign,UP_5288,pkSess_5286))
                                        )
                                        else
                                            {6626}let v_5289: bool = (Sess_4247 = C) in
                                            (
                                                {6627}if v_5289 then
                                                (
                                                    {6628}let pkSess_5290: bitstring = pub(skC) in
                                                    {6629}in(c, =GetEndpointRequest);
                                                    {6630}new SPs_5291: bitstring;
                                                    {6631}new UP_5292: bitstring;
                                                    {6632}out(c, (SPs_5291,Sign,UP_5292,pkSess_5290))
                                                )
                                                else
                                                    {6633}let pkSess_5293: bitstring = pub(skI) in
                                                    {6634}in(c, =GetEndpointRequest);
                                                    {6635}new SPs_5294: bitstring;
                                                    {6636}new UP_5295: bitstring;
                                                    {6637}out(c, (SPs_5294,Sign,UP_5295,pkSess_5293))
                                            )
                                            else
                                                {6638}let pkSess_5296: bitstring = fail-any in
                                                {6639}in(c, =GetEndpointRequest);
                                                {6640}new SPs_5297: bitstring;
                                                {6641}new UP_5298: bitstring;
                                                {6642}out(c, (SPs_5297,Sign,UP_5298,pkSess_5296))
                                    )
                                    else
                                        {6643}let pkSess_5299: bitstring = fail-any in
                                        {6644}in(c, =GetEndpointRequest);
                                        {6645}new SPs_5300: bitstring;
                                        {6646}new UP_5301: bitstring;
                                        {6647}out(c, (SPs_5300,Sign,UP_5301,pkSess_5299))
                            )
                            else
                                {6648}let pkSess_5302: bitstring = fail-any in
                                {6649}in(c, =GetEndpointRequest);
                                {6650}new SPs_5303: bitstring;
                                {6651}new UP_5304: bitstring;
                                {6652}out(c, (SPs_5303,Sign,UP_5304,pkSess_5302))
                )
                else
                    {6653}let pkCli_5305: bitstring = fail-any in
                    {6654}let v_5306: bool = (Sess_4247 = A) in
                    (
                        {6655}if v_5306 then
                        (
                            {6656}let pkSess_5307: bitstring = pub(skA) in
                            {6657}in(c, =GetEndpointRequest);
                            {6658}new SPs_5308: bitstring;
                            {6659}new UP_5309: bitstring;
                            {6660}out(c, (SPs_5308,Sign,UP_5309,pkSess_5307))
                        )
                        else
                            {6661}let v_5310: bool = (Sess_4247 = B) in
                            (
                                {6662}if v_5310 then
                                (
                                    {6663}let pkSess_5311: bitstring = pub(skB) in
                                    {6664}in(c, =GetEndpointRequest);
                                    {6665}new SPs_5312: bitstring;
                                    {6666}new UP_5313: bitstring;
                                    {6667}out(c, (SPs_5312,Sign,UP_5313,pkSess_5311))
                                )
                                else
                                    {6668}let v_5314: bool = (Sess_4247 = C) in
                                    (
                                        {6669}if v_5314 then
                                        (
                                            {6670}let pkSess_5315: bitstring = pub(skC) in
                                            {6671}in(c, =GetEndpointRequest);
                                            {6672}new SPs_5316: bitstring;
                                            {6673}new UP_5317: bitstring;
                                            {6674}out(c, (SPs_5316,Sign,UP_5317,pkSess_5315))
                                        )
                                        else
                                            {6675}let pkSess_5318: bitstring = pub(skI) in
                                            {6676}in(c, =GetEndpointRequest);
                                            {6677}new SPs_5319: bitstring;
                                            {6678}new UP_5320: bitstring;
                                            {6679}out(c, (SPs_5319,Sign,UP_5320,pkSess_5318))
                                    )
                                    else
                                        {6680}let pkSess_5321: bitstring = fail-any in
                                        {6681}in(c, =GetEndpointRequest);
                                        {6682}new SPs_5322: bitstring;
                                        {6683}new UP_5323: bitstring;
                                        {6684}out(c, (SPs_5322,Sign,UP_5323,pkSess_5321))
                            )
                            else
                                {6685}let pkSess_5324: bitstring = fail-any in
                                {6686}in(c, =GetEndpointRequest);
                                {6687}new SPs_5325: bitstring;
                                {6688}new UP_5326: bitstring;
                                {6689}out(c, (SPs_5325,Sign,UP_5326,pkSess_5324))
                    )
                    else
                        {6690}let pkSess_5327: bitstring = fail-any in
                        {6691}in(c, =GetEndpointRequest);
                        {6692}new SPs_5328: bitstring;
                        {6693}new UP_5329: bitstring;
                        {6694}out(c, (SPs_5328,Sign,UP_5329,pkSess_5327))
    )
    else
        {6695}let skDisco_5330: bitstring = fail-any in
        {6696}let pkDisco_5331: bitstring = pub(skDisco_5330) in
        {6697}let v_5332: bool = (Cli_4245 = A) in
        (
            {6698}if v_5332 then
            (
                {6699}let pkCli_5333: bitstring = pub(skA) in
                {6700}let v_5334: bool = (Sess_4247 = A) in
                (
                    {6701}if v_5334 then
                    (
                        {6702}let pkSess_5335: bitstring = pub(skA) in
                        {6703}in(c, =GetEndpointRequest);
                        {6704}new SPs_5336: bitstring;
                        {6705}new UP_5337: bitstring;
                        {6706}out(c, (SPs_5336,Sign,UP_5337,pkSess_5335))
                    )
                    else
                        {6707}let v_5338: bool = (Sess_4247 = B) in
                        (
                            {6708}if v_5338 then
                            (
                                {6709}let pkSess_5339: bitstring = pub(skB) in
                                {6710}in(c, =GetEndpointRequest);
                                {6711}new SPs_5340: bitstring;
                                {6712}new UP_5341: bitstring;
                                {6713}out(c, (SPs_5340,Sign,UP_5341,pkSess_5339))
                            )
                            else
                                {6714}let v_5342: bool = (Sess_4247 = C) in
                                (
                                    {6715}if v_5342 then
                                    (
                                        {6716}let pkSess_5343: bitstring = pub(skC) in
                                        {6717}in(c, =GetEndpointRequest);
                                        {6718}new SPs_5344: bitstring;
                                        {6719}new UP_5345: bitstring;
                                        {6720}out(c, (SPs_5344,Sign,UP_5345,pkSess_5343))
                                    )
                                    else
                                        {6721}let pkSess_5346: bitstring = pub(skI) in
                                        {6722}in(c, =GetEndpointRequest);
                                        {6723}new SPs_5347: bitstring;
                                        {6724}new UP_5348: bitstring;
                                        {6725}out(c, (SPs_5347,Sign,UP_5348,pkSess_5346))
                                )
                                else
                                    {6726}let pkSess_5349: bitstring = fail-any in
                                    {6727}in(c, =GetEndpointRequest);
                                    {6728}new SPs_5350: bitstring;
                                    {6729}new UP_5351: bitstring;
                                    {6730}out(c, (SPs_5350,Sign,UP_5351,pkSess_5349))
                        )
                        else
                            {6731}let pkSess_5352: bitstring = fail-any in
                            {6732}in(c, =GetEndpointRequest);
                            {6733}new SPs_5353: bitstring;
                            {6734}new UP_5354: bitstring;
                            {6735}out(c, (SPs_5353,Sign,UP_5354,pkSess_5352))
                )
                else
                    {6736}let pkSess_5355: bitstring = fail-any in
                    {6737}in(c, =GetEndpointRequest);
                    {6738}new SPs_5356: bitstring;
                    {6739}new UP_5357: bitstring;
                    {6740}out(c, (SPs_5356,Sign,UP_5357,pkSess_5355))
            )
            else
                {6741}let v_5358: bool = (Cli_4245 = B) in
                (
                    {6742}if v_5358 then
                    (
                        {6743}let pkCli_5359: bitstring = pub(skB) in
                        {6744}let v_5360: bool = (Sess_4247 = A) in
                        (
                            {6745}if v_5360 then
                            (
                                {6746}let pkSess_5361: bitstring = pub(skA) in
                                {6747}in(c, =GetEndpointRequest);
                                {6748}new SPs_5362: bitstring;
                                {6749}new UP_5363: bitstring;
                                {6750}out(c, (SPs_5362,Sign,UP_5363,pkSess_5361))
                            )
                            else
                                {6751}let v_5364: bool = (Sess_4247 = B) in
                                (
                                    {6752}if v_5364 then
                                    (
                                        {6753}let pkSess_5365: bitstring = pub(skB) in
                                        {6754}in(c, =GetEndpointRequest);
                                        {6755}new SPs_5366: bitstring;
                                        {6756}new UP_5367: bitstring;
                                        {6757}out(c, (SPs_5366,Sign,UP_5367,pkSess_5365))
                                    )
                                    else
                                        {6758}let v_5368: bool = (Sess_4247 = C) in
                                        (
                                            {6759}if v_5368 then
                                            (
                                                {6760}let pkSess_5369: bitstring = pub(skC) in
                                                {6761}in(c, =GetEndpointRequest);
                                                {6762}new SPs_5370: bitstring;
                                                {6763}new UP_5371: bitstring;
                                                {6764}out(c, (SPs_5370,Sign,UP_5371,pkSess_5369))
                                            )
                                            else
                                                {6765}let pkSess_5372: bitstring = pub(skI) in
                                                {6766}in(c, =GetEndpointRequest);
                                                {6767}new SPs_5373: bitstring;
                                                {6768}new UP_5374: bitstring;
                                                {6769}out(c, (SPs_5373,Sign,UP_5374,pkSess_5372))
                                        )
                                        else
                                            {6770}let pkSess_5375: bitstring = fail-any in
                                            {6771}in(c, =GetEndpointRequest);
                                            {6772}new SPs_5376: bitstring;
                                            {6773}new UP_5377: bitstring;
                                            {6774}out(c, (SPs_5376,Sign,UP_5377,pkSess_5375))
                                )
                                else
                                    {6775}let pkSess_5378: bitstring = fail-any in
                                    {6776}in(c, =GetEndpointRequest);
                                    {6777}new SPs_5379: bitstring;
                                    {6778}new UP_5380: bitstring;
                                    {6779}out(c, (SPs_5379,Sign,UP_5380,pkSess_5378))
                        )
                        else
                            {6780}let pkSess_5381: bitstring = fail-any in
                            {6781}in(c, =GetEndpointRequest);
                            {6782}new SPs_5382: bitstring;
                            {6783}new UP_5383: bitstring;
                            {6784}out(c, (SPs_5382,Sign,UP_5383,pkSess_5381))
                    )
                    else
                        {6785}let v_5384: bool = (Cli_4245 = C) in
                        (
                            {6786}if v_5384 then
                            (
                                {6787}let pkCli_5385: bitstring = pub(skC) in
                                {6788}let v_5386: bool = (Sess_4247 = A) in
                                (
                                    {6789}if v_5386 then
                                    (
                                        {6790}let pkSess_5387: bitstring = pub(skA) in
                                        {6791}in(c, =GetEndpointRequest);
                                        {6792}new SPs_5388: bitstring;
                                        {6793}new UP_5389: bitstring;
                                        {6794}out(c, (SPs_5388,Sign,UP_5389,pkSess_5387))
                                    )
                                    else
                                        {6795}let v_5390: bool = (Sess_4247 = B) in
                                        (
                                            {6796}if v_5390 then
                                            (
                                                {6797}let pkSess_5391: bitstring = pub(skB) in
                                                {6798}in(c, =GetEndpointRequest);
                                                {6799}new SPs_5392: bitstring;
                                                {6800}new UP_5393: bitstring;
                                                {6801}out(c, (SPs_5392,Sign,UP_5393,pkSess_5391))
                                            )
                                            else
                                                {6802}let v_5394: bool = (Sess_4247 = C) in
                                                (
                                                    {6803}if v_5394 then
                                                    (
                                                        {6804}let pkSess_5395: bitstring = pub(skC) in
                                                        {6805}in(c, =GetEndpointRequest);
                                                        {6806}new SPs_5396: bitstring;
                                                        {6807}new UP_5397: bitstring;
                                                        {6808}out(c, (SPs_5396,Sign,UP_5397,pkSess_5395))
                                                    )
                                                    else
                                                        {6809}let pkSess_5398: bitstring = pub(skI) in
                                                        {6810}in(c, =GetEndpointRequest);
                                                        {6811}new SPs_5399: bitstring;
                                                        {6812}new UP_5400: bitstring;
                                                        {6813}out(c, (SPs_5399,Sign,UP_5400,pkSess_5398))
                                                )
                                                else
                                                    {6814}let pkSess_5401: bitstring = fail-any in
                                                    {6815}in(c, =GetEndpointRequest);
                                                    {6816}new SPs_5402: bitstring;
                                                    {6817}new UP_5403: bitstring;
                                                    {6818}out(c, (SPs_5402,Sign,UP_5403,pkSess_5401))
                                        )
                                        else
                                            {6819}let pkSess_5404: bitstring = fail-any in
                                            {6820}in(c, =GetEndpointRequest);
                                            {6821}new SPs_5405: bitstring;
                                            {6822}new UP_5406: bitstring;
                                            {6823}out(c, (SPs_5405,Sign,UP_5406,pkSess_5404))
                                )
                                else
                                    {6824}let pkSess_5407: bitstring = fail-any in
                                    {6825}in(c, =GetEndpointRequest);
                                    {6826}new SPs_5408: bitstring;
                                    {6827}new UP_5409: bitstring;
                                    {6828}out(c, (SPs_5408,Sign,UP_5409,pkSess_5407))
                            )
                            else
                                {6829}let pkCli_5410: bitstring = pub(skI) in
                                {6830}let v_5411: bool = (Sess_4247 = A) in
                                (
                                    {6831}if v_5411 then
                                    (
                                        {6832}let pkSess_5412: bitstring = pub(skA) in
                                        {6833}in(c, =GetEndpointRequest);
                                        {6834}new SPs_5413: bitstring;
                                        {6835}new UP_5414: bitstring;
                                        {6836}out(c, (SPs_5413,Sign,UP_5414,pkSess_5412))
                                    )
                                    else
                                        {6837}let v_5415: bool = (Sess_4247 = B) in
                                        (
                                            {6838}if v_5415 then
                                            (
                                                {6839}let pkSess_5416: bitstring = pub(skB) in
                                                {6840}in(c, =GetEndpointRequest);
                                                {6841}new SPs_5417: bitstring;
                                                {6842}new UP_5418: bitstring;
                                                {6843}out(c, (SPs_5417,Sign,UP_5418,pkSess_5416))
                                            )
                                            else
                                                {6844}let v_5419: bool = (Sess_4247 = C) in
                                                (
                                                    {6845}if v_5419 then
                                                    (
                                                        {6846}let pkSess_5420: bitstring = pub(skC) in
                                                        {6847}in(c, =GetEndpointRequest);
                                                        {6848}new SPs_5421: bitstring;
                                                        {6849}new UP_5422: bitstring;
                                                        {6850}out(c, (SPs_5421,Sign,UP_5422,pkSess_5420))
                                                    )
                                                    else
                                                        {6851}let pkSess_5423: bitstring = pub(skI) in
                                                        {6852}in(c, =GetEndpointRequest);
                                                        {6853}new SPs_5424: bitstring;
                                                        {6854}new UP_5425: bitstring;
                                                        {6855}out(c, (SPs_5424,Sign,UP_5425,pkSess_5423))
                                                )
                                                else
                                                    {6856}let pkSess_5426: bitstring = fail-any in
                                                    {6857}in(c, =GetEndpointRequest);
                                                    {6858}new SPs_5427: bitstring;
                                                    {6859}new UP_5428: bitstring;
                                                    {6860}out(c, (SPs_5427,Sign,UP_5428,pkSess_5426))
                                        )
                                        else
                                            {6861}let pkSess_5429: bitstring = fail-any in
                                            {6862}in(c, =GetEndpointRequest);
                                            {6863}new SPs_5430: bitstring;
                                            {6864}new UP_5431: bitstring;
                                            {6865}out(c, (SPs_5430,Sign,UP_5431,pkSess_5429))
                                )
                                else
                                    {6866}let pkSess_5432: bitstring = fail-any in
                                    {6867}in(c, =GetEndpointRequest);
                                    {6868}new SPs_5433: bitstring;
                                    {6869}new UP_5434: bitstring;
                                    {6870}out(c, (SPs_5433,Sign,UP_5434,pkSess_5432))
                        )
                        else
                            {6871}let pkCli_5435: bitstring = fail-any in
                            {6872}let v_5436: bool = (Sess_4247 = A) in
                            (
                                {6873}if v_5436 then
                                (
                                    {6874}let pkSess_5437: bitstring = pub(skA) in
                                    {6875}in(c, =GetEndpointRequest);
                                    {6876}new SPs_5438: bitstring;
                                    {6877}new UP_5439: bitstring;
                                    {6878}out(c, (SPs_5438,Sign,UP_5439,pkSess_5437))
                                )
                                else
                                    {6879}let v_5440: bool = (Sess_4247 = B) in
                                    (
                                        {6880}if v_5440 then
                                        (
                                            {6881}let pkSess_5441: bitstring = pub(skB) in
                                            {6882}in(c, =GetEndpointRequest);
                                            {6883}new SPs_5442: bitstring;
                                            {6884}new UP_5443: bitstring;
                                            {6885}out(c, (SPs_5442,Sign,UP_5443,pkSess_5441))
                                        )
                                        else
                                            {6886}let v_5444: bool = (Sess_4247 = C) in
                                            (
                                                {6887}if v_5444 then
                                                (
                                                    {6888}let pkSess_5445: bitstring = pub(skC) in
                                                    {6889}in(c, =GetEndpointRequest);
                                                    {6890}new SPs_5446: bitstring;
                                                    {6891}new UP_5447: bitstring;
                                                    {6892}out(c, (SPs_5446,Sign,UP_5447,pkSess_5445))
                                                )
                                                else
                                                    {6893}let pkSess_5448: bitstring = pub(skI) in
                                                    {6894}in(c, =GetEndpointRequest);
                                                    {6895}new SPs_5449: bitstring;
                                                    {6896}new UP_5450: bitstring;
                                                    {6897}out(c, (SPs_5449,Sign,UP_5450,pkSess_5448))
                                            )
                                            else
                                                {6898}let pkSess_5451: bitstring = fail-any in
                                                {6899}in(c, =GetEndpointRequest);
                                                {6900}new SPs_5452: bitstring;
                                                {6901}new UP_5453: bitstring;
                                                {6902}out(c, (SPs_5452,Sign,UP_5453,pkSess_5451))
                                    )
                                    else
                                        {6903}let pkSess_5454: bitstring = fail-any in
                                        {6904}in(c, =GetEndpointRequest);
                                        {6905}new SPs_5455: bitstring;
                                        {6906}new UP_5456: bitstring;
                                        {6907}out(c, (SPs_5455,Sign,UP_5456,pkSess_5454))
                            )
                            else
                                {6908}let pkSess_5457: bitstring = fail-any in
                                {6909}in(c, =GetEndpointRequest);
                                {6910}new SPs_5458: bitstring;
                                {6911}new UP_5459: bitstring;
                                {6912}out(c, (SPs_5458,Sign,UP_5459,pkSess_5457))
                )
                else
                    {6913}let pkCli_5460: bitstring = fail-any in
                    {6914}let v_5461: bool = (Sess_4247 = A) in
                    (
                        {6915}if v_5461 then
                        (
                            {6916}let pkSess_5462: bitstring = pub(skA) in
                            {6917}in(c, =GetEndpointRequest);
                            {6918}new SPs_5463: bitstring;
                            {6919}new UP_5464: bitstring;
                            {6920}out(c, (SPs_5463,Sign,UP_5464,pkSess_5462))
                        )
                        else
                            {6921}let v_5465: bool = (Sess_4247 = B) in
                            (
                                {6922}if v_5465 then
                                (
                                    {6923}let pkSess_5466: bitstring = pub(skB) in
                                    {6924}in(c, =GetEndpointRequest);
                                    {6925}new SPs_5467: bitstring;
                                    {6926}new UP_5468: bitstring;
                                    {6927}out(c, (SPs_5467,Sign,UP_5468,pkSess_5466))
                                )
                                else
                                    {6928}let v_5469: bool = (Sess_4247 = C) in
                                    (
                                        {6929}if v_5469 then
                                        (
                                            {6930}let pkSess_5470: bitstring = pub(skC) in
                                            {6931}in(c, =GetEndpointRequest);
                                            {6932}new SPs_5471: bitstring;
                                            {6933}new UP_5472: bitstring;
                                            {6934}out(c, (SPs_5471,Sign,UP_5472,pkSess_5470))
                                        )
                                        else
                                            {6935}let pkSess_5473: bitstring = pub(skI) in
                                            {6936}in(c, =GetEndpointRequest);
                                            {6937}new SPs_5474: bitstring;
                                            {6938}new UP_5475: bitstring;
                                            {6939}out(c, (SPs_5474,Sign,UP_5475,pkSess_5473))
                                    )
                                    else
                                        {6940}let pkSess_5476: bitstring = fail-any in
                                        {6941}in(c, =GetEndpointRequest);
                                        {6942}new SPs_5477: bitstring;
                                        {6943}new UP_5478: bitstring;
                                        {6944}out(c, (SPs_5477,Sign,UP_5478,pkSess_5476))
                            )
                            else
                                {6945}let pkSess_5479: bitstring = fail-any in
                                {6946}in(c, =GetEndpointRequest);
                                {6947}new SPs_5480: bitstring;
                                {6948}new UP_5481: bitstring;
                                {6949}out(c, (SPs_5480,Sign,UP_5481,pkSess_5479))
                    )
                    else
                        {6950}let pkSess_5482: bitstring = fail-any in
                        {6951}in(c, =GetEndpointRequest);
                        {6952}new SPs_5483: bitstring;
                        {6953}new UP_5484: bitstring;
                        {6954}out(c, (SPs_5483,Sign,UP_5484,pkSess_5482))
        )
        else
            {6955}let pkCli_5485: bitstring = fail-any in
            {6956}let v_5486: bool = (Sess_4247 = A) in
            (
                {6957}if v_5486 then
                (
                    {6958}let pkSess_5487: bitstring = pub(skA) in
                    {6959}in(c, =GetEndpointRequest);
                    {6960}new SPs_5488: bitstring;
                    {6961}new UP_5489: bitstring;
                    {6962}out(c, (SPs_5488,Sign,UP_5489,pkSess_5487))
                )
                else
                    {6963}let v_5490: bool = (Sess_4247 = B) in
                    (
                        {6964}if v_5490 then
                        (
                            {6965}let pkSess_5491: bitstring = pub(skB) in
                            {6966}in(c, =GetEndpointRequest);
                            {6967}new SPs_5492: bitstring;
                            {6968}new UP_5493: bitstring;
                            {6969}out(c, (SPs_5492,Sign,UP_5493,pkSess_5491))
                        )
                        else
                            {6970}let v_5494: bool = (Sess_4247 = C) in
                            (
                                {6971}if v_5494 then
                                (
                                    {6972}let pkSess_5495: bitstring = pub(skC) in
                                    {6973}in(c, =GetEndpointRequest);
                                    {6974}new SPs_5496: bitstring;
                                    {6975}new UP_5497: bitstring;
                                    {6976}out(c, (SPs_5496,Sign,UP_5497,pkSess_5495))
                                )
                                else
                                    {6977}let pkSess_5498: bitstring = pub(skI) in
                                    {6978}in(c, =GetEndpointRequest);
                                    {6979}new SPs_5499: bitstring;
                                    {6980}new UP_5500: bitstring;
                                    {6981}out(c, (SPs_5499,Sign,UP_5500,pkSess_5498))
                            )
                            else
                                {6982}let pkSess_5501: bitstring = fail-any in
                                {6983}in(c, =GetEndpointRequest);
                                {6984}new SPs_5502: bitstring;
                                {6985}new UP_5503: bitstring;
                                {6986}out(c, (SPs_5502,Sign,UP_5503,pkSess_5501))
                    )
                    else
                        {6987}let pkSess_5504: bitstring = fail-any in
                        {6988}in(c, =GetEndpointRequest);
                        {6989}new SPs_5505: bitstring;
                        {6990}new UP_5506: bitstring;
                        {6991}out(c, (SPs_5505,Sign,UP_5506,pkSess_5504))
            )
            else
                {6992}let pkSess_5507: bitstring = fail-any in
                {6993}in(c, =GetEndpointRequest);
                {6994}new SPs_5508: bitstring;
                {6995}new UP_5509: bitstring;
                {6996}out(c, (SPs_5508,Sign,UP_5509,pkSess_5507))
) | (
    {6997}!
    {6998}in(c, (Cli_5510: host,Disco_5511: host,Sess_5512: host));
    {6999}let v_5513: bool = (Sess_5512 = A) in
    (
        {7000}if v_5513 then
        (
            {7001}let skSess: bitstring = skA in
            {7002}let pkSess_5514: bitstring = pub(skSess) in
            {7003}let v_5515: bool = (Cli_5510 = A) in
            (
                {7004}if v_5515 then
                (
                    {7005}let pkCli_5516: bitstring = pub(skA) in
                    {7006}let v_5517: bool = (Disco_5511 = A) in
                    (
                        {7007}if v_5517 then
                        (
                            {7008}let pkDisco_5518: bitstring = pub(skA) in
                            {7009}in(c, (=pkCli_5516,m1_5519: bitstring,sigM1: bitstring));
                            {7010}if (verify(h(m1_5519),sigM1,pkCli_5516) <> true) then
                                0
                            else
                                {7011}let (=Sess_5512,SPc_5520: bitstring,PartC: bitstring) = m1_5519 in
                                {7012}event endSrv(Cli_5510,Sess_5512,PartC);
                                {7013}new Ns: bitstring;
                                {7014}let gNs: bitstring = exp(g,Ns) in
                                {7015}let m2: bitstring = (Cli_5510,gNs) in
                                {7016}event beginSrv(Sess_5512,Cli_5510,gNs);
                                {7017}out(c, (m2,sign(h(m2),skSess)))
                        )
                        else
                            {7018}let v_5521: bool = (Disco_5511 = B) in
                            (
                                {7019}if v_5521 then
                                (
                                    {7020}let pkDisco_5522: bitstring = pub(skB) in
                                    {7021}in(c, (=pkCli_5516,m1_5523: bitstring,sigM1_5524: bitstring));
                                    {7022}if (verify(h(m1_5523),sigM1_5524,pkCli_5516) <> true) then
                                        0
                                    else
                                        {7023}let (=Sess_5512,SPc_5525: bitstring,PartC_5526: bitstring) = m1_5523 in
                                        {7024}event endSrv(Cli_5510,Sess_5512,PartC_5526);
                                        {7025}new Ns_5527: bitstring;
                                        {7026}let gNs_5528: bitstring = exp(g,Ns_5527) in
                                        {7027}let m2_5529: bitstring = (Cli_5510,gNs_5528) in
                                        {7028}event beginSrv(Sess_5512,Cli_5510,gNs_5528);
                                        {7029}out(c, (m2_5529,sign(h(m2_5529),skSess)))
                                )
                                else
                                    {7030}let v_5530: bool = (Disco_5511 = C) in
                                    (
                                        {7031}if v_5530 then
                                        (
                                            {7032}let pkDisco_5531: bitstring = pub(skC) in
                                            {7033}in(c, (=pkCli_5516,m1_5532: bitstring,sigM1_5533: bitstring));
                                            {7034}if (verify(h(m1_5532),sigM1_5533,pkCli_5516) <> true) then
                                                0
                                            else
                                                {7035}let (=Sess_5512,SPc_5534: bitstring,PartC_5535: bitstring) = m1_5532 in
                                                {7036}event endSrv(Cli_5510,Sess_5512,PartC_5535);
                                                {7037}new Ns_5536: bitstring;
                                                {7038}let gNs_5537: bitstring = exp(g,Ns_5536) in
                                                {7039}let m2_5538: bitstring = (Cli_5510,gNs_5537) in
                                                {7040}event beginSrv(Sess_5512,Cli_5510,gNs_5537);
                                                {7041}out(c, (m2_5538,sign(h(m2_5538),skSess)))
                                        )
                                        else
                                            {7042}let pkDisco_5539: bitstring = pub(skI) in
                                            {7043}in(c, (=pkCli_5516,m1_5540: bitstring,sigM1_5541: bitstring));
                                            {7044}if (verify(h(m1_5540),sigM1_5541,pkCli_5516) <> true) then
                                                0
                                            else
                                                {7045}let (=Sess_5512,SPc_5542: bitstring,PartC_5543: bitstring) = m1_5540 in
                                                {7046}event endSrv(Cli_5510,Sess_5512,PartC_5543);
                                                {7047}new Ns_5544: bitstring;
                                                {7048}let gNs_5545: bitstring = exp(g,Ns_5544) in
                                                {7049}let m2_5546: bitstring = (Cli_5510,gNs_5545) in
                                                {7050}event beginSrv(Sess_5512,Cli_5510,gNs_5545);
                                                {7051}out(c, (m2_5546,sign(h(m2_5546),skSess)))
                                    )
                                    else
                                        {7052}let pkDisco_5547: bitstring = fail-any in
                                        {7053}in(c, (=pkCli_5516,m1_5548: bitstring,sigM1_5549: bitstring));
                                        {7054}if (verify(h(m1_5548),sigM1_5549,pkCli_5516) <> true) then
                                            0
                                        else
                                            {7055}let (=Sess_5512,SPc_5550: bitstring,PartC_5551: bitstring) = m1_5548 in
                                            {7056}event endSrv(Cli_5510,Sess_5512,PartC_5551);
                                            {7057}new Ns_5552: bitstring;
                                            {7058}let gNs_5553: bitstring = exp(g,Ns_5552) in
                                            {7059}let m2_5554: bitstring = (Cli_5510,gNs_5553) in
                                            {7060}event beginSrv(Sess_5512,Cli_5510,gNs_5553);
                                            {7061}out(c, (m2_5554,sign(h(m2_5554),skSess)))
                            )
                            else
                                {7062}let pkDisco_5555: bitstring = fail-any in
                                {7063}in(c, (=pkCli_5516,m1_5556: bitstring,sigM1_5557: bitstring));
                                {7064}if (verify(h(m1_5556),sigM1_5557,pkCli_5516) <> true) then
                                    0
                                else
                                    {7065}let (=Sess_5512,SPc_5558: bitstring,PartC_5559: bitstring) = m1_5556 in
                                    {7066}event endSrv(Cli_5510,Sess_5512,PartC_5559);
                                    {7067}new Ns_5560: bitstring;
                                    {7068}let gNs_5561: bitstring = exp(g,Ns_5560) in
                                    {7069}let m2_5562: bitstring = (Cli_5510,gNs_5561) in
                                    {7070}event beginSrv(Sess_5512,Cli_5510,gNs_5561);
                                    {7071}out(c, (m2_5562,sign(h(m2_5562),skSess)))
                    )
                    else
                        {7072}let pkDisco_5563: bitstring = fail-any in
                        {7073}in(c, (=pkCli_5516,m1_5564: bitstring,sigM1_5565: bitstring));
                        {7074}if (verify(h(m1_5564),sigM1_5565,pkCli_5516) <> true) then
                            0
                        else
                            {7075}let (=Sess_5512,SPc_5566: bitstring,PartC_5567: bitstring) = m1_5564 in
                            {7076}event endSrv(Cli_5510,Sess_5512,PartC_5567);
                            {7077}new Ns_5568: bitstring;
                            {7078}let gNs_5569: bitstring = exp(g,Ns_5568) in
                            {7079}let m2_5570: bitstring = (Cli_5510,gNs_5569) in
                            {7080}event beginSrv(Sess_5512,Cli_5510,gNs_5569);
                            {7081}out(c, (m2_5570,sign(h(m2_5570),skSess)))
                )
                else
                    {7082}let v_5571: bool = (Cli_5510 = B) in
                    (
                        {7083}if v_5571 then
                        (
                            {7084}let pkCli_5572: bitstring = pub(skB) in
                            {7085}let v_5573: bool = (Disco_5511 = A) in
                            (
                                {7086}if v_5573 then
                                (
                                    {7087}let pkDisco_5574: bitstring = pub(skA) in
                                    {7088}in(c, (=pkCli_5572,m1_5575: bitstring,sigM1_5576: bitstring));
                                    {7089}if (verify(h(m1_5575),sigM1_5576,pkCli_5572) <> true) then
                                        0
                                    else
                                        {7090}let (=Sess_5512,SPc_5577: bitstring,PartC_5578: bitstring) = m1_5575 in
                                        {7091}event endSrv(Cli_5510,Sess_5512,PartC_5578);
                                        {7092}new Ns_5579: bitstring;
                                        {7093}let gNs_5580: bitstring = exp(g,Ns_5579) in
                                        {7094}let m2_5581: bitstring = (Cli_5510,gNs_5580) in
                                        {7095}event beginSrv(Sess_5512,Cli_5510,gNs_5580);
                                        {7096}out(c, (m2_5581,sign(h(m2_5581),skSess)))
                                )
                                else
                                    {7097}let v_5582: bool = (Disco_5511 = B) in
                                    (
                                        {7098}if v_5582 then
                                        (
                                            {7099}let pkDisco_5583: bitstring = pub(skB) in
                                            {7100}in(c, (=pkCli_5572,m1_5584: bitstring,sigM1_5585: bitstring));
                                            {7101}if (verify(h(m1_5584),sigM1_5585,pkCli_5572) <> true) then
                                                0
                                            else
                                                {7102}let (=Sess_5512,SPc_5586: bitstring,PartC_5587: bitstring) = m1_5584 in
                                                {7103}event endSrv(Cli_5510,Sess_5512,PartC_5587);
                                                {7104}new Ns_5588: bitstring;
                                                {7105}let gNs_5589: bitstring = exp(g,Ns_5588) in
                                                {7106}let m2_5590: bitstring = (Cli_5510,gNs_5589) in
                                                {7107}event beginSrv(Sess_5512,Cli_5510,gNs_5589);
                                                {7108}out(c, (m2_5590,sign(h(m2_5590),skSess)))
                                        )
                                        else
                                            {7109}let v_5591: bool = (Disco_5511 = C) in
                                            (
                                                {7110}if v_5591 then
                                                (
                                                    {7111}let pkDisco_5592: bitstring = pub(skC) in
                                                    {7112}in(c, (=pkCli_5572,m1_5593: bitstring,sigM1_5594: bitstring));
                                                    {7113}if (verify(h(m1_5593),sigM1_5594,pkCli_5572) <> true) then
                                                        0
                                                    else
                                                        {7114}let (=Sess_5512,SPc_5595: bitstring,PartC_5596: bitstring) = m1_5593 in
                                                        {7115}event endSrv(Cli_5510,Sess_5512,PartC_5596);
                                                        {7116}new Ns_5597: bitstring;
                                                        {7117}let gNs_5598: bitstring = exp(g,Ns_5597) in
                                                        {7118}let m2_5599: bitstring = (Cli_5510,gNs_5598) in
                                                        {7119}event beginSrv(Sess_5512,Cli_5510,gNs_5598);
                                                        {7120}out(c, (m2_5599,sign(h(m2_5599),skSess)))
                                                )
                                                else
                                                    {7121}let pkDisco_5600: bitstring = pub(skI) in
                                                    {7122}in(c, (=pkCli_5572,m1_5601: bitstring,sigM1_5602: bitstring));
                                                    {7123}if (verify(h(m1_5601),sigM1_5602,pkCli_5572) <> true) then
                                                        0
                                                    else
                                                        {7124}let (=Sess_5512,SPc_5603: bitstring,PartC_5604: bitstring) = m1_5601 in
                                                        {7125}event endSrv(Cli_5510,Sess_5512,PartC_5604);
                                                        {7126}new Ns_5605: bitstring;
                                                        {7127}let gNs_5606: bitstring = exp(g,Ns_5605) in
                                                        {7128}let m2_5607: bitstring = (Cli_5510,gNs_5606) in
                                                        {7129}event beginSrv(Sess_5512,Cli_5510,gNs_5606);
                                                        {7130}out(c, (m2_5607,sign(h(m2_5607),skSess)))
                                            )
                                            else
                                                {7131}let pkDisco_5608: bitstring = fail-any in
                                                {7132}in(c, (=pkCli_5572,m1_5609: bitstring,sigM1_5610: bitstring));
                                                {7133}if (verify(h(m1_5609),sigM1_5610,pkCli_5572) <> true) then
                                                    0
                                                else
                                                    {7134}let (=Sess_5512,SPc_5611: bitstring,PartC_5612: bitstring) = m1_5609 in
                                                    {7135}event endSrv(Cli_5510,Sess_5512,PartC_5612);
                                                    {7136}new Ns_5613: bitstring;
                                                    {7137}let gNs_5614: bitstring = exp(g,Ns_5613) in
                                                    {7138}let m2_5615: bitstring = (Cli_5510,gNs_5614) in
                                                    {7139}event beginSrv(Sess_5512,Cli_5510,gNs_5614);
                                                    {7140}out(c, (m2_5615,sign(h(m2_5615),skSess)))
                                    )
                                    else
                                        {7141}let pkDisco_5616: bitstring = fail-any in
                                        {7142}in(c, (=pkCli_5572,m1_5617: bitstring,sigM1_5618: bitstring));
                                        {7143}if (verify(h(m1_5617),sigM1_5618,pkCli_5572) <> true) then
                                            0
                                        else
                                            {7144}let (=Sess_5512,SPc_5619: bitstring,PartC_5620: bitstring) = m1_5617 in
                                            {7145}event endSrv(Cli_5510,Sess_5512,PartC_5620);
                                            {7146}new Ns_5621: bitstring;
                                            {7147}let gNs_5622: bitstring = exp(g,Ns_5621) in
                                            {7148}let m2_5623: bitstring = (Cli_5510,gNs_5622) in
                                            {7149}event beginSrv(Sess_5512,Cli_5510,gNs_5622);
                                            {7150}out(c, (m2_5623,sign(h(m2_5623),skSess)))
                            )
                            else
                                {7151}let pkDisco_5624: bitstring = fail-any in
                                {7152}in(c, (=pkCli_5572,m1_5625: bitstring,sigM1_5626: bitstring));
                                {7153}if (verify(h(m1_5625),sigM1_5626,pkCli_5572) <> true) then
                                    0
                                else
                                    {7154}let (=Sess_5512,SPc_5627: bitstring,PartC_5628: bitstring) = m1_5625 in
                                    {7155}event endSrv(Cli_5510,Sess_5512,PartC_5628);
                                    {7156}new Ns_5629: bitstring;
                                    {7157}let gNs_5630: bitstring = exp(g,Ns_5629) in
                                    {7158}let m2_5631: bitstring = (Cli_5510,gNs_5630) in
                                    {7159}event beginSrv(Sess_5512,Cli_5510,gNs_5630);
                                    {7160}out(c, (m2_5631,sign(h(m2_5631),skSess)))
                        )
                        else
                            {7161}let v_5632: bool = (Cli_5510 = C) in
                            (
                                {7162}if v_5632 then
                                (
                                    {7163}let pkCli_5633: bitstring = pub(skC) in
                                    {7164}let v_5634: bool = (Disco_5511 = A) in
                                    (
                                        {7165}if v_5634 then
                                        (
                                            {7166}let pkDisco_5635: bitstring = pub(skA) in
                                            {7167}in(c, (=pkCli_5633,m1_5636: bitstring,sigM1_5637: bitstring));
                                            {7168}if (verify(h(m1_5636),sigM1_5637,pkCli_5633) <> true) then
                                                0
                                            else
                                                {7169}let (=Sess_5512,SPc_5638: bitstring,PartC_5639: bitstring) = m1_5636 in
                                                {7170}event endSrv(Cli_5510,Sess_5512,PartC_5639);
                                                {7171}new Ns_5640: bitstring;
                                                {7172}let gNs_5641: bitstring = exp(g,Ns_5640) in
                                                {7173}let m2_5642: bitstring = (Cli_5510,gNs_5641) in
                                                {7174}event beginSrv(Sess_5512,Cli_5510,gNs_5641);
                                                {7175}out(c, (m2_5642,sign(h(m2_5642),skSess)))
                                        )
                                        else
                                            {7176}let v_5643: bool = (Disco_5511 = B) in
                                            (
                                                {7177}if v_5643 then
                                                (
                                                    {7178}let pkDisco_5644: bitstring = pub(skB) in
                                                    {7179}in(c, (=pkCli_5633,m1_5645: bitstring,sigM1_5646: bitstring));
                                                    {7180}if (verify(h(m1_5645),sigM1_5646,pkCli_5633) <> true) then
                                                        0
                                                    else
                                                        {7181}let (=Sess_5512,SPc_5647: bitstring,PartC_5648: bitstring) = m1_5645 in
                                                        {7182}event endSrv(Cli_5510,Sess_5512,PartC_5648);
                                                        {7183}new Ns_5649: bitstring;
                                                        {7184}let gNs_5650: bitstring = exp(g,Ns_5649) in
                                                        {7185}let m2_5651: bitstring = (Cli_5510,gNs_5650) in
                                                        {7186}event beginSrv(Sess_5512,Cli_5510,gNs_5650);
                                                        {7187}out(c, (m2_5651,sign(h(m2_5651),skSess)))
                                                )
                                                else
                                                    {7188}let v_5652: bool = (Disco_5511 = C) in
                                                    (
                                                        {7189}if v_5652 then
                                                        (
                                                            {7190}let pkDisco_5653: bitstring = pub(skC) in
                                                            {7191}in(c, (=pkCli_5633,m1_5654: bitstring,sigM1_5655: bitstring));
                                                            {7192}if (verify(h(m1_5654),sigM1_5655,pkCli_5633) <> true) then
                                                                0
                                                            else
                                                                {7193}let (=Sess_5512,SPc_5656: bitstring,PartC_5657: bitstring) = m1_5654 in
                                                                {7194}event endSrv(Cli_5510,Sess_5512,PartC_5657);
                                                                {7195}new Ns_5658: bitstring;
                                                                {7196}let gNs_5659: bitstring = exp(g,Ns_5658) in
                                                                {7197}let m2_5660: bitstring = (Cli_5510,gNs_5659) in
                                                                {7198}event beginSrv(Sess_5512,Cli_5510,gNs_5659);
                                                                {7199}out(c, (m2_5660,sign(h(m2_5660),skSess)))
                                                        )
                                                        else
                                                            {7200}let pkDisco_5661: bitstring = pub(skI) in
                                                            {7201}in(c, (=pkCli_5633,m1_5662: bitstring,sigM1_5663: bitstring));
                                                            {7202}if (verify(h(m1_5662),sigM1_5663,pkCli_5633) <> true) then
                                                                0
                                                            else
                                                                {7203}let (=Sess_5512,SPc_5664: bitstring,PartC_5665: bitstring) = m1_5662 in
                                                                {7204}event endSrv(Cli_5510,Sess_5512,PartC_5665);
                                                                {7205}new Ns_5666: bitstring;
                                                                {7206}let gNs_5667: bitstring = exp(g,Ns_5666) in
                                                                {7207}let m2_5668: bitstring = (Cli_5510,gNs_5667) in
                                                                {7208}event beginSrv(Sess_5512,Cli_5510,gNs_5667);
                                                                {7209}out(c, (m2_5668,sign(h(m2_5668),skSess)))
                                                    )
                                                    else
                                                        {7210}let pkDisco_5669: bitstring = fail-any in
                                                        {7211}in(c, (=pkCli_5633,m1_5670: bitstring,sigM1_5671: bitstring));
                                                        {7212}if (verify(h(m1_5670),sigM1_5671,pkCli_5633) <> true) then
                                                            0
                                                        else
                                                            {7213}let (=Sess_5512,SPc_5672: bitstring,PartC_5673: bitstring) = m1_5670 in
                                                            {7214}event endSrv(Cli_5510,Sess_5512,PartC_5673);
                                                            {7215}new Ns_5674: bitstring;
                                                            {7216}let gNs_5675: bitstring = exp(g,Ns_5674) in
                                                            {7217}let m2_5676: bitstring = (Cli_5510,gNs_5675) in
                                                            {7218}event beginSrv(Sess_5512,Cli_5510,gNs_5675);
                                                            {7219}out(c, (m2_5676,sign(h(m2_5676),skSess)))
                                            )
                                            else
                                                {7220}let pkDisco_5677: bitstring = fail-any in
                                                {7221}in(c, (=pkCli_5633,m1_5678: bitstring,sigM1_5679: bitstring));
                                                {7222}if (verify(h(m1_5678),sigM1_5679,pkCli_5633) <> true) then
                                                    0
                                                else
                                                    {7223}let (=Sess_5512,SPc_5680: bitstring,PartC_5681: bitstring) = m1_5678 in
                                                    {7224}event endSrv(Cli_5510,Sess_5512,PartC_5681);
                                                    {7225}new Ns_5682: bitstring;
                                                    {7226}let gNs_5683: bitstring = exp(g,Ns_5682) in
                                                    {7227}let m2_5684: bitstring = (Cli_5510,gNs_5683) in
                                                    {7228}event beginSrv(Sess_5512,Cli_5510,gNs_5683);
                                                    {7229}out(c, (m2_5684,sign(h(m2_5684),skSess)))
                                    )
                                    else
                                        {7230}let pkDisco_5685: bitstring = fail-any in
                                        {7231}in(c, (=pkCli_5633,m1_5686: bitstring,sigM1_5687: bitstring));
                                        {7232}if (verify(h(m1_5686),sigM1_5687,pkCli_5633) <> true) then
                                            0
                                        else
                                            {7233}let (=Sess_5512,SPc_5688: bitstring,PartC_5689: bitstring) = m1_5686 in
                                            {7234}event endSrv(Cli_5510,Sess_5512,PartC_5689);
                                            {7235}new Ns_5690: bitstring;
                                            {7236}let gNs_5691: bitstring = exp(g,Ns_5690) in
                                            {7237}let m2_5692: bitstring = (Cli_5510,gNs_5691) in
                                            {7238}event beginSrv(Sess_5512,Cli_5510,gNs_5691);
                                            {7239}out(c, (m2_5692,sign(h(m2_5692),skSess)))
                                )
                                else
                                    {7240}let pkCli_5693: bitstring = pub(skI) in
                                    {7241}let v_5694: bool = (Disco_5511 = A) in
                                    (
                                        {7242}if v_5694 then
                                        (
                                            {7243}let pkDisco_5695: bitstring = pub(skA) in
                                            {7244}in(c, (=pkCli_5693,m1_5696: bitstring,sigM1_5697: bitstring));
                                            {7245}if (verify(h(m1_5696),sigM1_5697,pkCli_5693) <> true) then
                                                0
                                            else
                                                {7246}let (=Sess_5512,SPc_5698: bitstring,PartC_5699: bitstring) = m1_5696 in
                                                {7247}event endSrv(Cli_5510,Sess_5512,PartC_5699);
                                                {7248}new Ns_5700: bitstring;
                                                {7249}let gNs_5701: bitstring = exp(g,Ns_5700) in
                                                {7250}let m2_5702: bitstring = (Cli_5510,gNs_5701) in
                                                {7251}event beginSrv(Sess_5512,Cli_5510,gNs_5701);
                                                {7252}out(c, (m2_5702,sign(h(m2_5702),skSess)))
                                        )
                                        else
                                            {7253}let v_5703: bool = (Disco_5511 = B) in
                                            (
                                                {7254}if v_5703 then
                                                (
                                                    {7255}let pkDisco_5704: bitstring = pub(skB) in
                                                    {7256}in(c, (=pkCli_5693,m1_5705: bitstring,sigM1_5706: bitstring));
                                                    {7257}if (verify(h(m1_5705),sigM1_5706,pkCli_5693) <> true) then
                                                        0
                                                    else
                                                        {7258}let (=Sess_5512,SPc_5707: bitstring,PartC_5708: bitstring) = m1_5705 in
                                                        {7259}event endSrv(Cli_5510,Sess_5512,PartC_5708);
                                                        {7260}new Ns_5709: bitstring;
                                                        {7261}let gNs_5710: bitstring = exp(g,Ns_5709) in
                                                        {7262}let m2_5711: bitstring = (Cli_5510,gNs_5710) in
                                                        {7263}event beginSrv(Sess_5512,Cli_5510,gNs_5710);
                                                        {7264}out(c, (m2_5711,sign(h(m2_5711),skSess)))
                                                )
                                                else
                                                    {7265}let v_5712: bool = (Disco_5511 = C) in
                                                    (
                                                        {7266}if v_5712 then
                                                        (
                                                            {7267}let pkDisco_5713: bitstring = pub(skC) in
                                                            {7268}in(c, (=pkCli_5693,m1_5714: bitstring,sigM1_5715: bitstring));
                                                            {7269}if (verify(h(m1_5714),sigM1_5715,pkCli_5693) <> true) then
                                                                0
                                                            else
                                                                {7270}let (=Sess_5512,SPc_5716: bitstring,PartC_5717: bitstring) = m1_5714 in
                                                                {7271}event endSrv(Cli_5510,Sess_5512,PartC_5717);
                                                                {7272}new Ns_5718: bitstring;
                                                                {7273}let gNs_5719: bitstring = exp(g,Ns_5718) in
                                                                {7274}let m2_5720: bitstring = (Cli_5510,gNs_5719) in
                                                                {7275}event beginSrv(Sess_5512,Cli_5510,gNs_5719);
                                                                {7276}out(c, (m2_5720,sign(h(m2_5720),skSess)))
                                                        )
                                                        else
                                                            {7277}let pkDisco_5721: bitstring = pub(skI) in
                                                            {7278}in(c, (=pkCli_5693,m1_5722: bitstring,sigM1_5723: bitstring));
                                                            {7279}if (verify(h(m1_5722),sigM1_5723,pkCli_5693) <> true) then
                                                                0
                                                            else
                                                                {7280}let (=Sess_5512,SPc_5724: bitstring,PartC_5725: bitstring) = m1_5722 in
                                                                {7281}event endSrv(Cli_5510,Sess_5512,PartC_5725);
                                                                {7282}new Ns_5726: bitstring;
                                                                {7283}let gNs_5727: bitstring = exp(g,Ns_5726) in
                                                                {7284}let m2_5728: bitstring = (Cli_5510,gNs_5727) in
                                                                {7285}event beginSrv(Sess_5512,Cli_5510,gNs_5727);
                                                                {7286}out(c, (m2_5728,sign(h(m2_5728),skSess)))
                                                    )
                                                    else
                                                        {7287}let pkDisco_5729: bitstring = fail-any in
                                                        {7288}in(c, (=pkCli_5693,m1_5730: bitstring,sigM1_5731: bitstring));
                                                        {7289}if (verify(h(m1_5730),sigM1_5731,pkCli_5693) <> true) then
                                                            0
                                                        else
                                                            {7290}let (=Sess_5512,SPc_5732: bitstring,PartC_5733: bitstring) = m1_5730 in
                                                            {7291}event endSrv(Cli_5510,Sess_5512,PartC_5733);
                                                            {7292}new Ns_5734: bitstring;
                                                            {7293}let gNs_5735: bitstring = exp(g,Ns_5734) in
                                                            {7294}let m2_5736: bitstring = (Cli_5510,gNs_5735) in
                                                            {7295}event beginSrv(Sess_5512,Cli_5510,gNs_5735);
                                                            {7296}out(c, (m2_5736,sign(h(m2_5736),skSess)))
                                            )
                                            else
                                                {7297}let pkDisco_5737: bitstring = fail-any in
                                                {7298}in(c, (=pkCli_5693,m1_5738: bitstring,sigM1_5739: bitstring));
                                                {7299}if (verify(h(m1_5738),sigM1_5739,pkCli_5693) <> true) then
                                                    0
                                                else
                                                    {7300}let (=Sess_5512,SPc_5740: bitstring,PartC_5741: bitstring) = m1_5738 in
                                                    {7301}event endSrv(Cli_5510,Sess_5512,PartC_5741);
                                                    {7302}new Ns_5742: bitstring;
                                                    {7303}let gNs_5743: bitstring = exp(g,Ns_5742) in
                                                    {7304}let m2_5744: bitstring = (Cli_5510,gNs_5743) in
                                                    {7305}event beginSrv(Sess_5512,Cli_5510,gNs_5743);
                                                    {7306}out(c, (m2_5744,sign(h(m2_5744),skSess)))
                                    )
                                    else
                                        {7307}let pkDisco_5745: bitstring = fail-any in
                                        {7308}in(c, (=pkCli_5693,m1_5746: bitstring,sigM1_5747: bitstring));
                                        {7309}if (verify(h(m1_5746),sigM1_5747,pkCli_5693) <> true) then
                                            0
                                        else
                                            {7310}let (=Sess_5512,SPc_5748: bitstring,PartC_5749: bitstring) = m1_5746 in
                                            {7311}event endSrv(Cli_5510,Sess_5512,PartC_5749);
                                            {7312}new Ns_5750: bitstring;
                                            {7313}let gNs_5751: bitstring = exp(g,Ns_5750) in
                                            {7314}let m2_5752: bitstring = (Cli_5510,gNs_5751) in
                                            {7315}event beginSrv(Sess_5512,Cli_5510,gNs_5751);
                                            {7316}out(c, (m2_5752,sign(h(m2_5752),skSess)))
                            )
                            else
                                {7317}let pkCli_5753: bitstring = fail-any in
                                {7318}let v_5754: bool = (Disco_5511 = A) in
                                (
                                    {7319}if v_5754 then
                                    (
                                        {7320}let pkDisco_5755: bitstring = pub(skA) in
                                        {7321}in(c, (=pkCli_5753,m1_5756: bitstring,sigM1_5757: bitstring));
                                        {7322}if (verify(h(m1_5756),sigM1_5757,pkCli_5753) <> true) then
                                            0
                                        else
                                            {7323}let (=Sess_5512,SPc_5758: bitstring,PartC_5759: bitstring) = m1_5756 in
                                            {7324}event endSrv(Cli_5510,Sess_5512,PartC_5759);
                                            {7325}new Ns_5760: bitstring;
                                            {7326}let gNs_5761: bitstring = exp(g,Ns_5760) in
                                            {7327}let m2_5762: bitstring = (Cli_5510,gNs_5761) in
                                            {7328}event beginSrv(Sess_5512,Cli_5510,gNs_5761);
                                            {7329}out(c, (m2_5762,sign(h(m2_5762),skSess)))
                                    )
                                    else
                                        {7330}let v_5763: bool = (Disco_5511 = B) in
                                        (
                                            {7331}if v_5763 then
                                            (
                                                {7332}let pkDisco_5764: bitstring = pub(skB) in
                                                {7333}in(c, (=pkCli_5753,m1_5765: bitstring,sigM1_5766: bitstring));
                                                {7334}if (verify(h(m1_5765),sigM1_5766,pkCli_5753) <> true) then
                                                    0
                                                else
                                                    {7335}let (=Sess_5512,SPc_5767: bitstring,PartC_5768: bitstring) = m1_5765 in
                                                    {7336}event endSrv(Cli_5510,Sess_5512,PartC_5768);
                                                    {7337}new Ns_5769: bitstring;
                                                    {7338}let gNs_5770: bitstring = exp(g,Ns_5769) in
                                                    {7339}let m2_5771: bitstring = (Cli_5510,gNs_5770) in
                                                    {7340}event beginSrv(Sess_5512,Cli_5510,gNs_5770);
                                                    {7341}out(c, (m2_5771,sign(h(m2_5771),skSess)))
                                            )
                                            else
                                                {7342}let v_5772: bool = (Disco_5511 = C) in
                                                (
                                                    {7343}if v_5772 then
                                                    (
                                                        {7344}let pkDisco_5773: bitstring = pub(skC) in
                                                        {7345}in(c, (=pkCli_5753,m1_5774: bitstring,sigM1_5775: bitstring));
                                                        {7346}if (verify(h(m1_5774),sigM1_5775,pkCli_5753) <> true) then
                                                            0
                                                        else
                                                            {7347}let (=Sess_5512,SPc_5776: bitstring,PartC_5777: bitstring) = m1_5774 in
                                                            {7348}event endSrv(Cli_5510,Sess_5512,PartC_5777);
                                                            {7349}new Ns_5778: bitstring;
                                                            {7350}let gNs_5779: bitstring = exp(g,Ns_5778) in
                                                            {7351}let m2_5780: bitstring = (Cli_5510,gNs_5779) in
                                                            {7352}event beginSrv(Sess_5512,Cli_5510,gNs_5779);
                                                            {7353}out(c, (m2_5780,sign(h(m2_5780),skSess)))
                                                    )
                                                    else
                                                        {7354}let pkDisco_5781: bitstring = pub(skI) in
                                                        {7355}in(c, (=pkCli_5753,m1_5782: bitstring,sigM1_5783: bitstring));
                                                        {7356}if (verify(h(m1_5782),sigM1_5783,pkCli_5753) <> true) then
                                                            0
                                                        else
                                                            {7357}let (=Sess_5512,SPc_5784: bitstring,PartC_5785: bitstring) = m1_5782 in
                                                            {7358}event endSrv(Cli_5510,Sess_5512,PartC_5785);
                                                            {7359}new Ns_5786: bitstring;
                                                            {7360}let gNs_5787: bitstring = exp(g,Ns_5786) in
                                                            {7361}let m2_5788: bitstring = (Cli_5510,gNs_5787) in
                                                            {7362}event beginSrv(Sess_5512,Cli_5510,gNs_5787);
                                                            {7363}out(c, (m2_5788,sign(h(m2_5788),skSess)))
                                                )
                                                else
                                                    {7364}let pkDisco_5789: bitstring = fail-any in
                                                    {7365}in(c, (=pkCli_5753,m1_5790: bitstring,sigM1_5791: bitstring));
                                                    {7366}if (verify(h(m1_5790),sigM1_5791,pkCli_5753) <> true) then
                                                        0
                                                    else
                                                        {7367}let (=Sess_5512,SPc_5792: bitstring,PartC_5793: bitstring) = m1_5790 in
                                                        {7368}event endSrv(Cli_5510,Sess_5512,PartC_5793);
                                                        {7369}new Ns_5794: bitstring;
                                                        {7370}let gNs_5795: bitstring = exp(g,Ns_5794) in
                                                        {7371}let m2_5796: bitstring = (Cli_5510,gNs_5795) in
                                                        {7372}event beginSrv(Sess_5512,Cli_5510,gNs_5795);
                                                        {7373}out(c, (m2_5796,sign(h(m2_5796),skSess)))
                                        )
                                        else
                                            {7374}let pkDisco_5797: bitstring = fail-any in
                                            {7375}in(c, (=pkCli_5753,m1_5798: bitstring,sigM1_5799: bitstring));
                                            {7376}if (verify(h(m1_5798),sigM1_5799,pkCli_5753) <> true) then
                                                0
                                            else
                                                {7377}let (=Sess_5512,SPc_5800: bitstring,PartC_5801: bitstring) = m1_5798 in
                                                {7378}event endSrv(Cli_5510,Sess_5512,PartC_5801);
                                                {7379}new Ns_5802: bitstring;
                                                {7380}let gNs_5803: bitstring = exp(g,Ns_5802) in
                                                {7381}let m2_5804: bitstring = (Cli_5510,gNs_5803) in
                                                {7382}event beginSrv(Sess_5512,Cli_5510,gNs_5803);
                                                {7383}out(c, (m2_5804,sign(h(m2_5804),skSess)))
                                )
                                else
                                    {7384}let pkDisco_5805: bitstring = fail-any in
                                    {7385}in(c, (=pkCli_5753,m1_5806: bitstring,sigM1_5807: bitstring));
                                    {7386}if (verify(h(m1_5806),sigM1_5807,pkCli_5753) <> true) then
                                        0
                                    else
                                        {7387}let (=Sess_5512,SPc_5808: bitstring,PartC_5809: bitstring) = m1_5806 in
                                        {7388}event endSrv(Cli_5510,Sess_5512,PartC_5809);
                                        {7389}new Ns_5810: bitstring;
                                        {7390}let gNs_5811: bitstring = exp(g,Ns_5810) in
                                        {7391}let m2_5812: bitstring = (Cli_5510,gNs_5811) in
                                        {7392}event beginSrv(Sess_5512,Cli_5510,gNs_5811);
                                        {7393}out(c, (m2_5812,sign(h(m2_5812),skSess)))
                    )
                    else
                        {7394}let pkCli_5813: bitstring = fail-any in
                        {7395}let v_5814: bool = (Disco_5511 = A) in
                        (
                            {7396}if v_5814 then
                            (
                                {7397}let pkDisco_5815: bitstring = pub(skA) in
                                {7398}in(c, (=pkCli_5813,m1_5816: bitstring,sigM1_5817: bitstring));
                                {7399}if (verify(h(m1_5816),sigM1_5817,pkCli_5813) <> true) then
                                    0
                                else
                                    {7400}let (=Sess_5512,SPc_5818: bitstring,PartC_5819: bitstring) = m1_5816 in
                                    {7401}event endSrv(Cli_5510,Sess_5512,PartC_5819);
                                    {7402}new Ns_5820: bitstring;
                                    {7403}let gNs_5821: bitstring = exp(g,Ns_5820) in
                                    {7404}let m2_5822: bitstring = (Cli_5510,gNs_5821) in
                                    {7405}event beginSrv(Sess_5512,Cli_5510,gNs_5821);
                                    {7406}out(c, (m2_5822,sign(h(m2_5822),skSess)))
                            )
                            else
                                {7407}let v_5823: bool = (Disco_5511 = B) in
                                (
                                    {7408}if v_5823 then
                                    (
                                        {7409}let pkDisco_5824: bitstring = pub(skB) in
                                        {7410}in(c, (=pkCli_5813,m1_5825: bitstring,sigM1_5826: bitstring));
                                        {7411}if (verify(h(m1_5825),sigM1_5826,pkCli_5813) <> true) then
                                            0
                                        else
                                            {7412}let (=Sess_5512,SPc_5827: bitstring,PartC_5828: bitstring) = m1_5825 in
                                            {7413}event endSrv(Cli_5510,Sess_5512,PartC_5828);
                                            {7414}new Ns_5829: bitstring;
                                            {7415}let gNs_5830: bitstring = exp(g,Ns_5829) in
                                            {7416}let m2_5831: bitstring = (Cli_5510,gNs_5830) in
                                            {7417}event beginSrv(Sess_5512,Cli_5510,gNs_5830);
                                            {7418}out(c, (m2_5831,sign(h(m2_5831),skSess)))
                                    )
                                    else
                                        {7419}let v_5832: bool = (Disco_5511 = C) in
                                        (
                                            {7420}if v_5832 then
                                            (
                                                {7421}let pkDisco_5833: bitstring = pub(skC) in
                                                {7422}in(c, (=pkCli_5813,m1_5834: bitstring,sigM1_5835: bitstring));
                                                {7423}if (verify(h(m1_5834),sigM1_5835,pkCli_5813) <> true) then
                                                    0
                                                else
                                                    {7424}let (=Sess_5512,SPc_5836: bitstring,PartC_5837: bitstring) = m1_5834 in
                                                    {7425}event endSrv(Cli_5510,Sess_5512,PartC_5837);
                                                    {7426}new Ns_5838: bitstring;
                                                    {7427}let gNs_5839: bitstring = exp(g,Ns_5838) in
                                                    {7428}let m2_5840: bitstring = (Cli_5510,gNs_5839) in
                                                    {7429}event beginSrv(Sess_5512,Cli_5510,gNs_5839);
                                                    {7430}out(c, (m2_5840,sign(h(m2_5840),skSess)))
                                            )
                                            else
                                                {7431}let pkDisco_5841: bitstring = pub(skI) in
                                                {7432}in(c, (=pkCli_5813,m1_5842: bitstring,sigM1_5843: bitstring));
                                                {7433}if (verify(h(m1_5842),sigM1_5843,pkCli_5813) <> true) then
                                                    0
                                                else
                                                    {7434}let (=Sess_5512,SPc_5844: bitstring,PartC_5845: bitstring) = m1_5842 in
                                                    {7435}event endSrv(Cli_5510,Sess_5512,PartC_5845);
                                                    {7436}new Ns_5846: bitstring;
                                                    {7437}let gNs_5847: bitstring = exp(g,Ns_5846) in
                                                    {7438}let m2_5848: bitstring = (Cli_5510,gNs_5847) in
                                                    {7439}event beginSrv(Sess_5512,Cli_5510,gNs_5847);
                                                    {7440}out(c, (m2_5848,sign(h(m2_5848),skSess)))
                                        )
                                        else
                                            {7441}let pkDisco_5849: bitstring = fail-any in
                                            {7442}in(c, (=pkCli_5813,m1_5850: bitstring,sigM1_5851: bitstring));
                                            {7443}if (verify(h(m1_5850),sigM1_5851,pkCli_5813) <> true) then
                                                0
                                            else
                                                {7444}let (=Sess_5512,SPc_5852: bitstring,PartC_5853: bitstring) = m1_5850 in
                                                {7445}event endSrv(Cli_5510,Sess_5512,PartC_5853);
                                                {7446}new Ns_5854: bitstring;
                                                {7447}let gNs_5855: bitstring = exp(g,Ns_5854) in
                                                {7448}let m2_5856: bitstring = (Cli_5510,gNs_5855) in
                                                {7449}event beginSrv(Sess_5512,Cli_5510,gNs_5855);
                                                {7450}out(c, (m2_5856,sign(h(m2_5856),skSess)))
                                )
                                else
                                    {7451}let pkDisco_5857: bitstring = fail-any in
                                    {7452}in(c, (=pkCli_5813,m1_5858: bitstring,sigM1_5859: bitstring));
                                    {7453}if (verify(h(m1_5858),sigM1_5859,pkCli_5813) <> true) then
                                        0
                                    else
                                        {7454}let (=Sess_5512,SPc_5860: bitstring,PartC_5861: bitstring) = m1_5858 in
                                        {7455}event endSrv(Cli_5510,Sess_5512,PartC_5861);
                                        {7456}new Ns_5862: bitstring;
                                        {7457}let gNs_5863: bitstring = exp(g,Ns_5862) in
                                        {7458}let m2_5864: bitstring = (Cli_5510,gNs_5863) in
                                        {7459}event beginSrv(Sess_5512,Cli_5510,gNs_5863);
                                        {7460}out(c, (m2_5864,sign(h(m2_5864),skSess)))
                        )
                        else
                            {7461}let pkDisco_5865: bitstring = fail-any in
                            {7462}in(c, (=pkCli_5813,m1_5866: bitstring,sigM1_5867: bitstring));
                            {7463}if (verify(h(m1_5866),sigM1_5867,pkCli_5813) <> true) then
                                0
                            else
                                {7464}let (=Sess_5512,SPc_5868: bitstring,PartC_5869: bitstring) = m1_5866 in
                                {7465}event endSrv(Cli_5510,Sess_5512,PartC_5869);
                                {7466}new Ns_5870: bitstring;
                                {7467}let gNs_5871: bitstring = exp(g,Ns_5870) in
                                {7468}let m2_5872: bitstring = (Cli_5510,gNs_5871) in
                                {7469}event beginSrv(Sess_5512,Cli_5510,gNs_5871);
                                {7470}out(c, (m2_5872,sign(h(m2_5872),skSess)))
            )
            else
                {7471}let pkCli_5873: bitstring = fail-any in
                {7472}let v_5874: bool = (Disco_5511 = A) in
                (
                    {7473}if v_5874 then
                    (
                        {7474}let pkDisco_5875: bitstring = pub(skA) in
                        {7475}in(c, (=pkCli_5873,m1_5876: bitstring,sigM1_5877: bitstring));
                        {7476}if (verify(h(m1_5876),sigM1_5877,pkCli_5873) <> true) then
                            0
                        else
                            {7477}let (=Sess_5512,SPc_5878: bitstring,PartC_5879: bitstring) = m1_5876 in
                            {7478}event endSrv(Cli_5510,Sess_5512,PartC_5879);
                            {7479}new Ns_5880: bitstring;
                            {7480}let gNs_5881: bitstring = exp(g,Ns_5880) in
                            {7481}let m2_5882: bitstring = (Cli_5510,gNs_5881) in
                            {7482}event beginSrv(Sess_5512,Cli_5510,gNs_5881);
                            {7483}out(c, (m2_5882,sign(h(m2_5882),skSess)))
                    )
                    else
                        {7484}let v_5883: bool = (Disco_5511 = B) in
                        (
                            {7485}if v_5883 then
                            (
                                {7486}let pkDisco_5884: bitstring = pub(skB) in
                                {7487}in(c, (=pkCli_5873,m1_5885: bitstring,sigM1_5886: bitstring));
                                {7488}if (verify(h(m1_5885),sigM1_5886,pkCli_5873) <> true) then
                                    0
                                else
                                    {7489}let (=Sess_5512,SPc_5887: bitstring,PartC_5888: bitstring) = m1_5885 in
                                    {7490}event endSrv(Cli_5510,Sess_5512,PartC_5888);
                                    {7491}new Ns_5889: bitstring;
                                    {7492}let gNs_5890: bitstring = exp(g,Ns_5889) in
                                    {7493}let m2_5891: bitstring = (Cli_5510,gNs_5890) in
                                    {7494}event beginSrv(Sess_5512,Cli_5510,gNs_5890);
                                    {7495}out(c, (m2_5891,sign(h(m2_5891),skSess)))
                            )
                            else
                                {7496}let v_5892: bool = (Disco_5511 = C) in
                                (
                                    {7497}if v_5892 then
                                    (
                                        {7498}let pkDisco_5893: bitstring = pub(skC) in
                                        {7499}in(c, (=pkCli_5873,m1_5894: bitstring,sigM1_5895: bitstring));
                                        {7500}if (verify(h(m1_5894),sigM1_5895,pkCli_5873) <> true) then
                                            0
                                        else
                                            {7501}let (=Sess_5512,SPc_5896: bitstring,PartC_5897: bitstring) = m1_5894 in
                                            {7502}event endSrv(Cli_5510,Sess_5512,PartC_5897);
                                            {7503}new Ns_5898: bitstring;
                                            {7504}let gNs_5899: bitstring = exp(g,Ns_5898) in
                                            {7505}let m2_5900: bitstring = (Cli_5510,gNs_5899) in
                                            {7506}event beginSrv(Sess_5512,Cli_5510,gNs_5899);
                                            {7507}out(c, (m2_5900,sign(h(m2_5900),skSess)))
                                    )
                                    else
                                        {7508}let pkDisco_5901: bitstring = pub(skI) in
                                        {7509}in(c, (=pkCli_5873,m1_5902: bitstring,sigM1_5903: bitstring));
                                        {7510}if (verify(h(m1_5902),sigM1_5903,pkCli_5873) <> true) then
                                            0
                                        else
                                            {7511}let (=Sess_5512,SPc_5904: bitstring,PartC_5905: bitstring) = m1_5902 in
                                            {7512}event endSrv(Cli_5510,Sess_5512,PartC_5905);
                                            {7513}new Ns_5906: bitstring;
                                            {7514}let gNs_5907: bitstring = exp(g,Ns_5906) in
                                            {7515}let m2_5908: bitstring = (Cli_5510,gNs_5907) in
                                            {7516}event beginSrv(Sess_5512,Cli_5510,gNs_5907);
                                            {7517}out(c, (m2_5908,sign(h(m2_5908),skSess)))
                                )
                                else
                                    {7518}let pkDisco_5909: bitstring = fail-any in
                                    {7519}in(c, (=pkCli_5873,m1_5910: bitstring,sigM1_5911: bitstring));
                                    {7520}if (verify(h(m1_5910),sigM1_5911,pkCli_5873) <> true) then
                                        0
                                    else
                                        {7521}let (=Sess_5512,SPc_5912: bitstring,PartC_5913: bitstring) = m1_5910 in
                                        {7522}event endSrv(Cli_5510,Sess_5512,PartC_5913);
                                        {7523}new Ns_5914: bitstring;
                                        {7524}let gNs_5915: bitstring = exp(g,Ns_5914) in
                                        {7525}let m2_5916: bitstring = (Cli_5510,gNs_5915) in
                                        {7526}event beginSrv(Sess_5512,Cli_5510,gNs_5915);
                                        {7527}out(c, (m2_5916,sign(h(m2_5916),skSess)))
                        )
                        else
                            {7528}let pkDisco_5917: bitstring = fail-any in
                            {7529}in(c, (=pkCli_5873,m1_5918: bitstring,sigM1_5919: bitstring));
                            {7530}if (verify(h(m1_5918),sigM1_5919,pkCli_5873) <> true) then
                                0
                            else
                                {7531}let (=Sess_5512,SPc_5920: bitstring,PartC_5921: bitstring) = m1_5918 in
                                {7532}event endSrv(Cli_5510,Sess_5512,PartC_5921);
                                {7533}new Ns_5922: bitstring;
                                {7534}let gNs_5923: bitstring = exp(g,Ns_5922) in
                                {7535}let m2_5924: bitstring = (Cli_5510,gNs_5923) in
                                {7536}event beginSrv(Sess_5512,Cli_5510,gNs_5923);
                                {7537}out(c, (m2_5924,sign(h(m2_5924),skSess)))
                )
                else
                    {7538}let pkDisco_5925: bitstring = fail-any in
                    {7539}in(c, (=pkCli_5873,m1_5926: bitstring,sigM1_5927: bitstring));
                    {7540}if (verify(h(m1_5926),sigM1_5927,pkCli_5873) <> true) then
                        0
                    else
                        {7541}let (=Sess_5512,SPc_5928: bitstring,PartC_5929: bitstring) = m1_5926 in
                        {7542}event endSrv(Cli_5510,Sess_5512,PartC_5929);
                        {7543}new Ns_5930: bitstring;
                        {7544}let gNs_5931: bitstring = exp(g,Ns_5930) in
                        {7545}let m2_5932: bitstring = (Cli_5510,gNs_5931) in
                        {7546}event beginSrv(Sess_5512,Cli_5510,gNs_5931);
                        {7547}out(c, (m2_5932,sign(h(m2_5932),skSess)))
        )
        else
            {7548}let v_5933: bool = (Sess_5512 = B) in
            (
                {7549}if v_5933 then
                (
                    {7550}let skSess_5934: bitstring = skB in
                    {7551}let pkSess_5935: bitstring = pub(skSess_5934) in
                    {7552}let v_5936: bool = (Cli_5510 = A) in
                    (
                        {7553}if v_5936 then
                        (
                            {7554}let pkCli_5937: bitstring = pub(skA) in
                            {7555}let v_5938: bool = (Disco_5511 = A) in
                            (
                                {7556}if v_5938 then
                                (
                                    {7557}let pkDisco_5939: bitstring = pub(skA) in
                                    {7558}in(c, (=pkCli_5937,m1_5940: bitstring,sigM1_5941: bitstring));
                                    {7559}if (verify(h(m1_5940),sigM1_5941,pkCli_5937) <> true) then
                                        0
                                    else
                                        {7560}let (=Sess_5512,SPc_5942: bitstring,PartC_5943: bitstring) = m1_5940 in
                                        {7561}event endSrv(Cli_5510,Sess_5512,PartC_5943);
                                        {7562}new Ns_5944: bitstring;
                                        {7563}let gNs_5945: bitstring = exp(g,Ns_5944) in
                                        {7564}let m2_5946: bitstring = (Cli_5510,gNs_5945) in
                                        {7565}event beginSrv(Sess_5512,Cli_5510,gNs_5945);
                                        {7566}out(c, (m2_5946,sign(h(m2_5946),skSess_5934)))
                                )
                                else
                                    {7567}let v_5947: bool = (Disco_5511 = B) in
                                    (
                                        {7568}if v_5947 then
                                        (
                                            {7569}let pkDisco_5948: bitstring = pub(skB) in
                                            {7570}in(c, (=pkCli_5937,m1_5949: bitstring,sigM1_5950: bitstring));
                                            {7571}if (verify(h(m1_5949),sigM1_5950,pkCli_5937) <> true) then
                                                0
                                            else
                                                {7572}let (=Sess_5512,SPc_5951: bitstring,PartC_5952: bitstring) = m1_5949 in
                                                {7573}event endSrv(Cli_5510,Sess_5512,PartC_5952);
                                                {7574}new Ns_5953: bitstring;
                                                {7575}let gNs_5954: bitstring = exp(g,Ns_5953) in
                                                {7576}let m2_5955: bitstring = (Cli_5510,gNs_5954) in
                                                {7577}event beginSrv(Sess_5512,Cli_5510,gNs_5954);
                                                {7578}out(c, (m2_5955,sign(h(m2_5955),skSess_5934)))
                                        )
                                        else
                                            {7579}let v_5956: bool = (Disco_5511 = C) in
                                            (
                                                {7580}if v_5956 then
                                                (
                                                    {7581}let pkDisco_5957: bitstring = pub(skC) in
                                                    {7582}in(c, (=pkCli_5937,m1_5958: bitstring,sigM1_5959: bitstring));
                                                    {7583}if (verify(h(m1_5958),sigM1_5959,pkCli_5937) <> true) then
                                                        0
                                                    else
                                                        {7584}let (=Sess_5512,SPc_5960: bitstring,PartC_5961: bitstring) = m1_5958 in
                                                        {7585}event endSrv(Cli_5510,Sess_5512,PartC_5961);
                                                        {7586}new Ns_5962: bitstring;
                                                        {7587}let gNs_5963: bitstring = exp(g,Ns_5962) in
                                                        {7588}let m2_5964: bitstring = (Cli_5510,gNs_5963) in
                                                        {7589}event beginSrv(Sess_5512,Cli_5510,gNs_5963);
                                                        {7590}out(c, (m2_5964,sign(h(m2_5964),skSess_5934)))
                                                )
                                                else
                                                    {7591}let pkDisco_5965: bitstring = pub(skI) in
                                                    {7592}in(c, (=pkCli_5937,m1_5966: bitstring,sigM1_5967: bitstring));
                                                    {7593}if (verify(h(m1_5966),sigM1_5967,pkCli_5937) <> true) then
                                                        0
                                                    else
                                                        {7594}let (=Sess_5512,SPc_5968: bitstring,PartC_5969: bitstring) = m1_5966 in
                                                        {7595}event endSrv(Cli_5510,Sess_5512,PartC_5969);
                                                        {7596}new Ns_5970: bitstring;
                                                        {7597}let gNs_5971: bitstring = exp(g,Ns_5970) in
                                                        {7598}let m2_5972: bitstring = (Cli_5510,gNs_5971) in
                                                        {7599}event beginSrv(Sess_5512,Cli_5510,gNs_5971);
                                                        {7600}out(c, (m2_5972,sign(h(m2_5972),skSess_5934)))
                                            )
                                            else
                                                {7601}let pkDisco_5973: bitstring = fail-any in
                                                {7602}in(c, (=pkCli_5937,m1_5974: bitstring,sigM1_5975: bitstring));
                                                {7603}if (verify(h(m1_5974),sigM1_5975,pkCli_5937) <> true) then
                                                    0
                                                else
                                                    {7604}let (=Sess_5512,SPc_5976: bitstring,PartC_5977: bitstring) = m1_5974 in
                                                    {7605}event endSrv(Cli_5510,Sess_5512,PartC_5977);
                                                    {7606}new Ns_5978: bitstring;
                                                    {7607}let gNs_5979: bitstring = exp(g,Ns_5978) in
                                                    {7608}let m2_5980: bitstring = (Cli_5510,gNs_5979) in
                                                    {7609}event beginSrv(Sess_5512,Cli_5510,gNs_5979);
                                                    {7610}out(c, (m2_5980,sign(h(m2_5980),skSess_5934)))
                                    )
                                    else
                                        {7611}let pkDisco_5981: bitstring = fail-any in
                                        {7612}in(c, (=pkCli_5937,m1_5982: bitstring,sigM1_5983: bitstring));
                                        {7613}if (verify(h(m1_5982),sigM1_5983,pkCli_5937) <> true) then
                                            0
                                        else
                                            {7614}let (=Sess_5512,SPc_5984: bitstring,PartC_5985: bitstring) = m1_5982 in
                                            {7615}event endSrv(Cli_5510,Sess_5512,PartC_5985);
                                            {7616}new Ns_5986: bitstring;
                                            {7617}let gNs_5987: bitstring = exp(g,Ns_5986) in
                                            {7618}let m2_5988: bitstring = (Cli_5510,gNs_5987) in
                                            {7619}event beginSrv(Sess_5512,Cli_5510,gNs_5987);
                                            {7620}out(c, (m2_5988,sign(h(m2_5988),skSess_5934)))
                            )
                            else
                                {7621}let pkDisco_5989: bitstring = fail-any in
                                {7622}in(c, (=pkCli_5937,m1_5990: bitstring,sigM1_5991: bitstring));
                                {7623}if (verify(h(m1_5990),sigM1_5991,pkCli_5937) <> true) then
                                    0
                                else
                                    {7624}let (=Sess_5512,SPc_5992: bitstring,PartC_5993: bitstring) = m1_5990 in
                                    {7625}event endSrv(Cli_5510,Sess_5512,PartC_5993);
                                    {7626}new Ns_5994: bitstring;
                                    {7627}let gNs_5995: bitstring = exp(g,Ns_5994) in
                                    {7628}let m2_5996: bitstring = (Cli_5510,gNs_5995) in
                                    {7629}event beginSrv(Sess_5512,Cli_5510,gNs_5995);
                                    {7630}out(c, (m2_5996,sign(h(m2_5996),skSess_5934)))
                        )
                        else
                            {7631}let v_5997: bool = (Cli_5510 = B) in
                            (
                                {7632}if v_5997 then
                                (
                                    {7633}let pkCli_5998: bitstring = pub(skB) in
                                    {7634}let v_5999: bool = (Disco_5511 = A) in
                                    (
                                        {7635}if v_5999 then
                                        (
                                            {7636}let pkDisco_6000: bitstring = pub(skA) in
                                            {7637}in(c, (=pkCli_5998,m1_6001: bitstring,sigM1_6002: bitstring));
                                            {7638}if (verify(h(m1_6001),sigM1_6002,pkCli_5998) <> true) then
                                                0
                                            else
                                                {7639}let (=Sess_5512,SPc_6003: bitstring,PartC_6004: bitstring) = m1_6001 in
                                                {7640}event endSrv(Cli_5510,Sess_5512,PartC_6004);
                                                {7641}new Ns_6005: bitstring;
                                                {7642}let gNs_6006: bitstring = exp(g,Ns_6005) in
                                                {7643}let m2_6007: bitstring = (Cli_5510,gNs_6006) in
                                                {7644}event beginSrv(Sess_5512,Cli_5510,gNs_6006);
                                                {7645}out(c, (m2_6007,sign(h(m2_6007),skSess_5934)))
                                        )
                                        else
                                            {7646}let v_6008: bool = (Disco_5511 = B) in
                                            (
                                                {7647}if v_6008 then
                                                (
                                                    {7648}let pkDisco_6009: bitstring = pub(skB) in
                                                    {7649}in(c, (=pkCli_5998,m1_6010: bitstring,sigM1_6011: bitstring));
                                                    {7650}if (verify(h(m1_6010),sigM1_6011,pkCli_5998) <> true) then
                                                        0
                                                    else
                                                        {7651}let (=Sess_5512,SPc_6012: bitstring,PartC_6013: bitstring) = m1_6010 in
                                                        {7652}event endSrv(Cli_5510,Sess_5512,PartC_6013);
                                                        {7653}new Ns_6014: bitstring;
                                                        {7654}let gNs_6015: bitstring = exp(g,Ns_6014) in
                                                        {7655}let m2_6016: bitstring = (Cli_5510,gNs_6015) in
                                                        {7656}event beginSrv(Sess_5512,Cli_5510,gNs_6015);
                                                        {7657}out(c, (m2_6016,sign(h(m2_6016),skSess_5934)))
                                                )
                                                else
                                                    {7658}let v_6017: bool = (Disco_5511 = C) in
                                                    (
                                                        {7659}if v_6017 then
                                                        (
                                                            {7660}let pkDisco_6018: bitstring = pub(skC) in
                                                            {7661}in(c, (=pkCli_5998,m1_6019: bitstring,sigM1_6020: bitstring));
                                                            {7662}if (verify(h(m1_6019),sigM1_6020,pkCli_5998) <> true) then
                                                                0
                                                            else
                                                                {7663}let (=Sess_5512,SPc_6021: bitstring,PartC_6022: bitstring) = m1_6019 in
                                                                {7664}event endSrv(Cli_5510,Sess_5512,PartC_6022);
                                                                {7665}new Ns_6023: bitstring;
                                                                {7666}let gNs_6024: bitstring = exp(g,Ns_6023) in
                                                                {7667}let m2_6025: bitstring = (Cli_5510,gNs_6024) in
                                                                {7668}event beginSrv(Sess_5512,Cli_5510,gNs_6024);
                                                                {7669}out(c, (m2_6025,sign(h(m2_6025),skSess_5934)))
                                                        )
                                                        else
                                                            {7670}let pkDisco_6026: bitstring = pub(skI) in
                                                            {7671}in(c, (=pkCli_5998,m1_6027: bitstring,sigM1_6028: bitstring));
                                                            {7672}if (verify(h(m1_6027),sigM1_6028,pkCli_5998) <> true) then
                                                                0
                                                            else
                                                                {7673}let (=Sess_5512,SPc_6029: bitstring,PartC_6030: bitstring) = m1_6027 in
                                                                {7674}event endSrv(Cli_5510,Sess_5512,PartC_6030);
                                                                {7675}new Ns_6031: bitstring;
                                                                {7676}let gNs_6032: bitstring = exp(g,Ns_6031) in
                                                                {7677}let m2_6033: bitstring = (Cli_5510,gNs_6032) in
                                                                {7678}event beginSrv(Sess_5512,Cli_5510,gNs_6032);
                                                                {7679}out(c, (m2_6033,sign(h(m2_6033),skSess_5934)))
                                                    )
                                                    else
                                                        {7680}let pkDisco_6034: bitstring = fail-any in
                                                        {7681}in(c, (=pkCli_5998,m1_6035: bitstring,sigM1_6036: bitstring));
                                                        {7682}if (verify(h(m1_6035),sigM1_6036,pkCli_5998) <> true) then
                                                            0
                                                        else
                                                            {7683}let (=Sess_5512,SPc_6037: bitstring,PartC_6038: bitstring) = m1_6035 in
                                                            {7684}event endSrv(Cli_5510,Sess_5512,PartC_6038);
                                                            {7685}new Ns_6039: bitstring;
                                                            {7686}let gNs_6040: bitstring = exp(g,Ns_6039) in
                                                            {7687}let m2_6041: bitstring = (Cli_5510,gNs_6040) in
                                                            {7688}event beginSrv(Sess_5512,Cli_5510,gNs_6040);
                                                            {7689}out(c, (m2_6041,sign(h(m2_6041),skSess_5934)))
                                            )
                                            else
                                                {7690}let pkDisco_6042: bitstring = fail-any in
                                                {7691}in(c, (=pkCli_5998,m1_6043: bitstring,sigM1_6044: bitstring));
                                                {7692}if (verify(h(m1_6043),sigM1_6044,pkCli_5998) <> true) then
                                                    0
                                                else
                                                    {7693}let (=Sess_5512,SPc_6045: bitstring,PartC_6046: bitstring) = m1_6043 in
                                                    {7694}event endSrv(Cli_5510,Sess_5512,PartC_6046);
                                                    {7695}new Ns_6047: bitstring;
                                                    {7696}let gNs_6048: bitstring = exp(g,Ns_6047) in
                                                    {7697}let m2_6049: bitstring = (Cli_5510,gNs_6048) in
                                                    {7698}event beginSrv(Sess_5512,Cli_5510,gNs_6048);
                                                    {7699}out(c, (m2_6049,sign(h(m2_6049),skSess_5934)))
                                    )
                                    else
                                        {7700}let pkDisco_6050: bitstring = fail-any in
                                        {7701}in(c, (=pkCli_5998,m1_6051: bitstring,sigM1_6052: bitstring));
                                        {7702}if (verify(h(m1_6051),sigM1_6052,pkCli_5998) <> true) then
                                            0
                                        else
                                            {7703}let (=Sess_5512,SPc_6053: bitstring,PartC_6054: bitstring) = m1_6051 in
                                            {7704}event endSrv(Cli_5510,Sess_5512,PartC_6054);
                                            {7705}new Ns_6055: bitstring;
                                            {7706}let gNs_6056: bitstring = exp(g,Ns_6055) in
                                            {7707}let m2_6057: bitstring = (Cli_5510,gNs_6056) in
                                            {7708}event beginSrv(Sess_5512,Cli_5510,gNs_6056);
                                            {7709}out(c, (m2_6057,sign(h(m2_6057),skSess_5934)))
                                )
                                else
                                    {7710}let v_6058: bool = (Cli_5510 = C) in
                                    (
                                        {7711}if v_6058 then
                                        (
                                            {7712}let pkCli_6059: bitstring = pub(skC) in
                                            {7713}let v_6060: bool = (Disco_5511 = A) in
                                            (
                                                {7714}if v_6060 then
                                                (
                                                    {7715}let pkDisco_6061: bitstring = pub(skA) in
                                                    {7716}in(c, (=pkCli_6059,m1_6062: bitstring,sigM1_6063: bitstring));
                                                    {7717}if (verify(h(m1_6062),sigM1_6063,pkCli_6059) <> true) then
                                                        0
                                                    else
                                                        {7718}let (=Sess_5512,SPc_6064: bitstring,PartC_6065: bitstring) = m1_6062 in
                                                        {7719}event endSrv(Cli_5510,Sess_5512,PartC_6065);
                                                        {7720}new Ns_6066: bitstring;
                                                        {7721}let gNs_6067: bitstring = exp(g,Ns_6066) in
                                                        {7722}let m2_6068: bitstring = (Cli_5510,gNs_6067) in
                                                        {7723}event beginSrv(Sess_5512,Cli_5510,gNs_6067);
                                                        {7724}out(c, (m2_6068,sign(h(m2_6068),skSess_5934)))
                                                )
                                                else
                                                    {7725}let v_6069: bool = (Disco_5511 = B) in
                                                    (
                                                        {7726}if v_6069 then
                                                        (
                                                            {7727}let pkDisco_6070: bitstring = pub(skB) in
                                                            {7728}in(c, (=pkCli_6059,m1_6071: bitstring,sigM1_6072: bitstring));
                                                            {7729}if (verify(h(m1_6071),sigM1_6072,pkCli_6059) <> true) then
                                                                0
                                                            else
                                                                {7730}let (=Sess_5512,SPc_6073: bitstring,PartC_6074: bitstring) = m1_6071 in
                                                                {7731}event endSrv(Cli_5510,Sess_5512,PartC_6074);
                                                                {7732}new Ns_6075: bitstring;
                                                                {7733}let gNs_6076: bitstring = exp(g,Ns_6075) in
                                                                {7734}let m2_6077: bitstring = (Cli_5510,gNs_6076) in
                                                                {7735}event beginSrv(Sess_5512,Cli_5510,gNs_6076);
                                                                {7736}out(c, (m2_6077,sign(h(m2_6077),skSess_5934)))
                                                        )
                                                        else
                                                            {7737}let v_6078: bool = (Disco_5511 = C) in
                                                            (
                                                                {7738}if v_6078 then
                                                                (
                                                                    {7739}let pkDisco_6079: bitstring = pub(skC) in
                                                                    {7740}in(c, (=pkCli_6059,m1_6080: bitstring,sigM1_6081: bitstring));
                                                                    {7741}if (verify(h(m1_6080),sigM1_6081,pkCli_6059) <> true) then
                                                                        0
                                                                    else
                                                                        {7742}let (=Sess_5512,SPc_6082: bitstring,PartC_6083: bitstring) = m1_6080 in
                                                                        {7743}event endSrv(Cli_5510,Sess_5512,PartC_6083);
                                                                        {7744}new Ns_6084: bitstring;
                                                                        {7745}let gNs_6085: bitstring = exp(g,Ns_6084) in
                                                                        {7746}let m2_6086: bitstring = (Cli_5510,gNs_6085) in
                                                                        {7747}event beginSrv(Sess_5512,Cli_5510,gNs_6085);
                                                                        {7748}out(c, (m2_6086,sign(h(m2_6086),skSess_5934)))
                                                                )
                                                                else
                                                                    {7749}let pkDisco_6087: bitstring = pub(skI) in
                                                                    {7750}in(c, (=pkCli_6059,m1_6088: bitstring,sigM1_6089: bitstring));
                                                                    {7751}if (verify(h(m1_6088),sigM1_6089,pkCli_6059) <> true) then
                                                                        0
                                                                    else
                                                                        {7752}let (=Sess_5512,SPc_6090: bitstring,PartC_6091: bitstring) = m1_6088 in
                                                                        {7753}event endSrv(Cli_5510,Sess_5512,PartC_6091);
                                                                        {7754}new Ns_6092: bitstring;
                                                                        {7755}let gNs_6093: bitstring = exp(g,Ns_6092) in
                                                                        {7756}let m2_6094: bitstring = (Cli_5510,gNs_6093) in
                                                                        {7757}event beginSrv(Sess_5512,Cli_5510,gNs_6093);
                                                                        {7758}out(c, (m2_6094,sign(h(m2_6094),skSess_5934)))
                                                            )
                                                            else
                                                                {7759}let pkDisco_6095: bitstring = fail-any in
                                                                {7760}in(c, (=pkCli_6059,m1_6096: bitstring,sigM1_6097: bitstring));
                                                                {7761}if (verify(h(m1_6096),sigM1_6097,pkCli_6059) <> true) then
                                                                    0
                                                                else
                                                                    {7762}let (=Sess_5512,SPc_6098: bitstring,PartC_6099: bitstring) = m1_6096 in
                                                                    {7763}event endSrv(Cli_5510,Sess_5512,PartC_6099);
                                                                    {7764}new Ns_6100: bitstring;
                                                                    {7765}let gNs_6101: bitstring = exp(g,Ns_6100) in
                                                                    {7766}let m2_6102: bitstring = (Cli_5510,gNs_6101) in
                                                                    {7767}event beginSrv(Sess_5512,Cli_5510,gNs_6101);
                                                                    {7768}out(c, (m2_6102,sign(h(m2_6102),skSess_5934)))
                                                    )
                                                    else
                                                        {7769}let pkDisco_6103: bitstring = fail-any in
                                                        {7770}in(c, (=pkCli_6059,m1_6104: bitstring,sigM1_6105: bitstring));
                                                        {7771}if (verify(h(m1_6104),sigM1_6105,pkCli_6059) <> true) then
                                                            0
                                                        else
                                                            {7772}let (=Sess_5512,SPc_6106: bitstring,PartC_6107: bitstring) = m1_6104 in
                                                            {7773}event endSrv(Cli_5510,Sess_5512,PartC_6107);
                                                            {7774}new Ns_6108: bitstring;
                                                            {7775}let gNs_6109: bitstring = exp(g,Ns_6108) in
                                                            {7776}let m2_6110: bitstring = (Cli_5510,gNs_6109) in
                                                            {7777}event beginSrv(Sess_5512,Cli_5510,gNs_6109);
                                                            {7778}out(c, (m2_6110,sign(h(m2_6110),skSess_5934)))
                                            )
                                            else
                                                {7779}let pkDisco_6111: bitstring = fail-any in
                                                {7780}in(c, (=pkCli_6059,m1_6112: bitstring,sigM1_6113: bitstring));
                                                {7781}if (verify(h(m1_6112),sigM1_6113,pkCli_6059) <> true) then
                                                    0
                                                else
                                                    {7782}let (=Sess_5512,SPc_6114: bitstring,PartC_6115: bitstring) = m1_6112 in
                                                    {7783}event endSrv(Cli_5510,Sess_5512,PartC_6115);
                                                    {7784}new Ns_6116: bitstring;
                                                    {7785}let gNs_6117: bitstring = exp(g,Ns_6116) in
                                                    {7786}let m2_6118: bitstring = (Cli_5510,gNs_6117) in
                                                    {7787}event beginSrv(Sess_5512,Cli_5510,gNs_6117);
                                                    {7788}out(c, (m2_6118,sign(h(m2_6118),skSess_5934)))
                                        )
                                        else
                                            {7789}let pkCli_6119: bitstring = pub(skI) in
                                            {7790}let v_6120: bool = (Disco_5511 = A) in
                                            (
                                                {7791}if v_6120 then
                                                (
                                                    {7792}let pkDisco_6121: bitstring = pub(skA) in
                                                    {7793}in(c, (=pkCli_6119,m1_6122: bitstring,sigM1_6123: bitstring));
                                                    {7794}if (verify(h(m1_6122),sigM1_6123,pkCli_6119) <> true) then
                                                        0
                                                    else
                                                        {7795}let (=Sess_5512,SPc_6124: bitstring,PartC_6125: bitstring) = m1_6122 in
                                                        {7796}event endSrv(Cli_5510,Sess_5512,PartC_6125);
                                                        {7797}new Ns_6126: bitstring;
                                                        {7798}let gNs_6127: bitstring = exp(g,Ns_6126) in
                                                        {7799}let m2_6128: bitstring = (Cli_5510,gNs_6127) in
                                                        {7800}event beginSrv(Sess_5512,Cli_5510,gNs_6127);
                                                        {7801}out(c, (m2_6128,sign(h(m2_6128),skSess_5934)))
                                                )
                                                else
                                                    {7802}let v_6129: bool = (Disco_5511 = B) in
                                                    (
                                                        {7803}if v_6129 then
                                                        (
                                                            {7804}let pkDisco_6130: bitstring = pub(skB) in
                                                            {7805}in(c, (=pkCli_6119,m1_6131: bitstring,sigM1_6132: bitstring));
                                                            {7806}if (verify(h(m1_6131),sigM1_6132,pkCli_6119) <> true) then
                                                                0
                                                            else
                                                                {7807}let (=Sess_5512,SPc_6133: bitstring,PartC_6134: bitstring) = m1_6131 in
                                                                {7808}event endSrv(Cli_5510,Sess_5512,PartC_6134);
                                                                {7809}new Ns_6135: bitstring;
                                                                {7810}let gNs_6136: bitstring = exp(g,Ns_6135) in
                                                                {7811}let m2_6137: bitstring = (Cli_5510,gNs_6136) in
                                                                {7812}event beginSrv(Sess_5512,Cli_5510,gNs_6136);
                                                                {7813}out(c, (m2_6137,sign(h(m2_6137),skSess_5934)))
                                                        )
                                                        else
                                                            {7814}let v_6138: bool = (Disco_5511 = C) in
                                                            (
                                                                {7815}if v_6138 then
                                                                (
                                                                    {7816}let pkDisco_6139: bitstring = pub(skC) in
                                                                    {7817}in(c, (=pkCli_6119,m1_6140: bitstring,sigM1_6141: bitstring));
                                                                    {7818}if (verify(h(m1_6140),sigM1_6141,pkCli_6119) <> true) then
                                                                        0
                                                                    else
                                                                        {7819}let (=Sess_5512,SPc_6142: bitstring,PartC_6143: bitstring) = m1_6140 in
                                                                        {7820}event endSrv(Cli_5510,Sess_5512,PartC_6143);
                                                                        {7821}new Ns_6144: bitstring;
                                                                        {7822}let gNs_6145: bitstring = exp(g,Ns_6144) in
                                                                        {7823}let m2_6146: bitstring = (Cli_5510,gNs_6145) in
                                                                        {7824}event beginSrv(Sess_5512,Cli_5510,gNs_6145);
                                                                        {7825}out(c, (m2_6146,sign(h(m2_6146),skSess_5934)))
                                                                )
                                                                else
                                                                    {7826}let pkDisco_6147: bitstring = pub(skI) in
                                                                    {7827}in(c, (=pkCli_6119,m1_6148: bitstring,sigM1_6149: bitstring));
                                                                    {7828}if (verify(h(m1_6148),sigM1_6149,pkCli_6119) <> true) then
                                                                        0
                                                                    else
                                                                        {7829}let (=Sess_5512,SPc_6150: bitstring,PartC_6151: bitstring) = m1_6148 in
                                                                        {7830}event endSrv(Cli_5510,Sess_5512,PartC_6151);
                                                                        {7831}new Ns_6152: bitstring;
                                                                        {7832}let gNs_6153: bitstring = exp(g,Ns_6152) in
                                                                        {7833}let m2_6154: bitstring = (Cli_5510,gNs_6153) in
                                                                        {7834}event beginSrv(Sess_5512,Cli_5510,gNs_6153);
                                                                        {7835}out(c, (m2_6154,sign(h(m2_6154),skSess_5934)))
                                                            )
                                                            else
                                                                {7836}let pkDisco_6155: bitstring = fail-any in
                                                                {7837}in(c, (=pkCli_6119,m1_6156: bitstring,sigM1_6157: bitstring));
                                                                {7838}if (verify(h(m1_6156),sigM1_6157,pkCli_6119) <> true) then
                                                                    0
                                                                else
                                                                    {7839}let (=Sess_5512,SPc_6158: bitstring,PartC_6159: bitstring) = m1_6156 in
                                                                    {7840}event endSrv(Cli_5510,Sess_5512,PartC_6159);
                                                                    {7841}new Ns_6160: bitstring;
                                                                    {7842}let gNs_6161: bitstring = exp(g,Ns_6160) in
                                                                    {7843}let m2_6162: bitstring = (Cli_5510,gNs_6161) in
                                                                    {7844}event beginSrv(Sess_5512,Cli_5510,gNs_6161);
                                                                    {7845}out(c, (m2_6162,sign(h(m2_6162),skSess_5934)))
                                                    )
                                                    else
                                                        {7846}let pkDisco_6163: bitstring = fail-any in
                                                        {7847}in(c, (=pkCli_6119,m1_6164: bitstring,sigM1_6165: bitstring));
                                                        {7848}if (verify(h(m1_6164),sigM1_6165,pkCli_6119) <> true) then
                                                            0
                                                        else
                                                            {7849}let (=Sess_5512,SPc_6166: bitstring,PartC_6167: bitstring) = m1_6164 in
                                                            {7850}event endSrv(Cli_5510,Sess_5512,PartC_6167);
                                                            {7851}new Ns_6168: bitstring;
                                                            {7852}let gNs_6169: bitstring = exp(g,Ns_6168) in
                                                            {7853}let m2_6170: bitstring = (Cli_5510,gNs_6169) in
                                                            {7854}event beginSrv(Sess_5512,Cli_5510,gNs_6169);
                                                            {7855}out(c, (m2_6170,sign(h(m2_6170),skSess_5934)))
                                            )
                                            else
                                                {7856}let pkDisco_6171: bitstring = fail-any in
                                                {7857}in(c, (=pkCli_6119,m1_6172: bitstring,sigM1_6173: bitstring));
                                                {7858}if (verify(h(m1_6172),sigM1_6173,pkCli_6119) <> true) then
                                                    0
                                                else
                                                    {7859}let (=Sess_5512,SPc_6174: bitstring,PartC_6175: bitstring) = m1_6172 in
                                                    {7860}event endSrv(Cli_5510,Sess_5512,PartC_6175);
                                                    {7861}new Ns_6176: bitstring;
                                                    {7862}let gNs_6177: bitstring = exp(g,Ns_6176) in
                                                    {7863}let m2_6178: bitstring = (Cli_5510,gNs_6177) in
                                                    {7864}event beginSrv(Sess_5512,Cli_5510,gNs_6177);
                                                    {7865}out(c, (m2_6178,sign(h(m2_6178),skSess_5934)))
                                    )
                                    else
                                        {7866}let pkCli_6179: bitstring = fail-any in
                                        {7867}let v_6180: bool = (Disco_5511 = A) in
                                        (
                                            {7868}if v_6180 then
                                            (
                                                {7869}let pkDisco_6181: bitstring = pub(skA) in
                                                {7870}in(c, (=pkCli_6179,m1_6182: bitstring,sigM1_6183: bitstring));
                                                {7871}if (verify(h(m1_6182),sigM1_6183,pkCli_6179) <> true) then
                                                    0
                                                else
                                                    {7872}let (=Sess_5512,SPc_6184: bitstring,PartC_6185: bitstring) = m1_6182 in
                                                    {7873}event endSrv(Cli_5510,Sess_5512,PartC_6185);
                                                    {7874}new Ns_6186: bitstring;
                                                    {7875}let gNs_6187: bitstring = exp(g,Ns_6186) in
                                                    {7876}let m2_6188: bitstring = (Cli_5510,gNs_6187) in
                                                    {7877}event beginSrv(Sess_5512,Cli_5510,gNs_6187);
                                                    {7878}out(c, (m2_6188,sign(h(m2_6188),skSess_5934)))
                                            )
                                            else
                                                {7879}let v_6189: bool = (Disco_5511 = B) in
                                                (
                                                    {7880}if v_6189 then
                                                    (
                                                        {7881}let pkDisco_6190: bitstring = pub(skB) in
                                                        {7882}in(c, (=pkCli_6179,m1_6191: bitstring,sigM1_6192: bitstring));
                                                        {7883}if (verify(h(m1_6191),sigM1_6192,pkCli_6179) <> true) then
                                                            0
                                                        else
                                                            {7884}let (=Sess_5512,SPc_6193: bitstring,PartC_6194: bitstring) = m1_6191 in
                                                            {7885}event endSrv(Cli_5510,Sess_5512,PartC_6194);
                                                            {7886}new Ns_6195: bitstring;
                                                            {7887}let gNs_6196: bitstring = exp(g,Ns_6195) in
                                                            {7888}let m2_6197: bitstring = (Cli_5510,gNs_6196) in
                                                            {7889}event beginSrv(Sess_5512,Cli_5510,gNs_6196);
                                                            {7890}out(c, (m2_6197,sign(h(m2_6197),skSess_5934)))
                                                    )
                                                    else
                                                        {7891}let v_6198: bool = (Disco_5511 = C) in
                                                        (
                                                            {7892}if v_6198 then
                                                            (
                                                                {7893}let pkDisco_6199: bitstring = pub(skC) in
                                                                {7894}in(c, (=pkCli_6179,m1_6200: bitstring,sigM1_6201: bitstring));
                                                                {7895}if (verify(h(m1_6200),sigM1_6201,pkCli_6179) <> true) then
                                                                    0
                                                                else
                                                                    {7896}let (=Sess_5512,SPc_6202: bitstring,PartC_6203: bitstring) = m1_6200 in
                                                                    {7897}event endSrv(Cli_5510,Sess_5512,PartC_6203);
                                                                    {7898}new Ns_6204: bitstring;
                                                                    {7899}let gNs_6205: bitstring = exp(g,Ns_6204) in
                                                                    {7900}let m2_6206: bitstring = (Cli_5510,gNs_6205) in
                                                                    {7901}event beginSrv(Sess_5512,Cli_5510,gNs_6205);
                                                                    {7902}out(c, (m2_6206,sign(h(m2_6206),skSess_5934)))
                                                            )
                                                            else
                                                                {7903}let pkDisco_6207: bitstring = pub(skI) in
                                                                {7904}in(c, (=pkCli_6179,m1_6208: bitstring,sigM1_6209: bitstring));
                                                                {7905}if (verify(h(m1_6208),sigM1_6209,pkCli_6179) <> true) then
                                                                    0
                                                                else
                                                                    {7906}let (=Sess_5512,SPc_6210: bitstring,PartC_6211: bitstring) = m1_6208 in
                                                                    {7907}event endSrv(Cli_5510,Sess_5512,PartC_6211);
                                                                    {7908}new Ns_6212: bitstring;
                                                                    {7909}let gNs_6213: bitstring = exp(g,Ns_6212) in
                                                                    {7910}let m2_6214: bitstring = (Cli_5510,gNs_6213) in
                                                                    {7911}event beginSrv(Sess_5512,Cli_5510,gNs_6213);
                                                                    {7912}out(c, (m2_6214,sign(h(m2_6214),skSess_5934)))
                                                        )
                                                        else
                                                            {7913}let pkDisco_6215: bitstring = fail-any in
                                                            {7914}in(c, (=pkCli_6179,m1_6216: bitstring,sigM1_6217: bitstring));
                                                            {7915}if (verify(h(m1_6216),sigM1_6217,pkCli_6179) <> true) then
                                                                0
                                                            else
                                                                {7916}let (=Sess_5512,SPc_6218: bitstring,PartC_6219: bitstring) = m1_6216 in
                                                                {7917}event endSrv(Cli_5510,Sess_5512,PartC_6219);
                                                                {7918}new Ns_6220: bitstring;
                                                                {7919}let gNs_6221: bitstring = exp(g,Ns_6220) in
                                                                {7920}let m2_6222: bitstring = (Cli_5510,gNs_6221) in
                                                                {7921}event beginSrv(Sess_5512,Cli_5510,gNs_6221);
                                                                {7922}out(c, (m2_6222,sign(h(m2_6222),skSess_5934)))
                                                )
                                                else
                                                    {7923}let pkDisco_6223: bitstring = fail-any in
                                                    {7924}in(c, (=pkCli_6179,m1_6224: bitstring,sigM1_6225: bitstring));
                                                    {7925}if (verify(h(m1_6224),sigM1_6225,pkCli_6179) <> true) then
                                                        0
                                                    else
                                                        {7926}let (=Sess_5512,SPc_6226: bitstring,PartC_6227: bitstring) = m1_6224 in
                                                        {7927}event endSrv(Cli_5510,Sess_5512,PartC_6227);
                                                        {7928}new Ns_6228: bitstring;
                                                        {7929}let gNs_6229: bitstring = exp(g,Ns_6228) in
                                                        {7930}let m2_6230: bitstring = (Cli_5510,gNs_6229) in
                                                        {7931}event beginSrv(Sess_5512,Cli_5510,gNs_6229);
                                                        {7932}out(c, (m2_6230,sign(h(m2_6230),skSess_5934)))
                                        )
                                        else
                                            {7933}let pkDisco_6231: bitstring = fail-any in
                                            {7934}in(c, (=pkCli_6179,m1_6232: bitstring,sigM1_6233: bitstring));
                                            {7935}if (verify(h(m1_6232),sigM1_6233,pkCli_6179) <> true) then
                                                0
                                            else
                                                {7936}let (=Sess_5512,SPc_6234: bitstring,PartC_6235: bitstring) = m1_6232 in
                                                {7937}event endSrv(Cli_5510,Sess_5512,PartC_6235);
                                                {7938}new Ns_6236: bitstring;
                                                {7939}let gNs_6237: bitstring = exp(g,Ns_6236) in
                                                {7940}let m2_6238: bitstring = (Cli_5510,gNs_6237) in
                                                {7941}event beginSrv(Sess_5512,Cli_5510,gNs_6237);
                                                {7942}out(c, (m2_6238,sign(h(m2_6238),skSess_5934)))
                            )
                            else
                                {7943}let pkCli_6239: bitstring = fail-any in
                                {7944}let v_6240: bool = (Disco_5511 = A) in
                                (
                                    {7945}if v_6240 then
                                    (
                                        {7946}let pkDisco_6241: bitstring = pub(skA) in
                                        {7947}in(c, (=pkCli_6239,m1_6242: bitstring,sigM1_6243: bitstring));
                                        {7948}if (verify(h(m1_6242),sigM1_6243,pkCli_6239) <> true) then
                                            0
                                        else
                                            {7949}let (=Sess_5512,SPc_6244: bitstring,PartC_6245: bitstring) = m1_6242 in
                                            {7950}event endSrv(Cli_5510,Sess_5512,PartC_6245);
                                            {7951}new Ns_6246: bitstring;
                                            {7952}let gNs_6247: bitstring = exp(g,Ns_6246) in
                                            {7953}let m2_6248: bitstring = (Cli_5510,gNs_6247) in
                                            {7954}event beginSrv(Sess_5512,Cli_5510,gNs_6247);
                                            {7955}out(c, (m2_6248,sign(h(m2_6248),skSess_5934)))
                                    )
                                    else
                                        {7956}let v_6249: bool = (Disco_5511 = B) in
                                        (
                                            {7957}if v_6249 then
                                            (
                                                {7958}let pkDisco_6250: bitstring = pub(skB) in
                                                {7959}in(c, (=pkCli_6239,m1_6251: bitstring,sigM1_6252: bitstring));
                                                {7960}if (verify(h(m1_6251),sigM1_6252,pkCli_6239) <> true) then
                                                    0
                                                else
                                                    {7961}let (=Sess_5512,SPc_6253: bitstring,PartC_6254: bitstring) = m1_6251 in
                                                    {7962}event endSrv(Cli_5510,Sess_5512,PartC_6254);
                                                    {7963}new Ns_6255: bitstring;
                                                    {7964}let gNs_6256: bitstring = exp(g,Ns_6255) in
                                                    {7965}let m2_6257: bitstring = (Cli_5510,gNs_6256) in
                                                    {7966}event beginSrv(Sess_5512,Cli_5510,gNs_6256);
                                                    {7967}out(c, (m2_6257,sign(h(m2_6257),skSess_5934)))
                                            )
                                            else
                                                {7968}let v_6258: bool = (Disco_5511 = C) in
                                                (
                                                    {7969}if v_6258 then
                                                    (
                                                        {7970}let pkDisco_6259: bitstring = pub(skC) in
                                                        {7971}in(c, (=pkCli_6239,m1_6260: bitstring,sigM1_6261: bitstring));
                                                        {7972}if (verify(h(m1_6260),sigM1_6261,pkCli_6239) <> true) then
                                                            0
                                                        else
                                                            {7973}let (=Sess_5512,SPc_6262: bitstring,PartC_6263: bitstring) = m1_6260 in
                                                            {7974}event endSrv(Cli_5510,Sess_5512,PartC_6263);
                                                            {7975}new Ns_6264: bitstring;
                                                            {7976}let gNs_6265: bitstring = exp(g,Ns_6264) in
                                                            {7977}let m2_6266: bitstring = (Cli_5510,gNs_6265) in
                                                            {7978}event beginSrv(Sess_5512,Cli_5510,gNs_6265);
                                                            {7979}out(c, (m2_6266,sign(h(m2_6266),skSess_5934)))
                                                    )
                                                    else
                                                        {7980}let pkDisco_6267: bitstring = pub(skI) in
                                                        {7981}in(c, (=pkCli_6239,m1_6268: bitstring,sigM1_6269: bitstring));
                                                        {7982}if (verify(h(m1_6268),sigM1_6269,pkCli_6239) <> true) then
                                                            0
                                                        else
                                                            {7983}let (=Sess_5512,SPc_6270: bitstring,PartC_6271: bitstring) = m1_6268 in
                                                            {7984}event endSrv(Cli_5510,Sess_5512,PartC_6271);
                                                            {7985}new Ns_6272: bitstring;
                                                            {7986}let gNs_6273: bitstring = exp(g,Ns_6272) in
                                                            {7987}let m2_6274: bitstring = (Cli_5510,gNs_6273) in
                                                            {7988}event beginSrv(Sess_5512,Cli_5510,gNs_6273);
                                                            {7989}out(c, (m2_6274,sign(h(m2_6274),skSess_5934)))
                                                )
                                                else
                                                    {7990}let pkDisco_6275: bitstring = fail-any in
                                                    {7991}in(c, (=pkCli_6239,m1_6276: bitstring,sigM1_6277: bitstring));
                                                    {7992}if (verify(h(m1_6276),sigM1_6277,pkCli_6239) <> true) then
                                                        0
                                                    else
                                                        {7993}let (=Sess_5512,SPc_6278: bitstring,PartC_6279: bitstring) = m1_6276 in
                                                        {7994}event endSrv(Cli_5510,Sess_5512,PartC_6279);
                                                        {7995}new Ns_6280: bitstring;
                                                        {7996}let gNs_6281: bitstring = exp(g,Ns_6280) in
                                                        {7997}let m2_6282: bitstring = (Cli_5510,gNs_6281) in
                                                        {7998}event beginSrv(Sess_5512,Cli_5510,gNs_6281);
                                                        {7999}out(c, (m2_6282,sign(h(m2_6282),skSess_5934)))
                                        )
                                        else
                                            {8000}let pkDisco_6283: bitstring = fail-any in
                                            {8001}in(c, (=pkCli_6239,m1_6284: bitstring,sigM1_6285: bitstring));
                                            {8002}if (verify(h(m1_6284),sigM1_6285,pkCli_6239) <> true) then
                                                0
                                            else
                                                {8003}let (=Sess_5512,SPc_6286: bitstring,PartC_6287: bitstring) = m1_6284 in
                                                {8004}event endSrv(Cli_5510,Sess_5512,PartC_6287);
                                                {8005}new Ns_6288: bitstring;
                                                {8006}let gNs_6289: bitstring = exp(g,Ns_6288) in
                                                {8007}let m2_6290: bitstring = (Cli_5510,gNs_6289) in
                                                {8008}event beginSrv(Sess_5512,Cli_5510,gNs_6289);
                                                {8009}out(c, (m2_6290,sign(h(m2_6290),skSess_5934)))
                                )
                                else
                                    {8010}let pkDisco_6291: bitstring = fail-any in
                                    {8011}in(c, (=pkCli_6239,m1_6292: bitstring,sigM1_6293: bitstring));
                                    {8012}if (verify(h(m1_6292),sigM1_6293,pkCli_6239) <> true) then
                                        0
                                    else
                                        {8013}let (=Sess_5512,SPc_6294: bitstring,PartC_6295: bitstring) = m1_6292 in
                                        {8014}event endSrv(Cli_5510,Sess_5512,PartC_6295);
                                        {8015}new Ns_6296: bitstring;
                                        {8016}let gNs_6297: bitstring = exp(g,Ns_6296) in
                                        {8017}let m2_6298: bitstring = (Cli_5510,gNs_6297) in
                                        {8018}event beginSrv(Sess_5512,Cli_5510,gNs_6297);
                                        {8019}out(c, (m2_6298,sign(h(m2_6298),skSess_5934)))
                    )
                    else
                        {8020}let pkCli_6299: bitstring = fail-any in
                        {8021}let v_6300: bool = (Disco_5511 = A) in
                        (
                            {8022}if v_6300 then
                            (
                                {8023}let pkDisco_6301: bitstring = pub(skA) in
                                {8024}in(c, (=pkCli_6299,m1_6302: bitstring,sigM1_6303: bitstring));
                                {8025}if (verify(h(m1_6302),sigM1_6303,pkCli_6299) <> true) then
                                    0
                                else
                                    {8026}let (=Sess_5512,SPc_6304: bitstring,PartC_6305: bitstring) = m1_6302 in
                                    {8027}event endSrv(Cli_5510,Sess_5512,PartC_6305);
                                    {8028}new Ns_6306: bitstring;
                                    {8029}let gNs_6307: bitstring = exp(g,Ns_6306) in
                                    {8030}let m2_6308: bitstring = (Cli_5510,gNs_6307) in
                                    {8031}event beginSrv(Sess_5512,Cli_5510,gNs_6307);
                                    {8032}out(c, (m2_6308,sign(h(m2_6308),skSess_5934)))
                            )
                            else
                                {8033}let v_6309: bool = (Disco_5511 = B) in
                                (
                                    {8034}if v_6309 then
                                    (
                                        {8035}let pkDisco_6310: bitstring = pub(skB) in
                                        {8036}in(c, (=pkCli_6299,m1_6311: bitstring,sigM1_6312: bitstring));
                                        {8037}if (verify(h(m1_6311),sigM1_6312,pkCli_6299) <> true) then
                                            0
                                        else
                                            {8038}let (=Sess_5512,SPc_6313: bitstring,PartC_6314: bitstring) = m1_6311 in
                                            {8039}event endSrv(Cli_5510,Sess_5512,PartC_6314);
                                            {8040}new Ns_6315: bitstring;
                                            {8041}let gNs_6316: bitstring = exp(g,Ns_6315) in
                                            {8042}let m2_6317: bitstring = (Cli_5510,gNs_6316) in
                                            {8043}event beginSrv(Sess_5512,Cli_5510,gNs_6316);
                                            {8044}out(c, (m2_6317,sign(h(m2_6317),skSess_5934)))
                                    )
                                    else
                                        {8045}let v_6318: bool = (Disco_5511 = C) in
                                        (
                                            {8046}if v_6318 then
                                            (
                                                {8047}let pkDisco_6319: bitstring = pub(skC) in
                                                {8048}in(c, (=pkCli_6299,m1_6320: bitstring,sigM1_6321: bitstring));
                                                {8049}if (verify(h(m1_6320),sigM1_6321,pkCli_6299) <> true) then
                                                    0
                                                else
                                                    {8050}let (=Sess_5512,SPc_6322: bitstring,PartC_6323: bitstring) = m1_6320 in
                                                    {8051}event endSrv(Cli_5510,Sess_5512,PartC_6323);
                                                    {8052}new Ns_6324: bitstring;
                                                    {8053}let gNs_6325: bitstring = exp(g,Ns_6324) in
                                                    {8054}let m2_6326: bitstring = (Cli_5510,gNs_6325) in
                                                    {8055}event beginSrv(Sess_5512,Cli_5510,gNs_6325);
                                                    {8056}out(c, (m2_6326,sign(h(m2_6326),skSess_5934)))
                                            )
                                            else
                                                {8057}let pkDisco_6327: bitstring = pub(skI) in
                                                {8058}in(c, (=pkCli_6299,m1_6328: bitstring,sigM1_6329: bitstring));
                                                {8059}if (verify(h(m1_6328),sigM1_6329,pkCli_6299) <> true) then
                                                    0
                                                else
                                                    {8060}let (=Sess_5512,SPc_6330: bitstring,PartC_6331: bitstring) = m1_6328 in
                                                    {8061}event endSrv(Cli_5510,Sess_5512,PartC_6331);
                                                    {8062}new Ns_6332: bitstring;
                                                    {8063}let gNs_6333: bitstring = exp(g,Ns_6332) in
                                                    {8064}let m2_6334: bitstring = (Cli_5510,gNs_6333) in
                                                    {8065}event beginSrv(Sess_5512,Cli_5510,gNs_6333);
                                                    {8066}out(c, (m2_6334,sign(h(m2_6334),skSess_5934)))
                                        )
                                        else
                                            {8067}let pkDisco_6335: bitstring = fail-any in
                                            {8068}in(c, (=pkCli_6299,m1_6336: bitstring,sigM1_6337: bitstring));
                                            {8069}if (verify(h(m1_6336),sigM1_6337,pkCli_6299) <> true) then
                                                0
                                            else
                                                {8070}let (=Sess_5512,SPc_6338: bitstring,PartC_6339: bitstring) = m1_6336 in
                                                {8071}event endSrv(Cli_5510,Sess_5512,PartC_6339);
                                                {8072}new Ns_6340: bitstring;
                                                {8073}let gNs_6341: bitstring = exp(g,Ns_6340) in
                                                {8074}let m2_6342: bitstring = (Cli_5510,gNs_6341) in
                                                {8075}event beginSrv(Sess_5512,Cli_5510,gNs_6341);
                                                {8076}out(c, (m2_6342,sign(h(m2_6342),skSess_5934)))
                                )
                                else
                                    {8077}let pkDisco_6343: bitstring = fail-any in
                                    {8078}in(c, (=pkCli_6299,m1_6344: bitstring,sigM1_6345: bitstring));
                                    {8079}if (verify(h(m1_6344),sigM1_6345,pkCli_6299) <> true) then
                                        0
                                    else
                                        {8080}let (=Sess_5512,SPc_6346: bitstring,PartC_6347: bitstring) = m1_6344 in
                                        {8081}event endSrv(Cli_5510,Sess_5512,PartC_6347);
                                        {8082}new Ns_6348: bitstring;
                                        {8083}let gNs_6349: bitstring = exp(g,Ns_6348) in
                                        {8084}let m2_6350: bitstring = (Cli_5510,gNs_6349) in
                                        {8085}event beginSrv(Sess_5512,Cli_5510,gNs_6349);
                                        {8086}out(c, (m2_6350,sign(h(m2_6350),skSess_5934)))
                        )
                        else
                            {8087}let pkDisco_6351: bitstring = fail-any in
                            {8088}in(c, (=pkCli_6299,m1_6352: bitstring,sigM1_6353: bitstring));
                            {8089}if (verify(h(m1_6352),sigM1_6353,pkCli_6299) <> true) then
                                0
                            else
                                {8090}let (=Sess_5512,SPc_6354: bitstring,PartC_6355: bitstring) = m1_6352 in
                                {8091}event endSrv(Cli_5510,Sess_5512,PartC_6355);
                                {8092}new Ns_6356: bitstring;
                                {8093}let gNs_6357: bitstring = exp(g,Ns_6356) in
                                {8094}let m2_6358: bitstring = (Cli_5510,gNs_6357) in
                                {8095}event beginSrv(Sess_5512,Cli_5510,gNs_6357);
                                {8096}out(c, (m2_6358,sign(h(m2_6358),skSess_5934)))
                )
                else
                    {8097}let v_6359: bool = (Sess_5512 = C) in
                    (
                        {8098}if v_6359 then
                        (
                            {8099}let skSess_6360: bitstring = skC in
                            {8100}let pkSess_6361: bitstring = pub(skSess_6360) in
                            {8101}let v_6362: bool = (Cli_5510 = A) in
                            (
                                {8102}if v_6362 then
                                (
                                    {8103}let pkCli_6363: bitstring = pub(skA) in
                                    {8104}let v_6364: bool = (Disco_5511 = A) in
                                    (
                                        {8105}if v_6364 then
                                        (
                                            {8106}let pkDisco_6365: bitstring = pub(skA) in
                                            {8107}in(c, (=pkCli_6363,m1_6366: bitstring,sigM1_6367: bitstring));
                                            {8108}if (verify(h(m1_6366),sigM1_6367,pkCli_6363) <> true) then
                                                0
                                            else
                                                {8109}let (=Sess_5512,SPc_6368: bitstring,PartC_6369: bitstring) = m1_6366 in
                                                {8110}event endSrv(Cli_5510,Sess_5512,PartC_6369);
                                                {8111}new Ns_6370: bitstring;
                                                {8112}let gNs_6371: bitstring = exp(g,Ns_6370) in
                                                {8113}let m2_6372: bitstring = (Cli_5510,gNs_6371) in
                                                {8114}event beginSrv(Sess_5512,Cli_5510,gNs_6371);
                                                {8115}out(c, (m2_6372,sign(h(m2_6372),skSess_6360)))
                                        )
                                        else
                                            {8116}let v_6373: bool = (Disco_5511 = B) in
                                            (
                                                {8117}if v_6373 then
                                                (
                                                    {8118}let pkDisco_6374: bitstring = pub(skB) in
                                                    {8119}in(c, (=pkCli_6363,m1_6375: bitstring,sigM1_6376: bitstring));
                                                    {8120}if (verify(h(m1_6375),sigM1_6376,pkCli_6363) <> true) then
                                                        0
                                                    else
                                                        {8121}let (=Sess_5512,SPc_6377: bitstring,PartC_6378: bitstring) = m1_6375 in
                                                        {8122}event endSrv(Cli_5510,Sess_5512,PartC_6378);
                                                        {8123}new Ns_6379: bitstring;
                                                        {8124}let gNs_6380: bitstring = exp(g,Ns_6379) in
                                                        {8125}let m2_6381: bitstring = (Cli_5510,gNs_6380) in
                                                        {8126}event beginSrv(Sess_5512,Cli_5510,gNs_6380);
                                                        {8127}out(c, (m2_6381,sign(h(m2_6381),skSess_6360)))
                                                )
                                                else
                                                    {8128}let v_6382: bool = (Disco_5511 = C) in
                                                    (
                                                        {8129}if v_6382 then
                                                        (
                                                            {8130}let pkDisco_6383: bitstring = pub(skC) in
                                                            {8131}in(c, (=pkCli_6363,m1_6384: bitstring,sigM1_6385: bitstring));
                                                            {8132}if (verify(h(m1_6384),sigM1_6385,pkCli_6363) <> true) then
                                                                0
                                                            else
                                                                {8133}let (=Sess_5512,SPc_6386: bitstring,PartC_6387: bitstring) = m1_6384 in
                                                                {8134}event endSrv(Cli_5510,Sess_5512,PartC_6387);
                                                                {8135}new Ns_6388: bitstring;
                                                                {8136}let gNs_6389: bitstring = exp(g,Ns_6388) in
                                                                {8137}let m2_6390: bitstring = (Cli_5510,gNs_6389) in
                                                                {8138}event beginSrv(Sess_5512,Cli_5510,gNs_6389);
                                                                {8139}out(c, (m2_6390,sign(h(m2_6390),skSess_6360)))
                                                        )
                                                        else
                                                            {8140}let pkDisco_6391: bitstring = pub(skI) in
                                                            {8141}in(c, (=pkCli_6363,m1_6392: bitstring,sigM1_6393: bitstring));
                                                            {8142}if (verify(h(m1_6392),sigM1_6393,pkCli_6363) <> true) then
                                                                0
                                                            else
                                                                {8143}let (=Sess_5512,SPc_6394: bitstring,PartC_6395: bitstring) = m1_6392 in
                                                                {8144}event endSrv(Cli_5510,Sess_5512,PartC_6395);
                                                                {8145}new Ns_6396: bitstring;
                                                                {8146}let gNs_6397: bitstring = exp(g,Ns_6396) in
                                                                {8147}let m2_6398: bitstring = (Cli_5510,gNs_6397) in
                                                                {8148}event beginSrv(Sess_5512,Cli_5510,gNs_6397);
                                                                {8149}out(c, (m2_6398,sign(h(m2_6398),skSess_6360)))
                                                    )
                                                    else
                                                        {8150}let pkDisco_6399: bitstring = fail-any in
                                                        {8151}in(c, (=pkCli_6363,m1_6400: bitstring,sigM1_6401: bitstring));
                                                        {8152}if (verify(h(m1_6400),sigM1_6401,pkCli_6363) <> true) then
                                                            0
                                                        else
                                                            {8153}let (=Sess_5512,SPc_6402: bitstring,PartC_6403: bitstring) = m1_6400 in
                                                            {8154}event endSrv(Cli_5510,Sess_5512,PartC_6403);
                                                            {8155}new Ns_6404: bitstring;
                                                            {8156}let gNs_6405: bitstring = exp(g,Ns_6404) in
                                                            {8157}let m2_6406: bitstring = (Cli_5510,gNs_6405) in
                                                            {8158}event beginSrv(Sess_5512,Cli_5510,gNs_6405);
                                                            {8159}out(c, (m2_6406,sign(h(m2_6406),skSess_6360)))
                                            )
                                            else
                                                {8160}let pkDisco_6407: bitstring = fail-any in
                                                {8161}in(c, (=pkCli_6363,m1_6408: bitstring,sigM1_6409: bitstring));
                                                {8162}if (verify(h(m1_6408),sigM1_6409,pkCli_6363) <> true) then
                                                    0
                                                else
                                                    {8163}let (=Sess_5512,SPc_6410: bitstring,PartC_6411: bitstring) = m1_6408 in
                                                    {8164}event endSrv(Cli_5510,Sess_5512,PartC_6411);
                                                    {8165}new Ns_6412: bitstring;
                                                    {8166}let gNs_6413: bitstring = exp(g,Ns_6412) in
                                                    {8167}let m2_6414: bitstring = (Cli_5510,gNs_6413) in
                                                    {8168}event beginSrv(Sess_5512,Cli_5510,gNs_6413);
                                                    {8169}out(c, (m2_6414,sign(h(m2_6414),skSess_6360)))
                                    )
                                    else
                                        {8170}let pkDisco_6415: bitstring = fail-any in
                                        {8171}in(c, (=pkCli_6363,m1_6416: bitstring,sigM1_6417: bitstring));
                                        {8172}if (verify(h(m1_6416),sigM1_6417,pkCli_6363) <> true) then
                                            0
                                        else
                                            {8173}let (=Sess_5512,SPc_6418: bitstring,PartC_6419: bitstring) = m1_6416 in
                                            {8174}event endSrv(Cli_5510,Sess_5512,PartC_6419);
                                            {8175}new Ns_6420: bitstring;
                                            {8176}let gNs_6421: bitstring = exp(g,Ns_6420) in
                                            {8177}let m2_6422: bitstring = (Cli_5510,gNs_6421) in
                                            {8178}event beginSrv(Sess_5512,Cli_5510,gNs_6421);
                                            {8179}out(c, (m2_6422,sign(h(m2_6422),skSess_6360)))
                                )
                                else
                                    {8180}let v_6423: bool = (Cli_5510 = B) in
                                    (
                                        {8181}if v_6423 then
                                        (
                                            {8182}let pkCli_6424: bitstring = pub(skB) in
                                            {8183}let v_6425: bool = (Disco_5511 = A) in
                                            (
                                                {8184}if v_6425 then
                                                (
                                                    {8185}let pkDisco_6426: bitstring = pub(skA) in
                                                    {8186}in(c, (=pkCli_6424,m1_6427: bitstring,sigM1_6428: bitstring));
                                                    {8187}if (verify(h(m1_6427),sigM1_6428,pkCli_6424) <> true) then
                                                        0
                                                    else
                                                        {8188}let (=Sess_5512,SPc_6429: bitstring,PartC_6430: bitstring) = m1_6427 in
                                                        {8189}event endSrv(Cli_5510,Sess_5512,PartC_6430);
                                                        {8190}new Ns_6431: bitstring;
                                                        {8191}let gNs_6432: bitstring = exp(g,Ns_6431) in
                                                        {8192}let m2_6433: bitstring = (Cli_5510,gNs_6432) in
                                                        {8193}event beginSrv(Sess_5512,Cli_5510,gNs_6432);
                                                        {8194}out(c, (m2_6433,sign(h(m2_6433),skSess_6360)))
                                                )
                                                else
                                                    {8195}let v_6434: bool = (Disco_5511 = B) in
                                                    (
                                                        {8196}if v_6434 then
                                                        (
                                                            {8197}let pkDisco_6435: bitstring = pub(skB) in
                                                            {8198}in(c, (=pkCli_6424,m1_6436: bitstring,sigM1_6437: bitstring));
                                                            {8199}if (verify(h(m1_6436),sigM1_6437,pkCli_6424) <> true) then
                                                                0
                                                            else
                                                                {8200}let (=Sess_5512,SPc_6438: bitstring,PartC_6439: bitstring) = m1_6436 in
                                                                {8201}event endSrv(Cli_5510,Sess_5512,PartC_6439);
                                                                {8202}new Ns_6440: bitstring;
                                                                {8203}let gNs_6441: bitstring = exp(g,Ns_6440) in
                                                                {8204}let m2_6442: bitstring = (Cli_5510,gNs_6441) in
                                                                {8205}event beginSrv(Sess_5512,Cli_5510,gNs_6441);
                                                                {8206}out(c, (m2_6442,sign(h(m2_6442),skSess_6360)))
                                                        )
                                                        else
                                                            {8207}let v_6443: bool = (Disco_5511 = C) in
                                                            (
                                                                {8208}if v_6443 then
                                                                (
                                                                    {8209}let pkDisco_6444: bitstring = pub(skC) in
                                                                    {8210}in(c, (=pkCli_6424,m1_6445: bitstring,sigM1_6446: bitstring));
                                                                    {8211}if (verify(h(m1_6445),sigM1_6446,pkCli_6424) <> true) then
                                                                        0
                                                                    else
                                                                        {8212}let (=Sess_5512,SPc_6447: bitstring,PartC_6448: bitstring) = m1_6445 in
                                                                        {8213}event endSrv(Cli_5510,Sess_5512,PartC_6448);
                                                                        {8214}new Ns_6449: bitstring;
                                                                        {8215}let gNs_6450: bitstring = exp(g,Ns_6449) in
                                                                        {8216}let m2_6451: bitstring = (Cli_5510,gNs_6450) in
                                                                        {8217}event beginSrv(Sess_5512,Cli_5510,gNs_6450);
                                                                        {8218}out(c, (m2_6451,sign(h(m2_6451),skSess_6360)))
                                                                )
                                                                else
                                                                    {8219}let pkDisco_6452: bitstring = pub(skI) in
                                                                    {8220}in(c, (=pkCli_6424,m1_6453: bitstring,sigM1_6454: bitstring));
                                                                    {8221}if (verify(h(m1_6453),sigM1_6454,pkCli_6424) <> true) then
                                                                        0
                                                                    else
                                                                        {8222}let (=Sess_5512,SPc_6455: bitstring,PartC_6456: bitstring) = m1_6453 in
                                                                        {8223}event endSrv(Cli_5510,Sess_5512,PartC_6456);
                                                                        {8224}new Ns_6457: bitstring;
                                                                        {8225}let gNs_6458: bitstring = exp(g,Ns_6457) in
                                                                        {8226}let m2_6459: bitstring = (Cli_5510,gNs_6458) in
                                                                        {8227}event beginSrv(Sess_5512,Cli_5510,gNs_6458);
                                                                        {8228}out(c, (m2_6459,sign(h(m2_6459),skSess_6360)))
                                                            )
                                                            else
                                                                {8229}let pkDisco_6460: bitstring = fail-any in
                                                                {8230}in(c, (=pkCli_6424,m1_6461: bitstring,sigM1_6462: bitstring));
                                                                {8231}if (verify(h(m1_6461),sigM1_6462,pkCli_6424) <> true) then
                                                                    0
                                                                else
                                                                    {8232}let (=Sess_5512,SPc_6463: bitstring,PartC_6464: bitstring) = m1_6461 in
                                                                    {8233}event endSrv(Cli_5510,Sess_5512,PartC_6464);
                                                                    {8234}new Ns_6465: bitstring;
                                                                    {8235}let gNs_6466: bitstring = exp(g,Ns_6465) in
                                                                    {8236}let m2_6467: bitstring = (Cli_5510,gNs_6466) in
                                                                    {8237}event beginSrv(Sess_5512,Cli_5510,gNs_6466);
                                                                    {8238}out(c, (m2_6467,sign(h(m2_6467),skSess_6360)))
                                                    )
                                                    else
                                                        {8239}let pkDisco_6468: bitstring = fail-any in
                                                        {8240}in(c, (=pkCli_6424,m1_6469: bitstring,sigM1_6470: bitstring));
                                                        {8241}if (verify(h(m1_6469),sigM1_6470,pkCli_6424) <> true) then
                                                            0
                                                        else
                                                            {8242}let (=Sess_5512,SPc_6471: bitstring,PartC_6472: bitstring) = m1_6469 in
                                                            {8243}event endSrv(Cli_5510,Sess_5512,PartC_6472);
                                                            {8244}new Ns_6473: bitstring;
                                                            {8245}let gNs_6474: bitstring = exp(g,Ns_6473) in
                                                            {8246}let m2_6475: bitstring = (Cli_5510,gNs_6474) in
                                                            {8247}event beginSrv(Sess_5512,Cli_5510,gNs_6474);
                                                            {8248}out(c, (m2_6475,sign(h(m2_6475),skSess_6360)))
                                            )
                                            else
                                                {8249}let pkDisco_6476: bitstring = fail-any in
                                                {8250}in(c, (=pkCli_6424,m1_6477: bitstring,sigM1_6478: bitstring));
                                                {8251}if (verify(h(m1_6477),sigM1_6478,pkCli_6424) <> true) then
                                                    0
                                                else
                                                    {8252}let (=Sess_5512,SPc_6479: bitstring,PartC_6480: bitstring) = m1_6477 in
                                                    {8253}event endSrv(Cli_5510,Sess_5512,PartC_6480);
                                                    {8254}new Ns_6481: bitstring;
                                                    {8255}let gNs_6482: bitstring = exp(g,Ns_6481) in
                                                    {8256}let m2_6483: bitstring = (Cli_5510,gNs_6482) in
                                                    {8257}event beginSrv(Sess_5512,Cli_5510,gNs_6482);
                                                    {8258}out(c, (m2_6483,sign(h(m2_6483),skSess_6360)))
                                        )
                                        else
                                            {8259}let v_6484: bool = (Cli_5510 = C) in
                                            (
                                                {8260}if v_6484 then
                                                (
                                                    {8261}let pkCli_6485: bitstring = pub(skC) in
                                                    {8262}let v_6486: bool = (Disco_5511 = A) in
                                                    (
                                                        {8263}if v_6486 then
                                                        (
                                                            {8264}let pkDisco_6487: bitstring = pub(skA) in
                                                            {8265}in(c, (=pkCli_6485,m1_6488: bitstring,sigM1_6489: bitstring));
                                                            {8266}if (verify(h(m1_6488),sigM1_6489,pkCli_6485) <> true) then
                                                                0
                                                            else
                                                                {8267}let (=Sess_5512,SPc_6490: bitstring,PartC_6491: bitstring) = m1_6488 in
                                                                {8268}event endSrv(Cli_5510,Sess_5512,PartC_6491);
                                                                {8269}new Ns_6492: bitstring;
                                                                {8270}let gNs_6493: bitstring = exp(g,Ns_6492) in
                                                                {8271}let m2_6494: bitstring = (Cli_5510,gNs_6493) in
                                                                {8272}event beginSrv(Sess_5512,Cli_5510,gNs_6493);
                                                                {8273}out(c, (m2_6494,sign(h(m2_6494),skSess_6360)))
                                                        )
                                                        else
                                                            {8274}let v_6495: bool = (Disco_5511 = B) in
                                                            (
                                                                {8275}if v_6495 then
                                                                (
                                                                    {8276}let pkDisco_6496: bitstring = pub(skB) in
                                                                    {8277}in(c, (=pkCli_6485,m1_6497: bitstring,sigM1_6498: bitstring));
                                                                    {8278}if (verify(h(m1_6497),sigM1_6498,pkCli_6485) <> true) then
                                                                        0
                                                                    else
                                                                        {8279}let (=Sess_5512,SPc_6499: bitstring,PartC_6500: bitstring) = m1_6497 in
                                                                        {8280}event endSrv(Cli_5510,Sess_5512,PartC_6500);
                                                                        {8281}new Ns_6501: bitstring;
                                                                        {8282}let gNs_6502: bitstring = exp(g,Ns_6501) in
                                                                        {8283}let m2_6503: bitstring = (Cli_5510,gNs_6502) in
                                                                        {8284}event beginSrv(Sess_5512,Cli_5510,gNs_6502);
                                                                        {8285}out(c, (m2_6503,sign(h(m2_6503),skSess_6360)))
                                                                )
                                                                else
                                                                    {8286}let v_6504: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8287}if v_6504 then
                                                                        (
                                                                            {8288}let pkDisco_6505: bitstring = pub(skC) in
                                                                            {8289}in(c, (=pkCli_6485,m1_6506: bitstring,sigM1_6507: bitstring));
                                                                            {8290}if (verify(h(m1_6506),sigM1_6507,pkCli_6485) <> true) then
                                                                                0
                                                                            else
                                                                                {8291}let (=Sess_5512,SPc_6508: bitstring,PartC_6509: bitstring) = m1_6506 in
                                                                                {8292}event endSrv(Cli_5510,Sess_5512,PartC_6509);
                                                                                {8293}new Ns_6510: bitstring;
                                                                                {8294}let gNs_6511: bitstring = exp(g,Ns_6510) in
                                                                                {8295}let m2_6512: bitstring = (Cli_5510,gNs_6511) in
                                                                                {8296}event beginSrv(Sess_5512,Cli_5510,gNs_6511);
                                                                                {8297}out(c, (m2_6512,sign(h(m2_6512),skSess_6360)))
                                                                        )
                                                                        else
                                                                            {8298}let pkDisco_6513: bitstring = pub(skI) in
                                                                            {8299}in(c, (=pkCli_6485,m1_6514: bitstring,sigM1_6515: bitstring));
                                                                            {8300}if (verify(h(m1_6514),sigM1_6515,pkCli_6485) <> true) then
                                                                                0
                                                                            else
                                                                                {8301}let (=Sess_5512,SPc_6516: bitstring,PartC_6517: bitstring) = m1_6514 in
                                                                                {8302}event endSrv(Cli_5510,Sess_5512,PartC_6517);
                                                                                {8303}new Ns_6518: bitstring;
                                                                                {8304}let gNs_6519: bitstring = exp(g,Ns_6518) in
                                                                                {8305}let m2_6520: bitstring = (Cli_5510,gNs_6519) in
                                                                                {8306}event beginSrv(Sess_5512,Cli_5510,gNs_6519);
                                                                                {8307}out(c, (m2_6520,sign(h(m2_6520),skSess_6360)))
                                                                    )
                                                                    else
                                                                        {8308}let pkDisco_6521: bitstring = fail-any in
                                                                        {8309}in(c, (=pkCli_6485,m1_6522: bitstring,sigM1_6523: bitstring));
                                                                        {8310}if (verify(h(m1_6522),sigM1_6523,pkCli_6485) <> true) then
                                                                            0
                                                                        else
                                                                            {8311}let (=Sess_5512,SPc_6524: bitstring,PartC_6525: bitstring) = m1_6522 in
                                                                            {8312}event endSrv(Cli_5510,Sess_5512,PartC_6525);
                                                                            {8313}new Ns_6526: bitstring;
                                                                            {8314}let gNs_6527: bitstring = exp(g,Ns_6526) in
                                                                            {8315}let m2_6528: bitstring = (Cli_5510,gNs_6527) in
                                                                            {8316}event beginSrv(Sess_5512,Cli_5510,gNs_6527);
                                                                            {8317}out(c, (m2_6528,sign(h(m2_6528),skSess_6360)))
                                                            )
                                                            else
                                                                {8318}let pkDisco_6529: bitstring = fail-any in
                                                                {8319}in(c, (=pkCli_6485,m1_6530: bitstring,sigM1_6531: bitstring));
                                                                {8320}if (verify(h(m1_6530),sigM1_6531,pkCli_6485) <> true) then
                                                                    0
                                                                else
                                                                    {8321}let (=Sess_5512,SPc_6532: bitstring,PartC_6533: bitstring) = m1_6530 in
                                                                    {8322}event endSrv(Cli_5510,Sess_5512,PartC_6533);
                                                                    {8323}new Ns_6534: bitstring;
                                                                    {8324}let gNs_6535: bitstring = exp(g,Ns_6534) in
                                                                    {8325}let m2_6536: bitstring = (Cli_5510,gNs_6535) in
                                                                    {8326}event beginSrv(Sess_5512,Cli_5510,gNs_6535);
                                                                    {8327}out(c, (m2_6536,sign(h(m2_6536),skSess_6360)))
                                                    )
                                                    else
                                                        {8328}let pkDisco_6537: bitstring = fail-any in
                                                        {8329}in(c, (=pkCli_6485,m1_6538: bitstring,sigM1_6539: bitstring));
                                                        {8330}if (verify(h(m1_6538),sigM1_6539,pkCli_6485) <> true) then
                                                            0
                                                        else
                                                            {8331}let (=Sess_5512,SPc_6540: bitstring,PartC_6541: bitstring) = m1_6538 in
                                                            {8332}event endSrv(Cli_5510,Sess_5512,PartC_6541);
                                                            {8333}new Ns_6542: bitstring;
                                                            {8334}let gNs_6543: bitstring = exp(g,Ns_6542) in
                                                            {8335}let m2_6544: bitstring = (Cli_5510,gNs_6543) in
                                                            {8336}event beginSrv(Sess_5512,Cli_5510,gNs_6543);
                                                            {8337}out(c, (m2_6544,sign(h(m2_6544),skSess_6360)))
                                                )
                                                else
                                                    {8338}let pkCli_6545: bitstring = pub(skI) in
                                                    {8339}let v_6546: bool = (Disco_5511 = A) in
                                                    (
                                                        {8340}if v_6546 then
                                                        (
                                                            {8341}let pkDisco_6547: bitstring = pub(skA) in
                                                            {8342}in(c, (=pkCli_6545,m1_6548: bitstring,sigM1_6549: bitstring));
                                                            {8343}if (verify(h(m1_6548),sigM1_6549,pkCli_6545) <> true) then
                                                                0
                                                            else
                                                                {8344}let (=Sess_5512,SPc_6550: bitstring,PartC_6551: bitstring) = m1_6548 in
                                                                {8345}event endSrv(Cli_5510,Sess_5512,PartC_6551);
                                                                {8346}new Ns_6552: bitstring;
                                                                {8347}let gNs_6553: bitstring = exp(g,Ns_6552) in
                                                                {8348}let m2_6554: bitstring = (Cli_5510,gNs_6553) in
                                                                {8349}event beginSrv(Sess_5512,Cli_5510,gNs_6553);
                                                                {8350}out(c, (m2_6554,sign(h(m2_6554),skSess_6360)))
                                                        )
                                                        else
                                                            {8351}let v_6555: bool = (Disco_5511 = B) in
                                                            (
                                                                {8352}if v_6555 then
                                                                (
                                                                    {8353}let pkDisco_6556: bitstring = pub(skB) in
                                                                    {8354}in(c, (=pkCli_6545,m1_6557: bitstring,sigM1_6558: bitstring));
                                                                    {8355}if (verify(h(m1_6557),sigM1_6558,pkCli_6545) <> true) then
                                                                        0
                                                                    else
                                                                        {8356}let (=Sess_5512,SPc_6559: bitstring,PartC_6560: bitstring) = m1_6557 in
                                                                        {8357}event endSrv(Cli_5510,Sess_5512,PartC_6560);
                                                                        {8358}new Ns_6561: bitstring;
                                                                        {8359}let gNs_6562: bitstring = exp(g,Ns_6561) in
                                                                        {8360}let m2_6563: bitstring = (Cli_5510,gNs_6562) in
                                                                        {8361}event beginSrv(Sess_5512,Cli_5510,gNs_6562);
                                                                        {8362}out(c, (m2_6563,sign(h(m2_6563),skSess_6360)))
                                                                )
                                                                else
                                                                    {8363}let v_6564: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8364}if v_6564 then
                                                                        (
                                                                            {8365}let pkDisco_6565: bitstring = pub(skC) in
                                                                            {8366}in(c, (=pkCli_6545,m1_6566: bitstring,sigM1_6567: bitstring));
                                                                            {8367}if (verify(h(m1_6566),sigM1_6567,pkCli_6545) <> true) then
                                                                                0
                                                                            else
                                                                                {8368}let (=Sess_5512,SPc_6568: bitstring,PartC_6569: bitstring) = m1_6566 in
                                                                                {8369}event endSrv(Cli_5510,Sess_5512,PartC_6569);
                                                                                {8370}new Ns_6570: bitstring;
                                                                                {8371}let gNs_6571: bitstring = exp(g,Ns_6570) in
                                                                                {8372}let m2_6572: bitstring = (Cli_5510,gNs_6571) in
                                                                                {8373}event beginSrv(Sess_5512,Cli_5510,gNs_6571);
                                                                                {8374}out(c, (m2_6572,sign(h(m2_6572),skSess_6360)))
                                                                        )
                                                                        else
                                                                            {8375}let pkDisco_6573: bitstring = pub(skI) in
                                                                            {8376}in(c, (=pkCli_6545,m1_6574: bitstring,sigM1_6575: bitstring));
                                                                            {8377}if (verify(h(m1_6574),sigM1_6575,pkCli_6545) <> true) then
                                                                                0
                                                                            else
                                                                                {8378}let (=Sess_5512,SPc_6576: bitstring,PartC_6577: bitstring) = m1_6574 in
                                                                                {8379}event endSrv(Cli_5510,Sess_5512,PartC_6577);
                                                                                {8380}new Ns_6578: bitstring;
                                                                                {8381}let gNs_6579: bitstring = exp(g,Ns_6578) in
                                                                                {8382}let m2_6580: bitstring = (Cli_5510,gNs_6579) in
                                                                                {8383}event beginSrv(Sess_5512,Cli_5510,gNs_6579);
                                                                                {8384}out(c, (m2_6580,sign(h(m2_6580),skSess_6360)))
                                                                    )
                                                                    else
                                                                        {8385}let pkDisco_6581: bitstring = fail-any in
                                                                        {8386}in(c, (=pkCli_6545,m1_6582: bitstring,sigM1_6583: bitstring));
                                                                        {8387}if (verify(h(m1_6582),sigM1_6583,pkCli_6545) <> true) then
                                                                            0
                                                                        else
                                                                            {8388}let (=Sess_5512,SPc_6584: bitstring,PartC_6585: bitstring) = m1_6582 in
                                                                            {8389}event endSrv(Cli_5510,Sess_5512,PartC_6585);
                                                                            {8390}new Ns_6586: bitstring;
                                                                            {8391}let gNs_6587: bitstring = exp(g,Ns_6586) in
                                                                            {8392}let m2_6588: bitstring = (Cli_5510,gNs_6587) in
                                                                            {8393}event beginSrv(Sess_5512,Cli_5510,gNs_6587);
                                                                            {8394}out(c, (m2_6588,sign(h(m2_6588),skSess_6360)))
                                                            )
                                                            else
                                                                {8395}let pkDisco_6589: bitstring = fail-any in
                                                                {8396}in(c, (=pkCli_6545,m1_6590: bitstring,sigM1_6591: bitstring));
                                                                {8397}if (verify(h(m1_6590),sigM1_6591,pkCli_6545) <> true) then
                                                                    0
                                                                else
                                                                    {8398}let (=Sess_5512,SPc_6592: bitstring,PartC_6593: bitstring) = m1_6590 in
                                                                    {8399}event endSrv(Cli_5510,Sess_5512,PartC_6593);
                                                                    {8400}new Ns_6594: bitstring;
                                                                    {8401}let gNs_6595: bitstring = exp(g,Ns_6594) in
                                                                    {8402}let m2_6596: bitstring = (Cli_5510,gNs_6595) in
                                                                    {8403}event beginSrv(Sess_5512,Cli_5510,gNs_6595);
                                                                    {8404}out(c, (m2_6596,sign(h(m2_6596),skSess_6360)))
                                                    )
                                                    else
                                                        {8405}let pkDisco_6597: bitstring = fail-any in
                                                        {8406}in(c, (=pkCli_6545,m1_6598: bitstring,sigM1_6599: bitstring));
                                                        {8407}if (verify(h(m1_6598),sigM1_6599,pkCli_6545) <> true) then
                                                            0
                                                        else
                                                            {8408}let (=Sess_5512,SPc_6600: bitstring,PartC_6601: bitstring) = m1_6598 in
                                                            {8409}event endSrv(Cli_5510,Sess_5512,PartC_6601);
                                                            {8410}new Ns_6602: bitstring;
                                                            {8411}let gNs_6603: bitstring = exp(g,Ns_6602) in
                                                            {8412}let m2_6604: bitstring = (Cli_5510,gNs_6603) in
                                                            {8413}event beginSrv(Sess_5512,Cli_5510,gNs_6603);
                                                            {8414}out(c, (m2_6604,sign(h(m2_6604),skSess_6360)))
                                            )
                                            else
                                                {8415}let pkCli_6605: bitstring = fail-any in
                                                {8416}let v_6606: bool = (Disco_5511 = A) in
                                                (
                                                    {8417}if v_6606 then
                                                    (
                                                        {8418}let pkDisco_6607: bitstring = pub(skA) in
                                                        {8419}in(c, (=pkCli_6605,m1_6608: bitstring,sigM1_6609: bitstring));
                                                        {8420}if (verify(h(m1_6608),sigM1_6609,pkCli_6605) <> true) then
                                                            0
                                                        else
                                                            {8421}let (=Sess_5512,SPc_6610: bitstring,PartC_6611: bitstring) = m1_6608 in
                                                            {8422}event endSrv(Cli_5510,Sess_5512,PartC_6611);
                                                            {8423}new Ns_6612: bitstring;
                                                            {8424}let gNs_6613: bitstring = exp(g,Ns_6612) in
                                                            {8425}let m2_6614: bitstring = (Cli_5510,gNs_6613) in
                                                            {8426}event beginSrv(Sess_5512,Cli_5510,gNs_6613);
                                                            {8427}out(c, (m2_6614,sign(h(m2_6614),skSess_6360)))
                                                    )
                                                    else
                                                        {8428}let v_6615: bool = (Disco_5511 = B) in
                                                        (
                                                            {8429}if v_6615 then
                                                            (
                                                                {8430}let pkDisco_6616: bitstring = pub(skB) in
                                                                {8431}in(c, (=pkCli_6605,m1_6617: bitstring,sigM1_6618: bitstring));
                                                                {8432}if (verify(h(m1_6617),sigM1_6618,pkCli_6605) <> true) then
                                                                    0
                                                                else
                                                                    {8433}let (=Sess_5512,SPc_6619: bitstring,PartC_6620: bitstring) = m1_6617 in
                                                                    {8434}event endSrv(Cli_5510,Sess_5512,PartC_6620);
                                                                    {8435}new Ns_6621: bitstring;
                                                                    {8436}let gNs_6622: bitstring = exp(g,Ns_6621) in
                                                                    {8437}let m2_6623: bitstring = (Cli_5510,gNs_6622) in
                                                                    {8438}event beginSrv(Sess_5512,Cli_5510,gNs_6622);
                                                                    {8439}out(c, (m2_6623,sign(h(m2_6623),skSess_6360)))
                                                            )
                                                            else
                                                                {8440}let v_6624: bool = (Disco_5511 = C) in
                                                                (
                                                                    {8441}if v_6624 then
                                                                    (
                                                                        {8442}let pkDisco_6625: bitstring = pub(skC) in
                                                                        {8443}in(c, (=pkCli_6605,m1_6626: bitstring,sigM1_6627: bitstring));
                                                                        {8444}if (verify(h(m1_6626),sigM1_6627,pkCli_6605) <> true) then
                                                                            0
                                                                        else
                                                                            {8445}let (=Sess_5512,SPc_6628: bitstring,PartC_6629: bitstring) = m1_6626 in
                                                                            {8446}event endSrv(Cli_5510,Sess_5512,PartC_6629);
                                                                            {8447}new Ns_6630: bitstring;
                                                                            {8448}let gNs_6631: bitstring = exp(g,Ns_6630) in
                                                                            {8449}let m2_6632: bitstring = (Cli_5510,gNs_6631) in
                                                                            {8450}event beginSrv(Sess_5512,Cli_5510,gNs_6631);
                                                                            {8451}out(c, (m2_6632,sign(h(m2_6632),skSess_6360)))
                                                                    )
                                                                    else
                                                                        {8452}let pkDisco_6633: bitstring = pub(skI) in
                                                                        {8453}in(c, (=pkCli_6605,m1_6634: bitstring,sigM1_6635: bitstring));
                                                                        {8454}if (verify(h(m1_6634),sigM1_6635,pkCli_6605) <> true) then
                                                                            0
                                                                        else
                                                                            {8455}let (=Sess_5512,SPc_6636: bitstring,PartC_6637: bitstring) = m1_6634 in
                                                                            {8456}event endSrv(Cli_5510,Sess_5512,PartC_6637);
                                                                            {8457}new Ns_6638: bitstring;
                                                                            {8458}let gNs_6639: bitstring = exp(g,Ns_6638) in
                                                                            {8459}let m2_6640: bitstring = (Cli_5510,gNs_6639) in
                                                                            {8460}event beginSrv(Sess_5512,Cli_5510,gNs_6639);
                                                                            {8461}out(c, (m2_6640,sign(h(m2_6640),skSess_6360)))
                                                                )
                                                                else
                                                                    {8462}let pkDisco_6641: bitstring = fail-any in
                                                                    {8463}in(c, (=pkCli_6605,m1_6642: bitstring,sigM1_6643: bitstring));
                                                                    {8464}if (verify(h(m1_6642),sigM1_6643,pkCli_6605) <> true) then
                                                                        0
                                                                    else
                                                                        {8465}let (=Sess_5512,SPc_6644: bitstring,PartC_6645: bitstring) = m1_6642 in
                                                                        {8466}event endSrv(Cli_5510,Sess_5512,PartC_6645);
                                                                        {8467}new Ns_6646: bitstring;
                                                                        {8468}let gNs_6647: bitstring = exp(g,Ns_6646) in
                                                                        {8469}let m2_6648: bitstring = (Cli_5510,gNs_6647) in
                                                                        {8470}event beginSrv(Sess_5512,Cli_5510,gNs_6647);
                                                                        {8471}out(c, (m2_6648,sign(h(m2_6648),skSess_6360)))
                                                        )
                                                        else
                                                            {8472}let pkDisco_6649: bitstring = fail-any in
                                                            {8473}in(c, (=pkCli_6605,m1_6650: bitstring,sigM1_6651: bitstring));
                                                            {8474}if (verify(h(m1_6650),sigM1_6651,pkCli_6605) <> true) then
                                                                0
                                                            else
                                                                {8475}let (=Sess_5512,SPc_6652: bitstring,PartC_6653: bitstring) = m1_6650 in
                                                                {8476}event endSrv(Cli_5510,Sess_5512,PartC_6653);
                                                                {8477}new Ns_6654: bitstring;
                                                                {8478}let gNs_6655: bitstring = exp(g,Ns_6654) in
                                                                {8479}let m2_6656: bitstring = (Cli_5510,gNs_6655) in
                                                                {8480}event beginSrv(Sess_5512,Cli_5510,gNs_6655);
                                                                {8481}out(c, (m2_6656,sign(h(m2_6656),skSess_6360)))
                                                )
                                                else
                                                    {8482}let pkDisco_6657: bitstring = fail-any in
                                                    {8483}in(c, (=pkCli_6605,m1_6658: bitstring,sigM1_6659: bitstring));
                                                    {8484}if (verify(h(m1_6658),sigM1_6659,pkCli_6605) <> true) then
                                                        0
                                                    else
                                                        {8485}let (=Sess_5512,SPc_6660: bitstring,PartC_6661: bitstring) = m1_6658 in
                                                        {8486}event endSrv(Cli_5510,Sess_5512,PartC_6661);
                                                        {8487}new Ns_6662: bitstring;
                                                        {8488}let gNs_6663: bitstring = exp(g,Ns_6662) in
                                                        {8489}let m2_6664: bitstring = (Cli_5510,gNs_6663) in
                                                        {8490}event beginSrv(Sess_5512,Cli_5510,gNs_6663);
                                                        {8491}out(c, (m2_6664,sign(h(m2_6664),skSess_6360)))
                                    )
                                    else
                                        {8492}let pkCli_6665: bitstring = fail-any in
                                        {8493}let v_6666: bool = (Disco_5511 = A) in
                                        (
                                            {8494}if v_6666 then
                                            (
                                                {8495}let pkDisco_6667: bitstring = pub(skA) in
                                                {8496}in(c, (=pkCli_6665,m1_6668: bitstring,sigM1_6669: bitstring));
                                                {8497}if (verify(h(m1_6668),sigM1_6669,pkCli_6665) <> true) then
                                                    0
                                                else
                                                    {8498}let (=Sess_5512,SPc_6670: bitstring,PartC_6671: bitstring) = m1_6668 in
                                                    {8499}event endSrv(Cli_5510,Sess_5512,PartC_6671);
                                                    {8500}new Ns_6672: bitstring;
                                                    {8501}let gNs_6673: bitstring = exp(g,Ns_6672) in
                                                    {8502}let m2_6674: bitstring = (Cli_5510,gNs_6673) in
                                                    {8503}event beginSrv(Sess_5512,Cli_5510,gNs_6673);
                                                    {8504}out(c, (m2_6674,sign(h(m2_6674),skSess_6360)))
                                            )
                                            else
                                                {8505}let v_6675: bool = (Disco_5511 = B) in
                                                (
                                                    {8506}if v_6675 then
                                                    (
                                                        {8507}let pkDisco_6676: bitstring = pub(skB) in
                                                        {8508}in(c, (=pkCli_6665,m1_6677: bitstring,sigM1_6678: bitstring));
                                                        {8509}if (verify(h(m1_6677),sigM1_6678,pkCli_6665) <> true) then
                                                            0
                                                        else
                                                            {8510}let (=Sess_5512,SPc_6679: bitstring,PartC_6680: bitstring) = m1_6677 in
                                                            {8511}event endSrv(Cli_5510,Sess_5512,PartC_6680);
                                                            {8512}new Ns_6681: bitstring;
                                                            {8513}let gNs_6682: bitstring = exp(g,Ns_6681) in
                                                            {8514}let m2_6683: bitstring = (Cli_5510,gNs_6682) in
                                                            {8515}event beginSrv(Sess_5512,Cli_5510,gNs_6682);
                                                            {8516}out(c, (m2_6683,sign(h(m2_6683),skSess_6360)))
                                                    )
                                                    else
                                                        {8517}let v_6684: bool = (Disco_5511 = C) in
                                                        (
                                                            {8518}if v_6684 then
                                                            (
                                                                {8519}let pkDisco_6685: bitstring = pub(skC) in
                                                                {8520}in(c, (=pkCli_6665,m1_6686: bitstring,sigM1_6687: bitstring));
                                                                {8521}if (verify(h(m1_6686),sigM1_6687,pkCli_6665) <> true) then
                                                                    0
                                                                else
                                                                    {8522}let (=Sess_5512,SPc_6688: bitstring,PartC_6689: bitstring) = m1_6686 in
                                                                    {8523}event endSrv(Cli_5510,Sess_5512,PartC_6689);
                                                                    {8524}new Ns_6690: bitstring;
                                                                    {8525}let gNs_6691: bitstring = exp(g,Ns_6690) in
                                                                    {8526}let m2_6692: bitstring = (Cli_5510,gNs_6691) in
                                                                    {8527}event beginSrv(Sess_5512,Cli_5510,gNs_6691);
                                                                    {8528}out(c, (m2_6692,sign(h(m2_6692),skSess_6360)))
                                                            )
                                                            else
                                                                {8529}let pkDisco_6693: bitstring = pub(skI) in
                                                                {8530}in(c, (=pkCli_6665,m1_6694: bitstring,sigM1_6695: bitstring));
                                                                {8531}if (verify(h(m1_6694),sigM1_6695,pkCli_6665) <> true) then
                                                                    0
                                                                else
                                                                    {8532}let (=Sess_5512,SPc_6696: bitstring,PartC_6697: bitstring) = m1_6694 in
                                                                    {8533}event endSrv(Cli_5510,Sess_5512,PartC_6697);
                                                                    {8534}new Ns_6698: bitstring;
                                                                    {8535}let gNs_6699: bitstring = exp(g,Ns_6698) in
                                                                    {8536}let m2_6700: bitstring = (Cli_5510,gNs_6699) in
                                                                    {8537}event beginSrv(Sess_5512,Cli_5510,gNs_6699);
                                                                    {8538}out(c, (m2_6700,sign(h(m2_6700),skSess_6360)))
                                                        )
                                                        else
                                                            {8539}let pkDisco_6701: bitstring = fail-any in
                                                            {8540}in(c, (=pkCli_6665,m1_6702: bitstring,sigM1_6703: bitstring));
                                                            {8541}if (verify(h(m1_6702),sigM1_6703,pkCli_6665) <> true) then
                                                                0
                                                            else
                                                                {8542}let (=Sess_5512,SPc_6704: bitstring,PartC_6705: bitstring) = m1_6702 in
                                                                {8543}event endSrv(Cli_5510,Sess_5512,PartC_6705);
                                                                {8544}new Ns_6706: bitstring;
                                                                {8545}let gNs_6707: bitstring = exp(g,Ns_6706) in
                                                                {8546}let m2_6708: bitstring = (Cli_5510,gNs_6707) in
                                                                {8547}event beginSrv(Sess_5512,Cli_5510,gNs_6707);
                                                                {8548}out(c, (m2_6708,sign(h(m2_6708),skSess_6360)))
                                                )
                                                else
                                                    {8549}let pkDisco_6709: bitstring = fail-any in
                                                    {8550}in(c, (=pkCli_6665,m1_6710: bitstring,sigM1_6711: bitstring));
                                                    {8551}if (verify(h(m1_6710),sigM1_6711,pkCli_6665) <> true) then
                                                        0
                                                    else
                                                        {8552}let (=Sess_5512,SPc_6712: bitstring,PartC_6713: bitstring) = m1_6710 in
                                                        {8553}event endSrv(Cli_5510,Sess_5512,PartC_6713);
                                                        {8554}new Ns_6714: bitstring;
                                                        {8555}let gNs_6715: bitstring = exp(g,Ns_6714) in
                                                        {8556}let m2_6716: bitstring = (Cli_5510,gNs_6715) in
                                                        {8557}event beginSrv(Sess_5512,Cli_5510,gNs_6715);
                                                        {8558}out(c, (m2_6716,sign(h(m2_6716),skSess_6360)))
                                        )
                                        else
                                            {8559}let pkDisco_6717: bitstring = fail-any in
                                            {8560}in(c, (=pkCli_6665,m1_6718: bitstring,sigM1_6719: bitstring));
                                            {8561}if (verify(h(m1_6718),sigM1_6719,pkCli_6665) <> true) then
                                                0
                                            else
                                                {8562}let (=Sess_5512,SPc_6720: bitstring,PartC_6721: bitstring) = m1_6718 in
                                                {8563}event endSrv(Cli_5510,Sess_5512,PartC_6721);
                                                {8564}new Ns_6722: bitstring;
                                                {8565}let gNs_6723: bitstring = exp(g,Ns_6722) in
                                                {8566}let m2_6724: bitstring = (Cli_5510,gNs_6723) in
                                                {8567}event beginSrv(Sess_5512,Cli_5510,gNs_6723);
                                                {8568}out(c, (m2_6724,sign(h(m2_6724),skSess_6360)))
                            )
                            else
                                {8569}let pkCli_6725: bitstring = fail-any in
                                {8570}let v_6726: bool = (Disco_5511 = A) in
                                (
                                    {8571}if v_6726 then
                                    (
                                        {8572}let pkDisco_6727: bitstring = pub(skA) in
                                        {8573}in(c, (=pkCli_6725,m1_6728: bitstring,sigM1_6729: bitstring));
                                        {8574}if (verify(h(m1_6728),sigM1_6729,pkCli_6725) <> true) then
                                            0
                                        else
                                            {8575}let (=Sess_5512,SPc_6730: bitstring,PartC_6731: bitstring) = m1_6728 in
                                            {8576}event endSrv(Cli_5510,Sess_5512,PartC_6731);
                                            {8577}new Ns_6732: bitstring;
                                            {8578}let gNs_6733: bitstring = exp(g,Ns_6732) in
                                            {8579}let m2_6734: bitstring = (Cli_5510,gNs_6733) in
                                            {8580}event beginSrv(Sess_5512,Cli_5510,gNs_6733);
                                            {8581}out(c, (m2_6734,sign(h(m2_6734),skSess_6360)))
                                    )
                                    else
                                        {8582}let v_6735: bool = (Disco_5511 = B) in
                                        (
                                            {8583}if v_6735 then
                                            (
                                                {8584}let pkDisco_6736: bitstring = pub(skB) in
                                                {8585}in(c, (=pkCli_6725,m1_6737: bitstring,sigM1_6738: bitstring));
                                                {8586}if (verify(h(m1_6737),sigM1_6738,pkCli_6725) <> true) then
                                                    0
                                                else
                                                    {8587}let (=Sess_5512,SPc_6739: bitstring,PartC_6740: bitstring) = m1_6737 in
                                                    {8588}event endSrv(Cli_5510,Sess_5512,PartC_6740);
                                                    {8589}new Ns_6741: bitstring;
                                                    {8590}let gNs_6742: bitstring = exp(g,Ns_6741) in
                                                    {8591}let m2_6743: bitstring = (Cli_5510,gNs_6742) in
                                                    {8592}event beginSrv(Sess_5512,Cli_5510,gNs_6742);
                                                    {8593}out(c, (m2_6743,sign(h(m2_6743),skSess_6360)))
                                            )
                                            else
                                                {8594}let v_6744: bool = (Disco_5511 = C) in
                                                (
                                                    {8595}if v_6744 then
                                                    (
                                                        {8596}let pkDisco_6745: bitstring = pub(skC) in
                                                        {8597}in(c, (=pkCli_6725,m1_6746: bitstring,sigM1_6747: bitstring));
                                                        {8598}if (verify(h(m1_6746),sigM1_6747,pkCli_6725) <> true) then
                                                            0
                                                        else
                                                            {8599}let (=Sess_5512,SPc_6748: bitstring,PartC_6749: bitstring) = m1_6746 in
                                                            {8600}event endSrv(Cli_5510,Sess_5512,PartC_6749);
                                                            {8601}new Ns_6750: bitstring;
                                                            {8602}let gNs_6751: bitstring = exp(g,Ns_6750) in
                                                            {8603}let m2_6752: bitstring = (Cli_5510,gNs_6751) in
                                                            {8604}event beginSrv(Sess_5512,Cli_5510,gNs_6751);
                                                            {8605}out(c, (m2_6752,sign(h(m2_6752),skSess_6360)))
                                                    )
                                                    else
                                                        {8606}let pkDisco_6753: bitstring = pub(skI) in
                                                        {8607}in(c, (=pkCli_6725,m1_6754: bitstring,sigM1_6755: bitstring));
                                                        {8608}if (verify(h(m1_6754),sigM1_6755,pkCli_6725) <> true) then
                                                            0
                                                        else
                                                            {8609}let (=Sess_5512,SPc_6756: bitstring,PartC_6757: bitstring) = m1_6754 in
                                                            {8610}event endSrv(Cli_5510,Sess_5512,PartC_6757);
                                                            {8611}new Ns_6758: bitstring;
                                                            {8612}let gNs_6759: bitstring = exp(g,Ns_6758) in
                                                            {8613}let m2_6760: bitstring = (Cli_5510,gNs_6759) in
                                                            {8614}event beginSrv(Sess_5512,Cli_5510,gNs_6759);
                                                            {8615}out(c, (m2_6760,sign(h(m2_6760),skSess_6360)))
                                                )
                                                else
                                                    {8616}let pkDisco_6761: bitstring = fail-any in
                                                    {8617}in(c, (=pkCli_6725,m1_6762: bitstring,sigM1_6763: bitstring));
                                                    {8618}if (verify(h(m1_6762),sigM1_6763,pkCli_6725) <> true) then
                                                        0
                                                    else
                                                        {8619}let (=Sess_5512,SPc_6764: bitstring,PartC_6765: bitstring) = m1_6762 in
                                                        {8620}event endSrv(Cli_5510,Sess_5512,PartC_6765);
                                                        {8621}new Ns_6766: bitstring;
                                                        {8622}let gNs_6767: bitstring = exp(g,Ns_6766) in
                                                        {8623}let m2_6768: bitstring = (Cli_5510,gNs_6767) in
                                                        {8624}event beginSrv(Sess_5512,Cli_5510,gNs_6767);
                                                        {8625}out(c, (m2_6768,sign(h(m2_6768),skSess_6360)))
                                        )
                                        else
                                            {8626}let pkDisco_6769: bitstring = fail-any in
                                            {8627}in(c, (=pkCli_6725,m1_6770: bitstring,sigM1_6771: bitstring));
                                            {8628}if (verify(h(m1_6770),sigM1_6771,pkCli_6725) <> true) then
                                                0
                                            else
                                                {8629}let (=Sess_5512,SPc_6772: bitstring,PartC_6773: bitstring) = m1_6770 in
                                                {8630}event endSrv(Cli_5510,Sess_5512,PartC_6773);
                                                {8631}new Ns_6774: bitstring;
                                                {8632}let gNs_6775: bitstring = exp(g,Ns_6774) in
                                                {8633}let m2_6776: bitstring = (Cli_5510,gNs_6775) in
                                                {8634}event beginSrv(Sess_5512,Cli_5510,gNs_6775);
                                                {8635}out(c, (m2_6776,sign(h(m2_6776),skSess_6360)))
                                )
                                else
                                    {8636}let pkDisco_6777: bitstring = fail-any in
                                    {8637}in(c, (=pkCli_6725,m1_6778: bitstring,sigM1_6779: bitstring));
                                    {8638}if (verify(h(m1_6778),sigM1_6779,pkCli_6725) <> true) then
                                        0
                                    else
                                        {8639}let (=Sess_5512,SPc_6780: bitstring,PartC_6781: bitstring) = m1_6778 in
                                        {8640}event endSrv(Cli_5510,Sess_5512,PartC_6781);
                                        {8641}new Ns_6782: bitstring;
                                        {8642}let gNs_6783: bitstring = exp(g,Ns_6782) in
                                        {8643}let m2_6784: bitstring = (Cli_5510,gNs_6783) in
                                        {8644}event beginSrv(Sess_5512,Cli_5510,gNs_6783);
                                        {8645}out(c, (m2_6784,sign(h(m2_6784),skSess_6360)))
                        )
                        else
                            {8646}let skSess_6785: bitstring = skI in
                            {8647}let pkSess_6786: bitstring = pub(skSess_6785) in
                            {8648}let v_6787: bool = (Cli_5510 = A) in
                            (
                                {8649}if v_6787 then
                                (
                                    {8650}let pkCli_6788: bitstring = pub(skA) in
                                    {8651}let v_6789: bool = (Disco_5511 = A) in
                                    (
                                        {8652}if v_6789 then
                                        (
                                            {8653}let pkDisco_6790: bitstring = pub(skA) in
                                            {8654}in(c, (=pkCli_6788,m1_6791: bitstring,sigM1_6792: bitstring));
                                            {8655}if (verify(h(m1_6791),sigM1_6792,pkCli_6788) <> true) then
                                                0
                                            else
                                                {8656}let (=Sess_5512,SPc_6793: bitstring,PartC_6794: bitstring) = m1_6791 in
                                                {8657}event endSrv(Cli_5510,Sess_5512,PartC_6794);
                                                {8658}new Ns_6795: bitstring;
                                                {8659}let gNs_6796: bitstring = exp(g,Ns_6795) in
                                                {8660}let m2_6797: bitstring = (Cli_5510,gNs_6796) in
                                                {8661}event beginSrv(Sess_5512,Cli_5510,gNs_6796);
                                                {8662}out(c, (m2_6797,sign(h(m2_6797),skSess_6785)))
                                        )
                                        else
                                            {8663}let v_6798: bool = (Disco_5511 = B) in
                                            (
                                                {8664}if v_6798 then
                                                (
                                                    {8665}let pkDisco_6799: bitstring = pub(skB) in
                                                    {8666}in(c, (=pkCli_6788,m1_6800: bitstring,sigM1_6801: bitstring));
                                                    {8667}if (verify(h(m1_6800),sigM1_6801,pkCli_6788) <> true) then
                                                        0
                                                    else
                                                        {8668}let (=Sess_5512,SPc_6802: bitstring,PartC_6803: bitstring) = m1_6800 in
                                                        {8669}event endSrv(Cli_5510,Sess_5512,PartC_6803);
                                                        {8670}new Ns_6804: bitstring;
                                                        {8671}let gNs_6805: bitstring = exp(g,Ns_6804) in
                                                        {8672}let m2_6806: bitstring = (Cli_5510,gNs_6805) in
                                                        {8673}event beginSrv(Sess_5512,Cli_5510,gNs_6805);
                                                        {8674}out(c, (m2_6806,sign(h(m2_6806),skSess_6785)))
                                                )
                                                else
                                                    {8675}let v_6807: bool = (Disco_5511 = C) in
                                                    (
                                                        {8676}if v_6807 then
                                                        (
                                                            {8677}let pkDisco_6808: bitstring = pub(skC) in
                                                            {8678}in(c, (=pkCli_6788,m1_6809: bitstring,sigM1_6810: bitstring));
                                                            {8679}if (verify(h(m1_6809),sigM1_6810,pkCli_6788) <> true) then
                                                                0
                                                            else
                                                                {8680}let (=Sess_5512,SPc_6811: bitstring,PartC_6812: bitstring) = m1_6809 in
                                                                {8681}event endSrv(Cli_5510,Sess_5512,PartC_6812);
                                                                {8682}new Ns_6813: bitstring;
                                                                {8683}let gNs_6814: bitstring = exp(g,Ns_6813) in
                                                                {8684}let m2_6815: bitstring = (Cli_5510,gNs_6814) in
                                                                {8685}event beginSrv(Sess_5512,Cli_5510,gNs_6814);
                                                                {8686}out(c, (m2_6815,sign(h(m2_6815),skSess_6785)))
                                                        )
                                                        else
                                                            {8687}let pkDisco_6816: bitstring = pub(skI) in
                                                            {8688}in(c, (=pkCli_6788,m1_6817: bitstring,sigM1_6818: bitstring));
                                                            {8689}if (verify(h(m1_6817),sigM1_6818,pkCli_6788) <> true) then
                                                                0
                                                            else
                                                                {8690}let (=Sess_5512,SPc_6819: bitstring,PartC_6820: bitstring) = m1_6817 in
                                                                {8691}event endSrv(Cli_5510,Sess_5512,PartC_6820);
                                                                {8692}new Ns_6821: bitstring;
                                                                {8693}let gNs_6822: bitstring = exp(g,Ns_6821) in
                                                                {8694}let m2_6823: bitstring = (Cli_5510,gNs_6822) in
                                                                {8695}event beginSrv(Sess_5512,Cli_5510,gNs_6822);
                                                                {8696}out(c, (m2_6823,sign(h(m2_6823),skSess_6785)))
                                                    )
                                                    else
                                                        {8697}let pkDisco_6824: bitstring = fail-any in
                                                        {8698}in(c, (=pkCli_6788,m1_6825: bitstring,sigM1_6826: bitstring));
                                                        {8699}if (verify(h(m1_6825),sigM1_6826,pkCli_6788) <> true) then
                                                            0
                                                        else
                                                            {8700}let (=Sess_5512,SPc_6827: bitstring,PartC_6828: bitstring) = m1_6825 in
                                                            {8701}event endSrv(Cli_5510,Sess_5512,PartC_6828);
                                                            {8702}new Ns_6829: bitstring;
                                                            {8703}let gNs_6830: bitstring = exp(g,Ns_6829) in
                                                            {8704}let m2_6831: bitstring = (Cli_5510,gNs_6830) in
                                                            {8705}event beginSrv(Sess_5512,Cli_5510,gNs_6830);
                                                            {8706}out(c, (m2_6831,sign(h(m2_6831),skSess_6785)))
                                            )
                                            else
                                                {8707}let pkDisco_6832: bitstring = fail-any in
                                                {8708}in(c, (=pkCli_6788,m1_6833: bitstring,sigM1_6834: bitstring));
                                                {8709}if (verify(h(m1_6833),sigM1_6834,pkCli_6788) <> true) then
                                                    0
                                                else
                                                    {8710}let (=Sess_5512,SPc_6835: bitstring,PartC_6836: bitstring) = m1_6833 in
                                                    {8711}event endSrv(Cli_5510,Sess_5512,PartC_6836);
                                                    {8712}new Ns_6837: bitstring;
                                                    {8713}let gNs_6838: bitstring = exp(g,Ns_6837) in
                                                    {8714}let m2_6839: bitstring = (Cli_5510,gNs_6838) in
                                                    {8715}event beginSrv(Sess_5512,Cli_5510,gNs_6838);
                                                    {8716}out(c, (m2_6839,sign(h(m2_6839),skSess_6785)))
                                    )
                                    else
                                        {8717}let pkDisco_6840: bitstring = fail-any in
                                        {8718}in(c, (=pkCli_6788,m1_6841: bitstring,sigM1_6842: bitstring));
                                        {8719}if (verify(h(m1_6841),sigM1_6842,pkCli_6788) <> true) then
                                            0
                                        else
                                            {8720}let (=Sess_5512,SPc_6843: bitstring,PartC_6844: bitstring) = m1_6841 in
                                            {8721}event endSrv(Cli_5510,Sess_5512,PartC_6844);
                                            {8722}new Ns_6845: bitstring;
                                            {8723}let gNs_6846: bitstring = exp(g,Ns_6845) in
                                            {8724}let m2_6847: bitstring = (Cli_5510,gNs_6846) in
                                            {8725}event beginSrv(Sess_5512,Cli_5510,gNs_6846);
                                            {8726}out(c, (m2_6847,sign(h(m2_6847),skSess_6785)))
                                )
                                else
                                    {8727}let v_6848: bool = (Cli_5510 = B) in
                                    (
                                        {8728}if v_6848 then
                                        (
                                            {8729}let pkCli_6849: bitstring = pub(skB) in
                                            {8730}let v_6850: bool = (Disco_5511 = A) in
                                            (
                                                {8731}if v_6850 then
                                                (
                                                    {8732}let pkDisco_6851: bitstring = pub(skA) in
                                                    {8733}in(c, (=pkCli_6849,m1_6852: bitstring,sigM1_6853: bitstring));
                                                    {8734}if (verify(h(m1_6852),sigM1_6853,pkCli_6849) <> true) then
                                                        0
                                                    else
                                                        {8735}let (=Sess_5512,SPc_6854: bitstring,PartC_6855: bitstring) = m1_6852 in
                                                        {8736}event endSrv(Cli_5510,Sess_5512,PartC_6855);
                                                        {8737}new Ns_6856: bitstring;
                                                        {8738}let gNs_6857: bitstring = exp(g,Ns_6856) in
                                                        {8739}let m2_6858: bitstring = (Cli_5510,gNs_6857) in
                                                        {8740}event beginSrv(Sess_5512,Cli_5510,gNs_6857);
                                                        {8741}out(c, (m2_6858,sign(h(m2_6858),skSess_6785)))
                                                )
                                                else
                                                    {8742}let v_6859: bool = (Disco_5511 = B) in
                                                    (
                                                        {8743}if v_6859 then
                                                        (
                                                            {8744}let pkDisco_6860: bitstring = pub(skB) in
                                                            {8745}in(c, (=pkCli_6849,m1_6861: bitstring,sigM1_6862: bitstring));
                                                            {8746}if (verify(h(m1_6861),sigM1_6862,pkCli_6849) <> true) then
                                                                0
                                                            else
                                                                {8747}let (=Sess_5512,SPc_6863: bitstring,PartC_6864: bitstring) = m1_6861 in
                                                                {8748}event endSrv(Cli_5510,Sess_5512,PartC_6864);
                                                                {8749}new Ns_6865: bitstring;
                                                                {8750}let gNs_6866: bitstring = exp(g,Ns_6865) in
                                                                {8751}let m2_6867: bitstring = (Cli_5510,gNs_6866) in
                                                                {8752}event beginSrv(Sess_5512,Cli_5510,gNs_6866);
                                                                {8753}out(c, (m2_6867,sign(h(m2_6867),skSess_6785)))
                                                        )
                                                        else
                                                            {8754}let v_6868: bool = (Disco_5511 = C) in
                                                            (
                                                                {8755}if v_6868 then
                                                                (
                                                                    {8756}let pkDisco_6869: bitstring = pub(skC) in
                                                                    {8757}in(c, (=pkCli_6849,m1_6870: bitstring,sigM1_6871: bitstring));
                                                                    {8758}if (verify(h(m1_6870),sigM1_6871,pkCli_6849) <> true) then
                                                                        0
                                                                    else
                                                                        {8759}let (=Sess_5512,SPc_6872: bitstring,PartC_6873: bitstring) = m1_6870 in
                                                                        {8760}event endSrv(Cli_5510,Sess_5512,PartC_6873);
                                                                        {8761}new Ns_6874: bitstring;
                                                                        {8762}let gNs_6875: bitstring = exp(g,Ns_6874) in
                                                                        {8763}let m2_6876: bitstring = (Cli_5510,gNs_6875) in
                                                                        {8764}event beginSrv(Sess_5512,Cli_5510,gNs_6875);
                                                                        {8765}out(c, (m2_6876,sign(h(m2_6876),skSess_6785)))
                                                                )
                                                                else
                                                                    {8766}let pkDisco_6877: bitstring = pub(skI) in
                                                                    {8767}in(c, (=pkCli_6849,m1_6878: bitstring,sigM1_6879: bitstring));
                                                                    {8768}if (verify(h(m1_6878),sigM1_6879,pkCli_6849) <> true) then
                                                                        0
                                                                    else
                                                                        {8769}let (=Sess_5512,SPc_6880: bitstring,PartC_6881: bitstring) = m1_6878 in
                                                                        {8770}event endSrv(Cli_5510,Sess_5512,PartC_6881);
                                                                        {8771}new Ns_6882: bitstring;
                                                                        {8772}let gNs_6883: bitstring = exp(g,Ns_6882) in
                                                                        {8773}let m2_6884: bitstring = (Cli_5510,gNs_6883) in
                                                                        {8774}event beginSrv(Sess_5512,Cli_5510,gNs_6883);
                                                                        {8775}out(c, (m2_6884,sign(h(m2_6884),skSess_6785)))
                                                            )
                                                            else
                                                                {8776}let pkDisco_6885: bitstring = fail-any in
                                                                {8777}in(c, (=pkCli_6849,m1_6886: bitstring,sigM1_6887: bitstring));
                                                                {8778}if (verify(h(m1_6886),sigM1_6887,pkCli_6849) <> true) then
                                                                    0
                                                                else
                                                                    {8779}let (=Sess_5512,SPc_6888: bitstring,PartC_6889: bitstring) = m1_6886 in
                                                                    {8780}event endSrv(Cli_5510,Sess_5512,PartC_6889);
                                                                    {8781}new Ns_6890: bitstring;
                                                                    {8782}let gNs_6891: bitstring = exp(g,Ns_6890) in
                                                                    {8783}let m2_6892: bitstring = (Cli_5510,gNs_6891) in
                                                                    {8784}event beginSrv(Sess_5512,Cli_5510,gNs_6891);
                                                                    {8785}out(c, (m2_6892,sign(h(m2_6892),skSess_6785)))
                                                    )
                                                    else
                                                        {8786}let pkDisco_6893: bitstring = fail-any in
                                                        {8787}in(c, (=pkCli_6849,m1_6894: bitstring,sigM1_6895: bitstring));
                                                        {8788}if (verify(h(m1_6894),sigM1_6895,pkCli_6849) <> true) then
                                                            0
                                                        else
                                                            {8789}let (=Sess_5512,SPc_6896: bitstring,PartC_6897: bitstring) = m1_6894 in
                                                            {8790}event endSrv(Cli_5510,Sess_5512,PartC_6897);
                                                            {8791}new Ns_6898: bitstring;
                                                            {8792}let gNs_6899: bitstring = exp(g,Ns_6898) in
                                                            {8793}let m2_6900: bitstring = (Cli_5510,gNs_6899) in
                                                            {8794}event beginSrv(Sess_5512,Cli_5510,gNs_6899);
                                                            {8795}out(c, (m2_6900,sign(h(m2_6900),skSess_6785)))
                                            )
                                            else
                                                {8796}let pkDisco_6901: bitstring = fail-any in
                                                {8797}in(c, (=pkCli_6849,m1_6902: bitstring,sigM1_6903: bitstring));
                                                {8798}if (verify(h(m1_6902),sigM1_6903,pkCli_6849) <> true) then
                                                    0
                                                else
                                                    {8799}let (=Sess_5512,SPc_6904: bitstring,PartC_6905: bitstring) = m1_6902 in
                                                    {8800}event endSrv(Cli_5510,Sess_5512,PartC_6905);
                                                    {8801}new Ns_6906: bitstring;
                                                    {8802}let gNs_6907: bitstring = exp(g,Ns_6906) in
                                                    {8803}let m2_6908: bitstring = (Cli_5510,gNs_6907) in
                                                    {8804}event beginSrv(Sess_5512,Cli_5510,gNs_6907);
                                                    {8805}out(c, (m2_6908,sign(h(m2_6908),skSess_6785)))
                                        )
                                        else
                                            {8806}let v_6909: bool = (Cli_5510 = C) in
                                            (
                                                {8807}if v_6909 then
                                                (
                                                    {8808}let pkCli_6910: bitstring = pub(skC) in
                                                    {8809}let v_6911: bool = (Disco_5511 = A) in
                                                    (
                                                        {8810}if v_6911 then
                                                        (
                                                            {8811}let pkDisco_6912: bitstring = pub(skA) in
                                                            {8812}in(c, (=pkCli_6910,m1_6913: bitstring,sigM1_6914: bitstring));
                                                            {8813}if (verify(h(m1_6913),sigM1_6914,pkCli_6910) <> true) then
                                                                0
                                                            else
                                                                {8814}let (=Sess_5512,SPc_6915: bitstring,PartC_6916: bitstring) = m1_6913 in
                                                                {8815}event endSrv(Cli_5510,Sess_5512,PartC_6916);
                                                                {8816}new Ns_6917: bitstring;
                                                                {8817}let gNs_6918: bitstring = exp(g,Ns_6917) in
                                                                {8818}let m2_6919: bitstring = (Cli_5510,gNs_6918) in
                                                                {8819}event beginSrv(Sess_5512,Cli_5510,gNs_6918);
                                                                {8820}out(c, (m2_6919,sign(h(m2_6919),skSess_6785)))
                                                        )
                                                        else
                                                            {8821}let v_6920: bool = (Disco_5511 = B) in
                                                            (
                                                                {8822}if v_6920 then
                                                                (
                                                                    {8823}let pkDisco_6921: bitstring = pub(skB) in
                                                                    {8824}in(c, (=pkCli_6910,m1_6922: bitstring,sigM1_6923: bitstring));
                                                                    {8825}if (verify(h(m1_6922),sigM1_6923,pkCli_6910) <> true) then
                                                                        0
                                                                    else
                                                                        {8826}let (=Sess_5512,SPc_6924: bitstring,PartC_6925: bitstring) = m1_6922 in
                                                                        {8827}event endSrv(Cli_5510,Sess_5512,PartC_6925);
                                                                        {8828}new Ns_6926: bitstring;
                                                                        {8829}let gNs_6927: bitstring = exp(g,Ns_6926) in
                                                                        {8830}let m2_6928: bitstring = (Cli_5510,gNs_6927) in
                                                                        {8831}event beginSrv(Sess_5512,Cli_5510,gNs_6927);
                                                                        {8832}out(c, (m2_6928,sign(h(m2_6928),skSess_6785)))
                                                                )
                                                                else
                                                                    {8833}let v_6929: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8834}if v_6929 then
                                                                        (
                                                                            {8835}let pkDisco_6930: bitstring = pub(skC) in
                                                                            {8836}in(c, (=pkCli_6910,m1_6931: bitstring,sigM1_6932: bitstring));
                                                                            {8837}if (verify(h(m1_6931),sigM1_6932,pkCli_6910) <> true) then
                                                                                0
                                                                            else
                                                                                {8838}let (=Sess_5512,SPc_6933: bitstring,PartC_6934: bitstring) = m1_6931 in
                                                                                {8839}event endSrv(Cli_5510,Sess_5512,PartC_6934);
                                                                                {8840}new Ns_6935: bitstring;
                                                                                {8841}let gNs_6936: bitstring = exp(g,Ns_6935) in
                                                                                {8842}let m2_6937: bitstring = (Cli_5510,gNs_6936) in
                                                                                {8843}event beginSrv(Sess_5512,Cli_5510,gNs_6936);
                                                                                {8844}out(c, (m2_6937,sign(h(m2_6937),skSess_6785)))
                                                                        )
                                                                        else
                                                                            {8845}let pkDisco_6938: bitstring = pub(skI) in
                                                                            {8846}in(c, (=pkCli_6910,m1_6939: bitstring,sigM1_6940: bitstring));
                                                                            {8847}if (verify(h(m1_6939),sigM1_6940,pkCli_6910) <> true) then
                                                                                0
                                                                            else
                                                                                {8848}let (=Sess_5512,SPc_6941: bitstring,PartC_6942: bitstring) = m1_6939 in
                                                                                {8849}event endSrv(Cli_5510,Sess_5512,PartC_6942);
                                                                                {8850}new Ns_6943: bitstring;
                                                                                {8851}let gNs_6944: bitstring = exp(g,Ns_6943) in
                                                                                {8852}let m2_6945: bitstring = (Cli_5510,gNs_6944) in
                                                                                {8853}event beginSrv(Sess_5512,Cli_5510,gNs_6944);
                                                                                {8854}out(c, (m2_6945,sign(h(m2_6945),skSess_6785)))
                                                                    )
                                                                    else
                                                                        {8855}let pkDisco_6946: bitstring = fail-any in
                                                                        {8856}in(c, (=pkCli_6910,m1_6947: bitstring,sigM1_6948: bitstring));
                                                                        {8857}if (verify(h(m1_6947),sigM1_6948,pkCli_6910) <> true) then
                                                                            0
                                                                        else
                                                                            {8858}let (=Sess_5512,SPc_6949: bitstring,PartC_6950: bitstring) = m1_6947 in
                                                                            {8859}event endSrv(Cli_5510,Sess_5512,PartC_6950);
                                                                            {8860}new Ns_6951: bitstring;
                                                                            {8861}let gNs_6952: bitstring = exp(g,Ns_6951) in
                                                                            {8862}let m2_6953: bitstring = (Cli_5510,gNs_6952) in
                                                                            {8863}event beginSrv(Sess_5512,Cli_5510,gNs_6952);
                                                                            {8864}out(c, (m2_6953,sign(h(m2_6953),skSess_6785)))
                                                            )
                                                            else
                                                                {8865}let pkDisco_6954: bitstring = fail-any in
                                                                {8866}in(c, (=pkCli_6910,m1_6955: bitstring,sigM1_6956: bitstring));
                                                                {8867}if (verify(h(m1_6955),sigM1_6956,pkCli_6910) <> true) then
                                                                    0
                                                                else
                                                                    {8868}let (=Sess_5512,SPc_6957: bitstring,PartC_6958: bitstring) = m1_6955 in
                                                                    {8869}event endSrv(Cli_5510,Sess_5512,PartC_6958);
                                                                    {8870}new Ns_6959: bitstring;
                                                                    {8871}let gNs_6960: bitstring = exp(g,Ns_6959) in
                                                                    {8872}let m2_6961: bitstring = (Cli_5510,gNs_6960) in
                                                                    {8873}event beginSrv(Sess_5512,Cli_5510,gNs_6960);
                                                                    {8874}out(c, (m2_6961,sign(h(m2_6961),skSess_6785)))
                                                    )
                                                    else
                                                        {8875}let pkDisco_6962: bitstring = fail-any in
                                                        {8876}in(c, (=pkCli_6910,m1_6963: bitstring,sigM1_6964: bitstring));
                                                        {8877}if (verify(h(m1_6963),sigM1_6964,pkCli_6910) <> true) then
                                                            0
                                                        else
                                                            {8878}let (=Sess_5512,SPc_6965: bitstring,PartC_6966: bitstring) = m1_6963 in
                                                            {8879}event endSrv(Cli_5510,Sess_5512,PartC_6966);
                                                            {8880}new Ns_6967: bitstring;
                                                            {8881}let gNs_6968: bitstring = exp(g,Ns_6967) in
                                                            {8882}let m2_6969: bitstring = (Cli_5510,gNs_6968) in
                                                            {8883}event beginSrv(Sess_5512,Cli_5510,gNs_6968);
                                                            {8884}out(c, (m2_6969,sign(h(m2_6969),skSess_6785)))
                                                )
                                                else
                                                    {8885}let pkCli_6970: bitstring = pub(skI) in
                                                    {8886}let v_6971: bool = (Disco_5511 = A) in
                                                    (
                                                        {8887}if v_6971 then
                                                        (
                                                            {8888}let pkDisco_6972: bitstring = pub(skA) in
                                                            {8889}in(c, (=pkCli_6970,m1_6973: bitstring,sigM1_6974: bitstring));
                                                            {8890}if (verify(h(m1_6973),sigM1_6974,pkCli_6970) <> true) then
                                                                0
                                                            else
                                                                {8891}let (=Sess_5512,SPc_6975: bitstring,PartC_6976: bitstring) = m1_6973 in
                                                                {8892}event endSrv(Cli_5510,Sess_5512,PartC_6976);
                                                                {8893}new Ns_6977: bitstring;
                                                                {8894}let gNs_6978: bitstring = exp(g,Ns_6977) in
                                                                {8895}let m2_6979: bitstring = (Cli_5510,gNs_6978) in
                                                                {8896}event beginSrv(Sess_5512,Cli_5510,gNs_6978);
                                                                {8897}out(c, (m2_6979,sign(h(m2_6979),skSess_6785)))
                                                        )
                                                        else
                                                            {8898}let v_6980: bool = (Disco_5511 = B) in
                                                            (
                                                                {8899}if v_6980 then
                                                                (
                                                                    {8900}let pkDisco_6981: bitstring = pub(skB) in
                                                                    {8901}in(c, (=pkCli_6970,m1_6982: bitstring,sigM1_6983: bitstring));
                                                                    {8902}if (verify(h(m1_6982),sigM1_6983,pkCli_6970) <> true) then
                                                                        0
                                                                    else
                                                                        {8903}let (=Sess_5512,SPc_6984: bitstring,PartC_6985: bitstring) = m1_6982 in
                                                                        {8904}event endSrv(Cli_5510,Sess_5512,PartC_6985);
                                                                        {8905}new Ns_6986: bitstring;
                                                                        {8906}let gNs_6987: bitstring = exp(g,Ns_6986) in
                                                                        {8907}let m2_6988: bitstring = (Cli_5510,gNs_6987) in
                                                                        {8908}event beginSrv(Sess_5512,Cli_5510,gNs_6987);
                                                                        {8909}out(c, (m2_6988,sign(h(m2_6988),skSess_6785)))
                                                                )
                                                                else
                                                                    {8910}let v_6989: bool = (Disco_5511 = C) in
                                                                    (
                                                                        {8911}if v_6989 then
                                                                        (
                                                                            {8912}let pkDisco_6990: bitstring = pub(skC) in
                                                                            {8913}in(c, (=pkCli_6970,m1_6991: bitstring,sigM1_6992: bitstring));
                                                                            {8914}if (verify(h(m1_6991),sigM1_6992,pkCli_6970) <> true) then
                                                                                0
                                                                            else
                                                                                {8915}let (=Sess_5512,SPc_6993: bitstring,PartC_6994: bitstring) = m1_6991 in
                                                                                {8916}event endSrv(Cli_5510,Sess_5512,PartC_6994);
                                                                                {8917}new Ns_6995: bitstring;
                                                                                {8918}let gNs_6996: bitstring = exp(g,Ns_6995) in
                                                                                {8919}let m2_6997: bitstring = (Cli_5510,gNs_6996) in
                                                                                {8920}event beginSrv(Sess_5512,Cli_5510,gNs_6996);
                                                                                {8921}out(c, (m2_6997,sign(h(m2_6997),skSess_6785)))
                                                                        )
                                                                        else
                                                                            {8922}let pkDisco_6998: bitstring = pub(skI) in
                                                                            {8923}in(c, (=pkCli_6970,m1_6999: bitstring,sigM1_7000: bitstring));
                                                                            {8924}if (verify(h(m1_6999),sigM1_7000,pkCli_6970) <> true) then
                                                                                0
                                                                            else
                                                                                {8925}let (=Sess_5512,SPc_7001: bitstring,PartC_7002: bitstring) = m1_6999 in
                                                                                {8926}event endSrv(Cli_5510,Sess_5512,PartC_7002);
                                                                                {8927}new Ns_7003: bitstring;
                                                                                {8928}let gNs_7004: bitstring = exp(g,Ns_7003) in
                                                                                {8929}let m2_7005: bitstring = (Cli_5510,gNs_7004) in
                                                                                {8930}event beginSrv(Sess_5512,Cli_5510,gNs_7004);
                                                                                {8931}out(c, (m2_7005,sign(h(m2_7005),skSess_6785)))
                                                                    )
                                                                    else
                                                                        {8932}let pkDisco_7006: bitstring = fail-any in
                                                                        {8933}in(c, (=pkCli_6970,m1_7007: bitstring,sigM1_7008: bitstring));
                                                                        {8934}if (verify(h(m1_7007),sigM1_7008,pkCli_6970) <> true) then
                                                                            0
                                                                        else
                                                                            {8935}let (=Sess_5512,SPc_7009: bitstring,PartC_7010: bitstring) = m1_7007 in
                                                                            {8936}event endSrv(Cli_5510,Sess_5512,PartC_7010);
                                                                            {8937}new Ns_7011: bitstring;
                                                                            {8938}let gNs_7012: bitstring = exp(g,Ns_7011) in
                                                                            {8939}let m2_7013: bitstring = (Cli_5510,gNs_7012) in
                                                                            {8940}event beginSrv(Sess_5512,Cli_5510,gNs_7012);
                                                                            {8941}out(c, (m2_7013,sign(h(m2_7013),skSess_6785)))
                                                            )
                                                            else
                                                                {8942}let pkDisco_7014: bitstring = fail-any in
                                                                {8943}in(c, (=pkCli_6970,m1_7015: bitstring,sigM1_7016: bitstring));
                                                                {8944}if (verify(h(m1_7015),sigM1_7016,pkCli_6970) <> true) then
                                                                    0
                                                                else
                                                                    {8945}let (=Sess_5512,SPc_7017: bitstring,PartC_7018: bitstring) = m1_7015 in
                                                                    {8946}event endSrv(Cli_5510,Sess_5512,PartC_7018);
                                                                    {8947}new Ns_7019: bitstring;
                                                                    {8948}let gNs_7020: bitstring = exp(g,Ns_7019) in
                                                                    {8949}let m2_7021: bitstring = (Cli_5510,gNs_7020) in
                                                                    {8950}event beginSrv(Sess_5512,Cli_5510,gNs_7020);
                                                                    {8951}out(c, (m2_7021,sign(h(m2_7021),skSess_6785)))
                                                    )
                                                    else
                                                        {8952}let pkDisco_7022: bitstring = fail-any in
                                                        {8953}in(c, (=pkCli_6970,m1_7023: bitstring,sigM1_7024: bitstring));
                                                        {8954}if (verify(h(m1_7023),sigM1_7024,pkCli_6970) <> true) then
                                                            0
                                                        else
                                                            {8955}let (=Sess_5512,SPc_7025: bitstring,PartC_7026: bitstring) = m1_7023 in
                                                            {8956}event endSrv(Cli_5510,Sess_5512,PartC_7026);
                                                            {8957}new Ns_7027: bitstring;
                                                            {8958}let gNs_7028: bitstring = exp(g,Ns_7027) in
                                                            {8959}let m2_7029: bitstring = (Cli_5510,gNs_7028) in
                                                            {8960}event beginSrv(Sess_5512,Cli_5510,gNs_7028);
                                                            {8961}out(c, (m2_7029,sign(h(m2_7029),skSess_6785)))
                                            )
                                            else
                                                {8962}let pkCli_7030: bitstring = fail-any in
                                                {8963}let v_7031: bool = (Disco_5511 = A) in
                                                (
                                                    {8964}if v_7031 then
                                                    (
                                                        {8965}let pkDisco_7032: bitstring = pub(skA) in
                                                        {8966}in(c, (=pkCli_7030,m1_7033: bitstring,sigM1_7034: bitstring));
                                                        {8967}if (verify(h(m1_7033),sigM1_7034,pkCli_7030) <> true) then
                                                            0
                                                        else
                                                            {8968}let (=Sess_5512,SPc_7035: bitstring,PartC_7036: bitstring) = m1_7033 in
                                                            {8969}event endSrv(Cli_5510,Sess_5512,PartC_7036);
                                                            {8970}new Ns_7037: bitstring;
                                                            {8971}let gNs_7038: bitstring = exp(g,Ns_7037) in
                                                            {8972}let m2_7039: bitstring = (Cli_5510,gNs_7038) in
                                                            {8973}event beginSrv(Sess_5512,Cli_5510,gNs_7038);
                                                            {8974}out(c, (m2_7039,sign(h(m2_7039),skSess_6785)))
                                                    )
                                                    else
                                                        {8975}let v_7040: bool = (Disco_5511 = B) in
                                                        (
                                                            {8976}if v_7040 then
                                                            (
                                                                {8977}let pkDisco_7041: bitstring = pub(skB) in
                                                                {8978}in(c, (=pkCli_7030,m1_7042: bitstring,sigM1_7043: bitstring));
                                                                {8979}if (verify(h(m1_7042),sigM1_7043,pkCli_7030) <> true) then
                                                                    0
                                                                else
                                                                    {8980}let (=Sess_5512,SPc_7044: bitstring,PartC_7045: bitstring) = m1_7042 in
                                                                    {8981}event endSrv(Cli_5510,Sess_5512,PartC_7045);
                                                                    {8982}new Ns_7046: bitstring;
                                                                    {8983}let gNs_7047: bitstring = exp(g,Ns_7046) in
                                                                    {8984}let m2_7048: bitstring = (Cli_5510,gNs_7047) in
                                                                    {8985}event beginSrv(Sess_5512,Cli_5510,gNs_7047);
                                                                    {8986}out(c, (m2_7048,sign(h(m2_7048),skSess_6785)))
                                                            )
                                                            else
                                                                {8987}let v_7049: bool = (Disco_5511 = C) in
                                                                (
                                                                    {8988}if v_7049 then
                                                                    (
                                                                        {8989}let pkDisco_7050: bitstring = pub(skC) in
                                                                        {8990}in(c, (=pkCli_7030,m1_7051: bitstring,sigM1_7052: bitstring));
                                                                        {8991}if (verify(h(m1_7051),sigM1_7052,pkCli_7030) <> true) then
                                                                            0
                                                                        else
                                                                            {8992}let (=Sess_5512,SPc_7053: bitstring,PartC_7054: bitstring) = m1_7051 in
                                                                            {8993}event endSrv(Cli_5510,Sess_5512,PartC_7054);
                                                                            {8994}new Ns_7055: bitstring;
                                                                            {8995}let gNs_7056: bitstring = exp(g,Ns_7055) in
                                                                            {8996}let m2_7057: bitstring = (Cli_5510,gNs_7056) in
                                                                            {8997}event beginSrv(Sess_5512,Cli_5510,gNs_7056);
                                                                            {8998}out(c, (m2_7057,sign(h(m2_7057),skSess_6785)))
                                                                    )
                                                                    else
                                                                        {8999}let pkDisco_7058: bitstring = pub(skI) in
                                                                        {9000}in(c, (=pkCli_7030,m1_7059: bitstring,sigM1_7060: bitstring));
                                                                        {9001}if (verify(h(m1_7059),sigM1_7060,pkCli_7030) <> true) then
                                                                            0
                                                                        else
                                                                            {9002}let (=Sess_5512,SPc_7061: bitstring,PartC_7062: bitstring) = m1_7059 in
                                                                            {9003}event endSrv(Cli_5510,Sess_5512,PartC_7062);
                                                                            {9004}new Ns_7063: bitstring;
                                                                            {9005}let gNs_7064: bitstring = exp(g,Ns_7063) in
                                                                            {9006}let m2_7065: bitstring = (Cli_5510,gNs_7064) in
                                                                            {9007}event beginSrv(Sess_5512,Cli_5510,gNs_7064);
                                                                            {9008}out(c, (m2_7065,sign(h(m2_7065),skSess_6785)))
                                                                )
                                                                else
                                                                    {9009}let pkDisco_7066: bitstring = fail-any in
                                                                    {9010}in(c, (=pkCli_7030,m1_7067: bitstring,sigM1_7068: bitstring));
                                                                    {9011}if (verify(h(m1_7067),sigM1_7068,pkCli_7030) <> true) then
                                                                        0
                                                                    else
                                                                        {9012}let (=Sess_5512,SPc_7069: bitstring,PartC_7070: bitstring) = m1_7067 in
                                                                        {9013}event endSrv(Cli_5510,Sess_5512,PartC_7070);
                                                                        {9014}new Ns_7071: bitstring;
                                                                        {9015}let gNs_7072: bitstring = exp(g,Ns_7071) in
                                                                        {9016}let m2_7073: bitstring = (Cli_5510,gNs_7072) in
                                                                        {9017}event beginSrv(Sess_5512,Cli_5510,gNs_7072);
                                                                        {9018}out(c, (m2_7073,sign(h(m2_7073),skSess_6785)))
                                                        )
                                                        else
                                                            {9019}let pkDisco_7074: bitstring = fail-any in
                                                            {9020}in(c, (=pkCli_7030,m1_7075: bitstring,sigM1_7076: bitstring));
                                                            {9021}if (verify(h(m1_7075),sigM1_7076,pkCli_7030) <> true) then
                                                                0
                                                            else
                                                                {9022}let (=Sess_5512,SPc_7077: bitstring,PartC_7078: bitstring) = m1_7075 in
                                                                {9023}event endSrv(Cli_5510,Sess_5512,PartC_7078);
                                                                {9024}new Ns_7079: bitstring;
                                                                {9025}let gNs_7080: bitstring = exp(g,Ns_7079) in
                                                                {9026}let m2_7081: bitstring = (Cli_5510,gNs_7080) in
                                                                {9027}event beginSrv(Sess_5512,Cli_5510,gNs_7080);
                                                                {9028}out(c, (m2_7081,sign(h(m2_7081),skSess_6785)))
                                                )
                                                else
                                                    {9029}let pkDisco_7082: bitstring = fail-any in
                                                    {9030}in(c, (=pkCli_7030,m1_7083: bitstring,sigM1_7084: bitstring));
                                                    {9031}if (verify(h(m1_7083),sigM1_7084,pkCli_7030) <> true) then
                                                        0
                                                    else
                                                        {9032}let (=Sess_5512,SPc_7085: bitstring,PartC_7086: bitstring) = m1_7083 in
                                                        {9033}event endSrv(Cli_5510,Sess_5512,PartC_7086);
                                                        {9034}new Ns_7087: bitstring;
                                                        {9035}let gNs_7088: bitstring = exp(g,Ns_7087) in
                                                        {9036}let m2_7089: bitstring = (Cli_5510,gNs_7088) in
                                                        {9037}event beginSrv(Sess_5512,Cli_5510,gNs_7088);
                                                        {9038}out(c, (m2_7089,sign(h(m2_7089),skSess_6785)))
                                    )
                                    else
                                        {9039}let pkCli_7090: bitstring = fail-any in
                                        {9040}let v_7091: bool = (Disco_5511 = A) in
                                        (
                                            {9041}if v_7091 then
                                            (
                                                {9042}let pkDisco_7092: bitstring = pub(skA) in
                                                {9043}in(c, (=pkCli_7090,m1_7093: bitstring,sigM1_7094: bitstring));
                                                {9044}if (verify(h(m1_7093),sigM1_7094,pkCli_7090) <> true) then
                                                    0
                                                else
                                                    {9045}let (=Sess_5512,SPc_7095: bitstring,PartC_7096: bitstring) = m1_7093 in
                                                    {9046}event endSrv(Cli_5510,Sess_5512,PartC_7096);
                                                    {9047}new Ns_7097: bitstring;
                                                    {9048}let gNs_7098: bitstring = exp(g,Ns_7097) in
                                                    {9049}let m2_7099: bitstring = (Cli_5510,gNs_7098) in
                                                    {9050}event beginSrv(Sess_5512,Cli_5510,gNs_7098);
                                                    {9051}out(c, (m2_7099,sign(h(m2_7099),skSess_6785)))
                                            )
                                            else
                                                {9052}let v_7100: bool = (Disco_5511 = B) in
                                                (
                                                    {9053}if v_7100 then
                                                    (
                                                        {9054}let pkDisco_7101: bitstring = pub(skB) in
                                                        {9055}in(c, (=pkCli_7090,m1_7102: bitstring,sigM1_7103: bitstring));
                                                        {9056}if (verify(h(m1_7102),sigM1_7103,pkCli_7090) <> true) then
                                                            0
                                                        else
                                                            {9057}let (=Sess_5512,SPc_7104: bitstring,PartC_7105: bitstring) = m1_7102 in
                                                            {9058}event endSrv(Cli_5510,Sess_5512,PartC_7105);
                                                            {9059}new Ns_7106: bitstring;
                                                            {9060}let gNs_7107: bitstring = exp(g,Ns_7106) in
                                                            {9061}let m2_7108: bitstring = (Cli_5510,gNs_7107) in
                                                            {9062}event beginSrv(Sess_5512,Cli_5510,gNs_7107);
                                                            {9063}out(c, (m2_7108,sign(h(m2_7108),skSess_6785)))
                                                    )
                                                    else
                                                        {9064}let v_7109: bool = (Disco_5511 = C) in
                                                        (
                                                            {9065}if v_7109 then
                                                            (
                                                                {9066}let pkDisco_7110: bitstring = pub(skC) in
                                                                {9067}in(c, (=pkCli_7090,m1_7111: bitstring,sigM1_7112: bitstring));
                                                                {9068}if (verify(h(m1_7111),sigM1_7112,pkCli_7090) <> true) then
                                                                    0
                                                                else
                                                                    {9069}let (=Sess_5512,SPc_7113: bitstring,PartC_7114: bitstring) = m1_7111 in
                                                                    {9070}event endSrv(Cli_5510,Sess_5512,PartC_7114);
                                                                    {9071}new Ns_7115: bitstring;
                                                                    {9072}let gNs_7116: bitstring = exp(g,Ns_7115) in
                                                                    {9073}let m2_7117: bitstring = (Cli_5510,gNs_7116) in
                                                                    {9074}event beginSrv(Sess_5512,Cli_5510,gNs_7116);
                                                                    {9075}out(c, (m2_7117,sign(h(m2_7117),skSess_6785)))
                                                            )
                                                            else
                                                                {9076}let pkDisco_7118: bitstring = pub(skI) in
                                                                {9077}in(c, (=pkCli_7090,m1_7119: bitstring,sigM1_7120: bitstring));
                                                                {9078}if (verify(h(m1_7119),sigM1_7120,pkCli_7090) <> true) then
                                                                    0
                                                                else
                                                                    {9079}let (=Sess_5512,SPc_7121: bitstring,PartC_7122: bitstring) = m1_7119 in
                                                                    {9080}event endSrv(Cli_5510,Sess_5512,PartC_7122);
                                                                    {9081}new Ns_7123: bitstring;
                                                                    {9082}let gNs_7124: bitstring = exp(g,Ns_7123) in
                                                                    {9083}let m2_7125: bitstring = (Cli_5510,gNs_7124) in
                                                                    {9084}event beginSrv(Sess_5512,Cli_5510,gNs_7124);
                                                                    {9085}out(c, (m2_7125,sign(h(m2_7125),skSess_6785)))
                                                        )
                                                        else
                                                            {9086}let pkDisco_7126: bitstring = fail-any in
                                                            {9087}in(c, (=pkCli_7090,m1_7127: bitstring,sigM1_7128: bitstring));
                                                            {9088}if (verify(h(m1_7127),sigM1_7128,pkCli_7090) <> true) then
                                                                0
                                                            else
                                                                {9089}let (=Sess_5512,SPc_7129: bitstring,PartC_7130: bitstring) = m1_7127 in
                                                                {9090}event endSrv(Cli_5510,Sess_5512,PartC_7130);
                                                                {9091}new Ns_7131: bitstring;
                                                                {9092}let gNs_7132: bitstring = exp(g,Ns_7131) in
                                                                {9093}let m2_7133: bitstring = (Cli_5510,gNs_7132) in
                                                                {9094}event beginSrv(Sess_5512,Cli_5510,gNs_7132);
                                                                {9095}out(c, (m2_7133,sign(h(m2_7133),skSess_6785)))
                                                )
                                                else
                                                    {9096}let pkDisco_7134: bitstring = fail-any in
                                                    {9097}in(c, (=pkCli_7090,m1_7135: bitstring,sigM1_7136: bitstring));
                                                    {9098}if (verify(h(m1_7135),sigM1_7136,pkCli_7090) <> true) then
                                                        0
                                                    else
                                                        {9099}let (=Sess_5512,SPc_7137: bitstring,PartC_7138: bitstring) = m1_7135 in
                                                        {9100}event endSrv(Cli_5510,Sess_5512,PartC_7138);
                                                        {9101}new Ns_7139: bitstring;
                                                        {9102}let gNs_7140: bitstring = exp(g,Ns_7139) in
                                                        {9103}let m2_7141: bitstring = (Cli_5510,gNs_7140) in
                                                        {9104}event beginSrv(Sess_5512,Cli_5510,gNs_7140);
                                                        {9105}out(c, (m2_7141,sign(h(m2_7141),skSess_6785)))
                                        )
                                        else
                                            {9106}let pkDisco_7142: bitstring = fail-any in
                                            {9107}in(c, (=pkCli_7090,m1_7143: bitstring,sigM1_7144: bitstring));
                                            {9108}if (verify(h(m1_7143),sigM1_7144,pkCli_7090) <> true) then
                                                0
                                            else
                                                {9109}let (=Sess_5512,SPc_7145: bitstring,PartC_7146: bitstring) = m1_7143 in
                                                {9110}event endSrv(Cli_5510,Sess_5512,PartC_7146);
                                                {9111}new Ns_7147: bitstring;
                                                {9112}let gNs_7148: bitstring = exp(g,Ns_7147) in
                                                {9113}let m2_7149: bitstring = (Cli_5510,gNs_7148) in
                                                {9114}event beginSrv(Sess_5512,Cli_5510,gNs_7148);
                                                {9115}out(c, (m2_7149,sign(h(m2_7149),skSess_6785)))
                            )
                            else
                                {9116}let pkCli_7150: bitstring = fail-any in
                                {9117}let v_7151: bool = (Disco_5511 = A) in
                                (
                                    {9118}if v_7151 then
                                    (
                                        {9119}let pkDisco_7152: bitstring = pub(skA) in
                                        {9120}in(c, (=pkCli_7150,m1_7153: bitstring,sigM1_7154: bitstring));
                                        {9121}if (verify(h(m1_7153),sigM1_7154,pkCli_7150) <> true) then
                                            0
                                        else
                                            {9122}let (=Sess_5512,SPc_7155: bitstring,PartC_7156: bitstring) = m1_7153 in
                                            {9123}event endSrv(Cli_5510,Sess_5512,PartC_7156);
                                            {9124}new Ns_7157: bitstring;
                                            {9125}let gNs_7158: bitstring = exp(g,Ns_7157) in
                                            {9126}let m2_7159: bitstring = (Cli_5510,gNs_7158) in
                                            {9127}event beginSrv(Sess_5512,Cli_5510,gNs_7158);
                                            {9128}out(c, (m2_7159,sign(h(m2_7159),skSess_6785)))
                                    )
                                    else
                                        {9129}let v_7160: bool = (Disco_5511 = B) in
                                        (
                                            {9130}if v_7160 then
                                            (
                                                {9131}let pkDisco_7161: bitstring = pub(skB) in
                                                {9132}in(c, (=pkCli_7150,m1_7162: bitstring,sigM1_7163: bitstring));
                                                {9133}if (verify(h(m1_7162),sigM1_7163,pkCli_7150) <> true) then
                                                    0
                                                else
                                                    {9134}let (=Sess_5512,SPc_7164: bitstring,PartC_7165: bitstring) = m1_7162 in
                                                    {9135}event endSrv(Cli_5510,Sess_5512,PartC_7165);
                                                    {9136}new Ns_7166: bitstring;
                                                    {9137}let gNs_7167: bitstring = exp(g,Ns_7166) in
                                                    {9138}let m2_7168: bitstring = (Cli_5510,gNs_7167) in
                                                    {9139}event beginSrv(Sess_5512,Cli_5510,gNs_7167);
                                                    {9140}out(c, (m2_7168,sign(h(m2_7168),skSess_6785)))
                                            )
                                            else
                                                {9141}let v_7169: bool = (Disco_5511 = C) in
                                                (
                                                    {9142}if v_7169 then
                                                    (
                                                        {9143}let pkDisco_7170: bitstring = pub(skC) in
                                                        {9144}in(c, (=pkCli_7150,m1_7171: bitstring,sigM1_7172: bitstring));
                                                        {9145}if (verify(h(m1_7171),sigM1_7172,pkCli_7150) <> true) then
                                                            0
                                                        else
                                                            {9146}let (=Sess_5512,SPc_7173: bitstring,PartC_7174: bitstring) = m1_7171 in
                                                            {9147}event endSrv(Cli_5510,Sess_5512,PartC_7174);
                                                            {9148}new Ns_7175: bitstring;
                                                            {9149}let gNs_7176: bitstring = exp(g,Ns_7175) in
                                                            {9150}let m2_7177: bitstring = (Cli_5510,gNs_7176) in
                                                            {9151}event beginSrv(Sess_5512,Cli_5510,gNs_7176);
                                                            {9152}out(c, (m2_7177,sign(h(m2_7177),skSess_6785)))
                                                    )
                                                    else
                                                        {9153}let pkDisco_7178: bitstring = pub(skI) in
                                                        {9154}in(c, (=pkCli_7150,m1_7179: bitstring,sigM1_7180: bitstring));
                                                        {9155}if (verify(h(m1_7179),sigM1_7180,pkCli_7150) <> true) then
                                                            0
                                                        else
                                                            {9156}let (=Sess_5512,SPc_7181: bitstring,PartC_7182: bitstring) = m1_7179 in
                                                            {9157}event endSrv(Cli_5510,Sess_5512,PartC_7182);
                                                            {9158}new Ns_7183: bitstring;
                                                            {9159}let gNs_7184: bitstring = exp(g,Ns_7183) in
                                                            {9160}let m2_7185: bitstring = (Cli_5510,gNs_7184) in
                                                            {9161}event beginSrv(Sess_5512,Cli_5510,gNs_7184);
                                                            {9162}out(c, (m2_7185,sign(h(m2_7185),skSess_6785)))
                                                )
                                                else
                                                    {9163}let pkDisco_7186: bitstring = fail-any in
                                                    {9164}in(c, (=pkCli_7150,m1_7187: bitstring,sigM1_7188: bitstring));
                                                    {9165}if (verify(h(m1_7187),sigM1_7188,pkCli_7150) <> true) then
                                                        0
                                                    else
                                                        {9166}let (=Sess_5512,SPc_7189: bitstring,PartC_7190: bitstring) = m1_7187 in
                                                        {9167}event endSrv(Cli_5510,Sess_5512,PartC_7190);
                                                        {9168}new Ns_7191: bitstring;
                                                        {9169}let gNs_7192: bitstring = exp(g,Ns_7191) in
                                                        {9170}let m2_7193: bitstring = (Cli_5510,gNs_7192) in
                                                        {9171}event beginSrv(Sess_5512,Cli_5510,gNs_7192);
                                                        {9172}out(c, (m2_7193,sign(h(m2_7193),skSess_6785)))
                                        )
                                        else
                                            {9173}let pkDisco_7194: bitstring = fail-any in
                                            {9174}in(c, (=pkCli_7150,m1_7195: bitstring,sigM1_7196: bitstring));
                                            {9175}if (verify(h(m1_7195),sigM1_7196,pkCli_7150) <> true) then
                                                0
                                            else
                                                {9176}let (=Sess_5512,SPc_7197: bitstring,PartC_7198: bitstring) = m1_7195 in
                                                {9177}event endSrv(Cli_5510,Sess_5512,PartC_7198);
                                                {9178}new Ns_7199: bitstring;
                                                {9179}let gNs_7200: bitstring = exp(g,Ns_7199) in
                                                {9180}let m2_7201: bitstring = (Cli_5510,gNs_7200) in
                                                {9181}event beginSrv(Sess_5512,Cli_5510,gNs_7200);
                                                {9182}out(c, (m2_7201,sign(h(m2_7201),skSess_6785)))
                                )
                                else
                                    {9183}let pkDisco_7202: bitstring = fail-any in
                                    {9184}in(c, (=pkCli_7150,m1_7203: bitstring,sigM1_7204: bitstring));
                                    {9185}if (verify(h(m1_7203),sigM1_7204,pkCli_7150) <> true) then
                                        0
                                    else
                                        {9186}let (=Sess_5512,SPc_7205: bitstring,PartC_7206: bitstring) = m1_7203 in
                                        {9187}event endSrv(Cli_5510,Sess_5512,PartC_7206);
                                        {9188}new Ns_7207: bitstring;
                                        {9189}let gNs_7208: bitstring = exp(g,Ns_7207) in
                                        {9190}let m2_7209: bitstring = (Cli_5510,gNs_7208) in
                                        {9191}event beginSrv(Sess_5512,Cli_5510,gNs_7208);
                                        {9192}out(c, (m2_7209,sign(h(m2_7209),skSess_6785)))
                    )
                    else
                        {9193}let skSess_7210: bitstring = fail-any in
                        {9194}let pkSess_7211: bitstring = pub(skSess_7210) in
                        {9195}let v_7212: bool = (Cli_5510 = A) in
                        (
                            {9196}if v_7212 then
                            (
                                {9197}let pkCli_7213: bitstring = pub(skA) in
                                {9198}let v_7214: bool = (Disco_5511 = A) in
                                (
                                    {9199}if v_7214 then
                                    (
                                        {9200}let pkDisco_7215: bitstring = pub(skA) in
                                        {9201}in(c, (=pkCli_7213,m1_7216: bitstring,sigM1_7217: bitstring));
                                        {9202}if (verify(h(m1_7216),sigM1_7217,pkCli_7213) <> true) then
                                            0
                                        else
                                            {9203}let (=Sess_5512,SPc_7218: bitstring,PartC_7219: bitstring) = m1_7216 in
                                            {9204}event endSrv(Cli_5510,Sess_5512,PartC_7219);
                                            {9205}new Ns_7220: bitstring;
                                            {9206}let gNs_7221: bitstring = exp(g,Ns_7220) in
                                            {9207}let m2_7222: bitstring = (Cli_5510,gNs_7221) in
                                            {9208}event beginSrv(Sess_5512,Cli_5510,gNs_7221);
                                            {9209}out(c, (m2_7222,sign(h(m2_7222),skSess_7210)))
                                    )
                                    else
                                        {9210}let v_7223: bool = (Disco_5511 = B) in
                                        (
                                            {9211}if v_7223 then
                                            (
                                                {9212}let pkDisco_7224: bitstring = pub(skB) in
                                                {9213}in(c, (=pkCli_7213,m1_7225: bitstring,sigM1_7226: bitstring));
                                                {9214}if (verify(h(m1_7225),sigM1_7226,pkCli_7213) <> true) then
                                                    0
                                                else
                                                    {9215}let (=Sess_5512,SPc_7227: bitstring,PartC_7228: bitstring) = m1_7225 in
                                                    {9216}event endSrv(Cli_5510,Sess_5512,PartC_7228);
                                                    {9217}new Ns_7229: bitstring;
                                                    {9218}let gNs_7230: bitstring = exp(g,Ns_7229) in
                                                    {9219}let m2_7231: bitstring = (Cli_5510,gNs_7230) in
                                                    {9220}event beginSrv(Sess_5512,Cli_5510,gNs_7230);
                                                    {9221}out(c, (m2_7231,sign(h(m2_7231),skSess_7210)))
                                            )
                                            else
                                                {9222}let v_7232: bool = (Disco_5511 = C) in
                                                (
                                                    {9223}if v_7232 then
                                                    (
                                                        {9224}let pkDisco_7233: bitstring = pub(skC) in
                                                        {9225}in(c, (=pkCli_7213,m1_7234: bitstring,sigM1_7235: bitstring));
                                                        {9226}if (verify(h(m1_7234),sigM1_7235,pkCli_7213) <> true) then
                                                            0
                                                        else
                                                            {9227}let (=Sess_5512,SPc_7236: bitstring,PartC_7237: bitstring) = m1_7234 in
                                                            {9228}event endSrv(Cli_5510,Sess_5512,PartC_7237);
                                                            {9229}new Ns_7238: bitstring;
                                                            {9230}let gNs_7239: bitstring = exp(g,Ns_7238) in
                                                            {9231}let m2_7240: bitstring = (Cli_5510,gNs_7239) in
                                                            {9232}event beginSrv(Sess_5512,Cli_5510,gNs_7239);
                                                            {9233}out(c, (m2_7240,sign(h(m2_7240),skSess_7210)))
                                                    )
                                                    else
                                                        {9234}let pkDisco_7241: bitstring = pub(skI) in
                                                        {9235}in(c, (=pkCli_7213,m1_7242: bitstring,sigM1_7243: bitstring));
                                                        {9236}if (verify(h(m1_7242),sigM1_7243,pkCli_7213) <> true) then
                                                            0
                                                        else
                                                            {9237}let (=Sess_5512,SPc_7244: bitstring,PartC_7245: bitstring) = m1_7242 in
                                                            {9238}event endSrv(Cli_5510,Sess_5512,PartC_7245);
                                                            {9239}new Ns_7246: bitstring;
                                                            {9240}let gNs_7247: bitstring = exp(g,Ns_7246) in
                                                            {9241}let m2_7248: bitstring = (Cli_5510,gNs_7247) in
                                                            {9242}event beginSrv(Sess_5512,Cli_5510,gNs_7247);
                                                            {9243}out(c, (m2_7248,sign(h(m2_7248),skSess_7210)))
                                                )
                                                else
                                                    {9244}let pkDisco_7249: bitstring = fail-any in
                                                    {9245}in(c, (=pkCli_7213,m1_7250: bitstring,sigM1_7251: bitstring));
                                                    {9246}if (verify(h(m1_7250),sigM1_7251,pkCli_7213) <> true) then
                                                        0
                                                    else
                                                        {9247}let (=Sess_5512,SPc_7252: bitstring,PartC_7253: bitstring) = m1_7250 in
                                                        {9248}event endSrv(Cli_5510,Sess_5512,PartC_7253);
                                                        {9249}new Ns_7254: bitstring;
                                                        {9250}let gNs_7255: bitstring = exp(g,Ns_7254) in
                                                        {9251}let m2_7256: bitstring = (Cli_5510,gNs_7255) in
                                                        {9252}event beginSrv(Sess_5512,Cli_5510,gNs_7255);
                                                        {9253}out(c, (m2_7256,sign(h(m2_7256),skSess_7210)))
                                        )
                                        else
                                            {9254}let pkDisco_7257: bitstring = fail-any in
                                            {9255}in(c, (=pkCli_7213,m1_7258: bitstring,sigM1_7259: bitstring));
                                            {9256}if (verify(h(m1_7258),sigM1_7259,pkCli_7213) <> true) then
                                                0
                                            else
                                                {9257}let (=Sess_5512,SPc_7260: bitstring,PartC_7261: bitstring) = m1_7258 in
                                                {9258}event endSrv(Cli_5510,Sess_5512,PartC_7261);
                                                {9259}new Ns_7262: bitstring;
                                                {9260}let gNs_7263: bitstring = exp(g,Ns_7262) in
                                                {9261}let m2_7264: bitstring = (Cli_5510,gNs_7263) in
                                                {9262}event beginSrv(Sess_5512,Cli_5510,gNs_7263);
                                                {9263}out(c, (m2_7264,sign(h(m2_7264),skSess_7210)))
                                )
                                else
                                    {9264}let pkDisco_7265: bitstring = fail-any in
                                    {9265}in(c, (=pkCli_7213,m1_7266: bitstring,sigM1_7267: bitstring));
                                    {9266}if (verify(h(m1_7266),sigM1_7267,pkCli_7213) <> true) then
                                        0
                                    else
                                        {9267}let (=Sess_5512,SPc_7268: bitstring,PartC_7269: bitstring) = m1_7266 in
                                        {9268}event endSrv(Cli_5510,Sess_5512,PartC_7269);
                                        {9269}new Ns_7270: bitstring;
                                        {9270}let gNs_7271: bitstring = exp(g,Ns_7270) in
                                        {9271}let m2_7272: bitstring = (Cli_5510,gNs_7271) in
                                        {9272}event beginSrv(Sess_5512,Cli_5510,gNs_7271);
                                        {9273}out(c, (m2_7272,sign(h(m2_7272),skSess_7210)))
                            )
                            else
                                {9274}let v_7273: bool = (Cli_5510 = B) in
                                (
                                    {9275}if v_7273 then
                                    (
                                        {9276}let pkCli_7274: bitstring = pub(skB) in
                                        {9277}let v_7275: bool = (Disco_5511 = A) in
                                        (
                                            {9278}if v_7275 then
                                            (
                                                {9279}let pkDisco_7276: bitstring = pub(skA) in
                                                {9280}in(c, (=pkCli_7274,m1_7277: bitstring,sigM1_7278: bitstring));
                                                {9281}if (verify(h(m1_7277),sigM1_7278,pkCli_7274) <> true) then
                                                    0
                                                else
                                                    {9282}let (=Sess_5512,SPc_7279: bitstring,PartC_7280: bitstring) = m1_7277 in
                                                    {9283}event endSrv(Cli_5510,Sess_5512,PartC_7280);
                                                    {9284}new Ns_7281: bitstring;
                                                    {9285}let gNs_7282: bitstring = exp(g,Ns_7281) in
                                                    {9286}let m2_7283: bitstring = (Cli_5510,gNs_7282) in
                                                    {9287}event beginSrv(Sess_5512,Cli_5510,gNs_7282);
                                                    {9288}out(c, (m2_7283,sign(h(m2_7283),skSess_7210)))
                                            )
                                            else
                                                {9289}let v_7284: bool = (Disco_5511 = B) in
                                                (
                                                    {9290}if v_7284 then
                                                    (
                                                        {9291}let pkDisco_7285: bitstring = pub(skB) in
                                                        {9292}in(c, (=pkCli_7274,m1_7286: bitstring,sigM1_7287: bitstring));
                                                        {9293}if (verify(h(m1_7286),sigM1_7287,pkCli_7274) <> true) then
                                                            0
                                                        else
                                                            {9294}let (=Sess_5512,SPc_7288: bitstring,PartC_7289: bitstring) = m1_7286 in
                                                            {9295}event endSrv(Cli_5510,Sess_5512,PartC_7289);
                                                            {9296}new Ns_7290: bitstring;
                                                            {9297}let gNs_7291: bitstring = exp(g,Ns_7290) in
                                                            {9298}let m2_7292: bitstring = (Cli_5510,gNs_7291) in
                                                            {9299}event beginSrv(Sess_5512,Cli_5510,gNs_7291);
                                                            {9300}out(c, (m2_7292,sign(h(m2_7292),skSess_7210)))
                                                    )
                                                    else
                                                        {9301}let v_7293: bool = (Disco_5511 = C) in
                                                        (
                                                            {9302}if v_7293 then
                                                            (
                                                                {9303}let pkDisco_7294: bitstring = pub(skC) in
                                                                {9304}in(c, (=pkCli_7274,m1_7295: bitstring,sigM1_7296: bitstring));
                                                                {9305}if (verify(h(m1_7295),sigM1_7296,pkCli_7274) <> true) then
                                                                    0
                                                                else
                                                                    {9306}let (=Sess_5512,SPc_7297: bitstring,PartC_7298: bitstring) = m1_7295 in
                                                                    {9307}event endSrv(Cli_5510,Sess_5512,PartC_7298);
                                                                    {9308}new Ns_7299: bitstring;
                                                                    {9309}let gNs_7300: bitstring = exp(g,Ns_7299) in
                                                                    {9310}let m2_7301: bitstring = (Cli_5510,gNs_7300) in
                                                                    {9311}event beginSrv(Sess_5512,Cli_5510,gNs_7300);
                                                                    {9312}out(c, (m2_7301,sign(h(m2_7301),skSess_7210)))
                                                            )
                                                            else
                                                                {9313}let pkDisco_7302: bitstring = pub(skI) in
                                                                {9314}in(c, (=pkCli_7274,m1_7303: bitstring,sigM1_7304: bitstring));
                                                                {9315}if (verify(h(m1_7303),sigM1_7304,pkCli_7274) <> true) then
                                                                    0
                                                                else
                                                                    {9316}let (=Sess_5512,SPc_7305: bitstring,PartC_7306: bitstring) = m1_7303 in
                                                                    {9317}event endSrv(Cli_5510,Sess_5512,PartC_7306);
                                                                    {9318}new Ns_7307: bitstring;
                                                                    {9319}let gNs_7308: bitstring = exp(g,Ns_7307) in
                                                                    {9320}let m2_7309: bitstring = (Cli_5510,gNs_7308) in
                                                                    {9321}event beginSrv(Sess_5512,Cli_5510,gNs_7308);
                                                                    {9322}out(c, (m2_7309,sign(h(m2_7309),skSess_7210)))
                                                        )
                                                        else
                                                            {9323}let pkDisco_7310: bitstring = fail-any in
                                                            {9324}in(c, (=pkCli_7274,m1_7311: bitstring,sigM1_7312: bitstring));
                                                            {9325}if (verify(h(m1_7311),sigM1_7312,pkCli_7274) <> true) then
                                                                0
                                                            else
                                                                {9326}let (=Sess_5512,SPc_7313: bitstring,PartC_7314: bitstring) = m1_7311 in
                                                                {9327}event endSrv(Cli_5510,Sess_5512,PartC_7314);
                                                                {9328}new Ns_7315: bitstring;
                                                                {9329}let gNs_7316: bitstring = exp(g,Ns_7315) in
                                                                {9330}let m2_7317: bitstring = (Cli_5510,gNs_7316) in
                                                                {9331}event beginSrv(Sess_5512,Cli_5510,gNs_7316);
                                                                {9332}out(c, (m2_7317,sign(h(m2_7317),skSess_7210)))
                                                )
                                                else
                                                    {9333}let pkDisco_7318: bitstring = fail-any in
                                                    {9334}in(c, (=pkCli_7274,m1_7319: bitstring,sigM1_7320: bitstring));
                                                    {9335}if (verify(h(m1_7319),sigM1_7320,pkCli_7274) <> true) then
                                                        0
                                                    else
                                                        {9336}let (=Sess_5512,SPc_7321: bitstring,PartC_7322: bitstring) = m1_7319 in
                                                        {9337}event endSrv(Cli_5510,Sess_5512,PartC_7322);
                                                        {9338}new Ns_7323: bitstring;
                                                        {9339}let gNs_7324: bitstring = exp(g,Ns_7323) in
                                                        {9340}let m2_7325: bitstring = (Cli_5510,gNs_7324) in
                                                        {9341}event beginSrv(Sess_5512,Cli_5510,gNs_7324);
                                                        {9342}out(c, (m2_7325,sign(h(m2_7325),skSess_7210)))
                                        )
                                        else
                                            {9343}let pkDisco_7326: bitstring = fail-any in
                                            {9344}in(c, (=pkCli_7274,m1_7327: bitstring,sigM1_7328: bitstring));
                                            {9345}if (verify(h(m1_7327),sigM1_7328,pkCli_7274) <> true) then
                                                0
                                            else
                                                {9346}let (=Sess_5512,SPc_7329: bitstring,PartC_7330: bitstring) = m1_7327 in
                                                {9347}event endSrv(Cli_5510,Sess_5512,PartC_7330);
                                                {9348}new Ns_7331: bitstring;
                                                {9349}let gNs_7332: bitstring = exp(g,Ns_7331) in
                                                {9350}let m2_7333: bitstring = (Cli_5510,gNs_7332) in
                                                {9351}event beginSrv(Sess_5512,Cli_5510,gNs_7332);
                                                {9352}out(c, (m2_7333,sign(h(m2_7333),skSess_7210)))
                                    )
                                    else
                                        {9353}let v_7334: bool = (Cli_5510 = C) in
                                        (
                                            {9354}if v_7334 then
                                            (
                                                {9355}let pkCli_7335: bitstring = pub(skC) in
                                                {9356}let v_7336: bool = (Disco_5511 = A) in
                                                (
                                                    {9357}if v_7336 then
                                                    (
                                                        {9358}let pkDisco_7337: bitstring = pub(skA) in
                                                        {9359}in(c, (=pkCli_7335,m1_7338: bitstring,sigM1_7339: bitstring));
                                                        {9360}if (verify(h(m1_7338),sigM1_7339,pkCli_7335) <> true) then
                                                            0
                                                        else
                                                            {9361}let (=Sess_5512,SPc_7340: bitstring,PartC_7341: bitstring) = m1_7338 in
                                                            {9362}event endSrv(Cli_5510,Sess_5512,PartC_7341);
                                                            {9363}new Ns_7342: bitstring;
                                                            {9364}let gNs_7343: bitstring = exp(g,Ns_7342) in
                                                            {9365}let m2_7344: bitstring = (Cli_5510,gNs_7343) in
                                                            {9366}event beginSrv(Sess_5512,Cli_5510,gNs_7343);
                                                            {9367}out(c, (m2_7344,sign(h(m2_7344),skSess_7210)))
                                                    )
                                                    else
                                                        {9368}let v_7345: bool = (Disco_5511 = B) in
                                                        (
                                                            {9369}if v_7345 then
                                                            (
                                                                {9370}let pkDisco_7346: bitstring = pub(skB) in
                                                                {9371}in(c, (=pkCli_7335,m1_7347: bitstring,sigM1_7348: bitstring));
                                                                {9372}if (verify(h(m1_7347),sigM1_7348,pkCli_7335) <> true) then
                                                                    0
                                                                else
                                                                    {9373}let (=Sess_5512,SPc_7349: bitstring,PartC_7350: bitstring) = m1_7347 in
                                                                    {9374}event endSrv(Cli_5510,Sess_5512,PartC_7350);
                                                                    {9375}new Ns_7351: bitstring;
                                                                    {9376}let gNs_7352: bitstring = exp(g,Ns_7351) in
                                                                    {9377}let m2_7353: bitstring = (Cli_5510,gNs_7352) in
                                                                    {9378}event beginSrv(Sess_5512,Cli_5510,gNs_7352);
                                                                    {9379}out(c, (m2_7353,sign(h(m2_7353),skSess_7210)))
                                                            )
                                                            else
                                                                {9380}let v_7354: bool = (Disco_5511 = C) in
                                                                (
                                                                    {9381}if v_7354 then
                                                                    (
                                                                        {9382}let pkDisco_7355: bitstring = pub(skC) in
                                                                        {9383}in(c, (=pkCli_7335,m1_7356: bitstring,sigM1_7357: bitstring));
                                                                        {9384}if (verify(h(m1_7356),sigM1_7357,pkCli_7335) <> true) then
                                                                            0
                                                                        else
                                                                            {9385}let (=Sess_5512,SPc_7358: bitstring,PartC_7359: bitstring) = m1_7356 in
                                                                            {9386}event endSrv(Cli_5510,Sess_5512,PartC_7359);
                                                                            {9387}new Ns_7360: bitstring;
                                                                            {9388}let gNs_7361: bitstring = exp(g,Ns_7360) in
                                                                            {9389}let m2_7362: bitstring = (Cli_5510,gNs_7361) in
                                                                            {9390}event beginSrv(Sess_5512,Cli_5510,gNs_7361);
                                                                            {9391}out(c, (m2_7362,sign(h(m2_7362),skSess_7210)))
                                                                    )
                                                                    else
                                                                        {9392}let pkDisco_7363: bitstring = pub(skI) in
                                                                        {9393}in(c, (=pkCli_7335,m1_7364: bitstring,sigM1_7365: bitstring));
                                                                        {9394}if (verify(h(m1_7364),sigM1_7365,pkCli_7335) <> true) then
                                                                            0
                                                                        else
                                                                            {9395}let (=Sess_5512,SPc_7366: bitstring,PartC_7367: bitstring) = m1_7364 in
                                                                            {9396}event endSrv(Cli_5510,Sess_5512,PartC_7367);
                                                                            {9397}new Ns_7368: bitstring;
                                                                            {9398}let gNs_7369: bitstring = exp(g,Ns_7368) in
                                                                            {9399}let m2_7370: bitstring = (Cli_5510,gNs_7369) in
                                                                            {9400}event beginSrv(Sess_5512,Cli_5510,gNs_7369);
                                                                            {9401}out(c, (m2_7370,sign(h(m2_7370),skSess_7210)))
                                                                )
                                                                else
                                                                    {9402}let pkDisco_7371: bitstring = fail-any in
                                                                    {9403}in(c, (=pkCli_7335,m1_7372: bitstring,sigM1_7373: bitstring));
                                                                    {9404}if (verify(h(m1_7372),sigM1_7373,pkCli_7335) <> true) then
                                                                        0
                                                                    else
                                                                        {9405}let (=Sess_5512,SPc_7374: bitstring,PartC_7375: bitstring) = m1_7372 in
                                                                        {9406}event endSrv(Cli_5510,Sess_5512,PartC_7375);
                                                                        {9407}new Ns_7376: bitstring;
                                                                        {9408}let gNs_7377: bitstring = exp(g,Ns_7376) in
                                                                        {9409}let m2_7378: bitstring = (Cli_5510,gNs_7377) in
                                                                        {9410}event beginSrv(Sess_5512,Cli_5510,gNs_7377);
                                                                        {9411}out(c, (m2_7378,sign(h(m2_7378),skSess_7210)))
                                                        )
                                                        else
                                                            {9412}let pkDisco_7379: bitstring = fail-any in
                                                            {9413}in(c, (=pkCli_7335,m1_7380: bitstring,sigM1_7381: bitstring));
                                                            {9414}if (verify(h(m1_7380),sigM1_7381,pkCli_7335) <> true) then
                                                                0
                                                            else
                                                                {9415}let (=Sess_5512,SPc_7382: bitstring,PartC_7383: bitstring) = m1_7380 in
                                                                {9416}event endSrv(Cli_5510,Sess_5512,PartC_7383);
                                                                {9417}new Ns_7384: bitstring;
                                                                {9418}let gNs_7385: bitstring = exp(g,Ns_7384) in
                                                                {9419}let m2_7386: bitstring = (Cli_5510,gNs_7385) in
                                                                {9420}event beginSrv(Sess_5512,Cli_5510,gNs_7385);
                                                                {9421}out(c, (m2_7386,sign(h(m2_7386),skSess_7210)))
                                                )
                                                else
                                                    {9422}let pkDisco_7387: bitstring = fail-any in
                                                    {9423}in(c, (=pkCli_7335,m1_7388: bitstring,sigM1_7389: bitstring));
                                                    {9424}if (verify(h(m1_7388),sigM1_7389,pkCli_7335) <> true) then
                                                        0
                                                    else
                                                        {9425}let (=Sess_5512,SPc_7390: bitstring,PartC_7391: bitstring) = m1_7388 in
                                                        {9426}event endSrv(Cli_5510,Sess_5512,PartC_7391);
                                                        {9427}new Ns_7392: bitstring;
                                                        {9428}let gNs_7393: bitstring = exp(g,Ns_7392) in
                                                        {9429}let m2_7394: bitstring = (Cli_5510,gNs_7393) in
                                                        {9430}event beginSrv(Sess_5512,Cli_5510,gNs_7393);
                                                        {9431}out(c, (m2_7394,sign(h(m2_7394),skSess_7210)))
                                            )
                                            else
                                                {9432}let pkCli_7395: bitstring = pub(skI) in
                                                {9433}let v_7396: bool = (Disco_5511 = A) in
                                                (
                                                    {9434}if v_7396 then
                                                    (
                                                        {9435}let pkDisco_7397: bitstring = pub(skA) in
                                                        {9436}in(c, (=pkCli_7395,m1_7398: bitstring,sigM1_7399: bitstring));
                                                        {9437}if (verify(h(m1_7398),sigM1_7399,pkCli_7395) <> true) then
                                                            0
                                                        else
                                                            {9438}let (=Sess_5512,SPc_7400: bitstring,PartC_7401: bitstring) = m1_7398 in
                                                            {9439}event endSrv(Cli_5510,Sess_5512,PartC_7401);
                                                            {9440}new Ns_7402: bitstring;
                                                            {9441}let gNs_7403: bitstring = exp(g,Ns_7402) in
                                                            {9442}let m2_7404: bitstring = (Cli_5510,gNs_7403) in
                                                            {9443}event beginSrv(Sess_5512,Cli_5510,gNs_7403);
                                                            {9444}out(c, (m2_7404,sign(h(m2_7404),skSess_7210)))
                                                    )
                                                    else
                                                        {9445}let v_7405: bool = (Disco_5511 = B) in
                                                        (
                                                            {9446}if v_7405 then
                                                            (
                                                                {9447}let pkDisco_7406: bitstring = pub(skB) in
                                                                {9448}in(c, (=pkCli_7395,m1_7407: bitstring,sigM1_7408: bitstring));
                                                                {9449}if (verify(h(m1_7407),sigM1_7408,pkCli_7395) <> true) then
                                                                    0
                                                                else
                                                                    {9450}let (=Sess_5512,SPc_7409: bitstring,PartC_7410: bitstring) = m1_7407 in
                                                                    {9451}event endSrv(Cli_5510,Sess_5512,PartC_7410);
                                                                    {9452}new Ns_7411: bitstring;
                                                                    {9453}let gNs_7412: bitstring = exp(g,Ns_7411) in
                                                                    {9454}let m2_7413: bitstring = (Cli_5510,gNs_7412) in
                                                                    {9455}event beginSrv(Sess_5512,Cli_5510,gNs_7412);
                                                                    {9456}out(c, (m2_7413,sign(h(m2_7413),skSess_7210)))
                                                            )
                                                            else
                                                                {9457}let v_7414: bool = (Disco_5511 = C) in
                                                                (
                                                                    {9458}if v_7414 then
                                                                    (
                                                                        {9459}let pkDisco_7415: bitstring = pub(skC) in
                                                                        {9460}in(c, (=pkCli_7395,m1_7416: bitstring,sigM1_7417: bitstring));
                                                                        {9461}if (verify(h(m1_7416),sigM1_7417,pkCli_7395) <> true) then
                                                                            0
                                                                        else
                                                                            {9462}let (=Sess_5512,SPc_7418: bitstring,PartC_7419: bitstring) = m1_7416 in
                                                                            {9463}event endSrv(Cli_5510,Sess_5512,PartC_7419);
                                                                            {9464}new Ns_7420: bitstring;
                                                                            {9465}let gNs_7421: bitstring = exp(g,Ns_7420) in
                                                                            {9466}let m2_7422: bitstring = (Cli_5510,gNs_7421) in
                                                                            {9467}event beginSrv(Sess_5512,Cli_5510,gNs_7421);
                                                                            {9468}out(c, (m2_7422,sign(h(m2_7422),skSess_7210)))
                                                                    )
                                                                    else
                                                                        {9469}let pkDisco_7423: bitstring = pub(skI) in
                                                                        {9470}in(c, (=pkCli_7395,m1_7424: bitstring,sigM1_7425: bitstring));
                                                                        {9471}if (verify(h(m1_7424),sigM1_7425,pkCli_7395) <> true) then
                                                                            0
                                                                        else
                                                                            {9472}let (=Sess_5512,SPc_7426: bitstring,PartC_7427: bitstring) = m1_7424 in
                                                                            {9473}event endSrv(Cli_5510,Sess_5512,PartC_7427);
                                                                            {9474}new Ns_7428: bitstring;
                                                                            {9475}let gNs_7429: bitstring = exp(g,Ns_7428) in
                                                                            {9476}let m2_7430: bitstring = (Cli_5510,gNs_7429) in
                                                                            {9477}event beginSrv(Sess_5512,Cli_5510,gNs_7429);
                                                                            {9478}out(c, (m2_7430,sign(h(m2_7430),skSess_7210)))
                                                                )
                                                                else
                                                                    {9479}let pkDisco_7431: bitstring = fail-any in
                                                                    {9480}in(c, (=pkCli_7395,m1_7432: bitstring,sigM1_7433: bitstring));
                                                                    {9481}if (verify(h(m1_7432),sigM1_7433,pkCli_7395) <> true) then
                                                                        0
                                                                    else
                                                                        {9482}let (=Sess_5512,SPc_7434: bitstring,PartC_7435: bitstring) = m1_7432 in
                                                                        {9483}event endSrv(Cli_5510,Sess_5512,PartC_7435);
                                                                        {9484}new Ns_7436: bitstring;
                                                                        {9485}let gNs_7437: bitstring = exp(g,Ns_7436) in
                                                                        {9486}let m2_7438: bitstring = (Cli_5510,gNs_7437) in
                                                                        {9487}event beginSrv(Sess_5512,Cli_5510,gNs_7437);
                                                                        {9488}out(c, (m2_7438,sign(h(m2_7438),skSess_7210)))
                                                        )
                                                        else
                                                            {9489}let pkDisco_7439: bitstring = fail-any in
                                                            {9490}in(c, (=pkCli_7395,m1_7440: bitstring,sigM1_7441: bitstring));
                                                            {9491}if (verify(h(m1_7440),sigM1_7441,pkCli_7395) <> true) then
                                                                0
                                                            else
                                                                {9492}let (=Sess_5512,SPc_7442: bitstring,PartC_7443: bitstring) = m1_7440 in
                                                                {9493}event endSrv(Cli_5510,Sess_5512,PartC_7443);
                                                                {9494}new Ns_7444: bitstring;
                                                                {9495}let gNs_7445: bitstring = exp(g,Ns_7444) in
                                                                {9496}let m2_7446: bitstring = (Cli_5510,gNs_7445) in
                                                                {9497}event beginSrv(Sess_5512,Cli_5510,gNs_7445);
                                                                {9498}out(c, (m2_7446,sign(h(m2_7446),skSess_7210)))
                                                )
                                                else
                                                    {9499}let pkDisco_7447: bitstring = fail-any in
                                                    {9500}in(c, (=pkCli_7395,m1_7448: bitstring,sigM1_7449: bitstring));
                                                    {9501}if (verify(h(m1_7448),sigM1_7449,pkCli_7395) <> true) then
                                                        0
                                                    else
                                                        {9502}let (=Sess_5512,SPc_7450: bitstring,PartC_7451: bitstring) = m1_7448 in
                                                        {9503}event endSrv(Cli_5510,Sess_5512,PartC_7451);
                                                        {9504}new Ns_7452: bitstring;
                                                        {9505}let gNs_7453: bitstring = exp(g,Ns_7452) in
                                                        {9506}let m2_7454: bitstring = (Cli_5510,gNs_7453) in
                                                        {9507}event beginSrv(Sess_5512,Cli_5510,gNs_7453);
                                                        {9508}out(c, (m2_7454,sign(h(m2_7454),skSess_7210)))
                                        )
                                        else
                                            {9509}let pkCli_7455: bitstring = fail-any in
                                            {9510}let v_7456: bool = (Disco_5511 = A) in
                                            (
                                                {9511}if v_7456 then
                                                (
                                                    {9512}let pkDisco_7457: bitstring = pub(skA) in
                                                    {9513}in(c, (=pkCli_7455,m1_7458: bitstring,sigM1_7459: bitstring));
                                                    {9514}if (verify(h(m1_7458),sigM1_7459,pkCli_7455) <> true) then
                                                        0
                                                    else
                                                        {9515}let (=Sess_5512,SPc_7460: bitstring,PartC_7461: bitstring) = m1_7458 in
                                                        {9516}event endSrv(Cli_5510,Sess_5512,PartC_7461);
                                                        {9517}new Ns_7462: bitstring;
                                                        {9518}let gNs_7463: bitstring = exp(g,Ns_7462) in
                                                        {9519}let m2_7464: bitstring = (Cli_5510,gNs_7463) in
                                                        {9520}event beginSrv(Sess_5512,Cli_5510,gNs_7463);
                                                        {9521}out(c, (m2_7464,sign(h(m2_7464),skSess_7210)))
                                                )
                                                else
                                                    {9522}let v_7465: bool = (Disco_5511 = B) in
                                                    (
                                                        {9523}if v_7465 then
                                                        (
                                                            {9524}let pkDisco_7466: bitstring = pub(skB) in
                                                            {9525}in(c, (=pkCli_7455,m1_7467: bitstring,sigM1_7468: bitstring));
                                                            {9526}if (verify(h(m1_7467),sigM1_7468,pkCli_7455) <> true) then
                                                                0
                                                            else
                                                                {9527}let (=Sess_5512,SPc_7469: bitstring,PartC_7470: bitstring) = m1_7467 in
                                                                {9528}event endSrv(Cli_5510,Sess_5512,PartC_7470);
                                                                {9529}new Ns_7471: bitstring;
                                                                {9530}let gNs_7472: bitstring = exp(g,Ns_7471) in
                                                                {9531}let m2_7473: bitstring = (Cli_5510,gNs_7472) in
                                                                {9532}event beginSrv(Sess_5512,Cli_5510,gNs_7472);
                                                                {9533}out(c, (m2_7473,sign(h(m2_7473),skSess_7210)))
                                                        )
                                                        else
                                                            {9534}let v_7474: bool = (Disco_5511 = C) in
                                                            (
                                                                {9535}if v_7474 then
                                                                (
                                                                    {9536}let pkDisco_7475: bitstring = pub(skC) in
                                                                    {9537}in(c, (=pkCli_7455,m1_7476: bitstring,sigM1_7477: bitstring));
                                                                    {9538}if (verify(h(m1_7476),sigM1_7477,pkCli_7455) <> true) then
                                                                        0
                                                                    else
                                                                        {9539}let (=Sess_5512,SPc_7478: bitstring,PartC_7479: bitstring) = m1_7476 in
                                                                        {9540}event endSrv(Cli_5510,Sess_5512,PartC_7479);
                                                                        {9541}new Ns_7480: bitstring;
                                                                        {9542}let gNs_7481: bitstring = exp(g,Ns_7480) in
                                                                        {9543}let m2_7482: bitstring = (Cli_5510,gNs_7481) in
                                                                        {9544}event beginSrv(Sess_5512,Cli_5510,gNs_7481);
                                                                        {9545}out(c, (m2_7482,sign(h(m2_7482),skSess_7210)))
                                                                )
                                                                else
                                                                    {9546}let pkDisco_7483: bitstring = pub(skI) in
                                                                    {9547}in(c, (=pkCli_7455,m1_7484: bitstring,sigM1_7485: bitstring));
                                                                    {9548}if (verify(h(m1_7484),sigM1_7485,pkCli_7455) <> true) then
                                                                        0
                                                                    else
                                                                        {9549}let (=Sess_5512,SPc_7486: bitstring,PartC_7487: bitstring) = m1_7484 in
                                                                        {9550}event endSrv(Cli_5510,Sess_5512,PartC_7487);
                                                                        {9551}new Ns_7488: bitstring;
                                                                        {9552}let gNs_7489: bitstring = exp(g,Ns_7488) in
                                                                        {9553}let m2_7490: bitstring = (Cli_5510,gNs_7489) in
                                                                        {9554}event beginSrv(Sess_5512,Cli_5510,gNs_7489);
                                                                        {9555}out(c, (m2_7490,sign(h(m2_7490),skSess_7210)))
                                                            )
                                                            else
                                                                {9556}let pkDisco_7491: bitstring = fail-any in
                                                                {9557}in(c, (=pkCli_7455,m1_7492: bitstring,sigM1_7493: bitstring));
                                                                {9558}if (verify(h(m1_7492),sigM1_7493,pkCli_7455) <> true) then
                                                                    0
                                                                else
                                                                    {9559}let (=Sess_5512,SPc_7494: bitstring,PartC_7495: bitstring) = m1_7492 in
                                                                    {9560}event endSrv(Cli_5510,Sess_5512,PartC_7495);
                                                                    {9561}new Ns_7496: bitstring;
                                                                    {9562}let gNs_7497: bitstring = exp(g,Ns_7496) in
                                                                    {9563}let m2_7498: bitstring = (Cli_5510,gNs_7497) in
                                                                    {9564}event beginSrv(Sess_5512,Cli_5510,gNs_7497);
                                                                    {9565}out(c, (m2_7498,sign(h(m2_7498),skSess_7210)))
                                                    )
                                                    else
                                                        {9566}let pkDisco_7499: bitstring = fail-any in
                                                        {9567}in(c, (=pkCli_7455,m1_7500: bitstring,sigM1_7501: bitstring));
                                                        {9568}if (verify(h(m1_7500),sigM1_7501,pkCli_7455) <> true) then
                                                            0
                                                        else
                                                            {9569}let (=Sess_5512,SPc_7502: bitstring,PartC_7503: bitstring) = m1_7500 in
                                                            {9570}event endSrv(Cli_5510,Sess_5512,PartC_7503);
                                                            {9571}new Ns_7504: bitstring;
                                                            {9572}let gNs_7505: bitstring = exp(g,Ns_7504) in
                                                            {9573}let m2_7506: bitstring = (Cli_5510,gNs_7505) in
                                                            {9574}event beginSrv(Sess_5512,Cli_5510,gNs_7505);
                                                            {9575}out(c, (m2_7506,sign(h(m2_7506),skSess_7210)))
                                            )
                                            else
                                                {9576}let pkDisco_7507: bitstring = fail-any in
                                                {9577}in(c, (=pkCli_7455,m1_7508: bitstring,sigM1_7509: bitstring));
                                                {9578}if (verify(h(m1_7508),sigM1_7509,pkCli_7455) <> true) then
                                                    0
                                                else
                                                    {9579}let (=Sess_5512,SPc_7510: bitstring,PartC_7511: bitstring) = m1_7508 in
                                                    {9580}event endSrv(Cli_5510,Sess_5512,PartC_7511);
                                                    {9581}new Ns_7512: bitstring;
                                                    {9582}let gNs_7513: bitstring = exp(g,Ns_7512) in
                                                    {9583}let m2_7514: bitstring = (Cli_5510,gNs_7513) in
                                                    {9584}event beginSrv(Sess_5512,Cli_5510,gNs_7513);
                                                    {9585}out(c, (m2_7514,sign(h(m2_7514),skSess_7210)))
                                )
                                else
                                    {9586}let pkCli_7515: bitstring = fail-any in
                                    {9587}let v_7516: bool = (Disco_5511 = A) in
                                    (
                                        {9588}if v_7516 then
                                        (
                                            {9589}let pkDisco_7517: bitstring = pub(skA) in
                                            {9590}in(c, (=pkCli_7515,m1_7518: bitstring,sigM1_7519: bitstring));
                                            {9591}if (verify(h(m1_7518),sigM1_7519,pkCli_7515) <> true) then
                                                0
                                            else
                                                {9592}let (=Sess_5512,SPc_7520: bitstring,PartC_7521: bitstring) = m1_7518 in
                                                {9593}event endSrv(Cli_5510,Sess_5512,PartC_7521);
                                                {9594}new Ns_7522: bitstring;
                                                {9595}let gNs_7523: bitstring = exp(g,Ns_7522) in
                                                {9596}let m2_7524: bitstring = (Cli_5510,gNs_7523) in
                                                {9597}event beginSrv(Sess_5512,Cli_5510,gNs_7523);
                                                {9598}out(c, (m2_7524,sign(h(m2_7524),skSess_7210)))
                                        )
                                        else
                                            {9599}let v_7525: bool = (Disco_5511 = B) in
                                            (
                                                {9600}if v_7525 then
                                                (
                                                    {9601}let pkDisco_7526: bitstring = pub(skB) in
                                                    {9602}in(c, (=pkCli_7515,m1_7527: bitstring,sigM1_7528: bitstring));
                                                    {9603}if (verify(h(m1_7527),sigM1_7528,pkCli_7515) <> true) then
                                                        0
                                                    else
                                                        {9604}let (=Sess_5512,SPc_7529: bitstring,PartC_7530: bitstring) = m1_7527 in
                                                        {9605}event endSrv(Cli_5510,Sess_5512,PartC_7530);
                                                        {9606}new Ns_7531: bitstring;
                                                        {9607}let gNs_7532: bitstring = exp(g,Ns_7531) in
                                                        {9608}let m2_7533: bitstring = (Cli_5510,gNs_7532) in
                                                        {9609}event beginSrv(Sess_5512,Cli_5510,gNs_7532);
                                                        {9610}out(c, (m2_7533,sign(h(m2_7533),skSess_7210)))
                                                )
                                                else
                                                    {9611}let v_7534: bool = (Disco_5511 = C) in
                                                    (
                                                        {9612}if v_7534 then
                                                        (
                                                            {9613}let pkDisco_7535: bitstring = pub(skC) in
                                                            {9614}in(c, (=pkCli_7515,m1_7536: bitstring,sigM1_7537: bitstring));
                                                            {9615}if (verify(h(m1_7536),sigM1_7537,pkCli_7515) <> true) then
                                                                0
                                                            else
                                                                {9616}let (=Sess_5512,SPc_7538: bitstring,PartC_7539: bitstring) = m1_7536 in
                                                                {9617}event endSrv(Cli_5510,Sess_5512,PartC_7539);
                                                                {9618}new Ns_7540: bitstring;
                                                                {9619}let gNs_7541: bitstring = exp(g,Ns_7540) in
                                                                {9620}let m2_7542: bitstring = (Cli_5510,gNs_7541) in
                                                                {9621}event beginSrv(Sess_5512,Cli_5510,gNs_7541);
                                                                {9622}out(c, (m2_7542,sign(h(m2_7542),skSess_7210)))
                                                        )
                                                        else
                                                            {9623}let pkDisco_7543: bitstring = pub(skI) in
                                                            {9624}in(c, (=pkCli_7515,m1_7544: bitstring,sigM1_7545: bitstring));
                                                            {9625}if (verify(h(m1_7544),sigM1_7545,pkCli_7515) <> true) then
                                                                0
                                                            else
                                                                {9626}let (=Sess_5512,SPc_7546: bitstring,PartC_7547: bitstring) = m1_7544 in
                                                                {9627}event endSrv(Cli_5510,Sess_5512,PartC_7547);
                                                                {9628}new Ns_7548: bitstring;
                                                                {9629}let gNs_7549: bitstring = exp(g,Ns_7548) in
                                                                {9630}let m2_7550: bitstring = (Cli_5510,gNs_7549) in
                                                                {9631}event beginSrv(Sess_5512,Cli_5510,gNs_7549);
                                                                {9632}out(c, (m2_7550,sign(h(m2_7550),skSess_7210)))
                                                    )
                                                    else
                                                        {9633}let pkDisco_7551: bitstring = fail-any in
                                                        {9634}in(c, (=pkCli_7515,m1_7552: bitstring,sigM1_7553: bitstring));
                                                        {9635}if (verify(h(m1_7552),sigM1_7553,pkCli_7515) <> true) then
                                                            0
                                                        else
                                                            {9636}let (=Sess_5512,SPc_7554: bitstring,PartC_7555: bitstring) = m1_7552 in
                                                            {9637}event endSrv(Cli_5510,Sess_5512,PartC_7555);
                                                            {9638}new Ns_7556: bitstring;
                                                            {9639}let gNs_7557: bitstring = exp(g,Ns_7556) in
                                                            {9640}let m2_7558: bitstring = (Cli_5510,gNs_7557) in
                                                            {9641}event beginSrv(Sess_5512,Cli_5510,gNs_7557);
                                                            {9642}out(c, (m2_7558,sign(h(m2_7558),skSess_7210)))
                                            )
                                            else
                                                {9643}let pkDisco_7559: bitstring = fail-any in
                                                {9644}in(c, (=pkCli_7515,m1_7560: bitstring,sigM1_7561: bitstring));
                                                {9645}if (verify(h(m1_7560),sigM1_7561,pkCli_7515) <> true) then
                                                    0
                                                else
                                                    {9646}let (=Sess_5512,SPc_7562: bitstring,PartC_7563: bitstring) = m1_7560 in
                                                    {9647}event endSrv(Cli_5510,Sess_5512,PartC_7563);
                                                    {9648}new Ns_7564: bitstring;
                                                    {9649}let gNs_7565: bitstring = exp(g,Ns_7564) in
                                                    {9650}let m2_7566: bitstring = (Cli_5510,gNs_7565) in
                                                    {9651}event beginSrv(Sess_5512,Cli_5510,gNs_7565);
                                                    {9652}out(c, (m2_7566,sign(h(m2_7566),skSess_7210)))
                                    )
                                    else
                                        {9653}let pkDisco_7567: bitstring = fail-any in
                                        {9654}in(c, (=pkCli_7515,m1_7568: bitstring,sigM1_7569: bitstring));
                                        {9655}if (verify(h(m1_7568),sigM1_7569,pkCli_7515) <> true) then
                                            0
                                        else
                                            {9656}let (=Sess_5512,SPc_7570: bitstring,PartC_7571: bitstring) = m1_7568 in
                                            {9657}event endSrv(Cli_5510,Sess_5512,PartC_7571);
                                            {9658}new Ns_7572: bitstring;
                                            {9659}let gNs_7573: bitstring = exp(g,Ns_7572) in
                                            {9660}let m2_7574: bitstring = (Cli_5510,gNs_7573) in
                                            {9661}event beginSrv(Sess_5512,Cli_5510,gNs_7573);
                                            {9662}out(c, (m2_7574,sign(h(m2_7574),skSess_7210)))
                        )
                        else
                            {9663}let pkCli_7575: bitstring = fail-any in
                            {9664}let v_7576: bool = (Disco_5511 = A) in
                            (
                                {9665}if v_7576 then
                                (
                                    {9666}let pkDisco_7577: bitstring = pub(skA) in
                                    {9667}in(c, (=pkCli_7575,m1_7578: bitstring,sigM1_7579: bitstring));
                                    {9668}if (verify(h(m1_7578),sigM1_7579,pkCli_7575) <> true) then
                                        0
                                    else
                                        {9669}let (=Sess_5512,SPc_7580: bitstring,PartC_7581: bitstring) = m1_7578 in
                                        {9670}event endSrv(Cli_5510,Sess_5512,PartC_7581);
                                        {9671}new Ns_7582: bitstring;
                                        {9672}let gNs_7583: bitstring = exp(g,Ns_7582) in
                                        {9673}let m2_7584: bitstring = (Cli_5510,gNs_7583) in
                                        {9674}event beginSrv(Sess_5512,Cli_5510,gNs_7583);
                                        {9675}out(c, (m2_7584,sign(h(m2_7584),skSess_7210)))
                                )
                                else
                                    {9676}let v_7585: bool = (Disco_5511 = B) in
                                    (
                                        {9677}if v_7585 then
                                        (
                                            {9678}let pkDisco_7586: bitstring = pub(skB) in
                                            {9679}in(c, (=pkCli_7575,m1_7587: bitstring,sigM1_7588: bitstring));
                                            {9680}if (verify(h(m1_7587),sigM1_7588,pkCli_7575) <> true) then
                                                0
                                            else
                                                {9681}let (=Sess_5512,SPc_7589: bitstring,PartC_7590: bitstring) = m1_7587 in
                                                {9682}event endSrv(Cli_5510,Sess_5512,PartC_7590);
                                                {9683}new Ns_7591: bitstring;
                                                {9684}let gNs_7592: bitstring = exp(g,Ns_7591) in
                                                {9685}let m2_7593: bitstring = (Cli_5510,gNs_7592) in
                                                {9686}event beginSrv(Sess_5512,Cli_5510,gNs_7592);
                                                {9687}out(c, (m2_7593,sign(h(m2_7593),skSess_7210)))
                                        )
                                        else
                                            {9688}let v_7594: bool = (Disco_5511 = C) in
                                            (
                                                {9689}if v_7594 then
                                                (
                                                    {9690}let pkDisco_7595: bitstring = pub(skC) in
                                                    {9691}in(c, (=pkCli_7575,m1_7596: bitstring,sigM1_7597: bitstring));
                                                    {9692}if (verify(h(m1_7596),sigM1_7597,pkCli_7575) <> true) then
                                                        0
                                                    else
                                                        {9693}let (=Sess_5512,SPc_7598: bitstring,PartC_7599: bitstring) = m1_7596 in
                                                        {9694}event endSrv(Cli_5510,Sess_5512,PartC_7599);
                                                        {9695}new Ns_7600: bitstring;
                                                        {9696}let gNs_7601: bitstring = exp(g,Ns_7600) in
                                                        {9697}let m2_7602: bitstring = (Cli_5510,gNs_7601) in
                                                        {9698}event beginSrv(Sess_5512,Cli_5510,gNs_7601);
                                                        {9699}out(c, (m2_7602,sign(h(m2_7602),skSess_7210)))
                                                )
                                                else
                                                    {9700}let pkDisco_7603: bitstring = pub(skI) in
                                                    {9701}in(c, (=pkCli_7575,m1_7604: bitstring,sigM1_7605: bitstring));
                                                    {9702}if (verify(h(m1_7604),sigM1_7605,pkCli_7575) <> true) then
                                                        0
                                                    else
                                                        {9703}let (=Sess_5512,SPc_7606: bitstring,PartC_7607: bitstring) = m1_7604 in
                                                        {9704}event endSrv(Cli_5510,Sess_5512,PartC_7607);
                                                        {9705}new Ns_7608: bitstring;
                                                        {9706}let gNs_7609: bitstring = exp(g,Ns_7608) in
                                                        {9707}let m2_7610: bitstring = (Cli_5510,gNs_7609) in
                                                        {9708}event beginSrv(Sess_5512,Cli_5510,gNs_7609);
                                                        {9709}out(c, (m2_7610,sign(h(m2_7610),skSess_7210)))
                                            )
                                            else
                                                {9710}let pkDisco_7611: bitstring = fail-any in
                                                {9711}in(c, (=pkCli_7575,m1_7612: bitstring,sigM1_7613: bitstring));
                                                {9712}if (verify(h(m1_7612),sigM1_7613,pkCli_7575) <> true) then
                                                    0
                                                else
                                                    {9713}let (=Sess_5512,SPc_7614: bitstring,PartC_7615: bitstring) = m1_7612 in
                                                    {9714}event endSrv(Cli_5510,Sess_5512,PartC_7615);
                                                    {9715}new Ns_7616: bitstring;
                                                    {9716}let gNs_7617: bitstring = exp(g,Ns_7616) in
                                                    {9717}let m2_7618: bitstring = (Cli_5510,gNs_7617) in
                                                    {9718}event beginSrv(Sess_5512,Cli_5510,gNs_7617);
                                                    {9719}out(c, (m2_7618,sign(h(m2_7618),skSess_7210)))
                                    )
                                    else
                                        {9720}let pkDisco_7619: bitstring = fail-any in
                                        {9721}in(c, (=pkCli_7575,m1_7620: bitstring,sigM1_7621: bitstring));
                                        {9722}if (verify(h(m1_7620),sigM1_7621,pkCli_7575) <> true) then
                                            0
                                        else
                                            {9723}let (=Sess_5512,SPc_7622: bitstring,PartC_7623: bitstring) = m1_7620 in
                                            {9724}event endSrv(Cli_5510,Sess_5512,PartC_7623);
                                            {9725}new Ns_7624: bitstring;
                                            {9726}let gNs_7625: bitstring = exp(g,Ns_7624) in
                                            {9727}let m2_7626: bitstring = (Cli_5510,gNs_7625) in
                                            {9728}event beginSrv(Sess_5512,Cli_5510,gNs_7625);
                                            {9729}out(c, (m2_7626,sign(h(m2_7626),skSess_7210)))
                            )
                            else
                                {9730}let pkDisco_7627: bitstring = fail-any in
                                {9731}in(c, (=pkCli_7575,m1_7628: bitstring,sigM1_7629: bitstring));
                                {9732}if (verify(h(m1_7628),sigM1_7629,pkCli_7575) <> true) then
                                    0
                                else
                                    {9733}let (=Sess_5512,SPc_7630: bitstring,PartC_7631: bitstring) = m1_7628 in
                                    {9734}event endSrv(Cli_5510,Sess_5512,PartC_7631);
                                    {9735}new Ns_7632: bitstring;
                                    {9736}let gNs_7633: bitstring = exp(g,Ns_7632) in
                                    {9737}let m2_7634: bitstring = (Cli_5510,gNs_7633) in
                                    {9738}event beginSrv(Sess_5512,Cli_5510,gNs_7633);
                                    {9739}out(c, (m2_7634,sign(h(m2_7634),skSess_7210)))
            )
            else
                {9740}let skSess_7635: bitstring = fail-any in
                {9741}let pkSess_7636: bitstring = pub(skSess_7635) in
                {9742}let v_7637: bool = (Cli_5510 = A) in
                (
                    {9743}if v_7637 then
                    (
                        {9744}let pkCli_7638: bitstring = pub(skA) in
                        {9745}let v_7639: bool = (Disco_5511 = A) in
                        (
                            {9746}if v_7639 then
                            (
                                {9747}let pkDisco_7640: bitstring = pub(skA) in
                                {9748}in(c, (=pkCli_7638,m1_7641: bitstring,sigM1_7642: bitstring));
                                {9749}if (verify(h(m1_7641),sigM1_7642,pkCli_7638) <> true) then
                                    0
                                else
                                    {9750}let (=Sess_5512,SPc_7643: bitstring,PartC_7644: bitstring) = m1_7641 in
                                    {9751}event endSrv(Cli_5510,Sess_5512,PartC_7644);
                                    {9752}new Ns_7645: bitstring;
                                    {9753}let gNs_7646: bitstring = exp(g,Ns_7645) in
                                    {9754}let m2_7647: bitstring = (Cli_5510,gNs_7646) in
                                    {9755}event beginSrv(Sess_5512,Cli_5510,gNs_7646);
                                    {9756}out(c, (m2_7647,sign(h(m2_7647),skSess_7635)))
                            )
                            else
                                {9757}let v_7648: bool = (Disco_5511 = B) in
                                (
                                    {9758}if v_7648 then
                                    (
                                        {9759}let pkDisco_7649: bitstring = pub(skB) in
                                        {9760}in(c, (=pkCli_7638,m1_7650: bitstring,sigM1_7651: bitstring));
                                        {9761}if (verify(h(m1_7650),sigM1_7651,pkCli_7638) <> true) then
                                            0
                                        else
                                            {9762}let (=Sess_5512,SPc_7652: bitstring,PartC_7653: bitstring) = m1_7650 in
                                            {9763}event endSrv(Cli_5510,Sess_5512,PartC_7653);
                                            {9764}new Ns_7654: bitstring;
                                            {9765}let gNs_7655: bitstring = exp(g,Ns_7654) in
                                            {9766}let m2_7656: bitstring = (Cli_5510,gNs_7655) in
                                            {9767}event beginSrv(Sess_5512,Cli_5510,gNs_7655);
                                            {9768}out(c, (m2_7656,sign(h(m2_7656),skSess_7635)))
                                    )
                                    else
                                        {9769}let v_7657: bool = (Disco_5511 = C) in
                                        (
                                            {9770}if v_7657 then
                                            (
                                                {9771}let pkDisco_7658: bitstring = pub(skC) in
                                                {9772}in(c, (=pkCli_7638,m1_7659: bitstring,sigM1_7660: bitstring));
                                                {9773}if (verify(h(m1_7659),sigM1_7660,pkCli_7638) <> true) then
                                                    0
                                                else
                                                    {9774}let (=Sess_5512,SPc_7661: bitstring,PartC_7662: bitstring) = m1_7659 in
                                                    {9775}event endSrv(Cli_5510,Sess_5512,PartC_7662);
                                                    {9776}new Ns_7663: bitstring;
                                                    {9777}let gNs_7664: bitstring = exp(g,Ns_7663) in
                                                    {9778}let m2_7665: bitstring = (Cli_5510,gNs_7664) in
                                                    {9779}event beginSrv(Sess_5512,Cli_5510,gNs_7664);
                                                    {9780}out(c, (m2_7665,sign(h(m2_7665),skSess_7635)))
                                            )
                                            else
                                                {9781}let pkDisco_7666: bitstring = pub(skI) in
                                                {9782}in(c, (=pkCli_7638,m1_7667: bitstring,sigM1_7668: bitstring));
                                                {9783}if (verify(h(m1_7667),sigM1_7668,pkCli_7638) <> true) then
                                                    0
                                                else
                                                    {9784}let (=Sess_5512,SPc_7669: bitstring,PartC_7670: bitstring) = m1_7667 in
                                                    {9785}event endSrv(Cli_5510,Sess_5512,PartC_7670);
                                                    {9786}new Ns_7671: bitstring;
                                                    {9787}let gNs_7672: bitstring = exp(g,Ns_7671) in
                                                    {9788}let m2_7673: bitstring = (Cli_5510,gNs_7672) in
                                                    {9789}event beginSrv(Sess_5512,Cli_5510,gNs_7672);
                                                    {9790}out(c, (m2_7673,sign(h(m2_7673),skSess_7635)))
                                        )
                                        else
                                            {9791}let pkDisco_7674: bitstring = fail-any in
                                            {9792}in(c, (=pkCli_7638,m1_7675: bitstring,sigM1_7676: bitstring));
                                            {9793}if (verify(h(m1_7675),sigM1_7676,pkCli_7638) <> true) then
                                                0
                                            else
                                                {9794}let (=Sess_5512,SPc_7677: bitstring,PartC_7678: bitstring) = m1_7675 in
                                                {9795}event endSrv(Cli_5510,Sess_5512,PartC_7678);
                                                {9796}new Ns_7679: bitstring;
                                                {9797}let gNs_7680: bitstring = exp(g,Ns_7679) in
                                                {9798}let m2_7681: bitstring = (Cli_5510,gNs_7680) in
                                                {9799}event beginSrv(Sess_5512,Cli_5510,gNs_7680);
                                                {9800}out(c, (m2_7681,sign(h(m2_7681),skSess_7635)))
                                )
                                else
                                    {9801}let pkDisco_7682: bitstring = fail-any in
                                    {9802}in(c, (=pkCli_7638,m1_7683: bitstring,sigM1_7684: bitstring));
                                    {9803}if (verify(h(m1_7683),sigM1_7684,pkCli_7638) <> true) then
                                        0
                                    else
                                        {9804}let (=Sess_5512,SPc_7685: bitstring,PartC_7686: bitstring) = m1_7683 in
                                        {9805}event endSrv(Cli_5510,Sess_5512,PartC_7686);
                                        {9806}new Ns_7687: bitstring;
                                        {9807}let gNs_7688: bitstring = exp(g,Ns_7687) in
                                        {9808}let m2_7689: bitstring = (Cli_5510,gNs_7688) in
                                        {9809}event beginSrv(Sess_5512,Cli_5510,gNs_7688);
                                        {9810}out(c, (m2_7689,sign(h(m2_7689),skSess_7635)))
                        )
                        else
                            {9811}let pkDisco_7690: bitstring = fail-any in
                            {9812}in(c, (=pkCli_7638,m1_7691: bitstring,sigM1_7692: bitstring));
                            {9813}if (verify(h(m1_7691),sigM1_7692,pkCli_7638) <> true) then
                                0
                            else
                                {9814}let (=Sess_5512,SPc_7693: bitstring,PartC_7694: bitstring) = m1_7691 in
                                {9815}event endSrv(Cli_5510,Sess_5512,PartC_7694);
                                {9816}new Ns_7695: bitstring;
                                {9817}let gNs_7696: bitstring = exp(g,Ns_7695) in
                                {9818}let m2_7697: bitstring = (Cli_5510,gNs_7696) in
                                {9819}event beginSrv(Sess_5512,Cli_5510,gNs_7696);
                                {9820}out(c, (m2_7697,sign(h(m2_7697),skSess_7635)))
                    )
                    else
                        {9821}let v_7698: bool = (Cli_5510 = B) in
                        (
                            {9822}if v_7698 then
                            (
                                {9823}let pkCli_7699: bitstring = pub(skB) in
                                {9824}let v_7700: bool = (Disco_5511 = A) in
                                (
                                    {9825}if v_7700 then
                                    (
                                        {9826}let pkDisco_7701: bitstring = pub(skA) in
                                        {9827}in(c, (=pkCli_7699,m1_7702: bitstring,sigM1_7703: bitstring));
                                        {9828}if (verify(h(m1_7702),sigM1_7703,pkCli_7699) <> true) then
                                            0
                                        else
                                            {9829}let (=Sess_5512,SPc_7704: bitstring,PartC_7705: bitstring) = m1_7702 in
                                            {9830}event endSrv(Cli_5510,Sess_5512,PartC_7705);
                                            {9831}new Ns_7706: bitstring;
                                            {9832}let gNs_7707: bitstring = exp(g,Ns_7706) in
                                            {9833}let m2_7708: bitstring = (Cli_5510,gNs_7707) in
                                            {9834}event beginSrv(Sess_5512,Cli_5510,gNs_7707);
                                            {9835}out(c, (m2_7708,sign(h(m2_7708),skSess_7635)))
                                    )
                                    else
                                        {9836}let v_7709: bool = (Disco_5511 = B) in
                                        (
                                            {9837}if v_7709 then
                                            (
                                                {9838}let pkDisco_7710: bitstring = pub(skB) in
                                                {9839}in(c, (=pkCli_7699,m1_7711: bitstring,sigM1_7712: bitstring));
                                                {9840}if (verify(h(m1_7711),sigM1_7712,pkCli_7699) <> true) then
                                                    0
                                                else
                                                    {9841}let (=Sess_5512,SPc_7713: bitstring,PartC_7714: bitstring) = m1_7711 in
                                                    {9842}event endSrv(Cli_5510,Sess_5512,PartC_7714);
                                                    {9843}new Ns_7715: bitstring;
                                                    {9844}let gNs_7716: bitstring = exp(g,Ns_7715) in
                                                    {9845}let m2_7717: bitstring = (Cli_5510,gNs_7716) in
                                                    {9846}event beginSrv(Sess_5512,Cli_5510,gNs_7716);
                                                    {9847}out(c, (m2_7717,sign(h(m2_7717),skSess_7635)))
                                            )
                                            else
                                                {9848}let v_7718: bool = (Disco_5511 = C) in
                                                (
                                                    {9849}if v_7718 then
                                                    (
                                                        {9850}let pkDisco_7719: bitstring = pub(skC) in
                                                        {9851}in(c, (=pkCli_7699,m1_7720: bitstring,sigM1_7721: bitstring));
                                                        {9852}if (verify(h(m1_7720),sigM1_7721,pkCli_7699) <> true) then
                                                            0
                                                        else
                                                            {9853}let (=Sess_5512,SPc_7722: bitstring,PartC_7723: bitstring) = m1_7720 in
                                                            {9854}event endSrv(Cli_5510,Sess_5512,PartC_7723);
                                                            {9855}new Ns_7724: bitstring;
                                                            {9856}let gNs_7725: bitstring = exp(g,Ns_7724) in
                                                            {9857}let m2_7726: bitstring = (Cli_5510,gNs_7725) in
                                                            {9858}event beginSrv(Sess_5512,Cli_5510,gNs_7725);
                                                            {9859}out(c, (m2_7726,sign(h(m2_7726),skSess_7635)))
                                                    )
                                                    else
                                                        {9860}let pkDisco_7727: bitstring = pub(skI) in
                                                        {9861}in(c, (=pkCli_7699,m1_7728: bitstring,sigM1_7729: bitstring));
                                                        {9862}if (verify(h(m1_7728),sigM1_7729,pkCli_7699) <> true) then
                                                            0
                                                        else
                                                            {9863}let (=Sess_5512,SPc_7730: bitstring,PartC_7731: bitstring) = m1_7728 in
                                                            {9864}event endSrv(Cli_5510,Sess_5512,PartC_7731);
                                                            {9865}new Ns_7732: bitstring;
                                                            {9866}let gNs_7733: bitstring = exp(g,Ns_7732) in
                                                            {9867}let m2_7734: bitstring = (Cli_5510,gNs_7733) in
                                                            {9868}event beginSrv(Sess_5512,Cli_5510,gNs_7733);
                                                            {9869}out(c, (m2_7734,sign(h(m2_7734),skSess_7635)))
                                                )
                                                else
                                                    {9870}let pkDisco_7735: bitstring = fail-any in
                                                    {9871}in(c, (=pkCli_7699,m1_7736: bitstring,sigM1_7737: bitstring));
                                                    {9872}if (verify(h(m1_7736),sigM1_7737,pkCli_7699) <> true) then
                                                        0
                                                    else
                                                        {9873}let (=Sess_5512,SPc_7738: bitstring,PartC_7739: bitstring) = m1_7736 in
                                                        {9874}event endSrv(Cli_5510,Sess_5512,PartC_7739);
                                                        {9875}new Ns_7740: bitstring;
                                                        {9876}let gNs_7741: bitstring = exp(g,Ns_7740) in
                                                        {9877}let m2_7742: bitstring = (Cli_5510,gNs_7741) in
                                                        {9878}event beginSrv(Sess_5512,Cli_5510,gNs_7741);
                                                        {9879}out(c, (m2_7742,sign(h(m2_7742),skSess_7635)))
                                        )
                                        else
                                            {9880}let pkDisco_7743: bitstring = fail-any in
                                            {9881}in(c, (=pkCli_7699,m1_7744: bitstring,sigM1_7745: bitstring));
                                            {9882}if (verify(h(m1_7744),sigM1_7745,pkCli_7699) <> true) then
                                                0
                                            else
                                                {9883}let (=Sess_5512,SPc_7746: bitstring,PartC_7747: bitstring) = m1_7744 in
                                                {9884}event endSrv(Cli_5510,Sess_5512,PartC_7747);
                                                {9885}new Ns_7748: bitstring;
                                                {9886}let gNs_7749: bitstring = exp(g,Ns_7748) in
                                                {9887}let m2_7750: bitstring = (Cli_5510,gNs_7749) in
                                                {9888}event beginSrv(Sess_5512,Cli_5510,gNs_7749);
                                                {9889}out(c, (m2_7750,sign(h(m2_7750),skSess_7635)))
                                )
                                else
                                    {9890}let pkDisco_7751: bitstring = fail-any in
                                    {9891}in(c, (=pkCli_7699,m1_7752: bitstring,sigM1_7753: bitstring));
                                    {9892}if (verify(h(m1_7752),sigM1_7753,pkCli_7699) <> true) then
                                        0
                                    else
                                        {9893}let (=Sess_5512,SPc_7754: bitstring,PartC_7755: bitstring) = m1_7752 in
                                        {9894}event endSrv(Cli_5510,Sess_5512,PartC_7755);
                                        {9895}new Ns_7756: bitstring;
                                        {9896}let gNs_7757: bitstring = exp(g,Ns_7756) in
                                        {9897}let m2_7758: bitstring = (Cli_5510,gNs_7757) in
                                        {9898}event beginSrv(Sess_5512,Cli_5510,gNs_7757);
                                        {9899}out(c, (m2_7758,sign(h(m2_7758),skSess_7635)))
                            )
                            else
                                {9900}let v_7759: bool = (Cli_5510 = C) in
                                (
                                    {9901}if v_7759 then
                                    (
                                        {9902}let pkCli_7760: bitstring = pub(skC) in
                                        {9903}let v_7761: bool = (Disco_5511 = A) in
                                        (
                                            {9904}if v_7761 then
                                            (
                                                {9905}let pkDisco_7762: bitstring = pub(skA) in
                                                {9906}in(c, (=pkCli_7760,m1_7763: bitstring,sigM1_7764: bitstring));
                                                {9907}if (verify(h(m1_7763),sigM1_7764,pkCli_7760) <> true) then
                                                    0
                                                else
                                                    {9908}let (=Sess_5512,SPc_7765: bitstring,PartC_7766: bitstring) = m1_7763 in
                                                    {9909}event endSrv(Cli_5510,Sess_5512,PartC_7766);
                                                    {9910}new Ns_7767: bitstring;
                                                    {9911}let gNs_7768: bitstring = exp(g,Ns_7767) in
                                                    {9912}let m2_7769: bitstring = (Cli_5510,gNs_7768) in
                                                    {9913}event beginSrv(Sess_5512,Cli_5510,gNs_7768);
                                                    {9914}out(c, (m2_7769,sign(h(m2_7769),skSess_7635)))
                                            )
                                            else
                                                {9915}let v_7770: bool = (Disco_5511 = B) in
                                                (
                                                    {9916}if v_7770 then
                                                    (
                                                        {9917}let pkDisco_7771: bitstring = pub(skB) in
                                                        {9918}in(c, (=pkCli_7760,m1_7772: bitstring,sigM1_7773: bitstring));
                                                        {9919}if (verify(h(m1_7772),sigM1_7773,pkCli_7760) <> true) then
                                                            0
                                                        else
                                                            {9920}let (=Sess_5512,SPc_7774: bitstring,PartC_7775: bitstring) = m1_7772 in
                                                            {9921}event endSrv(Cli_5510,Sess_5512,PartC_7775);
                                                            {9922}new Ns_7776: bitstring;
                                                            {9923}let gNs_7777: bitstring = exp(g,Ns_7776) in
                                                            {9924}let m2_7778: bitstring = (Cli_5510,gNs_7777) in
                                                            {9925}event beginSrv(Sess_5512,Cli_5510,gNs_7777);
                                                            {9926}out(c, (m2_7778,sign(h(m2_7778),skSess_7635)))
                                                    )
                                                    else
                                                        {9927}let v_7779: bool = (Disco_5511 = C) in
                                                        (
                                                            {9928}if v_7779 then
                                                            (
                                                                {9929}let pkDisco_7780: bitstring = pub(skC) in
                                                                {9930}in(c, (=pkCli_7760,m1_7781: bitstring,sigM1_7782: bitstring));
                                                                {9931}if (verify(h(m1_7781),sigM1_7782,pkCli_7760) <> true) then
                                                                    0
                                                                else
                                                                    {9932}let (=Sess_5512,SPc_7783: bitstring,PartC_7784: bitstring) = m1_7781 in
                                                                    {9933}event endSrv(Cli_5510,Sess_5512,PartC_7784);
                                                                    {9934}new Ns_7785: bitstring;
                                                                    {9935}let gNs_7786: bitstring = exp(g,Ns_7785) in
                                                                    {9936}let m2_7787: bitstring = (Cli_5510,gNs_7786) in
                                                                    {9937}event beginSrv(Sess_5512,Cli_5510,gNs_7786);
                                                                    {9938}out(c, (m2_7787,sign(h(m2_7787),skSess_7635)))
                                                            )
                                                            else
                                                                {9939}let pkDisco_7788: bitstring = pub(skI) in
                                                                {9940}in(c, (=pkCli_7760,m1_7789: bitstring,sigM1_7790: bitstring));
                                                                {9941}if (verify(h(m1_7789),sigM1_7790,pkCli_7760) <> true) then
                                                                    0
                                                                else
                                                                    {9942}let (=Sess_5512,SPc_7791: bitstring,PartC_7792: bitstring) = m1_7789 in
                                                                    {9943}event endSrv(Cli_5510,Sess_5512,PartC_7792);
                                                                    {9944}new Ns_7793: bitstring;
                                                                    {9945}let gNs_7794: bitstring = exp(g,Ns_7793) in
                                                                    {9946}let m2_7795: bitstring = (Cli_5510,gNs_7794) in
                                                                    {9947}event beginSrv(Sess_5512,Cli_5510,gNs_7794);
                                                                    {9948}out(c, (m2_7795,sign(h(m2_7795),skSess_7635)))
                                                        )
                                                        else
                                                            {9949}let pkDisco_7796: bitstring = fail-any in
                                                            {9950}in(c, (=pkCli_7760,m1_7797: bitstring,sigM1_7798: bitstring));
                                                            {9951}if (verify(h(m1_7797),sigM1_7798,pkCli_7760) <> true) then
                                                                0
                                                            else
                                                                {9952}let (=Sess_5512,SPc_7799: bitstring,PartC_7800: bitstring) = m1_7797 in
                                                                {9953}event endSrv(Cli_5510,Sess_5512,PartC_7800);
                                                                {9954}new Ns_7801: bitstring;
                                                                {9955}let gNs_7802: bitstring = exp(g,Ns_7801) in
                                                                {9956}let m2_7803: bitstring = (Cli_5510,gNs_7802) in
                                                                {9957}event beginSrv(Sess_5512,Cli_5510,gNs_7802);
                                                                {9958}out(c, (m2_7803,sign(h(m2_7803),skSess_7635)))
                                                )
                                                else
                                                    {9959}let pkDisco_7804: bitstring = fail-any in
                                                    {9960}in(c, (=pkCli_7760,m1_7805: bitstring,sigM1_7806: bitstring));
                                                    {9961}if (verify(h(m1_7805),sigM1_7806,pkCli_7760) <> true) then
                                                        0
                                                    else
                                                        {9962}let (=Sess_5512,SPc_7807: bitstring,PartC_7808: bitstring) = m1_7805 in
                                                        {9963}event endSrv(Cli_5510,Sess_5512,PartC_7808);
                                                        {9964}new Ns_7809: bitstring;
                                                        {9965}let gNs_7810: bitstring = exp(g,Ns_7809) in
                                                        {9966}let m2_7811: bitstring = (Cli_5510,gNs_7810) in
                                                        {9967}event beginSrv(Sess_5512,Cli_5510,gNs_7810);
                                                        {9968}out(c, (m2_7811,sign(h(m2_7811),skSess_7635)))
                                        )
                                        else
                                            {9969}let pkDisco_7812: bitstring = fail-any in
                                            {9970}in(c, (=pkCli_7760,m1_7813: bitstring,sigM1_7814: bitstring));
                                            {9971}if (verify(h(m1_7813),sigM1_7814,pkCli_7760) <> true) then
                                                0
                                            else
                                                {9972}let (=Sess_5512,SPc_7815: bitstring,PartC_7816: bitstring) = m1_7813 in
                                                {9973}event endSrv(Cli_5510,Sess_5512,PartC_7816);
                                                {9974}new Ns_7817: bitstring;
                                                {9975}let gNs_7818: bitstring = exp(g,Ns_7817) in
                                                {9976}let m2_7819: bitstring = (Cli_5510,gNs_7818) in
                                                {9977}event beginSrv(Sess_5512,Cli_5510,gNs_7818);
                                                {9978}out(c, (m2_7819,sign(h(m2_7819),skSess_7635)))
                                    )
                                    else
                                        {9979}let pkCli_7820: bitstring = pub(skI) in
                                        {9980}let v_7821: bool = (Disco_5511 = A) in
                                        (
                                            {9981}if v_7821 then
                                            (
                                                {9982}let pkDisco_7822: bitstring = pub(skA) in
                                                {9983}in(c, (=pkCli_7820,m1_7823: bitstring,sigM1_7824: bitstring));
                                                {9984}if (verify(h(m1_7823),sigM1_7824,pkCli_7820) <> true) then
                                                    0
                                                else
                                                    {9985}let (=Sess_5512,SPc_7825: bitstring,PartC_7826: bitstring) = m1_7823 in
                                                    {9986}event endSrv(Cli_5510,Sess_5512,PartC_7826);
                                                    {9987}new Ns_7827: bitstring;
                                                    {9988}let gNs_7828: bitstring = exp(g,Ns_7827) in
                                                    {9989}let m2_7829: bitstring = (Cli_5510,gNs_7828) in
                                                    {9990}event beginSrv(Sess_5512,Cli_5510,gNs_7828);
                                                    {9991}out(c, (m2_7829,sign(h(m2_7829),skSess_7635)))
                                            )
                                            else
                                                {9992}let v_7830: bool = (Disco_5511 = B) in
                                                (
                                                    {9993}if v_7830 then
                                                    (
                                                        {9994}let pkDisco_7831: bitstring = pub(skB) in
                                                        {9995}in(c, (=pkCli_7820,m1_7832: bitstring,sigM1_7833: bitstring));
                                                        {9996}if (verify(h(m1_7832),sigM1_7833,pkCli_7820) <> true) then
                                                            0
                                                        else
                                                            {9997}let (=Sess_5512,SPc_7834: bitstring,PartC_7835: bitstring) = m1_7832 in
                                                            {9998}event endSrv(Cli_5510,Sess_5512,PartC_7835);
                                                            {9999}new Ns_7836: bitstring;
                                                            {10000}let gNs_7837: bitstring = exp(g,Ns_7836) in
                                                            {10001}let m2_7838: bitstring = (Cli_5510,gNs_7837) in
                                                            {10002}event beginSrv(Sess_5512,Cli_5510,gNs_7837);
                                                            {10003}out(c, (m2_7838,sign(h(m2_7838),skSess_7635)))
                                                    )
                                                    else
                                                        {10004}let v_7839: bool = (Disco_5511 = C) in
                                                        (
                                                            {10005}if v_7839 then
                                                            (
                                                                {10006}let pkDisco_7840: bitstring = pub(skC) in
                                                                {10007}in(c, (=pkCli_7820,m1_7841: bitstring,sigM1_7842: bitstring));
                                                                {10008}if (verify(h(m1_7841),sigM1_7842,pkCli_7820) <> true) then
                                                                    0
                                                                else
                                                                    {10009}let (=Sess_5512,SPc_7843: bitstring,PartC_7844: bitstring) = m1_7841 in
                                                                    {10010}event endSrv(Cli_5510,Sess_5512,PartC_7844);
                                                                    {10011}new Ns_7845: bitstring;
                                                                    {10012}let gNs_7846: bitstring = exp(g,Ns_7845) in
                                                                    {10013}let m2_7847: bitstring = (Cli_5510,gNs_7846) in
                                                                    {10014}event beginSrv(Sess_5512,Cli_5510,gNs_7846);
                                                                    {10015}out(c, (m2_7847,sign(h(m2_7847),skSess_7635)))
                                                            )
                                                            else
                                                                {10016}let pkDisco_7848: bitstring = pub(skI) in
                                                                {10017}in(c, (=pkCli_7820,m1_7849: bitstring,sigM1_7850: bitstring));
                                                                {10018}if (verify(h(m1_7849),sigM1_7850,pkCli_7820) <> true) then
                                                                    0
                                                                else
                                                                    {10019}let (=Sess_5512,SPc_7851: bitstring,PartC_7852: bitstring) = m1_7849 in
                                                                    {10020}event endSrv(Cli_5510,Sess_5512,PartC_7852);
                                                                    {10021}new Ns_7853: bitstring;
                                                                    {10022}let gNs_7854: bitstring = exp(g,Ns_7853) in
                                                                    {10023}let m2_7855: bitstring = (Cli_5510,gNs_7854) in
                                                                    {10024}event beginSrv(Sess_5512,Cli_5510,gNs_7854);
                                                                    {10025}out(c, (m2_7855,sign(h(m2_7855),skSess_7635)))
                                                        )
                                                        else
                                                            {10026}let pkDisco_7856: bitstring = fail-any in
                                                            {10027}in(c, (=pkCli_7820,m1_7857: bitstring,sigM1_7858: bitstring));
                                                            {10028}if (verify(h(m1_7857),sigM1_7858,pkCli_7820) <> true) then
                                                                0
                                                            else
                                                                {10029}let (=Sess_5512,SPc_7859: bitstring,PartC_7860: bitstring) = m1_7857 in
                                                                {10030}event endSrv(Cli_5510,Sess_5512,PartC_7860);
                                                                {10031}new Ns_7861: bitstring;
                                                                {10032}let gNs_7862: bitstring = exp(g,Ns_7861) in
                                                                {10033}let m2_7863: bitstring = (Cli_5510,gNs_7862) in
                                                                {10034}event beginSrv(Sess_5512,Cli_5510,gNs_7862);
                                                                {10035}out(c, (m2_7863,sign(h(m2_7863),skSess_7635)))
                                                )
                                                else
                                                    {10036}let pkDisco_7864: bitstring = fail-any in
                                                    {10037}in(c, (=pkCli_7820,m1_7865: bitstring,sigM1_7866: bitstring));
                                                    {10038}if (verify(h(m1_7865),sigM1_7866,pkCli_7820) <> true) then
                                                        0
                                                    else
                                                        {10039}let (=Sess_5512,SPc_7867: bitstring,PartC_7868: bitstring) = m1_7865 in
                                                        {10040}event endSrv(Cli_5510,Sess_5512,PartC_7868);
                                                        {10041}new Ns_7869: bitstring;
                                                        {10042}let gNs_7870: bitstring = exp(g,Ns_7869) in
                                                        {10043}let m2_7871: bitstring = (Cli_5510,gNs_7870) in
                                                        {10044}event beginSrv(Sess_5512,Cli_5510,gNs_7870);
                                                        {10045}out(c, (m2_7871,sign(h(m2_7871),skSess_7635)))
                                        )
                                        else
                                            {10046}let pkDisco_7872: bitstring = fail-any in
                                            {10047}in(c, (=pkCli_7820,m1_7873: bitstring,sigM1_7874: bitstring));
                                            {10048}if (verify(h(m1_7873),sigM1_7874,pkCli_7820) <> true) then
                                                0
                                            else
                                                {10049}let (=Sess_5512,SPc_7875: bitstring,PartC_7876: bitstring) = m1_7873 in
                                                {10050}event endSrv(Cli_5510,Sess_5512,PartC_7876);
                                                {10051}new Ns_7877: bitstring;
                                                {10052}let gNs_7878: bitstring = exp(g,Ns_7877) in
                                                {10053}let m2_7879: bitstring = (Cli_5510,gNs_7878) in
                                                {10054}event beginSrv(Sess_5512,Cli_5510,gNs_7878);
                                                {10055}out(c, (m2_7879,sign(h(m2_7879),skSess_7635)))
                                )
                                else
                                    {10056}let pkCli_7880: bitstring = fail-any in
                                    {10057}let v_7881: bool = (Disco_5511 = A) in
                                    (
                                        {10058}if v_7881 then
                                        (
                                            {10059}let pkDisco_7882: bitstring = pub(skA) in
                                            {10060}in(c, (=pkCli_7880,m1_7883: bitstring,sigM1_7884: bitstring));
                                            {10061}if (verify(h(m1_7883),sigM1_7884,pkCli_7880) <> true) then
                                                0
                                            else
                                                {10062}let (=Sess_5512,SPc_7885: bitstring,PartC_7886: bitstring) = m1_7883 in
                                                {10063}event endSrv(Cli_5510,Sess_5512,PartC_7886);
                                                {10064}new Ns_7887: bitstring;
                                                {10065}let gNs_7888: bitstring = exp(g,Ns_7887) in
                                                {10066}let m2_7889: bitstring = (Cli_5510,gNs_7888) in
                                                {10067}event beginSrv(Sess_5512,Cli_5510,gNs_7888);
                                                {10068}out(c, (m2_7889,sign(h(m2_7889),skSess_7635)))
                                        )
                                        else
                                            {10069}let v_7890: bool = (Disco_5511 = B) in
                                            (
                                                {10070}if v_7890 then
                                                (
                                                    {10071}let pkDisco_7891: bitstring = pub(skB) in
                                                    {10072}in(c, (=pkCli_7880,m1_7892: bitstring,sigM1_7893: bitstring));
                                                    {10073}if (verify(h(m1_7892),sigM1_7893,pkCli_7880) <> true) then
                                                        0
                                                    else
                                                        {10074}let (=Sess_5512,SPc_7894: bitstring,PartC_7895: bitstring) = m1_7892 in
                                                        {10075}event endSrv(Cli_5510,Sess_5512,PartC_7895);
                                                        {10076}new Ns_7896: bitstring;
                                                        {10077}let gNs_7897: bitstring = exp(g,Ns_7896) in
                                                        {10078}let m2_7898: bitstring = (Cli_5510,gNs_7897) in
                                                        {10079}event beginSrv(Sess_5512,Cli_5510,gNs_7897);
                                                        {10080}out(c, (m2_7898,sign(h(m2_7898),skSess_7635)))
                                                )
                                                else
                                                    {10081}let v_7899: bool = (Disco_5511 = C) in
                                                    (
                                                        {10082}if v_7899 then
                                                        (
                                                            {10083}let pkDisco_7900: bitstring = pub(skC) in
                                                            {10084}in(c, (=pkCli_7880,m1_7901: bitstring,sigM1_7902: bitstring));
                                                            {10085}if (verify(h(m1_7901),sigM1_7902,pkCli_7880) <> true) then
                                                                0
                                                            else
                                                                {10086}let (=Sess_5512,SPc_7903: bitstring,PartC_7904: bitstring) = m1_7901 in
                                                                {10087}event endSrv(Cli_5510,Sess_5512,PartC_7904);
                                                                {10088}new Ns_7905: bitstring;
                                                                {10089}let gNs_7906: bitstring = exp(g,Ns_7905) in
                                                                {10090}let m2_7907: bitstring = (Cli_5510,gNs_7906) in
                                                                {10091}event beginSrv(Sess_5512,Cli_5510,gNs_7906);
                                                                {10092}out(c, (m2_7907,sign(h(m2_7907),skSess_7635)))
                                                        )
                                                        else
                                                            {10093}let pkDisco_7908: bitstring = pub(skI) in
                                                            {10094}in(c, (=pkCli_7880,m1_7909: bitstring,sigM1_7910: bitstring));
                                                            {10095}if (verify(h(m1_7909),sigM1_7910,pkCli_7880) <> true) then
                                                                0
                                                            else
                                                                {10096}let (=Sess_5512,SPc_7911: bitstring,PartC_7912: bitstring) = m1_7909 in
                                                                {10097}event endSrv(Cli_5510,Sess_5512,PartC_7912);
                                                                {10098}new Ns_7913: bitstring;
                                                                {10099}let gNs_7914: bitstring = exp(g,Ns_7913) in
                                                                {10100}let m2_7915: bitstring = (Cli_5510,gNs_7914) in
                                                                {10101}event beginSrv(Sess_5512,Cli_5510,gNs_7914);
                                                                {10102}out(c, (m2_7915,sign(h(m2_7915),skSess_7635)))
                                                    )
                                                    else
                                                        {10103}let pkDisco_7916: bitstring = fail-any in
                                                        {10104}in(c, (=pkCli_7880,m1_7917: bitstring,sigM1_7918: bitstring));
                                                        {10105}if (verify(h(m1_7917),sigM1_7918,pkCli_7880) <> true) then
                                                            0
                                                        else
                                                            {10106}let (=Sess_5512,SPc_7919: bitstring,PartC_7920: bitstring) = m1_7917 in
                                                            {10107}event endSrv(Cli_5510,Sess_5512,PartC_7920);
                                                            {10108}new Ns_7921: bitstring;
                                                            {10109}let gNs_7922: bitstring = exp(g,Ns_7921) in
                                                            {10110}let m2_7923: bitstring = (Cli_5510,gNs_7922) in
                                                            {10111}event beginSrv(Sess_5512,Cli_5510,gNs_7922);
                                                            {10112}out(c, (m2_7923,sign(h(m2_7923),skSess_7635)))
                                            )
                                            else
                                                {10113}let pkDisco_7924: bitstring = fail-any in
                                                {10114}in(c, (=pkCli_7880,m1_7925: bitstring,sigM1_7926: bitstring));
                                                {10115}if (verify(h(m1_7925),sigM1_7926,pkCli_7880) <> true) then
                                                    0
                                                else
                                                    {10116}let (=Sess_5512,SPc_7927: bitstring,PartC_7928: bitstring) = m1_7925 in
                                                    {10117}event endSrv(Cli_5510,Sess_5512,PartC_7928);
                                                    {10118}new Ns_7929: bitstring;
                                                    {10119}let gNs_7930: bitstring = exp(g,Ns_7929) in
                                                    {10120}let m2_7931: bitstring = (Cli_5510,gNs_7930) in
                                                    {10121}event beginSrv(Sess_5512,Cli_5510,gNs_7930);
                                                    {10122}out(c, (m2_7931,sign(h(m2_7931),skSess_7635)))
                                    )
                                    else
                                        {10123}let pkDisco_7932: bitstring = fail-any in
                                        {10124}in(c, (=pkCli_7880,m1_7933: bitstring,sigM1_7934: bitstring));
                                        {10125}if (verify(h(m1_7933),sigM1_7934,pkCli_7880) <> true) then
                                            0
                                        else
                                            {10126}let (=Sess_5512,SPc_7935: bitstring,PartC_7936: bitstring) = m1_7933 in
                                            {10127}event endSrv(Cli_5510,Sess_5512,PartC_7936);
                                            {10128}new Ns_7937: bitstring;
                                            {10129}let gNs_7938: bitstring = exp(g,Ns_7937) in
                                            {10130}let m2_7939: bitstring = (Cli_5510,gNs_7938) in
                                            {10131}event beginSrv(Sess_5512,Cli_5510,gNs_7938);
                                            {10132}out(c, (m2_7939,sign(h(m2_7939),skSess_7635)))
                        )
                        else
                            {10133}let pkCli_7940: bitstring = fail-any in
                            {10134}let v_7941: bool = (Disco_5511 = A) in
                            (
                                {10135}if v_7941 then
                                (
                                    {10136}let pkDisco_7942: bitstring = pub(skA) in
                                    {10137}in(c, (=pkCli_7940,m1_7943: bitstring,sigM1_7944: bitstring));
                                    {10138}if (verify(h(m1_7943),sigM1_7944,pkCli_7940) <> true) then
                                        0
                                    else
                                        {10139}let (=Sess_5512,SPc_7945: bitstring,PartC_7946: bitstring) = m1_7943 in
                                        {10140}event endSrv(Cli_5510,Sess_5512,PartC_7946);
                                        {10141}new Ns_7947: bitstring;
                                        {10142}let gNs_7948: bitstring = exp(g,Ns_7947) in
                                        {10143}let m2_7949: bitstring = (Cli_5510,gNs_7948) in
                                        {10144}event beginSrv(Sess_5512,Cli_5510,gNs_7948);
                                        {10145}out(c, (m2_7949,sign(h(m2_7949),skSess_7635)))
                                )
                                else
                                    {10146}let v_7950: bool = (Disco_5511 = B) in
                                    (
                                        {10147}if v_7950 then
                                        (
                                            {10148}let pkDisco_7951: bitstring = pub(skB) in
                                            {10149}in(c, (=pkCli_7940,m1_7952: bitstring,sigM1_7953: bitstring));
                                            {10150}if (verify(h(m1_7952),sigM1_7953,pkCli_7940) <> true) then
                                                0
                                            else
                                                {10151}let (=Sess_5512,SPc_7954: bitstring,PartC_7955: bitstring) = m1_7952 in
                                                {10152}event endSrv(Cli_5510,Sess_5512,PartC_7955);
                                                {10153}new Ns_7956: bitstring;
                                                {10154}let gNs_7957: bitstring = exp(g,Ns_7956) in
                                                {10155}let m2_7958: bitstring = (Cli_5510,gNs_7957) in
                                                {10156}event beginSrv(Sess_5512,Cli_5510,gNs_7957);
                                                {10157}out(c, (m2_7958,sign(h(m2_7958),skSess_7635)))
                                        )
                                        else
                                            {10158}let v_7959: bool = (Disco_5511 = C) in
                                            (
                                                {10159}if v_7959 then
                                                (
                                                    {10160}let pkDisco_7960: bitstring = pub(skC) in
                                                    {10161}in(c, (=pkCli_7940,m1_7961: bitstring,sigM1_7962: bitstring));
                                                    {10162}if (verify(h(m1_7961),sigM1_7962,pkCli_7940) <> true) then
                                                        0
                                                    else
                                                        {10163}let (=Sess_5512,SPc_7963: bitstring,PartC_7964: bitstring) = m1_7961 in
                                                        {10164}event endSrv(Cli_5510,Sess_5512,PartC_7964);
                                                        {10165}new Ns_7965: bitstring;
                                                        {10166}let gNs_7966: bitstring = exp(g,Ns_7965) in
                                                        {10167}let m2_7967: bitstring = (Cli_5510,gNs_7966) in
                                                        {10168}event beginSrv(Sess_5512,Cli_5510,gNs_7966);
                                                        {10169}out(c, (m2_7967,sign(h(m2_7967),skSess_7635)))
                                                )
                                                else
                                                    {10170}let pkDisco_7968: bitstring = pub(skI) in
                                                    {10171}in(c, (=pkCli_7940,m1_7969: bitstring,sigM1_7970: bitstring));
                                                    {10172}if (verify(h(m1_7969),sigM1_7970,pkCli_7940) <> true) then
                                                        0
                                                    else
                                                        {10173}let (=Sess_5512,SPc_7971: bitstring,PartC_7972: bitstring) = m1_7969 in
                                                        {10174}event endSrv(Cli_5510,Sess_5512,PartC_7972);
                                                        {10175}new Ns_7973: bitstring;
                                                        {10176}let gNs_7974: bitstring = exp(g,Ns_7973) in
                                                        {10177}let m2_7975: bitstring = (Cli_5510,gNs_7974) in
                                                        {10178}event beginSrv(Sess_5512,Cli_5510,gNs_7974);
                                                        {10179}out(c, (m2_7975,sign(h(m2_7975),skSess_7635)))
                                            )
                                            else
                                                {10180}let pkDisco_7976: bitstring = fail-any in
                                                {10181}in(c, (=pkCli_7940,m1_7977: bitstring,sigM1_7978: bitstring));
                                                {10182}if (verify(h(m1_7977),sigM1_7978,pkCli_7940) <> true) then
                                                    0
                                                else
                                                    {10183}let (=Sess_5512,SPc_7979: bitstring,PartC_7980: bitstring) = m1_7977 in
                                                    {10184}event endSrv(Cli_5510,Sess_5512,PartC_7980);
                                                    {10185}new Ns_7981: bitstring;
                                                    {10186}let gNs_7982: bitstring = exp(g,Ns_7981) in
                                                    {10187}let m2_7983: bitstring = (Cli_5510,gNs_7982) in
                                                    {10188}event beginSrv(Sess_5512,Cli_5510,gNs_7982);
                                                    {10189}out(c, (m2_7983,sign(h(m2_7983),skSess_7635)))
                                    )
                                    else
                                        {10190}let pkDisco_7984: bitstring = fail-any in
                                        {10191}in(c, (=pkCli_7940,m1_7985: bitstring,sigM1_7986: bitstring));
                                        {10192}if (verify(h(m1_7985),sigM1_7986,pkCli_7940) <> true) then
                                            0
                                        else
                                            {10193}let (=Sess_5512,SPc_7987: bitstring,PartC_7988: bitstring) = m1_7985 in
                                            {10194}event endSrv(Cli_5510,Sess_5512,PartC_7988);
                                            {10195}new Ns_7989: bitstring;
                                            {10196}let gNs_7990: bitstring = exp(g,Ns_7989) in
                                            {10197}let m2_7991: bitstring = (Cli_5510,gNs_7990) in
                                            {10198}event beginSrv(Sess_5512,Cli_5510,gNs_7990);
                                            {10199}out(c, (m2_7991,sign(h(m2_7991),skSess_7635)))
                            )
                            else
                                {10200}let pkDisco_7992: bitstring = fail-any in
                                {10201}in(c, (=pkCli_7940,m1_7993: bitstring,sigM1_7994: bitstring));
                                {10202}if (verify(h(m1_7993),sigM1_7994,pkCli_7940) <> true) then
                                    0
                                else
                                    {10203}let (=Sess_5512,SPc_7995: bitstring,PartC_7996: bitstring) = m1_7993 in
                                    {10204}event endSrv(Cli_5510,Sess_5512,PartC_7996);
                                    {10205}new Ns_7997: bitstring;
                                    {10206}let gNs_7998: bitstring = exp(g,Ns_7997) in
                                    {10207}let m2_7999: bitstring = (Cli_5510,gNs_7998) in
                                    {10208}event beginSrv(Sess_5512,Cli_5510,gNs_7998);
                                    {10209}out(c, (m2_7999,sign(h(m2_7999),skSess_7635)))
                )
                else
                    {10210}let pkCli_8000: bitstring = fail-any in
                    {10211}let v_8001: bool = (Disco_5511 = A) in
                    (
                        {10212}if v_8001 then
                        (
                            {10213}let pkDisco_8002: bitstring = pub(skA) in
                            {10214}in(c, (=pkCli_8000,m1_8003: bitstring,sigM1_8004: bitstring));
                            {10215}if (verify(h(m1_8003),sigM1_8004,pkCli_8000) <> true) then
                                0
                            else
                                {10216}let (=Sess_5512,SPc_8005: bitstring,PartC_8006: bitstring) = m1_8003 in
                                {10217}event endSrv(Cli_5510,Sess_5512,PartC_8006);
                                {10218}new Ns_8007: bitstring;
                                {10219}let gNs_8008: bitstring = exp(g,Ns_8007) in
                                {10220}let m2_8009: bitstring = (Cli_5510,gNs_8008) in
                                {10221}event beginSrv(Sess_5512,Cli_5510,gNs_8008);
                                {10222}out(c, (m2_8009,sign(h(m2_8009),skSess_7635)))
                        )
                        else
                            {10223}let v_8010: bool = (Disco_5511 = B) in
                            (
                                {10224}if v_8010 then
                                (
                                    {10225}let pkDisco_8011: bitstring = pub(skB) in
                                    {10226}in(c, (=pkCli_8000,m1_8012: bitstring,sigM1_8013: bitstring));
                                    {10227}if (verify(h(m1_8012),sigM1_8013,pkCli_8000) <> true) then
                                        0
                                    else
                                        {10228}let (=Sess_5512,SPc_8014: bitstring,PartC_8015: bitstring) = m1_8012 in
                                        {10229}event endSrv(Cli_5510,Sess_5512,PartC_8015);
                                        {10230}new Ns_8016: bitstring;
                                        {10231}let gNs_8017: bitstring = exp(g,Ns_8016) in
                                        {10232}let m2_8018: bitstring = (Cli_5510,gNs_8017) in
                                        {10233}event beginSrv(Sess_5512,Cli_5510,gNs_8017);
                                        {10234}out(c, (m2_8018,sign(h(m2_8018),skSess_7635)))
                                )
                                else
                                    {10235}let v_8019: bool = (Disco_5511 = C) in
                                    (
                                        {10236}if v_8019 then
                                        (
                                            {10237}let pkDisco_8020: bitstring = pub(skC) in
                                            {10238}in(c, (=pkCli_8000,m1_8021: bitstring,sigM1_8022: bitstring));
                                            {10239}if (verify(h(m1_8021),sigM1_8022,pkCli_8000) <> true) then
                                                0
                                            else
                                                {10240}let (=Sess_5512,SPc_8023: bitstring,PartC_8024: bitstring) = m1_8021 in
                                                {10241}event endSrv(Cli_5510,Sess_5512,PartC_8024);
                                                {10242}new Ns_8025: bitstring;
                                                {10243}let gNs_8026: bitstring = exp(g,Ns_8025) in
                                                {10244}let m2_8027: bitstring = (Cli_5510,gNs_8026) in
                                                {10245}event beginSrv(Sess_5512,Cli_5510,gNs_8026);
                                                {10246}out(c, (m2_8027,sign(h(m2_8027),skSess_7635)))
                                        )
                                        else
                                            {10247}let pkDisco_8028: bitstring = pub(skI) in
                                            {10248}in(c, (=pkCli_8000,m1_8029: bitstring,sigM1_8030: bitstring));
                                            {10249}if (verify(h(m1_8029),sigM1_8030,pkCli_8000) <> true) then
                                                0
                                            else
                                                {10250}let (=Sess_5512,SPc_8031: bitstring,PartC_8032: bitstring) = m1_8029 in
                                                {10251}event endSrv(Cli_5510,Sess_5512,PartC_8032);
                                                {10252}new Ns_8033: bitstring;
                                                {10253}let gNs_8034: bitstring = exp(g,Ns_8033) in
                                                {10254}let m2_8035: bitstring = (Cli_5510,gNs_8034) in
                                                {10255}event beginSrv(Sess_5512,Cli_5510,gNs_8034);
                                                {10256}out(c, (m2_8035,sign(h(m2_8035),skSess_7635)))
                                    )
                                    else
                                        {10257}let pkDisco_8036: bitstring = fail-any in
                                        {10258}in(c, (=pkCli_8000,m1_8037: bitstring,sigM1_8038: bitstring));
                                        {10259}if (verify(h(m1_8037),sigM1_8038,pkCli_8000) <> true) then
                                            0
                                        else
                                            {10260}let (=Sess_5512,SPc_8039: bitstring,PartC_8040: bitstring) = m1_8037 in
                                            {10261}event endSrv(Cli_5510,Sess_5512,PartC_8040);
                                            {10262}new Ns_8041: bitstring;
                                            {10263}let gNs_8042: bitstring = exp(g,Ns_8041) in
                                            {10264}let m2_8043: bitstring = (Cli_5510,gNs_8042) in
                                            {10265}event beginSrv(Sess_5512,Cli_5510,gNs_8042);
                                            {10266}out(c, (m2_8043,sign(h(m2_8043),skSess_7635)))
                            )
                            else
                                {10267}let pkDisco_8044: bitstring = fail-any in
                                {10268}in(c, (=pkCli_8000,m1_8045: bitstring,sigM1_8046: bitstring));
                                {10269}if (verify(h(m1_8045),sigM1_8046,pkCli_8000) <> true) then
                                    0
                                else
                                    {10270}let (=Sess_5512,SPc_8047: bitstring,PartC_8048: bitstring) = m1_8045 in
                                    {10271}event endSrv(Cli_5510,Sess_5512,PartC_8048);
                                    {10272}new Ns_8049: bitstring;
                                    {10273}let gNs_8050: bitstring = exp(g,Ns_8049) in
                                    {10274}let m2_8051: bitstring = (Cli_5510,gNs_8050) in
                                    {10275}event beginSrv(Sess_5512,Cli_5510,gNs_8050);
                                    {10276}out(c, (m2_8051,sign(h(m2_8051),skSess_7635)))
                    )
                    else
                        {10277}let pkDisco_8052: bitstring = fail-any in
                        {10278}in(c, (=pkCli_8000,m1_8053: bitstring,sigM1_8054: bitstring));
                        {10279}if (verify(h(m1_8053),sigM1_8054,pkCli_8000) <> true) then
                            0
                        else
                            {10280}let (=Sess_5512,SPc_8055: bitstring,PartC_8056: bitstring) = m1_8053 in
                            {10281}event endSrv(Cli_5510,Sess_5512,PartC_8056);
                            {10282}new Ns_8057: bitstring;
                            {10283}let gNs_8058: bitstring = exp(g,Ns_8057) in
                            {10284}let m2_8059: bitstring = (Cli_5510,gNs_8058) in
                            {10285}event beginSrv(Sess_5512,Cli_5510,gNs_8058);
                            {10286}out(c, (m2_8059,sign(h(m2_8059),skSess_7635)))
    )
    else
        {10287}let skSess_8060: bitstring = fail-any in
        {10288}let pkSess_8061: bitstring = pub(skSess_8060) in
        {10289}let v_8062: bool = (Cli_5510 = A) in
        (
            {10290}if v_8062 then
            (
                {10291}let pkCli_8063: bitstring = pub(skA) in
                {10292}let v_8064: bool = (Disco_5511 = A) in
                (
                    {10293}if v_8064 then
                    (
                        {10294}let pkDisco_8065: bitstring = pub(skA) in
                        {10295}in(c, (=pkCli_8063,m1_8066: bitstring,sigM1_8067: bitstring));
                        {10296}if (verify(h(m1_8066),sigM1_8067,pkCli_8063) <> true) then
                            0
                        else
                            {10297}let (=Sess_5512,SPc_8068: bitstring,PartC_8069: bitstring) = m1_8066 in
                            {10298}event endSrv(Cli_5510,Sess_5512,PartC_8069);
                            {10299}new Ns_8070: bitstring;
                            {10300}let gNs_8071: bitstring = exp(g,Ns_8070) in
                            {10301}let m2_8072: bitstring = (Cli_5510,gNs_8071) in
                            {10302}event beginSrv(Sess_5512,Cli_5510,gNs_8071);
                            {10303}out(c, (m2_8072,sign(h(m2_8072),skSess_8060)))
                    )
                    else
                        {10304}let v_8073: bool = (Disco_5511 = B) in
                        (
                            {10305}if v_8073 then
                            (
                                {10306}let pkDisco_8074: bitstring = pub(skB) in
                                {10307}in(c, (=pkCli_8063,m1_8075: bitstring,sigM1_8076: bitstring));
                                {10308}if (verify(h(m1_8075),sigM1_8076,pkCli_8063) <> true) then
                                    0
                                else
                                    {10309}let (=Sess_5512,SPc_8077: bitstring,PartC_8078: bitstring) = m1_8075 in
                                    {10310}event endSrv(Cli_5510,Sess_5512,PartC_8078);
                                    {10311}new Ns_8079: bitstring;
                                    {10312}let gNs_8080: bitstring = exp(g,Ns_8079) in
                                    {10313}let m2_8081: bitstring = (Cli_5510,gNs_8080) in
                                    {10314}event beginSrv(Sess_5512,Cli_5510,gNs_8080);
                                    {10315}out(c, (m2_8081,sign(h(m2_8081),skSess_8060)))
                            )
                            else
                                {10316}let v_8082: bool = (Disco_5511 = C) in
                                (
                                    {10317}if v_8082 then
                                    (
                                        {10318}let pkDisco_8083: bitstring = pub(skC) in
                                        {10319}in(c, (=pkCli_8063,m1_8084: bitstring,sigM1_8085: bitstring));
                                        {10320}if (verify(h(m1_8084),sigM1_8085,pkCli_8063) <> true) then
                                            0
                                        else
                                            {10321}let (=Sess_5512,SPc_8086: bitstring,PartC_8087: bitstring) = m1_8084 in
                                            {10322}event endSrv(Cli_5510,Sess_5512,PartC_8087);
                                            {10323}new Ns_8088: bitstring;
                                            {10324}let gNs_8089: bitstring = exp(g,Ns_8088) in
                                            {10325}let m2_8090: bitstring = (Cli_5510,gNs_8089) in
                                            {10326}event beginSrv(Sess_5512,Cli_5510,gNs_8089);
                                            {10327}out(c, (m2_8090,sign(h(m2_8090),skSess_8060)))
                                    )
                                    else
                                        {10328}let pkDisco_8091: bitstring = pub(skI) in
                                        {10329}in(c, (=pkCli_8063,m1_8092: bitstring,sigM1_8093: bitstring));
                                        {10330}if (verify(h(m1_8092),sigM1_8093,pkCli_8063) <> true) then
                                            0
                                        else
                                            {10331}let (=Sess_5512,SPc_8094: bitstring,PartC_8095: bitstring) = m1_8092 in
                                            {10332}event endSrv(Cli_5510,Sess_5512,PartC_8095);
                                            {10333}new Ns_8096: bitstring;
                                            {10334}let gNs_8097: bitstring = exp(g,Ns_8096) in
                                            {10335}let m2_8098: bitstring = (Cli_5510,gNs_8097) in
                                            {10336}event beginSrv(Sess_5512,Cli_5510,gNs_8097);
                                            {10337}out(c, (m2_8098,sign(h(m2_8098),skSess_8060)))
                                )
                                else
                                    {10338}let pkDisco_8099: bitstring = fail-any in
                                    {10339}in(c, (=pkCli_8063,m1_8100: bitstring,sigM1_8101: bitstring));
                                    {10340}if (verify(h(m1_8100),sigM1_8101,pkCli_8063) <> true) then
                                        0
                                    else
                                        {10341}let (=Sess_5512,SPc_8102: bitstring,PartC_8103: bitstring) = m1_8100 in
                                        {10342}event endSrv(Cli_5510,Sess_5512,PartC_8103);
                                        {10343}new Ns_8104: bitstring;
                                        {10344}let gNs_8105: bitstring = exp(g,Ns_8104) in
                                        {10345}let m2_8106: bitstring = (Cli_5510,gNs_8105) in
                                        {10346}event beginSrv(Sess_5512,Cli_5510,gNs_8105);
                                        {10347}out(c, (m2_8106,sign(h(m2_8106),skSess_8060)))
                        )
                        else
                            {10348}let pkDisco_8107: bitstring = fail-any in
                            {10349}in(c, (=pkCli_8063,m1_8108: bitstring,sigM1_8109: bitstring));
                            {10350}if (verify(h(m1_8108),sigM1_8109,pkCli_8063) <> true) then
                                0
                            else
                                {10351}let (=Sess_5512,SPc_8110: bitstring,PartC_8111: bitstring) = m1_8108 in
                                {10352}event endSrv(Cli_5510,Sess_5512,PartC_8111);
                                {10353}new Ns_8112: bitstring;
                                {10354}let gNs_8113: bitstring = exp(g,Ns_8112) in
                                {10355}let m2_8114: bitstring = (Cli_5510,gNs_8113) in
                                {10356}event beginSrv(Sess_5512,Cli_5510,gNs_8113);
                                {10357}out(c, (m2_8114,sign(h(m2_8114),skSess_8060)))
                )
                else
                    {10358}let pkDisco_8115: bitstring = fail-any in
                    {10359}in(c, (=pkCli_8063,m1_8116: bitstring,sigM1_8117: bitstring));
                    {10360}if (verify(h(m1_8116),sigM1_8117,pkCli_8063) <> true) then
                        0
                    else
                        {10361}let (=Sess_5512,SPc_8118: bitstring,PartC_8119: bitstring) = m1_8116 in
                        {10362}event endSrv(Cli_5510,Sess_5512,PartC_8119);
                        {10363}new Ns_8120: bitstring;
                        {10364}let gNs_8121: bitstring = exp(g,Ns_8120) in
                        {10365}let m2_8122: bitstring = (Cli_5510,gNs_8121) in
                        {10366}event beginSrv(Sess_5512,Cli_5510,gNs_8121);
                        {10367}out(c, (m2_8122,sign(h(m2_8122),skSess_8060)))
            )
            else
                {10368}let v_8123: bool = (Cli_5510 = B) in
                (
                    {10369}if v_8123 then
                    (
                        {10370}let pkCli_8124: bitstring = pub(skB) in
                        {10371}let v_8125: bool = (Disco_5511 = A) in
                        (
                            {10372}if v_8125 then
                            (
                                {10373}let pkDisco_8126: bitstring = pub(skA) in
                                {10374}in(c, (=pkCli_8124,m1_8127: bitstring,sigM1_8128: bitstring));
                                {10375}if (verify(h(m1_8127),sigM1_8128,pkCli_8124) <> true) then
                                    0
                                else
                                    {10376}let (=Sess_5512,SPc_8129: bitstring,PartC_8130: bitstring) = m1_8127 in
                                    {10377}event endSrv(Cli_5510,Sess_5512,PartC_8130);
                                    {10378}new Ns_8131: bitstring;
                                    {10379}let gNs_8132: bitstring = exp(g,Ns_8131) in
                                    {10380}let m2_8133: bitstring = (Cli_5510,gNs_8132) in
                                    {10381}event beginSrv(Sess_5512,Cli_5510,gNs_8132);
                                    {10382}out(c, (m2_8133,sign(h(m2_8133),skSess_8060)))
                            )
                            else
                                {10383}let v_8134: bool = (Disco_5511 = B) in
                                (
                                    {10384}if v_8134 then
                                    (
                                        {10385}let pkDisco_8135: bitstring = pub(skB) in
                                        {10386}in(c, (=pkCli_8124,m1_8136: bitstring,sigM1_8137: bitstring));
                                        {10387}if (verify(h(m1_8136),sigM1_8137,pkCli_8124) <> true) then
                                            0
                                        else
                                            {10388}let (=Sess_5512,SPc_8138: bitstring,PartC_8139: bitstring) = m1_8136 in
                                            {10389}event endSrv(Cli_5510,Sess_5512,PartC_8139);
                                            {10390}new Ns_8140: bitstring;
                                            {10391}let gNs_8141: bitstring = exp(g,Ns_8140) in
                                            {10392}let m2_8142: bitstring = (Cli_5510,gNs_8141) in
                                            {10393}event beginSrv(Sess_5512,Cli_5510,gNs_8141);
                                            {10394}out(c, (m2_8142,sign(h(m2_8142),skSess_8060)))
                                    )
                                    else
                                        {10395}let v_8143: bool = (Disco_5511 = C) in
                                        (
                                            {10396}if v_8143 then
                                            (
                                                {10397}let pkDisco_8144: bitstring = pub(skC) in
                                                {10398}in(c, (=pkCli_8124,m1_8145: bitstring,sigM1_8146: bitstring));
                                                {10399}if (verify(h(m1_8145),sigM1_8146,pkCli_8124) <> true) then
                                                    0
                                                else
                                                    {10400}let (=Sess_5512,SPc_8147: bitstring,PartC_8148: bitstring) = m1_8145 in
                                                    {10401}event endSrv(Cli_5510,Sess_5512,PartC_8148);
                                                    {10402}new Ns_8149: bitstring;
                                                    {10403}let gNs_8150: bitstring = exp(g,Ns_8149) in
                                                    {10404}let m2_8151: bitstring = (Cli_5510,gNs_8150) in
                                                    {10405}event beginSrv(Sess_5512,Cli_5510,gNs_8150);
                                                    {10406}out(c, (m2_8151,sign(h(m2_8151),skSess_8060)))
                                            )
                                            else
                                                {10407}let pkDisco_8152: bitstring = pub(skI) in
                                                {10408}in(c, (=pkCli_8124,m1_8153: bitstring,sigM1_8154: bitstring));
                                                {10409}if (verify(h(m1_8153),sigM1_8154,pkCli_8124) <> true) then
                                                    0
                                                else
                                                    {10410}let (=Sess_5512,SPc_8155: bitstring,PartC_8156: bitstring) = m1_8153 in
                                                    {10411}event endSrv(Cli_5510,Sess_5512,PartC_8156);
                                                    {10412}new Ns_8157: bitstring;
                                                    {10413}let gNs_8158: bitstring = exp(g,Ns_8157) in
                                                    {10414}let m2_8159: bitstring = (Cli_5510,gNs_8158) in
                                                    {10415}event beginSrv(Sess_5512,Cli_5510,gNs_8158);
                                                    {10416}out(c, (m2_8159,sign(h(m2_8159),skSess_8060)))
                                        )
                                        else
                                            {10417}let pkDisco_8160: bitstring = fail-any in
                                            {10418}in(c, (=pkCli_8124,m1_8161: bitstring,sigM1_8162: bitstring));
                                            {10419}if (verify(h(m1_8161),sigM1_8162,pkCli_8124) <> true) then
                                                0
                                            else
                                                {10420}let (=Sess_5512,SPc_8163: bitstring,PartC_8164: bitstring) = m1_8161 in
                                                {10421}event endSrv(Cli_5510,Sess_5512,PartC_8164);
                                                {10422}new Ns_8165: bitstring;
                                                {10423}let gNs_8166: bitstring = exp(g,Ns_8165) in
                                                {10424}let m2_8167: bitstring = (Cli_5510,gNs_8166) in
                                                {10425}event beginSrv(Sess_5512,Cli_5510,gNs_8166);
                                                {10426}out(c, (m2_8167,sign(h(m2_8167),skSess_8060)))
                                )
                                else
                                    {10427}let pkDisco_8168: bitstring = fail-any in
                                    {10428}in(c, (=pkCli_8124,m1_8169: bitstring,sigM1_8170: bitstring));
                                    {10429}if (verify(h(m1_8169),sigM1_8170,pkCli_8124) <> true) then
                                        0
                                    else
                                        {10430}let (=Sess_5512,SPc_8171: bitstring,PartC_8172: bitstring) = m1_8169 in
                                        {10431}event endSrv(Cli_5510,Sess_5512,PartC_8172);
                                        {10432}new Ns_8173: bitstring;
                                        {10433}let gNs_8174: bitstring = exp(g,Ns_8173) in
                                        {10434}let m2_8175: bitstring = (Cli_5510,gNs_8174) in
                                        {10435}event beginSrv(Sess_5512,Cli_5510,gNs_8174);
                                        {10436}out(c, (m2_8175,sign(h(m2_8175),skSess_8060)))
                        )
                        else
                            {10437}let pkDisco_8176: bitstring = fail-any in
                            {10438}in(c, (=pkCli_8124,m1_8177: bitstring,sigM1_8178: bitstring));
                            {10439}if (verify(h(m1_8177),sigM1_8178,pkCli_8124) <> true) then
                                0
                            else
                                {10440}let (=Sess_5512,SPc_8179: bitstring,PartC_8180: bitstring) = m1_8177 in
                                {10441}event endSrv(Cli_5510,Sess_5512,PartC_8180);
                                {10442}new Ns_8181: bitstring;
                                {10443}let gNs_8182: bitstring = exp(g,Ns_8181) in
                                {10444}let m2_8183: bitstring = (Cli_5510,gNs_8182) in
                                {10445}event beginSrv(Sess_5512,Cli_5510,gNs_8182);
                                {10446}out(c, (m2_8183,sign(h(m2_8183),skSess_8060)))
                    )
                    else
                        {10447}let v_8184: bool = (Cli_5510 = C) in
                        (
                            {10448}if v_8184 then
                            (
                                {10449}let pkCli_8185: bitstring = pub(skC) in
                                {10450}let v_8186: bool = (Disco_5511 = A) in
                                (
                                    {10451}if v_8186 then
                                    (
                                        {10452}let pkDisco_8187: bitstring = pub(skA) in
                                        {10453}in(c, (=pkCli_8185,m1_8188: bitstring,sigM1_8189: bitstring));
                                        {10454}if (verify(h(m1_8188),sigM1_8189,pkCli_8185) <> true) then
                                            0
                                        else
                                            {10455}let (=Sess_5512,SPc_8190: bitstring,PartC_8191: bitstring) = m1_8188 in
                                            {10456}event endSrv(Cli_5510,Sess_5512,PartC_8191);
                                            {10457}new Ns_8192: bitstring;
                                            {10458}let gNs_8193: bitstring = exp(g,Ns_8192) in
                                            {10459}let m2_8194: bitstring = (Cli_5510,gNs_8193) in
                                            {10460}event beginSrv(Sess_5512,Cli_5510,gNs_8193);
                                            {10461}out(c, (m2_8194,sign(h(m2_8194),skSess_8060)))
                                    )
                                    else
                                        {10462}let v_8195: bool = (Disco_5511 = B) in
                                        (
                                            {10463}if v_8195 then
                                            (
                                                {10464}let pkDisco_8196: bitstring = pub(skB) in
                                                {10465}in(c, (=pkCli_8185,m1_8197: bitstring,sigM1_8198: bitstring));
                                                {10466}if (verify(h(m1_8197),sigM1_8198,pkCli_8185) <> true) then
                                                    0
                                                else
                                                    {10467}let (=Sess_5512,SPc_8199: bitstring,PartC_8200: bitstring) = m1_8197 in
                                                    {10468}event endSrv(Cli_5510,Sess_5512,PartC_8200);
                                                    {10469}new Ns_8201: bitstring;
                                                    {10470}let gNs_8202: bitstring = exp(g,Ns_8201) in
                                                    {10471}let m2_8203: bitstring = (Cli_5510,gNs_8202) in
                                                    {10472}event beginSrv(Sess_5512,Cli_5510,gNs_8202);
                                                    {10473}out(c, (m2_8203,sign(h(m2_8203),skSess_8060)))
                                            )
                                            else
                                                {10474}let v_8204: bool = (Disco_5511 = C) in
                                                (
                                                    {10475}if v_8204 then
                                                    (
                                                        {10476}let pkDisco_8205: bitstring = pub(skC) in
                                                        {10477}in(c, (=pkCli_8185,m1_8206: bitstring,sigM1_8207: bitstring));
                                                        {10478}if (verify(h(m1_8206),sigM1_8207,pkCli_8185) <> true) then
                                                            0
                                                        else
                                                            {10479}let (=Sess_5512,SPc_8208: bitstring,PartC_8209: bitstring) = m1_8206 in
                                                            {10480}event endSrv(Cli_5510,Sess_5512,PartC_8209);
                                                            {10481}new Ns_8210: bitstring;
                                                            {10482}let gNs_8211: bitstring = exp(g,Ns_8210) in
                                                            {10483}let m2_8212: bitstring = (Cli_5510,gNs_8211) in
                                                            {10484}event beginSrv(Sess_5512,Cli_5510,gNs_8211);
                                                            {10485}out(c, (m2_8212,sign(h(m2_8212),skSess_8060)))
                                                    )
                                                    else
                                                        {10486}let pkDisco_8213: bitstring = pub(skI) in
                                                        {10487}in(c, (=pkCli_8185,m1_8214: bitstring,sigM1_8215: bitstring));
                                                        {10488}if (verify(h(m1_8214),sigM1_8215,pkCli_8185) <> true) then
                                                            0
                                                        else
                                                            {10489}let (=Sess_5512,SPc_8216: bitstring,PartC_8217: bitstring) = m1_8214 in
                                                            {10490}event endSrv(Cli_5510,Sess_5512,PartC_8217);
                                                            {10491}new Ns_8218: bitstring;
                                                            {10492}let gNs_8219: bitstring = exp(g,Ns_8218) in
                                                            {10493}let m2_8220: bitstring = (Cli_5510,gNs_8219) in
                                                            {10494}event beginSrv(Sess_5512,Cli_5510,gNs_8219);
                                                            {10495}out(c, (m2_8220,sign(h(m2_8220),skSess_8060)))
                                                )
                                                else
                                                    {10496}let pkDisco_8221: bitstring = fail-any in
                                                    {10497}in(c, (=pkCli_8185,m1_8222: bitstring,sigM1_8223: bitstring));
                                                    {10498}if (verify(h(m1_8222),sigM1_8223,pkCli_8185) <> true) then
                                                        0
                                                    else
                                                        {10499}let (=Sess_5512,SPc_8224: bitstring,PartC_8225: bitstring) = m1_8222 in
                                                        {10500}event endSrv(Cli_5510,Sess_5512,PartC_8225);
                                                        {10501}new Ns_8226: bitstring;
                                                        {10502}let gNs_8227: bitstring = exp(g,Ns_8226) in
                                                        {10503}let m2_8228: bitstring = (Cli_5510,gNs_8227) in
                                                        {10504}event beginSrv(Sess_5512,Cli_5510,gNs_8227);
                                                        {10505}out(c, (m2_8228,sign(h(m2_8228),skSess_8060)))
                                        )
                                        else
                                            {10506}let pkDisco_8229: bitstring = fail-any in
                                            {10507}in(c, (=pkCli_8185,m1_8230: bitstring,sigM1_8231: bitstring));
                                            {10508}if (verify(h(m1_8230),sigM1_8231,pkCli_8185) <> true) then
                                                0
                                            else
                                                {10509}let (=Sess_5512,SPc_8232: bitstring,PartC_8233: bitstring) = m1_8230 in
                                                {10510}event endSrv(Cli_5510,Sess_5512,PartC_8233);
                                                {10511}new Ns_8234: bitstring;
                                                {10512}let gNs_8235: bitstring = exp(g,Ns_8234) in
                                                {10513}let m2_8236: bitstring = (Cli_5510,gNs_8235) in
                                                {10514}event beginSrv(Sess_5512,Cli_5510,gNs_8235);
                                                {10515}out(c, (m2_8236,sign(h(m2_8236),skSess_8060)))
                                )
                                else
                                    {10516}let pkDisco_8237: bitstring = fail-any in
                                    {10517}in(c, (=pkCli_8185,m1_8238: bitstring,sigM1_8239: bitstring));
                                    {10518}if (verify(h(m1_8238),sigM1_8239,pkCli_8185) <> true) then
                                        0
                                    else
                                        {10519}let (=Sess_5512,SPc_8240: bitstring,PartC_8241: bitstring) = m1_8238 in
                                        {10520}event endSrv(Cli_5510,Sess_5512,PartC_8241);
                                        {10521}new Ns_8242: bitstring;
                                        {10522}let gNs_8243: bitstring = exp(g,Ns_8242) in
                                        {10523}let m2_8244: bitstring = (Cli_5510,gNs_8243) in
                                        {10524}event beginSrv(Sess_5512,Cli_5510,gNs_8243);
                                        {10525}out(c, (m2_8244,sign(h(m2_8244),skSess_8060)))
                            )
                            else
                                {10526}let pkCli_8245: bitstring = pub(skI) in
                                {10527}let v_8246: bool = (Disco_5511 = A) in
                                (
                                    {10528}if v_8246 then
                                    (
                                        {10529}let pkDisco_8247: bitstring = pub(skA) in
                                        {10530}in(c, (=pkCli_8245,m1_8248: bitstring,sigM1_8249: bitstring));
                                        {10531}if (verify(h(m1_8248),sigM1_8249,pkCli_8245) <> true) then
                                            0
                                        else
                                            {10532}let (=Sess_5512,SPc_8250: bitstring,PartC_8251: bitstring) = m1_8248 in
                                            {10533}event endSrv(Cli_5510,Sess_5512,PartC_8251);
                                            {10534}new Ns_8252: bitstring;
                                            {10535}let gNs_8253: bitstring = exp(g,Ns_8252) in
                                            {10536}let m2_8254: bitstring = (Cli_5510,gNs_8253) in
                                            {10537}event beginSrv(Sess_5512,Cli_5510,gNs_8253);
                                            {10538}out(c, (m2_8254,sign(h(m2_8254),skSess_8060)))
                                    )
                                    else
                                        {10539}let v_8255: bool = (Disco_5511 = B) in
                                        (
                                            {10540}if v_8255 then
                                            (
                                                {10541}let pkDisco_8256: bitstring = pub(skB) in
                                                {10542}in(c, (=pkCli_8245,m1_8257: bitstring,sigM1_8258: bitstring));
                                                {10543}if (verify(h(m1_8257),sigM1_8258,pkCli_8245) <> true) then
                                                    0
                                                else
                                                    {10544}let (=Sess_5512,SPc_8259: bitstring,PartC_8260: bitstring) = m1_8257 in
                                                    {10545}event endSrv(Cli_5510,Sess_5512,PartC_8260);
                                                    {10546}new Ns_8261: bitstring;
                                                    {10547}let gNs_8262: bitstring = exp(g,Ns_8261) in
                                                    {10548}let m2_8263: bitstring = (Cli_5510,gNs_8262) in
                                                    {10549}event beginSrv(Sess_5512,Cli_5510,gNs_8262);
                                                    {10550}out(c, (m2_8263,sign(h(m2_8263),skSess_8060)))
                                            )
                                            else
                                                {10551}let v_8264: bool = (Disco_5511 = C) in
                                                (
                                                    {10552}if v_8264 then
                                                    (
                                                        {10553}let pkDisco_8265: bitstring = pub(skC) in
                                                        {10554}in(c, (=pkCli_8245,m1_8266: bitstring,sigM1_8267: bitstring));
                                                        {10555}if (verify(h(m1_8266),sigM1_8267,pkCli_8245) <> true) then
                                                            0
                                                        else
                                                            {10556}let (=Sess_5512,SPc_8268: bitstring,PartC_8269: bitstring) = m1_8266 in
                                                            {10557}event endSrv(Cli_5510,Sess_5512,PartC_8269);
                                                            {10558}new Ns_8270: bitstring;
                                                            {10559}let gNs_8271: bitstring = exp(g,Ns_8270) in
                                                            {10560}let m2_8272: bitstring = (Cli_5510,gNs_8271) in
                                                            {10561}event beginSrv(Sess_5512,Cli_5510,gNs_8271);
                                                            {10562}out(c, (m2_8272,sign(h(m2_8272),skSess_8060)))
                                                    )
                                                    else
                                                        {10563}let pkDisco_8273: bitstring = pub(skI) in
                                                        {10564}in(c, (=pkCli_8245,m1_8274: bitstring,sigM1_8275: bitstring));
                                                        {10565}if (verify(h(m1_8274),sigM1_8275,pkCli_8245) <> true) then
                                                            0
                                                        else
                                                            {10566}let (=Sess_5512,SPc_8276: bitstring,PartC_8277: bitstring) = m1_8274 in
                                                            {10567}event endSrv(Cli_5510,Sess_5512,PartC_8277);
                                                            {10568}new Ns_8278: bitstring;
                                                            {10569}let gNs_8279: bitstring = exp(g,Ns_8278) in
                                                            {10570}let m2_8280: bitstring = (Cli_5510,gNs_8279) in
                                                            {10571}event beginSrv(Sess_5512,Cli_5510,gNs_8279);
                                                            {10572}out(c, (m2_8280,sign(h(m2_8280),skSess_8060)))
                                                )
                                                else
                                                    {10573}let pkDisco_8281: bitstring = fail-any in
                                                    {10574}in(c, (=pkCli_8245,m1_8282: bitstring,sigM1_8283: bitstring));
                                                    {10575}if (verify(h(m1_8282),sigM1_8283,pkCli_8245) <> true) then
                                                        0
                                                    else
                                                        {10576}let (=Sess_5512,SPc_8284: bitstring,PartC_8285: bitstring) = m1_8282 in
                                                        {10577}event endSrv(Cli_5510,Sess_5512,PartC_8285);
                                                        {10578}new Ns_8286: bitstring;
                                                        {10579}let gNs_8287: bitstring = exp(g,Ns_8286) in
                                                        {10580}let m2_8288: bitstring = (Cli_5510,gNs_8287) in
                                                        {10581}event beginSrv(Sess_5512,Cli_5510,gNs_8287);
                                                        {10582}out(c, (m2_8288,sign(h(m2_8288),skSess_8060)))
                                        )
                                        else
                                            {10583}let pkDisco_8289: bitstring = fail-any in
                                            {10584}in(c, (=pkCli_8245,m1_8290: bitstring,sigM1_8291: bitstring));
                                            {10585}if (verify(h(m1_8290),sigM1_8291,pkCli_8245) <> true) then
                                                0
                                            else
                                                {10586}let (=Sess_5512,SPc_8292: bitstring,PartC_8293: bitstring) = m1_8290 in
                                                {10587}event endSrv(Cli_5510,Sess_5512,PartC_8293);
                                                {10588}new Ns_8294: bitstring;
                                                {10589}let gNs_8295: bitstring = exp(g,Ns_8294) in
                                                {10590}let m2_8296: bitstring = (Cli_5510,gNs_8295) in
                                                {10591}event beginSrv(Sess_5512,Cli_5510,gNs_8295);
                                                {10592}out(c, (m2_8296,sign(h(m2_8296),skSess_8060)))
                                )
                                else
                                    {10593}let pkDisco_8297: bitstring = fail-any in
                                    {10594}in(c, (=pkCli_8245,m1_8298: bitstring,sigM1_8299: bitstring));
                                    {10595}if (verify(h(m1_8298),sigM1_8299,pkCli_8245) <> true) then
                                        0
                                    else
                                        {10596}let (=Sess_5512,SPc_8300: bitstring,PartC_8301: bitstring) = m1_8298 in
                                        {10597}event endSrv(Cli_5510,Sess_5512,PartC_8301);
                                        {10598}new Ns_8302: bitstring;
                                        {10599}let gNs_8303: bitstring = exp(g,Ns_8302) in
                                        {10600}let m2_8304: bitstring = (Cli_5510,gNs_8303) in
                                        {10601}event beginSrv(Sess_5512,Cli_5510,gNs_8303);
                                        {10602}out(c, (m2_8304,sign(h(m2_8304),skSess_8060)))
                        )
                        else
                            {10603}let pkCli_8305: bitstring = fail-any in
                            {10604}let v_8306: bool = (Disco_5511 = A) in
                            (
                                {10605}if v_8306 then
                                (
                                    {10606}let pkDisco_8307: bitstring = pub(skA) in
                                    {10607}in(c, (=pkCli_8305,m1_8308: bitstring,sigM1_8309: bitstring));
                                    {10608}if (verify(h(m1_8308),sigM1_8309,pkCli_8305) <> true) then
                                        0
                                    else
                                        {10609}let (=Sess_5512,SPc_8310: bitstring,PartC_8311: bitstring) = m1_8308 in
                                        {10610}event endSrv(Cli_5510,Sess_5512,PartC_8311);
                                        {10611}new Ns_8312: bitstring;
                                        {10612}let gNs_8313: bitstring = exp(g,Ns_8312) in
                                        {10613}let m2_8314: bitstring = (Cli_5510,gNs_8313) in
                                        {10614}event beginSrv(Sess_5512,Cli_5510,gNs_8313);
                                        {10615}out(c, (m2_8314,sign(h(m2_8314),skSess_8060)))
                                )
                                else
                                    {10616}let v_8315: bool = (Disco_5511 = B) in
                                    (
                                        {10617}if v_8315 then
                                        (
                                            {10618}let pkDisco_8316: bitstring = pub(skB) in
                                            {10619}in(c, (=pkCli_8305,m1_8317: bitstring,sigM1_8318: bitstring));
                                            {10620}if (verify(h(m1_8317),sigM1_8318,pkCli_8305) <> true) then
                                                0
                                            else
                                                {10621}let (=Sess_5512,SPc_8319: bitstring,PartC_8320: bitstring) = m1_8317 in
                                                {10622}event endSrv(Cli_5510,Sess_5512,PartC_8320);
                                                {10623}new Ns_8321: bitstring;
                                                {10624}let gNs_8322: bitstring = exp(g,Ns_8321) in
                                                {10625}let m2_8323: bitstring = (Cli_5510,gNs_8322) in
                                                {10626}event beginSrv(Sess_5512,Cli_5510,gNs_8322);
                                                {10627}out(c, (m2_8323,sign(h(m2_8323),skSess_8060)))
                                        )
                                        else
                                            {10628}let v_8324: bool = (Disco_5511 = C) in
                                            (
                                                {10629}if v_8324 then
                                                (
                                                    {10630}let pkDisco_8325: bitstring = pub(skC) in
                                                    {10631}in(c, (=pkCli_8305,m1_8326: bitstring,sigM1_8327: bitstring));
                                                    {10632}if (verify(h(m1_8326),sigM1_8327,pkCli_8305) <> true) then
                                                        0
                                                    else
                                                        {10633}let (=Sess_5512,SPc_8328: bitstring,PartC_8329: bitstring) = m1_8326 in
                                                        {10634}event endSrv(Cli_5510,Sess_5512,PartC_8329);
                                                        {10635}new Ns_8330: bitstring;
                                                        {10636}let gNs_8331: bitstring = exp(g,Ns_8330) in
                                                        {10637}let m2_8332: bitstring = (Cli_5510,gNs_8331) in
                                                        {10638}event beginSrv(Sess_5512,Cli_5510,gNs_8331);
                                                        {10639}out(c, (m2_8332,sign(h(m2_8332),skSess_8060)))
                                                )
                                                else
                                                    {10640}let pkDisco_8333: bitstring = pub(skI) in
                                                    {10641}in(c, (=pkCli_8305,m1_8334: bitstring,sigM1_8335: bitstring));
                                                    {10642}if (verify(h(m1_8334),sigM1_8335,pkCli_8305) <> true) then
                                                        0
                                                    else
                                                        {10643}let (=Sess_5512,SPc_8336: bitstring,PartC_8337: bitstring) = m1_8334 in
                                                        {10644}event endSrv(Cli_5510,Sess_5512,PartC_8337);
                                                        {10645}new Ns_8338: bitstring;
                                                        {10646}let gNs_8339: bitstring = exp(g,Ns_8338) in
                                                        {10647}let m2_8340: bitstring = (Cli_5510,gNs_8339) in
                                                        {10648}event beginSrv(Sess_5512,Cli_5510,gNs_8339);
                                                        {10649}out(c, (m2_8340,sign(h(m2_8340),skSess_8060)))
                                            )
                                            else
                                                {10650}let pkDisco_8341: bitstring = fail-any in
                                                {10651}in(c, (=pkCli_8305,m1_8342: bitstring,sigM1_8343: bitstring));
                                                {10652}if (verify(h(m1_8342),sigM1_8343,pkCli_8305) <> true) then
                                                    0
                                                else
                                                    {10653}let (=Sess_5512,SPc_8344: bitstring,PartC_8345: bitstring) = m1_8342 in
                                                    {10654}event endSrv(Cli_5510,Sess_5512,PartC_8345);
                                                    {10655}new Ns_8346: bitstring;
                                                    {10656}let gNs_8347: bitstring = exp(g,Ns_8346) in
                                                    {10657}let m2_8348: bitstring = (Cli_5510,gNs_8347) in
                                                    {10658}event beginSrv(Sess_5512,Cli_5510,gNs_8347);
                                                    {10659}out(c, (m2_8348,sign(h(m2_8348),skSess_8060)))
                                    )
                                    else
                                        {10660}let pkDisco_8349: bitstring = fail-any in
                                        {10661}in(c, (=pkCli_8305,m1_8350: bitstring,sigM1_8351: bitstring));
                                        {10662}if (verify(h(m1_8350),sigM1_8351,pkCli_8305) <> true) then
                                            0
                                        else
                                            {10663}let (=Sess_5512,SPc_8352: bitstring,PartC_8353: bitstring) = m1_8350 in
                                            {10664}event endSrv(Cli_5510,Sess_5512,PartC_8353);
                                            {10665}new Ns_8354: bitstring;
                                            {10666}let gNs_8355: bitstring = exp(g,Ns_8354) in
                                            {10667}let m2_8356: bitstring = (Cli_5510,gNs_8355) in
                                            {10668}event beginSrv(Sess_5512,Cli_5510,gNs_8355);
                                            {10669}out(c, (m2_8356,sign(h(m2_8356),skSess_8060)))
                            )
                            else
                                {10670}let pkDisco_8357: bitstring = fail-any in
                                {10671}in(c, (=pkCli_8305,m1_8358: bitstring,sigM1_8359: bitstring));
                                {10672}if (verify(h(m1_8358),sigM1_8359,pkCli_8305) <> true) then
                                    0
                                else
                                    {10673}let (=Sess_5512,SPc_8360: bitstring,PartC_8361: bitstring) = m1_8358 in
                                    {10674}event endSrv(Cli_5510,Sess_5512,PartC_8361);
                                    {10675}new Ns_8362: bitstring;
                                    {10676}let gNs_8363: bitstring = exp(g,Ns_8362) in
                                    {10677}let m2_8364: bitstring = (Cli_5510,gNs_8363) in
                                    {10678}event beginSrv(Sess_5512,Cli_5510,gNs_8363);
                                    {10679}out(c, (m2_8364,sign(h(m2_8364),skSess_8060)))
                )
                else
                    {10680}let pkCli_8365: bitstring = fail-any in
                    {10681}let v_8366: bool = (Disco_5511 = A) in
                    (
                        {10682}if v_8366 then
                        (
                            {10683}let pkDisco_8367: bitstring = pub(skA) in
                            {10684}in(c, (=pkCli_8365,m1_8368: bitstring,sigM1_8369: bitstring));
                            {10685}if (verify(h(m1_8368),sigM1_8369,pkCli_8365) <> true) then
                                0
                            else
                                {10686}let (=Sess_5512,SPc_8370: bitstring,PartC_8371: bitstring) = m1_8368 in
                                {10687}event endSrv(Cli_5510,Sess_5512,PartC_8371);
                                {10688}new Ns_8372: bitstring;
                                {10689}let gNs_8373: bitstring = exp(g,Ns_8372) in
                                {10690}let m2_8374: bitstring = (Cli_5510,gNs_8373) in
                                {10691}event beginSrv(Sess_5512,Cli_5510,gNs_8373);
                                {10692}out(c, (m2_8374,sign(h(m2_8374),skSess_8060)))
                        )
                        else
                            {10693}let v_8375: bool = (Disco_5511 = B) in
                            (
                                {10694}if v_8375 then
                                (
                                    {10695}let pkDisco_8376: bitstring = pub(skB) in
                                    {10696}in(c, (=pkCli_8365,m1_8377: bitstring,sigM1_8378: bitstring));
                                    {10697}if (verify(h(m1_8377),sigM1_8378,pkCli_8365) <> true) then
                                        0
                                    else
                                        {10698}let (=Sess_5512,SPc_8379: bitstring,PartC_8380: bitstring) = m1_8377 in
                                        {10699}event endSrv(Cli_5510,Sess_5512,PartC_8380);
                                        {10700}new Ns_8381: bitstring;
                                        {10701}let gNs_8382: bitstring = exp(g,Ns_8381) in
                                        {10702}let m2_8383: bitstring = (Cli_5510,gNs_8382) in
                                        {10703}event beginSrv(Sess_5512,Cli_5510,gNs_8382);
                                        {10704}out(c, (m2_8383,sign(h(m2_8383),skSess_8060)))
                                )
                                else
                                    {10705}let v_8384: bool = (Disco_5511 = C) in
                                    (
                                        {10706}if v_8384 then
                                        (
                                            {10707}let pkDisco_8385: bitstring = pub(skC) in
                                            {10708}in(c, (=pkCli_8365,m1_8386: bitstring,sigM1_8387: bitstring));
                                            {10709}if (verify(h(m1_8386),sigM1_8387,pkCli_8365) <> true) then
                                                0
                                            else
                                                {10710}let (=Sess_5512,SPc_8388: bitstring,PartC_8389: bitstring) = m1_8386 in
                                                {10711}event endSrv(Cli_5510,Sess_5512,PartC_8389);
                                                {10712}new Ns_8390: bitstring;
                                                {10713}let gNs_8391: bitstring = exp(g,Ns_8390) in
                                                {10714}let m2_8392: bitstring = (Cli_5510,gNs_8391) in
                                                {10715}event beginSrv(Sess_5512,Cli_5510,gNs_8391);
                                                {10716}out(c, (m2_8392,sign(h(m2_8392),skSess_8060)))
                                        )
                                        else
                                            {10717}let pkDisco_8393: bitstring = pub(skI) in
                                            {10718}in(c, (=pkCli_8365,m1_8394: bitstring,sigM1_8395: bitstring));
                                            {10719}if (verify(h(m1_8394),sigM1_8395,pkCli_8365) <> true) then
                                                0
                                            else
                                                {10720}let (=Sess_5512,SPc_8396: bitstring,PartC_8397: bitstring) = m1_8394 in
                                                {10721}event endSrv(Cli_5510,Sess_5512,PartC_8397);
                                                {10722}new Ns_8398: bitstring;
                                                {10723}let gNs_8399: bitstring = exp(g,Ns_8398) in
                                                {10724}let m2_8400: bitstring = (Cli_5510,gNs_8399) in
                                                {10725}event beginSrv(Sess_5512,Cli_5510,gNs_8399);
                                                {10726}out(c, (m2_8400,sign(h(m2_8400),skSess_8060)))
                                    )
                                    else
                                        {10727}let pkDisco_8401: bitstring = fail-any in
                                        {10728}in(c, (=pkCli_8365,m1_8402: bitstring,sigM1_8403: bitstring));
                                        {10729}if (verify(h(m1_8402),sigM1_8403,pkCli_8365) <> true) then
                                            0
                                        else
                                            {10730}let (=Sess_5512,SPc_8404: bitstring,PartC_8405: bitstring) = m1_8402 in
                                            {10731}event endSrv(Cli_5510,Sess_5512,PartC_8405);
                                            {10732}new Ns_8406: bitstring;
                                            {10733}let gNs_8407: bitstring = exp(g,Ns_8406) in
                                            {10734}let m2_8408: bitstring = (Cli_5510,gNs_8407) in
                                            {10735}event beginSrv(Sess_5512,Cli_5510,gNs_8407);
                                            {10736}out(c, (m2_8408,sign(h(m2_8408),skSess_8060)))
                            )
                            else
                                {10737}let pkDisco_8409: bitstring = fail-any in
                                {10738}in(c, (=pkCli_8365,m1_8410: bitstring,sigM1_8411: bitstring));
                                {10739}if (verify(h(m1_8410),sigM1_8411,pkCli_8365) <> true) then
                                    0
                                else
                                    {10740}let (=Sess_5512,SPc_8412: bitstring,PartC_8413: bitstring) = m1_8410 in
                                    {10741}event endSrv(Cli_5510,Sess_5512,PartC_8413);
                                    {10742}new Ns_8414: bitstring;
                                    {10743}let gNs_8415: bitstring = exp(g,Ns_8414) in
                                    {10744}let m2_8416: bitstring = (Cli_5510,gNs_8415) in
                                    {10745}event beginSrv(Sess_5512,Cli_5510,gNs_8415);
                                    {10746}out(c, (m2_8416,sign(h(m2_8416),skSess_8060)))
                    )
                    else
                        {10747}let pkDisco_8417: bitstring = fail-any in
                        {10748}in(c, (=pkCli_8365,m1_8418: bitstring,sigM1_8419: bitstring));
                        {10749}if (verify(h(m1_8418),sigM1_8419,pkCli_8365) <> true) then
                            0
                        else
                            {10750}let (=Sess_5512,SPc_8420: bitstring,PartC_8421: bitstring) = m1_8418 in
                            {10751}event endSrv(Cli_5510,Sess_5512,PartC_8421);
                            {10752}new Ns_8422: bitstring;
                            {10753}let gNs_8423: bitstring = exp(g,Ns_8422) in
                            {10754}let m2_8424: bitstring = (Cli_5510,gNs_8423) in
                            {10755}event beginSrv(Sess_5512,Cli_5510,gNs_8423);
                            {10756}out(c, (m2_8424,sign(h(m2_8424),skSess_8060)))
        )
        else
            {10757}let pkCli_8425: bitstring = fail-any in
            {10758}let v_8426: bool = (Disco_5511 = A) in
            (
                {10759}if v_8426 then
                (
                    {10760}let pkDisco_8427: bitstring = pub(skA) in
                    {10761}in(c, (=pkCli_8425,m1_8428: bitstring,sigM1_8429: bitstring));
                    {10762}if (verify(h(m1_8428),sigM1_8429,pkCli_8425) <> true) then
                        0
                    else
                        {10763}let (=Sess_5512,SPc_8430: bitstring,PartC_8431: bitstring) = m1_8428 in
                        {10764}event endSrv(Cli_5510,Sess_5512,PartC_8431);
                        {10765}new Ns_8432: bitstring;
                        {10766}let gNs_8433: bitstring = exp(g,Ns_8432) in
                        {10767}let m2_8434: bitstring = (Cli_5510,gNs_8433) in
                        {10768}event beginSrv(Sess_5512,Cli_5510,gNs_8433);
                        {10769}out(c, (m2_8434,sign(h(m2_8434),skSess_8060)))
                )
                else
                    {10770}let v_8435: bool = (Disco_5511 = B) in
                    (
                        {10771}if v_8435 then
                        (
                            {10772}let pkDisco_8436: bitstring = pub(skB) in
                            {10773}in(c, (=pkCli_8425,m1_8437: bitstring,sigM1_8438: bitstring));
                            {10774}if (verify(h(m1_8437),sigM1_8438,pkCli_8425) <> true) then
                                0
                            else
                                {10775}let (=Sess_5512,SPc_8439: bitstring,PartC_8440: bitstring) = m1_8437 in
                                {10776}event endSrv(Cli_5510,Sess_5512,PartC_8440);
                                {10777}new Ns_8441: bitstring;
                                {10778}let gNs_8442: bitstring = exp(g,Ns_8441) in
                                {10779}let m2_8443: bitstring = (Cli_5510,gNs_8442) in
                                {10780}event beginSrv(Sess_5512,Cli_5510,gNs_8442);
                                {10781}out(c, (m2_8443,sign(h(m2_8443),skSess_8060)))
                        )
                        else
                            {10782}let v_8444: bool = (Disco_5511 = C) in
                            (
                                {10783}if v_8444 then
                                (
                                    {10784}let pkDisco_8445: bitstring = pub(skC) in
                                    {10785}in(c, (=pkCli_8425,m1_8446: bitstring,sigM1_8447: bitstring));
                                    {10786}if (verify(h(m1_8446),sigM1_8447,pkCli_8425) <> true) then
                                        0
                                    else
                                        {10787}let (=Sess_5512,SPc_8448: bitstring,PartC_8449: bitstring) = m1_8446 in
                                        {10788}event endSrv(Cli_5510,Sess_5512,PartC_8449);
                                        {10789}new Ns_8450: bitstring;
                                        {10790}let gNs_8451: bitstring = exp(g,Ns_8450) in
                                        {10791}let m2_8452: bitstring = (Cli_5510,gNs_8451) in
                                        {10792}event beginSrv(Sess_5512,Cli_5510,gNs_8451);
                                        {10793}out(c, (m2_8452,sign(h(m2_8452),skSess_8060)))
                                )
                                else
                                    {10794}let pkDisco_8453: bitstring = pub(skI) in
                                    {10795}in(c, (=pkCli_8425,m1_8454: bitstring,sigM1_8455: bitstring));
                                    {10796}if (verify(h(m1_8454),sigM1_8455,pkCli_8425) <> true) then
                                        0
                                    else
                                        {10797}let (=Sess_5512,SPc_8456: bitstring,PartC_8457: bitstring) = m1_8454 in
                                        {10798}event endSrv(Cli_5510,Sess_5512,PartC_8457);
                                        {10799}new Ns_8458: bitstring;
                                        {10800}let gNs_8459: bitstring = exp(g,Ns_8458) in
                                        {10801}let m2_8460: bitstring = (Cli_5510,gNs_8459) in
                                        {10802}event beginSrv(Sess_5512,Cli_5510,gNs_8459);
                                        {10803}out(c, (m2_8460,sign(h(m2_8460),skSess_8060)))
                            )
                            else
                                {10804}let pkDisco_8461: bitstring = fail-any in
                                {10805}in(c, (=pkCli_8425,m1_8462: bitstring,sigM1_8463: bitstring));
                                {10806}if (verify(h(m1_8462),sigM1_8463,pkCli_8425) <> true) then
                                    0
                                else
                                    {10807}let (=Sess_5512,SPc_8464: bitstring,PartC_8465: bitstring) = m1_8462 in
                                    {10808}event endSrv(Cli_5510,Sess_5512,PartC_8465);
                                    {10809}new Ns_8466: bitstring;
                                    {10810}let gNs_8467: bitstring = exp(g,Ns_8466) in
                                    {10811}let m2_8468: bitstring = (Cli_5510,gNs_8467) in
                                    {10812}event beginSrv(Sess_5512,Cli_5510,gNs_8467);
                                    {10813}out(c, (m2_8468,sign(h(m2_8468),skSess_8060)))
                    )
                    else
                        {10814}let pkDisco_8469: bitstring = fail-any in
                        {10815}in(c, (=pkCli_8425,m1_8470: bitstring,sigM1_8471: bitstring));
                        {10816}if (verify(h(m1_8470),sigM1_8471,pkCli_8425) <> true) then
                            0
                        else
                            {10817}let (=Sess_5512,SPc_8472: bitstring,PartC_8473: bitstring) = m1_8470 in
                            {10818}event endSrv(Cli_5510,Sess_5512,PartC_8473);
                            {10819}new Ns_8474: bitstring;
                            {10820}let gNs_8475: bitstring = exp(g,Ns_8474) in
                            {10821}let m2_8476: bitstring = (Cli_5510,gNs_8475) in
                            {10822}event beginSrv(Sess_5512,Cli_5510,gNs_8475);
                            {10823}out(c, (m2_8476,sign(h(m2_8476),skSess_8060)))
            )
            else
                {10824}let pkDisco_8477: bitstring = fail-any in
                {10825}in(c, (=pkCli_8425,m1_8478: bitstring,sigM1_8479: bitstring));
                {10826}if (verify(h(m1_8478),sigM1_8479,pkCli_8425) <> true) then
                    0
                else
                    {10827}let (=Sess_5512,SPc_8480: bitstring,PartC_8481: bitstring) = m1_8478 in
                    {10828}event endSrv(Cli_5510,Sess_5512,PartC_8481);
                    {10829}new Ns_8482: bitstring;
                    {10830}let gNs_8483: bitstring = exp(g,Ns_8482) in
                    {10831}let m2_8484: bitstring = (Cli_5510,gNs_8483) in
                    {10832}event beginSrv(Sess_5512,Cli_5510,gNs_8483);
                    {10833}out(c, (m2_8484,sign(h(m2_8484),skSess_8060)))
)

-- Query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
Completing...
200 rules inserted. The rule base contains 90 rules. 405 rules in the queue.
400 rules inserted. The rule base contains 172 rules. 402 rules in the queue.
600 rules inserted. The rule base contains 234 rules. 402 rules in the queue.
800 rules inserted. The rule base contains 236 rules. 399 rules in the queue.
1000 rules inserted. The rule base contains 210 rules. 395 rules in the queue.
1200 rules inserted. The rule base contains 249 rules. 356 rules in the queue.
1400 rules inserted. The rule base contains 283 rules. 452 rules in the queue.
1600 rules inserted. The rule base contains 414 rules. 239 rules in the queue.
1800 rules inserted. The rule base contains 569 rules. 444 rules in the queue.
2000 rules inserted. The rule base contains 734 rules. 445 rules in the queue.
2200 rules inserted. The rule base contains 926 rules. 441 rules in the queue.
2400 rules inserted. The rule base contains 1060 rules. 351 rules in the queue.
2600 rules inserted. The rule base contains 1218 rules. 250 rules in the queue.
2800 rules inserted. The rule base contains 1277 rules. 171 rules in the queue.
3000 rules inserted. The rule base contains 1306 rules. 118 rules in the queue.
3200 rules inserted. The rule base contains 1320 rules. 102 rules in the queue.
3400 rules inserted. The rule base contains 1435 rules. 23 rules in the queue.
Starting query event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N))
goal reachable: X_80146 <> C[] && X_80146 <> B[] && X_80146 <> A[] && begin(beginSrv(C[],X_80146,exp(g,Ns_6561[sigM1_6558 = sign(h((C[],SPc_80147,PartC_80148)),skI[]),m1_6557 = (C[],SPc_80147,PartC_80148),Sess_5512 = C[],Disco_5511 = B[],Cli_5510 = X_80146,!1 = @sid_80149]))) && attacker(SPc_80147) && attacker(PartC_80148) && attacker(X_80146) -> end(endCli(C[],X_80146,exp(g,Ns_6561[sigM1_6558 = sign(h((C[],SPc_80147,PartC_80148)),skI[]),m1_6557 = (C[],SPc_80147,PartC_80148),Sess_5512 = C[],Disco_5511 = B[],Cli_5510 = X_80146,!1 = @sid_80149])))
goal reachable: X_80150 <> C[] && X_80150 <> B[] && X_80150 <> A[] && begin(beginSrv(C[],X_80150,exp(g,Ns_6552[sigM1_6549 = sign(h((C[],SPc_80151,PartC_80152)),skI[]),m1_6548 = (C[],SPc_80151,PartC_80152),Sess_5512 = C[],Disco_5511 = A[],Cli_5510 = X_80150,!1 = @sid_80153]))) && attacker(SPc_80151) && attacker(PartC_80152) && attacker(X_80150) -> end(endCli(C[],X_80150,exp(g,Ns_6552[sigM1_6549 = sign(h((C[],SPc_80151,PartC_80152)),skI[]),m1_6548 = (C[],SPc_80151,PartC_80152),Sess_5512 = C[],Disco_5511 = A[],Cli_5510 = X_80150,!1 = @sid_80153])))
goal reachable: Disco_80157 <> C[] && Disco_80157 <> B[] && Disco_80157 <> A[] && X_80154 <> C[] && X_80154 <> B[] && X_80154 <> A[] && begin(beginSrv(C[],X_80154,exp(g,Ns_6578[sigM1_6575 = sign(h((C[],SPc_80155,PartC_80156)),skI[]),m1_6574 = (C[],SPc_80155,PartC_80156),Sess_5512 = C[],Disco_5511 = Disco_80157,Cli_5510 = X_80154,!1 = @sid_80158]))) && attacker(SPc_80155) && attacker(PartC_80156) && attacker(Disco_80157) && attacker(X_80154) -> end(endCli(C[],X_80154,exp(g,Ns_6578[sigM1_6575 = sign(h((C[],SPc_80155,PartC_80156)),skI[]),m1_6574 = (C[],SPc_80155,PartC_80156),Sess_5512 = C[],Disco_5511 = Disco_80157,Cli_5510 = X_80154,!1 = @sid_80158])))
goal reachable: X_80159 <> C[] && X_80159 <> B[] && X_80159 <> A[] && begin(beginSrv(C[],X_80159,exp(g,Ns_6570[sigM1_6567 = sign(h((C[],SPc_80160,PartC_80161)),skI[]),m1_6566 = (C[],SPc_80160,PartC_80161),Sess_5512 = C[],Disco_5511 = C[],Cli_5510 = X_80159,!1 = @sid_80162]))) && attacker(SPc_80160) && attacker(PartC_80161) && attacker(X_80159) -> end(endCli(C[],X_80159,exp(g,Ns_6570[sigM1_6567 = sign(h((C[],SPc_80160,PartC_80161)),skI[]),m1_6566 = (C[],SPc_80160,PartC_80161),Sess_5512 = C[],Disco_5511 = C[],Cli_5510 = X_80159,!1 = @sid_80162])))
RESULT event(endCli(C[],X,N)) ==> event(beginSrv(C[],X,N)) is true.
-- Query event(endSrv(A[],X_80170,N_80171)) ==> event(beginCli(A[],X_80170,N_80171))
Completing...
200 rules inserted. The rule base contains 74 rules. 414 rules in the queue.
400 rules inserted. The rule base contains 163 rules. 402 rules in the queue.
600 rules inserted. The rule base contains 218 rules. 402 rules in the queue.
800 rules inserted. The rule base contains 220 rules. 399 rules in the queue.
1000 rules inserted. The rule base contains 192 rules. 394 rules in the queue.
1200 rules inserted. The rule base contains 230 rules. 356 rules in the queue.
1400 rules inserted. The rule base contains 268 rules. 461 rules in the queue.
1600 rules inserted. The rule base contains 406 rules. 242 rules in the queue.
1800 rules inserted. The rule base contains 562 rules. 470 rules in the queue.
2000 rules inserted. The rule base contains 725 rules. 460 rules in the queue.
2200 rules inserted. The rule base contains 921 rules. 481 rules in the queue.
2400 rules inserted. The rule base contains 1079 rules. 385 rules in the queue.
2600 rules inserted. The rule base contains 1219 rules. 293 rules in the queue.
2800 rules inserted. The rule base contains 1330 rules. 195 rules in the queue.
3000 rules inserted. The rule base contains 1363 rules. 130 rules in the queue.
3200 rules inserted. The rule base contains 1358 rules. 108 rules in the queue.
3400 rules inserted. The rule base contains 1445 rules. 54 rules in the queue.
Starting query event(endSrv(A[],X_80170,N_80171)) ==> event(beginCli(A[],X_80170,N_80171))
goal reachable: X_153561 <> C[] && X_153561 <> B[] && X_153561 <> A[] && begin(beginCli(A[],X_153561,exp(g,Nc_773[UP_771 = UP_153562,SPs_770 = SPs_153563,Sess = X_153561,Disco = C[],Cli = A[],!1 = @sid_153564]))) && attacker(SPs_153563) && attacker(UP_153562) && attacker(X_153561) -> end(endSrv(A[],X_153561,exp(g,Nc_773[UP_771 = UP_153562,SPs_770 = SPs_153563,Sess = X_153561,Disco = C[],Cli = A[],!1 = @sid_153564])))
goal reachable: X_153565 <> C[] && X_153565 <> B[] && X_153565 <> A[] && begin(beginCli(A[],X_153565,exp(g,Nc_698[UP_696 = UP_153566,SPs_695 = SPs_153567,Sess = X_153565,Disco = B[],Cli = A[],!1 = @sid_153568]))) && attacker(SPs_153567) && attacker(UP_153566) && attacker(X_153565) -> end(endSrv(A[],X_153565,exp(g,Nc_698[UP_696 = UP_153566,SPs_695 = SPs_153567,Sess = X_153565,Disco = B[],Cli = A[],!1 = @sid_153568])))
goal reachable: Disco_153572 <> C[] && Disco_153572 <> B[] && Disco_153572 <> A[] && X_153569 <> C[] && X_153569 <> B[] && X_153569 <> A[] && begin(beginCli(A[],X_153569,exp(g,Nc_847[UP_845 = UP_153570,SPs_844 = SPs_153571,Sess = X_153569,Disco = Disco_153572,Cli = A[],!1 = @sid_153573]))) && attacker(SPs_153571) && attacker(UP_153570) && attacker(Disco_153572) && attacker(X_153569) -> end(endSrv(A[],X_153569,exp(g,Nc_847[UP_845 = UP_153570,SPs_844 = SPs_153571,Sess = X_153569,Disco = Disco_153572,Cli = A[],!1 = @sid_153573])))
goal reachable: X_153574 <> C[] && X_153574 <> B[] && X_153574 <> A[] && begin(beginCli(A[],X_153574,exp(g,Nc_623[UP_621 = UP_153575,SPs_620 = SPs_153576,Sess = X_153574,Disco = A[],Cli = A[],!1 = @sid_153577]))) && attacker(SPs_153576) && attacker(UP_153575) && attacker(X_153574) -> end(endSrv(A[],X_153574,exp(g,Nc_623[UP_621 = UP_153575,SPs_620 = SPs_153576,Sess = X_153574,Disco = A[],Cli = A[],!1 = @sid_153577])))
RESULT event(endSrv(A[],X_80170,N_80171)) ==> event(beginCli(A[],X_80170,N_80171)) is true.
