Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_516: bool = (Cli = A) in
    (
        {10}if v_516 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_517: bool = (Disco = A) in
            (
                {14}if v_517 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_518: bool = (Sess = A) in
                    (
                        {17}if v_518 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let gNc: bitstring = exp(g,Nc) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc) in
                            {24}event beginCli(Cli,Sess,gNc);
                            {25}out(c, (pkCli,m1));
                            {26}in(c, em2: bitstring);
                            {27}let m2: bitstring = em2 in
                            {28}let (=OpenSecureChannelResponse,=Cli,PartS: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {29}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {30}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {31}let v_519: bool = (Sess = B) in
                            (
                                {32}if v_519 then
                                (
                                    {33}let pkSess_520: bitstring = pub(skB) in
                                    {34}out(c, GetEndpointRequest);
                                    {35}in(c, (=GetEndpointResponse,=pkSess_520,=None,SP_521: bitstring,UP_522: bitstring));
                                    {36}new Nc_523: bitstring;
                                    {37}let gNc_524: bitstring = exp(g,Nc_523) in
                                    {38}let m1_525: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_524) in
                                    {39}event beginCli(Cli,Sess,gNc_524);
                                    {40}out(c, (pkCli,m1_525));
                                    {41}in(c, em2_526: bitstring);
                                    {42}let m2_527: bitstring = em2_526 in
                                    {43}let (=OpenSecureChannelResponse,=Cli,PartS_528: bitstring,ST_529: bitstring,TTL_530: bitstring) = m2_527 in
                                    {44}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {45}event endCli(Sess,Cli,PartS_528)
                                )
                                else
                                    {46}let v_531: bool = (Sess = C) in
                                    (
                                        {47}if v_531 then
                                        (
                                            {48}let pkSess_532: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (=GetEndpointResponse,=pkSess_532,=None,SP_533: bitstring,UP_534: bitstring));
                                            {51}new Nc_535: bitstring;
                                            {52}let gNc_536: bitstring = exp(g,Nc_535) in
                                            {53}let m1_537: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_536) in
                                            {54}event beginCli(Cli,Sess,gNc_536);
                                            {55}out(c, (pkCli,m1_537));
                                            {56}in(c, em2_538: bitstring);
                                            {57}let m2_539: bitstring = em2_538 in
                                            {58}let (=OpenSecureChannelResponse,=Cli,PartS_540: bitstring,ST_541: bitstring,TTL_542: bitstring) = m2_539 in
                                            {59}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {60}event endCli(Sess,Cli,PartS_540)
                                        )
                                        else
                                            {61}let pkSess_543: bitstring = pub(sk(Sess)) in
                                            {62}out(c, GetEndpointRequest);
                                            {63}in(c, (=GetEndpointResponse,=pkSess_543,=None,SP_544: bitstring,UP_545: bitstring));
                                            {64}new Nc_546: bitstring;
                                            {65}let gNc_547: bitstring = exp(g,Nc_546) in
                                            {66}let m1_548: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_547) in
                                            {67}event beginCli(Cli,Sess,gNc_547);
                                            {68}out(c, (pkCli,m1_548));
                                            {69}in(c, em2_549: bitstring);
                                            {70}let m2_550: bitstring = em2_549 in
                                            {71}let (=OpenSecureChannelResponse,=Cli,PartS_551: bitstring,ST_552: bitstring,TTL_553: bitstring) = m2_550 in
                                            {72}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {73}event endCli(Sess,Cli,PartS_551)
                                    )
                                    else
                                        {74}let pkSess_554: bitstring = fail-any in
                                        {75}out(c, GetEndpointRequest);
                                        {76}in(c, (=GetEndpointResponse,=pkSess_554,=None,SP_555: bitstring,UP_556: bitstring));
                                        {77}new Nc_557: bitstring;
                                        {78}let gNc_558: bitstring = exp(g,Nc_557) in
                                        {79}let m1_559: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_558) in
                                        {80}event beginCli(Cli,Sess,gNc_558);
                                        {81}out(c, (pkCli,m1_559));
                                        {82}in(c, em2_560: bitstring);
                                        {83}let m2_561: bitstring = em2_560 in
                                        {84}let (=OpenSecureChannelResponse,=Cli,PartS_562: bitstring,ST_563: bitstring,TTL_564: bitstring) = m2_561 in
                                        {85}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {86}event endCli(Sess,Cli,PartS_562)
                            )
                            else
                                {87}let pkSess_565: bitstring = fail-any in
                                {88}out(c, GetEndpointRequest);
                                {89}in(c, (=GetEndpointResponse,=pkSess_565,=None,SP_566: bitstring,UP_567: bitstring));
                                {90}new Nc_568: bitstring;
                                {91}let gNc_569: bitstring = exp(g,Nc_568) in
                                {92}let m1_570: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_569) in
                                {93}event beginCli(Cli,Sess,gNc_569);
                                {94}out(c, (pkCli,m1_570));
                                {95}in(c, em2_571: bitstring);
                                {96}let m2_572: bitstring = em2_571 in
                                {97}let (=OpenSecureChannelResponse,=Cli,PartS_573: bitstring,ST_574: bitstring,TTL_575: bitstring) = m2_572 in
                                {98}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {99}event endCli(Sess,Cli,PartS_573)
                    )
                    else
                        {100}let pkSess_576: bitstring = fail-any in
                        {101}out(c, GetEndpointRequest);
                        {102}in(c, (=GetEndpointResponse,=pkSess_576,=None,SP_577: bitstring,UP_578: bitstring));
                        {103}new Nc_579: bitstring;
                        {104}let gNc_580: bitstring = exp(g,Nc_579) in
                        {105}let m1_581: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_580) in
                        {106}event beginCli(Cli,Sess,gNc_580);
                        {107}out(c, (pkCli,m1_581));
                        {108}in(c, em2_582: bitstring);
                        {109}let m2_583: bitstring = em2_582 in
                        {110}let (=OpenSecureChannelResponse,=Cli,PartS_584: bitstring,ST_585: bitstring,TTL_586: bitstring) = m2_583 in
                        {111}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {112}event endCli(Sess,Cli,PartS_584)
                )
                else
                    {113}let v_587: bool = (Disco = B) in
                    (
                        {114}if v_587 then
                        (
                            {115}let pkDisco_588: bitstring = pub(skB) in
                            {116}let v_589: bool = (Sess = A) in
                            (
                                {117}if v_589 then
                                (
                                    {118}let pkSess_590: bitstring = pub(skA) in
                                    {119}out(c, GetEndpointRequest);
                                    {120}in(c, (=GetEndpointResponse,=pkSess_590,=None,SP_591: bitstring,UP_592: bitstring));
                                    {121}new Nc_593: bitstring;
                                    {122}let gNc_594: bitstring = exp(g,Nc_593) in
                                    {123}let m1_595: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_594) in
                                    {124}event beginCli(Cli,Sess,gNc_594);
                                    {125}out(c, (pkCli,m1_595));
                                    {126}in(c, em2_596: bitstring);
                                    {127}let m2_597: bitstring = em2_596 in
                                    {128}let (=OpenSecureChannelResponse,=Cli,PartS_598: bitstring,ST_599: bitstring,TTL_600: bitstring) = m2_597 in
                                    {129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {130}event endCli(Sess,Cli,PartS_598)
                                )
                                else
                                    {131}let v_601: bool = (Sess = B) in
                                    (
                                        {132}if v_601 then
                                        (
                                            {133}let pkSess_602: bitstring = pub(skB) in
                                            {134}out(c, GetEndpointRequest);
                                            {135}in(c, (=GetEndpointResponse,=pkSess_602,=None,SP_603: bitstring,UP_604: bitstring));
                                            {136}new Nc_605: bitstring;
                                            {137}let gNc_606: bitstring = exp(g,Nc_605) in
                                            {138}let m1_607: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_606) in
                                            {139}event beginCli(Cli,Sess,gNc_606);
                                            {140}out(c, (pkCli,m1_607));
                                            {141}in(c, em2_608: bitstring);
                                            {142}let m2_609: bitstring = em2_608 in
                                            {143}let (=OpenSecureChannelResponse,=Cli,PartS_610: bitstring,ST_611: bitstring,TTL_612: bitstring) = m2_609 in
                                            {144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {145}event endCli(Sess,Cli,PartS_610)
                                        )
                                        else
                                            {146}let v_613: bool = (Sess = C) in
                                            (
                                                {147}if v_613 then
                                                (
                                                    {148}let pkSess_614: bitstring = pub(skC) in
                                                    {149}out(c, GetEndpointRequest);
                                                    {150}in(c, (=GetEndpointResponse,=pkSess_614,=None,SP_615: bitstring,UP_616: bitstring));
                                                    {151}new Nc_617: bitstring;
                                                    {152}let gNc_618: bitstring = exp(g,Nc_617) in
                                                    {153}let m1_619: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_618) in
                                                    {154}event beginCli(Cli,Sess,gNc_618);
                                                    {155}out(c, (pkCli,m1_619));
                                                    {156}in(c, em2_620: bitstring);
                                                    {157}let m2_621: bitstring = em2_620 in
                                                    {158}let (=OpenSecureChannelResponse,=Cli,PartS_622: bitstring,ST_623: bitstring,TTL_624: bitstring) = m2_621 in
                                                    {159}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {160}event endCli(Sess,Cli,PartS_622)
                                                )
                                                else
                                                    {161}let pkSess_625: bitstring = pub(sk(Sess)) in
                                                    {162}out(c, GetEndpointRequest);
                                                    {163}in(c, (=GetEndpointResponse,=pkSess_625,=None,SP_626: bitstring,UP_627: bitstring));
                                                    {164}new Nc_628: bitstring;
                                                    {165}let gNc_629: bitstring = exp(g,Nc_628) in
                                                    {166}let m1_630: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_629) in
                                                    {167}event beginCli(Cli,Sess,gNc_629);
                                                    {168}out(c, (pkCli,m1_630));
                                                    {169}in(c, em2_631: bitstring);
                                                    {170}let m2_632: bitstring = em2_631 in
                                                    {171}let (=OpenSecureChannelResponse,=Cli,PartS_633: bitstring,ST_634: bitstring,TTL_635: bitstring) = m2_632 in
                                                    {172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {173}event endCli(Sess,Cli,PartS_633)
                                            )
                                            else
                                                {174}let pkSess_636: bitstring = fail-any in
                                                {175}out(c, GetEndpointRequest);
                                                {176}in(c, (=GetEndpointResponse,=pkSess_636,=None,SP_637: bitstring,UP_638: bitstring));
                                                {177}new Nc_639: bitstring;
                                                {178}let gNc_640: bitstring = exp(g,Nc_639) in
                                                {179}let m1_641: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_640) in
                                                {180}event beginCli(Cli,Sess,gNc_640);
                                                {181}out(c, (pkCli,m1_641));
                                                {182}in(c, em2_642: bitstring);
                                                {183}let m2_643: bitstring = em2_642 in
                                                {184}let (=OpenSecureChannelResponse,=Cli,PartS_644: bitstring,ST_645: bitstring,TTL_646: bitstring) = m2_643 in
                                                {185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {186}event endCli(Sess,Cli,PartS_644)
                                    )
                                    else
                                        {187}let pkSess_647: bitstring = fail-any in
                                        {188}out(c, GetEndpointRequest);
                                        {189}in(c, (=GetEndpointResponse,=pkSess_647,=None,SP_648: bitstring,UP_649: bitstring));
                                        {190}new Nc_650: bitstring;
                                        {191}let gNc_651: bitstring = exp(g,Nc_650) in
                                        {192}let m1_652: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_651) in
                                        {193}event beginCli(Cli,Sess,gNc_651);
                                        {194}out(c, (pkCli,m1_652));
                                        {195}in(c, em2_653: bitstring);
                                        {196}let m2_654: bitstring = em2_653 in
                                        {197}let (=OpenSecureChannelResponse,=Cli,PartS_655: bitstring,ST_656: bitstring,TTL_657: bitstring) = m2_654 in
                                        {198}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {199}event endCli(Sess,Cli,PartS_655)
                            )
                            else
                                {200}let pkSess_658: bitstring = fail-any in
                                {201}out(c, GetEndpointRequest);
                                {202}in(c, (=GetEndpointResponse,=pkSess_658,=None,SP_659: bitstring,UP_660: bitstring));
                                {203}new Nc_661: bitstring;
                                {204}let gNc_662: bitstring = exp(g,Nc_661) in
                                {205}let m1_663: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_662) in
                                {206}event beginCli(Cli,Sess,gNc_662);
                                {207}out(c, (pkCli,m1_663));
                                {208}in(c, em2_664: bitstring);
                                {209}let m2_665: bitstring = em2_664 in
                                {210}let (=OpenSecureChannelResponse,=Cli,PartS_666: bitstring,ST_667: bitstring,TTL_668: bitstring) = m2_665 in
                                {211}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {212}event endCli(Sess,Cli,PartS_666)
                        )
                        else
                            {213}let v_669: bool = (Disco = C) in
                            (
                                {214}if v_669 then
                                (
                                    {215}let pkDisco_670: bitstring = pub(skC) in
                                    {216}let v_671: bool = (Sess = A) in
                                    (
                                        {217}if v_671 then
                                        (
                                            {218}let pkSess_672: bitstring = pub(skA) in
                                            {219}out(c, GetEndpointRequest);
                                            {220}in(c, (=GetEndpointResponse,=pkSess_672,=None,SP_673: bitstring,UP_674: bitstring));
                                            {221}new Nc_675: bitstring;
                                            {222}let gNc_676: bitstring = exp(g,Nc_675) in
                                            {223}let m1_677: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_676) in
                                            {224}event beginCli(Cli,Sess,gNc_676);
                                            {225}out(c, (pkCli,m1_677));
                                            {226}in(c, em2_678: bitstring);
                                            {227}let m2_679: bitstring = em2_678 in
                                            {228}let (=OpenSecureChannelResponse,=Cli,PartS_680: bitstring,ST_681: bitstring,TTL_682: bitstring) = m2_679 in
                                            {229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {230}event endCli(Sess,Cli,PartS_680)
                                        )
                                        else
                                            {231}let v_683: bool = (Sess = B) in
                                            (
                                                {232}if v_683 then
                                                (
                                                    {233}let pkSess_684: bitstring = pub(skB) in
                                                    {234}out(c, GetEndpointRequest);
                                                    {235}in(c, (=GetEndpointResponse,=pkSess_684,=None,SP_685: bitstring,UP_686: bitstring));
                                                    {236}new Nc_687: bitstring;
                                                    {237}let gNc_688: bitstring = exp(g,Nc_687) in
                                                    {238}let m1_689: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_688) in
                                                    {239}event beginCli(Cli,Sess,gNc_688);
                                                    {240}out(c, (pkCli,m1_689));
                                                    {241}in(c, em2_690: bitstring);
                                                    {242}let m2_691: bitstring = em2_690 in
                                                    {243}let (=OpenSecureChannelResponse,=Cli,PartS_692: bitstring,ST_693: bitstring,TTL_694: bitstring) = m2_691 in
                                                    {244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {245}event endCli(Sess,Cli,PartS_692)
                                                )
                                                else
                                                    {246}let v_695: bool = (Sess = C) in
                                                    (
                                                        {247}if v_695 then
                                                        (
                                                            {248}let pkSess_696: bitstring = pub(skC) in
                                                            {249}out(c, GetEndpointRequest);
                                                            {250}in(c, (=GetEndpointResponse,=pkSess_696,=None,SP_697: bitstring,UP_698: bitstring));
                                                            {251}new Nc_699: bitstring;
                                                            {252}let gNc_700: bitstring = exp(g,Nc_699) in
                                                            {253}let m1_701: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_700) in
                                                            {254}event beginCli(Cli,Sess,gNc_700);
                                                            {255}out(c, (pkCli,m1_701));
                                                            {256}in(c, em2_702: bitstring);
                                                            {257}let m2_703: bitstring = em2_702 in
                                                            {258}let (=OpenSecureChannelResponse,=Cli,PartS_704: bitstring,ST_705: bitstring,TTL_706: bitstring) = m2_703 in
                                                            {259}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {260}event endCli(Sess,Cli,PartS_704)
                                                        )
                                                        else
                                                            {261}let pkSess_707: bitstring = pub(sk(Sess)) in
                                                            {262}out(c, GetEndpointRequest);
                                                            {263}in(c, (=GetEndpointResponse,=pkSess_707,=None,SP_708: bitstring,UP_709: bitstring));
                                                            {264}new Nc_710: bitstring;
                                                            {265}let gNc_711: bitstring = exp(g,Nc_710) in
                                                            {266}let m1_712: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_711) in
                                                            {267}event beginCli(Cli,Sess,gNc_711);
                                                            {268}out(c, (pkCli,m1_712));
                                                            {269}in(c, em2_713: bitstring);
                                                            {270}let m2_714: bitstring = em2_713 in
                                                            {271}let (=OpenSecureChannelResponse,=Cli,PartS_715: bitstring,ST_716: bitstring,TTL_717: bitstring) = m2_714 in
                                                            {272}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {273}event endCli(Sess,Cli,PartS_715)
                                                    )
                                                    else
                                                        {274}let pkSess_718: bitstring = fail-any in
                                                        {275}out(c, GetEndpointRequest);
                                                        {276}in(c, (=GetEndpointResponse,=pkSess_718,=None,SP_719: bitstring,UP_720: bitstring));
                                                        {277}new Nc_721: bitstring;
                                                        {278}let gNc_722: bitstring = exp(g,Nc_721) in
                                                        {279}let m1_723: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_722) in
                                                        {280}event beginCli(Cli,Sess,gNc_722);
                                                        {281}out(c, (pkCli,m1_723));
                                                        {282}in(c, em2_724: bitstring);
                                                        {283}let m2_725: bitstring = em2_724 in
                                                        {284}let (=OpenSecureChannelResponse,=Cli,PartS_726: bitstring,ST_727: bitstring,TTL_728: bitstring) = m2_725 in
                                                        {285}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {286}event endCli(Sess,Cli,PartS_726)
                                            )
                                            else
                                                {287}let pkSess_729: bitstring = fail-any in
                                                {288}out(c, GetEndpointRequest);
                                                {289}in(c, (=GetEndpointResponse,=pkSess_729,=None,SP_730: bitstring,UP_731: bitstring));
                                                {290}new Nc_732: bitstring;
                                                {291}let gNc_733: bitstring = exp(g,Nc_732) in
                                                {292}let m1_734: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_733) in
                                                {293}event beginCli(Cli,Sess,gNc_733);
                                                {294}out(c, (pkCli,m1_734));
                                                {295}in(c, em2_735: bitstring);
                                                {296}let m2_736: bitstring = em2_735 in
                                                {297}let (=OpenSecureChannelResponse,=Cli,PartS_737: bitstring,ST_738: bitstring,TTL_739: bitstring) = m2_736 in
                                                {298}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {299}event endCli(Sess,Cli,PartS_737)
                                    )
                                    else
                                        {300}let pkSess_740: bitstring = fail-any in
                                        {301}out(c, GetEndpointRequest);
                                        {302}in(c, (=GetEndpointResponse,=pkSess_740,=None,SP_741: bitstring,UP_742: bitstring));
                                        {303}new Nc_743: bitstring;
                                        {304}let gNc_744: bitstring = exp(g,Nc_743) in
                                        {305}let m1_745: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_744) in
                                        {306}event beginCli(Cli,Sess,gNc_744);
                                        {307}out(c, (pkCli,m1_745));
                                        {308}in(c, em2_746: bitstring);
                                        {309}let m2_747: bitstring = em2_746 in
                                        {310}let (=OpenSecureChannelResponse,=Cli,PartS_748: bitstring,ST_749: bitstring,TTL_750: bitstring) = m2_747 in
                                        {311}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {312}event endCli(Sess,Cli,PartS_748)
                                )
                                else
                                    {313}let pkDisco_751: bitstring = pub(sk(Disco)) in
                                    {314}let v_752: bool = (Sess = A) in
                                    (
                                        {315}if v_752 then
                                        (
                                            {316}let pkSess_753: bitstring = pub(skA) in
                                            {317}out(c, GetEndpointRequest);
                                            {318}in(c, (=GetEndpointResponse,=pkSess_753,=None,SP_754: bitstring,UP_755: bitstring));
                                            {319}new Nc_756: bitstring;
                                            {320}let gNc_757: bitstring = exp(g,Nc_756) in
                                            {321}let m1_758: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_757) in
                                            {322}event beginCli(Cli,Sess,gNc_757);
                                            {323}out(c, (pkCli,m1_758));
                                            {324}in(c, em2_759: bitstring);
                                            {325}let m2_760: bitstring = em2_759 in
                                            {326}let (=OpenSecureChannelResponse,=Cli,PartS_761: bitstring,ST_762: bitstring,TTL_763: bitstring) = m2_760 in
                                            {327}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {328}event endCli(Sess,Cli,PartS_761)
                                        )
                                        else
                                            {329}let v_764: bool = (Sess = B) in
                                            (
                                                {330}if v_764 then
                                                (
                                                    {331}let pkSess_765: bitstring = pub(skB) in
                                                    {332}out(c, GetEndpointRequest);
                                                    {333}in(c, (=GetEndpointResponse,=pkSess_765,=None,SP_766: bitstring,UP_767: bitstring));
                                                    {334}new Nc_768: bitstring;
                                                    {335}let gNc_769: bitstring = exp(g,Nc_768) in
                                                    {336}let m1_770: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_769) in
                                                    {337}event beginCli(Cli,Sess,gNc_769);
                                                    {338}out(c, (pkCli,m1_770));
                                                    {339}in(c, em2_771: bitstring);
                                                    {340}let m2_772: bitstring = em2_771 in
                                                    {341}let (=OpenSecureChannelResponse,=Cli,PartS_773: bitstring,ST_774: bitstring,TTL_775: bitstring) = m2_772 in
                                                    {342}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {343}event endCli(Sess,Cli,PartS_773)
                                                )
                                                else
                                                    {344}let v_776: bool = (Sess = C) in
                                                    (
                                                        {345}if v_776 then
                                                        (
                                                            {346}let pkSess_777: bitstring = pub(skC) in
                                                            {347}out(c, GetEndpointRequest);
                                                            {348}in(c, (=GetEndpointResponse,=pkSess_777,=None,SP_778: bitstring,UP_779: bitstring));
                                                            {349}new Nc_780: bitstring;
                                                            {350}let gNc_781: bitstring = exp(g,Nc_780) in
                                                            {351}let m1_782: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_781) in
                                                            {352}event beginCli(Cli,Sess,gNc_781);
                                                            {353}out(c, (pkCli,m1_782));
                                                            {354}in(c, em2_783: bitstring);
                                                            {355}let m2_784: bitstring = em2_783 in
                                                            {356}let (=OpenSecureChannelResponse,=Cli,PartS_785: bitstring,ST_786: bitstring,TTL_787: bitstring) = m2_784 in
                                                            {357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {358}event endCli(Sess,Cli,PartS_785)
                                                        )
                                                        else
                                                            {359}let pkSess_788: bitstring = pub(sk(Sess)) in
                                                            {360}out(c, GetEndpointRequest);
                                                            {361}in(c, (=GetEndpointResponse,=pkSess_788,=None,SP_789: bitstring,UP_790: bitstring));
                                                            {362}new Nc_791: bitstring;
                                                            {363}let gNc_792: bitstring = exp(g,Nc_791) in
                                                            {364}let m1_793: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_792) in
                                                            {365}event beginCli(Cli,Sess,gNc_792);
                                                            {366}out(c, (pkCli,m1_793));
                                                            {367}in(c, em2_794: bitstring);
                                                            {368}let m2_795: bitstring = em2_794 in
                                                            {369}let (=OpenSecureChannelResponse,=Cli,PartS_796: bitstring,ST_797: bitstring,TTL_798: bitstring) = m2_795 in
                                                            {370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {371}event endCli(Sess,Cli,PartS_796)
                                                    )
                                                    else
                                                        {372}let pkSess_799: bitstring = fail-any in
                                                        {373}out(c, GetEndpointRequest);
                                                        {374}in(c, (=GetEndpointResponse,=pkSess_799,=None,SP_800: bitstring,UP_801: bitstring));
                                                        {375}new Nc_802: bitstring;
                                                        {376}let gNc_803: bitstring = exp(g,Nc_802) in
                                                        {377}let m1_804: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_803) in
                                                        {378}event beginCli(Cli,Sess,gNc_803);
                                                        {379}out(c, (pkCli,m1_804));
                                                        {380}in(c, em2_805: bitstring);
                                                        {381}let m2_806: bitstring = em2_805 in
                                                        {382}let (=OpenSecureChannelResponse,=Cli,PartS_807: bitstring,ST_808: bitstring,TTL_809: bitstring) = m2_806 in
                                                        {383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {384}event endCli(Sess,Cli,PartS_807)
                                            )
                                            else
                                                {385}let pkSess_810: bitstring = fail-any in
                                                {386}out(c, GetEndpointRequest);
                                                {387}in(c, (=GetEndpointResponse,=pkSess_810,=None,SP_811: bitstring,UP_812: bitstring));
                                                {388}new Nc_813: bitstring;
                                                {389}let gNc_814: bitstring = exp(g,Nc_813) in
                                                {390}let m1_815: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_814) in
                                                {391}event beginCli(Cli,Sess,gNc_814);
                                                {392}out(c, (pkCli,m1_815));
                                                {393}in(c, em2_816: bitstring);
                                                {394}let m2_817: bitstring = em2_816 in
                                                {395}let (=OpenSecureChannelResponse,=Cli,PartS_818: bitstring,ST_819: bitstring,TTL_820: bitstring) = m2_817 in
                                                {396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {397}event endCli(Sess,Cli,PartS_818)
                                    )
                                    else
                                        {398}let pkSess_821: bitstring = fail-any in
                                        {399}out(c, GetEndpointRequest);
                                        {400}in(c, (=GetEndpointResponse,=pkSess_821,=None,SP_822: bitstring,UP_823: bitstring));
                                        {401}new Nc_824: bitstring;
                                        {402}let gNc_825: bitstring = exp(g,Nc_824) in
                                        {403}let m1_826: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_825) in
                                        {404}event beginCli(Cli,Sess,gNc_825);
                                        {405}out(c, (pkCli,m1_826));
                                        {406}in(c, em2_827: bitstring);
                                        {407}let m2_828: bitstring = em2_827 in
                                        {408}let (=OpenSecureChannelResponse,=Cli,PartS_829: bitstring,ST_830: bitstring,TTL_831: bitstring) = m2_828 in
                                        {409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {410}event endCli(Sess,Cli,PartS_829)
                            )
                            else
                                {411}let pkDisco_832: bitstring = fail-any in
                                {412}let v_833: bool = (Sess = A) in
                                (
                                    {413}if v_833 then
                                    (
                                        {414}let pkSess_834: bitstring = pub(skA) in
                                        {415}out(c, GetEndpointRequest);
                                        {416}in(c, (=GetEndpointResponse,=pkSess_834,=None,SP_835: bitstring,UP_836: bitstring));
                                        {417}new Nc_837: bitstring;
                                        {418}let gNc_838: bitstring = exp(g,Nc_837) in
                                        {419}let m1_839: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_838) in
                                        {420}event beginCli(Cli,Sess,gNc_838);
                                        {421}out(c, (pkCli,m1_839));
                                        {422}in(c, em2_840: bitstring);
                                        {423}let m2_841: bitstring = em2_840 in
                                        {424}let (=OpenSecureChannelResponse,=Cli,PartS_842: bitstring,ST_843: bitstring,TTL_844: bitstring) = m2_841 in
                                        {425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {426}event endCli(Sess,Cli,PartS_842)
                                    )
                                    else
                                        {427}let v_845: bool = (Sess = B) in
                                        (
                                            {428}if v_845 then
                                            (
                                                {429}let pkSess_846: bitstring = pub(skB) in
                                                {430}out(c, GetEndpointRequest);
                                                {431}in(c, (=GetEndpointResponse,=pkSess_846,=None,SP_847: bitstring,UP_848: bitstring));
                                                {432}new Nc_849: bitstring;
                                                {433}let gNc_850: bitstring = exp(g,Nc_849) in
                                                {434}let m1_851: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_850) in
                                                {435}event beginCli(Cli,Sess,gNc_850);
                                                {436}out(c, (pkCli,m1_851));
                                                {437}in(c, em2_852: bitstring);
                                                {438}let m2_853: bitstring = em2_852 in
                                                {439}let (=OpenSecureChannelResponse,=Cli,PartS_854: bitstring,ST_855: bitstring,TTL_856: bitstring) = m2_853 in
                                                {440}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {441}event endCli(Sess,Cli,PartS_854)
                                            )
                                            else
                                                {442}let v_857: bool = (Sess = C) in
                                                (
                                                    {443}if v_857 then
                                                    (
                                                        {444}let pkSess_858: bitstring = pub(skC) in
                                                        {445}out(c, GetEndpointRequest);
                                                        {446}in(c, (=GetEndpointResponse,=pkSess_858,=None,SP_859: bitstring,UP_860: bitstring));
                                                        {447}new Nc_861: bitstring;
                                                        {448}let gNc_862: bitstring = exp(g,Nc_861) in
                                                        {449}let m1_863: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_862) in
                                                        {450}event beginCli(Cli,Sess,gNc_862);
                                                        {451}out(c, (pkCli,m1_863));
                                                        {452}in(c, em2_864: bitstring);
                                                        {453}let m2_865: bitstring = em2_864 in
                                                        {454}let (=OpenSecureChannelResponse,=Cli,PartS_866: bitstring,ST_867: bitstring,TTL_868: bitstring) = m2_865 in
                                                        {455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {456}event endCli(Sess,Cli,PartS_866)
                                                    )
                                                    else
                                                        {457}let pkSess_869: bitstring = pub(sk(Sess)) in
                                                        {458}out(c, GetEndpointRequest);
                                                        {459}in(c, (=GetEndpointResponse,=pkSess_869,=None,SP_870: bitstring,UP_871: bitstring));
                                                        {460}new Nc_872: bitstring;
                                                        {461}let gNc_873: bitstring = exp(g,Nc_872) in
                                                        {462}let m1_874: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_873) in
                                                        {463}event beginCli(Cli,Sess,gNc_873);
                                                        {464}out(c, (pkCli,m1_874));
                                                        {465}in(c, em2_875: bitstring);
                                                        {466}let m2_876: bitstring = em2_875 in
                                                        {467}let (=OpenSecureChannelResponse,=Cli,PartS_877: bitstring,ST_878: bitstring,TTL_879: bitstring) = m2_876 in
                                                        {468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {469}event endCli(Sess,Cli,PartS_877)
                                                )
                                                else
                                                    {470}let pkSess_880: bitstring = fail-any in
                                                    {471}out(c, GetEndpointRequest);
                                                    {472}in(c, (=GetEndpointResponse,=pkSess_880,=None,SP_881: bitstring,UP_882: bitstring));
                                                    {473}new Nc_883: bitstring;
                                                    {474}let gNc_884: bitstring = exp(g,Nc_883) in
                                                    {475}let m1_885: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_884) in
                                                    {476}event beginCli(Cli,Sess,gNc_884);
                                                    {477}out(c, (pkCli,m1_885));
                                                    {478}in(c, em2_886: bitstring);
                                                    {479}let m2_887: bitstring = em2_886 in
                                                    {480}let (=OpenSecureChannelResponse,=Cli,PartS_888: bitstring,ST_889: bitstring,TTL_890: bitstring) = m2_887 in
                                                    {481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {482}event endCli(Sess,Cli,PartS_888)
                                        )
                                        else
                                            {483}let pkSess_891: bitstring = fail-any in
                                            {484}out(c, GetEndpointRequest);
                                            {485}in(c, (=GetEndpointResponse,=pkSess_891,=None,SP_892: bitstring,UP_893: bitstring));
                                            {486}new Nc_894: bitstring;
                                            {487}let gNc_895: bitstring = exp(g,Nc_894) in
                                            {488}let m1_896: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_895) in
                                            {489}event beginCli(Cli,Sess,gNc_895);
                                            {490}out(c, (pkCli,m1_896));
                                            {491}in(c, em2_897: bitstring);
                                            {492}let m2_898: bitstring = em2_897 in
                                            {493}let (=OpenSecureChannelResponse,=Cli,PartS_899: bitstring,ST_900: bitstring,TTL_901: bitstring) = m2_898 in
                                            {494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {495}event endCli(Sess,Cli,PartS_899)
                                )
                                else
                                    {496}let pkSess_902: bitstring = fail-any in
                                    {497}out(c, GetEndpointRequest);
                                    {498}in(c, (=GetEndpointResponse,=pkSess_902,=None,SP_903: bitstring,UP_904: bitstring));
                                    {499}new Nc_905: bitstring;
                                    {500}let gNc_906: bitstring = exp(g,Nc_905) in
                                    {501}let m1_907: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_906) in
                                    {502}event beginCli(Cli,Sess,gNc_906);
                                    {503}out(c, (pkCli,m1_907));
                                    {504}in(c, em2_908: bitstring);
                                    {505}let m2_909: bitstring = em2_908 in
                                    {506}let (=OpenSecureChannelResponse,=Cli,PartS_910: bitstring,ST_911: bitstring,TTL_912: bitstring) = m2_909 in
                                    {507}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {508}event endCli(Sess,Cli,PartS_910)
                    )
                    else
                        {509}let pkDisco_913: bitstring = fail-any in
                        {510}let v_914: bool = (Sess = A) in
                        (
                            {511}if v_914 then
                            (
                                {512}let pkSess_915: bitstring = pub(skA) in
                                {513}out(c, GetEndpointRequest);
                                {514}in(c, (=GetEndpointResponse,=pkSess_915,=None,SP_916: bitstring,UP_917: bitstring));
                                {515}new Nc_918: bitstring;
                                {516}let gNc_919: bitstring = exp(g,Nc_918) in
                                {517}let m1_920: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_919) in
                                {518}event beginCli(Cli,Sess,gNc_919);
                                {519}out(c, (pkCli,m1_920));
                                {520}in(c, em2_921: bitstring);
                                {521}let m2_922: bitstring = em2_921 in
                                {522}let (=OpenSecureChannelResponse,=Cli,PartS_923: bitstring,ST_924: bitstring,TTL_925: bitstring) = m2_922 in
                                {523}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {524}event endCli(Sess,Cli,PartS_923)
                            )
                            else
                                {525}let v_926: bool = (Sess = B) in
                                (
                                    {526}if v_926 then
                                    (
                                        {527}let pkSess_927: bitstring = pub(skB) in
                                        {528}out(c, GetEndpointRequest);
                                        {529}in(c, (=GetEndpointResponse,=pkSess_927,=None,SP_928: bitstring,UP_929: bitstring));
                                        {530}new Nc_930: bitstring;
                                        {531}let gNc_931: bitstring = exp(g,Nc_930) in
                                        {532}let m1_932: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_931) in
                                        {533}event beginCli(Cli,Sess,gNc_931);
                                        {534}out(c, (pkCli,m1_932));
                                        {535}in(c, em2_933: bitstring);
                                        {536}let m2_934: bitstring = em2_933 in
                                        {537}let (=OpenSecureChannelResponse,=Cli,PartS_935: bitstring,ST_936: bitstring,TTL_937: bitstring) = m2_934 in
                                        {538}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {539}event endCli(Sess,Cli,PartS_935)
                                    )
                                    else
                                        {540}let v_938: bool = (Sess = C) in
                                        (
                                            {541}if v_938 then
                                            (
                                                {542}let pkSess_939: bitstring = pub(skC) in
                                                {543}out(c, GetEndpointRequest);
                                                {544}in(c, (=GetEndpointResponse,=pkSess_939,=None,SP_940: bitstring,UP_941: bitstring));
                                                {545}new Nc_942: bitstring;
                                                {546}let gNc_943: bitstring = exp(g,Nc_942) in
                                                {547}let m1_944: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_943) in
                                                {548}event beginCli(Cli,Sess,gNc_943);
                                                {549}out(c, (pkCli,m1_944));
                                                {550}in(c, em2_945: bitstring);
                                                {551}let m2_946: bitstring = em2_945 in
                                                {552}let (=OpenSecureChannelResponse,=Cli,PartS_947: bitstring,ST_948: bitstring,TTL_949: bitstring) = m2_946 in
                                                {553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {554}event endCli(Sess,Cli,PartS_947)
                                            )
                                            else
                                                {555}let pkSess_950: bitstring = pub(sk(Sess)) in
                                                {556}out(c, GetEndpointRequest);
                                                {557}in(c, (=GetEndpointResponse,=pkSess_950,=None,SP_951: bitstring,UP_952: bitstring));
                                                {558}new Nc_953: bitstring;
                                                {559}let gNc_954: bitstring = exp(g,Nc_953) in
                                                {560}let m1_955: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_954) in
                                                {561}event beginCli(Cli,Sess,gNc_954);
                                                {562}out(c, (pkCli,m1_955));
                                                {563}in(c, em2_956: bitstring);
                                                {564}let m2_957: bitstring = em2_956 in
                                                {565}let (=OpenSecureChannelResponse,=Cli,PartS_958: bitstring,ST_959: bitstring,TTL_960: bitstring) = m2_957 in
                                                {566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {567}event endCli(Sess,Cli,PartS_958)
                                        )
                                        else
                                            {568}let pkSess_961: bitstring = fail-any in
                                            {569}out(c, GetEndpointRequest);
                                            {570}in(c, (=GetEndpointResponse,=pkSess_961,=None,SP_962: bitstring,UP_963: bitstring));
                                            {571}new Nc_964: bitstring;
                                            {572}let gNc_965: bitstring = exp(g,Nc_964) in
                                            {573}let m1_966: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_965) in
                                            {574}event beginCli(Cli,Sess,gNc_965);
                                            {575}out(c, (pkCli,m1_966));
                                            {576}in(c, em2_967: bitstring);
                                            {577}let m2_968: bitstring = em2_967 in
                                            {578}let (=OpenSecureChannelResponse,=Cli,PartS_969: bitstring,ST_970: bitstring,TTL_971: bitstring) = m2_968 in
                                            {579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {580}event endCli(Sess,Cli,PartS_969)
                                )
                                else
                                    {581}let pkSess_972: bitstring = fail-any in
                                    {582}out(c, GetEndpointRequest);
                                    {583}in(c, (=GetEndpointResponse,=pkSess_972,=None,SP_973: bitstring,UP_974: bitstring));
                                    {584}new Nc_975: bitstring;
                                    {585}let gNc_976: bitstring = exp(g,Nc_975) in
                                    {586}let m1_977: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_976) in
                                    {587}event beginCli(Cli,Sess,gNc_976);
                                    {588}out(c, (pkCli,m1_977));
                                    {589}in(c, em2_978: bitstring);
                                    {590}let m2_979: bitstring = em2_978 in
                                    {591}let (=OpenSecureChannelResponse,=Cli,PartS_980: bitstring,ST_981: bitstring,TTL_982: bitstring) = m2_979 in
                                    {592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {593}event endCli(Sess,Cli,PartS_980)
                        )
                        else
                            {594}let pkSess_983: bitstring = fail-any in
                            {595}out(c, GetEndpointRequest);
                            {596}in(c, (=GetEndpointResponse,=pkSess_983,=None,SP_984: bitstring,UP_985: bitstring));
                            {597}new Nc_986: bitstring;
                            {598}let gNc_987: bitstring = exp(g,Nc_986) in
                            {599}let m1_988: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_987) in
                            {600}event beginCli(Cli,Sess,gNc_987);
                            {601}out(c, (pkCli,m1_988));
                            {602}in(c, em2_989: bitstring);
                            {603}let m2_990: bitstring = em2_989 in
                            {604}let (=OpenSecureChannelResponse,=Cli,PartS_991: bitstring,ST_992: bitstring,TTL_993: bitstring) = m2_990 in
                            {605}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {606}event endCli(Sess,Cli,PartS_991)
            )
            else
                {607}let pkDisco_994: bitstring = fail-any in
                {608}let v_995: bool = (Sess = A) in
                (
                    {609}if v_995 then
                    (
                        {610}let pkSess_996: bitstring = pub(skA) in
                        {611}out(c, GetEndpointRequest);
                        {612}in(c, (=GetEndpointResponse,=pkSess_996,=None,SP_997: bitstring,UP_998: bitstring));
                        {613}new Nc_999: bitstring;
                        {614}let gNc_1000: bitstring = exp(g,Nc_999) in
                        {615}let m1_1001: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1000) in
                        {616}event beginCli(Cli,Sess,gNc_1000);
                        {617}out(c, (pkCli,m1_1001));
                        {618}in(c, em2_1002: bitstring);
                        {619}let m2_1003: bitstring = em2_1002 in
                        {620}let (=OpenSecureChannelResponse,=Cli,PartS_1004: bitstring,ST_1005: bitstring,TTL_1006: bitstring) = m2_1003 in
                        {621}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {622}event endCli(Sess,Cli,PartS_1004)
                    )
                    else
                        {623}let v_1007: bool = (Sess = B) in
                        (
                            {624}if v_1007 then
                            (
                                {625}let pkSess_1008: bitstring = pub(skB) in
                                {626}out(c, GetEndpointRequest);
                                {627}in(c, (=GetEndpointResponse,=pkSess_1008,=None,SP_1009: bitstring,UP_1010: bitstring));
                                {628}new Nc_1011: bitstring;
                                {629}let gNc_1012: bitstring = exp(g,Nc_1011) in
                                {630}let m1_1013: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1012) in
                                {631}event beginCli(Cli,Sess,gNc_1012);
                                {632}out(c, (pkCli,m1_1013));
                                {633}in(c, em2_1014: bitstring);
                                {634}let m2_1015: bitstring = em2_1014 in
                                {635}let (=OpenSecureChannelResponse,=Cli,PartS_1016: bitstring,ST_1017: bitstring,TTL_1018: bitstring) = m2_1015 in
                                {636}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {637}event endCli(Sess,Cli,PartS_1016)
                            )
                            else
                                {638}let v_1019: bool = (Sess = C) in
                                (
                                    {639}if v_1019 then
                                    (
                                        {640}let pkSess_1020: bitstring = pub(skC) in
                                        {641}out(c, GetEndpointRequest);
                                        {642}in(c, (=GetEndpointResponse,=pkSess_1020,=None,SP_1021: bitstring,UP_1022: bitstring));
                                        {643}new Nc_1023: bitstring;
                                        {644}let gNc_1024: bitstring = exp(g,Nc_1023) in
                                        {645}let m1_1025: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1024) in
                                        {646}event beginCli(Cli,Sess,gNc_1024);
                                        {647}out(c, (pkCli,m1_1025));
                                        {648}in(c, em2_1026: bitstring);
                                        {649}let m2_1027: bitstring = em2_1026 in
                                        {650}let (=OpenSecureChannelResponse,=Cli,PartS_1028: bitstring,ST_1029: bitstring,TTL_1030: bitstring) = m2_1027 in
                                        {651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {652}event endCli(Sess,Cli,PartS_1028)
                                    )
                                    else
                                        {653}let pkSess_1031: bitstring = pub(sk(Sess)) in
                                        {654}out(c, GetEndpointRequest);
                                        {655}in(c, (=GetEndpointResponse,=pkSess_1031,=None,SP_1032: bitstring,UP_1033: bitstring));
                                        {656}new Nc_1034: bitstring;
                                        {657}let gNc_1035: bitstring = exp(g,Nc_1034) in
                                        {658}let m1_1036: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1035) in
                                        {659}event beginCli(Cli,Sess,gNc_1035);
                                        {660}out(c, (pkCli,m1_1036));
                                        {661}in(c, em2_1037: bitstring);
                                        {662}let m2_1038: bitstring = em2_1037 in
                                        {663}let (=OpenSecureChannelResponse,=Cli,PartS_1039: bitstring,ST_1040: bitstring,TTL_1041: bitstring) = m2_1038 in
                                        {664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {665}event endCli(Sess,Cli,PartS_1039)
                                )
                                else
                                    {666}let pkSess_1042: bitstring = fail-any in
                                    {667}out(c, GetEndpointRequest);
                                    {668}in(c, (=GetEndpointResponse,=pkSess_1042,=None,SP_1043: bitstring,UP_1044: bitstring));
                                    {669}new Nc_1045: bitstring;
                                    {670}let gNc_1046: bitstring = exp(g,Nc_1045) in
                                    {671}let m1_1047: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1046) in
                                    {672}event beginCli(Cli,Sess,gNc_1046);
                                    {673}out(c, (pkCli,m1_1047));
                                    {674}in(c, em2_1048: bitstring);
                                    {675}let m2_1049: bitstring = em2_1048 in
                                    {676}let (=OpenSecureChannelResponse,=Cli,PartS_1050: bitstring,ST_1051: bitstring,TTL_1052: bitstring) = m2_1049 in
                                    {677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {678}event endCli(Sess,Cli,PartS_1050)
                        )
                        else
                            {679}let pkSess_1053: bitstring = fail-any in
                            {680}out(c, GetEndpointRequest);
                            {681}in(c, (=GetEndpointResponse,=pkSess_1053,=None,SP_1054: bitstring,UP_1055: bitstring));
                            {682}new Nc_1056: bitstring;
                            {683}let gNc_1057: bitstring = exp(g,Nc_1056) in
                            {684}let m1_1058: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1057) in
                            {685}event beginCli(Cli,Sess,gNc_1057);
                            {686}out(c, (pkCli,m1_1058));
                            {687}in(c, em2_1059: bitstring);
                            {688}let m2_1060: bitstring = em2_1059 in
                            {689}let (=OpenSecureChannelResponse,=Cli,PartS_1061: bitstring,ST_1062: bitstring,TTL_1063: bitstring) = m2_1060 in
                            {690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {691}event endCli(Sess,Cli,PartS_1061)
                )
                else
                    {692}let pkSess_1064: bitstring = fail-any in
                    {693}out(c, GetEndpointRequest);
                    {694}in(c, (=GetEndpointResponse,=pkSess_1064,=None,SP_1065: bitstring,UP_1066: bitstring));
                    {695}new Nc_1067: bitstring;
                    {696}let gNc_1068: bitstring = exp(g,Nc_1067) in
                    {697}let m1_1069: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1068) in
                    {698}event beginCli(Cli,Sess,gNc_1068);
                    {699}out(c, (pkCli,m1_1069));
                    {700}in(c, em2_1070: bitstring);
                    {701}let m2_1071: bitstring = em2_1070 in
                    {702}let (=OpenSecureChannelResponse,=Cli,PartS_1072: bitstring,ST_1073: bitstring,TTL_1074: bitstring) = m2_1071 in
                    {703}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {704}event endCli(Sess,Cli,PartS_1072)
        )
        else
            {705}let v_1075: bool = (Cli = B) in
            (
                {706}if v_1075 then
                (
                    {707}let skCli_1076: bitstring = skB in
                    {708}let pkCli_1077: bitstring = pub(skCli_1076) in
                    {709}let v_1078: bool = (Disco = A) in
                    (
                        {710}if v_1078 then
                        (
                            {711}let pkDisco_1079: bitstring = pub(skA) in
                            {712}let v_1080: bool = (Sess = A) in
                            (
                                {713}if v_1080 then
                                (
                                    {714}let pkSess_1081: bitstring = pub(skA) in
                                    {715}out(c, GetEndpointRequest);
                                    {716}in(c, (=GetEndpointResponse,=pkSess_1081,=None,SP_1082: bitstring,UP_1083: bitstring));
                                    {717}new Nc_1084: bitstring;
                                    {718}let gNc_1085: bitstring = exp(g,Nc_1084) in
                                    {719}let m1_1086: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1085) in
                                    {720}event beginCli(Cli,Sess,gNc_1085);
                                    {721}out(c, (pkCli_1077,m1_1086));
                                    {722}in(c, em2_1087: bitstring);
                                    {723}let m2_1088: bitstring = em2_1087 in
                                    {724}let (=OpenSecureChannelResponse,=Cli,PartS_1089: bitstring,ST_1090: bitstring,TTL_1091: bitstring) = m2_1088 in
                                    {725}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {726}event endCli(Sess,Cli,PartS_1089)
                                )
                                else
                                    {727}let v_1092: bool = (Sess = B) in
                                    (
                                        {728}if v_1092 then
                                        (
                                            {729}let pkSess_1093: bitstring = pub(skB) in
                                            {730}out(c, GetEndpointRequest);
                                            {731}in(c, (=GetEndpointResponse,=pkSess_1093,=None,SP_1094: bitstring,UP_1095: bitstring));
                                            {732}new Nc_1096: bitstring;
                                            {733}let gNc_1097: bitstring = exp(g,Nc_1096) in
                                            {734}let m1_1098: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1097) in
                                            {735}event beginCli(Cli,Sess,gNc_1097);
                                            {736}out(c, (pkCli_1077,m1_1098));
                                            {737}in(c, em2_1099: bitstring);
                                            {738}let m2_1100: bitstring = em2_1099 in
                                            {739}let (=OpenSecureChannelResponse,=Cli,PartS_1101: bitstring,ST_1102: bitstring,TTL_1103: bitstring) = m2_1100 in
                                            {740}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {741}event endCli(Sess,Cli,PartS_1101)
                                        )
                                        else
                                            {742}let v_1104: bool = (Sess = C) in
                                            (
                                                {743}if v_1104 then
                                                (
                                                    {744}let pkSess_1105: bitstring = pub(skC) in
                                                    {745}out(c, GetEndpointRequest);
                                                    {746}in(c, (=GetEndpointResponse,=pkSess_1105,=None,SP_1106: bitstring,UP_1107: bitstring));
                                                    {747}new Nc_1108: bitstring;
                                                    {748}let gNc_1109: bitstring = exp(g,Nc_1108) in
                                                    {749}let m1_1110: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1109) in
                                                    {750}event beginCli(Cli,Sess,gNc_1109);
                                                    {751}out(c, (pkCli_1077,m1_1110));
                                                    {752}in(c, em2_1111: bitstring);
                                                    {753}let m2_1112: bitstring = em2_1111 in
                                                    {754}let (=OpenSecureChannelResponse,=Cli,PartS_1113: bitstring,ST_1114: bitstring,TTL_1115: bitstring) = m2_1112 in
                                                    {755}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {756}event endCli(Sess,Cli,PartS_1113)
                                                )
                                                else
                                                    {757}let pkSess_1116: bitstring = pub(sk(Sess)) in
                                                    {758}out(c, GetEndpointRequest);
                                                    {759}in(c, (=GetEndpointResponse,=pkSess_1116,=None,SP_1117: bitstring,UP_1118: bitstring));
                                                    {760}new Nc_1119: bitstring;
                                                    {761}let gNc_1120: bitstring = exp(g,Nc_1119) in
                                                    {762}let m1_1121: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1120) in
                                                    {763}event beginCli(Cli,Sess,gNc_1120);
                                                    {764}out(c, (pkCli_1077,m1_1121));
                                                    {765}in(c, em2_1122: bitstring);
                                                    {766}let m2_1123: bitstring = em2_1122 in
                                                    {767}let (=OpenSecureChannelResponse,=Cli,PartS_1124: bitstring,ST_1125: bitstring,TTL_1126: bitstring) = m2_1123 in
                                                    {768}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {769}event endCli(Sess,Cli,PartS_1124)
                                            )
                                            else
                                                {770}let pkSess_1127: bitstring = fail-any in
                                                {771}out(c, GetEndpointRequest);
                                                {772}in(c, (=GetEndpointResponse,=pkSess_1127,=None,SP_1128: bitstring,UP_1129: bitstring));
                                                {773}new Nc_1130: bitstring;
                                                {774}let gNc_1131: bitstring = exp(g,Nc_1130) in
                                                {775}let m1_1132: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1131) in
                                                {776}event beginCli(Cli,Sess,gNc_1131);
                                                {777}out(c, (pkCli_1077,m1_1132));
                                                {778}in(c, em2_1133: bitstring);
                                                {779}let m2_1134: bitstring = em2_1133 in
                                                {780}let (=OpenSecureChannelResponse,=Cli,PartS_1135: bitstring,ST_1136: bitstring,TTL_1137: bitstring) = m2_1134 in
                                                {781}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {782}event endCli(Sess,Cli,PartS_1135)
                                    )
                                    else
                                        {783}let pkSess_1138: bitstring = fail-any in
                                        {784}out(c, GetEndpointRequest);
                                        {785}in(c, (=GetEndpointResponse,=pkSess_1138,=None,SP_1139: bitstring,UP_1140: bitstring));
                                        {786}new Nc_1141: bitstring;
                                        {787}let gNc_1142: bitstring = exp(g,Nc_1141) in
                                        {788}let m1_1143: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1142) in
                                        {789}event beginCli(Cli,Sess,gNc_1142);
                                        {790}out(c, (pkCli_1077,m1_1143));
                                        {791}in(c, em2_1144: bitstring);
                                        {792}let m2_1145: bitstring = em2_1144 in
                                        {793}let (=OpenSecureChannelResponse,=Cli,PartS_1146: bitstring,ST_1147: bitstring,TTL_1148: bitstring) = m2_1145 in
                                        {794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {795}event endCli(Sess,Cli,PartS_1146)
                            )
                            else
                                {796}let pkSess_1149: bitstring = fail-any in
                                {797}out(c, GetEndpointRequest);
                                {798}in(c, (=GetEndpointResponse,=pkSess_1149,=None,SP_1150: bitstring,UP_1151: bitstring));
                                {799}new Nc_1152: bitstring;
                                {800}let gNc_1153: bitstring = exp(g,Nc_1152) in
                                {801}let m1_1154: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1153) in
                                {802}event beginCli(Cli,Sess,gNc_1153);
                                {803}out(c, (pkCli_1077,m1_1154));
                                {804}in(c, em2_1155: bitstring);
                                {805}let m2_1156: bitstring = em2_1155 in
                                {806}let (=OpenSecureChannelResponse,=Cli,PartS_1157: bitstring,ST_1158: bitstring,TTL_1159: bitstring) = m2_1156 in
                                {807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {808}event endCli(Sess,Cli,PartS_1157)
                        )
                        else
                            {809}let v_1160: bool = (Disco = B) in
                            (
                                {810}if v_1160 then
                                (
                                    {811}let pkDisco_1161: bitstring = pub(skB) in
                                    {812}let v_1162: bool = (Sess = A) in
                                    (
                                        {813}if v_1162 then
                                        (
                                            {814}let pkSess_1163: bitstring = pub(skA) in
                                            {815}out(c, GetEndpointRequest);
                                            {816}in(c, (=GetEndpointResponse,=pkSess_1163,=None,SP_1164: bitstring,UP_1165: bitstring));
                                            {817}new Nc_1166: bitstring;
                                            {818}let gNc_1167: bitstring = exp(g,Nc_1166) in
                                            {819}let m1_1168: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1167) in
                                            {820}event beginCli(Cli,Sess,gNc_1167);
                                            {821}out(c, (pkCli_1077,m1_1168));
                                            {822}in(c, em2_1169: bitstring);
                                            {823}let m2_1170: bitstring = em2_1169 in
                                            {824}let (=OpenSecureChannelResponse,=Cli,PartS_1171: bitstring,ST_1172: bitstring,TTL_1173: bitstring) = m2_1170 in
                                            {825}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {826}event endCli(Sess,Cli,PartS_1171)
                                        )
                                        else
                                            {827}let v_1174: bool = (Sess = B) in
                                            (
                                                {828}if v_1174 then
                                                (
                                                    {829}let pkSess_1175: bitstring = pub(skB) in
                                                    {830}out(c, GetEndpointRequest);
                                                    {831}in(c, (=GetEndpointResponse,=pkSess_1175,=None,SP_1176: bitstring,UP_1177: bitstring));
                                                    {832}new Nc_1178: bitstring;
                                                    {833}let gNc_1179: bitstring = exp(g,Nc_1178) in
                                                    {834}let m1_1180: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1179) in
                                                    {835}event beginCli(Cli,Sess,gNc_1179);
                                                    {836}out(c, (pkCli_1077,m1_1180));
                                                    {837}in(c, em2_1181: bitstring);
                                                    {838}let m2_1182: bitstring = em2_1181 in
                                                    {839}let (=OpenSecureChannelResponse,=Cli,PartS_1183: bitstring,ST_1184: bitstring,TTL_1185: bitstring) = m2_1182 in
                                                    {840}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {841}event endCli(Sess,Cli,PartS_1183)
                                                )
                                                else
                                                    {842}let v_1186: bool = (Sess = C) in
                                                    (
                                                        {843}if v_1186 then
                                                        (
                                                            {844}let pkSess_1187: bitstring = pub(skC) in
                                                            {845}out(c, GetEndpointRequest);
                                                            {846}in(c, (=GetEndpointResponse,=pkSess_1187,=None,SP_1188: bitstring,UP_1189: bitstring));
                                                            {847}new Nc_1190: bitstring;
                                                            {848}let gNc_1191: bitstring = exp(g,Nc_1190) in
                                                            {849}let m1_1192: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1191) in
                                                            {850}event beginCli(Cli,Sess,gNc_1191);
                                                            {851}out(c, (pkCli_1077,m1_1192));
                                                            {852}in(c, em2_1193: bitstring);
                                                            {853}let m2_1194: bitstring = em2_1193 in
                                                            {854}let (=OpenSecureChannelResponse,=Cli,PartS_1195: bitstring,ST_1196: bitstring,TTL_1197: bitstring) = m2_1194 in
                                                            {855}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {856}event endCli(Sess,Cli,PartS_1195)
                                                        )
                                                        else
                                                            {857}let pkSess_1198: bitstring = pub(sk(Sess)) in
                                                            {858}out(c, GetEndpointRequest);
                                                            {859}in(c, (=GetEndpointResponse,=pkSess_1198,=None,SP_1199: bitstring,UP_1200: bitstring));
                                                            {860}new Nc_1201: bitstring;
                                                            {861}let gNc_1202: bitstring = exp(g,Nc_1201) in
                                                            {862}let m1_1203: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1202) in
                                                            {863}event beginCli(Cli,Sess,gNc_1202);
                                                            {864}out(c, (pkCli_1077,m1_1203));
                                                            {865}in(c, em2_1204: bitstring);
                                                            {866}let m2_1205: bitstring = em2_1204 in
                                                            {867}let (=OpenSecureChannelResponse,=Cli,PartS_1206: bitstring,ST_1207: bitstring,TTL_1208: bitstring) = m2_1205 in
                                                            {868}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {869}event endCli(Sess,Cli,PartS_1206)
                                                    )
                                                    else
                                                        {870}let pkSess_1209: bitstring = fail-any in
                                                        {871}out(c, GetEndpointRequest);
                                                        {872}in(c, (=GetEndpointResponse,=pkSess_1209,=None,SP_1210: bitstring,UP_1211: bitstring));
                                                        {873}new Nc_1212: bitstring;
                                                        {874}let gNc_1213: bitstring = exp(g,Nc_1212) in
                                                        {875}let m1_1214: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1213) in
                                                        {876}event beginCli(Cli,Sess,gNc_1213);
                                                        {877}out(c, (pkCli_1077,m1_1214));
                                                        {878}in(c, em2_1215: bitstring);
                                                        {879}let m2_1216: bitstring = em2_1215 in
                                                        {880}let (=OpenSecureChannelResponse,=Cli,PartS_1217: bitstring,ST_1218: bitstring,TTL_1219: bitstring) = m2_1216 in
                                                        {881}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {882}event endCli(Sess,Cli,PartS_1217)
                                            )
                                            else
                                                {883}let pkSess_1220: bitstring = fail-any in
                                                {884}out(c, GetEndpointRequest);
                                                {885}in(c, (=GetEndpointResponse,=pkSess_1220,=None,SP_1221: bitstring,UP_1222: bitstring));
                                                {886}new Nc_1223: bitstring;
                                                {887}let gNc_1224: bitstring = exp(g,Nc_1223) in
                                                {888}let m1_1225: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1224) in
                                                {889}event beginCli(Cli,Sess,gNc_1224);
                                                {890}out(c, (pkCli_1077,m1_1225));
                                                {891}in(c, em2_1226: bitstring);
                                                {892}let m2_1227: bitstring = em2_1226 in
                                                {893}let (=OpenSecureChannelResponse,=Cli,PartS_1228: bitstring,ST_1229: bitstring,TTL_1230: bitstring) = m2_1227 in
                                                {894}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {895}event endCli(Sess,Cli,PartS_1228)
                                    )
                                    else
                                        {896}let pkSess_1231: bitstring = fail-any in
                                        {897}out(c, GetEndpointRequest);
                                        {898}in(c, (=GetEndpointResponse,=pkSess_1231,=None,SP_1232: bitstring,UP_1233: bitstring));
                                        {899}new Nc_1234: bitstring;
                                        {900}let gNc_1235: bitstring = exp(g,Nc_1234) in
                                        {901}let m1_1236: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1235) in
                                        {902}event beginCli(Cli,Sess,gNc_1235);
                                        {903}out(c, (pkCli_1077,m1_1236));
                                        {904}in(c, em2_1237: bitstring);
                                        {905}let m2_1238: bitstring = em2_1237 in
                                        {906}let (=OpenSecureChannelResponse,=Cli,PartS_1239: bitstring,ST_1240: bitstring,TTL_1241: bitstring) = m2_1238 in
                                        {907}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {908}event endCli(Sess,Cli,PartS_1239)
                                )
                                else
                                    {909}let v_1242: bool = (Disco = C) in
                                    (
                                        {910}if v_1242 then
                                        (
                                            {911}let pkDisco_1243: bitstring = pub(skC) in
                                            {912}let v_1244: bool = (Sess = A) in
                                            (
                                                {913}if v_1244 then
                                                (
                                                    {914}let pkSess_1245: bitstring = pub(skA) in
                                                    {915}out(c, GetEndpointRequest);
                                                    {916}in(c, (=GetEndpointResponse,=pkSess_1245,=None,SP_1246: bitstring,UP_1247: bitstring));
                                                    {917}new Nc_1248: bitstring;
                                                    {918}let gNc_1249: bitstring = exp(g,Nc_1248) in
                                                    {919}let m1_1250: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1249) in
                                                    {920}event beginCli(Cli,Sess,gNc_1249);
                                                    {921}out(c, (pkCli_1077,m1_1250));
                                                    {922}in(c, em2_1251: bitstring);
                                                    {923}let m2_1252: bitstring = em2_1251 in
                                                    {924}let (=OpenSecureChannelResponse,=Cli,PartS_1253: bitstring,ST_1254: bitstring,TTL_1255: bitstring) = m2_1252 in
                                                    {925}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {926}event endCli(Sess,Cli,PartS_1253)
                                                )
                                                else
                                                    {927}let v_1256: bool = (Sess = B) in
                                                    (
                                                        {928}if v_1256 then
                                                        (
                                                            {929}let pkSess_1257: bitstring = pub(skB) in
                                                            {930}out(c, GetEndpointRequest);
                                                            {931}in(c, (=GetEndpointResponse,=pkSess_1257,=None,SP_1258: bitstring,UP_1259: bitstring));
                                                            {932}new Nc_1260: bitstring;
                                                            {933}let gNc_1261: bitstring = exp(g,Nc_1260) in
                                                            {934}let m1_1262: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1261) in
                                                            {935}event beginCli(Cli,Sess,gNc_1261);
                                                            {936}out(c, (pkCli_1077,m1_1262));
                                                            {937}in(c, em2_1263: bitstring);
                                                            {938}let m2_1264: bitstring = em2_1263 in
                                                            {939}let (=OpenSecureChannelResponse,=Cli,PartS_1265: bitstring,ST_1266: bitstring,TTL_1267: bitstring) = m2_1264 in
                                                            {940}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {941}event endCli(Sess,Cli,PartS_1265)
                                                        )
                                                        else
                                                            {942}let v_1268: bool = (Sess = C) in
                                                            (
                                                                {943}if v_1268 then
                                                                (
                                                                    {944}let pkSess_1269: bitstring = pub(skC) in
                                                                    {945}out(c, GetEndpointRequest);
                                                                    {946}in(c, (=GetEndpointResponse,=pkSess_1269,=None,SP_1270: bitstring,UP_1271: bitstring));
                                                                    {947}new Nc_1272: bitstring;
                                                                    {948}let gNc_1273: bitstring = exp(g,Nc_1272) in
                                                                    {949}let m1_1274: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1273) in
                                                                    {950}event beginCli(Cli,Sess,gNc_1273);
                                                                    {951}out(c, (pkCli_1077,m1_1274));
                                                                    {952}in(c, em2_1275: bitstring);
                                                                    {953}let m2_1276: bitstring = em2_1275 in
                                                                    {954}let (=OpenSecureChannelResponse,=Cli,PartS_1277: bitstring,ST_1278: bitstring,TTL_1279: bitstring) = m2_1276 in
                                                                    {955}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {956}event endCli(Sess,Cli,PartS_1277)
                                                                )
                                                                else
                                                                    {957}let pkSess_1280: bitstring = pub(sk(Sess)) in
                                                                    {958}out(c, GetEndpointRequest);
                                                                    {959}in(c, (=GetEndpointResponse,=pkSess_1280,=None,SP_1281: bitstring,UP_1282: bitstring));
                                                                    {960}new Nc_1283: bitstring;
                                                                    {961}let gNc_1284: bitstring = exp(g,Nc_1283) in
                                                                    {962}let m1_1285: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1284) in
                                                                    {963}event beginCli(Cli,Sess,gNc_1284);
                                                                    {964}out(c, (pkCli_1077,m1_1285));
                                                                    {965}in(c, em2_1286: bitstring);
                                                                    {966}let m2_1287: bitstring = em2_1286 in
                                                                    {967}let (=OpenSecureChannelResponse,=Cli,PartS_1288: bitstring,ST_1289: bitstring,TTL_1290: bitstring) = m2_1287 in
                                                                    {968}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {969}event endCli(Sess,Cli,PartS_1288)
                                                            )
                                                            else
                                                                {970}let pkSess_1291: bitstring = fail-any in
                                                                {971}out(c, GetEndpointRequest);
                                                                {972}in(c, (=GetEndpointResponse,=pkSess_1291,=None,SP_1292: bitstring,UP_1293: bitstring));
                                                                {973}new Nc_1294: bitstring;
                                                                {974}let gNc_1295: bitstring = exp(g,Nc_1294) in
                                                                {975}let m1_1296: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1295) in
                                                                {976}event beginCli(Cli,Sess,gNc_1295);
                                                                {977}out(c, (pkCli_1077,m1_1296));
                                                                {978}in(c, em2_1297: bitstring);
                                                                {979}let m2_1298: bitstring = em2_1297 in
                                                                {980}let (=OpenSecureChannelResponse,=Cli,PartS_1299: bitstring,ST_1300: bitstring,TTL_1301: bitstring) = m2_1298 in
                                                                {981}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {982}event endCli(Sess,Cli,PartS_1299)
                                                    )
                                                    else
                                                        {983}let pkSess_1302: bitstring = fail-any in
                                                        {984}out(c, GetEndpointRequest);
                                                        {985}in(c, (=GetEndpointResponse,=pkSess_1302,=None,SP_1303: bitstring,UP_1304: bitstring));
                                                        {986}new Nc_1305: bitstring;
                                                        {987}let gNc_1306: bitstring = exp(g,Nc_1305) in
                                                        {988}let m1_1307: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1306) in
                                                        {989}event beginCli(Cli,Sess,gNc_1306);
                                                        {990}out(c, (pkCli_1077,m1_1307));
                                                        {991}in(c, em2_1308: bitstring);
                                                        {992}let m2_1309: bitstring = em2_1308 in
                                                        {993}let (=OpenSecureChannelResponse,=Cli,PartS_1310: bitstring,ST_1311: bitstring,TTL_1312: bitstring) = m2_1309 in
                                                        {994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {995}event endCli(Sess,Cli,PartS_1310)
                                            )
                                            else
                                                {996}let pkSess_1313: bitstring = fail-any in
                                                {997}out(c, GetEndpointRequest);
                                                {998}in(c, (=GetEndpointResponse,=pkSess_1313,=None,SP_1314: bitstring,UP_1315: bitstring));
                                                {999}new Nc_1316: bitstring;
                                                {1000}let gNc_1317: bitstring = exp(g,Nc_1316) in
                                                {1001}let m1_1318: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1317) in
                                                {1002}event beginCli(Cli,Sess,gNc_1317);
                                                {1003}out(c, (pkCli_1077,m1_1318));
                                                {1004}in(c, em2_1319: bitstring);
                                                {1005}let m2_1320: bitstring = em2_1319 in
                                                {1006}let (=OpenSecureChannelResponse,=Cli,PartS_1321: bitstring,ST_1322: bitstring,TTL_1323: bitstring) = m2_1320 in
                                                {1007}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1008}event endCli(Sess,Cli,PartS_1321)
                                        )
                                        else
                                            {1009}let pkDisco_1324: bitstring = pub(sk(Disco)) in
                                            {1010}let v_1325: bool = (Sess = A) in
                                            (
                                                {1011}if v_1325 then
                                                (
                                                    {1012}let pkSess_1326: bitstring = pub(skA) in
                                                    {1013}out(c, GetEndpointRequest);
                                                    {1014}in(c, (=GetEndpointResponse,=pkSess_1326,=None,SP_1327: bitstring,UP_1328: bitstring));
                                                    {1015}new Nc_1329: bitstring;
                                                    {1016}let gNc_1330: bitstring = exp(g,Nc_1329) in
                                                    {1017}let m1_1331: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1330) in
                                                    {1018}event beginCli(Cli,Sess,gNc_1330);
                                                    {1019}out(c, (pkCli_1077,m1_1331));
                                                    {1020}in(c, em2_1332: bitstring);
                                                    {1021}let m2_1333: bitstring = em2_1332 in
                                                    {1022}let (=OpenSecureChannelResponse,=Cli,PartS_1334: bitstring,ST_1335: bitstring,TTL_1336: bitstring) = m2_1333 in
                                                    {1023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1024}event endCli(Sess,Cli,PartS_1334)
                                                )
                                                else
                                                    {1025}let v_1337: bool = (Sess = B) in
                                                    (
                                                        {1026}if v_1337 then
                                                        (
                                                            {1027}let pkSess_1338: bitstring = pub(skB) in
                                                            {1028}out(c, GetEndpointRequest);
                                                            {1029}in(c, (=GetEndpointResponse,=pkSess_1338,=None,SP_1339: bitstring,UP_1340: bitstring));
                                                            {1030}new Nc_1341: bitstring;
                                                            {1031}let gNc_1342: bitstring = exp(g,Nc_1341) in
                                                            {1032}let m1_1343: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1342) in
                                                            {1033}event beginCli(Cli,Sess,gNc_1342);
                                                            {1034}out(c, (pkCli_1077,m1_1343));
                                                            {1035}in(c, em2_1344: bitstring);
                                                            {1036}let m2_1345: bitstring = em2_1344 in
                                                            {1037}let (=OpenSecureChannelResponse,=Cli,PartS_1346: bitstring,ST_1347: bitstring,TTL_1348: bitstring) = m2_1345 in
                                                            {1038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1039}event endCli(Sess,Cli,PartS_1346)
                                                        )
                                                        else
                                                            {1040}let v_1349: bool = (Sess = C) in
                                                            (
                                                                {1041}if v_1349 then
                                                                (
                                                                    {1042}let pkSess_1350: bitstring = pub(skC) in
                                                                    {1043}out(c, GetEndpointRequest);
                                                                    {1044}in(c, (=GetEndpointResponse,=pkSess_1350,=None,SP_1351: bitstring,UP_1352: bitstring));
                                                                    {1045}new Nc_1353: bitstring;
                                                                    {1046}let gNc_1354: bitstring = exp(g,Nc_1353) in
                                                                    {1047}let m1_1355: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1354) in
                                                                    {1048}event beginCli(Cli,Sess,gNc_1354);
                                                                    {1049}out(c, (pkCli_1077,m1_1355));
                                                                    {1050}in(c, em2_1356: bitstring);
                                                                    {1051}let m2_1357: bitstring = em2_1356 in
                                                                    {1052}let (=OpenSecureChannelResponse,=Cli,PartS_1358: bitstring,ST_1359: bitstring,TTL_1360: bitstring) = m2_1357 in
                                                                    {1053}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1054}event endCli(Sess,Cli,PartS_1358)
                                                                )
                                                                else
                                                                    {1055}let pkSess_1361: bitstring = pub(sk(Sess)) in
                                                                    {1056}out(c, GetEndpointRequest);
                                                                    {1057}in(c, (=GetEndpointResponse,=pkSess_1361,=None,SP_1362: bitstring,UP_1363: bitstring));
                                                                    {1058}new Nc_1364: bitstring;
                                                                    {1059}let gNc_1365: bitstring = exp(g,Nc_1364) in
                                                                    {1060}let m1_1366: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1365) in
                                                                    {1061}event beginCli(Cli,Sess,gNc_1365);
                                                                    {1062}out(c, (pkCli_1077,m1_1366));
                                                                    {1063}in(c, em2_1367: bitstring);
                                                                    {1064}let m2_1368: bitstring = em2_1367 in
                                                                    {1065}let (=OpenSecureChannelResponse,=Cli,PartS_1369: bitstring,ST_1370: bitstring,TTL_1371: bitstring) = m2_1368 in
                                                                    {1066}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1067}event endCli(Sess,Cli,PartS_1369)
                                                            )
                                                            else
                                                                {1068}let pkSess_1372: bitstring = fail-any in
                                                                {1069}out(c, GetEndpointRequest);
                                                                {1070}in(c, (=GetEndpointResponse,=pkSess_1372,=None,SP_1373: bitstring,UP_1374: bitstring));
                                                                {1071}new Nc_1375: bitstring;
                                                                {1072}let gNc_1376: bitstring = exp(g,Nc_1375) in
                                                                {1073}let m1_1377: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1376) in
                                                                {1074}event beginCli(Cli,Sess,gNc_1376);
                                                                {1075}out(c, (pkCli_1077,m1_1377));
                                                                {1076}in(c, em2_1378: bitstring);
                                                                {1077}let m2_1379: bitstring = em2_1378 in
                                                                {1078}let (=OpenSecureChannelResponse,=Cli,PartS_1380: bitstring,ST_1381: bitstring,TTL_1382: bitstring) = m2_1379 in
                                                                {1079}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1080}event endCli(Sess,Cli,PartS_1380)
                                                    )
                                                    else
                                                        {1081}let pkSess_1383: bitstring = fail-any in
                                                        {1082}out(c, GetEndpointRequest);
                                                        {1083}in(c, (=GetEndpointResponse,=pkSess_1383,=None,SP_1384: bitstring,UP_1385: bitstring));
                                                        {1084}new Nc_1386: bitstring;
                                                        {1085}let gNc_1387: bitstring = exp(g,Nc_1386) in
                                                        {1086}let m1_1388: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1387) in
                                                        {1087}event beginCli(Cli,Sess,gNc_1387);
                                                        {1088}out(c, (pkCli_1077,m1_1388));
                                                        {1089}in(c, em2_1389: bitstring);
                                                        {1090}let m2_1390: bitstring = em2_1389 in
                                                        {1091}let (=OpenSecureChannelResponse,=Cli,PartS_1391: bitstring,ST_1392: bitstring,TTL_1393: bitstring) = m2_1390 in
                                                        {1092}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1093}event endCli(Sess,Cli,PartS_1391)
                                            )
                                            else
                                                {1094}let pkSess_1394: bitstring = fail-any in
                                                {1095}out(c, GetEndpointRequest);
                                                {1096}in(c, (=GetEndpointResponse,=pkSess_1394,=None,SP_1395: bitstring,UP_1396: bitstring));
                                                {1097}new Nc_1397: bitstring;
                                                {1098}let gNc_1398: bitstring = exp(g,Nc_1397) in
                                                {1099}let m1_1399: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1398) in
                                                {1100}event beginCli(Cli,Sess,gNc_1398);
                                                {1101}out(c, (pkCli_1077,m1_1399));
                                                {1102}in(c, em2_1400: bitstring);
                                                {1103}let m2_1401: bitstring = em2_1400 in
                                                {1104}let (=OpenSecureChannelResponse,=Cli,PartS_1402: bitstring,ST_1403: bitstring,TTL_1404: bitstring) = m2_1401 in
                                                {1105}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1106}event endCli(Sess,Cli,PartS_1402)
                                    )
                                    else
                                        {1107}let pkDisco_1405: bitstring = fail-any in
                                        {1108}let v_1406: bool = (Sess = A) in
                                        (
                                            {1109}if v_1406 then
                                            (
                                                {1110}let pkSess_1407: bitstring = pub(skA) in
                                                {1111}out(c, GetEndpointRequest);
                                                {1112}in(c, (=GetEndpointResponse,=pkSess_1407,=None,SP_1408: bitstring,UP_1409: bitstring));
                                                {1113}new Nc_1410: bitstring;
                                                {1114}let gNc_1411: bitstring = exp(g,Nc_1410) in
                                                {1115}let m1_1412: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1411) in
                                                {1116}event beginCli(Cli,Sess,gNc_1411);
                                                {1117}out(c, (pkCli_1077,m1_1412));
                                                {1118}in(c, em2_1413: bitstring);
                                                {1119}let m2_1414: bitstring = em2_1413 in
                                                {1120}let (=OpenSecureChannelResponse,=Cli,PartS_1415: bitstring,ST_1416: bitstring,TTL_1417: bitstring) = m2_1414 in
                                                {1121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1122}event endCli(Sess,Cli,PartS_1415)
                                            )
                                            else
                                                {1123}let v_1418: bool = (Sess = B) in
                                                (
                                                    {1124}if v_1418 then
                                                    (
                                                        {1125}let pkSess_1419: bitstring = pub(skB) in
                                                        {1126}out(c, GetEndpointRequest);
                                                        {1127}in(c, (=GetEndpointResponse,=pkSess_1419,=None,SP_1420: bitstring,UP_1421: bitstring));
                                                        {1128}new Nc_1422: bitstring;
                                                        {1129}let gNc_1423: bitstring = exp(g,Nc_1422) in
                                                        {1130}let m1_1424: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1423) in
                                                        {1131}event beginCli(Cli,Sess,gNc_1423);
                                                        {1132}out(c, (pkCli_1077,m1_1424));
                                                        {1133}in(c, em2_1425: bitstring);
                                                        {1134}let m2_1426: bitstring = em2_1425 in
                                                        {1135}let (=OpenSecureChannelResponse,=Cli,PartS_1427: bitstring,ST_1428: bitstring,TTL_1429: bitstring) = m2_1426 in
                                                        {1136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1137}event endCli(Sess,Cli,PartS_1427)
                                                    )
                                                    else
                                                        {1138}let v_1430: bool = (Sess = C) in
                                                        (
                                                            {1139}if v_1430 then
                                                            (
                                                                {1140}let pkSess_1431: bitstring = pub(skC) in
                                                                {1141}out(c, GetEndpointRequest);
                                                                {1142}in(c, (=GetEndpointResponse,=pkSess_1431,=None,SP_1432: bitstring,UP_1433: bitstring));
                                                                {1143}new Nc_1434: bitstring;
                                                                {1144}let gNc_1435: bitstring = exp(g,Nc_1434) in
                                                                {1145}let m1_1436: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1435) in
                                                                {1146}event beginCli(Cli,Sess,gNc_1435);
                                                                {1147}out(c, (pkCli_1077,m1_1436));
                                                                {1148}in(c, em2_1437: bitstring);
                                                                {1149}let m2_1438: bitstring = em2_1437 in
                                                                {1150}let (=OpenSecureChannelResponse,=Cli,PartS_1439: bitstring,ST_1440: bitstring,TTL_1441: bitstring) = m2_1438 in
                                                                {1151}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1152}event endCli(Sess,Cli,PartS_1439)
                                                            )
                                                            else
                                                                {1153}let pkSess_1442: bitstring = pub(sk(Sess)) in
                                                                {1154}out(c, GetEndpointRequest);
                                                                {1155}in(c, (=GetEndpointResponse,=pkSess_1442,=None,SP_1443: bitstring,UP_1444: bitstring));
                                                                {1156}new Nc_1445: bitstring;
                                                                {1157}let gNc_1446: bitstring = exp(g,Nc_1445) in
                                                                {1158}let m1_1447: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1446) in
                                                                {1159}event beginCli(Cli,Sess,gNc_1446);
                                                                {1160}out(c, (pkCli_1077,m1_1447));
                                                                {1161}in(c, em2_1448: bitstring);
                                                                {1162}let m2_1449: bitstring = em2_1448 in
                                                                {1163}let (=OpenSecureChannelResponse,=Cli,PartS_1450: bitstring,ST_1451: bitstring,TTL_1452: bitstring) = m2_1449 in
                                                                {1164}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1165}event endCli(Sess,Cli,PartS_1450)
                                                        )
                                                        else
                                                            {1166}let pkSess_1453: bitstring = fail-any in
                                                            {1167}out(c, GetEndpointRequest);
                                                            {1168}in(c, (=GetEndpointResponse,=pkSess_1453,=None,SP_1454: bitstring,UP_1455: bitstring));
                                                            {1169}new Nc_1456: bitstring;
                                                            {1170}let gNc_1457: bitstring = exp(g,Nc_1456) in
                                                            {1171}let m1_1458: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1457) in
                                                            {1172}event beginCli(Cli,Sess,gNc_1457);
                                                            {1173}out(c, (pkCli_1077,m1_1458));
                                                            {1174}in(c, em2_1459: bitstring);
                                                            {1175}let m2_1460: bitstring = em2_1459 in
                                                            {1176}let (=OpenSecureChannelResponse,=Cli,PartS_1461: bitstring,ST_1462: bitstring,TTL_1463: bitstring) = m2_1460 in
                                                            {1177}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1178}event endCli(Sess,Cli,PartS_1461)
                                                )
                                                else
                                                    {1179}let pkSess_1464: bitstring = fail-any in
                                                    {1180}out(c, GetEndpointRequest);
                                                    {1181}in(c, (=GetEndpointResponse,=pkSess_1464,=None,SP_1465: bitstring,UP_1466: bitstring));
                                                    {1182}new Nc_1467: bitstring;
                                                    {1183}let gNc_1468: bitstring = exp(g,Nc_1467) in
                                                    {1184}let m1_1469: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1468) in
                                                    {1185}event beginCli(Cli,Sess,gNc_1468);
                                                    {1186}out(c, (pkCli_1077,m1_1469));
                                                    {1187}in(c, em2_1470: bitstring);
                                                    {1188}let m2_1471: bitstring = em2_1470 in
                                                    {1189}let (=OpenSecureChannelResponse,=Cli,PartS_1472: bitstring,ST_1473: bitstring,TTL_1474: bitstring) = m2_1471 in
                                                    {1190}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1191}event endCli(Sess,Cli,PartS_1472)
                                        )
                                        else
                                            {1192}let pkSess_1475: bitstring = fail-any in
                                            {1193}out(c, GetEndpointRequest);
                                            {1194}in(c, (=GetEndpointResponse,=pkSess_1475,=None,SP_1476: bitstring,UP_1477: bitstring));
                                            {1195}new Nc_1478: bitstring;
                                            {1196}let gNc_1479: bitstring = exp(g,Nc_1478) in
                                            {1197}let m1_1480: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1479) in
                                            {1198}event beginCli(Cli,Sess,gNc_1479);
                                            {1199}out(c, (pkCli_1077,m1_1480));
                                            {1200}in(c, em2_1481: bitstring);
                                            {1201}let m2_1482: bitstring = em2_1481 in
                                            {1202}let (=OpenSecureChannelResponse,=Cli,PartS_1483: bitstring,ST_1484: bitstring,TTL_1485: bitstring) = m2_1482 in
                                            {1203}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1204}event endCli(Sess,Cli,PartS_1483)
                            )
                            else
                                {1205}let pkDisco_1486: bitstring = fail-any in
                                {1206}let v_1487: bool = (Sess = A) in
                                (
                                    {1207}if v_1487 then
                                    (
                                        {1208}let pkSess_1488: bitstring = pub(skA) in
                                        {1209}out(c, GetEndpointRequest);
                                        {1210}in(c, (=GetEndpointResponse,=pkSess_1488,=None,SP_1489: bitstring,UP_1490: bitstring));
                                        {1211}new Nc_1491: bitstring;
                                        {1212}let gNc_1492: bitstring = exp(g,Nc_1491) in
                                        {1213}let m1_1493: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1492) in
                                        {1214}event beginCli(Cli,Sess,gNc_1492);
                                        {1215}out(c, (pkCli_1077,m1_1493));
                                        {1216}in(c, em2_1494: bitstring);
                                        {1217}let m2_1495: bitstring = em2_1494 in
                                        {1218}let (=OpenSecureChannelResponse,=Cli,PartS_1496: bitstring,ST_1497: bitstring,TTL_1498: bitstring) = m2_1495 in
                                        {1219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1220}event endCli(Sess,Cli,PartS_1496)
                                    )
                                    else
                                        {1221}let v_1499: bool = (Sess = B) in
                                        (
                                            {1222}if v_1499 then
                                            (
                                                {1223}let pkSess_1500: bitstring = pub(skB) in
                                                {1224}out(c, GetEndpointRequest);
                                                {1225}in(c, (=GetEndpointResponse,=pkSess_1500,=None,SP_1501: bitstring,UP_1502: bitstring));
                                                {1226}new Nc_1503: bitstring;
                                                {1227}let gNc_1504: bitstring = exp(g,Nc_1503) in
                                                {1228}let m1_1505: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1504) in
                                                {1229}event beginCli(Cli,Sess,gNc_1504);
                                                {1230}out(c, (pkCli_1077,m1_1505));
                                                {1231}in(c, em2_1506: bitstring);
                                                {1232}let m2_1507: bitstring = em2_1506 in
                                                {1233}let (=OpenSecureChannelResponse,=Cli,PartS_1508: bitstring,ST_1509: bitstring,TTL_1510: bitstring) = m2_1507 in
                                                {1234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1235}event endCli(Sess,Cli,PartS_1508)
                                            )
                                            else
                                                {1236}let v_1511: bool = (Sess = C) in
                                                (
                                                    {1237}if v_1511 then
                                                    (
                                                        {1238}let pkSess_1512: bitstring = pub(skC) in
                                                        {1239}out(c, GetEndpointRequest);
                                                        {1240}in(c, (=GetEndpointResponse,=pkSess_1512,=None,SP_1513: bitstring,UP_1514: bitstring));
                                                        {1241}new Nc_1515: bitstring;
                                                        {1242}let gNc_1516: bitstring = exp(g,Nc_1515) in
                                                        {1243}let m1_1517: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1516) in
                                                        {1244}event beginCli(Cli,Sess,gNc_1516);
                                                        {1245}out(c, (pkCli_1077,m1_1517));
                                                        {1246}in(c, em2_1518: bitstring);
                                                        {1247}let m2_1519: bitstring = em2_1518 in
                                                        {1248}let (=OpenSecureChannelResponse,=Cli,PartS_1520: bitstring,ST_1521: bitstring,TTL_1522: bitstring) = m2_1519 in
                                                        {1249}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1250}event endCli(Sess,Cli,PartS_1520)
                                                    )
                                                    else
                                                        {1251}let pkSess_1523: bitstring = pub(sk(Sess)) in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (=GetEndpointResponse,=pkSess_1523,=None,SP_1524: bitstring,UP_1525: bitstring));
                                                        {1254}new Nc_1526: bitstring;
                                                        {1255}let gNc_1527: bitstring = exp(g,Nc_1526) in
                                                        {1256}let m1_1528: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1527) in
                                                        {1257}event beginCli(Cli,Sess,gNc_1527);
                                                        {1258}out(c, (pkCli_1077,m1_1528));
                                                        {1259}in(c, em2_1529: bitstring);
                                                        {1260}let m2_1530: bitstring = em2_1529 in
                                                        {1261}let (=OpenSecureChannelResponse,=Cli,PartS_1531: bitstring,ST_1532: bitstring,TTL_1533: bitstring) = m2_1530 in
                                                        {1262}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1263}event endCli(Sess,Cli,PartS_1531)
                                                )
                                                else
                                                    {1264}let pkSess_1534: bitstring = fail-any in
                                                    {1265}out(c, GetEndpointRequest);
                                                    {1266}in(c, (=GetEndpointResponse,=pkSess_1534,=None,SP_1535: bitstring,UP_1536: bitstring));
                                                    {1267}new Nc_1537: bitstring;
                                                    {1268}let gNc_1538: bitstring = exp(g,Nc_1537) in
                                                    {1269}let m1_1539: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1538) in
                                                    {1270}event beginCli(Cli,Sess,gNc_1538);
                                                    {1271}out(c, (pkCli_1077,m1_1539));
                                                    {1272}in(c, em2_1540: bitstring);
                                                    {1273}let m2_1541: bitstring = em2_1540 in
                                                    {1274}let (=OpenSecureChannelResponse,=Cli,PartS_1542: bitstring,ST_1543: bitstring,TTL_1544: bitstring) = m2_1541 in
                                                    {1275}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1276}event endCli(Sess,Cli,PartS_1542)
                                        )
                                        else
                                            {1277}let pkSess_1545: bitstring = fail-any in
                                            {1278}out(c, GetEndpointRequest);
                                            {1279}in(c, (=GetEndpointResponse,=pkSess_1545,=None,SP_1546: bitstring,UP_1547: bitstring));
                                            {1280}new Nc_1548: bitstring;
                                            {1281}let gNc_1549: bitstring = exp(g,Nc_1548) in
                                            {1282}let m1_1550: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1549) in
                                            {1283}event beginCli(Cli,Sess,gNc_1549);
                                            {1284}out(c, (pkCli_1077,m1_1550));
                                            {1285}in(c, em2_1551: bitstring);
                                            {1286}let m2_1552: bitstring = em2_1551 in
                                            {1287}let (=OpenSecureChannelResponse,=Cli,PartS_1553: bitstring,ST_1554: bitstring,TTL_1555: bitstring) = m2_1552 in
                                            {1288}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1289}event endCli(Sess,Cli,PartS_1553)
                                )
                                else
                                    {1290}let pkSess_1556: bitstring = fail-any in
                                    {1291}out(c, GetEndpointRequest);
                                    {1292}in(c, (=GetEndpointResponse,=pkSess_1556,=None,SP_1557: bitstring,UP_1558: bitstring));
                                    {1293}new Nc_1559: bitstring;
                                    {1294}let gNc_1560: bitstring = exp(g,Nc_1559) in
                                    {1295}let m1_1561: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1560) in
                                    {1296}event beginCli(Cli,Sess,gNc_1560);
                                    {1297}out(c, (pkCli_1077,m1_1561));
                                    {1298}in(c, em2_1562: bitstring);
                                    {1299}let m2_1563: bitstring = em2_1562 in
                                    {1300}let (=OpenSecureChannelResponse,=Cli,PartS_1564: bitstring,ST_1565: bitstring,TTL_1566: bitstring) = m2_1563 in
                                    {1301}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1302}event endCli(Sess,Cli,PartS_1564)
                    )
                    else
                        {1303}let pkDisco_1567: bitstring = fail-any in
                        {1304}let v_1568: bool = (Sess = A) in
                        (
                            {1305}if v_1568 then
                            (
                                {1306}let pkSess_1569: bitstring = pub(skA) in
                                {1307}out(c, GetEndpointRequest);
                                {1308}in(c, (=GetEndpointResponse,=pkSess_1569,=None,SP_1570: bitstring,UP_1571: bitstring));
                                {1309}new Nc_1572: bitstring;
                                {1310}let gNc_1573: bitstring = exp(g,Nc_1572) in
                                {1311}let m1_1574: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1573) in
                                {1312}event beginCli(Cli,Sess,gNc_1573);
                                {1313}out(c, (pkCli_1077,m1_1574));
                                {1314}in(c, em2_1575: bitstring);
                                {1315}let m2_1576: bitstring = em2_1575 in
                                {1316}let (=OpenSecureChannelResponse,=Cli,PartS_1577: bitstring,ST_1578: bitstring,TTL_1579: bitstring) = m2_1576 in
                                {1317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1318}event endCli(Sess,Cli,PartS_1577)
                            )
                            else
                                {1319}let v_1580: bool = (Sess = B) in
                                (
                                    {1320}if v_1580 then
                                    (
                                        {1321}let pkSess_1581: bitstring = pub(skB) in
                                        {1322}out(c, GetEndpointRequest);
                                        {1323}in(c, (=GetEndpointResponse,=pkSess_1581,=None,SP_1582: bitstring,UP_1583: bitstring));
                                        {1324}new Nc_1584: bitstring;
                                        {1325}let gNc_1585: bitstring = exp(g,Nc_1584) in
                                        {1326}let m1_1586: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1585) in
                                        {1327}event beginCli(Cli,Sess,gNc_1585);
                                        {1328}out(c, (pkCli_1077,m1_1586));
                                        {1329}in(c, em2_1587: bitstring);
                                        {1330}let m2_1588: bitstring = em2_1587 in
                                        {1331}let (=OpenSecureChannelResponse,=Cli,PartS_1589: bitstring,ST_1590: bitstring,TTL_1591: bitstring) = m2_1588 in
                                        {1332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1333}event endCli(Sess,Cli,PartS_1589)
                                    )
                                    else
                                        {1334}let v_1592: bool = (Sess = C) in
                                        (
                                            {1335}if v_1592 then
                                            (
                                                {1336}let pkSess_1593: bitstring = pub(skC) in
                                                {1337}out(c, GetEndpointRequest);
                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1593,=None,SP_1594: bitstring,UP_1595: bitstring));
                                                {1339}new Nc_1596: bitstring;
                                                {1340}let gNc_1597: bitstring = exp(g,Nc_1596) in
                                                {1341}let m1_1598: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1597) in
                                                {1342}event beginCli(Cli,Sess,gNc_1597);
                                                {1343}out(c, (pkCli_1077,m1_1598));
                                                {1344}in(c, em2_1599: bitstring);
                                                {1345}let m2_1600: bitstring = em2_1599 in
                                                {1346}let (=OpenSecureChannelResponse,=Cli,PartS_1601: bitstring,ST_1602: bitstring,TTL_1603: bitstring) = m2_1600 in
                                                {1347}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1348}event endCli(Sess,Cli,PartS_1601)
                                            )
                                            else
                                                {1349}let pkSess_1604: bitstring = pub(sk(Sess)) in
                                                {1350}out(c, GetEndpointRequest);
                                                {1351}in(c, (=GetEndpointResponse,=pkSess_1604,=None,SP_1605: bitstring,UP_1606: bitstring));
                                                {1352}new Nc_1607: bitstring;
                                                {1353}let gNc_1608: bitstring = exp(g,Nc_1607) in
                                                {1354}let m1_1609: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1608) in
                                                {1355}event beginCli(Cli,Sess,gNc_1608);
                                                {1356}out(c, (pkCli_1077,m1_1609));
                                                {1357}in(c, em2_1610: bitstring);
                                                {1358}let m2_1611: bitstring = em2_1610 in
                                                {1359}let (=OpenSecureChannelResponse,=Cli,PartS_1612: bitstring,ST_1613: bitstring,TTL_1614: bitstring) = m2_1611 in
                                                {1360}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1361}event endCli(Sess,Cli,PartS_1612)
                                        )
                                        else
                                            {1362}let pkSess_1615: bitstring = fail-any in
                                            {1363}out(c, GetEndpointRequest);
                                            {1364}in(c, (=GetEndpointResponse,=pkSess_1615,=None,SP_1616: bitstring,UP_1617: bitstring));
                                            {1365}new Nc_1618: bitstring;
                                            {1366}let gNc_1619: bitstring = exp(g,Nc_1618) in
                                            {1367}let m1_1620: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1619) in
                                            {1368}event beginCli(Cli,Sess,gNc_1619);
                                            {1369}out(c, (pkCli_1077,m1_1620));
                                            {1370}in(c, em2_1621: bitstring);
                                            {1371}let m2_1622: bitstring = em2_1621 in
                                            {1372}let (=OpenSecureChannelResponse,=Cli,PartS_1623: bitstring,ST_1624: bitstring,TTL_1625: bitstring) = m2_1622 in
                                            {1373}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1374}event endCli(Sess,Cli,PartS_1623)
                                )
                                else
                                    {1375}let pkSess_1626: bitstring = fail-any in
                                    {1376}out(c, GetEndpointRequest);
                                    {1377}in(c, (=GetEndpointResponse,=pkSess_1626,=None,SP_1627: bitstring,UP_1628: bitstring));
                                    {1378}new Nc_1629: bitstring;
                                    {1379}let gNc_1630: bitstring = exp(g,Nc_1629) in
                                    {1380}let m1_1631: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1630) in
                                    {1381}event beginCli(Cli,Sess,gNc_1630);
                                    {1382}out(c, (pkCli_1077,m1_1631));
                                    {1383}in(c, em2_1632: bitstring);
                                    {1384}let m2_1633: bitstring = em2_1632 in
                                    {1385}let (=OpenSecureChannelResponse,=Cli,PartS_1634: bitstring,ST_1635: bitstring,TTL_1636: bitstring) = m2_1633 in
                                    {1386}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1387}event endCli(Sess,Cli,PartS_1634)
                        )
                        else
                            {1388}let pkSess_1637: bitstring = fail-any in
                            {1389}out(c, GetEndpointRequest);
                            {1390}in(c, (=GetEndpointResponse,=pkSess_1637,=None,SP_1638: bitstring,UP_1639: bitstring));
                            {1391}new Nc_1640: bitstring;
                            {1392}let gNc_1641: bitstring = exp(g,Nc_1640) in
                            {1393}let m1_1642: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1077,gNc_1641) in
                            {1394}event beginCli(Cli,Sess,gNc_1641);
                            {1395}out(c, (pkCli_1077,m1_1642));
                            {1396}in(c, em2_1643: bitstring);
                            {1397}let m2_1644: bitstring = em2_1643 in
                            {1398}let (=OpenSecureChannelResponse,=Cli,PartS_1645: bitstring,ST_1646: bitstring,TTL_1647: bitstring) = m2_1644 in
                            {1399}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {1400}event endCli(Sess,Cli,PartS_1645)
                )
                else
                    {1401}let =true = (Cli = C) in
                    (
                        {1402}let skCli_1648: bitstring = skC in
                        {1403}let pkCli_1649: bitstring = pub(skCli_1648) in
                        {1404}let v_1650: bool = (Disco = A) in
                        (
                            {1405}if v_1650 then
                            (
                                {1406}let pkDisco_1651: bitstring = pub(skA) in
                                {1407}let v_1652: bool = (Sess = A) in
                                (
                                    {1408}if v_1652 then
                                    (
                                        {1409}let pkSess_1653: bitstring = pub(skA) in
                                        {1410}out(c, GetEndpointRequest);
                                        {1411}in(c, (=GetEndpointResponse,=pkSess_1653,=None,SP_1654: bitstring,UP_1655: bitstring));
                                        {1412}new Nc_1656: bitstring;
                                        {1413}let gNc_1657: bitstring = exp(g,Nc_1656) in
                                        {1414}let m1_1658: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1657) in
                                        {1415}event beginCli(Cli,Sess,gNc_1657);
                                        {1416}out(c, (pkCli_1649,m1_1658));
                                        {1417}in(c, em2_1659: bitstring);
                                        {1418}let m2_1660: bitstring = em2_1659 in
                                        {1419}let (=OpenSecureChannelResponse,=Cli,PartS_1661: bitstring,ST_1662: bitstring,TTL_1663: bitstring) = m2_1660 in
                                        {1420}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1421}event endCli(Sess,Cli,PartS_1661)
                                    )
                                    else
                                        {1422}let v_1664: bool = (Sess = B) in
                                        (
                                            {1423}if v_1664 then
                                            (
                                                {1424}let pkSess_1665: bitstring = pub(skB) in
                                                {1425}out(c, GetEndpointRequest);
                                                {1426}in(c, (=GetEndpointResponse,=pkSess_1665,=None,SP_1666: bitstring,UP_1667: bitstring));
                                                {1427}new Nc_1668: bitstring;
                                                {1428}let gNc_1669: bitstring = exp(g,Nc_1668) in
                                                {1429}let m1_1670: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1669) in
                                                {1430}event beginCli(Cli,Sess,gNc_1669);
                                                {1431}out(c, (pkCli_1649,m1_1670));
                                                {1432}in(c, em2_1671: bitstring);
                                                {1433}let m2_1672: bitstring = em2_1671 in
                                                {1434}let (=OpenSecureChannelResponse,=Cli,PartS_1673: bitstring,ST_1674: bitstring,TTL_1675: bitstring) = m2_1672 in
                                                {1435}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1436}event endCli(Sess,Cli,PartS_1673)
                                            )
                                            else
                                                {1437}let v_1676: bool = (Sess = C) in
                                                (
                                                    {1438}if v_1676 then
                                                    (
                                                        {1439}let pkSess_1677: bitstring = pub(skC) in
                                                        {1440}out(c, GetEndpointRequest);
                                                        {1441}in(c, (=GetEndpointResponse,=pkSess_1677,=None,SP_1678: bitstring,UP_1679: bitstring));
                                                        {1442}new Nc_1680: bitstring;
                                                        {1443}let gNc_1681: bitstring = exp(g,Nc_1680) in
                                                        {1444}let m1_1682: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1681) in
                                                        {1445}event beginCli(Cli,Sess,gNc_1681);
                                                        {1446}out(c, (pkCli_1649,m1_1682));
                                                        {1447}in(c, em2_1683: bitstring);
                                                        {1448}let m2_1684: bitstring = em2_1683 in
                                                        {1449}let (=OpenSecureChannelResponse,=Cli,PartS_1685: bitstring,ST_1686: bitstring,TTL_1687: bitstring) = m2_1684 in
                                                        {1450}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1451}event endCli(Sess,Cli,PartS_1685)
                                                    )
                                                    else
                                                        {1452}let pkSess_1688: bitstring = pub(sk(Sess)) in
                                                        {1453}out(c, GetEndpointRequest);
                                                        {1454}in(c, (=GetEndpointResponse,=pkSess_1688,=None,SP_1689: bitstring,UP_1690: bitstring));
                                                        {1455}new Nc_1691: bitstring;
                                                        {1456}let gNc_1692: bitstring = exp(g,Nc_1691) in
                                                        {1457}let m1_1693: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1692) in
                                                        {1458}event beginCli(Cli,Sess,gNc_1692);
                                                        {1459}out(c, (pkCli_1649,m1_1693));
                                                        {1460}in(c, em2_1694: bitstring);
                                                        {1461}let m2_1695: bitstring = em2_1694 in
                                                        {1462}let (=OpenSecureChannelResponse,=Cli,PartS_1696: bitstring,ST_1697: bitstring,TTL_1698: bitstring) = m2_1695 in
                                                        {1463}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1464}event endCli(Sess,Cli,PartS_1696)
                                                )
                                                else
                                                    {1465}let pkSess_1699: bitstring = fail-any in
                                                    {1466}out(c, GetEndpointRequest);
                                                    {1467}in(c, (=GetEndpointResponse,=pkSess_1699,=None,SP_1700: bitstring,UP_1701: bitstring));
                                                    {1468}new Nc_1702: bitstring;
                                                    {1469}let gNc_1703: bitstring = exp(g,Nc_1702) in
                                                    {1470}let m1_1704: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1703) in
                                                    {1471}event beginCli(Cli,Sess,gNc_1703);
                                                    {1472}out(c, (pkCli_1649,m1_1704));
                                                    {1473}in(c, em2_1705: bitstring);
                                                    {1474}let m2_1706: bitstring = em2_1705 in
                                                    {1475}let (=OpenSecureChannelResponse,=Cli,PartS_1707: bitstring,ST_1708: bitstring,TTL_1709: bitstring) = m2_1706 in
                                                    {1476}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1477}event endCli(Sess,Cli,PartS_1707)
                                        )
                                        else
                                            {1478}let pkSess_1710: bitstring = fail-any in
                                            {1479}out(c, GetEndpointRequest);
                                            {1480}in(c, (=GetEndpointResponse,=pkSess_1710,=None,SP_1711: bitstring,UP_1712: bitstring));
                                            {1481}new Nc_1713: bitstring;
                                            {1482}let gNc_1714: bitstring = exp(g,Nc_1713) in
                                            {1483}let m1_1715: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1714) in
                                            {1484}event beginCli(Cli,Sess,gNc_1714);
                                            {1485}out(c, (pkCli_1649,m1_1715));
                                            {1486}in(c, em2_1716: bitstring);
                                            {1487}let m2_1717: bitstring = em2_1716 in
                                            {1488}let (=OpenSecureChannelResponse,=Cli,PartS_1718: bitstring,ST_1719: bitstring,TTL_1720: bitstring) = m2_1717 in
                                            {1489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1490}event endCli(Sess,Cli,PartS_1718)
                                )
                                else
                                    {1491}let pkSess_1721: bitstring = fail-any in
                                    {1492}out(c, GetEndpointRequest);
                                    {1493}in(c, (=GetEndpointResponse,=pkSess_1721,=None,SP_1722: bitstring,UP_1723: bitstring));
                                    {1494}new Nc_1724: bitstring;
                                    {1495}let gNc_1725: bitstring = exp(g,Nc_1724) in
                                    {1496}let m1_1726: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1725) in
                                    {1497}event beginCli(Cli,Sess,gNc_1725);
                                    {1498}out(c, (pkCli_1649,m1_1726));
                                    {1499}in(c, em2_1727: bitstring);
                                    {1500}let m2_1728: bitstring = em2_1727 in
                                    {1501}let (=OpenSecureChannelResponse,=Cli,PartS_1729: bitstring,ST_1730: bitstring,TTL_1731: bitstring) = m2_1728 in
                                    {1502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1503}event endCli(Sess,Cli,PartS_1729)
                            )
                            else
                                {1504}let v_1732: bool = (Disco = B) in
                                (
                                    {1505}if v_1732 then
                                    (
                                        {1506}let pkDisco_1733: bitstring = pub(skB) in
                                        {1507}let v_1734: bool = (Sess = A) in
                                        (
                                            {1508}if v_1734 then
                                            (
                                                {1509}let pkSess_1735: bitstring = pub(skA) in
                                                {1510}out(c, GetEndpointRequest);
                                                {1511}in(c, (=GetEndpointResponse,=pkSess_1735,=None,SP_1736: bitstring,UP_1737: bitstring));
                                                {1512}new Nc_1738: bitstring;
                                                {1513}let gNc_1739: bitstring = exp(g,Nc_1738) in
                                                {1514}let m1_1740: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1739) in
                                                {1515}event beginCli(Cli,Sess,gNc_1739);
                                                {1516}out(c, (pkCli_1649,m1_1740));
                                                {1517}in(c, em2_1741: bitstring);
                                                {1518}let m2_1742: bitstring = em2_1741 in
                                                {1519}let (=OpenSecureChannelResponse,=Cli,PartS_1743: bitstring,ST_1744: bitstring,TTL_1745: bitstring) = m2_1742 in
                                                {1520}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1521}event endCli(Sess,Cli,PartS_1743)
                                            )
                                            else
                                                {1522}let v_1746: bool = (Sess = B) in
                                                (
                                                    {1523}if v_1746 then
                                                    (
                                                        {1524}let pkSess_1747: bitstring = pub(skB) in
                                                        {1525}out(c, GetEndpointRequest);
                                                        {1526}in(c, (=GetEndpointResponse,=pkSess_1747,=None,SP_1748: bitstring,UP_1749: bitstring));
                                                        {1527}new Nc_1750: bitstring;
                                                        {1528}let gNc_1751: bitstring = exp(g,Nc_1750) in
                                                        {1529}let m1_1752: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1751) in
                                                        {1530}event beginCli(Cli,Sess,gNc_1751);
                                                        {1531}out(c, (pkCli_1649,m1_1752));
                                                        {1532}in(c, em2_1753: bitstring);
                                                        {1533}let m2_1754: bitstring = em2_1753 in
                                                        {1534}let (=OpenSecureChannelResponse,=Cli,PartS_1755: bitstring,ST_1756: bitstring,TTL_1757: bitstring) = m2_1754 in
                                                        {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1536}event endCli(Sess,Cli,PartS_1755)
                                                    )
                                                    else
                                                        {1537}let v_1758: bool = (Sess = C) in
                                                        (
                                                            {1538}if v_1758 then
                                                            (
                                                                {1539}let pkSess_1759: bitstring = pub(skC) in
                                                                {1540}out(c, GetEndpointRequest);
                                                                {1541}in(c, (=GetEndpointResponse,=pkSess_1759,=None,SP_1760: bitstring,UP_1761: bitstring));
                                                                {1542}new Nc_1762: bitstring;
                                                                {1543}let gNc_1763: bitstring = exp(g,Nc_1762) in
                                                                {1544}let m1_1764: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1763) in
                                                                {1545}event beginCli(Cli,Sess,gNc_1763);
                                                                {1546}out(c, (pkCli_1649,m1_1764));
                                                                {1547}in(c, em2_1765: bitstring);
                                                                {1548}let m2_1766: bitstring = em2_1765 in
                                                                {1549}let (=OpenSecureChannelResponse,=Cli,PartS_1767: bitstring,ST_1768: bitstring,TTL_1769: bitstring) = m2_1766 in
                                                                {1550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1551}event endCli(Sess,Cli,PartS_1767)
                                                            )
                                                            else
                                                                {1552}let pkSess_1770: bitstring = pub(sk(Sess)) in
                                                                {1553}out(c, GetEndpointRequest);
                                                                {1554}in(c, (=GetEndpointResponse,=pkSess_1770,=None,SP_1771: bitstring,UP_1772: bitstring));
                                                                {1555}new Nc_1773: bitstring;
                                                                {1556}let gNc_1774: bitstring = exp(g,Nc_1773) in
                                                                {1557}let m1_1775: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1774) in
                                                                {1558}event beginCli(Cli,Sess,gNc_1774);
                                                                {1559}out(c, (pkCli_1649,m1_1775));
                                                                {1560}in(c, em2_1776: bitstring);
                                                                {1561}let m2_1777: bitstring = em2_1776 in
                                                                {1562}let (=OpenSecureChannelResponse,=Cli,PartS_1778: bitstring,ST_1779: bitstring,TTL_1780: bitstring) = m2_1777 in
                                                                {1563}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1564}event endCli(Sess,Cli,PartS_1778)
                                                        )
                                                        else
                                                            {1565}let pkSess_1781: bitstring = fail-any in
                                                            {1566}out(c, GetEndpointRequest);
                                                            {1567}in(c, (=GetEndpointResponse,=pkSess_1781,=None,SP_1782: bitstring,UP_1783: bitstring));
                                                            {1568}new Nc_1784: bitstring;
                                                            {1569}let gNc_1785: bitstring = exp(g,Nc_1784) in
                                                            {1570}let m1_1786: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1785) in
                                                            {1571}event beginCli(Cli,Sess,gNc_1785);
                                                            {1572}out(c, (pkCli_1649,m1_1786));
                                                            {1573}in(c, em2_1787: bitstring);
                                                            {1574}let m2_1788: bitstring = em2_1787 in
                                                            {1575}let (=OpenSecureChannelResponse,=Cli,PartS_1789: bitstring,ST_1790: bitstring,TTL_1791: bitstring) = m2_1788 in
                                                            {1576}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1577}event endCli(Sess,Cli,PartS_1789)
                                                )
                                                else
                                                    {1578}let pkSess_1792: bitstring = fail-any in
                                                    {1579}out(c, GetEndpointRequest);
                                                    {1580}in(c, (=GetEndpointResponse,=pkSess_1792,=None,SP_1793: bitstring,UP_1794: bitstring));
                                                    {1581}new Nc_1795: bitstring;
                                                    {1582}let gNc_1796: bitstring = exp(g,Nc_1795) in
                                                    {1583}let m1_1797: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1796) in
                                                    {1584}event beginCli(Cli,Sess,gNc_1796);
                                                    {1585}out(c, (pkCli_1649,m1_1797));
                                                    {1586}in(c, em2_1798: bitstring);
                                                    {1587}let m2_1799: bitstring = em2_1798 in
                                                    {1588}let (=OpenSecureChannelResponse,=Cli,PartS_1800: bitstring,ST_1801: bitstring,TTL_1802: bitstring) = m2_1799 in
                                                    {1589}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1590}event endCli(Sess,Cli,PartS_1800)
                                        )
                                        else
                                            {1591}let pkSess_1803: bitstring = fail-any in
                                            {1592}out(c, GetEndpointRequest);
                                            {1593}in(c, (=GetEndpointResponse,=pkSess_1803,=None,SP_1804: bitstring,UP_1805: bitstring));
                                            {1594}new Nc_1806: bitstring;
                                            {1595}let gNc_1807: bitstring = exp(g,Nc_1806) in
                                            {1596}let m1_1808: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1807) in
                                            {1597}event beginCli(Cli,Sess,gNc_1807);
                                            {1598}out(c, (pkCli_1649,m1_1808));
                                            {1599}in(c, em2_1809: bitstring);
                                            {1600}let m2_1810: bitstring = em2_1809 in
                                            {1601}let (=OpenSecureChannelResponse,=Cli,PartS_1811: bitstring,ST_1812: bitstring,TTL_1813: bitstring) = m2_1810 in
                                            {1602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1603}event endCli(Sess,Cli,PartS_1811)
                                    )
                                    else
                                        {1604}let v_1814: bool = (Disco = C) in
                                        (
                                            {1605}if v_1814 then
                                            (
                                                {1606}let pkDisco_1815: bitstring = pub(skC) in
                                                {1607}let v_1816: bool = (Sess = A) in
                                                (
                                                    {1608}if v_1816 then
                                                    (
                                                        {1609}let pkSess_1817: bitstring = pub(skA) in
                                                        {1610}out(c, GetEndpointRequest);
                                                        {1611}in(c, (=GetEndpointResponse,=pkSess_1817,=None,SP_1818: bitstring,UP_1819: bitstring));
                                                        {1612}new Nc_1820: bitstring;
                                                        {1613}let gNc_1821: bitstring = exp(g,Nc_1820) in
                                                        {1614}let m1_1822: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1821) in
                                                        {1615}event beginCli(Cli,Sess,gNc_1821);
                                                        {1616}out(c, (pkCli_1649,m1_1822));
                                                        {1617}in(c, em2_1823: bitstring);
                                                        {1618}let m2_1824: bitstring = em2_1823 in
                                                        {1619}let (=OpenSecureChannelResponse,=Cli,PartS_1825: bitstring,ST_1826: bitstring,TTL_1827: bitstring) = m2_1824 in
                                                        {1620}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1621}event endCli(Sess,Cli,PartS_1825)
                                                    )
                                                    else
                                                        {1622}let v_1828: bool = (Sess = B) in
                                                        (
                                                            {1623}if v_1828 then
                                                            (
                                                                {1624}let pkSess_1829: bitstring = pub(skB) in
                                                                {1625}out(c, GetEndpointRequest);
                                                                {1626}in(c, (=GetEndpointResponse,=pkSess_1829,=None,SP_1830: bitstring,UP_1831: bitstring));
                                                                {1627}new Nc_1832: bitstring;
                                                                {1628}let gNc_1833: bitstring = exp(g,Nc_1832) in
                                                                {1629}let m1_1834: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1833) in
                                                                {1630}event beginCli(Cli,Sess,gNc_1833);
                                                                {1631}out(c, (pkCli_1649,m1_1834));
                                                                {1632}in(c, em2_1835: bitstring);
                                                                {1633}let m2_1836: bitstring = em2_1835 in
                                                                {1634}let (=OpenSecureChannelResponse,=Cli,PartS_1837: bitstring,ST_1838: bitstring,TTL_1839: bitstring) = m2_1836 in
                                                                {1635}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1636}event endCli(Sess,Cli,PartS_1837)
                                                            )
                                                            else
                                                                {1637}let v_1840: bool = (Sess = C) in
                                                                (
                                                                    {1638}if v_1840 then
                                                                    (
                                                                        {1639}let pkSess_1841: bitstring = pub(skC) in
                                                                        {1640}out(c, GetEndpointRequest);
                                                                        {1641}in(c, (=GetEndpointResponse,=pkSess_1841,=None,SP_1842: bitstring,UP_1843: bitstring));
                                                                        {1642}new Nc_1844: bitstring;
                                                                        {1643}let gNc_1845: bitstring = exp(g,Nc_1844) in
                                                                        {1644}let m1_1846: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1845) in
                                                                        {1645}event beginCli(Cli,Sess,gNc_1845);
                                                                        {1646}out(c, (pkCli_1649,m1_1846));
                                                                        {1647}in(c, em2_1847: bitstring);
                                                                        {1648}let m2_1848: bitstring = em2_1847 in
                                                                        {1649}let (=OpenSecureChannelResponse,=Cli,PartS_1849: bitstring,ST_1850: bitstring,TTL_1851: bitstring) = m2_1848 in
                                                                        {1650}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1651}event endCli(Sess,Cli,PartS_1849)
                                                                    )
                                                                    else
                                                                        {1652}let pkSess_1852: bitstring = pub(sk(Sess)) in
                                                                        {1653}out(c, GetEndpointRequest);
                                                                        {1654}in(c, (=GetEndpointResponse,=pkSess_1852,=None,SP_1853: bitstring,UP_1854: bitstring));
                                                                        {1655}new Nc_1855: bitstring;
                                                                        {1656}let gNc_1856: bitstring = exp(g,Nc_1855) in
                                                                        {1657}let m1_1857: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1856) in
                                                                        {1658}event beginCli(Cli,Sess,gNc_1856);
                                                                        {1659}out(c, (pkCli_1649,m1_1857));
                                                                        {1660}in(c, em2_1858: bitstring);
                                                                        {1661}let m2_1859: bitstring = em2_1858 in
                                                                        {1662}let (=OpenSecureChannelResponse,=Cli,PartS_1860: bitstring,ST_1861: bitstring,TTL_1862: bitstring) = m2_1859 in
                                                                        {1663}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1664}event endCli(Sess,Cli,PartS_1860)
                                                                )
                                                                else
                                                                    {1665}let pkSess_1863: bitstring = fail-any in
                                                                    {1666}out(c, GetEndpointRequest);
                                                                    {1667}in(c, (=GetEndpointResponse,=pkSess_1863,=None,SP_1864: bitstring,UP_1865: bitstring));
                                                                    {1668}new Nc_1866: bitstring;
                                                                    {1669}let gNc_1867: bitstring = exp(g,Nc_1866) in
                                                                    {1670}let m1_1868: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1867) in
                                                                    {1671}event beginCli(Cli,Sess,gNc_1867);
                                                                    {1672}out(c, (pkCli_1649,m1_1868));
                                                                    {1673}in(c, em2_1869: bitstring);
                                                                    {1674}let m2_1870: bitstring = em2_1869 in
                                                                    {1675}let (=OpenSecureChannelResponse,=Cli,PartS_1871: bitstring,ST_1872: bitstring,TTL_1873: bitstring) = m2_1870 in
                                                                    {1676}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1677}event endCli(Sess,Cli,PartS_1871)
                                                        )
                                                        else
                                                            {1678}let pkSess_1874: bitstring = fail-any in
                                                            {1679}out(c, GetEndpointRequest);
                                                            {1680}in(c, (=GetEndpointResponse,=pkSess_1874,=None,SP_1875: bitstring,UP_1876: bitstring));
                                                            {1681}new Nc_1877: bitstring;
                                                            {1682}let gNc_1878: bitstring = exp(g,Nc_1877) in
                                                            {1683}let m1_1879: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1878) in
                                                            {1684}event beginCli(Cli,Sess,gNc_1878);
                                                            {1685}out(c, (pkCli_1649,m1_1879));
                                                            {1686}in(c, em2_1880: bitstring);
                                                            {1687}let m2_1881: bitstring = em2_1880 in
                                                            {1688}let (=OpenSecureChannelResponse,=Cli,PartS_1882: bitstring,ST_1883: bitstring,TTL_1884: bitstring) = m2_1881 in
                                                            {1689}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1690}event endCli(Sess,Cli,PartS_1882)
                                                )
                                                else
                                                    {1691}let pkSess_1885: bitstring = fail-any in
                                                    {1692}out(c, GetEndpointRequest);
                                                    {1693}in(c, (=GetEndpointResponse,=pkSess_1885,=None,SP_1886: bitstring,UP_1887: bitstring));
                                                    {1694}new Nc_1888: bitstring;
                                                    {1695}let gNc_1889: bitstring = exp(g,Nc_1888) in
                                                    {1696}let m1_1890: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1889) in
                                                    {1697}event beginCli(Cli,Sess,gNc_1889);
                                                    {1698}out(c, (pkCli_1649,m1_1890));
                                                    {1699}in(c, em2_1891: bitstring);
                                                    {1700}let m2_1892: bitstring = em2_1891 in
                                                    {1701}let (=OpenSecureChannelResponse,=Cli,PartS_1893: bitstring,ST_1894: bitstring,TTL_1895: bitstring) = m2_1892 in
                                                    {1702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1703}event endCli(Sess,Cli,PartS_1893)
                                            )
                                            else
                                                {1704}let pkDisco_1896: bitstring = pub(sk(Disco)) in
                                                {1705}let v_1897: bool = (Sess = A) in
                                                (
                                                    {1706}if v_1897 then
                                                    (
                                                        {1707}let pkSess_1898: bitstring = pub(skA) in
                                                        {1708}out(c, GetEndpointRequest);
                                                        {1709}in(c, (=GetEndpointResponse,=pkSess_1898,=None,SP_1899: bitstring,UP_1900: bitstring));
                                                        {1710}new Nc_1901: bitstring;
                                                        {1711}let gNc_1902: bitstring = exp(g,Nc_1901) in
                                                        {1712}let m1_1903: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1902) in
                                                        {1713}event beginCli(Cli,Sess,gNc_1902);
                                                        {1714}out(c, (pkCli_1649,m1_1903));
                                                        {1715}in(c, em2_1904: bitstring);
                                                        {1716}let m2_1905: bitstring = em2_1904 in
                                                        {1717}let (=OpenSecureChannelResponse,=Cli,PartS_1906: bitstring,ST_1907: bitstring,TTL_1908: bitstring) = m2_1905 in
                                                        {1718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1719}event endCli(Sess,Cli,PartS_1906)
                                                    )
                                                    else
                                                        {1720}let v_1909: bool = (Sess = B) in
                                                        (
                                                            {1721}if v_1909 then
                                                            (
                                                                {1722}let pkSess_1910: bitstring = pub(skB) in
                                                                {1723}out(c, GetEndpointRequest);
                                                                {1724}in(c, (=GetEndpointResponse,=pkSess_1910,=None,SP_1911: bitstring,UP_1912: bitstring));
                                                                {1725}new Nc_1913: bitstring;
                                                                {1726}let gNc_1914: bitstring = exp(g,Nc_1913) in
                                                                {1727}let m1_1915: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1914) in
                                                                {1728}event beginCli(Cli,Sess,gNc_1914);
                                                                {1729}out(c, (pkCli_1649,m1_1915));
                                                                {1730}in(c, em2_1916: bitstring);
                                                                {1731}let m2_1917: bitstring = em2_1916 in
                                                                {1732}let (=OpenSecureChannelResponse,=Cli,PartS_1918: bitstring,ST_1919: bitstring,TTL_1920: bitstring) = m2_1917 in
                                                                {1733}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1734}event endCli(Sess,Cli,PartS_1918)
                                                            )
                                                            else
                                                                {1735}let v_1921: bool = (Sess = C) in
                                                                (
                                                                    {1736}if v_1921 then
                                                                    (
                                                                        {1737}let pkSess_1922: bitstring = pub(skC) in
                                                                        {1738}out(c, GetEndpointRequest);
                                                                        {1739}in(c, (=GetEndpointResponse,=pkSess_1922,=None,SP_1923: bitstring,UP_1924: bitstring));
                                                                        {1740}new Nc_1925: bitstring;
                                                                        {1741}let gNc_1926: bitstring = exp(g,Nc_1925) in
                                                                        {1742}let m1_1927: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1926) in
                                                                        {1743}event beginCli(Cli,Sess,gNc_1926);
                                                                        {1744}out(c, (pkCli_1649,m1_1927));
                                                                        {1745}in(c, em2_1928: bitstring);
                                                                        {1746}let m2_1929: bitstring = em2_1928 in
                                                                        {1747}let (=OpenSecureChannelResponse,=Cli,PartS_1930: bitstring,ST_1931: bitstring,TTL_1932: bitstring) = m2_1929 in
                                                                        {1748}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1749}event endCli(Sess,Cli,PartS_1930)
                                                                    )
                                                                    else
                                                                        {1750}let pkSess_1933: bitstring = pub(sk(Sess)) in
                                                                        {1751}out(c, GetEndpointRequest);
                                                                        {1752}in(c, (=GetEndpointResponse,=pkSess_1933,=None,SP_1934: bitstring,UP_1935: bitstring));
                                                                        {1753}new Nc_1936: bitstring;
                                                                        {1754}let gNc_1937: bitstring = exp(g,Nc_1936) in
                                                                        {1755}let m1_1938: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1937) in
                                                                        {1756}event beginCli(Cli,Sess,gNc_1937);
                                                                        {1757}out(c, (pkCli_1649,m1_1938));
                                                                        {1758}in(c, em2_1939: bitstring);
                                                                        {1759}let m2_1940: bitstring = em2_1939 in
                                                                        {1760}let (=OpenSecureChannelResponse,=Cli,PartS_1941: bitstring,ST_1942: bitstring,TTL_1943: bitstring) = m2_1940 in
                                                                        {1761}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1762}event endCli(Sess,Cli,PartS_1941)
                                                                )
                                                                else
                                                                    {1763}let pkSess_1944: bitstring = fail-any in
                                                                    {1764}out(c, GetEndpointRequest);
                                                                    {1765}in(c, (=GetEndpointResponse,=pkSess_1944,=None,SP_1945: bitstring,UP_1946: bitstring));
                                                                    {1766}new Nc_1947: bitstring;
                                                                    {1767}let gNc_1948: bitstring = exp(g,Nc_1947) in
                                                                    {1768}let m1_1949: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1948) in
                                                                    {1769}event beginCli(Cli,Sess,gNc_1948);
                                                                    {1770}out(c, (pkCli_1649,m1_1949));
                                                                    {1771}in(c, em2_1950: bitstring);
                                                                    {1772}let m2_1951: bitstring = em2_1950 in
                                                                    {1773}let (=OpenSecureChannelResponse,=Cli,PartS_1952: bitstring,ST_1953: bitstring,TTL_1954: bitstring) = m2_1951 in
                                                                    {1774}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1775}event endCli(Sess,Cli,PartS_1952)
                                                        )
                                                        else
                                                            {1776}let pkSess_1955: bitstring = fail-any in
                                                            {1777}out(c, GetEndpointRequest);
                                                            {1778}in(c, (=GetEndpointResponse,=pkSess_1955,=None,SP_1956: bitstring,UP_1957: bitstring));
                                                            {1779}new Nc_1958: bitstring;
                                                            {1780}let gNc_1959: bitstring = exp(g,Nc_1958) in
                                                            {1781}let m1_1960: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1959) in
                                                            {1782}event beginCli(Cli,Sess,gNc_1959);
                                                            {1783}out(c, (pkCli_1649,m1_1960));
                                                            {1784}in(c, em2_1961: bitstring);
                                                            {1785}let m2_1962: bitstring = em2_1961 in
                                                            {1786}let (=OpenSecureChannelResponse,=Cli,PartS_1963: bitstring,ST_1964: bitstring,TTL_1965: bitstring) = m2_1962 in
                                                            {1787}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1788}event endCli(Sess,Cli,PartS_1963)
                                                )
                                                else
                                                    {1789}let pkSess_1966: bitstring = fail-any in
                                                    {1790}out(c, GetEndpointRequest);
                                                    {1791}in(c, (=GetEndpointResponse,=pkSess_1966,=None,SP_1967: bitstring,UP_1968: bitstring));
                                                    {1792}new Nc_1969: bitstring;
                                                    {1793}let gNc_1970: bitstring = exp(g,Nc_1969) in
                                                    {1794}let m1_1971: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1970) in
                                                    {1795}event beginCli(Cli,Sess,gNc_1970);
                                                    {1796}out(c, (pkCli_1649,m1_1971));
                                                    {1797}in(c, em2_1972: bitstring);
                                                    {1798}let m2_1973: bitstring = em2_1972 in
                                                    {1799}let (=OpenSecureChannelResponse,=Cli,PartS_1974: bitstring,ST_1975: bitstring,TTL_1976: bitstring) = m2_1973 in
                                                    {1800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1801}event endCli(Sess,Cli,PartS_1974)
                                        )
                                        else
                                            {1802}let pkDisco_1977: bitstring = fail-any in
                                            {1803}let v_1978: bool = (Sess = A) in
                                            (
                                                {1804}if v_1978 then
                                                (
                                                    {1805}let pkSess_1979: bitstring = pub(skA) in
                                                    {1806}out(c, GetEndpointRequest);
                                                    {1807}in(c, (=GetEndpointResponse,=pkSess_1979,=None,SP_1980: bitstring,UP_1981: bitstring));
                                                    {1808}new Nc_1982: bitstring;
                                                    {1809}let gNc_1983: bitstring = exp(g,Nc_1982) in
                                                    {1810}let m1_1984: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1983) in
                                                    {1811}event beginCli(Cli,Sess,gNc_1983);
                                                    {1812}out(c, (pkCli_1649,m1_1984));
                                                    {1813}in(c, em2_1985: bitstring);
                                                    {1814}let m2_1986: bitstring = em2_1985 in
                                                    {1815}let (=OpenSecureChannelResponse,=Cli,PartS_1987: bitstring,ST_1988: bitstring,TTL_1989: bitstring) = m2_1986 in
                                                    {1816}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1817}event endCli(Sess,Cli,PartS_1987)
                                                )
                                                else
                                                    {1818}let v_1990: bool = (Sess = B) in
                                                    (
                                                        {1819}if v_1990 then
                                                        (
                                                            {1820}let pkSess_1991: bitstring = pub(skB) in
                                                            {1821}out(c, GetEndpointRequest);
                                                            {1822}in(c, (=GetEndpointResponse,=pkSess_1991,=None,SP_1992: bitstring,UP_1993: bitstring));
                                                            {1823}new Nc_1994: bitstring;
                                                            {1824}let gNc_1995: bitstring = exp(g,Nc_1994) in
                                                            {1825}let m1_1996: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_1995) in
                                                            {1826}event beginCli(Cli,Sess,gNc_1995);
                                                            {1827}out(c, (pkCli_1649,m1_1996));
                                                            {1828}in(c, em2_1997: bitstring);
                                                            {1829}let m2_1998: bitstring = em2_1997 in
                                                            {1830}let (=OpenSecureChannelResponse,=Cli,PartS_1999: bitstring,ST_2000: bitstring,TTL_2001: bitstring) = m2_1998 in
                                                            {1831}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1832}event endCli(Sess,Cli,PartS_1999)
                                                        )
                                                        else
                                                            {1833}let v_2002: bool = (Sess = C) in
                                                            (
                                                                {1834}if v_2002 then
                                                                (
                                                                    {1835}let pkSess_2003: bitstring = pub(skC) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (=GetEndpointResponse,=pkSess_2003,=None,SP_2004: bitstring,UP_2005: bitstring));
                                                                    {1838}new Nc_2006: bitstring;
                                                                    {1839}let gNc_2007: bitstring = exp(g,Nc_2006) in
                                                                    {1840}let m1_2008: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2007) in
                                                                    {1841}event beginCli(Cli,Sess,gNc_2007);
                                                                    {1842}out(c, (pkCli_1649,m1_2008));
                                                                    {1843}in(c, em2_2009: bitstring);
                                                                    {1844}let m2_2010: bitstring = em2_2009 in
                                                                    {1845}let (=OpenSecureChannelResponse,=Cli,PartS_2011: bitstring,ST_2012: bitstring,TTL_2013: bitstring) = m2_2010 in
                                                                    {1846}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1847}event endCli(Sess,Cli,PartS_2011)
                                                                )
                                                                else
                                                                    {1848}let pkSess_2014: bitstring = pub(sk(Sess)) in
                                                                    {1849}out(c, GetEndpointRequest);
                                                                    {1850}in(c, (=GetEndpointResponse,=pkSess_2014,=None,SP_2015: bitstring,UP_2016: bitstring));
                                                                    {1851}new Nc_2017: bitstring;
                                                                    {1852}let gNc_2018: bitstring = exp(g,Nc_2017) in
                                                                    {1853}let m1_2019: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2018) in
                                                                    {1854}event beginCli(Cli,Sess,gNc_2018);
                                                                    {1855}out(c, (pkCli_1649,m1_2019));
                                                                    {1856}in(c, em2_2020: bitstring);
                                                                    {1857}let m2_2021: bitstring = em2_2020 in
                                                                    {1858}let (=OpenSecureChannelResponse,=Cli,PartS_2022: bitstring,ST_2023: bitstring,TTL_2024: bitstring) = m2_2021 in
                                                                    {1859}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1860}event endCli(Sess,Cli,PartS_2022)
                                                            )
                                                            else
                                                                {1861}let pkSess_2025: bitstring = fail-any in
                                                                {1862}out(c, GetEndpointRequest);
                                                                {1863}in(c, (=GetEndpointResponse,=pkSess_2025,=None,SP_2026: bitstring,UP_2027: bitstring));
                                                                {1864}new Nc_2028: bitstring;
                                                                {1865}let gNc_2029: bitstring = exp(g,Nc_2028) in
                                                                {1866}let m1_2030: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2029) in
                                                                {1867}event beginCli(Cli,Sess,gNc_2029);
                                                                {1868}out(c, (pkCli_1649,m1_2030));
                                                                {1869}in(c, em2_2031: bitstring);
                                                                {1870}let m2_2032: bitstring = em2_2031 in
                                                                {1871}let (=OpenSecureChannelResponse,=Cli,PartS_2033: bitstring,ST_2034: bitstring,TTL_2035: bitstring) = m2_2032 in
                                                                {1872}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1873}event endCli(Sess,Cli,PartS_2033)
                                                    )
                                                    else
                                                        {1874}let pkSess_2036: bitstring = fail-any in
                                                        {1875}out(c, GetEndpointRequest);
                                                        {1876}in(c, (=GetEndpointResponse,=pkSess_2036,=None,SP_2037: bitstring,UP_2038: bitstring));
                                                        {1877}new Nc_2039: bitstring;
                                                        {1878}let gNc_2040: bitstring = exp(g,Nc_2039) in
                                                        {1879}let m1_2041: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2040) in
                                                        {1880}event beginCli(Cli,Sess,gNc_2040);
                                                        {1881}out(c, (pkCli_1649,m1_2041));
                                                        {1882}in(c, em2_2042: bitstring);
                                                        {1883}let m2_2043: bitstring = em2_2042 in
                                                        {1884}let (=OpenSecureChannelResponse,=Cli,PartS_2044: bitstring,ST_2045: bitstring,TTL_2046: bitstring) = m2_2043 in
                                                        {1885}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1886}event endCli(Sess,Cli,PartS_2044)
                                            )
                                            else
                                                {1887}let pkSess_2047: bitstring = fail-any in
                                                {1888}out(c, GetEndpointRequest);
                                                {1889}in(c, (=GetEndpointResponse,=pkSess_2047,=None,SP_2048: bitstring,UP_2049: bitstring));
                                                {1890}new Nc_2050: bitstring;
                                                {1891}let gNc_2051: bitstring = exp(g,Nc_2050) in
                                                {1892}let m1_2052: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2051) in
                                                {1893}event beginCli(Cli,Sess,gNc_2051);
                                                {1894}out(c, (pkCli_1649,m1_2052));
                                                {1895}in(c, em2_2053: bitstring);
                                                {1896}let m2_2054: bitstring = em2_2053 in
                                                {1897}let (=OpenSecureChannelResponse,=Cli,PartS_2055: bitstring,ST_2056: bitstring,TTL_2057: bitstring) = m2_2054 in
                                                {1898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1899}event endCli(Sess,Cli,PartS_2055)
                                )
                                else
                                    {1900}let pkDisco_2058: bitstring = fail-any in
                                    {1901}let v_2059: bool = (Sess = A) in
                                    (
                                        {1902}if v_2059 then
                                        (
                                            {1903}let pkSess_2060: bitstring = pub(skA) in
                                            {1904}out(c, GetEndpointRequest);
                                            {1905}in(c, (=GetEndpointResponse,=pkSess_2060,=None,SP_2061: bitstring,UP_2062: bitstring));
                                            {1906}new Nc_2063: bitstring;
                                            {1907}let gNc_2064: bitstring = exp(g,Nc_2063) in
                                            {1908}let m1_2065: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2064) in
                                            {1909}event beginCli(Cli,Sess,gNc_2064);
                                            {1910}out(c, (pkCli_1649,m1_2065));
                                            {1911}in(c, em2_2066: bitstring);
                                            {1912}let m2_2067: bitstring = em2_2066 in
                                            {1913}let (=OpenSecureChannelResponse,=Cli,PartS_2068: bitstring,ST_2069: bitstring,TTL_2070: bitstring) = m2_2067 in
                                            {1914}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1915}event endCli(Sess,Cli,PartS_2068)
                                        )
                                        else
                                            {1916}let v_2071: bool = (Sess = B) in
                                            (
                                                {1917}if v_2071 then
                                                (
                                                    {1918}let pkSess_2072: bitstring = pub(skB) in
                                                    {1919}out(c, GetEndpointRequest);
                                                    {1920}in(c, (=GetEndpointResponse,=pkSess_2072,=None,SP_2073: bitstring,UP_2074: bitstring));
                                                    {1921}new Nc_2075: bitstring;
                                                    {1922}let gNc_2076: bitstring = exp(g,Nc_2075) in
                                                    {1923}let m1_2077: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2076) in
                                                    {1924}event beginCli(Cli,Sess,gNc_2076);
                                                    {1925}out(c, (pkCli_1649,m1_2077));
                                                    {1926}in(c, em2_2078: bitstring);
                                                    {1927}let m2_2079: bitstring = em2_2078 in
                                                    {1928}let (=OpenSecureChannelResponse,=Cli,PartS_2080: bitstring,ST_2081: bitstring,TTL_2082: bitstring) = m2_2079 in
                                                    {1929}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1930}event endCli(Sess,Cli,PartS_2080)
                                                )
                                                else
                                                    {1931}let v_2083: bool = (Sess = C) in
                                                    (
                                                        {1932}if v_2083 then
                                                        (
                                                            {1933}let pkSess_2084: bitstring = pub(skC) in
                                                            {1934}out(c, GetEndpointRequest);
                                                            {1935}in(c, (=GetEndpointResponse,=pkSess_2084,=None,SP_2085: bitstring,UP_2086: bitstring));
                                                            {1936}new Nc_2087: bitstring;
                                                            {1937}let gNc_2088: bitstring = exp(g,Nc_2087) in
                                                            {1938}let m1_2089: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2088) in
                                                            {1939}event beginCli(Cli,Sess,gNc_2088);
                                                            {1940}out(c, (pkCli_1649,m1_2089));
                                                            {1941}in(c, em2_2090: bitstring);
                                                            {1942}let m2_2091: bitstring = em2_2090 in
                                                            {1943}let (=OpenSecureChannelResponse,=Cli,PartS_2092: bitstring,ST_2093: bitstring,TTL_2094: bitstring) = m2_2091 in
                                                            {1944}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1945}event endCli(Sess,Cli,PartS_2092)
                                                        )
                                                        else
                                                            {1946}let pkSess_2095: bitstring = pub(sk(Sess)) in
                                                            {1947}out(c, GetEndpointRequest);
                                                            {1948}in(c, (=GetEndpointResponse,=pkSess_2095,=None,SP_2096: bitstring,UP_2097: bitstring));
                                                            {1949}new Nc_2098: bitstring;
                                                            {1950}let gNc_2099: bitstring = exp(g,Nc_2098) in
                                                            {1951}let m1_2100: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2099) in
                                                            {1952}event beginCli(Cli,Sess,gNc_2099);
                                                            {1953}out(c, (pkCli_1649,m1_2100));
                                                            {1954}in(c, em2_2101: bitstring);
                                                            {1955}let m2_2102: bitstring = em2_2101 in
                                                            {1956}let (=OpenSecureChannelResponse,=Cli,PartS_2103: bitstring,ST_2104: bitstring,TTL_2105: bitstring) = m2_2102 in
                                                            {1957}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1958}event endCli(Sess,Cli,PartS_2103)
                                                    )
                                                    else
                                                        {1959}let pkSess_2106: bitstring = fail-any in
                                                        {1960}out(c, GetEndpointRequest);
                                                        {1961}in(c, (=GetEndpointResponse,=pkSess_2106,=None,SP_2107: bitstring,UP_2108: bitstring));
                                                        {1962}new Nc_2109: bitstring;
                                                        {1963}let gNc_2110: bitstring = exp(g,Nc_2109) in
                                                        {1964}let m1_2111: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2110) in
                                                        {1965}event beginCli(Cli,Sess,gNc_2110);
                                                        {1966}out(c, (pkCli_1649,m1_2111));
                                                        {1967}in(c, em2_2112: bitstring);
                                                        {1968}let m2_2113: bitstring = em2_2112 in
                                                        {1969}let (=OpenSecureChannelResponse,=Cli,PartS_2114: bitstring,ST_2115: bitstring,TTL_2116: bitstring) = m2_2113 in
                                                        {1970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1971}event endCli(Sess,Cli,PartS_2114)
                                            )
                                            else
                                                {1972}let pkSess_2117: bitstring = fail-any in
                                                {1973}out(c, GetEndpointRequest);
                                                {1974}in(c, (=GetEndpointResponse,=pkSess_2117,=None,SP_2118: bitstring,UP_2119: bitstring));
                                                {1975}new Nc_2120: bitstring;
                                                {1976}let gNc_2121: bitstring = exp(g,Nc_2120) in
                                                {1977}let m1_2122: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2121) in
                                                {1978}event beginCli(Cli,Sess,gNc_2121);
                                                {1979}out(c, (pkCli_1649,m1_2122));
                                                {1980}in(c, em2_2123: bitstring);
                                                {1981}let m2_2124: bitstring = em2_2123 in
                                                {1982}let (=OpenSecureChannelResponse,=Cli,PartS_2125: bitstring,ST_2126: bitstring,TTL_2127: bitstring) = m2_2124 in
                                                {1983}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1984}event endCli(Sess,Cli,PartS_2125)
                                    )
                                    else
                                        {1985}let pkSess_2128: bitstring = fail-any in
                                        {1986}out(c, GetEndpointRequest);
                                        {1987}in(c, (=GetEndpointResponse,=pkSess_2128,=None,SP_2129: bitstring,UP_2130: bitstring));
                                        {1988}new Nc_2131: bitstring;
                                        {1989}let gNc_2132: bitstring = exp(g,Nc_2131) in
                                        {1990}let m1_2133: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2132) in
                                        {1991}event beginCli(Cli,Sess,gNc_2132);
                                        {1992}out(c, (pkCli_1649,m1_2133));
                                        {1993}in(c, em2_2134: bitstring);
                                        {1994}let m2_2135: bitstring = em2_2134 in
                                        {1995}let (=OpenSecureChannelResponse,=Cli,PartS_2136: bitstring,ST_2137: bitstring,TTL_2138: bitstring) = m2_2135 in
                                        {1996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1997}event endCli(Sess,Cli,PartS_2136)
                        )
                        else
                            {1998}let pkDisco_2139: bitstring = fail-any in
                            {1999}let v_2140: bool = (Sess = A) in
                            (
                                {2000}if v_2140 then
                                (
                                    {2001}let pkSess_2141: bitstring = pub(skA) in
                                    {2002}out(c, GetEndpointRequest);
                                    {2003}in(c, (=GetEndpointResponse,=pkSess_2141,=None,SP_2142: bitstring,UP_2143: bitstring));
                                    {2004}new Nc_2144: bitstring;
                                    {2005}let gNc_2145: bitstring = exp(g,Nc_2144) in
                                    {2006}let m1_2146: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2145) in
                                    {2007}event beginCli(Cli,Sess,gNc_2145);
                                    {2008}out(c, (pkCli_1649,m1_2146));
                                    {2009}in(c, em2_2147: bitstring);
                                    {2010}let m2_2148: bitstring = em2_2147 in
                                    {2011}let (=OpenSecureChannelResponse,=Cli,PartS_2149: bitstring,ST_2150: bitstring,TTL_2151: bitstring) = m2_2148 in
                                    {2012}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2013}event endCli(Sess,Cli,PartS_2149)
                                )
                                else
                                    {2014}let v_2152: bool = (Sess = B) in
                                    (
                                        {2015}if v_2152 then
                                        (
                                            {2016}let pkSess_2153: bitstring = pub(skB) in
                                            {2017}out(c, GetEndpointRequest);
                                            {2018}in(c, (=GetEndpointResponse,=pkSess_2153,=None,SP_2154: bitstring,UP_2155: bitstring));
                                            {2019}new Nc_2156: bitstring;
                                            {2020}let gNc_2157: bitstring = exp(g,Nc_2156) in
                                            {2021}let m1_2158: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2157) in
                                            {2022}event beginCli(Cli,Sess,gNc_2157);
                                            {2023}out(c, (pkCli_1649,m1_2158));
                                            {2024}in(c, em2_2159: bitstring);
                                            {2025}let m2_2160: bitstring = em2_2159 in
                                            {2026}let (=OpenSecureChannelResponse,=Cli,PartS_2161: bitstring,ST_2162: bitstring,TTL_2163: bitstring) = m2_2160 in
                                            {2027}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2028}event endCli(Sess,Cli,PartS_2161)
                                        )
                                        else
                                            {2029}let v_2164: bool = (Sess = C) in
                                            (
                                                {2030}if v_2164 then
                                                (
                                                    {2031}let pkSess_2165: bitstring = pub(skC) in
                                                    {2032}out(c, GetEndpointRequest);
                                                    {2033}in(c, (=GetEndpointResponse,=pkSess_2165,=None,SP_2166: bitstring,UP_2167: bitstring));
                                                    {2034}new Nc_2168: bitstring;
                                                    {2035}let gNc_2169: bitstring = exp(g,Nc_2168) in
                                                    {2036}let m1_2170: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2169) in
                                                    {2037}event beginCli(Cli,Sess,gNc_2169);
                                                    {2038}out(c, (pkCli_1649,m1_2170));
                                                    {2039}in(c, em2_2171: bitstring);
                                                    {2040}let m2_2172: bitstring = em2_2171 in
                                                    {2041}let (=OpenSecureChannelResponse,=Cli,PartS_2173: bitstring,ST_2174: bitstring,TTL_2175: bitstring) = m2_2172 in
                                                    {2042}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2043}event endCli(Sess,Cli,PartS_2173)
                                                )
                                                else
                                                    {2044}let pkSess_2176: bitstring = pub(sk(Sess)) in
                                                    {2045}out(c, GetEndpointRequest);
                                                    {2046}in(c, (=GetEndpointResponse,=pkSess_2176,=None,SP_2177: bitstring,UP_2178: bitstring));
                                                    {2047}new Nc_2179: bitstring;
                                                    {2048}let gNc_2180: bitstring = exp(g,Nc_2179) in
                                                    {2049}let m1_2181: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2180) in
                                                    {2050}event beginCli(Cli,Sess,gNc_2180);
                                                    {2051}out(c, (pkCli_1649,m1_2181));
                                                    {2052}in(c, em2_2182: bitstring);
                                                    {2053}let m2_2183: bitstring = em2_2182 in
                                                    {2054}let (=OpenSecureChannelResponse,=Cli,PartS_2184: bitstring,ST_2185: bitstring,TTL_2186: bitstring) = m2_2183 in
                                                    {2055}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2056}event endCli(Sess,Cli,PartS_2184)
                                            )
                                            else
                                                {2057}let pkSess_2187: bitstring = fail-any in
                                                {2058}out(c, GetEndpointRequest);
                                                {2059}in(c, (=GetEndpointResponse,=pkSess_2187,=None,SP_2188: bitstring,UP_2189: bitstring));
                                                {2060}new Nc_2190: bitstring;
                                                {2061}let gNc_2191: bitstring = exp(g,Nc_2190) in
                                                {2062}let m1_2192: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2191) in
                                                {2063}event beginCli(Cli,Sess,gNc_2191);
                                                {2064}out(c, (pkCli_1649,m1_2192));
                                                {2065}in(c, em2_2193: bitstring);
                                                {2066}let m2_2194: bitstring = em2_2193 in
                                                {2067}let (=OpenSecureChannelResponse,=Cli,PartS_2195: bitstring,ST_2196: bitstring,TTL_2197: bitstring) = m2_2194 in
                                                {2068}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2069}event endCli(Sess,Cli,PartS_2195)
                                    )
                                    else
                                        {2070}let pkSess_2198: bitstring = fail-any in
                                        {2071}out(c, GetEndpointRequest);
                                        {2072}in(c, (=GetEndpointResponse,=pkSess_2198,=None,SP_2199: bitstring,UP_2200: bitstring));
                                        {2073}new Nc_2201: bitstring;
                                        {2074}let gNc_2202: bitstring = exp(g,Nc_2201) in
                                        {2075}let m1_2203: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2202) in
                                        {2076}event beginCli(Cli,Sess,gNc_2202);
                                        {2077}out(c, (pkCli_1649,m1_2203));
                                        {2078}in(c, em2_2204: bitstring);
                                        {2079}let m2_2205: bitstring = em2_2204 in
                                        {2080}let (=OpenSecureChannelResponse,=Cli,PartS_2206: bitstring,ST_2207: bitstring,TTL_2208: bitstring) = m2_2205 in
                                        {2081}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2082}event endCli(Sess,Cli,PartS_2206)
                            )
                            else
                                {2083}let pkSess_2209: bitstring = fail-any in
                                {2084}out(c, GetEndpointRequest);
                                {2085}in(c, (=GetEndpointResponse,=pkSess_2209,=None,SP_2210: bitstring,UP_2211: bitstring));
                                {2086}new Nc_2212: bitstring;
                                {2087}let gNc_2213: bitstring = exp(g,Nc_2212) in
                                {2088}let m1_2214: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1649,gNc_2213) in
                                {2089}event beginCli(Cli,Sess,gNc_2213);
                                {2090}out(c, (pkCli_1649,m1_2214));
                                {2091}in(c, em2_2215: bitstring);
                                {2092}let m2_2216: bitstring = em2_2215 in
                                {2093}let (=OpenSecureChannelResponse,=Cli,PartS_2217: bitstring,ST_2218: bitstring,TTL_2219: bitstring) = m2_2216 in
                                {2094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2095}event endCli(Sess,Cli,PartS_2217)
                    )
                    else
                        {2096}let skCli_2220: bitstring = fail-any in
                        {2097}let pkCli_2221: bitstring = pub(skCli_2220) in
                        {2098}let v_2222: bool = (Disco = A) in
                        (
                            {2099}if v_2222 then
                            (
                                {2100}let pkDisco_2223: bitstring = pub(skA) in
                                {2101}let v_2224: bool = (Sess = A) in
                                (
                                    {2102}if v_2224 then
                                    (
                                        {2103}let pkSess_2225: bitstring = pub(skA) in
                                        {2104}out(c, GetEndpointRequest);
                                        {2105}in(c, (=GetEndpointResponse,=pkSess_2225,=None,SP_2226: bitstring,UP_2227: bitstring));
                                        {2106}new Nc_2228: bitstring;
                                        {2107}let gNc_2229: bitstring = exp(g,Nc_2228) in
                                        {2108}let m1_2230: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2229) in
                                        {2109}event beginCli(Cli,Sess,gNc_2229);
                                        {2110}out(c, (pkCli_2221,m1_2230));
                                        {2111}in(c, em2_2231: bitstring);
                                        {2112}let m2_2232: bitstring = em2_2231 in
                                        {2113}let (=OpenSecureChannelResponse,=Cli,PartS_2233: bitstring,ST_2234: bitstring,TTL_2235: bitstring) = m2_2232 in
                                        {2114}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2115}event endCli(Sess,Cli,PartS_2233)
                                    )
                                    else
                                        {2116}let v_2236: bool = (Sess = B) in
                                        (
                                            {2117}if v_2236 then
                                            (
                                                {2118}let pkSess_2237: bitstring = pub(skB) in
                                                {2119}out(c, GetEndpointRequest);
                                                {2120}in(c, (=GetEndpointResponse,=pkSess_2237,=None,SP_2238: bitstring,UP_2239: bitstring));
                                                {2121}new Nc_2240: bitstring;
                                                {2122}let gNc_2241: bitstring = exp(g,Nc_2240) in
                                                {2123}let m1_2242: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2241) in
                                                {2124}event beginCli(Cli,Sess,gNc_2241);
                                                {2125}out(c, (pkCli_2221,m1_2242));
                                                {2126}in(c, em2_2243: bitstring);
                                                {2127}let m2_2244: bitstring = em2_2243 in
                                                {2128}let (=OpenSecureChannelResponse,=Cli,PartS_2245: bitstring,ST_2246: bitstring,TTL_2247: bitstring) = m2_2244 in
                                                {2129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2130}event endCli(Sess,Cli,PartS_2245)
                                            )
                                            else
                                                {2131}let v_2248: bool = (Sess = C) in
                                                (
                                                    {2132}if v_2248 then
                                                    (
                                                        {2133}let pkSess_2249: bitstring = pub(skC) in
                                                        {2134}out(c, GetEndpointRequest);
                                                        {2135}in(c, (=GetEndpointResponse,=pkSess_2249,=None,SP_2250: bitstring,UP_2251: bitstring));
                                                        {2136}new Nc_2252: bitstring;
                                                        {2137}let gNc_2253: bitstring = exp(g,Nc_2252) in
                                                        {2138}let m1_2254: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2253) in
                                                        {2139}event beginCli(Cli,Sess,gNc_2253);
                                                        {2140}out(c, (pkCli_2221,m1_2254));
                                                        {2141}in(c, em2_2255: bitstring);
                                                        {2142}let m2_2256: bitstring = em2_2255 in
                                                        {2143}let (=OpenSecureChannelResponse,=Cli,PartS_2257: bitstring,ST_2258: bitstring,TTL_2259: bitstring) = m2_2256 in
                                                        {2144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2145}event endCli(Sess,Cli,PartS_2257)
                                                    )
                                                    else
                                                        {2146}let pkSess_2260: bitstring = pub(sk(Sess)) in
                                                        {2147}out(c, GetEndpointRequest);
                                                        {2148}in(c, (=GetEndpointResponse,=pkSess_2260,=None,SP_2261: bitstring,UP_2262: bitstring));
                                                        {2149}new Nc_2263: bitstring;
                                                        {2150}let gNc_2264: bitstring = exp(g,Nc_2263) in
                                                        {2151}let m1_2265: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2264) in
                                                        {2152}event beginCli(Cli,Sess,gNc_2264);
                                                        {2153}out(c, (pkCli_2221,m1_2265));
                                                        {2154}in(c, em2_2266: bitstring);
                                                        {2155}let m2_2267: bitstring = em2_2266 in
                                                        {2156}let (=OpenSecureChannelResponse,=Cli,PartS_2268: bitstring,ST_2269: bitstring,TTL_2270: bitstring) = m2_2267 in
                                                        {2157}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2158}event endCli(Sess,Cli,PartS_2268)
                                                )
                                                else
                                                    {2159}let pkSess_2271: bitstring = fail-any in
                                                    {2160}out(c, GetEndpointRequest);
                                                    {2161}in(c, (=GetEndpointResponse,=pkSess_2271,=None,SP_2272: bitstring,UP_2273: bitstring));
                                                    {2162}new Nc_2274: bitstring;
                                                    {2163}let gNc_2275: bitstring = exp(g,Nc_2274) in
                                                    {2164}let m1_2276: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2275) in
                                                    {2165}event beginCli(Cli,Sess,gNc_2275);
                                                    {2166}out(c, (pkCli_2221,m1_2276));
                                                    {2167}in(c, em2_2277: bitstring);
                                                    {2168}let m2_2278: bitstring = em2_2277 in
                                                    {2169}let (=OpenSecureChannelResponse,=Cli,PartS_2279: bitstring,ST_2280: bitstring,TTL_2281: bitstring) = m2_2278 in
                                                    {2170}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2171}event endCli(Sess,Cli,PartS_2279)
                                        )
                                        else
                                            {2172}let pkSess_2282: bitstring = fail-any in
                                            {2173}out(c, GetEndpointRequest);
                                            {2174}in(c, (=GetEndpointResponse,=pkSess_2282,=None,SP_2283: bitstring,UP_2284: bitstring));
                                            {2175}new Nc_2285: bitstring;
                                            {2176}let gNc_2286: bitstring = exp(g,Nc_2285) in
                                            {2177}let m1_2287: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2286) in
                                            {2178}event beginCli(Cli,Sess,gNc_2286);
                                            {2179}out(c, (pkCli_2221,m1_2287));
                                            {2180}in(c, em2_2288: bitstring);
                                            {2181}let m2_2289: bitstring = em2_2288 in
                                            {2182}let (=OpenSecureChannelResponse,=Cli,PartS_2290: bitstring,ST_2291: bitstring,TTL_2292: bitstring) = m2_2289 in
                                            {2183}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2184}event endCli(Sess,Cli,PartS_2290)
                                )
                                else
                                    {2185}let pkSess_2293: bitstring = fail-any in
                                    {2186}out(c, GetEndpointRequest);
                                    {2187}in(c, (=GetEndpointResponse,=pkSess_2293,=None,SP_2294: bitstring,UP_2295: bitstring));
                                    {2188}new Nc_2296: bitstring;
                                    {2189}let gNc_2297: bitstring = exp(g,Nc_2296) in
                                    {2190}let m1_2298: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2297) in
                                    {2191}event beginCli(Cli,Sess,gNc_2297);
                                    {2192}out(c, (pkCli_2221,m1_2298));
                                    {2193}in(c, em2_2299: bitstring);
                                    {2194}let m2_2300: bitstring = em2_2299 in
                                    {2195}let (=OpenSecureChannelResponse,=Cli,PartS_2301: bitstring,ST_2302: bitstring,TTL_2303: bitstring) = m2_2300 in
                                    {2196}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2197}event endCli(Sess,Cli,PartS_2301)
                            )
                            else
                                {2198}let v_2304: bool = (Disco = B) in
                                (
                                    {2199}if v_2304 then
                                    (
                                        {2200}let pkDisco_2305: bitstring = pub(skB) in
                                        {2201}let v_2306: bool = (Sess = A) in
                                        (
                                            {2202}if v_2306 then
                                            (
                                                {2203}let pkSess_2307: bitstring = pub(skA) in
                                                {2204}out(c, GetEndpointRequest);
                                                {2205}in(c, (=GetEndpointResponse,=pkSess_2307,=None,SP_2308: bitstring,UP_2309: bitstring));
                                                {2206}new Nc_2310: bitstring;
                                                {2207}let gNc_2311: bitstring = exp(g,Nc_2310) in
                                                {2208}let m1_2312: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2311) in
                                                {2209}event beginCli(Cli,Sess,gNc_2311);
                                                {2210}out(c, (pkCli_2221,m1_2312));
                                                {2211}in(c, em2_2313: bitstring);
                                                {2212}let m2_2314: bitstring = em2_2313 in
                                                {2213}let (=OpenSecureChannelResponse,=Cli,PartS_2315: bitstring,ST_2316: bitstring,TTL_2317: bitstring) = m2_2314 in
                                                {2214}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2215}event endCli(Sess,Cli,PartS_2315)
                                            )
                                            else
                                                {2216}let v_2318: bool = (Sess = B) in
                                                (
                                                    {2217}if v_2318 then
                                                    (
                                                        {2218}let pkSess_2319: bitstring = pub(skB) in
                                                        {2219}out(c, GetEndpointRequest);
                                                        {2220}in(c, (=GetEndpointResponse,=pkSess_2319,=None,SP_2320: bitstring,UP_2321: bitstring));
                                                        {2221}new Nc_2322: bitstring;
                                                        {2222}let gNc_2323: bitstring = exp(g,Nc_2322) in
                                                        {2223}let m1_2324: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2323) in
                                                        {2224}event beginCli(Cli,Sess,gNc_2323);
                                                        {2225}out(c, (pkCli_2221,m1_2324));
                                                        {2226}in(c, em2_2325: bitstring);
                                                        {2227}let m2_2326: bitstring = em2_2325 in
                                                        {2228}let (=OpenSecureChannelResponse,=Cli,PartS_2327: bitstring,ST_2328: bitstring,TTL_2329: bitstring) = m2_2326 in
                                                        {2229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2230}event endCli(Sess,Cli,PartS_2327)
                                                    )
                                                    else
                                                        {2231}let v_2330: bool = (Sess = C) in
                                                        (
                                                            {2232}if v_2330 then
                                                            (
                                                                {2233}let pkSess_2331: bitstring = pub(skC) in
                                                                {2234}out(c, GetEndpointRequest);
                                                                {2235}in(c, (=GetEndpointResponse,=pkSess_2331,=None,SP_2332: bitstring,UP_2333: bitstring));
                                                                {2236}new Nc_2334: bitstring;
                                                                {2237}let gNc_2335: bitstring = exp(g,Nc_2334) in
                                                                {2238}let m1_2336: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2335) in
                                                                {2239}event beginCli(Cli,Sess,gNc_2335);
                                                                {2240}out(c, (pkCli_2221,m1_2336));
                                                                {2241}in(c, em2_2337: bitstring);
                                                                {2242}let m2_2338: bitstring = em2_2337 in
                                                                {2243}let (=OpenSecureChannelResponse,=Cli,PartS_2339: bitstring,ST_2340: bitstring,TTL_2341: bitstring) = m2_2338 in
                                                                {2244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2245}event endCli(Sess,Cli,PartS_2339)
                                                            )
                                                            else
                                                                {2246}let pkSess_2342: bitstring = pub(sk(Sess)) in
                                                                {2247}out(c, GetEndpointRequest);
                                                                {2248}in(c, (=GetEndpointResponse,=pkSess_2342,=None,SP_2343: bitstring,UP_2344: bitstring));
                                                                {2249}new Nc_2345: bitstring;
                                                                {2250}let gNc_2346: bitstring = exp(g,Nc_2345) in
                                                                {2251}let m1_2347: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2346) in
                                                                {2252}event beginCli(Cli,Sess,gNc_2346);
                                                                {2253}out(c, (pkCli_2221,m1_2347));
                                                                {2254}in(c, em2_2348: bitstring);
                                                                {2255}let m2_2349: bitstring = em2_2348 in
                                                                {2256}let (=OpenSecureChannelResponse,=Cli,PartS_2350: bitstring,ST_2351: bitstring,TTL_2352: bitstring) = m2_2349 in
                                                                {2257}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2258}event endCli(Sess,Cli,PartS_2350)
                                                        )
                                                        else
                                                            {2259}let pkSess_2353: bitstring = fail-any in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2353,=None,SP_2354: bitstring,UP_2355: bitstring));
                                                            {2262}new Nc_2356: bitstring;
                                                            {2263}let gNc_2357: bitstring = exp(g,Nc_2356) in
                                                            {2264}let m1_2358: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2357) in
                                                            {2265}event beginCli(Cli,Sess,gNc_2357);
                                                            {2266}out(c, (pkCli_2221,m1_2358));
                                                            {2267}in(c, em2_2359: bitstring);
                                                            {2268}let m2_2360: bitstring = em2_2359 in
                                                            {2269}let (=OpenSecureChannelResponse,=Cli,PartS_2361: bitstring,ST_2362: bitstring,TTL_2363: bitstring) = m2_2360 in
                                                            {2270}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2271}event endCli(Sess,Cli,PartS_2361)
                                                )
                                                else
                                                    {2272}let pkSess_2364: bitstring = fail-any in
                                                    {2273}out(c, GetEndpointRequest);
                                                    {2274}in(c, (=GetEndpointResponse,=pkSess_2364,=None,SP_2365: bitstring,UP_2366: bitstring));
                                                    {2275}new Nc_2367: bitstring;
                                                    {2276}let gNc_2368: bitstring = exp(g,Nc_2367) in
                                                    {2277}let m1_2369: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2368) in
                                                    {2278}event beginCli(Cli,Sess,gNc_2368);
                                                    {2279}out(c, (pkCli_2221,m1_2369));
                                                    {2280}in(c, em2_2370: bitstring);
                                                    {2281}let m2_2371: bitstring = em2_2370 in
                                                    {2282}let (=OpenSecureChannelResponse,=Cli,PartS_2372: bitstring,ST_2373: bitstring,TTL_2374: bitstring) = m2_2371 in
                                                    {2283}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2284}event endCli(Sess,Cli,PartS_2372)
                                        )
                                        else
                                            {2285}let pkSess_2375: bitstring = fail-any in
                                            {2286}out(c, GetEndpointRequest);
                                            {2287}in(c, (=GetEndpointResponse,=pkSess_2375,=None,SP_2376: bitstring,UP_2377: bitstring));
                                            {2288}new Nc_2378: bitstring;
                                            {2289}let gNc_2379: bitstring = exp(g,Nc_2378) in
                                            {2290}let m1_2380: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2379) in
                                            {2291}event beginCli(Cli,Sess,gNc_2379);
                                            {2292}out(c, (pkCli_2221,m1_2380));
                                            {2293}in(c, em2_2381: bitstring);
                                            {2294}let m2_2382: bitstring = em2_2381 in
                                            {2295}let (=OpenSecureChannelResponse,=Cli,PartS_2383: bitstring,ST_2384: bitstring,TTL_2385: bitstring) = m2_2382 in
                                            {2296}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2297}event endCli(Sess,Cli,PartS_2383)
                                    )
                                    else
                                        {2298}let v_2386: bool = (Disco = C) in
                                        (
                                            {2299}if v_2386 then
                                            (
                                                {2300}let pkDisco_2387: bitstring = pub(skC) in
                                                {2301}let v_2388: bool = (Sess = A) in
                                                (
                                                    {2302}if v_2388 then
                                                    (
                                                        {2303}let pkSess_2389: bitstring = pub(skA) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2389,=None,SP_2390: bitstring,UP_2391: bitstring));
                                                        {2306}new Nc_2392: bitstring;
                                                        {2307}let gNc_2393: bitstring = exp(g,Nc_2392) in
                                                        {2308}let m1_2394: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2393) in
                                                        {2309}event beginCli(Cli,Sess,gNc_2393);
                                                        {2310}out(c, (pkCli_2221,m1_2394));
                                                        {2311}in(c, em2_2395: bitstring);
                                                        {2312}let m2_2396: bitstring = em2_2395 in
                                                        {2313}let (=OpenSecureChannelResponse,=Cli,PartS_2397: bitstring,ST_2398: bitstring,TTL_2399: bitstring) = m2_2396 in
                                                        {2314}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2315}event endCli(Sess,Cli,PartS_2397)
                                                    )
                                                    else
                                                        {2316}let v_2400: bool = (Sess = B) in
                                                        (
                                                            {2317}if v_2400 then
                                                            (
                                                                {2318}let pkSess_2401: bitstring = pub(skB) in
                                                                {2319}out(c, GetEndpointRequest);
                                                                {2320}in(c, (=GetEndpointResponse,=pkSess_2401,=None,SP_2402: bitstring,UP_2403: bitstring));
                                                                {2321}new Nc_2404: bitstring;
                                                                {2322}let gNc_2405: bitstring = exp(g,Nc_2404) in
                                                                {2323}let m1_2406: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2405) in
                                                                {2324}event beginCli(Cli,Sess,gNc_2405);
                                                                {2325}out(c, (pkCli_2221,m1_2406));
                                                                {2326}in(c, em2_2407: bitstring);
                                                                {2327}let m2_2408: bitstring = em2_2407 in
                                                                {2328}let (=OpenSecureChannelResponse,=Cli,PartS_2409: bitstring,ST_2410: bitstring,TTL_2411: bitstring) = m2_2408 in
                                                                {2329}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2330}event endCli(Sess,Cli,PartS_2409)
                                                            )
                                                            else
                                                                {2331}let v_2412: bool = (Sess = C) in
                                                                (
                                                                    {2332}if v_2412 then
                                                                    (
                                                                        {2333}let pkSess_2413: bitstring = pub(skC) in
                                                                        {2334}out(c, GetEndpointRequest);
                                                                        {2335}in(c, (=GetEndpointResponse,=pkSess_2413,=None,SP_2414: bitstring,UP_2415: bitstring));
                                                                        {2336}new Nc_2416: bitstring;
                                                                        {2337}let gNc_2417: bitstring = exp(g,Nc_2416) in
                                                                        {2338}let m1_2418: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2417) in
                                                                        {2339}event beginCli(Cli,Sess,gNc_2417);
                                                                        {2340}out(c, (pkCli_2221,m1_2418));
                                                                        {2341}in(c, em2_2419: bitstring);
                                                                        {2342}let m2_2420: bitstring = em2_2419 in
                                                                        {2343}let (=OpenSecureChannelResponse,=Cli,PartS_2421: bitstring,ST_2422: bitstring,TTL_2423: bitstring) = m2_2420 in
                                                                        {2344}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2345}event endCli(Sess,Cli,PartS_2421)
                                                                    )
                                                                    else
                                                                        {2346}let pkSess_2424: bitstring = pub(sk(Sess)) in
                                                                        {2347}out(c, GetEndpointRequest);
                                                                        {2348}in(c, (=GetEndpointResponse,=pkSess_2424,=None,SP_2425: bitstring,UP_2426: bitstring));
                                                                        {2349}new Nc_2427: bitstring;
                                                                        {2350}let gNc_2428: bitstring = exp(g,Nc_2427) in
                                                                        {2351}let m1_2429: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2428) in
                                                                        {2352}event beginCli(Cli,Sess,gNc_2428);
                                                                        {2353}out(c, (pkCli_2221,m1_2429));
                                                                        {2354}in(c, em2_2430: bitstring);
                                                                        {2355}let m2_2431: bitstring = em2_2430 in
                                                                        {2356}let (=OpenSecureChannelResponse,=Cli,PartS_2432: bitstring,ST_2433: bitstring,TTL_2434: bitstring) = m2_2431 in
                                                                        {2357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2358}event endCli(Sess,Cli,PartS_2432)
                                                                )
                                                                else
                                                                    {2359}let pkSess_2435: bitstring = fail-any in
                                                                    {2360}out(c, GetEndpointRequest);
                                                                    {2361}in(c, (=GetEndpointResponse,=pkSess_2435,=None,SP_2436: bitstring,UP_2437: bitstring));
                                                                    {2362}new Nc_2438: bitstring;
                                                                    {2363}let gNc_2439: bitstring = exp(g,Nc_2438) in
                                                                    {2364}let m1_2440: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2439) in
                                                                    {2365}event beginCli(Cli,Sess,gNc_2439);
                                                                    {2366}out(c, (pkCli_2221,m1_2440));
                                                                    {2367}in(c, em2_2441: bitstring);
                                                                    {2368}let m2_2442: bitstring = em2_2441 in
                                                                    {2369}let (=OpenSecureChannelResponse,=Cli,PartS_2443: bitstring,ST_2444: bitstring,TTL_2445: bitstring) = m2_2442 in
                                                                    {2370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2371}event endCli(Sess,Cli,PartS_2443)
                                                        )
                                                        else
                                                            {2372}let pkSess_2446: bitstring = fail-any in
                                                            {2373}out(c, GetEndpointRequest);
                                                            {2374}in(c, (=GetEndpointResponse,=pkSess_2446,=None,SP_2447: bitstring,UP_2448: bitstring));
                                                            {2375}new Nc_2449: bitstring;
                                                            {2376}let gNc_2450: bitstring = exp(g,Nc_2449) in
                                                            {2377}let m1_2451: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2450) in
                                                            {2378}event beginCli(Cli,Sess,gNc_2450);
                                                            {2379}out(c, (pkCli_2221,m1_2451));
                                                            {2380}in(c, em2_2452: bitstring);
                                                            {2381}let m2_2453: bitstring = em2_2452 in
                                                            {2382}let (=OpenSecureChannelResponse,=Cli,PartS_2454: bitstring,ST_2455: bitstring,TTL_2456: bitstring) = m2_2453 in
                                                            {2383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2384}event endCli(Sess,Cli,PartS_2454)
                                                )
                                                else
                                                    {2385}let pkSess_2457: bitstring = fail-any in
                                                    {2386}out(c, GetEndpointRequest);
                                                    {2387}in(c, (=GetEndpointResponse,=pkSess_2457,=None,SP_2458: bitstring,UP_2459: bitstring));
                                                    {2388}new Nc_2460: bitstring;
                                                    {2389}let gNc_2461: bitstring = exp(g,Nc_2460) in
                                                    {2390}let m1_2462: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2461) in
                                                    {2391}event beginCli(Cli,Sess,gNc_2461);
                                                    {2392}out(c, (pkCli_2221,m1_2462));
                                                    {2393}in(c, em2_2463: bitstring);
                                                    {2394}let m2_2464: bitstring = em2_2463 in
                                                    {2395}let (=OpenSecureChannelResponse,=Cli,PartS_2465: bitstring,ST_2466: bitstring,TTL_2467: bitstring) = m2_2464 in
                                                    {2396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2397}event endCli(Sess,Cli,PartS_2465)
                                            )
                                            else
                                                {2398}let pkDisco_2468: bitstring = pub(sk(Disco)) in
                                                {2399}let v_2469: bool = (Sess = A) in
                                                (
                                                    {2400}if v_2469 then
                                                    (
                                                        {2401}let pkSess_2470: bitstring = pub(skA) in
                                                        {2402}out(c, GetEndpointRequest);
                                                        {2403}in(c, (=GetEndpointResponse,=pkSess_2470,=None,SP_2471: bitstring,UP_2472: bitstring));
                                                        {2404}new Nc_2473: bitstring;
                                                        {2405}let gNc_2474: bitstring = exp(g,Nc_2473) in
                                                        {2406}let m1_2475: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2474) in
                                                        {2407}event beginCli(Cli,Sess,gNc_2474);
                                                        {2408}out(c, (pkCli_2221,m1_2475));
                                                        {2409}in(c, em2_2476: bitstring);
                                                        {2410}let m2_2477: bitstring = em2_2476 in
                                                        {2411}let (=OpenSecureChannelResponse,=Cli,PartS_2478: bitstring,ST_2479: bitstring,TTL_2480: bitstring) = m2_2477 in
                                                        {2412}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2413}event endCli(Sess,Cli,PartS_2478)
                                                    )
                                                    else
                                                        {2414}let v_2481: bool = (Sess = B) in
                                                        (
                                                            {2415}if v_2481 then
                                                            (
                                                                {2416}let pkSess_2482: bitstring = pub(skB) in
                                                                {2417}out(c, GetEndpointRequest);
                                                                {2418}in(c, (=GetEndpointResponse,=pkSess_2482,=None,SP_2483: bitstring,UP_2484: bitstring));
                                                                {2419}new Nc_2485: bitstring;
                                                                {2420}let gNc_2486: bitstring = exp(g,Nc_2485) in
                                                                {2421}let m1_2487: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2486) in
                                                                {2422}event beginCli(Cli,Sess,gNc_2486);
                                                                {2423}out(c, (pkCli_2221,m1_2487));
                                                                {2424}in(c, em2_2488: bitstring);
                                                                {2425}let m2_2489: bitstring = em2_2488 in
                                                                {2426}let (=OpenSecureChannelResponse,=Cli,PartS_2490: bitstring,ST_2491: bitstring,TTL_2492: bitstring) = m2_2489 in
                                                                {2427}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2428}event endCli(Sess,Cli,PartS_2490)
                                                            )
                                                            else
                                                                {2429}let v_2493: bool = (Sess = C) in
                                                                (
                                                                    {2430}if v_2493 then
                                                                    (
                                                                        {2431}let pkSess_2494: bitstring = pub(skC) in
                                                                        {2432}out(c, GetEndpointRequest);
                                                                        {2433}in(c, (=GetEndpointResponse,=pkSess_2494,=None,SP_2495: bitstring,UP_2496: bitstring));
                                                                        {2434}new Nc_2497: bitstring;
                                                                        {2435}let gNc_2498: bitstring = exp(g,Nc_2497) in
                                                                        {2436}let m1_2499: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2498) in
                                                                        {2437}event beginCli(Cli,Sess,gNc_2498);
                                                                        {2438}out(c, (pkCli_2221,m1_2499));
                                                                        {2439}in(c, em2_2500: bitstring);
                                                                        {2440}let m2_2501: bitstring = em2_2500 in
                                                                        {2441}let (=OpenSecureChannelResponse,=Cli,PartS_2502: bitstring,ST_2503: bitstring,TTL_2504: bitstring) = m2_2501 in
                                                                        {2442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2443}event endCli(Sess,Cli,PartS_2502)
                                                                    )
                                                                    else
                                                                        {2444}let pkSess_2505: bitstring = pub(sk(Sess)) in
                                                                        {2445}out(c, GetEndpointRequest);
                                                                        {2446}in(c, (=GetEndpointResponse,=pkSess_2505,=None,SP_2506: bitstring,UP_2507: bitstring));
                                                                        {2447}new Nc_2508: bitstring;
                                                                        {2448}let gNc_2509: bitstring = exp(g,Nc_2508) in
                                                                        {2449}let m1_2510: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2509) in
                                                                        {2450}event beginCli(Cli,Sess,gNc_2509);
                                                                        {2451}out(c, (pkCli_2221,m1_2510));
                                                                        {2452}in(c, em2_2511: bitstring);
                                                                        {2453}let m2_2512: bitstring = em2_2511 in
                                                                        {2454}let (=OpenSecureChannelResponse,=Cli,PartS_2513: bitstring,ST_2514: bitstring,TTL_2515: bitstring) = m2_2512 in
                                                                        {2455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2456}event endCli(Sess,Cli,PartS_2513)
                                                                )
                                                                else
                                                                    {2457}let pkSess_2516: bitstring = fail-any in
                                                                    {2458}out(c, GetEndpointRequest);
                                                                    {2459}in(c, (=GetEndpointResponse,=pkSess_2516,=None,SP_2517: bitstring,UP_2518: bitstring));
                                                                    {2460}new Nc_2519: bitstring;
                                                                    {2461}let gNc_2520: bitstring = exp(g,Nc_2519) in
                                                                    {2462}let m1_2521: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2520) in
                                                                    {2463}event beginCli(Cli,Sess,gNc_2520);
                                                                    {2464}out(c, (pkCli_2221,m1_2521));
                                                                    {2465}in(c, em2_2522: bitstring);
                                                                    {2466}let m2_2523: bitstring = em2_2522 in
                                                                    {2467}let (=OpenSecureChannelResponse,=Cli,PartS_2524: bitstring,ST_2525: bitstring,TTL_2526: bitstring) = m2_2523 in
                                                                    {2468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2469}event endCli(Sess,Cli,PartS_2524)
                                                        )
                                                        else
                                                            {2470}let pkSess_2527: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (=GetEndpointResponse,=pkSess_2527,=None,SP_2528: bitstring,UP_2529: bitstring));
                                                            {2473}new Nc_2530: bitstring;
                                                            {2474}let gNc_2531: bitstring = exp(g,Nc_2530) in
                                                            {2475}let m1_2532: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2531) in
                                                            {2476}event beginCli(Cli,Sess,gNc_2531);
                                                            {2477}out(c, (pkCli_2221,m1_2532));
                                                            {2478}in(c, em2_2533: bitstring);
                                                            {2479}let m2_2534: bitstring = em2_2533 in
                                                            {2480}let (=OpenSecureChannelResponse,=Cli,PartS_2535: bitstring,ST_2536: bitstring,TTL_2537: bitstring) = m2_2534 in
                                                            {2481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2482}event endCli(Sess,Cli,PartS_2535)
                                                )
                                                else
                                                    {2483}let pkSess_2538: bitstring = fail-any in
                                                    {2484}out(c, GetEndpointRequest);
                                                    {2485}in(c, (=GetEndpointResponse,=pkSess_2538,=None,SP_2539: bitstring,UP_2540: bitstring));
                                                    {2486}new Nc_2541: bitstring;
                                                    {2487}let gNc_2542: bitstring = exp(g,Nc_2541) in
                                                    {2488}let m1_2543: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2542) in
                                                    {2489}event beginCli(Cli,Sess,gNc_2542);
                                                    {2490}out(c, (pkCli_2221,m1_2543));
                                                    {2491}in(c, em2_2544: bitstring);
                                                    {2492}let m2_2545: bitstring = em2_2544 in
                                                    {2493}let (=OpenSecureChannelResponse,=Cli,PartS_2546: bitstring,ST_2547: bitstring,TTL_2548: bitstring) = m2_2545 in
                                                    {2494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2495}event endCli(Sess,Cli,PartS_2546)
                                        )
                                        else
                                            {2496}let pkDisco_2549: bitstring = fail-any in
                                            {2497}let v_2550: bool = (Sess = A) in
                                            (
                                                {2498}if v_2550 then
                                                (
                                                    {2499}let pkSess_2551: bitstring = pub(skA) in
                                                    {2500}out(c, GetEndpointRequest);
                                                    {2501}in(c, (=GetEndpointResponse,=pkSess_2551,=None,SP_2552: bitstring,UP_2553: bitstring));
                                                    {2502}new Nc_2554: bitstring;
                                                    {2503}let gNc_2555: bitstring = exp(g,Nc_2554) in
                                                    {2504}let m1_2556: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2555) in
                                                    {2505}event beginCli(Cli,Sess,gNc_2555);
                                                    {2506}out(c, (pkCli_2221,m1_2556));
                                                    {2507}in(c, em2_2557: bitstring);
                                                    {2508}let m2_2558: bitstring = em2_2557 in
                                                    {2509}let (=OpenSecureChannelResponse,=Cli,PartS_2559: bitstring,ST_2560: bitstring,TTL_2561: bitstring) = m2_2558 in
                                                    {2510}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2511}event endCli(Sess,Cli,PartS_2559)
                                                )
                                                else
                                                    {2512}let v_2562: bool = (Sess = B) in
                                                    (
                                                        {2513}if v_2562 then
                                                        (
                                                            {2514}let pkSess_2563: bitstring = pub(skB) in
                                                            {2515}out(c, GetEndpointRequest);
                                                            {2516}in(c, (=GetEndpointResponse,=pkSess_2563,=None,SP_2564: bitstring,UP_2565: bitstring));
                                                            {2517}new Nc_2566: bitstring;
                                                            {2518}let gNc_2567: bitstring = exp(g,Nc_2566) in
                                                            {2519}let m1_2568: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2567) in
                                                            {2520}event beginCli(Cli,Sess,gNc_2567);
                                                            {2521}out(c, (pkCli_2221,m1_2568));
                                                            {2522}in(c, em2_2569: bitstring);
                                                            {2523}let m2_2570: bitstring = em2_2569 in
                                                            {2524}let (=OpenSecureChannelResponse,=Cli,PartS_2571: bitstring,ST_2572: bitstring,TTL_2573: bitstring) = m2_2570 in
                                                            {2525}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2526}event endCli(Sess,Cli,PartS_2571)
                                                        )
                                                        else
                                                            {2527}let v_2574: bool = (Sess = C) in
                                                            (
                                                                {2528}if v_2574 then
                                                                (
                                                                    {2529}let pkSess_2575: bitstring = pub(skC) in
                                                                    {2530}out(c, GetEndpointRequest);
                                                                    {2531}in(c, (=GetEndpointResponse,=pkSess_2575,=None,SP_2576: bitstring,UP_2577: bitstring));
                                                                    {2532}new Nc_2578: bitstring;
                                                                    {2533}let gNc_2579: bitstring = exp(g,Nc_2578) in
                                                                    {2534}let m1_2580: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2579) in
                                                                    {2535}event beginCli(Cli,Sess,gNc_2579);
                                                                    {2536}out(c, (pkCli_2221,m1_2580));
                                                                    {2537}in(c, em2_2581: bitstring);
                                                                    {2538}let m2_2582: bitstring = em2_2581 in
                                                                    {2539}let (=OpenSecureChannelResponse,=Cli,PartS_2583: bitstring,ST_2584: bitstring,TTL_2585: bitstring) = m2_2582 in
                                                                    {2540}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2541}event endCli(Sess,Cli,PartS_2583)
                                                                )
                                                                else
                                                                    {2542}let pkSess_2586: bitstring = pub(sk(Sess)) in
                                                                    {2543}out(c, GetEndpointRequest);
                                                                    {2544}in(c, (=GetEndpointResponse,=pkSess_2586,=None,SP_2587: bitstring,UP_2588: bitstring));
                                                                    {2545}new Nc_2589: bitstring;
                                                                    {2546}let gNc_2590: bitstring = exp(g,Nc_2589) in
                                                                    {2547}let m1_2591: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2590) in
                                                                    {2548}event beginCli(Cli,Sess,gNc_2590);
                                                                    {2549}out(c, (pkCli_2221,m1_2591));
                                                                    {2550}in(c, em2_2592: bitstring);
                                                                    {2551}let m2_2593: bitstring = em2_2592 in
                                                                    {2552}let (=OpenSecureChannelResponse,=Cli,PartS_2594: bitstring,ST_2595: bitstring,TTL_2596: bitstring) = m2_2593 in
                                                                    {2553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2554}event endCli(Sess,Cli,PartS_2594)
                                                            )
                                                            else
                                                                {2555}let pkSess_2597: bitstring = fail-any in
                                                                {2556}out(c, GetEndpointRequest);
                                                                {2557}in(c, (=GetEndpointResponse,=pkSess_2597,=None,SP_2598: bitstring,UP_2599: bitstring));
                                                                {2558}new Nc_2600: bitstring;
                                                                {2559}let gNc_2601: bitstring = exp(g,Nc_2600) in
                                                                {2560}let m1_2602: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2601) in
                                                                {2561}event beginCli(Cli,Sess,gNc_2601);
                                                                {2562}out(c, (pkCli_2221,m1_2602));
                                                                {2563}in(c, em2_2603: bitstring);
                                                                {2564}let m2_2604: bitstring = em2_2603 in
                                                                {2565}let (=OpenSecureChannelResponse,=Cli,PartS_2605: bitstring,ST_2606: bitstring,TTL_2607: bitstring) = m2_2604 in
                                                                {2566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2567}event endCli(Sess,Cli,PartS_2605)
                                                    )
                                                    else
                                                        {2568}let pkSess_2608: bitstring = fail-any in
                                                        {2569}out(c, GetEndpointRequest);
                                                        {2570}in(c, (=GetEndpointResponse,=pkSess_2608,=None,SP_2609: bitstring,UP_2610: bitstring));
                                                        {2571}new Nc_2611: bitstring;
                                                        {2572}let gNc_2612: bitstring = exp(g,Nc_2611) in
                                                        {2573}let m1_2613: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2612) in
                                                        {2574}event beginCli(Cli,Sess,gNc_2612);
                                                        {2575}out(c, (pkCli_2221,m1_2613));
                                                        {2576}in(c, em2_2614: bitstring);
                                                        {2577}let m2_2615: bitstring = em2_2614 in
                                                        {2578}let (=OpenSecureChannelResponse,=Cli,PartS_2616: bitstring,ST_2617: bitstring,TTL_2618: bitstring) = m2_2615 in
                                                        {2579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2580}event endCli(Sess,Cli,PartS_2616)
                                            )
                                            else
                                                {2581}let pkSess_2619: bitstring = fail-any in
                                                {2582}out(c, GetEndpointRequest);
                                                {2583}in(c, (=GetEndpointResponse,=pkSess_2619,=None,SP_2620: bitstring,UP_2621: bitstring));
                                                {2584}new Nc_2622: bitstring;
                                                {2585}let gNc_2623: bitstring = exp(g,Nc_2622) in
                                                {2586}let m1_2624: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2623) in
                                                {2587}event beginCli(Cli,Sess,gNc_2623);
                                                {2588}out(c, (pkCli_2221,m1_2624));
                                                {2589}in(c, em2_2625: bitstring);
                                                {2590}let m2_2626: bitstring = em2_2625 in
                                                {2591}let (=OpenSecureChannelResponse,=Cli,PartS_2627: bitstring,ST_2628: bitstring,TTL_2629: bitstring) = m2_2626 in
                                                {2592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2593}event endCli(Sess,Cli,PartS_2627)
                                )
                                else
                                    {2594}let pkDisco_2630: bitstring = fail-any in
                                    {2595}let v_2631: bool = (Sess = A) in
                                    (
                                        {2596}if v_2631 then
                                        (
                                            {2597}let pkSess_2632: bitstring = pub(skA) in
                                            {2598}out(c, GetEndpointRequest);
                                            {2599}in(c, (=GetEndpointResponse,=pkSess_2632,=None,SP_2633: bitstring,UP_2634: bitstring));
                                            {2600}new Nc_2635: bitstring;
                                            {2601}let gNc_2636: bitstring = exp(g,Nc_2635) in
                                            {2602}let m1_2637: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2636) in
                                            {2603}event beginCli(Cli,Sess,gNc_2636);
                                            {2604}out(c, (pkCli_2221,m1_2637));
                                            {2605}in(c, em2_2638: bitstring);
                                            {2606}let m2_2639: bitstring = em2_2638 in
                                            {2607}let (=OpenSecureChannelResponse,=Cli,PartS_2640: bitstring,ST_2641: bitstring,TTL_2642: bitstring) = m2_2639 in
                                            {2608}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2609}event endCli(Sess,Cli,PartS_2640)
                                        )
                                        else
                                            {2610}let v_2643: bool = (Sess = B) in
                                            (
                                                {2611}if v_2643 then
                                                (
                                                    {2612}let pkSess_2644: bitstring = pub(skB) in
                                                    {2613}out(c, GetEndpointRequest);
                                                    {2614}in(c, (=GetEndpointResponse,=pkSess_2644,=None,SP_2645: bitstring,UP_2646: bitstring));
                                                    {2615}new Nc_2647: bitstring;
                                                    {2616}let gNc_2648: bitstring = exp(g,Nc_2647) in
                                                    {2617}let m1_2649: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2648) in
                                                    {2618}event beginCli(Cli,Sess,gNc_2648);
                                                    {2619}out(c, (pkCli_2221,m1_2649));
                                                    {2620}in(c, em2_2650: bitstring);
                                                    {2621}let m2_2651: bitstring = em2_2650 in
                                                    {2622}let (=OpenSecureChannelResponse,=Cli,PartS_2652: bitstring,ST_2653: bitstring,TTL_2654: bitstring) = m2_2651 in
                                                    {2623}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2624}event endCli(Sess,Cli,PartS_2652)
                                                )
                                                else
                                                    {2625}let v_2655: bool = (Sess = C) in
                                                    (
                                                        {2626}if v_2655 then
                                                        (
                                                            {2627}let pkSess_2656: bitstring = pub(skC) in
                                                            {2628}out(c, GetEndpointRequest);
                                                            {2629}in(c, (=GetEndpointResponse,=pkSess_2656,=None,SP_2657: bitstring,UP_2658: bitstring));
                                                            {2630}new Nc_2659: bitstring;
                                                            {2631}let gNc_2660: bitstring = exp(g,Nc_2659) in
                                                            {2632}let m1_2661: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2660) in
                                                            {2633}event beginCli(Cli,Sess,gNc_2660);
                                                            {2634}out(c, (pkCli_2221,m1_2661));
                                                            {2635}in(c, em2_2662: bitstring);
                                                            {2636}let m2_2663: bitstring = em2_2662 in
                                                            {2637}let (=OpenSecureChannelResponse,=Cli,PartS_2664: bitstring,ST_2665: bitstring,TTL_2666: bitstring) = m2_2663 in
                                                            {2638}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2639}event endCli(Sess,Cli,PartS_2664)
                                                        )
                                                        else
                                                            {2640}let pkSess_2667: bitstring = pub(sk(Sess)) in
                                                            {2641}out(c, GetEndpointRequest);
                                                            {2642}in(c, (=GetEndpointResponse,=pkSess_2667,=None,SP_2668: bitstring,UP_2669: bitstring));
                                                            {2643}new Nc_2670: bitstring;
                                                            {2644}let gNc_2671: bitstring = exp(g,Nc_2670) in
                                                            {2645}let m1_2672: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2671) in
                                                            {2646}event beginCli(Cli,Sess,gNc_2671);
                                                            {2647}out(c, (pkCli_2221,m1_2672));
                                                            {2648}in(c, em2_2673: bitstring);
                                                            {2649}let m2_2674: bitstring = em2_2673 in
                                                            {2650}let (=OpenSecureChannelResponse,=Cli,PartS_2675: bitstring,ST_2676: bitstring,TTL_2677: bitstring) = m2_2674 in
                                                            {2651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2652}event endCli(Sess,Cli,PartS_2675)
                                                    )
                                                    else
                                                        {2653}let pkSess_2678: bitstring = fail-any in
                                                        {2654}out(c, GetEndpointRequest);
                                                        {2655}in(c, (=GetEndpointResponse,=pkSess_2678,=None,SP_2679: bitstring,UP_2680: bitstring));
                                                        {2656}new Nc_2681: bitstring;
                                                        {2657}let gNc_2682: bitstring = exp(g,Nc_2681) in
                                                        {2658}let m1_2683: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2682) in
                                                        {2659}event beginCli(Cli,Sess,gNc_2682);
                                                        {2660}out(c, (pkCli_2221,m1_2683));
                                                        {2661}in(c, em2_2684: bitstring);
                                                        {2662}let m2_2685: bitstring = em2_2684 in
                                                        {2663}let (=OpenSecureChannelResponse,=Cli,PartS_2686: bitstring,ST_2687: bitstring,TTL_2688: bitstring) = m2_2685 in
                                                        {2664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2665}event endCli(Sess,Cli,PartS_2686)
                                            )
                                            else
                                                {2666}let pkSess_2689: bitstring = fail-any in
                                                {2667}out(c, GetEndpointRequest);
                                                {2668}in(c, (=GetEndpointResponse,=pkSess_2689,=None,SP_2690: bitstring,UP_2691: bitstring));
                                                {2669}new Nc_2692: bitstring;
                                                {2670}let gNc_2693: bitstring = exp(g,Nc_2692) in
                                                {2671}let m1_2694: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2693) in
                                                {2672}event beginCli(Cli,Sess,gNc_2693);
                                                {2673}out(c, (pkCli_2221,m1_2694));
                                                {2674}in(c, em2_2695: bitstring);
                                                {2675}let m2_2696: bitstring = em2_2695 in
                                                {2676}let (=OpenSecureChannelResponse,=Cli,PartS_2697: bitstring,ST_2698: bitstring,TTL_2699: bitstring) = m2_2696 in
                                                {2677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2678}event endCli(Sess,Cli,PartS_2697)
                                    )
                                    else
                                        {2679}let pkSess_2700: bitstring = fail-any in
                                        {2680}out(c, GetEndpointRequest);
                                        {2681}in(c, (=GetEndpointResponse,=pkSess_2700,=None,SP_2701: bitstring,UP_2702: bitstring));
                                        {2682}new Nc_2703: bitstring;
                                        {2683}let gNc_2704: bitstring = exp(g,Nc_2703) in
                                        {2684}let m1_2705: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2704) in
                                        {2685}event beginCli(Cli,Sess,gNc_2704);
                                        {2686}out(c, (pkCli_2221,m1_2705));
                                        {2687}in(c, em2_2706: bitstring);
                                        {2688}let m2_2707: bitstring = em2_2706 in
                                        {2689}let (=OpenSecureChannelResponse,=Cli,PartS_2708: bitstring,ST_2709: bitstring,TTL_2710: bitstring) = m2_2707 in
                                        {2690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2691}event endCli(Sess,Cli,PartS_2708)
                        )
                        else
                            {2692}let pkDisco_2711: bitstring = fail-any in
                            {2693}let v_2712: bool = (Sess = A) in
                            (
                                {2694}if v_2712 then
                                (
                                    {2695}let pkSess_2713: bitstring = pub(skA) in
                                    {2696}out(c, GetEndpointRequest);
                                    {2697}in(c, (=GetEndpointResponse,=pkSess_2713,=None,SP_2714: bitstring,UP_2715: bitstring));
                                    {2698}new Nc_2716: bitstring;
                                    {2699}let gNc_2717: bitstring = exp(g,Nc_2716) in
                                    {2700}let m1_2718: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2717) in
                                    {2701}event beginCli(Cli,Sess,gNc_2717);
                                    {2702}out(c, (pkCli_2221,m1_2718));
                                    {2703}in(c, em2_2719: bitstring);
                                    {2704}let m2_2720: bitstring = em2_2719 in
                                    {2705}let (=OpenSecureChannelResponse,=Cli,PartS_2721: bitstring,ST_2722: bitstring,TTL_2723: bitstring) = m2_2720 in
                                    {2706}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2707}event endCli(Sess,Cli,PartS_2721)
                                )
                                else
                                    {2708}let v_2724: bool = (Sess = B) in
                                    (
                                        {2709}if v_2724 then
                                        (
                                            {2710}let pkSess_2725: bitstring = pub(skB) in
                                            {2711}out(c, GetEndpointRequest);
                                            {2712}in(c, (=GetEndpointResponse,=pkSess_2725,=None,SP_2726: bitstring,UP_2727: bitstring));
                                            {2713}new Nc_2728: bitstring;
                                            {2714}let gNc_2729: bitstring = exp(g,Nc_2728) in
                                            {2715}let m1_2730: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2729) in
                                            {2716}event beginCli(Cli,Sess,gNc_2729);
                                            {2717}out(c, (pkCli_2221,m1_2730));
                                            {2718}in(c, em2_2731: bitstring);
                                            {2719}let m2_2732: bitstring = em2_2731 in
                                            {2720}let (=OpenSecureChannelResponse,=Cli,PartS_2733: bitstring,ST_2734: bitstring,TTL_2735: bitstring) = m2_2732 in
                                            {2721}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2722}event endCli(Sess,Cli,PartS_2733)
                                        )
                                        else
                                            {2723}let v_2736: bool = (Sess = C) in
                                            (
                                                {2724}if v_2736 then
                                                (
                                                    {2725}let pkSess_2737: bitstring = pub(skC) in
                                                    {2726}out(c, GetEndpointRequest);
                                                    {2727}in(c, (=GetEndpointResponse,=pkSess_2737,=None,SP_2738: bitstring,UP_2739: bitstring));
                                                    {2728}new Nc_2740: bitstring;
                                                    {2729}let gNc_2741: bitstring = exp(g,Nc_2740) in
                                                    {2730}let m1_2742: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2741) in
                                                    {2731}event beginCli(Cli,Sess,gNc_2741);
                                                    {2732}out(c, (pkCli_2221,m1_2742));
                                                    {2733}in(c, em2_2743: bitstring);
                                                    {2734}let m2_2744: bitstring = em2_2743 in
                                                    {2735}let (=OpenSecureChannelResponse,=Cli,PartS_2745: bitstring,ST_2746: bitstring,TTL_2747: bitstring) = m2_2744 in
                                                    {2736}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2737}event endCli(Sess,Cli,PartS_2745)
                                                )
                                                else
                                                    {2738}let pkSess_2748: bitstring = pub(sk(Sess)) in
                                                    {2739}out(c, GetEndpointRequest);
                                                    {2740}in(c, (=GetEndpointResponse,=pkSess_2748,=None,SP_2749: bitstring,UP_2750: bitstring));
                                                    {2741}new Nc_2751: bitstring;
                                                    {2742}let gNc_2752: bitstring = exp(g,Nc_2751) in
                                                    {2743}let m1_2753: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2752) in
                                                    {2744}event beginCli(Cli,Sess,gNc_2752);
                                                    {2745}out(c, (pkCli_2221,m1_2753));
                                                    {2746}in(c, em2_2754: bitstring);
                                                    {2747}let m2_2755: bitstring = em2_2754 in
                                                    {2748}let (=OpenSecureChannelResponse,=Cli,PartS_2756: bitstring,ST_2757: bitstring,TTL_2758: bitstring) = m2_2755 in
                                                    {2749}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2750}event endCli(Sess,Cli,PartS_2756)
                                            )
                                            else
                                                {2751}let pkSess_2759: bitstring = fail-any in
                                                {2752}out(c, GetEndpointRequest);
                                                {2753}in(c, (=GetEndpointResponse,=pkSess_2759,=None,SP_2760: bitstring,UP_2761: bitstring));
                                                {2754}new Nc_2762: bitstring;
                                                {2755}let gNc_2763: bitstring = exp(g,Nc_2762) in
                                                {2756}let m1_2764: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2763) in
                                                {2757}event beginCli(Cli,Sess,gNc_2763);
                                                {2758}out(c, (pkCli_2221,m1_2764));
                                                {2759}in(c, em2_2765: bitstring);
                                                {2760}let m2_2766: bitstring = em2_2765 in
                                                {2761}let (=OpenSecureChannelResponse,=Cli,PartS_2767: bitstring,ST_2768: bitstring,TTL_2769: bitstring) = m2_2766 in
                                                {2762}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2763}event endCli(Sess,Cli,PartS_2767)
                                    )
                                    else
                                        {2764}let pkSess_2770: bitstring = fail-any in
                                        {2765}out(c, GetEndpointRequest);
                                        {2766}in(c, (=GetEndpointResponse,=pkSess_2770,=None,SP_2771: bitstring,UP_2772: bitstring));
                                        {2767}new Nc_2773: bitstring;
                                        {2768}let gNc_2774: bitstring = exp(g,Nc_2773) in
                                        {2769}let m1_2775: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2774) in
                                        {2770}event beginCli(Cli,Sess,gNc_2774);
                                        {2771}out(c, (pkCli_2221,m1_2775));
                                        {2772}in(c, em2_2776: bitstring);
                                        {2773}let m2_2777: bitstring = em2_2776 in
                                        {2774}let (=OpenSecureChannelResponse,=Cli,PartS_2778: bitstring,ST_2779: bitstring,TTL_2780: bitstring) = m2_2777 in
                                        {2775}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2776}event endCli(Sess,Cli,PartS_2778)
                            )
                            else
                                {2777}let pkSess_2781: bitstring = fail-any in
                                {2778}out(c, GetEndpointRequest);
                                {2779}in(c, (=GetEndpointResponse,=pkSess_2781,=None,SP_2782: bitstring,UP_2783: bitstring));
                                {2780}new Nc_2784: bitstring;
                                {2781}let gNc_2785: bitstring = exp(g,Nc_2784) in
                                {2782}let m1_2786: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2221,gNc_2785) in
                                {2783}event beginCli(Cli,Sess,gNc_2785);
                                {2784}out(c, (pkCli_2221,m1_2786));
                                {2785}in(c, em2_2787: bitstring);
                                {2786}let m2_2788: bitstring = em2_2787 in
                                {2787}let (=OpenSecureChannelResponse,=Cli,PartS_2789: bitstring,ST_2790: bitstring,TTL_2791: bitstring) = m2_2788 in
                                {2788}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2789}event endCli(Sess,Cli,PartS_2789)
            )
            else
                {2790}let skCli_2792: bitstring = fail-any in
                {2791}let pkCli_2793: bitstring = pub(skCli_2792) in
                {2792}let v_2794: bool = (Disco = A) in
                (
                    {2793}if v_2794 then
                    (
                        {2794}let pkDisco_2795: bitstring = pub(skA) in
                        {2795}let v_2796: bool = (Sess = A) in
                        (
                            {2796}if v_2796 then
                            (
                                {2797}let pkSess_2797: bitstring = pub(skA) in
                                {2798}out(c, GetEndpointRequest);
                                {2799}in(c, (=GetEndpointResponse,=pkSess_2797,=None,SP_2798: bitstring,UP_2799: bitstring));
                                {2800}new Nc_2800: bitstring;
                                {2801}let gNc_2801: bitstring = exp(g,Nc_2800) in
                                {2802}let m1_2802: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2801) in
                                {2803}event beginCli(Cli,Sess,gNc_2801);
                                {2804}out(c, (pkCli_2793,m1_2802));
                                {2805}in(c, em2_2803: bitstring);
                                {2806}let m2_2804: bitstring = em2_2803 in
                                {2807}let (=OpenSecureChannelResponse,=Cli,PartS_2805: bitstring,ST_2806: bitstring,TTL_2807: bitstring) = m2_2804 in
                                {2808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2809}event endCli(Sess,Cli,PartS_2805)
                            )
                            else
                                {2810}let v_2808: bool = (Sess = B) in
                                (
                                    {2811}if v_2808 then
                                    (
                                        {2812}let pkSess_2809: bitstring = pub(skB) in
                                        {2813}out(c, GetEndpointRequest);
                                        {2814}in(c, (=GetEndpointResponse,=pkSess_2809,=None,SP_2810: bitstring,UP_2811: bitstring));
                                        {2815}new Nc_2812: bitstring;
                                        {2816}let gNc_2813: bitstring = exp(g,Nc_2812) in
                                        {2817}let m1_2814: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2813) in
                                        {2818}event beginCli(Cli,Sess,gNc_2813);
                                        {2819}out(c, (pkCli_2793,m1_2814));
                                        {2820}in(c, em2_2815: bitstring);
                                        {2821}let m2_2816: bitstring = em2_2815 in
                                        {2822}let (=OpenSecureChannelResponse,=Cli,PartS_2817: bitstring,ST_2818: bitstring,TTL_2819: bitstring) = m2_2816 in
                                        {2823}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2824}event endCli(Sess,Cli,PartS_2817)
                                    )
                                    else
                                        {2825}let v_2820: bool = (Sess = C) in
                                        (
                                            {2826}if v_2820 then
                                            (
                                                {2827}let pkSess_2821: bitstring = pub(skC) in
                                                {2828}out(c, GetEndpointRequest);
                                                {2829}in(c, (=GetEndpointResponse,=pkSess_2821,=None,SP_2822: bitstring,UP_2823: bitstring));
                                                {2830}new Nc_2824: bitstring;
                                                {2831}let gNc_2825: bitstring = exp(g,Nc_2824) in
                                                {2832}let m1_2826: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2825) in
                                                {2833}event beginCli(Cli,Sess,gNc_2825);
                                                {2834}out(c, (pkCli_2793,m1_2826));
                                                {2835}in(c, em2_2827: bitstring);
                                                {2836}let m2_2828: bitstring = em2_2827 in
                                                {2837}let (=OpenSecureChannelResponse,=Cli,PartS_2829: bitstring,ST_2830: bitstring,TTL_2831: bitstring) = m2_2828 in
                                                {2838}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2839}event endCli(Sess,Cli,PartS_2829)
                                            )
                                            else
                                                {2840}let pkSess_2832: bitstring = pub(sk(Sess)) in
                                                {2841}out(c, GetEndpointRequest);
                                                {2842}in(c, (=GetEndpointResponse,=pkSess_2832,=None,SP_2833: bitstring,UP_2834: bitstring));
                                                {2843}new Nc_2835: bitstring;
                                                {2844}let gNc_2836: bitstring = exp(g,Nc_2835) in
                                                {2845}let m1_2837: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2836) in
                                                {2846}event beginCli(Cli,Sess,gNc_2836);
                                                {2847}out(c, (pkCli_2793,m1_2837));
                                                {2848}in(c, em2_2838: bitstring);
                                                {2849}let m2_2839: bitstring = em2_2838 in
                                                {2850}let (=OpenSecureChannelResponse,=Cli,PartS_2840: bitstring,ST_2841: bitstring,TTL_2842: bitstring) = m2_2839 in
                                                {2851}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2852}event endCli(Sess,Cli,PartS_2840)
                                        )
                                        else
                                            {2853}let pkSess_2843: bitstring = fail-any in
                                            {2854}out(c, GetEndpointRequest);
                                            {2855}in(c, (=GetEndpointResponse,=pkSess_2843,=None,SP_2844: bitstring,UP_2845: bitstring));
                                            {2856}new Nc_2846: bitstring;
                                            {2857}let gNc_2847: bitstring = exp(g,Nc_2846) in
                                            {2858}let m1_2848: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2847) in
                                            {2859}event beginCli(Cli,Sess,gNc_2847);
                                            {2860}out(c, (pkCli_2793,m1_2848));
                                            {2861}in(c, em2_2849: bitstring);
                                            {2862}let m2_2850: bitstring = em2_2849 in
                                            {2863}let (=OpenSecureChannelResponse,=Cli,PartS_2851: bitstring,ST_2852: bitstring,TTL_2853: bitstring) = m2_2850 in
                                            {2864}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2865}event endCli(Sess,Cli,PartS_2851)
                                )
                                else
                                    {2866}let pkSess_2854: bitstring = fail-any in
                                    {2867}out(c, GetEndpointRequest);
                                    {2868}in(c, (=GetEndpointResponse,=pkSess_2854,=None,SP_2855: bitstring,UP_2856: bitstring));
                                    {2869}new Nc_2857: bitstring;
                                    {2870}let gNc_2858: bitstring = exp(g,Nc_2857) in
                                    {2871}let m1_2859: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2858) in
                                    {2872}event beginCli(Cli,Sess,gNc_2858);
                                    {2873}out(c, (pkCli_2793,m1_2859));
                                    {2874}in(c, em2_2860: bitstring);
                                    {2875}let m2_2861: bitstring = em2_2860 in
                                    {2876}let (=OpenSecureChannelResponse,=Cli,PartS_2862: bitstring,ST_2863: bitstring,TTL_2864: bitstring) = m2_2861 in
                                    {2877}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2878}event endCli(Sess,Cli,PartS_2862)
                        )
                        else
                            {2879}let pkSess_2865: bitstring = fail-any in
                            {2880}out(c, GetEndpointRequest);
                            {2881}in(c, (=GetEndpointResponse,=pkSess_2865,=None,SP_2866: bitstring,UP_2867: bitstring));
                            {2882}new Nc_2868: bitstring;
                            {2883}let gNc_2869: bitstring = exp(g,Nc_2868) in
                            {2884}let m1_2870: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2869) in
                            {2885}event beginCli(Cli,Sess,gNc_2869);
                            {2886}out(c, (pkCli_2793,m1_2870));
                            {2887}in(c, em2_2871: bitstring);
                            {2888}let m2_2872: bitstring = em2_2871 in
                            {2889}let (=OpenSecureChannelResponse,=Cli,PartS_2873: bitstring,ST_2874: bitstring,TTL_2875: bitstring) = m2_2872 in
                            {2890}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {2891}event endCli(Sess,Cli,PartS_2873)
                    )
                    else
                        {2892}let v_2876: bool = (Disco = B) in
                        (
                            {2893}if v_2876 then
                            (
                                {2894}let pkDisco_2877: bitstring = pub(skB) in
                                {2895}let v_2878: bool = (Sess = A) in
                                (
                                    {2896}if v_2878 then
                                    (
                                        {2897}let pkSess_2879: bitstring = pub(skA) in
                                        {2898}out(c, GetEndpointRequest);
                                        {2899}in(c, (=GetEndpointResponse,=pkSess_2879,=None,SP_2880: bitstring,UP_2881: bitstring));
                                        {2900}new Nc_2882: bitstring;
                                        {2901}let gNc_2883: bitstring = exp(g,Nc_2882) in
                                        {2902}let m1_2884: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2883) in
                                        {2903}event beginCli(Cli,Sess,gNc_2883);
                                        {2904}out(c, (pkCli_2793,m1_2884));
                                        {2905}in(c, em2_2885: bitstring);
                                        {2906}let m2_2886: bitstring = em2_2885 in
                                        {2907}let (=OpenSecureChannelResponse,=Cli,PartS_2887: bitstring,ST_2888: bitstring,TTL_2889: bitstring) = m2_2886 in
                                        {2908}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2909}event endCli(Sess,Cli,PartS_2887)
                                    )
                                    else
                                        {2910}let v_2890: bool = (Sess = B) in
                                        (
                                            {2911}if v_2890 then
                                            (
                                                {2912}let pkSess_2891: bitstring = pub(skB) in
                                                {2913}out(c, GetEndpointRequest);
                                                {2914}in(c, (=GetEndpointResponse,=pkSess_2891,=None,SP_2892: bitstring,UP_2893: bitstring));
                                                {2915}new Nc_2894: bitstring;
                                                {2916}let gNc_2895: bitstring = exp(g,Nc_2894) in
                                                {2917}let m1_2896: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2895) in
                                                {2918}event beginCli(Cli,Sess,gNc_2895);
                                                {2919}out(c, (pkCli_2793,m1_2896));
                                                {2920}in(c, em2_2897: bitstring);
                                                {2921}let m2_2898: bitstring = em2_2897 in
                                                {2922}let (=OpenSecureChannelResponse,=Cli,PartS_2899: bitstring,ST_2900: bitstring,TTL_2901: bitstring) = m2_2898 in
                                                {2923}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2924}event endCli(Sess,Cli,PartS_2899)
                                            )
                                            else
                                                {2925}let v_2902: bool = (Sess = C) in
                                                (
                                                    {2926}if v_2902 then
                                                    (
                                                        {2927}let pkSess_2903: bitstring = pub(skC) in
                                                        {2928}out(c, GetEndpointRequest);
                                                        {2929}in(c, (=GetEndpointResponse,=pkSess_2903,=None,SP_2904: bitstring,UP_2905: bitstring));
                                                        {2930}new Nc_2906: bitstring;
                                                        {2931}let gNc_2907: bitstring = exp(g,Nc_2906) in
                                                        {2932}let m1_2908: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2907) in
                                                        {2933}event beginCli(Cli,Sess,gNc_2907);
                                                        {2934}out(c, (pkCli_2793,m1_2908));
                                                        {2935}in(c, em2_2909: bitstring);
                                                        {2936}let m2_2910: bitstring = em2_2909 in
                                                        {2937}let (=OpenSecureChannelResponse,=Cli,PartS_2911: bitstring,ST_2912: bitstring,TTL_2913: bitstring) = m2_2910 in
                                                        {2938}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2939}event endCli(Sess,Cli,PartS_2911)
                                                    )
                                                    else
                                                        {2940}let pkSess_2914: bitstring = pub(sk(Sess)) in
                                                        {2941}out(c, GetEndpointRequest);
                                                        {2942}in(c, (=GetEndpointResponse,=pkSess_2914,=None,SP_2915: bitstring,UP_2916: bitstring));
                                                        {2943}new Nc_2917: bitstring;
                                                        {2944}let gNc_2918: bitstring = exp(g,Nc_2917) in
                                                        {2945}let m1_2919: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2918) in
                                                        {2946}event beginCli(Cli,Sess,gNc_2918);
                                                        {2947}out(c, (pkCli_2793,m1_2919));
                                                        {2948}in(c, em2_2920: bitstring);
                                                        {2949}let m2_2921: bitstring = em2_2920 in
                                                        {2950}let (=OpenSecureChannelResponse,=Cli,PartS_2922: bitstring,ST_2923: bitstring,TTL_2924: bitstring) = m2_2921 in
                                                        {2951}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2952}event endCli(Sess,Cli,PartS_2922)
                                                )
                                                else
                                                    {2953}let pkSess_2925: bitstring = fail-any in
                                                    {2954}out(c, GetEndpointRequest);
                                                    {2955}in(c, (=GetEndpointResponse,=pkSess_2925,=None,SP_2926: bitstring,UP_2927: bitstring));
                                                    {2956}new Nc_2928: bitstring;
                                                    {2957}let gNc_2929: bitstring = exp(g,Nc_2928) in
                                                    {2958}let m1_2930: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2929) in
                                                    {2959}event beginCli(Cli,Sess,gNc_2929);
                                                    {2960}out(c, (pkCli_2793,m1_2930));
                                                    {2961}in(c, em2_2931: bitstring);
                                                    {2962}let m2_2932: bitstring = em2_2931 in
                                                    {2963}let (=OpenSecureChannelResponse,=Cli,PartS_2933: bitstring,ST_2934: bitstring,TTL_2935: bitstring) = m2_2932 in
                                                    {2964}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2965}event endCli(Sess,Cli,PartS_2933)
                                        )
                                        else
                                            {2966}let pkSess_2936: bitstring = fail-any in
                                            {2967}out(c, GetEndpointRequest);
                                            {2968}in(c, (=GetEndpointResponse,=pkSess_2936,=None,SP_2937: bitstring,UP_2938: bitstring));
                                            {2969}new Nc_2939: bitstring;
                                            {2970}let gNc_2940: bitstring = exp(g,Nc_2939) in
                                            {2971}let m1_2941: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2940) in
                                            {2972}event beginCli(Cli,Sess,gNc_2940);
                                            {2973}out(c, (pkCli_2793,m1_2941));
                                            {2974}in(c, em2_2942: bitstring);
                                            {2975}let m2_2943: bitstring = em2_2942 in
                                            {2976}let (=OpenSecureChannelResponse,=Cli,PartS_2944: bitstring,ST_2945: bitstring,TTL_2946: bitstring) = m2_2943 in
                                            {2977}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2978}event endCli(Sess,Cli,PartS_2944)
                                )
                                else
                                    {2979}let pkSess_2947: bitstring = fail-any in
                                    {2980}out(c, GetEndpointRequest);
                                    {2981}in(c, (=GetEndpointResponse,=pkSess_2947,=None,SP_2948: bitstring,UP_2949: bitstring));
                                    {2982}new Nc_2950: bitstring;
                                    {2983}let gNc_2951: bitstring = exp(g,Nc_2950) in
                                    {2984}let m1_2952: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2951) in
                                    {2985}event beginCli(Cli,Sess,gNc_2951);
                                    {2986}out(c, (pkCli_2793,m1_2952));
                                    {2987}in(c, em2_2953: bitstring);
                                    {2988}let m2_2954: bitstring = em2_2953 in
                                    {2989}let (=OpenSecureChannelResponse,=Cli,PartS_2955: bitstring,ST_2956: bitstring,TTL_2957: bitstring) = m2_2954 in
                                    {2990}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2991}event endCli(Sess,Cli,PartS_2955)
                            )
                            else
                                {2992}let v_2958: bool = (Disco = C) in
                                (
                                    {2993}if v_2958 then
                                    (
                                        {2994}let pkDisco_2959: bitstring = pub(skC) in
                                        {2995}let v_2960: bool = (Sess = A) in
                                        (
                                            {2996}if v_2960 then
                                            (
                                                {2997}let pkSess_2961: bitstring = pub(skA) in
                                                {2998}out(c, GetEndpointRequest);
                                                {2999}in(c, (=GetEndpointResponse,=pkSess_2961,=None,SP_2962: bitstring,UP_2963: bitstring));
                                                {3000}new Nc_2964: bitstring;
                                                {3001}let gNc_2965: bitstring = exp(g,Nc_2964) in
                                                {3002}let m1_2966: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2965) in
                                                {3003}event beginCli(Cli,Sess,gNc_2965);
                                                {3004}out(c, (pkCli_2793,m1_2966));
                                                {3005}in(c, em2_2967: bitstring);
                                                {3006}let m2_2968: bitstring = em2_2967 in
                                                {3007}let (=OpenSecureChannelResponse,=Cli,PartS_2969: bitstring,ST_2970: bitstring,TTL_2971: bitstring) = m2_2968 in
                                                {3008}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3009}event endCli(Sess,Cli,PartS_2969)
                                            )
                                            else
                                                {3010}let v_2972: bool = (Sess = B) in
                                                (
                                                    {3011}if v_2972 then
                                                    (
                                                        {3012}let pkSess_2973: bitstring = pub(skB) in
                                                        {3013}out(c, GetEndpointRequest);
                                                        {3014}in(c, (=GetEndpointResponse,=pkSess_2973,=None,SP_2974: bitstring,UP_2975: bitstring));
                                                        {3015}new Nc_2976: bitstring;
                                                        {3016}let gNc_2977: bitstring = exp(g,Nc_2976) in
                                                        {3017}let m1_2978: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2977) in
                                                        {3018}event beginCli(Cli,Sess,gNc_2977);
                                                        {3019}out(c, (pkCli_2793,m1_2978));
                                                        {3020}in(c, em2_2979: bitstring);
                                                        {3021}let m2_2980: bitstring = em2_2979 in
                                                        {3022}let (=OpenSecureChannelResponse,=Cli,PartS_2981: bitstring,ST_2982: bitstring,TTL_2983: bitstring) = m2_2980 in
                                                        {3023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3024}event endCli(Sess,Cli,PartS_2981)
                                                    )
                                                    else
                                                        {3025}let v_2984: bool = (Sess = C) in
                                                        (
                                                            {3026}if v_2984 then
                                                            (
                                                                {3027}let pkSess_2985: bitstring = pub(skC) in
                                                                {3028}out(c, GetEndpointRequest);
                                                                {3029}in(c, (=GetEndpointResponse,=pkSess_2985,=None,SP_2986: bitstring,UP_2987: bitstring));
                                                                {3030}new Nc_2988: bitstring;
                                                                {3031}let gNc_2989: bitstring = exp(g,Nc_2988) in
                                                                {3032}let m1_2990: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_2989) in
                                                                {3033}event beginCli(Cli,Sess,gNc_2989);
                                                                {3034}out(c, (pkCli_2793,m1_2990));
                                                                {3035}in(c, em2_2991: bitstring);
                                                                {3036}let m2_2992: bitstring = em2_2991 in
                                                                {3037}let (=OpenSecureChannelResponse,=Cli,PartS_2993: bitstring,ST_2994: bitstring,TTL_2995: bitstring) = m2_2992 in
                                                                {3038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3039}event endCli(Sess,Cli,PartS_2993)
                                                            )
                                                            else
                                                                {3040}let pkSess_2996: bitstring = pub(sk(Sess)) in
                                                                {3041}out(c, GetEndpointRequest);
                                                                {3042}in(c, (=GetEndpointResponse,=pkSess_2996,=None,SP_2997: bitstring,UP_2998: bitstring));
                                                                {3043}new Nc_2999: bitstring;
                                                                {3044}let gNc_3000: bitstring = exp(g,Nc_2999) in
                                                                {3045}let m1_3001: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3000) in
                                                                {3046}event beginCli(Cli,Sess,gNc_3000);
                                                                {3047}out(c, (pkCli_2793,m1_3001));
                                                                {3048}in(c, em2_3002: bitstring);
                                                                {3049}let m2_3003: bitstring = em2_3002 in
                                                                {3050}let (=OpenSecureChannelResponse,=Cli,PartS_3004: bitstring,ST_3005: bitstring,TTL_3006: bitstring) = m2_3003 in
                                                                {3051}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3052}event endCli(Sess,Cli,PartS_3004)
                                                        )
                                                        else
                                                            {3053}let pkSess_3007: bitstring = fail-any in
                                                            {3054}out(c, GetEndpointRequest);
                                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3007,=None,SP_3008: bitstring,UP_3009: bitstring));
                                                            {3056}new Nc_3010: bitstring;
                                                            {3057}let gNc_3011: bitstring = exp(g,Nc_3010) in
                                                            {3058}let m1_3012: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3011) in
                                                            {3059}event beginCli(Cli,Sess,gNc_3011);
                                                            {3060}out(c, (pkCli_2793,m1_3012));
                                                            {3061}in(c, em2_3013: bitstring);
                                                            {3062}let m2_3014: bitstring = em2_3013 in
                                                            {3063}let (=OpenSecureChannelResponse,=Cli,PartS_3015: bitstring,ST_3016: bitstring,TTL_3017: bitstring) = m2_3014 in
                                                            {3064}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3065}event endCli(Sess,Cli,PartS_3015)
                                                )
                                                else
                                                    {3066}let pkSess_3018: bitstring = fail-any in
                                                    {3067}out(c, GetEndpointRequest);
                                                    {3068}in(c, (=GetEndpointResponse,=pkSess_3018,=None,SP_3019: bitstring,UP_3020: bitstring));
                                                    {3069}new Nc_3021: bitstring;
                                                    {3070}let gNc_3022: bitstring = exp(g,Nc_3021) in
                                                    {3071}let m1_3023: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3022) in
                                                    {3072}event beginCli(Cli,Sess,gNc_3022);
                                                    {3073}out(c, (pkCli_2793,m1_3023));
                                                    {3074}in(c, em2_3024: bitstring);
                                                    {3075}let m2_3025: bitstring = em2_3024 in
                                                    {3076}let (=OpenSecureChannelResponse,=Cli,PartS_3026: bitstring,ST_3027: bitstring,TTL_3028: bitstring) = m2_3025 in
                                                    {3077}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3078}event endCli(Sess,Cli,PartS_3026)
                                        )
                                        else
                                            {3079}let pkSess_3029: bitstring = fail-any in
                                            {3080}out(c, GetEndpointRequest);
                                            {3081}in(c, (=GetEndpointResponse,=pkSess_3029,=None,SP_3030: bitstring,UP_3031: bitstring));
                                            {3082}new Nc_3032: bitstring;
                                            {3083}let gNc_3033: bitstring = exp(g,Nc_3032) in
                                            {3084}let m1_3034: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3033) in
                                            {3085}event beginCli(Cli,Sess,gNc_3033);
                                            {3086}out(c, (pkCli_2793,m1_3034));
                                            {3087}in(c, em2_3035: bitstring);
                                            {3088}let m2_3036: bitstring = em2_3035 in
                                            {3089}let (=OpenSecureChannelResponse,=Cli,PartS_3037: bitstring,ST_3038: bitstring,TTL_3039: bitstring) = m2_3036 in
                                            {3090}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3091}event endCli(Sess,Cli,PartS_3037)
                                    )
                                    else
                                        {3092}let pkDisco_3040: bitstring = pub(sk(Disco)) in
                                        {3093}let v_3041: bool = (Sess = A) in
                                        (
                                            {3094}if v_3041 then
                                            (
                                                {3095}let pkSess_3042: bitstring = pub(skA) in
                                                {3096}out(c, GetEndpointRequest);
                                                {3097}in(c, (=GetEndpointResponse,=pkSess_3042,=None,SP_3043: bitstring,UP_3044: bitstring));
                                                {3098}new Nc_3045: bitstring;
                                                {3099}let gNc_3046: bitstring = exp(g,Nc_3045) in
                                                {3100}let m1_3047: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3046) in
                                                {3101}event beginCli(Cli,Sess,gNc_3046);
                                                {3102}out(c, (pkCli_2793,m1_3047));
                                                {3103}in(c, em2_3048: bitstring);
                                                {3104}let m2_3049: bitstring = em2_3048 in
                                                {3105}let (=OpenSecureChannelResponse,=Cli,PartS_3050: bitstring,ST_3051: bitstring,TTL_3052: bitstring) = m2_3049 in
                                                {3106}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3107}event endCli(Sess,Cli,PartS_3050)
                                            )
                                            else
                                                {3108}let v_3053: bool = (Sess = B) in
                                                (
                                                    {3109}if v_3053 then
                                                    (
                                                        {3110}let pkSess_3054: bitstring = pub(skB) in
                                                        {3111}out(c, GetEndpointRequest);
                                                        {3112}in(c, (=GetEndpointResponse,=pkSess_3054,=None,SP_3055: bitstring,UP_3056: bitstring));
                                                        {3113}new Nc_3057: bitstring;
                                                        {3114}let gNc_3058: bitstring = exp(g,Nc_3057) in
                                                        {3115}let m1_3059: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3058) in
                                                        {3116}event beginCli(Cli,Sess,gNc_3058);
                                                        {3117}out(c, (pkCli_2793,m1_3059));
                                                        {3118}in(c, em2_3060: bitstring);
                                                        {3119}let m2_3061: bitstring = em2_3060 in
                                                        {3120}let (=OpenSecureChannelResponse,=Cli,PartS_3062: bitstring,ST_3063: bitstring,TTL_3064: bitstring) = m2_3061 in
                                                        {3121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3122}event endCli(Sess,Cli,PartS_3062)
                                                    )
                                                    else
                                                        {3123}let v_3065: bool = (Sess = C) in
                                                        (
                                                            {3124}if v_3065 then
                                                            (
                                                                {3125}let pkSess_3066: bitstring = pub(skC) in
                                                                {3126}out(c, GetEndpointRequest);
                                                                {3127}in(c, (=GetEndpointResponse,=pkSess_3066,=None,SP_3067: bitstring,UP_3068: bitstring));
                                                                {3128}new Nc_3069: bitstring;
                                                                {3129}let gNc_3070: bitstring = exp(g,Nc_3069) in
                                                                {3130}let m1_3071: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3070) in
                                                                {3131}event beginCli(Cli,Sess,gNc_3070);
                                                                {3132}out(c, (pkCli_2793,m1_3071));
                                                                {3133}in(c, em2_3072: bitstring);
                                                                {3134}let m2_3073: bitstring = em2_3072 in
                                                                {3135}let (=OpenSecureChannelResponse,=Cli,PartS_3074: bitstring,ST_3075: bitstring,TTL_3076: bitstring) = m2_3073 in
                                                                {3136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3137}event endCli(Sess,Cli,PartS_3074)
                                                            )
                                                            else
                                                                {3138}let pkSess_3077: bitstring = pub(sk(Sess)) in
                                                                {3139}out(c, GetEndpointRequest);
                                                                {3140}in(c, (=GetEndpointResponse,=pkSess_3077,=None,SP_3078: bitstring,UP_3079: bitstring));
                                                                {3141}new Nc_3080: bitstring;
                                                                {3142}let gNc_3081: bitstring = exp(g,Nc_3080) in
                                                                {3143}let m1_3082: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3081) in
                                                                {3144}event beginCli(Cli,Sess,gNc_3081);
                                                                {3145}out(c, (pkCli_2793,m1_3082));
                                                                {3146}in(c, em2_3083: bitstring);
                                                                {3147}let m2_3084: bitstring = em2_3083 in
                                                                {3148}let (=OpenSecureChannelResponse,=Cli,PartS_3085: bitstring,ST_3086: bitstring,TTL_3087: bitstring) = m2_3084 in
                                                                {3149}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3150}event endCli(Sess,Cli,PartS_3085)
                                                        )
                                                        else
                                                            {3151}let pkSess_3088: bitstring = fail-any in
                                                            {3152}out(c, GetEndpointRequest);
                                                            {3153}in(c, (=GetEndpointResponse,=pkSess_3088,=None,SP_3089: bitstring,UP_3090: bitstring));
                                                            {3154}new Nc_3091: bitstring;
                                                            {3155}let gNc_3092: bitstring = exp(g,Nc_3091) in
                                                            {3156}let m1_3093: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3092) in
                                                            {3157}event beginCli(Cli,Sess,gNc_3092);
                                                            {3158}out(c, (pkCli_2793,m1_3093));
                                                            {3159}in(c, em2_3094: bitstring);
                                                            {3160}let m2_3095: bitstring = em2_3094 in
                                                            {3161}let (=OpenSecureChannelResponse,=Cli,PartS_3096: bitstring,ST_3097: bitstring,TTL_3098: bitstring) = m2_3095 in
                                                            {3162}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3163}event endCli(Sess,Cli,PartS_3096)
                                                )
                                                else
                                                    {3164}let pkSess_3099: bitstring = fail-any in
                                                    {3165}out(c, GetEndpointRequest);
                                                    {3166}in(c, (=GetEndpointResponse,=pkSess_3099,=None,SP_3100: bitstring,UP_3101: bitstring));
                                                    {3167}new Nc_3102: bitstring;
                                                    {3168}let gNc_3103: bitstring = exp(g,Nc_3102) in
                                                    {3169}let m1_3104: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3103) in
                                                    {3170}event beginCli(Cli,Sess,gNc_3103);
                                                    {3171}out(c, (pkCli_2793,m1_3104));
                                                    {3172}in(c, em2_3105: bitstring);
                                                    {3173}let m2_3106: bitstring = em2_3105 in
                                                    {3174}let (=OpenSecureChannelResponse,=Cli,PartS_3107: bitstring,ST_3108: bitstring,TTL_3109: bitstring) = m2_3106 in
                                                    {3175}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3176}event endCli(Sess,Cli,PartS_3107)
                                        )
                                        else
                                            {3177}let pkSess_3110: bitstring = fail-any in
                                            {3178}out(c, GetEndpointRequest);
                                            {3179}in(c, (=GetEndpointResponse,=pkSess_3110,=None,SP_3111: bitstring,UP_3112: bitstring));
                                            {3180}new Nc_3113: bitstring;
                                            {3181}let gNc_3114: bitstring = exp(g,Nc_3113) in
                                            {3182}let m1_3115: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3114) in
                                            {3183}event beginCli(Cli,Sess,gNc_3114);
                                            {3184}out(c, (pkCli_2793,m1_3115));
                                            {3185}in(c, em2_3116: bitstring);
                                            {3186}let m2_3117: bitstring = em2_3116 in
                                            {3187}let (=OpenSecureChannelResponse,=Cli,PartS_3118: bitstring,ST_3119: bitstring,TTL_3120: bitstring) = m2_3117 in
                                            {3188}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3189}event endCli(Sess,Cli,PartS_3118)
                                )
                                else
                                    {3190}let pkDisco_3121: bitstring = fail-any in
                                    {3191}let v_3122: bool = (Sess = A) in
                                    (
                                        {3192}if v_3122 then
                                        (
                                            {3193}let pkSess_3123: bitstring = pub(skA) in
                                            {3194}out(c, GetEndpointRequest);
                                            {3195}in(c, (=GetEndpointResponse,=pkSess_3123,=None,SP_3124: bitstring,UP_3125: bitstring));
                                            {3196}new Nc_3126: bitstring;
                                            {3197}let gNc_3127: bitstring = exp(g,Nc_3126) in
                                            {3198}let m1_3128: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3127) in
                                            {3199}event beginCli(Cli,Sess,gNc_3127);
                                            {3200}out(c, (pkCli_2793,m1_3128));
                                            {3201}in(c, em2_3129: bitstring);
                                            {3202}let m2_3130: bitstring = em2_3129 in
                                            {3203}let (=OpenSecureChannelResponse,=Cli,PartS_3131: bitstring,ST_3132: bitstring,TTL_3133: bitstring) = m2_3130 in
                                            {3204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3205}event endCli(Sess,Cli,PartS_3131)
                                        )
                                        else
                                            {3206}let v_3134: bool = (Sess = B) in
                                            (
                                                {3207}if v_3134 then
                                                (
                                                    {3208}let pkSess_3135: bitstring = pub(skB) in
                                                    {3209}out(c, GetEndpointRequest);
                                                    {3210}in(c, (=GetEndpointResponse,=pkSess_3135,=None,SP_3136: bitstring,UP_3137: bitstring));
                                                    {3211}new Nc_3138: bitstring;
                                                    {3212}let gNc_3139: bitstring = exp(g,Nc_3138) in
                                                    {3213}let m1_3140: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3139) in
                                                    {3214}event beginCli(Cli,Sess,gNc_3139);
                                                    {3215}out(c, (pkCli_2793,m1_3140));
                                                    {3216}in(c, em2_3141: bitstring);
                                                    {3217}let m2_3142: bitstring = em2_3141 in
                                                    {3218}let (=OpenSecureChannelResponse,=Cli,PartS_3143: bitstring,ST_3144: bitstring,TTL_3145: bitstring) = m2_3142 in
                                                    {3219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3220}event endCli(Sess,Cli,PartS_3143)
                                                )
                                                else
                                                    {3221}let v_3146: bool = (Sess = C) in
                                                    (
                                                        {3222}if v_3146 then
                                                        (
                                                            {3223}let pkSess_3147: bitstring = pub(skC) in
                                                            {3224}out(c, GetEndpointRequest);
                                                            {3225}in(c, (=GetEndpointResponse,=pkSess_3147,=None,SP_3148: bitstring,UP_3149: bitstring));
                                                            {3226}new Nc_3150: bitstring;
                                                            {3227}let gNc_3151: bitstring = exp(g,Nc_3150) in
                                                            {3228}let m1_3152: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3151) in
                                                            {3229}event beginCli(Cli,Sess,gNc_3151);
                                                            {3230}out(c, (pkCli_2793,m1_3152));
                                                            {3231}in(c, em2_3153: bitstring);
                                                            {3232}let m2_3154: bitstring = em2_3153 in
                                                            {3233}let (=OpenSecureChannelResponse,=Cli,PartS_3155: bitstring,ST_3156: bitstring,TTL_3157: bitstring) = m2_3154 in
                                                            {3234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3235}event endCli(Sess,Cli,PartS_3155)
                                                        )
                                                        else
                                                            {3236}let pkSess_3158: bitstring = pub(sk(Sess)) in
                                                            {3237}out(c, GetEndpointRequest);
                                                            {3238}in(c, (=GetEndpointResponse,=pkSess_3158,=None,SP_3159: bitstring,UP_3160: bitstring));
                                                            {3239}new Nc_3161: bitstring;
                                                            {3240}let gNc_3162: bitstring = exp(g,Nc_3161) in
                                                            {3241}let m1_3163: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3162) in
                                                            {3242}event beginCli(Cli,Sess,gNc_3162);
                                                            {3243}out(c, (pkCli_2793,m1_3163));
                                                            {3244}in(c, em2_3164: bitstring);
                                                            {3245}let m2_3165: bitstring = em2_3164 in
                                                            {3246}let (=OpenSecureChannelResponse,=Cli,PartS_3166: bitstring,ST_3167: bitstring,TTL_3168: bitstring) = m2_3165 in
                                                            {3247}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3248}event endCli(Sess,Cli,PartS_3166)
                                                    )
                                                    else
                                                        {3249}let pkSess_3169: bitstring = fail-any in
                                                        {3250}out(c, GetEndpointRequest);
                                                        {3251}in(c, (=GetEndpointResponse,=pkSess_3169,=None,SP_3170: bitstring,UP_3171: bitstring));
                                                        {3252}new Nc_3172: bitstring;
                                                        {3253}let gNc_3173: bitstring = exp(g,Nc_3172) in
                                                        {3254}let m1_3174: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3173) in
                                                        {3255}event beginCli(Cli,Sess,gNc_3173);
                                                        {3256}out(c, (pkCli_2793,m1_3174));
                                                        {3257}in(c, em2_3175: bitstring);
                                                        {3258}let m2_3176: bitstring = em2_3175 in
                                                        {3259}let (=OpenSecureChannelResponse,=Cli,PartS_3177: bitstring,ST_3178: bitstring,TTL_3179: bitstring) = m2_3176 in
                                                        {3260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3261}event endCli(Sess,Cli,PartS_3177)
                                            )
                                            else
                                                {3262}let pkSess_3180: bitstring = fail-any in
                                                {3263}out(c, GetEndpointRequest);
                                                {3264}in(c, (=GetEndpointResponse,=pkSess_3180,=None,SP_3181: bitstring,UP_3182: bitstring));
                                                {3265}new Nc_3183: bitstring;
                                                {3266}let gNc_3184: bitstring = exp(g,Nc_3183) in
                                                {3267}let m1_3185: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3184) in
                                                {3268}event beginCli(Cli,Sess,gNc_3184);
                                                {3269}out(c, (pkCli_2793,m1_3185));
                                                {3270}in(c, em2_3186: bitstring);
                                                {3271}let m2_3187: bitstring = em2_3186 in
                                                {3272}let (=OpenSecureChannelResponse,=Cli,PartS_3188: bitstring,ST_3189: bitstring,TTL_3190: bitstring) = m2_3187 in
                                                {3273}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3274}event endCli(Sess,Cli,PartS_3188)
                                    )
                                    else
                                        {3275}let pkSess_3191: bitstring = fail-any in
                                        {3276}out(c, GetEndpointRequest);
                                        {3277}in(c, (=GetEndpointResponse,=pkSess_3191,=None,SP_3192: bitstring,UP_3193: bitstring));
                                        {3278}new Nc_3194: bitstring;
                                        {3279}let gNc_3195: bitstring = exp(g,Nc_3194) in
                                        {3280}let m1_3196: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3195) in
                                        {3281}event beginCli(Cli,Sess,gNc_3195);
                                        {3282}out(c, (pkCli_2793,m1_3196));
                                        {3283}in(c, em2_3197: bitstring);
                                        {3284}let m2_3198: bitstring = em2_3197 in
                                        {3285}let (=OpenSecureChannelResponse,=Cli,PartS_3199: bitstring,ST_3200: bitstring,TTL_3201: bitstring) = m2_3198 in
                                        {3286}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3287}event endCli(Sess,Cli,PartS_3199)
                        )
                        else
                            {3288}let pkDisco_3202: bitstring = fail-any in
                            {3289}let v_3203: bool = (Sess = A) in
                            (
                                {3290}if v_3203 then
                                (
                                    {3291}let pkSess_3204: bitstring = pub(skA) in
                                    {3292}out(c, GetEndpointRequest);
                                    {3293}in(c, (=GetEndpointResponse,=pkSess_3204,=None,SP_3205: bitstring,UP_3206: bitstring));
                                    {3294}new Nc_3207: bitstring;
                                    {3295}let gNc_3208: bitstring = exp(g,Nc_3207) in
                                    {3296}let m1_3209: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3208) in
                                    {3297}event beginCli(Cli,Sess,gNc_3208);
                                    {3298}out(c, (pkCli_2793,m1_3209));
                                    {3299}in(c, em2_3210: bitstring);
                                    {3300}let m2_3211: bitstring = em2_3210 in
                                    {3301}let (=OpenSecureChannelResponse,=Cli,PartS_3212: bitstring,ST_3213: bitstring,TTL_3214: bitstring) = m2_3211 in
                                    {3302}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3303}event endCli(Sess,Cli,PartS_3212)
                                )
                                else
                                    {3304}let v_3215: bool = (Sess = B) in
                                    (
                                        {3305}if v_3215 then
                                        (
                                            {3306}let pkSess_3216: bitstring = pub(skB) in
                                            {3307}out(c, GetEndpointRequest);
                                            {3308}in(c, (=GetEndpointResponse,=pkSess_3216,=None,SP_3217: bitstring,UP_3218: bitstring));
                                            {3309}new Nc_3219: bitstring;
                                            {3310}let gNc_3220: bitstring = exp(g,Nc_3219) in
                                            {3311}let m1_3221: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3220) in
                                            {3312}event beginCli(Cli,Sess,gNc_3220);
                                            {3313}out(c, (pkCli_2793,m1_3221));
                                            {3314}in(c, em2_3222: bitstring);
                                            {3315}let m2_3223: bitstring = em2_3222 in
                                            {3316}let (=OpenSecureChannelResponse,=Cli,PartS_3224: bitstring,ST_3225: bitstring,TTL_3226: bitstring) = m2_3223 in
                                            {3317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3318}event endCli(Sess,Cli,PartS_3224)
                                        )
                                        else
                                            {3319}let v_3227: bool = (Sess = C) in
                                            (
                                                {3320}if v_3227 then
                                                (
                                                    {3321}let pkSess_3228: bitstring = pub(skC) in
                                                    {3322}out(c, GetEndpointRequest);
                                                    {3323}in(c, (=GetEndpointResponse,=pkSess_3228,=None,SP_3229: bitstring,UP_3230: bitstring));
                                                    {3324}new Nc_3231: bitstring;
                                                    {3325}let gNc_3232: bitstring = exp(g,Nc_3231) in
                                                    {3326}let m1_3233: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3232) in
                                                    {3327}event beginCli(Cli,Sess,gNc_3232);
                                                    {3328}out(c, (pkCli_2793,m1_3233));
                                                    {3329}in(c, em2_3234: bitstring);
                                                    {3330}let m2_3235: bitstring = em2_3234 in
                                                    {3331}let (=OpenSecureChannelResponse,=Cli,PartS_3236: bitstring,ST_3237: bitstring,TTL_3238: bitstring) = m2_3235 in
                                                    {3332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3333}event endCli(Sess,Cli,PartS_3236)
                                                )
                                                else
                                                    {3334}let pkSess_3239: bitstring = pub(sk(Sess)) in
                                                    {3335}out(c, GetEndpointRequest);
                                                    {3336}in(c, (=GetEndpointResponse,=pkSess_3239,=None,SP_3240: bitstring,UP_3241: bitstring));
                                                    {3337}new Nc_3242: bitstring;
                                                    {3338}let gNc_3243: bitstring = exp(g,Nc_3242) in
                                                    {3339}let m1_3244: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3243) in
                                                    {3340}event beginCli(Cli,Sess,gNc_3243);
                                                    {3341}out(c, (pkCli_2793,m1_3244));
                                                    {3342}in(c, em2_3245: bitstring);
                                                    {3343}let m2_3246: bitstring = em2_3245 in
                                                    {3344}let (=OpenSecureChannelResponse,=Cli,PartS_3247: bitstring,ST_3248: bitstring,TTL_3249: bitstring) = m2_3246 in
                                                    {3345}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3346}event endCli(Sess,Cli,PartS_3247)
                                            )
                                            else
                                                {3347}let pkSess_3250: bitstring = fail-any in
                                                {3348}out(c, GetEndpointRequest);
                                                {3349}in(c, (=GetEndpointResponse,=pkSess_3250,=None,SP_3251: bitstring,UP_3252: bitstring));
                                                {3350}new Nc_3253: bitstring;
                                                {3351}let gNc_3254: bitstring = exp(g,Nc_3253) in
                                                {3352}let m1_3255: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3254) in
                                                {3353}event beginCli(Cli,Sess,gNc_3254);
                                                {3354}out(c, (pkCli_2793,m1_3255));
                                                {3355}in(c, em2_3256: bitstring);
                                                {3356}let m2_3257: bitstring = em2_3256 in
                                                {3357}let (=OpenSecureChannelResponse,=Cli,PartS_3258: bitstring,ST_3259: bitstring,TTL_3260: bitstring) = m2_3257 in
                                                {3358}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3359}event endCli(Sess,Cli,PartS_3258)
                                    )
                                    else
                                        {3360}let pkSess_3261: bitstring = fail-any in
                                        {3361}out(c, GetEndpointRequest);
                                        {3362}in(c, (=GetEndpointResponse,=pkSess_3261,=None,SP_3262: bitstring,UP_3263: bitstring));
                                        {3363}new Nc_3264: bitstring;
                                        {3364}let gNc_3265: bitstring = exp(g,Nc_3264) in
                                        {3365}let m1_3266: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3265) in
                                        {3366}event beginCli(Cli,Sess,gNc_3265);
                                        {3367}out(c, (pkCli_2793,m1_3266));
                                        {3368}in(c, em2_3267: bitstring);
                                        {3369}let m2_3268: bitstring = em2_3267 in
                                        {3370}let (=OpenSecureChannelResponse,=Cli,PartS_3269: bitstring,ST_3270: bitstring,TTL_3271: bitstring) = m2_3268 in
                                        {3371}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3372}event endCli(Sess,Cli,PartS_3269)
                            )
                            else
                                {3373}let pkSess_3272: bitstring = fail-any in
                                {3374}out(c, GetEndpointRequest);
                                {3375}in(c, (=GetEndpointResponse,=pkSess_3272,=None,SP_3273: bitstring,UP_3274: bitstring));
                                {3376}new Nc_3275: bitstring;
                                {3377}let gNc_3276: bitstring = exp(g,Nc_3275) in
                                {3378}let m1_3277: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3276) in
                                {3379}event beginCli(Cli,Sess,gNc_3276);
                                {3380}out(c, (pkCli_2793,m1_3277));
                                {3381}in(c, em2_3278: bitstring);
                                {3382}let m2_3279: bitstring = em2_3278 in
                                {3383}let (=OpenSecureChannelResponse,=Cli,PartS_3280: bitstring,ST_3281: bitstring,TTL_3282: bitstring) = m2_3279 in
                                {3384}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3385}event endCli(Sess,Cli,PartS_3280)
                )
                else
                    {3386}let pkDisco_3283: bitstring = fail-any in
                    {3387}let v_3284: bool = (Sess = A) in
                    (
                        {3388}if v_3284 then
                        (
                            {3389}let pkSess_3285: bitstring = pub(skA) in
                            {3390}out(c, GetEndpointRequest);
                            {3391}in(c, (=GetEndpointResponse,=pkSess_3285,=None,SP_3286: bitstring,UP_3287: bitstring));
                            {3392}new Nc_3288: bitstring;
                            {3393}let gNc_3289: bitstring = exp(g,Nc_3288) in
                            {3394}let m1_3290: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3289) in
                            {3395}event beginCli(Cli,Sess,gNc_3289);
                            {3396}out(c, (pkCli_2793,m1_3290));
                            {3397}in(c, em2_3291: bitstring);
                            {3398}let m2_3292: bitstring = em2_3291 in
                            {3399}let (=OpenSecureChannelResponse,=Cli,PartS_3293: bitstring,ST_3294: bitstring,TTL_3295: bitstring) = m2_3292 in
                            {3400}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3401}event endCli(Sess,Cli,PartS_3293)
                        )
                        else
                            {3402}let v_3296: bool = (Sess = B) in
                            (
                                {3403}if v_3296 then
                                (
                                    {3404}let pkSess_3297: bitstring = pub(skB) in
                                    {3405}out(c, GetEndpointRequest);
                                    {3406}in(c, (=GetEndpointResponse,=pkSess_3297,=None,SP_3298: bitstring,UP_3299: bitstring));
                                    {3407}new Nc_3300: bitstring;
                                    {3408}let gNc_3301: bitstring = exp(g,Nc_3300) in
                                    {3409}let m1_3302: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3301) in
                                    {3410}event beginCli(Cli,Sess,gNc_3301);
                                    {3411}out(c, (pkCli_2793,m1_3302));
                                    {3412}in(c, em2_3303: bitstring);
                                    {3413}let m2_3304: bitstring = em2_3303 in
                                    {3414}let (=OpenSecureChannelResponse,=Cli,PartS_3305: bitstring,ST_3306: bitstring,TTL_3307: bitstring) = m2_3304 in
                                    {3415}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3416}event endCli(Sess,Cli,PartS_3305)
                                )
                                else
                                    {3417}let v_3308: bool = (Sess = C) in
                                    (
                                        {3418}if v_3308 then
                                        (
                                            {3419}let pkSess_3309: bitstring = pub(skC) in
                                            {3420}out(c, GetEndpointRequest);
                                            {3421}in(c, (=GetEndpointResponse,=pkSess_3309,=None,SP_3310: bitstring,UP_3311: bitstring));
                                            {3422}new Nc_3312: bitstring;
                                            {3423}let gNc_3313: bitstring = exp(g,Nc_3312) in
                                            {3424}let m1_3314: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3313) in
                                            {3425}event beginCli(Cli,Sess,gNc_3313);
                                            {3426}out(c, (pkCli_2793,m1_3314));
                                            {3427}in(c, em2_3315: bitstring);
                                            {3428}let m2_3316: bitstring = em2_3315 in
                                            {3429}let (=OpenSecureChannelResponse,=Cli,PartS_3317: bitstring,ST_3318: bitstring,TTL_3319: bitstring) = m2_3316 in
                                            {3430}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3431}event endCli(Sess,Cli,PartS_3317)
                                        )
                                        else
                                            {3432}let pkSess_3320: bitstring = pub(sk(Sess)) in
                                            {3433}out(c, GetEndpointRequest);
                                            {3434}in(c, (=GetEndpointResponse,=pkSess_3320,=None,SP_3321: bitstring,UP_3322: bitstring));
                                            {3435}new Nc_3323: bitstring;
                                            {3436}let gNc_3324: bitstring = exp(g,Nc_3323) in
                                            {3437}let m1_3325: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3324) in
                                            {3438}event beginCli(Cli,Sess,gNc_3324);
                                            {3439}out(c, (pkCli_2793,m1_3325));
                                            {3440}in(c, em2_3326: bitstring);
                                            {3441}let m2_3327: bitstring = em2_3326 in
                                            {3442}let (=OpenSecureChannelResponse,=Cli,PartS_3328: bitstring,ST_3329: bitstring,TTL_3330: bitstring) = m2_3327 in
                                            {3443}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3444}event endCli(Sess,Cli,PartS_3328)
                                    )
                                    else
                                        {3445}let pkSess_3331: bitstring = fail-any in
                                        {3446}out(c, GetEndpointRequest);
                                        {3447}in(c, (=GetEndpointResponse,=pkSess_3331,=None,SP_3332: bitstring,UP_3333: bitstring));
                                        {3448}new Nc_3334: bitstring;
                                        {3449}let gNc_3335: bitstring = exp(g,Nc_3334) in
                                        {3450}let m1_3336: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3335) in
                                        {3451}event beginCli(Cli,Sess,gNc_3335);
                                        {3452}out(c, (pkCli_2793,m1_3336));
                                        {3453}in(c, em2_3337: bitstring);
                                        {3454}let m2_3338: bitstring = em2_3337 in
                                        {3455}let (=OpenSecureChannelResponse,=Cli,PartS_3339: bitstring,ST_3340: bitstring,TTL_3341: bitstring) = m2_3338 in
                                        {3456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3457}event endCli(Sess,Cli,PartS_3339)
                            )
                            else
                                {3458}let pkSess_3342: bitstring = fail-any in
                                {3459}out(c, GetEndpointRequest);
                                {3460}in(c, (=GetEndpointResponse,=pkSess_3342,=None,SP_3343: bitstring,UP_3344: bitstring));
                                {3461}new Nc_3345: bitstring;
                                {3462}let gNc_3346: bitstring = exp(g,Nc_3345) in
                                {3463}let m1_3347: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3346) in
                                {3464}event beginCli(Cli,Sess,gNc_3346);
                                {3465}out(c, (pkCli_2793,m1_3347));
                                {3466}in(c, em2_3348: bitstring);
                                {3467}let m2_3349: bitstring = em2_3348 in
                                {3468}let (=OpenSecureChannelResponse,=Cli,PartS_3350: bitstring,ST_3351: bitstring,TTL_3352: bitstring) = m2_3349 in
                                {3469}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3470}event endCli(Sess,Cli,PartS_3350)
                    )
                    else
                        {3471}let pkSess_3353: bitstring = fail-any in
                        {3472}out(c, GetEndpointRequest);
                        {3473}in(c, (=GetEndpointResponse,=pkSess_3353,=None,SP_3354: bitstring,UP_3355: bitstring));
                        {3474}new Nc_3356: bitstring;
                        {3475}let gNc_3357: bitstring = exp(g,Nc_3356) in
                        {3476}let m1_3358: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2793,gNc_3357) in
                        {3477}event beginCli(Cli,Sess,gNc_3357);
                        {3478}out(c, (pkCli_2793,m1_3358));
                        {3479}in(c, em2_3359: bitstring);
                        {3480}let m2_3360: bitstring = em2_3359 in
                        {3481}let (=OpenSecureChannelResponse,=Cli,PartS_3361: bitstring,ST_3362: bitstring,TTL_3363: bitstring) = m2_3360 in
                        {3482}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3483}event endCli(Sess,Cli,PartS_3361)
    )
    else
        {3484}let skCli_3364: bitstring = fail-any in
        {3485}let pkCli_3365: bitstring = pub(skCli_3364) in
        {3486}let v_3366: bool = (Disco = A) in
        (
            {3487}if v_3366 then
            (
                {3488}let pkDisco_3367: bitstring = pub(skA) in
                {3489}let v_3368: bool = (Sess = A) in
                (
                    {3490}if v_3368 then
                    (
                        {3491}let pkSess_3369: bitstring = pub(skA) in
                        {3492}out(c, GetEndpointRequest);
                        {3493}in(c, (=GetEndpointResponse,=pkSess_3369,=None,SP_3370: bitstring,UP_3371: bitstring));
                        {3494}new Nc_3372: bitstring;
                        {3495}let gNc_3373: bitstring = exp(g,Nc_3372) in
                        {3496}let m1_3374: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3373) in
                        {3497}event beginCli(Cli,Sess,gNc_3373);
                        {3498}out(c, (pkCli_3365,m1_3374));
                        {3499}in(c, em2_3375: bitstring);
                        {3500}let m2_3376: bitstring = em2_3375 in
                        {3501}let (=OpenSecureChannelResponse,=Cli,PartS_3377: bitstring,ST_3378: bitstring,TTL_3379: bitstring) = m2_3376 in
                        {3502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3503}event endCli(Sess,Cli,PartS_3377)
                    )
                    else
                        {3504}let v_3380: bool = (Sess = B) in
                        (
                            {3505}if v_3380 then
                            (
                                {3506}let pkSess_3381: bitstring = pub(skB) in
                                {3507}out(c, GetEndpointRequest);
                                {3508}in(c, (=GetEndpointResponse,=pkSess_3381,=None,SP_3382: bitstring,UP_3383: bitstring));
                                {3509}new Nc_3384: bitstring;
                                {3510}let gNc_3385: bitstring = exp(g,Nc_3384) in
                                {3511}let m1_3386: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3385) in
                                {3512}event beginCli(Cli,Sess,gNc_3385);
                                {3513}out(c, (pkCli_3365,m1_3386));
                                {3514}in(c, em2_3387: bitstring);
                                {3515}let m2_3388: bitstring = em2_3387 in
                                {3516}let (=OpenSecureChannelResponse,=Cli,PartS_3389: bitstring,ST_3390: bitstring,TTL_3391: bitstring) = m2_3388 in
                                {3517}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3518}event endCli(Sess,Cli,PartS_3389)
                            )
                            else
                                {3519}let v_3392: bool = (Sess = C) in
                                (
                                    {3520}if v_3392 then
                                    (
                                        {3521}let pkSess_3393: bitstring = pub(skC) in
                                        {3522}out(c, GetEndpointRequest);
                                        {3523}in(c, (=GetEndpointResponse,=pkSess_3393,=None,SP_3394: bitstring,UP_3395: bitstring));
                                        {3524}new Nc_3396: bitstring;
                                        {3525}let gNc_3397: bitstring = exp(g,Nc_3396) in
                                        {3526}let m1_3398: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3397) in
                                        {3527}event beginCli(Cli,Sess,gNc_3397);
                                        {3528}out(c, (pkCli_3365,m1_3398));
                                        {3529}in(c, em2_3399: bitstring);
                                        {3530}let m2_3400: bitstring = em2_3399 in
                                        {3531}let (=OpenSecureChannelResponse,=Cli,PartS_3401: bitstring,ST_3402: bitstring,TTL_3403: bitstring) = m2_3400 in
                                        {3532}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3533}event endCli(Sess,Cli,PartS_3401)
                                    )
                                    else
                                        {3534}let pkSess_3404: bitstring = pub(sk(Sess)) in
                                        {3535}out(c, GetEndpointRequest);
                                        {3536}in(c, (=GetEndpointResponse,=pkSess_3404,=None,SP_3405: bitstring,UP_3406: bitstring));
                                        {3537}new Nc_3407: bitstring;
                                        {3538}let gNc_3408: bitstring = exp(g,Nc_3407) in
                                        {3539}let m1_3409: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3408) in
                                        {3540}event beginCli(Cli,Sess,gNc_3408);
                                        {3541}out(c, (pkCli_3365,m1_3409));
                                        {3542}in(c, em2_3410: bitstring);
                                        {3543}let m2_3411: bitstring = em2_3410 in
                                        {3544}let (=OpenSecureChannelResponse,=Cli,PartS_3412: bitstring,ST_3413: bitstring,TTL_3414: bitstring) = m2_3411 in
                                        {3545}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3546}event endCli(Sess,Cli,PartS_3412)
                                )
                                else
                                    {3547}let pkSess_3415: bitstring = fail-any in
                                    {3548}out(c, GetEndpointRequest);
                                    {3549}in(c, (=GetEndpointResponse,=pkSess_3415,=None,SP_3416: bitstring,UP_3417: bitstring));
                                    {3550}new Nc_3418: bitstring;
                                    {3551}let gNc_3419: bitstring = exp(g,Nc_3418) in
                                    {3552}let m1_3420: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3419) in
                                    {3553}event beginCli(Cli,Sess,gNc_3419);
                                    {3554}out(c, (pkCli_3365,m1_3420));
                                    {3555}in(c, em2_3421: bitstring);
                                    {3556}let m2_3422: bitstring = em2_3421 in
                                    {3557}let (=OpenSecureChannelResponse,=Cli,PartS_3423: bitstring,ST_3424: bitstring,TTL_3425: bitstring) = m2_3422 in
                                    {3558}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3559}event endCli(Sess,Cli,PartS_3423)
                        )
                        else
                            {3560}let pkSess_3426: bitstring = fail-any in
                            {3561}out(c, GetEndpointRequest);
                            {3562}in(c, (=GetEndpointResponse,=pkSess_3426,=None,SP_3427: bitstring,UP_3428: bitstring));
                            {3563}new Nc_3429: bitstring;
                            {3564}let gNc_3430: bitstring = exp(g,Nc_3429) in
                            {3565}let m1_3431: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3430) in
                            {3566}event beginCli(Cli,Sess,gNc_3430);
                            {3567}out(c, (pkCli_3365,m1_3431));
                            {3568}in(c, em2_3432: bitstring);
                            {3569}let m2_3433: bitstring = em2_3432 in
                            {3570}let (=OpenSecureChannelResponse,=Cli,PartS_3434: bitstring,ST_3435: bitstring,TTL_3436: bitstring) = m2_3433 in
                            {3571}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3572}event endCli(Sess,Cli,PartS_3434)
                )
                else
                    {3573}let pkSess_3437: bitstring = fail-any in
                    {3574}out(c, GetEndpointRequest);
                    {3575}in(c, (=GetEndpointResponse,=pkSess_3437,=None,SP_3438: bitstring,UP_3439: bitstring));
                    {3576}new Nc_3440: bitstring;
                    {3577}let gNc_3441: bitstring = exp(g,Nc_3440) in
                    {3578}let m1_3442: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3441) in
                    {3579}event beginCli(Cli,Sess,gNc_3441);
                    {3580}out(c, (pkCli_3365,m1_3442));
                    {3581}in(c, em2_3443: bitstring);
                    {3582}let m2_3444: bitstring = em2_3443 in
                    {3583}let (=OpenSecureChannelResponse,=Cli,PartS_3445: bitstring,ST_3446: bitstring,TTL_3447: bitstring) = m2_3444 in
                    {3584}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {3585}event endCli(Sess,Cli,PartS_3445)
            )
            else
                {3586}let v_3448: bool = (Disco = B) in
                (
                    {3587}if v_3448 then
                    (
                        {3588}let pkDisco_3449: bitstring = pub(skB) in
                        {3589}let v_3450: bool = (Sess = A) in
                        (
                            {3590}if v_3450 then
                            (
                                {3591}let pkSess_3451: bitstring = pub(skA) in
                                {3592}out(c, GetEndpointRequest);
                                {3593}in(c, (=GetEndpointResponse,=pkSess_3451,=None,SP_3452: bitstring,UP_3453: bitstring));
                                {3594}new Nc_3454: bitstring;
                                {3595}let gNc_3455: bitstring = exp(g,Nc_3454) in
                                {3596}let m1_3456: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3455) in
                                {3597}event beginCli(Cli,Sess,gNc_3455);
                                {3598}out(c, (pkCli_3365,m1_3456));
                                {3599}in(c, em2_3457: bitstring);
                                {3600}let m2_3458: bitstring = em2_3457 in
                                {3601}let (=OpenSecureChannelResponse,=Cli,PartS_3459: bitstring,ST_3460: bitstring,TTL_3461: bitstring) = m2_3458 in
                                {3602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3603}event endCli(Sess,Cli,PartS_3459)
                            )
                            else
                                {3604}let v_3462: bool = (Sess = B) in
                                (
                                    {3605}if v_3462 then
                                    (
                                        {3606}let pkSess_3463: bitstring = pub(skB) in
                                        {3607}out(c, GetEndpointRequest);
                                        {3608}in(c, (=GetEndpointResponse,=pkSess_3463,=None,SP_3464: bitstring,UP_3465: bitstring));
                                        {3609}new Nc_3466: bitstring;
                                        {3610}let gNc_3467: bitstring = exp(g,Nc_3466) in
                                        {3611}let m1_3468: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3467) in
                                        {3612}event beginCli(Cli,Sess,gNc_3467);
                                        {3613}out(c, (pkCli_3365,m1_3468));
                                        {3614}in(c, em2_3469: bitstring);
                                        {3615}let m2_3470: bitstring = em2_3469 in
                                        {3616}let (=OpenSecureChannelResponse,=Cli,PartS_3471: bitstring,ST_3472: bitstring,TTL_3473: bitstring) = m2_3470 in
                                        {3617}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3618}event endCli(Sess,Cli,PartS_3471)
                                    )
                                    else
                                        {3619}let v_3474: bool = (Sess = C) in
                                        (
                                            {3620}if v_3474 then
                                            (
                                                {3621}let pkSess_3475: bitstring = pub(skC) in
                                                {3622}out(c, GetEndpointRequest);
                                                {3623}in(c, (=GetEndpointResponse,=pkSess_3475,=None,SP_3476: bitstring,UP_3477: bitstring));
                                                {3624}new Nc_3478: bitstring;
                                                {3625}let gNc_3479: bitstring = exp(g,Nc_3478) in
                                                {3626}let m1_3480: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3479) in
                                                {3627}event beginCli(Cli,Sess,gNc_3479);
                                                {3628}out(c, (pkCli_3365,m1_3480));
                                                {3629}in(c, em2_3481: bitstring);
                                                {3630}let m2_3482: bitstring = em2_3481 in
                                                {3631}let (=OpenSecureChannelResponse,=Cli,PartS_3483: bitstring,ST_3484: bitstring,TTL_3485: bitstring) = m2_3482 in
                                                {3632}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3633}event endCli(Sess,Cli,PartS_3483)
                                            )
                                            else
                                                {3634}let pkSess_3486: bitstring = pub(sk(Sess)) in
                                                {3635}out(c, GetEndpointRequest);
                                                {3636}in(c, (=GetEndpointResponse,=pkSess_3486,=None,SP_3487: bitstring,UP_3488: bitstring));
                                                {3637}new Nc_3489: bitstring;
                                                {3638}let gNc_3490: bitstring = exp(g,Nc_3489) in
                                                {3639}let m1_3491: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3490) in
                                                {3640}event beginCli(Cli,Sess,gNc_3490);
                                                {3641}out(c, (pkCli_3365,m1_3491));
                                                {3642}in(c, em2_3492: bitstring);
                                                {3643}let m2_3493: bitstring = em2_3492 in
                                                {3644}let (=OpenSecureChannelResponse,=Cli,PartS_3494: bitstring,ST_3495: bitstring,TTL_3496: bitstring) = m2_3493 in
                                                {3645}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3646}event endCli(Sess,Cli,PartS_3494)
                                        )
                                        else
                                            {3647}let pkSess_3497: bitstring = fail-any in
                                            {3648}out(c, GetEndpointRequest);
                                            {3649}in(c, (=GetEndpointResponse,=pkSess_3497,=None,SP_3498: bitstring,UP_3499: bitstring));
                                            {3650}new Nc_3500: bitstring;
                                            {3651}let gNc_3501: bitstring = exp(g,Nc_3500) in
                                            {3652}let m1_3502: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3501) in
                                            {3653}event beginCli(Cli,Sess,gNc_3501);
                                            {3654}out(c, (pkCli_3365,m1_3502));
                                            {3655}in(c, em2_3503: bitstring);
                                            {3656}let m2_3504: bitstring = em2_3503 in
                                            {3657}let (=OpenSecureChannelResponse,=Cli,PartS_3505: bitstring,ST_3506: bitstring,TTL_3507: bitstring) = m2_3504 in
                                            {3658}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3659}event endCli(Sess,Cli,PartS_3505)
                                )
                                else
                                    {3660}let pkSess_3508: bitstring = fail-any in
                                    {3661}out(c, GetEndpointRequest);
                                    {3662}in(c, (=GetEndpointResponse,=pkSess_3508,=None,SP_3509: bitstring,UP_3510: bitstring));
                                    {3663}new Nc_3511: bitstring;
                                    {3664}let gNc_3512: bitstring = exp(g,Nc_3511) in
                                    {3665}let m1_3513: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3512) in
                                    {3666}event beginCli(Cli,Sess,gNc_3512);
                                    {3667}out(c, (pkCli_3365,m1_3513));
                                    {3668}in(c, em2_3514: bitstring);
                                    {3669}let m2_3515: bitstring = em2_3514 in
                                    {3670}let (=OpenSecureChannelResponse,=Cli,PartS_3516: bitstring,ST_3517: bitstring,TTL_3518: bitstring) = m2_3515 in
                                    {3671}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3672}event endCli(Sess,Cli,PartS_3516)
                        )
                        else
                            {3673}let pkSess_3519: bitstring = fail-any in
                            {3674}out(c, GetEndpointRequest);
                            {3675}in(c, (=GetEndpointResponse,=pkSess_3519,=None,SP_3520: bitstring,UP_3521: bitstring));
                            {3676}new Nc_3522: bitstring;
                            {3677}let gNc_3523: bitstring = exp(g,Nc_3522) in
                            {3678}let m1_3524: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3523) in
                            {3679}event beginCli(Cli,Sess,gNc_3523);
                            {3680}out(c, (pkCli_3365,m1_3524));
                            {3681}in(c, em2_3525: bitstring);
                            {3682}let m2_3526: bitstring = em2_3525 in
                            {3683}let (=OpenSecureChannelResponse,=Cli,PartS_3527: bitstring,ST_3528: bitstring,TTL_3529: bitstring) = m2_3526 in
                            {3684}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3685}event endCli(Sess,Cli,PartS_3527)
                    )
                    else
                        {3686}let v_3530: bool = (Disco = C) in
                        (
                            {3687}if v_3530 then
                            (
                                {3688}let pkDisco_3531: bitstring = pub(skC) in
                                {3689}let v_3532: bool = (Sess = A) in
                                (
                                    {3690}if v_3532 then
                                    (
                                        {3691}let pkSess_3533: bitstring = pub(skA) in
                                        {3692}out(c, GetEndpointRequest);
                                        {3693}in(c, (=GetEndpointResponse,=pkSess_3533,=None,SP_3534: bitstring,UP_3535: bitstring));
                                        {3694}new Nc_3536: bitstring;
                                        {3695}let gNc_3537: bitstring = exp(g,Nc_3536) in
                                        {3696}let m1_3538: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3537) in
                                        {3697}event beginCli(Cli,Sess,gNc_3537);
                                        {3698}out(c, (pkCli_3365,m1_3538));
                                        {3699}in(c, em2_3539: bitstring);
                                        {3700}let m2_3540: bitstring = em2_3539 in
                                        {3701}let (=OpenSecureChannelResponse,=Cli,PartS_3541: bitstring,ST_3542: bitstring,TTL_3543: bitstring) = m2_3540 in
                                        {3702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3703}event endCli(Sess,Cli,PartS_3541)
                                    )
                                    else
                                        {3704}let v_3544: bool = (Sess = B) in
                                        (
                                            {3705}if v_3544 then
                                            (
                                                {3706}let pkSess_3545: bitstring = pub(skB) in
                                                {3707}out(c, GetEndpointRequest);
                                                {3708}in(c, (=GetEndpointResponse,=pkSess_3545,=None,SP_3546: bitstring,UP_3547: bitstring));
                                                {3709}new Nc_3548: bitstring;
                                                {3710}let gNc_3549: bitstring = exp(g,Nc_3548) in
                                                {3711}let m1_3550: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3549) in
                                                {3712}event beginCli(Cli,Sess,gNc_3549);
                                                {3713}out(c, (pkCli_3365,m1_3550));
                                                {3714}in(c, em2_3551: bitstring);
                                                {3715}let m2_3552: bitstring = em2_3551 in
                                                {3716}let (=OpenSecureChannelResponse,=Cli,PartS_3553: bitstring,ST_3554: bitstring,TTL_3555: bitstring) = m2_3552 in
                                                {3717}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3718}event endCli(Sess,Cli,PartS_3553)
                                            )
                                            else
                                                {3719}let v_3556: bool = (Sess = C) in
                                                (
                                                    {3720}if v_3556 then
                                                    (
                                                        {3721}let pkSess_3557: bitstring = pub(skC) in
                                                        {3722}out(c, GetEndpointRequest);
                                                        {3723}in(c, (=GetEndpointResponse,=pkSess_3557,=None,SP_3558: bitstring,UP_3559: bitstring));
                                                        {3724}new Nc_3560: bitstring;
                                                        {3725}let gNc_3561: bitstring = exp(g,Nc_3560) in
                                                        {3726}let m1_3562: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3561) in
                                                        {3727}event beginCli(Cli,Sess,gNc_3561);
                                                        {3728}out(c, (pkCli_3365,m1_3562));
                                                        {3729}in(c, em2_3563: bitstring);
                                                        {3730}let m2_3564: bitstring = em2_3563 in
                                                        {3731}let (=OpenSecureChannelResponse,=Cli,PartS_3565: bitstring,ST_3566: bitstring,TTL_3567: bitstring) = m2_3564 in
                                                        {3732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3733}event endCli(Sess,Cli,PartS_3565)
                                                    )
                                                    else
                                                        {3734}let pkSess_3568: bitstring = pub(sk(Sess)) in
                                                        {3735}out(c, GetEndpointRequest);
                                                        {3736}in(c, (=GetEndpointResponse,=pkSess_3568,=None,SP_3569: bitstring,UP_3570: bitstring));
                                                        {3737}new Nc_3571: bitstring;
                                                        {3738}let gNc_3572: bitstring = exp(g,Nc_3571) in
                                                        {3739}let m1_3573: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3572) in
                                                        {3740}event beginCli(Cli,Sess,gNc_3572);
                                                        {3741}out(c, (pkCli_3365,m1_3573));
                                                        {3742}in(c, em2_3574: bitstring);
                                                        {3743}let m2_3575: bitstring = em2_3574 in
                                                        {3744}let (=OpenSecureChannelResponse,=Cli,PartS_3576: bitstring,ST_3577: bitstring,TTL_3578: bitstring) = m2_3575 in
                                                        {3745}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3746}event endCli(Sess,Cli,PartS_3576)
                                                )
                                                else
                                                    {3747}let pkSess_3579: bitstring = fail-any in
                                                    {3748}out(c, GetEndpointRequest);
                                                    {3749}in(c, (=GetEndpointResponse,=pkSess_3579,=None,SP_3580: bitstring,UP_3581: bitstring));
                                                    {3750}new Nc_3582: bitstring;
                                                    {3751}let gNc_3583: bitstring = exp(g,Nc_3582) in
                                                    {3752}let m1_3584: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3583) in
                                                    {3753}event beginCli(Cli,Sess,gNc_3583);
                                                    {3754}out(c, (pkCli_3365,m1_3584));
                                                    {3755}in(c, em2_3585: bitstring);
                                                    {3756}let m2_3586: bitstring = em2_3585 in
                                                    {3757}let (=OpenSecureChannelResponse,=Cli,PartS_3587: bitstring,ST_3588: bitstring,TTL_3589: bitstring) = m2_3586 in
                                                    {3758}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3759}event endCli(Sess,Cli,PartS_3587)
                                        )
                                        else
                                            {3760}let pkSess_3590: bitstring = fail-any in
                                            {3761}out(c, GetEndpointRequest);
                                            {3762}in(c, (=GetEndpointResponse,=pkSess_3590,=None,SP_3591: bitstring,UP_3592: bitstring));
                                            {3763}new Nc_3593: bitstring;
                                            {3764}let gNc_3594: bitstring = exp(g,Nc_3593) in
                                            {3765}let m1_3595: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3594) in
                                            {3766}event beginCli(Cli,Sess,gNc_3594);
                                            {3767}out(c, (pkCli_3365,m1_3595));
                                            {3768}in(c, em2_3596: bitstring);
                                            {3769}let m2_3597: bitstring = em2_3596 in
                                            {3770}let (=OpenSecureChannelResponse,=Cli,PartS_3598: bitstring,ST_3599: bitstring,TTL_3600: bitstring) = m2_3597 in
                                            {3771}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3772}event endCli(Sess,Cli,PartS_3598)
                                )
                                else
                                    {3773}let pkSess_3601: bitstring = fail-any in
                                    {3774}out(c, GetEndpointRequest);
                                    {3775}in(c, (=GetEndpointResponse,=pkSess_3601,=None,SP_3602: bitstring,UP_3603: bitstring));
                                    {3776}new Nc_3604: bitstring;
                                    {3777}let gNc_3605: bitstring = exp(g,Nc_3604) in
                                    {3778}let m1_3606: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3605) in
                                    {3779}event beginCli(Cli,Sess,gNc_3605);
                                    {3780}out(c, (pkCli_3365,m1_3606));
                                    {3781}in(c, em2_3607: bitstring);
                                    {3782}let m2_3608: bitstring = em2_3607 in
                                    {3783}let (=OpenSecureChannelResponse,=Cli,PartS_3609: bitstring,ST_3610: bitstring,TTL_3611: bitstring) = m2_3608 in
                                    {3784}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3785}event endCli(Sess,Cli,PartS_3609)
                            )
                            else
                                {3786}let pkDisco_3612: bitstring = pub(sk(Disco)) in
                                {3787}let v_3613: bool = (Sess = A) in
                                (
                                    {3788}if v_3613 then
                                    (
                                        {3789}let pkSess_3614: bitstring = pub(skA) in
                                        {3790}out(c, GetEndpointRequest);
                                        {3791}in(c, (=GetEndpointResponse,=pkSess_3614,=None,SP_3615: bitstring,UP_3616: bitstring));
                                        {3792}new Nc_3617: bitstring;
                                        {3793}let gNc_3618: bitstring = exp(g,Nc_3617) in
                                        {3794}let m1_3619: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3618) in
                                        {3795}event beginCli(Cli,Sess,gNc_3618);
                                        {3796}out(c, (pkCli_3365,m1_3619));
                                        {3797}in(c, em2_3620: bitstring);
                                        {3798}let m2_3621: bitstring = em2_3620 in
                                        {3799}let (=OpenSecureChannelResponse,=Cli,PartS_3622: bitstring,ST_3623: bitstring,TTL_3624: bitstring) = m2_3621 in
                                        {3800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3801}event endCli(Sess,Cli,PartS_3622)
                                    )
                                    else
                                        {3802}let v_3625: bool = (Sess = B) in
                                        (
                                            {3803}if v_3625 then
                                            (
                                                {3804}let pkSess_3626: bitstring = pub(skB) in
                                                {3805}out(c, GetEndpointRequest);
                                                {3806}in(c, (=GetEndpointResponse,=pkSess_3626,=None,SP_3627: bitstring,UP_3628: bitstring));
                                                {3807}new Nc_3629: bitstring;
                                                {3808}let gNc_3630: bitstring = exp(g,Nc_3629) in
                                                {3809}let m1_3631: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3630) in
                                                {3810}event beginCli(Cli,Sess,gNc_3630);
                                                {3811}out(c, (pkCli_3365,m1_3631));
                                                {3812}in(c, em2_3632: bitstring);
                                                {3813}let m2_3633: bitstring = em2_3632 in
                                                {3814}let (=OpenSecureChannelResponse,=Cli,PartS_3634: bitstring,ST_3635: bitstring,TTL_3636: bitstring) = m2_3633 in
                                                {3815}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3816}event endCli(Sess,Cli,PartS_3634)
                                            )
                                            else
                                                {3817}let v_3637: bool = (Sess = C) in
                                                (
                                                    {3818}if v_3637 then
                                                    (
                                                        {3819}let pkSess_3638: bitstring = pub(skC) in
                                                        {3820}out(c, GetEndpointRequest);
                                                        {3821}in(c, (=GetEndpointResponse,=pkSess_3638,=None,SP_3639: bitstring,UP_3640: bitstring));
                                                        {3822}new Nc_3641: bitstring;
                                                        {3823}let gNc_3642: bitstring = exp(g,Nc_3641) in
                                                        {3824}let m1_3643: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3642) in
                                                        {3825}event beginCli(Cli,Sess,gNc_3642);
                                                        {3826}out(c, (pkCli_3365,m1_3643));
                                                        {3827}in(c, em2_3644: bitstring);
                                                        {3828}let m2_3645: bitstring = em2_3644 in
                                                        {3829}let (=OpenSecureChannelResponse,=Cli,PartS_3646: bitstring,ST_3647: bitstring,TTL_3648: bitstring) = m2_3645 in
                                                        {3830}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3831}event endCli(Sess,Cli,PartS_3646)
                                                    )
                                                    else
                                                        {3832}let pkSess_3649: bitstring = pub(sk(Sess)) in
                                                        {3833}out(c, GetEndpointRequest);
                                                        {3834}in(c, (=GetEndpointResponse,=pkSess_3649,=None,SP_3650: bitstring,UP_3651: bitstring));
                                                        {3835}new Nc_3652: bitstring;
                                                        {3836}let gNc_3653: bitstring = exp(g,Nc_3652) in
                                                        {3837}let m1_3654: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3653) in
                                                        {3838}event beginCli(Cli,Sess,gNc_3653);
                                                        {3839}out(c, (pkCli_3365,m1_3654));
                                                        {3840}in(c, em2_3655: bitstring);
                                                        {3841}let m2_3656: bitstring = em2_3655 in
                                                        {3842}let (=OpenSecureChannelResponse,=Cli,PartS_3657: bitstring,ST_3658: bitstring,TTL_3659: bitstring) = m2_3656 in
                                                        {3843}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3844}event endCli(Sess,Cli,PartS_3657)
                                                )
                                                else
                                                    {3845}let pkSess_3660: bitstring = fail-any in
                                                    {3846}out(c, GetEndpointRequest);
                                                    {3847}in(c, (=GetEndpointResponse,=pkSess_3660,=None,SP_3661: bitstring,UP_3662: bitstring));
                                                    {3848}new Nc_3663: bitstring;
                                                    {3849}let gNc_3664: bitstring = exp(g,Nc_3663) in
                                                    {3850}let m1_3665: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3664) in
                                                    {3851}event beginCli(Cli,Sess,gNc_3664);
                                                    {3852}out(c, (pkCli_3365,m1_3665));
                                                    {3853}in(c, em2_3666: bitstring);
                                                    {3854}let m2_3667: bitstring = em2_3666 in
                                                    {3855}let (=OpenSecureChannelResponse,=Cli,PartS_3668: bitstring,ST_3669: bitstring,TTL_3670: bitstring) = m2_3667 in
                                                    {3856}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3857}event endCli(Sess,Cli,PartS_3668)
                                        )
                                        else
                                            {3858}let pkSess_3671: bitstring = fail-any in
                                            {3859}out(c, GetEndpointRequest);
                                            {3860}in(c, (=GetEndpointResponse,=pkSess_3671,=None,SP_3672: bitstring,UP_3673: bitstring));
                                            {3861}new Nc_3674: bitstring;
                                            {3862}let gNc_3675: bitstring = exp(g,Nc_3674) in
                                            {3863}let m1_3676: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3675) in
                                            {3864}event beginCli(Cli,Sess,gNc_3675);
                                            {3865}out(c, (pkCli_3365,m1_3676));
                                            {3866}in(c, em2_3677: bitstring);
                                            {3867}let m2_3678: bitstring = em2_3677 in
                                            {3868}let (=OpenSecureChannelResponse,=Cli,PartS_3679: bitstring,ST_3680: bitstring,TTL_3681: bitstring) = m2_3678 in
                                            {3869}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3870}event endCli(Sess,Cli,PartS_3679)
                                )
                                else
                                    {3871}let pkSess_3682: bitstring = fail-any in
                                    {3872}out(c, GetEndpointRequest);
                                    {3873}in(c, (=GetEndpointResponse,=pkSess_3682,=None,SP_3683: bitstring,UP_3684: bitstring));
                                    {3874}new Nc_3685: bitstring;
                                    {3875}let gNc_3686: bitstring = exp(g,Nc_3685) in
                                    {3876}let m1_3687: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3686) in
                                    {3877}event beginCli(Cli,Sess,gNc_3686);
                                    {3878}out(c, (pkCli_3365,m1_3687));
                                    {3879}in(c, em2_3688: bitstring);
                                    {3880}let m2_3689: bitstring = em2_3688 in
                                    {3881}let (=OpenSecureChannelResponse,=Cli,PartS_3690: bitstring,ST_3691: bitstring,TTL_3692: bitstring) = m2_3689 in
                                    {3882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3883}event endCli(Sess,Cli,PartS_3690)
                        )
                        else
                            {3884}let pkDisco_3693: bitstring = fail-any in
                            {3885}let v_3694: bool = (Sess = A) in
                            (
                                {3886}if v_3694 then
                                (
                                    {3887}let pkSess_3695: bitstring = pub(skA) in
                                    {3888}out(c, GetEndpointRequest);
                                    {3889}in(c, (=GetEndpointResponse,=pkSess_3695,=None,SP_3696: bitstring,UP_3697: bitstring));
                                    {3890}new Nc_3698: bitstring;
                                    {3891}let gNc_3699: bitstring = exp(g,Nc_3698) in
                                    {3892}let m1_3700: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3699) in
                                    {3893}event beginCli(Cli,Sess,gNc_3699);
                                    {3894}out(c, (pkCli_3365,m1_3700));
                                    {3895}in(c, em2_3701: bitstring);
                                    {3896}let m2_3702: bitstring = em2_3701 in
                                    {3897}let (=OpenSecureChannelResponse,=Cli,PartS_3703: bitstring,ST_3704: bitstring,TTL_3705: bitstring) = m2_3702 in
                                    {3898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3899}event endCli(Sess,Cli,PartS_3703)
                                )
                                else
                                    {3900}let v_3706: bool = (Sess = B) in
                                    (
                                        {3901}if v_3706 then
                                        (
                                            {3902}let pkSess_3707: bitstring = pub(skB) in
                                            {3903}out(c, GetEndpointRequest);
                                            {3904}in(c, (=GetEndpointResponse,=pkSess_3707,=None,SP_3708: bitstring,UP_3709: bitstring));
                                            {3905}new Nc_3710: bitstring;
                                            {3906}let gNc_3711: bitstring = exp(g,Nc_3710) in
                                            {3907}let m1_3712: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3711) in
                                            {3908}event beginCli(Cli,Sess,gNc_3711);
                                            {3909}out(c, (pkCli_3365,m1_3712));
                                            {3910}in(c, em2_3713: bitstring);
                                            {3911}let m2_3714: bitstring = em2_3713 in
                                            {3912}let (=OpenSecureChannelResponse,=Cli,PartS_3715: bitstring,ST_3716: bitstring,TTL_3717: bitstring) = m2_3714 in
                                            {3913}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3914}event endCli(Sess,Cli,PartS_3715)
                                        )
                                        else
                                            {3915}let v_3718: bool = (Sess = C) in
                                            (
                                                {3916}if v_3718 then
                                                (
                                                    {3917}let pkSess_3719: bitstring = pub(skC) in
                                                    {3918}out(c, GetEndpointRequest);
                                                    {3919}in(c, (=GetEndpointResponse,=pkSess_3719,=None,SP_3720: bitstring,UP_3721: bitstring));
                                                    {3920}new Nc_3722: bitstring;
                                                    {3921}let gNc_3723: bitstring = exp(g,Nc_3722) in
                                                    {3922}let m1_3724: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3723) in
                                                    {3923}event beginCli(Cli,Sess,gNc_3723);
                                                    {3924}out(c, (pkCli_3365,m1_3724));
                                                    {3925}in(c, em2_3725: bitstring);
                                                    {3926}let m2_3726: bitstring = em2_3725 in
                                                    {3927}let (=OpenSecureChannelResponse,=Cli,PartS_3727: bitstring,ST_3728: bitstring,TTL_3729: bitstring) = m2_3726 in
                                                    {3928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3929}event endCli(Sess,Cli,PartS_3727)
                                                )
                                                else
                                                    {3930}let pkSess_3730: bitstring = pub(sk(Sess)) in
                                                    {3931}out(c, GetEndpointRequest);
                                                    {3932}in(c, (=GetEndpointResponse,=pkSess_3730,=None,SP_3731: bitstring,UP_3732: bitstring));
                                                    {3933}new Nc_3733: bitstring;
                                                    {3934}let gNc_3734: bitstring = exp(g,Nc_3733) in
                                                    {3935}let m1_3735: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3734) in
                                                    {3936}event beginCli(Cli,Sess,gNc_3734);
                                                    {3937}out(c, (pkCli_3365,m1_3735));
                                                    {3938}in(c, em2_3736: bitstring);
                                                    {3939}let m2_3737: bitstring = em2_3736 in
                                                    {3940}let (=OpenSecureChannelResponse,=Cli,PartS_3738: bitstring,ST_3739: bitstring,TTL_3740: bitstring) = m2_3737 in
                                                    {3941}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3942}event endCli(Sess,Cli,PartS_3738)
                                            )
                                            else
                                                {3943}let pkSess_3741: bitstring = fail-any in
                                                {3944}out(c, GetEndpointRequest);
                                                {3945}in(c, (=GetEndpointResponse,=pkSess_3741,=None,SP_3742: bitstring,UP_3743: bitstring));
                                                {3946}new Nc_3744: bitstring;
                                                {3947}let gNc_3745: bitstring = exp(g,Nc_3744) in
                                                {3948}let m1_3746: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3745) in
                                                {3949}event beginCli(Cli,Sess,gNc_3745);
                                                {3950}out(c, (pkCli_3365,m1_3746));
                                                {3951}in(c, em2_3747: bitstring);
                                                {3952}let m2_3748: bitstring = em2_3747 in
                                                {3953}let (=OpenSecureChannelResponse,=Cli,PartS_3749: bitstring,ST_3750: bitstring,TTL_3751: bitstring) = m2_3748 in
                                                {3954}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3955}event endCli(Sess,Cli,PartS_3749)
                                    )
                                    else
                                        {3956}let pkSess_3752: bitstring = fail-any in
                                        {3957}out(c, GetEndpointRequest);
                                        {3958}in(c, (=GetEndpointResponse,=pkSess_3752,=None,SP_3753: bitstring,UP_3754: bitstring));
                                        {3959}new Nc_3755: bitstring;
                                        {3960}let gNc_3756: bitstring = exp(g,Nc_3755) in
                                        {3961}let m1_3757: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3756) in
                                        {3962}event beginCli(Cli,Sess,gNc_3756);
                                        {3963}out(c, (pkCli_3365,m1_3757));
                                        {3964}in(c, em2_3758: bitstring);
                                        {3965}let m2_3759: bitstring = em2_3758 in
                                        {3966}let (=OpenSecureChannelResponse,=Cli,PartS_3760: bitstring,ST_3761: bitstring,TTL_3762: bitstring) = m2_3759 in
                                        {3967}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3968}event endCli(Sess,Cli,PartS_3760)
                            )
                            else
                                {3969}let pkSess_3763: bitstring = fail-any in
                                {3970}out(c, GetEndpointRequest);
                                {3971}in(c, (=GetEndpointResponse,=pkSess_3763,=None,SP_3764: bitstring,UP_3765: bitstring));
                                {3972}new Nc_3766: bitstring;
                                {3973}let gNc_3767: bitstring = exp(g,Nc_3766) in
                                {3974}let m1_3768: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3767) in
                                {3975}event beginCli(Cli,Sess,gNc_3767);
                                {3976}out(c, (pkCli_3365,m1_3768));
                                {3977}in(c, em2_3769: bitstring);
                                {3978}let m2_3770: bitstring = em2_3769 in
                                {3979}let (=OpenSecureChannelResponse,=Cli,PartS_3771: bitstring,ST_3772: bitstring,TTL_3773: bitstring) = m2_3770 in
                                {3980}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3981}event endCli(Sess,Cli,PartS_3771)
                )
                else
                    {3982}let pkDisco_3774: bitstring = fail-any in
                    {3983}let v_3775: bool = (Sess = A) in
                    (
                        {3984}if v_3775 then
                        (
                            {3985}let pkSess_3776: bitstring = pub(skA) in
                            {3986}out(c, GetEndpointRequest);
                            {3987}in(c, (=GetEndpointResponse,=pkSess_3776,=None,SP_3777: bitstring,UP_3778: bitstring));
                            {3988}new Nc_3779: bitstring;
                            {3989}let gNc_3780: bitstring = exp(g,Nc_3779) in
                            {3990}let m1_3781: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3780) in
                            {3991}event beginCli(Cli,Sess,gNc_3780);
                            {3992}out(c, (pkCli_3365,m1_3781));
                            {3993}in(c, em2_3782: bitstring);
                            {3994}let m2_3783: bitstring = em2_3782 in
                            {3995}let (=OpenSecureChannelResponse,=Cli,PartS_3784: bitstring,ST_3785: bitstring,TTL_3786: bitstring) = m2_3783 in
                            {3996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3997}event endCli(Sess,Cli,PartS_3784)
                        )
                        else
                            {3998}let v_3787: bool = (Sess = B) in
                            (
                                {3999}if v_3787 then
                                (
                                    {4000}let pkSess_3788: bitstring = pub(skB) in
                                    {4001}out(c, GetEndpointRequest);
                                    {4002}in(c, (=GetEndpointResponse,=pkSess_3788,=None,SP_3789: bitstring,UP_3790: bitstring));
                                    {4003}new Nc_3791: bitstring;
                                    {4004}let gNc_3792: bitstring = exp(g,Nc_3791) in
                                    {4005}let m1_3793: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3792) in
                                    {4006}event beginCli(Cli,Sess,gNc_3792);
                                    {4007}out(c, (pkCli_3365,m1_3793));
                                    {4008}in(c, em2_3794: bitstring);
                                    {4009}let m2_3795: bitstring = em2_3794 in
                                    {4010}let (=OpenSecureChannelResponse,=Cli,PartS_3796: bitstring,ST_3797: bitstring,TTL_3798: bitstring) = m2_3795 in
                                    {4011}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4012}event endCli(Sess,Cli,PartS_3796)
                                )
                                else
                                    {4013}let v_3799: bool = (Sess = C) in
                                    (
                                        {4014}if v_3799 then
                                        (
                                            {4015}let pkSess_3800: bitstring = pub(skC) in
                                            {4016}out(c, GetEndpointRequest);
                                            {4017}in(c, (=GetEndpointResponse,=pkSess_3800,=None,SP_3801: bitstring,UP_3802: bitstring));
                                            {4018}new Nc_3803: bitstring;
                                            {4019}let gNc_3804: bitstring = exp(g,Nc_3803) in
                                            {4020}let m1_3805: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3804) in
                                            {4021}event beginCli(Cli,Sess,gNc_3804);
                                            {4022}out(c, (pkCli_3365,m1_3805));
                                            {4023}in(c, em2_3806: bitstring);
                                            {4024}let m2_3807: bitstring = em2_3806 in
                                            {4025}let (=OpenSecureChannelResponse,=Cli,PartS_3808: bitstring,ST_3809: bitstring,TTL_3810: bitstring) = m2_3807 in
                                            {4026}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4027}event endCli(Sess,Cli,PartS_3808)
                                        )
                                        else
                                            {4028}let pkSess_3811: bitstring = pub(sk(Sess)) in
                                            {4029}out(c, GetEndpointRequest);
                                            {4030}in(c, (=GetEndpointResponse,=pkSess_3811,=None,SP_3812: bitstring,UP_3813: bitstring));
                                            {4031}new Nc_3814: bitstring;
                                            {4032}let gNc_3815: bitstring = exp(g,Nc_3814) in
                                            {4033}let m1_3816: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3815) in
                                            {4034}event beginCli(Cli,Sess,gNc_3815);
                                            {4035}out(c, (pkCli_3365,m1_3816));
                                            {4036}in(c, em2_3817: bitstring);
                                            {4037}let m2_3818: bitstring = em2_3817 in
                                            {4038}let (=OpenSecureChannelResponse,=Cli,PartS_3819: bitstring,ST_3820: bitstring,TTL_3821: bitstring) = m2_3818 in
                                            {4039}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4040}event endCli(Sess,Cli,PartS_3819)
                                    )
                                    else
                                        {4041}let pkSess_3822: bitstring = fail-any in
                                        {4042}out(c, GetEndpointRequest);
                                        {4043}in(c, (=GetEndpointResponse,=pkSess_3822,=None,SP_3823: bitstring,UP_3824: bitstring));
                                        {4044}new Nc_3825: bitstring;
                                        {4045}let gNc_3826: bitstring = exp(g,Nc_3825) in
                                        {4046}let m1_3827: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3826) in
                                        {4047}event beginCli(Cli,Sess,gNc_3826);
                                        {4048}out(c, (pkCli_3365,m1_3827));
                                        {4049}in(c, em2_3828: bitstring);
                                        {4050}let m2_3829: bitstring = em2_3828 in
                                        {4051}let (=OpenSecureChannelResponse,=Cli,PartS_3830: bitstring,ST_3831: bitstring,TTL_3832: bitstring) = m2_3829 in
                                        {4052}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4053}event endCli(Sess,Cli,PartS_3830)
                            )
                            else
                                {4054}let pkSess_3833: bitstring = fail-any in
                                {4055}out(c, GetEndpointRequest);
                                {4056}in(c, (=GetEndpointResponse,=pkSess_3833,=None,SP_3834: bitstring,UP_3835: bitstring));
                                {4057}new Nc_3836: bitstring;
                                {4058}let gNc_3837: bitstring = exp(g,Nc_3836) in
                                {4059}let m1_3838: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3837) in
                                {4060}event beginCli(Cli,Sess,gNc_3837);
                                {4061}out(c, (pkCli_3365,m1_3838));
                                {4062}in(c, em2_3839: bitstring);
                                {4063}let m2_3840: bitstring = em2_3839 in
                                {4064}let (=OpenSecureChannelResponse,=Cli,PartS_3841: bitstring,ST_3842: bitstring,TTL_3843: bitstring) = m2_3840 in
                                {4065}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4066}event endCli(Sess,Cli,PartS_3841)
                    )
                    else
                        {4067}let pkSess_3844: bitstring = fail-any in
                        {4068}out(c, GetEndpointRequest);
                        {4069}in(c, (=GetEndpointResponse,=pkSess_3844,=None,SP_3845: bitstring,UP_3846: bitstring));
                        {4070}new Nc_3847: bitstring;
                        {4071}let gNc_3848: bitstring = exp(g,Nc_3847) in
                        {4072}let m1_3849: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3848) in
                        {4073}event beginCli(Cli,Sess,gNc_3848);
                        {4074}out(c, (pkCli_3365,m1_3849));
                        {4075}in(c, em2_3850: bitstring);
                        {4076}let m2_3851: bitstring = em2_3850 in
                        {4077}let (=OpenSecureChannelResponse,=Cli,PartS_3852: bitstring,ST_3853: bitstring,TTL_3854: bitstring) = m2_3851 in
                        {4078}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4079}event endCli(Sess,Cli,PartS_3852)
        )
        else
            {4080}let pkDisco_3855: bitstring = fail-any in
            {4081}let v_3856: bool = (Sess = A) in
            (
                {4082}if v_3856 then
                (
                    {4083}let pkSess_3857: bitstring = pub(skA) in
                    {4084}out(c, GetEndpointRequest);
                    {4085}in(c, (=GetEndpointResponse,=pkSess_3857,=None,SP_3858: bitstring,UP_3859: bitstring));
                    {4086}new Nc_3860: bitstring;
                    {4087}let gNc_3861: bitstring = exp(g,Nc_3860) in
                    {4088}let m1_3862: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3861) in
                    {4089}event beginCli(Cli,Sess,gNc_3861);
                    {4090}out(c, (pkCli_3365,m1_3862));
                    {4091}in(c, em2_3863: bitstring);
                    {4092}let m2_3864: bitstring = em2_3863 in
                    {4093}let (=OpenSecureChannelResponse,=Cli,PartS_3865: bitstring,ST_3866: bitstring,TTL_3867: bitstring) = m2_3864 in
                    {4094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {4095}event endCli(Sess,Cli,PartS_3865)
                )
                else
                    {4096}let v_3868: bool = (Sess = B) in
                    (
                        {4097}if v_3868 then
                        (
                            {4098}let pkSess_3869: bitstring = pub(skB) in
                            {4099}out(c, GetEndpointRequest);
                            {4100}in(c, (=GetEndpointResponse,=pkSess_3869,=None,SP_3870: bitstring,UP_3871: bitstring));
                            {4101}new Nc_3872: bitstring;
                            {4102}let gNc_3873: bitstring = exp(g,Nc_3872) in
                            {4103}let m1_3874: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3873) in
                            {4104}event beginCli(Cli,Sess,gNc_3873);
                            {4105}out(c, (pkCli_3365,m1_3874));
                            {4106}in(c, em2_3875: bitstring);
                            {4107}let m2_3876: bitstring = em2_3875 in
                            {4108}let (=OpenSecureChannelResponse,=Cli,PartS_3877: bitstring,ST_3878: bitstring,TTL_3879: bitstring) = m2_3876 in
                            {4109}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4110}event endCli(Sess,Cli,PartS_3877)
                        )
                        else
                            {4111}let v_3880: bool = (Sess = C) in
                            (
                                {4112}if v_3880 then
                                (
                                    {4113}let pkSess_3881: bitstring = pub(skC) in
                                    {4114}out(c, GetEndpointRequest);
                                    {4115}in(c, (=GetEndpointResponse,=pkSess_3881,=None,SP_3882: bitstring,UP_3883: bitstring));
                                    {4116}new Nc_3884: bitstring;
                                    {4117}let gNc_3885: bitstring = exp(g,Nc_3884) in
                                    {4118}let m1_3886: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3885) in
                                    {4119}event beginCli(Cli,Sess,gNc_3885);
                                    {4120}out(c, (pkCli_3365,m1_3886));
                                    {4121}in(c, em2_3887: bitstring);
                                    {4122}let m2_3888: bitstring = em2_3887 in
                                    {4123}let (=OpenSecureChannelResponse,=Cli,PartS_3889: bitstring,ST_3890: bitstring,TTL_3891: bitstring) = m2_3888 in
                                    {4124}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4125}event endCli(Sess,Cli,PartS_3889)
                                )
                                else
                                    {4126}let pkSess_3892: bitstring = pub(sk(Sess)) in
                                    {4127}out(c, GetEndpointRequest);
                                    {4128}in(c, (=GetEndpointResponse,=pkSess_3892,=None,SP_3893: bitstring,UP_3894: bitstring));
                                    {4129}new Nc_3895: bitstring;
                                    {4130}let gNc_3896: bitstring = exp(g,Nc_3895) in
                                    {4131}let m1_3897: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3896) in
                                    {4132}event beginCli(Cli,Sess,gNc_3896);
                                    {4133}out(c, (pkCli_3365,m1_3897));
                                    {4134}in(c, em2_3898: bitstring);
                                    {4135}let m2_3899: bitstring = em2_3898 in
                                    {4136}let (=OpenSecureChannelResponse,=Cli,PartS_3900: bitstring,ST_3901: bitstring,TTL_3902: bitstring) = m2_3899 in
                                    {4137}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4138}event endCli(Sess,Cli,PartS_3900)
                            )
                            else
                                {4139}let pkSess_3903: bitstring = fail-any in
                                {4140}out(c, GetEndpointRequest);
                                {4141}in(c, (=GetEndpointResponse,=pkSess_3903,=None,SP_3904: bitstring,UP_3905: bitstring));
                                {4142}new Nc_3906: bitstring;
                                {4143}let gNc_3907: bitstring = exp(g,Nc_3906) in
                                {4144}let m1_3908: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3907) in
                                {4145}event beginCli(Cli,Sess,gNc_3907);
                                {4146}out(c, (pkCli_3365,m1_3908));
                                {4147}in(c, em2_3909: bitstring);
                                {4148}let m2_3910: bitstring = em2_3909 in
                                {4149}let (=OpenSecureChannelResponse,=Cli,PartS_3911: bitstring,ST_3912: bitstring,TTL_3913: bitstring) = m2_3910 in
                                {4150}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4151}event endCli(Sess,Cli,PartS_3911)
                    )
                    else
                        {4152}let pkSess_3914: bitstring = fail-any in
                        {4153}out(c, GetEndpointRequest);
                        {4154}in(c, (=GetEndpointResponse,=pkSess_3914,=None,SP_3915: bitstring,UP_3916: bitstring));
                        {4155}new Nc_3917: bitstring;
                        {4156}let gNc_3918: bitstring = exp(g,Nc_3917) in
                        {4157}let m1_3919: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3918) in
                        {4158}event beginCli(Cli,Sess,gNc_3918);
                        {4159}out(c, (pkCli_3365,m1_3919));
                        {4160}in(c, em2_3920: bitstring);
                        {4161}let m2_3921: bitstring = em2_3920 in
                        {4162}let (=OpenSecureChannelResponse,=Cli,PartS_3922: bitstring,ST_3923: bitstring,TTL_3924: bitstring) = m2_3921 in
                        {4163}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4164}event endCli(Sess,Cli,PartS_3922)
            )
            else
                {4165}let pkSess_3925: bitstring = fail-any in
                {4166}out(c, GetEndpointRequest);
                {4167}in(c, (=GetEndpointResponse,=pkSess_3925,=None,SP_3926: bitstring,UP_3927: bitstring));
                {4168}new Nc_3928: bitstring;
                {4169}let gNc_3929: bitstring = exp(g,Nc_3928) in
                {4170}let m1_3930: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3365,gNc_3929) in
                {4171}event beginCli(Cli,Sess,gNc_3929);
                {4172}out(c, (pkCli_3365,m1_3930));
                {4173}in(c, em2_3931: bitstring);
                {4174}let m2_3932: bitstring = em2_3931 in
                {4175}let (=OpenSecureChannelResponse,=Cli,PartS_3933: bitstring,ST_3934: bitstring,TTL_3935: bitstring) = m2_3932 in
                {4176}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                {4177}event endCli(Sess,Cli,PartS_3933)
) | (
    {4178}!
    {4179}in(c, (Cli_3936: host,Disco_3937: host,Sess_3938: host));
    {4180}let v_3939: bool = (Disco_3937 = A) in
    (
        {4181}if v_3939 then
        (
            {4182}let skDisco: bitstring = skA in
            {4183}let pkDisco_3940: bitstring = pub(skDisco) in
            {4184}let v_3941: bool = (Cli_3936 = A) in
            (
                {4185}if v_3941 then
                (
                    {4186}let pkCli_3942: bitstring = pub(skA) in
                    {4187}let v_3943: bool = (Sess_3938 = A) in
                    (
                        {4188}if v_3943 then
                        (
                            {4189}let pkSess_3944: bitstring = pub(skA) in
                            {4190}in(c, =GetEndpointRequest);
                            {4191}new SP_3945: bitstring;
                            {4192}new UP_3946: bitstring;
                            {4193}out(c, (GetEndpointResponse,pkSess_3944,None,SP_3945,UP_3946))
                        )
                        else
                            {4194}let v_3947: bool = (Sess_3938 = B) in
                            (
                                {4195}if v_3947 then
                                (
                                    {4196}let pkSess_3948: bitstring = pub(skB) in
                                    {4197}in(c, =GetEndpointRequest);
                                    {4198}new SP_3949: bitstring;
                                    {4199}new UP_3950: bitstring;
                                    {4200}out(c, (GetEndpointResponse,pkSess_3948,None,SP_3949,UP_3950))
                                )
                                else
                                    {4201}let v_3951: bool = (Sess_3938 = C) in
                                    (
                                        {4202}if v_3951 then
                                        (
                                            {4203}let pkSess_3952: bitstring = pub(skC) in
                                            {4204}in(c, =GetEndpointRequest);
                                            {4205}new SP_3953: bitstring;
                                            {4206}new UP_3954: bitstring;
                                            {4207}out(c, (GetEndpointResponse,pkSess_3952,None,SP_3953,UP_3954))
                                        )
                                        else
                                            {4208}let pkSess_3955: bitstring = pub(sk(Sess_3938)) in
                                            {4209}in(c, =GetEndpointRequest);
                                            {4210}new SP_3956: bitstring;
                                            {4211}new UP_3957: bitstring;
                                            {4212}out(c, (GetEndpointResponse,pkSess_3955,None,SP_3956,UP_3957))
                                    )
                                    else
                                        {4213}let pkSess_3958: bitstring = fail-any in
                                        {4214}in(c, =GetEndpointRequest);
                                        {4215}new SP_3959: bitstring;
                                        {4216}new UP_3960: bitstring;
                                        {4217}out(c, (GetEndpointResponse,pkSess_3958,None,SP_3959,UP_3960))
                            )
                            else
                                {4218}let pkSess_3961: bitstring = fail-any in
                                {4219}in(c, =GetEndpointRequest);
                                {4220}new SP_3962: bitstring;
                                {4221}new UP_3963: bitstring;
                                {4222}out(c, (GetEndpointResponse,pkSess_3961,None,SP_3962,UP_3963))
                    )
                    else
                        {4223}let pkSess_3964: bitstring = fail-any in
                        {4224}in(c, =GetEndpointRequest);
                        {4225}new SP_3965: bitstring;
                        {4226}new UP_3966: bitstring;
                        {4227}out(c, (GetEndpointResponse,pkSess_3964,None,SP_3965,UP_3966))
                )
                else
                    {4228}let v_3967: bool = (Cli_3936 = B) in
                    (
                        {4229}if v_3967 then
                        (
                            {4230}let pkCli_3968: bitstring = pub(skB) in
                            {4231}let v_3969: bool = (Sess_3938 = A) in
                            (
                                {4232}if v_3969 then
                                (
                                    {4233}let pkSess_3970: bitstring = pub(skA) in
                                    {4234}in(c, =GetEndpointRequest);
                                    {4235}new SP_3971: bitstring;
                                    {4236}new UP_3972: bitstring;
                                    {4237}out(c, (GetEndpointResponse,pkSess_3970,None,SP_3971,UP_3972))
                                )
                                else
                                    {4238}let v_3973: bool = (Sess_3938 = B) in
                                    (
                                        {4239}if v_3973 then
                                        (
                                            {4240}let pkSess_3974: bitstring = pub(skB) in
                                            {4241}in(c, =GetEndpointRequest);
                                            {4242}new SP_3975: bitstring;
                                            {4243}new UP_3976: bitstring;
                                            {4244}out(c, (GetEndpointResponse,pkSess_3974,None,SP_3975,UP_3976))
                                        )
                                        else
                                            {4245}let v_3977: bool = (Sess_3938 = C) in
                                            (
                                                {4246}if v_3977 then
                                                (
                                                    {4247}let pkSess_3978: bitstring = pub(skC) in
                                                    {4248}in(c, =GetEndpointRequest);
                                                    {4249}new SP_3979: bitstring;
                                                    {4250}new UP_3980: bitstring;
                                                    {4251}out(c, (GetEndpointResponse,pkSess_3978,None,SP_3979,UP_3980))
                                                )
                                                else
                                                    {4252}let pkSess_3981: bitstring = pub(sk(Sess_3938)) in
                                                    {4253}in(c, =GetEndpointRequest);
                                                    {4254}new SP_3982: bitstring;
                                                    {4255}new UP_3983: bitstring;
                                                    {4256}out(c, (GetEndpointResponse,pkSess_3981,None,SP_3982,UP_3983))
                                            )
                                            else
                                                {4257}let pkSess_3984: bitstring = fail-any in
                                                {4258}in(c, =GetEndpointRequest);
                                                {4259}new SP_3985: bitstring;
                                                {4260}new UP_3986: bitstring;
                                                {4261}out(c, (GetEndpointResponse,pkSess_3984,None,SP_3985,UP_3986))
                                    )
                                    else
                                        {4262}let pkSess_3987: bitstring = fail-any in
                                        {4263}in(c, =GetEndpointRequest);
                                        {4264}new SP_3988: bitstring;
                                        {4265}new UP_3989: bitstring;
                                        {4266}out(c, (GetEndpointResponse,pkSess_3987,None,SP_3988,UP_3989))
                            )
                            else
                                {4267}let pkSess_3990: bitstring = fail-any in
                                {4268}in(c, =GetEndpointRequest);
                                {4269}new SP_3991: bitstring;
                                {4270}new UP_3992: bitstring;
                                {4271}out(c, (GetEndpointResponse,pkSess_3990,None,SP_3991,UP_3992))
                        )
                        else
                            {4272}let v_3993: bool = (Cli_3936 = C) in
                            (
                                {4273}if v_3993 then
                                (
                                    {4274}let pkCli_3994: bitstring = pub(skC) in
                                    {4275}let v_3995: bool = (Sess_3938 = A) in
                                    (
                                        {4276}if v_3995 then
                                        (
                                            {4277}let pkSess_3996: bitstring = pub(skA) in
                                            {4278}in(c, =GetEndpointRequest);
                                            {4279}new SP_3997: bitstring;
                                            {4280}new UP_3998: bitstring;
                                            {4281}out(c, (GetEndpointResponse,pkSess_3996,None,SP_3997,UP_3998))
                                        )
                                        else
                                            {4282}let v_3999: bool = (Sess_3938 = B) in
                                            (
                                                {4283}if v_3999 then
                                                (
                                                    {4284}let pkSess_4000: bitstring = pub(skB) in
                                                    {4285}in(c, =GetEndpointRequest);
                                                    {4286}new SP_4001: bitstring;
                                                    {4287}new UP_4002: bitstring;
                                                    {4288}out(c, (GetEndpointResponse,pkSess_4000,None,SP_4001,UP_4002))
                                                )
                                                else
                                                    {4289}let v_4003: bool = (Sess_3938 = C) in
                                                    (
                                                        {4290}if v_4003 then
                                                        (
                                                            {4291}let pkSess_4004: bitstring = pub(skC) in
                                                            {4292}in(c, =GetEndpointRequest);
                                                            {4293}new SP_4005: bitstring;
                                                            {4294}new UP_4006: bitstring;
                                                            {4295}out(c, (GetEndpointResponse,pkSess_4004,None,SP_4005,UP_4006))
                                                        )
                                                        else
                                                            {4296}let pkSess_4007: bitstring = pub(sk(Sess_3938)) in
                                                            {4297}in(c, =GetEndpointRequest);
                                                            {4298}new SP_4008: bitstring;
                                                            {4299}new UP_4009: bitstring;
                                                            {4300}out(c, (GetEndpointResponse,pkSess_4007,None,SP_4008,UP_4009))
                                                    )
                                                    else
                                                        {4301}let pkSess_4010: bitstring = fail-any in
                                                        {4302}in(c, =GetEndpointRequest);
                                                        {4303}new SP_4011: bitstring;
                                                        {4304}new UP_4012: bitstring;
                                                        {4305}out(c, (GetEndpointResponse,pkSess_4010,None,SP_4011,UP_4012))
                                            )
                                            else
                                                {4306}let pkSess_4013: bitstring = fail-any in
                                                {4307}in(c, =GetEndpointRequest);
                                                {4308}new SP_4014: bitstring;
                                                {4309}new UP_4015: bitstring;
                                                {4310}out(c, (GetEndpointResponse,pkSess_4013,None,SP_4014,UP_4015))
                                    )
                                    else
                                        {4311}let pkSess_4016: bitstring = fail-any in
                                        {4312}in(c, =GetEndpointRequest);
                                        {4313}new SP_4017: bitstring;
                                        {4314}new UP_4018: bitstring;
                                        {4315}out(c, (GetEndpointResponse,pkSess_4016,None,SP_4017,UP_4018))
                                )
                                else
                                    {4316}let pkCli_4019: bitstring = pub(sk(Cli_3936)) in
                                    {4317}let v_4020: bool = (Sess_3938 = A) in
                                    (
                                        {4318}if v_4020 then
                                        (
                                            {4319}let pkSess_4021: bitstring = pub(skA) in
                                            {4320}in(c, =GetEndpointRequest);
                                            {4321}new SP_4022: bitstring;
                                            {4322}new UP_4023: bitstring;
                                            {4323}out(c, (GetEndpointResponse,pkSess_4021,None,SP_4022,UP_4023))
                                        )
                                        else
                                            {4324}let v_4024: bool = (Sess_3938 = B) in
                                            (
                                                {4325}if v_4024 then
                                                (
                                                    {4326}let pkSess_4025: bitstring = pub(skB) in
                                                    {4327}in(c, =GetEndpointRequest);
                                                    {4328}new SP_4026: bitstring;
                                                    {4329}new UP_4027: bitstring;
                                                    {4330}out(c, (GetEndpointResponse,pkSess_4025,None,SP_4026,UP_4027))
                                                )
                                                else
                                                    {4331}let v_4028: bool = (Sess_3938 = C) in
                                                    (
                                                        {4332}if v_4028 then
                                                        (
                                                            {4333}let pkSess_4029: bitstring = pub(skC) in
                                                            {4334}in(c, =GetEndpointRequest);
                                                            {4335}new SP_4030: bitstring;
                                                            {4336}new UP_4031: bitstring;
                                                            {4337}out(c, (GetEndpointResponse,pkSess_4029,None,SP_4030,UP_4031))
                                                        )
                                                        else
                                                            {4338}let pkSess_4032: bitstring = pub(sk(Sess_3938)) in
                                                            {4339}in(c, =GetEndpointRequest);
                                                            {4340}new SP_4033: bitstring;
                                                            {4341}new UP_4034: bitstring;
                                                            {4342}out(c, (GetEndpointResponse,pkSess_4032,None,SP_4033,UP_4034))
                                                    )
                                                    else
                                                        {4343}let pkSess_4035: bitstring = fail-any in
                                                        {4344}in(c, =GetEndpointRequest);
                                                        {4345}new SP_4036: bitstring;
                                                        {4346}new UP_4037: bitstring;
                                                        {4347}out(c, (GetEndpointResponse,pkSess_4035,None,SP_4036,UP_4037))
                                            )
                                            else
                                                {4348}let pkSess_4038: bitstring = fail-any in
                                                {4349}in(c, =GetEndpointRequest);
                                                {4350}new SP_4039: bitstring;
                                                {4351}new UP_4040: bitstring;
                                                {4352}out(c, (GetEndpointResponse,pkSess_4038,None,SP_4039,UP_4040))
                                    )
                                    else
                                        {4353}let pkSess_4041: bitstring = fail-any in
                                        {4354}in(c, =GetEndpointRequest);
                                        {4355}new SP_4042: bitstring;
                                        {4356}new UP_4043: bitstring;
                                        {4357}out(c, (GetEndpointResponse,pkSess_4041,None,SP_4042,UP_4043))
                            )
                            else
                                {4358}let pkCli_4044: bitstring = fail-any in
                                {4359}let v_4045: bool = (Sess_3938 = A) in
                                (
                                    {4360}if v_4045 then
                                    (
                                        {4361}let pkSess_4046: bitstring = pub(skA) in
                                        {4362}in(c, =GetEndpointRequest);
                                        {4363}new SP_4047: bitstring;
                                        {4364}new UP_4048: bitstring;
                                        {4365}out(c, (GetEndpointResponse,pkSess_4046,None,SP_4047,UP_4048))
                                    )
                                    else
                                        {4366}let v_4049: bool = (Sess_3938 = B) in
                                        (
                                            {4367}if v_4049 then
                                            (
                                                {4368}let pkSess_4050: bitstring = pub(skB) in
                                                {4369}in(c, =GetEndpointRequest);
                                                {4370}new SP_4051: bitstring;
                                                {4371}new UP_4052: bitstring;
                                                {4372}out(c, (GetEndpointResponse,pkSess_4050,None,SP_4051,UP_4052))
                                            )
                                            else
                                                {4373}let v_4053: bool = (Sess_3938 = C) in
                                                (
                                                    {4374}if v_4053 then
                                                    (
                                                        {4375}let pkSess_4054: bitstring = pub(skC) in
                                                        {4376}in(c, =GetEndpointRequest);
                                                        {4377}new SP_4055: bitstring;
                                                        {4378}new UP_4056: bitstring;
                                                        {4379}out(c, (GetEndpointResponse,pkSess_4054,None,SP_4055,UP_4056))
                                                    )
                                                    else
                                                        {4380}let pkSess_4057: bitstring = pub(sk(Sess_3938)) in
                                                        {4381}in(c, =GetEndpointRequest);
                                                        {4382}new SP_4058: bitstring;
                                                        {4383}new UP_4059: bitstring;
                                                        {4384}out(c, (GetEndpointResponse,pkSess_4057,None,SP_4058,UP_4059))
                                                )
                                                else
                                                    {4385}let pkSess_4060: bitstring = fail-any in
                                                    {4386}in(c, =GetEndpointRequest);
                                                    {4387}new SP_4061: bitstring;
                                                    {4388}new UP_4062: bitstring;
                                                    {4389}out(c, (GetEndpointResponse,pkSess_4060,None,SP_4061,UP_4062))
                                        )
                                        else
                                            {4390}let pkSess_4063: bitstring = fail-any in
                                            {4391}in(c, =GetEndpointRequest);
                                            {4392}new SP_4064: bitstring;
                                            {4393}new UP_4065: bitstring;
                                            {4394}out(c, (GetEndpointResponse,pkSess_4063,None,SP_4064,UP_4065))
                                )
                                else
                                    {4395}let pkSess_4066: bitstring = fail-any in
                                    {4396}in(c, =GetEndpointRequest);
                                    {4397}new SP_4067: bitstring;
                                    {4398}new UP_4068: bitstring;
                                    {4399}out(c, (GetEndpointResponse,pkSess_4066,None,SP_4067,UP_4068))
                    )
                    else
                        {4400}let pkCli_4069: bitstring = fail-any in
                        {4401}let v_4070: bool = (Sess_3938 = A) in
                        (
                            {4402}if v_4070 then
                            (
                                {4403}let pkSess_4071: bitstring = pub(skA) in
                                {4404}in(c, =GetEndpointRequest);
                                {4405}new SP_4072: bitstring;
                                {4406}new UP_4073: bitstring;
                                {4407}out(c, (GetEndpointResponse,pkSess_4071,None,SP_4072,UP_4073))
                            )
                            else
                                {4408}let v_4074: bool = (Sess_3938 = B) in
                                (
                                    {4409}if v_4074 then
                                    (
                                        {4410}let pkSess_4075: bitstring = pub(skB) in
                                        {4411}in(c, =GetEndpointRequest);
                                        {4412}new SP_4076: bitstring;
                                        {4413}new UP_4077: bitstring;
                                        {4414}out(c, (GetEndpointResponse,pkSess_4075,None,SP_4076,UP_4077))
                                    )
                                    else
                                        {4415}let v_4078: bool = (Sess_3938 = C) in
                                        (
                                            {4416}if v_4078 then
                                            (
                                                {4417}let pkSess_4079: bitstring = pub(skC) in
                                                {4418}in(c, =GetEndpointRequest);
                                                {4419}new SP_4080: bitstring;
                                                {4420}new UP_4081: bitstring;
                                                {4421}out(c, (GetEndpointResponse,pkSess_4079,None,SP_4080,UP_4081))
                                            )
                                            else
                                                {4422}let pkSess_4082: bitstring = pub(sk(Sess_3938)) in
                                                {4423}in(c, =GetEndpointRequest);
                                                {4424}new SP_4083: bitstring;
                                                {4425}new UP_4084: bitstring;
                                                {4426}out(c, (GetEndpointResponse,pkSess_4082,None,SP_4083,UP_4084))
                                        )
                                        else
                                            {4427}let pkSess_4085: bitstring = fail-any in
                                            {4428}in(c, =GetEndpointRequest);
                                            {4429}new SP_4086: bitstring;
                                            {4430}new UP_4087: bitstring;
                                            {4431}out(c, (GetEndpointResponse,pkSess_4085,None,SP_4086,UP_4087))
                                )
                                else
                                    {4432}let pkSess_4088: bitstring = fail-any in
                                    {4433}in(c, =GetEndpointRequest);
                                    {4434}new SP_4089: bitstring;
                                    {4435}new UP_4090: bitstring;
                                    {4436}out(c, (GetEndpointResponse,pkSess_4088,None,SP_4089,UP_4090))
                        )
                        else
                            {4437}let pkSess_4091: bitstring = fail-any in
                            {4438}in(c, =GetEndpointRequest);
                            {4439}new SP_4092: bitstring;
                            {4440}new UP_4093: bitstring;
                            {4441}out(c, (GetEndpointResponse,pkSess_4091,None,SP_4092,UP_4093))
            )
            else
                {4442}let pkCli_4094: bitstring = fail-any in
                {4443}let v_4095: bool = (Sess_3938 = A) in
                (
                    {4444}if v_4095 then
                    (
                        {4445}let pkSess_4096: bitstring = pub(skA) in
                        {4446}in(c, =GetEndpointRequest);
                        {4447}new SP_4097: bitstring;
                        {4448}new UP_4098: bitstring;
                        {4449}out(c, (GetEndpointResponse,pkSess_4096,None,SP_4097,UP_4098))
                    )
                    else
                        {4450}let v_4099: bool = (Sess_3938 = B) in
                        (
                            {4451}if v_4099 then
                            (
                                {4452}let pkSess_4100: bitstring = pub(skB) in
                                {4453}in(c, =GetEndpointRequest);
                                {4454}new SP_4101: bitstring;
                                {4455}new UP_4102: bitstring;
                                {4456}out(c, (GetEndpointResponse,pkSess_4100,None,SP_4101,UP_4102))
                            )
                            else
                                {4457}let v_4103: bool = (Sess_3938 = C) in
                                (
                                    {4458}if v_4103 then
                                    (
                                        {4459}let pkSess_4104: bitstring = pub(skC) in
                                        {4460}in(c, =GetEndpointRequest);
                                        {4461}new SP_4105: bitstring;
                                        {4462}new UP_4106: bitstring;
                                        {4463}out(c, (GetEndpointResponse,pkSess_4104,None,SP_4105,UP_4106))
                                    )
                                    else
                                        {4464}let pkSess_4107: bitstring = pub(sk(Sess_3938)) in
                                        {4465}in(c, =GetEndpointRequest);
                                        {4466}new SP_4108: bitstring;
                                        {4467}new UP_4109: bitstring;
                                        {4468}out(c, (GetEndpointResponse,pkSess_4107,None,SP_4108,UP_4109))
                                )
                                else
                                    {4469}let pkSess_4110: bitstring = fail-any in
                                    {4470}in(c, =GetEndpointRequest);
                                    {4471}new SP_4111: bitstring;
                                    {4472}new UP_4112: bitstring;
                                    {4473}out(c, (GetEndpointResponse,pkSess_4110,None,SP_4111,UP_4112))
                        )
                        else
                            {4474}let pkSess_4113: bitstring = fail-any in
                            {4475}in(c, =GetEndpointRequest);
                            {4476}new SP_4114: bitstring;
                            {4477}new UP_4115: bitstring;
                            {4478}out(c, (GetEndpointResponse,pkSess_4113,None,SP_4114,UP_4115))
                )
                else
                    {4479}let pkSess_4116: bitstring = fail-any in
                    {4480}in(c, =GetEndpointRequest);
                    {4481}new SP_4117: bitstring;
                    {4482}new UP_4118: bitstring;
                    {4483}out(c, (GetEndpointResponse,pkSess_4116,None,SP_4117,UP_4118))
        )
        else
            {4484}let v_4119: bool = (Disco_3937 = B) in
            (
                {4485}if v_4119 then
                (
                    {4486}let skDisco_4120: bitstring = skB in
                    {4487}let pkDisco_4121: bitstring = pub(skDisco_4120) in
                    {4488}let v_4122: bool = (Cli_3936 = A) in
                    (
                        {4489}if v_4122 then
                        (
                            {4490}let pkCli_4123: bitstring = pub(skA) in
                            {4491}let v_4124: bool = (Sess_3938 = A) in
                            (
                                {4492}if v_4124 then
                                (
                                    {4493}let pkSess_4125: bitstring = pub(skA) in
                                    {4494}in(c, =GetEndpointRequest);
                                    {4495}new SP_4126: bitstring;
                                    {4496}new UP_4127: bitstring;
                                    {4497}out(c, (GetEndpointResponse,pkSess_4125,None,SP_4126,UP_4127))
                                )
                                else
                                    {4498}let v_4128: bool = (Sess_3938 = B) in
                                    (
                                        {4499}if v_4128 then
                                        (
                                            {4500}let pkSess_4129: bitstring = pub(skB) in
                                            {4501}in(c, =GetEndpointRequest);
                                            {4502}new SP_4130: bitstring;
                                            {4503}new UP_4131: bitstring;
                                            {4504}out(c, (GetEndpointResponse,pkSess_4129,None,SP_4130,UP_4131))
                                        )
                                        else
                                            {4505}let v_4132: bool = (Sess_3938 = C) in
                                            (
                                                {4506}if v_4132 then
                                                (
                                                    {4507}let pkSess_4133: bitstring = pub(skC) in
                                                    {4508}in(c, =GetEndpointRequest);
                                                    {4509}new SP_4134: bitstring;
                                                    {4510}new UP_4135: bitstring;
                                                    {4511}out(c, (GetEndpointResponse,pkSess_4133,None,SP_4134,UP_4135))
                                                )
                                                else
                                                    {4512}let pkSess_4136: bitstring = pub(sk(Sess_3938)) in
                                                    {4513}in(c, =GetEndpointRequest);
                                                    {4514}new SP_4137: bitstring;
                                                    {4515}new UP_4138: bitstring;
                                                    {4516}out(c, (GetEndpointResponse,pkSess_4136,None,SP_4137,UP_4138))
                                            )
                                            else
                                                {4517}let pkSess_4139: bitstring = fail-any in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4140: bitstring;
                                                {4520}new UP_4141: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4139,None,SP_4140,UP_4141))
                                    )
                                    else
                                        {4522}let pkSess_4142: bitstring = fail-any in
                                        {4523}in(c, =GetEndpointRequest);
                                        {4524}new SP_4143: bitstring;
                                        {4525}new UP_4144: bitstring;
                                        {4526}out(c, (GetEndpointResponse,pkSess_4142,None,SP_4143,UP_4144))
                            )
                            else
                                {4527}let pkSess_4145: bitstring = fail-any in
                                {4528}in(c, =GetEndpointRequest);
                                {4529}new SP_4146: bitstring;
                                {4530}new UP_4147: bitstring;
                                {4531}out(c, (GetEndpointResponse,pkSess_4145,None,SP_4146,UP_4147))
                        )
                        else
                            {4532}let v_4148: bool = (Cli_3936 = B) in
                            (
                                {4533}if v_4148 then
                                (
                                    {4534}let pkCli_4149: bitstring = pub(skB) in
                                    {4535}let v_4150: bool = (Sess_3938 = A) in
                                    (
                                        {4536}if v_4150 then
                                        (
                                            {4537}let pkSess_4151: bitstring = pub(skA) in
                                            {4538}in(c, =GetEndpointRequest);
                                            {4539}new SP_4152: bitstring;
                                            {4540}new UP_4153: bitstring;
                                            {4541}out(c, (GetEndpointResponse,pkSess_4151,None,SP_4152,UP_4153))
                                        )
                                        else
                                            {4542}let v_4154: bool = (Sess_3938 = B) in
                                            (
                                                {4543}if v_4154 then
                                                (
                                                    {4544}let pkSess_4155: bitstring = pub(skB) in
                                                    {4545}in(c, =GetEndpointRequest);
                                                    {4546}new SP_4156: bitstring;
                                                    {4547}new UP_4157: bitstring;
                                                    {4548}out(c, (GetEndpointResponse,pkSess_4155,None,SP_4156,UP_4157))
                                                )
                                                else
                                                    {4549}let v_4158: bool = (Sess_3938 = C) in
                                                    (
                                                        {4550}if v_4158 then
                                                        (
                                                            {4551}let pkSess_4159: bitstring = pub(skC) in
                                                            {4552}in(c, =GetEndpointRequest);
                                                            {4553}new SP_4160: bitstring;
                                                            {4554}new UP_4161: bitstring;
                                                            {4555}out(c, (GetEndpointResponse,pkSess_4159,None,SP_4160,UP_4161))
                                                        )
                                                        else
                                                            {4556}let pkSess_4162: bitstring = pub(sk(Sess_3938)) in
                                                            {4557}in(c, =GetEndpointRequest);
                                                            {4558}new SP_4163: bitstring;
                                                            {4559}new UP_4164: bitstring;
                                                            {4560}out(c, (GetEndpointResponse,pkSess_4162,None,SP_4163,UP_4164))
                                                    )
                                                    else
                                                        {4561}let pkSess_4165: bitstring = fail-any in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4166: bitstring;
                                                        {4564}new UP_4167: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4165,None,SP_4166,UP_4167))
                                            )
                                            else
                                                {4566}let pkSess_4168: bitstring = fail-any in
                                                {4567}in(c, =GetEndpointRequest);
                                                {4568}new SP_4169: bitstring;
                                                {4569}new UP_4170: bitstring;
                                                {4570}out(c, (GetEndpointResponse,pkSess_4168,None,SP_4169,UP_4170))
                                    )
                                    else
                                        {4571}let pkSess_4171: bitstring = fail-any in
                                        {4572}in(c, =GetEndpointRequest);
                                        {4573}new SP_4172: bitstring;
                                        {4574}new UP_4173: bitstring;
                                        {4575}out(c, (GetEndpointResponse,pkSess_4171,None,SP_4172,UP_4173))
                                )
                                else
                                    {4576}let v_4174: bool = (Cli_3936 = C) in
                                    (
                                        {4577}if v_4174 then
                                        (
                                            {4578}let pkCli_4175: bitstring = pub(skC) in
                                            {4579}let v_4176: bool = (Sess_3938 = A) in
                                            (
                                                {4580}if v_4176 then
                                                (
                                                    {4581}let pkSess_4177: bitstring = pub(skA) in
                                                    {4582}in(c, =GetEndpointRequest);
                                                    {4583}new SP_4178: bitstring;
                                                    {4584}new UP_4179: bitstring;
                                                    {4585}out(c, (GetEndpointResponse,pkSess_4177,None,SP_4178,UP_4179))
                                                )
                                                else
                                                    {4586}let v_4180: bool = (Sess_3938 = B) in
                                                    (
                                                        {4587}if v_4180 then
                                                        (
                                                            {4588}let pkSess_4181: bitstring = pub(skB) in
                                                            {4589}in(c, =GetEndpointRequest);
                                                            {4590}new SP_4182: bitstring;
                                                            {4591}new UP_4183: bitstring;
                                                            {4592}out(c, (GetEndpointResponse,pkSess_4181,None,SP_4182,UP_4183))
                                                        )
                                                        else
                                                            {4593}let v_4184: bool = (Sess_3938 = C) in
                                                            (
                                                                {4594}if v_4184 then
                                                                (
                                                                    {4595}let pkSess_4185: bitstring = pub(skC) in
                                                                    {4596}in(c, =GetEndpointRequest);
                                                                    {4597}new SP_4186: bitstring;
                                                                    {4598}new UP_4187: bitstring;
                                                                    {4599}out(c, (GetEndpointResponse,pkSess_4185,None,SP_4186,UP_4187))
                                                                )
                                                                else
                                                                    {4600}let pkSess_4188: bitstring = pub(sk(Sess_3938)) in
                                                                    {4601}in(c, =GetEndpointRequest);
                                                                    {4602}new SP_4189: bitstring;
                                                                    {4603}new UP_4190: bitstring;
                                                                    {4604}out(c, (GetEndpointResponse,pkSess_4188,None,SP_4189,UP_4190))
                                                            )
                                                            else
                                                                {4605}let pkSess_4191: bitstring = fail-any in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4192: bitstring;
                                                                {4608}new UP_4193: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4191,None,SP_4192,UP_4193))
                                                    )
                                                    else
                                                        {4610}let pkSess_4194: bitstring = fail-any in
                                                        {4611}in(c, =GetEndpointRequest);
                                                        {4612}new SP_4195: bitstring;
                                                        {4613}new UP_4196: bitstring;
                                                        {4614}out(c, (GetEndpointResponse,pkSess_4194,None,SP_4195,UP_4196))
                                            )
                                            else
                                                {4615}let pkSess_4197: bitstring = fail-any in
                                                {4616}in(c, =GetEndpointRequest);
                                                {4617}new SP_4198: bitstring;
                                                {4618}new UP_4199: bitstring;
                                                {4619}out(c, (GetEndpointResponse,pkSess_4197,None,SP_4198,UP_4199))
                                        )
                                        else
                                            {4620}let pkCli_4200: bitstring = pub(sk(Cli_3936)) in
                                            {4621}let v_4201: bool = (Sess_3938 = A) in
                                            (
                                                {4622}if v_4201 then
                                                (
                                                    {4623}let pkSess_4202: bitstring = pub(skA) in
                                                    {4624}in(c, =GetEndpointRequest);
                                                    {4625}new SP_4203: bitstring;
                                                    {4626}new UP_4204: bitstring;
                                                    {4627}out(c, (GetEndpointResponse,pkSess_4202,None,SP_4203,UP_4204))
                                                )
                                                else
                                                    {4628}let v_4205: bool = (Sess_3938 = B) in
                                                    (
                                                        {4629}if v_4205 then
                                                        (
                                                            {4630}let pkSess_4206: bitstring = pub(skB) in
                                                            {4631}in(c, =GetEndpointRequest);
                                                            {4632}new SP_4207: bitstring;
                                                            {4633}new UP_4208: bitstring;
                                                            {4634}out(c, (GetEndpointResponse,pkSess_4206,None,SP_4207,UP_4208))
                                                        )
                                                        else
                                                            {4635}let v_4209: bool = (Sess_3938 = C) in
                                                            (
                                                                {4636}if v_4209 then
                                                                (
                                                                    {4637}let pkSess_4210: bitstring = pub(skC) in
                                                                    {4638}in(c, =GetEndpointRequest);
                                                                    {4639}new SP_4211: bitstring;
                                                                    {4640}new UP_4212: bitstring;
                                                                    {4641}out(c, (GetEndpointResponse,pkSess_4210,None,SP_4211,UP_4212))
                                                                )
                                                                else
                                                                    {4642}let pkSess_4213: bitstring = pub(sk(Sess_3938)) in
                                                                    {4643}in(c, =GetEndpointRequest);
                                                                    {4644}new SP_4214: bitstring;
                                                                    {4645}new UP_4215: bitstring;
                                                                    {4646}out(c, (GetEndpointResponse,pkSess_4213,None,SP_4214,UP_4215))
                                                            )
                                                            else
                                                                {4647}let pkSess_4216: bitstring = fail-any in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4217: bitstring;
                                                                {4650}new UP_4218: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4216,None,SP_4217,UP_4218))
                                                    )
                                                    else
                                                        {4652}let pkSess_4219: bitstring = fail-any in
                                                        {4653}in(c, =GetEndpointRequest);
                                                        {4654}new SP_4220: bitstring;
                                                        {4655}new UP_4221: bitstring;
                                                        {4656}out(c, (GetEndpointResponse,pkSess_4219,None,SP_4220,UP_4221))
                                            )
                                            else
                                                {4657}let pkSess_4222: bitstring = fail-any in
                                                {4658}in(c, =GetEndpointRequest);
                                                {4659}new SP_4223: bitstring;
                                                {4660}new UP_4224: bitstring;
                                                {4661}out(c, (GetEndpointResponse,pkSess_4222,None,SP_4223,UP_4224))
                                    )
                                    else
                                        {4662}let pkCli_4225: bitstring = fail-any in
                                        {4663}let v_4226: bool = (Sess_3938 = A) in
                                        (
                                            {4664}if v_4226 then
                                            (
                                                {4665}let pkSess_4227: bitstring = pub(skA) in
                                                {4666}in(c, =GetEndpointRequest);
                                                {4667}new SP_4228: bitstring;
                                                {4668}new UP_4229: bitstring;
                                                {4669}out(c, (GetEndpointResponse,pkSess_4227,None,SP_4228,UP_4229))
                                            )
                                            else
                                                {4670}let v_4230: bool = (Sess_3938 = B) in
                                                (
                                                    {4671}if v_4230 then
                                                    (
                                                        {4672}let pkSess_4231: bitstring = pub(skB) in
                                                        {4673}in(c, =GetEndpointRequest);
                                                        {4674}new SP_4232: bitstring;
                                                        {4675}new UP_4233: bitstring;
                                                        {4676}out(c, (GetEndpointResponse,pkSess_4231,None,SP_4232,UP_4233))
                                                    )
                                                    else
                                                        {4677}let v_4234: bool = (Sess_3938 = C) in
                                                        (
                                                            {4678}if v_4234 then
                                                            (
                                                                {4679}let pkSess_4235: bitstring = pub(skC) in
                                                                {4680}in(c, =GetEndpointRequest);
                                                                {4681}new SP_4236: bitstring;
                                                                {4682}new UP_4237: bitstring;
                                                                {4683}out(c, (GetEndpointResponse,pkSess_4235,None,SP_4236,UP_4237))
                                                            )
                                                            else
                                                                {4684}let pkSess_4238: bitstring = pub(sk(Sess_3938)) in
                                                                {4685}in(c, =GetEndpointRequest);
                                                                {4686}new SP_4239: bitstring;
                                                                {4687}new UP_4240: bitstring;
                                                                {4688}out(c, (GetEndpointResponse,pkSess_4238,None,SP_4239,UP_4240))
                                                        )
                                                        else
                                                            {4689}let pkSess_4241: bitstring = fail-any in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4242: bitstring;
                                                            {4692}new UP_4243: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4241,None,SP_4242,UP_4243))
                                                )
                                                else
                                                    {4694}let pkSess_4244: bitstring = fail-any in
                                                    {4695}in(c, =GetEndpointRequest);
                                                    {4696}new SP_4245: bitstring;
                                                    {4697}new UP_4246: bitstring;
                                                    {4698}out(c, (GetEndpointResponse,pkSess_4244,None,SP_4245,UP_4246))
                                        )
                                        else
                                            {4699}let pkSess_4247: bitstring = fail-any in
                                            {4700}in(c, =GetEndpointRequest);
                                            {4701}new SP_4248: bitstring;
                                            {4702}new UP_4249: bitstring;
                                            {4703}out(c, (GetEndpointResponse,pkSess_4247,None,SP_4248,UP_4249))
                            )
                            else
                                {4704}let pkCli_4250: bitstring = fail-any in
                                {4705}let v_4251: bool = (Sess_3938 = A) in
                                (
                                    {4706}if v_4251 then
                                    (
                                        {4707}let pkSess_4252: bitstring = pub(skA) in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SP_4253: bitstring;
                                        {4710}new UP_4254: bitstring;
                                        {4711}out(c, (GetEndpointResponse,pkSess_4252,None,SP_4253,UP_4254))
                                    )
                                    else
                                        {4712}let v_4255: bool = (Sess_3938 = B) in
                                        (
                                            {4713}if v_4255 then
                                            (
                                                {4714}let pkSess_4256: bitstring = pub(skB) in
                                                {4715}in(c, =GetEndpointRequest);
                                                {4716}new SP_4257: bitstring;
                                                {4717}new UP_4258: bitstring;
                                                {4718}out(c, (GetEndpointResponse,pkSess_4256,None,SP_4257,UP_4258))
                                            )
                                            else
                                                {4719}let v_4259: bool = (Sess_3938 = C) in
                                                (
                                                    {4720}if v_4259 then
                                                    (
                                                        {4721}let pkSess_4260: bitstring = pub(skC) in
                                                        {4722}in(c, =GetEndpointRequest);
                                                        {4723}new SP_4261: bitstring;
                                                        {4724}new UP_4262: bitstring;
                                                        {4725}out(c, (GetEndpointResponse,pkSess_4260,None,SP_4261,UP_4262))
                                                    )
                                                    else
                                                        {4726}let pkSess_4263: bitstring = pub(sk(Sess_3938)) in
                                                        {4727}in(c, =GetEndpointRequest);
                                                        {4728}new SP_4264: bitstring;
                                                        {4729}new UP_4265: bitstring;
                                                        {4730}out(c, (GetEndpointResponse,pkSess_4263,None,SP_4264,UP_4265))
                                                )
                                                else
                                                    {4731}let pkSess_4266: bitstring = fail-any in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4267: bitstring;
                                                    {4734}new UP_4268: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4266,None,SP_4267,UP_4268))
                                        )
                                        else
                                            {4736}let pkSess_4269: bitstring = fail-any in
                                            {4737}in(c, =GetEndpointRequest);
                                            {4738}new SP_4270: bitstring;
                                            {4739}new UP_4271: bitstring;
                                            {4740}out(c, (GetEndpointResponse,pkSess_4269,None,SP_4270,UP_4271))
                                )
                                else
                                    {4741}let pkSess_4272: bitstring = fail-any in
                                    {4742}in(c, =GetEndpointRequest);
                                    {4743}new SP_4273: bitstring;
                                    {4744}new UP_4274: bitstring;
                                    {4745}out(c, (GetEndpointResponse,pkSess_4272,None,SP_4273,UP_4274))
                    )
                    else
                        {4746}let pkCli_4275: bitstring = fail-any in
                        {4747}let v_4276: bool = (Sess_3938 = A) in
                        (
                            {4748}if v_4276 then
                            (
                                {4749}let pkSess_4277: bitstring = pub(skA) in
                                {4750}in(c, =GetEndpointRequest);
                                {4751}new SP_4278: bitstring;
                                {4752}new UP_4279: bitstring;
                                {4753}out(c, (GetEndpointResponse,pkSess_4277,None,SP_4278,UP_4279))
                            )
                            else
                                {4754}let v_4280: bool = (Sess_3938 = B) in
                                (
                                    {4755}if v_4280 then
                                    (
                                        {4756}let pkSess_4281: bitstring = pub(skB) in
                                        {4757}in(c, =GetEndpointRequest);
                                        {4758}new SP_4282: bitstring;
                                        {4759}new UP_4283: bitstring;
                                        {4760}out(c, (GetEndpointResponse,pkSess_4281,None,SP_4282,UP_4283))
                                    )
                                    else
                                        {4761}let v_4284: bool = (Sess_3938 = C) in
                                        (
                                            {4762}if v_4284 then
                                            (
                                                {4763}let pkSess_4285: bitstring = pub(skC) in
                                                {4764}in(c, =GetEndpointRequest);
                                                {4765}new SP_4286: bitstring;
                                                {4766}new UP_4287: bitstring;
                                                {4767}out(c, (GetEndpointResponse,pkSess_4285,None,SP_4286,UP_4287))
                                            )
                                            else
                                                {4768}let pkSess_4288: bitstring = pub(sk(Sess_3938)) in
                                                {4769}in(c, =GetEndpointRequest);
                                                {4770}new SP_4289: bitstring;
                                                {4771}new UP_4290: bitstring;
                                                {4772}out(c, (GetEndpointResponse,pkSess_4288,None,SP_4289,UP_4290))
                                        )
                                        else
                                            {4773}let pkSess_4291: bitstring = fail-any in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4292: bitstring;
                                            {4776}new UP_4293: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4291,None,SP_4292,UP_4293))
                                )
                                else
                                    {4778}let pkSess_4294: bitstring = fail-any in
                                    {4779}in(c, =GetEndpointRequest);
                                    {4780}new SP_4295: bitstring;
                                    {4781}new UP_4296: bitstring;
                                    {4782}out(c, (GetEndpointResponse,pkSess_4294,None,SP_4295,UP_4296))
                        )
                        else
                            {4783}let pkSess_4297: bitstring = fail-any in
                            {4784}in(c, =GetEndpointRequest);
                            {4785}new SP_4298: bitstring;
                            {4786}new UP_4299: bitstring;
                            {4787}out(c, (GetEndpointResponse,pkSess_4297,None,SP_4298,UP_4299))
                )
                else
                    {4788}let =true = (Disco_3937 = C) in
                    (
                        {4789}let skDisco_4300: bitstring = skC in
                        {4790}let pkDisco_4301: bitstring = pub(skDisco_4300) in
                        {4791}let v_4302: bool = (Cli_3936 = A) in
                        (
                            {4792}if v_4302 then
                            (
                                {4793}let pkCli_4303: bitstring = pub(skA) in
                                {4794}let v_4304: bool = (Sess_3938 = A) in
                                (
                                    {4795}if v_4304 then
                                    (
                                        {4796}let pkSess_4305: bitstring = pub(skA) in
                                        {4797}in(c, =GetEndpointRequest);
                                        {4798}new SP_4306: bitstring;
                                        {4799}new UP_4307: bitstring;
                                        {4800}out(c, (GetEndpointResponse,pkSess_4305,None,SP_4306,UP_4307))
                                    )
                                    else
                                        {4801}let v_4308: bool = (Sess_3938 = B) in
                                        (
                                            {4802}if v_4308 then
                                            (
                                                {4803}let pkSess_4309: bitstring = pub(skB) in
                                                {4804}in(c, =GetEndpointRequest);
                                                {4805}new SP_4310: bitstring;
                                                {4806}new UP_4311: bitstring;
                                                {4807}out(c, (GetEndpointResponse,pkSess_4309,None,SP_4310,UP_4311))
                                            )
                                            else
                                                {4808}let v_4312: bool = (Sess_3938 = C) in
                                                (
                                                    {4809}if v_4312 then
                                                    (
                                                        {4810}let pkSess_4313: bitstring = pub(skC) in
                                                        {4811}in(c, =GetEndpointRequest);
                                                        {4812}new SP_4314: bitstring;
                                                        {4813}new UP_4315: bitstring;
                                                        {4814}out(c, (GetEndpointResponse,pkSess_4313,None,SP_4314,UP_4315))
                                                    )
                                                    else
                                                        {4815}let pkSess_4316: bitstring = pub(sk(Sess_3938)) in
                                                        {4816}in(c, =GetEndpointRequest);
                                                        {4817}new SP_4317: bitstring;
                                                        {4818}new UP_4318: bitstring;
                                                        {4819}out(c, (GetEndpointResponse,pkSess_4316,None,SP_4317,UP_4318))
                                                )
                                                else
                                                    {4820}let pkSess_4319: bitstring = fail-any in
                                                    {4821}in(c, =GetEndpointRequest);
                                                    {4822}new SP_4320: bitstring;
                                                    {4823}new UP_4321: bitstring;
                                                    {4824}out(c, (GetEndpointResponse,pkSess_4319,None,SP_4320,UP_4321))
                                        )
                                        else
                                            {4825}let pkSess_4322: bitstring = fail-any in
                                            {4826}in(c, =GetEndpointRequest);
                                            {4827}new SP_4323: bitstring;
                                            {4828}new UP_4324: bitstring;
                                            {4829}out(c, (GetEndpointResponse,pkSess_4322,None,SP_4323,UP_4324))
                                )
                                else
                                    {4830}let pkSess_4325: bitstring = fail-any in
                                    {4831}in(c, =GetEndpointRequest);
                                    {4832}new SP_4326: bitstring;
                                    {4833}new UP_4327: bitstring;
                                    {4834}out(c, (GetEndpointResponse,pkSess_4325,None,SP_4326,UP_4327))
                            )
                            else
                                {4835}let v_4328: bool = (Cli_3936 = B) in
                                (
                                    {4836}if v_4328 then
                                    (
                                        {4837}let pkCli_4329: bitstring = pub(skB) in
                                        {4838}let v_4330: bool = (Sess_3938 = A) in
                                        (
                                            {4839}if v_4330 then
                                            (
                                                {4840}let pkSess_4331: bitstring = pub(skA) in
                                                {4841}in(c, =GetEndpointRequest);
                                                {4842}new SP_4332: bitstring;
                                                {4843}new UP_4333: bitstring;
                                                {4844}out(c, (GetEndpointResponse,pkSess_4331,None,SP_4332,UP_4333))
                                            )
                                            else
                                                {4845}let v_4334: bool = (Sess_3938 = B) in
                                                (
                                                    {4846}if v_4334 then
                                                    (
                                                        {4847}let pkSess_4335: bitstring = pub(skB) in
                                                        {4848}in(c, =GetEndpointRequest);
                                                        {4849}new SP_4336: bitstring;
                                                        {4850}new UP_4337: bitstring;
                                                        {4851}out(c, (GetEndpointResponse,pkSess_4335,None,SP_4336,UP_4337))
                                                    )
                                                    else
                                                        {4852}let v_4338: bool = (Sess_3938 = C) in
                                                        (
                                                            {4853}if v_4338 then
                                                            (
                                                                {4854}let pkSess_4339: bitstring = pub(skC) in
                                                                {4855}in(c, =GetEndpointRequest);
                                                                {4856}new SP_4340: bitstring;
                                                                {4857}new UP_4341: bitstring;
                                                                {4858}out(c, (GetEndpointResponse,pkSess_4339,None,SP_4340,UP_4341))
                                                            )
                                                            else
                                                                {4859}let pkSess_4342: bitstring = pub(sk(Sess_3938)) in
                                                                {4860}in(c, =GetEndpointRequest);
                                                                {4861}new SP_4343: bitstring;
                                                                {4862}new UP_4344: bitstring;
                                                                {4863}out(c, (GetEndpointResponse,pkSess_4342,None,SP_4343,UP_4344))
                                                        )
                                                        else
                                                            {4864}let pkSess_4345: bitstring = fail-any in
                                                            {4865}in(c, =GetEndpointRequest);
                                                            {4866}new SP_4346: bitstring;
                                                            {4867}new UP_4347: bitstring;
                                                            {4868}out(c, (GetEndpointResponse,pkSess_4345,None,SP_4346,UP_4347))
                                                )
                                                else
                                                    {4869}let pkSess_4348: bitstring = fail-any in
                                                    {4870}in(c, =GetEndpointRequest);
                                                    {4871}new SP_4349: bitstring;
                                                    {4872}new UP_4350: bitstring;
                                                    {4873}out(c, (GetEndpointResponse,pkSess_4348,None,SP_4349,UP_4350))
                                        )
                                        else
                                            {4874}let pkSess_4351: bitstring = fail-any in
                                            {4875}in(c, =GetEndpointRequest);
                                            {4876}new SP_4352: bitstring;
                                            {4877}new UP_4353: bitstring;
                                            {4878}out(c, (GetEndpointResponse,pkSess_4351,None,SP_4352,UP_4353))
                                    )
                                    else
                                        {4879}let v_4354: bool = (Cli_3936 = C) in
                                        (
                                            {4880}if v_4354 then
                                            (
                                                {4881}let pkCli_4355: bitstring = pub(skC) in
                                                {4882}let v_4356: bool = (Sess_3938 = A) in
                                                (
                                                    {4883}if v_4356 then
                                                    (
                                                        {4884}let pkSess_4357: bitstring = pub(skA) in
                                                        {4885}in(c, =GetEndpointRequest);
                                                        {4886}new SP_4358: bitstring;
                                                        {4887}new UP_4359: bitstring;
                                                        {4888}out(c, (GetEndpointResponse,pkSess_4357,None,SP_4358,UP_4359))
                                                    )
                                                    else
                                                        {4889}let v_4360: bool = (Sess_3938 = B) in
                                                        (
                                                            {4890}if v_4360 then
                                                            (
                                                                {4891}let pkSess_4361: bitstring = pub(skB) in
                                                                {4892}in(c, =GetEndpointRequest);
                                                                {4893}new SP_4362: bitstring;
                                                                {4894}new UP_4363: bitstring;
                                                                {4895}out(c, (GetEndpointResponse,pkSess_4361,None,SP_4362,UP_4363))
                                                            )
                                                            else
                                                                {4896}let v_4364: bool = (Sess_3938 = C) in
                                                                (
                                                                    {4897}if v_4364 then
                                                                    (
                                                                        {4898}let pkSess_4365: bitstring = pub(skC) in
                                                                        {4899}in(c, =GetEndpointRequest);
                                                                        {4900}new SP_4366: bitstring;
                                                                        {4901}new UP_4367: bitstring;
                                                                        {4902}out(c, (GetEndpointResponse,pkSess_4365,None,SP_4366,UP_4367))
                                                                    )
                                                                    else
                                                                        {4903}let pkSess_4368: bitstring = pub(sk(Sess_3938)) in
                                                                        {4904}in(c, =GetEndpointRequest);
                                                                        {4905}new SP_4369: bitstring;
                                                                        {4906}new UP_4370: bitstring;
                                                                        {4907}out(c, (GetEndpointResponse,pkSess_4368,None,SP_4369,UP_4370))
                                                                )
                                                                else
                                                                    {4908}let pkSess_4371: bitstring = fail-any in
                                                                    {4909}in(c, =GetEndpointRequest);
                                                                    {4910}new SP_4372: bitstring;
                                                                    {4911}new UP_4373: bitstring;
                                                                    {4912}out(c, (GetEndpointResponse,pkSess_4371,None,SP_4372,UP_4373))
                                                        )
                                                        else
                                                            {4913}let pkSess_4374: bitstring = fail-any in
                                                            {4914}in(c, =GetEndpointRequest);
                                                            {4915}new SP_4375: bitstring;
                                                            {4916}new UP_4376: bitstring;
                                                            {4917}out(c, (GetEndpointResponse,pkSess_4374,None,SP_4375,UP_4376))
                                                )
                                                else
                                                    {4918}let pkSess_4377: bitstring = fail-any in
                                                    {4919}in(c, =GetEndpointRequest);
                                                    {4920}new SP_4378: bitstring;
                                                    {4921}new UP_4379: bitstring;
                                                    {4922}out(c, (GetEndpointResponse,pkSess_4377,None,SP_4378,UP_4379))
                                            )
                                            else
                                                {4923}let pkCli_4380: bitstring = pub(sk(Cli_3936)) in
                                                {4924}let v_4381: bool = (Sess_3938 = A) in
                                                (
                                                    {4925}if v_4381 then
                                                    (
                                                        {4926}let pkSess_4382: bitstring = pub(skA) in
                                                        {4927}in(c, =GetEndpointRequest);
                                                        {4928}new SP_4383: bitstring;
                                                        {4929}new UP_4384: bitstring;
                                                        {4930}out(c, (GetEndpointResponse,pkSess_4382,None,SP_4383,UP_4384))
                                                    )
                                                    else
                                                        {4931}let v_4385: bool = (Sess_3938 = B) in
                                                        (
                                                            {4932}if v_4385 then
                                                            (
                                                                {4933}let pkSess_4386: bitstring = pub(skB) in
                                                                {4934}in(c, =GetEndpointRequest);
                                                                {4935}new SP_4387: bitstring;
                                                                {4936}new UP_4388: bitstring;
                                                                {4937}out(c, (GetEndpointResponse,pkSess_4386,None,SP_4387,UP_4388))
                                                            )
                                                            else
                                                                {4938}let v_4389: bool = (Sess_3938 = C) in
                                                                (
                                                                    {4939}if v_4389 then
                                                                    (
                                                                        {4940}let pkSess_4390: bitstring = pub(skC) in
                                                                        {4941}in(c, =GetEndpointRequest);
                                                                        {4942}new SP_4391: bitstring;
                                                                        {4943}new UP_4392: bitstring;
                                                                        {4944}out(c, (GetEndpointResponse,pkSess_4390,None,SP_4391,UP_4392))
                                                                    )
                                                                    else
                                                                        {4945}let pkSess_4393: bitstring = pub(sk(Sess_3938)) in
                                                                        {4946}in(c, =GetEndpointRequest);
                                                                        {4947}new SP_4394: bitstring;
                                                                        {4948}new UP_4395: bitstring;
                                                                        {4949}out(c, (GetEndpointResponse,pkSess_4393,None,SP_4394,UP_4395))
                                                                )
                                                                else
                                                                    {4950}let pkSess_4396: bitstring = fail-any in
                                                                    {4951}in(c, =GetEndpointRequest);
                                                                    {4952}new SP_4397: bitstring;
                                                                    {4953}new UP_4398: bitstring;
                                                                    {4954}out(c, (GetEndpointResponse,pkSess_4396,None,SP_4397,UP_4398))
                                                        )
                                                        else
                                                            {4955}let pkSess_4399: bitstring = fail-any in
                                                            {4956}in(c, =GetEndpointRequest);
                                                            {4957}new SP_4400: bitstring;
                                                            {4958}new UP_4401: bitstring;
                                                            {4959}out(c, (GetEndpointResponse,pkSess_4399,None,SP_4400,UP_4401))
                                                )
                                                else
                                                    {4960}let pkSess_4402: bitstring = fail-any in
                                                    {4961}in(c, =GetEndpointRequest);
                                                    {4962}new SP_4403: bitstring;
                                                    {4963}new UP_4404: bitstring;
                                                    {4964}out(c, (GetEndpointResponse,pkSess_4402,None,SP_4403,UP_4404))
                                        )
                                        else
                                            {4965}let pkCli_4405: bitstring = fail-any in
                                            {4966}let v_4406: bool = (Sess_3938 = A) in
                                            (
                                                {4967}if v_4406 then
                                                (
                                                    {4968}let pkSess_4407: bitstring = pub(skA) in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4408: bitstring;
                                                    {4971}new UP_4409: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4407,None,SP_4408,UP_4409))
                                                )
                                                else
                                                    {4973}let v_4410: bool = (Sess_3938 = B) in
                                                    (
                                                        {4974}if v_4410 then
                                                        (
                                                            {4975}let pkSess_4411: bitstring = pub(skB) in
                                                            {4976}in(c, =GetEndpointRequest);
                                                            {4977}new SP_4412: bitstring;
                                                            {4978}new UP_4413: bitstring;
                                                            {4979}out(c, (GetEndpointResponse,pkSess_4411,None,SP_4412,UP_4413))
                                                        )
                                                        else
                                                            {4980}let v_4414: bool = (Sess_3938 = C) in
                                                            (
                                                                {4981}if v_4414 then
                                                                (
                                                                    {4982}let pkSess_4415: bitstring = pub(skC) in
                                                                    {4983}in(c, =GetEndpointRequest);
                                                                    {4984}new SP_4416: bitstring;
                                                                    {4985}new UP_4417: bitstring;
                                                                    {4986}out(c, (GetEndpointResponse,pkSess_4415,None,SP_4416,UP_4417))
                                                                )
                                                                else
                                                                    {4987}let pkSess_4418: bitstring = pub(sk(Sess_3938)) in
                                                                    {4988}in(c, =GetEndpointRequest);
                                                                    {4989}new SP_4419: bitstring;
                                                                    {4990}new UP_4420: bitstring;
                                                                    {4991}out(c, (GetEndpointResponse,pkSess_4418,None,SP_4419,UP_4420))
                                                            )
                                                            else
                                                                {4992}let pkSess_4421: bitstring = fail-any in
                                                                {4993}in(c, =GetEndpointRequest);
                                                                {4994}new SP_4422: bitstring;
                                                                {4995}new UP_4423: bitstring;
                                                                {4996}out(c, (GetEndpointResponse,pkSess_4421,None,SP_4422,UP_4423))
                                                    )
                                                    else
                                                        {4997}let pkSess_4424: bitstring = fail-any in
                                                        {4998}in(c, =GetEndpointRequest);
                                                        {4999}new SP_4425: bitstring;
                                                        {5000}new UP_4426: bitstring;
                                                        {5001}out(c, (GetEndpointResponse,pkSess_4424,None,SP_4425,UP_4426))
                                            )
                                            else
                                                {5002}let pkSess_4427: bitstring = fail-any in
                                                {5003}in(c, =GetEndpointRequest);
                                                {5004}new SP_4428: bitstring;
                                                {5005}new UP_4429: bitstring;
                                                {5006}out(c, (GetEndpointResponse,pkSess_4427,None,SP_4428,UP_4429))
                                )
                                else
                                    {5007}let pkCli_4430: bitstring = fail-any in
                                    {5008}let v_4431: bool = (Sess_3938 = A) in
                                    (
                                        {5009}if v_4431 then
                                        (
                                            {5010}let pkSess_4432: bitstring = pub(skA) in
                                            {5011}in(c, =GetEndpointRequest);
                                            {5012}new SP_4433: bitstring;
                                            {5013}new UP_4434: bitstring;
                                            {5014}out(c, (GetEndpointResponse,pkSess_4432,None,SP_4433,UP_4434))
                                        )
                                        else
                                            {5015}let v_4435: bool = (Sess_3938 = B) in
                                            (
                                                {5016}if v_4435 then
                                                (
                                                    {5017}let pkSess_4436: bitstring = pub(skB) in
                                                    {5018}in(c, =GetEndpointRequest);
                                                    {5019}new SP_4437: bitstring;
                                                    {5020}new UP_4438: bitstring;
                                                    {5021}out(c, (GetEndpointResponse,pkSess_4436,None,SP_4437,UP_4438))
                                                )
                                                else
                                                    {5022}let v_4439: bool = (Sess_3938 = C) in
                                                    (
                                                        {5023}if v_4439 then
                                                        (
                                                            {5024}let pkSess_4440: bitstring = pub(skC) in
                                                            {5025}in(c, =GetEndpointRequest);
                                                            {5026}new SP_4441: bitstring;
                                                            {5027}new UP_4442: bitstring;
                                                            {5028}out(c, (GetEndpointResponse,pkSess_4440,None,SP_4441,UP_4442))
                                                        )
                                                        else
                                                            {5029}let pkSess_4443: bitstring = pub(sk(Sess_3938)) in
                                                            {5030}in(c, =GetEndpointRequest);
                                                            {5031}new SP_4444: bitstring;
                                                            {5032}new UP_4445: bitstring;
                                                            {5033}out(c, (GetEndpointResponse,pkSess_4443,None,SP_4444,UP_4445))
                                                    )
                                                    else
                                                        {5034}let pkSess_4446: bitstring = fail-any in
                                                        {5035}in(c, =GetEndpointRequest);
                                                        {5036}new SP_4447: bitstring;
                                                        {5037}new UP_4448: bitstring;
                                                        {5038}out(c, (GetEndpointResponse,pkSess_4446,None,SP_4447,UP_4448))
                                            )
                                            else
                                                {5039}let pkSess_4449: bitstring = fail-any in
                                                {5040}in(c, =GetEndpointRequest);
                                                {5041}new SP_4450: bitstring;
                                                {5042}new UP_4451: bitstring;
                                                {5043}out(c, (GetEndpointResponse,pkSess_4449,None,SP_4450,UP_4451))
                                    )
                                    else
                                        {5044}let pkSess_4452: bitstring = fail-any in
                                        {5045}in(c, =GetEndpointRequest);
                                        {5046}new SP_4453: bitstring;
                                        {5047}new UP_4454: bitstring;
                                        {5048}out(c, (GetEndpointResponse,pkSess_4452,None,SP_4453,UP_4454))
                        )
                        else
                            {5049}let pkCli_4455: bitstring = fail-any in
                            {5050}let v_4456: bool = (Sess_3938 = A) in
                            (
                                {5051}if v_4456 then
                                (
                                    {5052}let pkSess_4457: bitstring = pub(skA) in
                                    {5053}in(c, =GetEndpointRequest);
                                    {5054}new SP_4458: bitstring;
                                    {5055}new UP_4459: bitstring;
                                    {5056}out(c, (GetEndpointResponse,pkSess_4457,None,SP_4458,UP_4459))
                                )
                                else
                                    {5057}let v_4460: bool = (Sess_3938 = B) in
                                    (
                                        {5058}if v_4460 then
                                        (
                                            {5059}let pkSess_4461: bitstring = pub(skB) in
                                            {5060}in(c, =GetEndpointRequest);
                                            {5061}new SP_4462: bitstring;
                                            {5062}new UP_4463: bitstring;
                                            {5063}out(c, (GetEndpointResponse,pkSess_4461,None,SP_4462,UP_4463))
                                        )
                                        else
                                            {5064}let v_4464: bool = (Sess_3938 = C) in
                                            (
                                                {5065}if v_4464 then
                                                (
                                                    {5066}let pkSess_4465: bitstring = pub(skC) in
                                                    {5067}in(c, =GetEndpointRequest);
                                                    {5068}new SP_4466: bitstring;
                                                    {5069}new UP_4467: bitstring;
                                                    {5070}out(c, (GetEndpointResponse,pkSess_4465,None,SP_4466,UP_4467))
                                                )
                                                else
                                                    {5071}let pkSess_4468: bitstring = pub(sk(Sess_3938)) in
                                                    {5072}in(c, =GetEndpointRequest);
                                                    {5073}new SP_4469: bitstring;
                                                    {5074}new UP_4470: bitstring;
                                                    {5075}out(c, (GetEndpointResponse,pkSess_4468,None,SP_4469,UP_4470))
                                            )
                                            else
                                                {5076}let pkSess_4471: bitstring = fail-any in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SP_4472: bitstring;
                                                {5079}new UP_4473: bitstring;
                                                {5080}out(c, (GetEndpointResponse,pkSess_4471,None,SP_4472,UP_4473))
                                    )
                                    else
                                        {5081}let pkSess_4474: bitstring = fail-any in
                                        {5082}in(c, =GetEndpointRequest);
                                        {5083}new SP_4475: bitstring;
                                        {5084}new UP_4476: bitstring;
                                        {5085}out(c, (GetEndpointResponse,pkSess_4474,None,SP_4475,UP_4476))
                            )
                            else
                                {5086}let pkSess_4477: bitstring = fail-any in
                                {5087}in(c, =GetEndpointRequest);
                                {5088}new SP_4478: bitstring;
                                {5089}new UP_4479: bitstring;
                                {5090}out(c, (GetEndpointResponse,pkSess_4477,None,SP_4478,UP_4479))
                    )
                    else
                        {5091}let skDisco_4480: bitstring = fail-any in
                        {5092}let pkDisco_4481: bitstring = pub(skDisco_4480) in
                        {5093}let v_4482: bool = (Cli_3936 = A) in
                        (
                            {5094}if v_4482 then
                            (
                                {5095}let pkCli_4483: bitstring = pub(skA) in
                                {5096}let v_4484: bool = (Sess_3938 = A) in
                                (
                                    {5097}if v_4484 then
                                    (
                                        {5098}let pkSess_4485: bitstring = pub(skA) in
                                        {5099}in(c, =GetEndpointRequest);
                                        {5100}new SP_4486: bitstring;
                                        {5101}new UP_4487: bitstring;
                                        {5102}out(c, (GetEndpointResponse,pkSess_4485,None,SP_4486,UP_4487))
                                    )
                                    else
                                        {5103}let v_4488: bool = (Sess_3938 = B) in
                                        (
                                            {5104}if v_4488 then
                                            (
                                                {5105}let pkSess_4489: bitstring = pub(skB) in
                                                {5106}in(c, =GetEndpointRequest);
                                                {5107}new SP_4490: bitstring;
                                                {5108}new UP_4491: bitstring;
                                                {5109}out(c, (GetEndpointResponse,pkSess_4489,None,SP_4490,UP_4491))
                                            )
                                            else
                                                {5110}let v_4492: bool = (Sess_3938 = C) in
                                                (
                                                    {5111}if v_4492 then
                                                    (
                                                        {5112}let pkSess_4493: bitstring = pub(skC) in
                                                        {5113}in(c, =GetEndpointRequest);
                                                        {5114}new SP_4494: bitstring;
                                                        {5115}new UP_4495: bitstring;
                                                        {5116}out(c, (GetEndpointResponse,pkSess_4493,None,SP_4494,UP_4495))
                                                    )
                                                    else
                                                        {5117}let pkSess_4496: bitstring = pub(sk(Sess_3938)) in
                                                        {5118}in(c, =GetEndpointRequest);
                                                        {5119}new SP_4497: bitstring;
                                                        {5120}new UP_4498: bitstring;
                                                        {5121}out(c, (GetEndpointResponse,pkSess_4496,None,SP_4497,UP_4498))
                                                )
                                                else
                                                    {5122}let pkSess_4499: bitstring = fail-any in
                                                    {5123}in(c, =GetEndpointRequest);
                                                    {5124}new SP_4500: bitstring;
                                                    {5125}new UP_4501: bitstring;
                                                    {5126}out(c, (GetEndpointResponse,pkSess_4499,None,SP_4500,UP_4501))
                                        )
                                        else
                                            {5127}let pkSess_4502: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SP_4503: bitstring;
                                            {5130}new UP_4504: bitstring;
                                            {5131}out(c, (GetEndpointResponse,pkSess_4502,None,SP_4503,UP_4504))
                                )
                                else
                                    {5132}let pkSess_4505: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SP_4506: bitstring;
                                    {5135}new UP_4507: bitstring;
                                    {5136}out(c, (GetEndpointResponse,pkSess_4505,None,SP_4506,UP_4507))
                            )
                            else
                                {5137}let v_4508: bool = (Cli_3936 = B) in
                                (
                                    {5138}if v_4508 then
                                    (
                                        {5139}let pkCli_4509: bitstring = pub(skB) in
                                        {5140}let v_4510: bool = (Sess_3938 = A) in
                                        (
                                            {5141}if v_4510 then
                                            (
                                                {5142}let pkSess_4511: bitstring = pub(skA) in
                                                {5143}in(c, =GetEndpointRequest);
                                                {5144}new SP_4512: bitstring;
                                                {5145}new UP_4513: bitstring;
                                                {5146}out(c, (GetEndpointResponse,pkSess_4511,None,SP_4512,UP_4513))
                                            )
                                            else
                                                {5147}let v_4514: bool = (Sess_3938 = B) in
                                                (
                                                    {5148}if v_4514 then
                                                    (
                                                        {5149}let pkSess_4515: bitstring = pub(skB) in
                                                        {5150}in(c, =GetEndpointRequest);
                                                        {5151}new SP_4516: bitstring;
                                                        {5152}new UP_4517: bitstring;
                                                        {5153}out(c, (GetEndpointResponse,pkSess_4515,None,SP_4516,UP_4517))
                                                    )
                                                    else
                                                        {5154}let v_4518: bool = (Sess_3938 = C) in
                                                        (
                                                            {5155}if v_4518 then
                                                            (
                                                                {5156}let pkSess_4519: bitstring = pub(skC) in
                                                                {5157}in(c, =GetEndpointRequest);
                                                                {5158}new SP_4520: bitstring;
                                                                {5159}new UP_4521: bitstring;
                                                                {5160}out(c, (GetEndpointResponse,pkSess_4519,None,SP_4520,UP_4521))
                                                            )
                                                            else
                                                                {5161}let pkSess_4522: bitstring = pub(sk(Sess_3938)) in
                                                                {5162}in(c, =GetEndpointRequest);
                                                                {5163}new SP_4523: bitstring;
                                                                {5164}new UP_4524: bitstring;
                                                                {5165}out(c, (GetEndpointResponse,pkSess_4522,None,SP_4523,UP_4524))
                                                        )
                                                        else
                                                            {5166}let pkSess_4525: bitstring = fail-any in
                                                            {5167}in(c, =GetEndpointRequest);
                                                            {5168}new SP_4526: bitstring;
                                                            {5169}new UP_4527: bitstring;
                                                            {5170}out(c, (GetEndpointResponse,pkSess_4525,None,SP_4526,UP_4527))
                                                )
                                                else
                                                    {5171}let pkSess_4528: bitstring = fail-any in
                                                    {5172}in(c, =GetEndpointRequest);
                                                    {5173}new SP_4529: bitstring;
                                                    {5174}new UP_4530: bitstring;
                                                    {5175}out(c, (GetEndpointResponse,pkSess_4528,None,SP_4529,UP_4530))
                                        )
                                        else
                                            {5176}let pkSess_4531: bitstring = fail-any in
                                            {5177}in(c, =GetEndpointRequest);
                                            {5178}new SP_4532: bitstring;
                                            {5179}new UP_4533: bitstring;
                                            {5180}out(c, (GetEndpointResponse,pkSess_4531,None,SP_4532,UP_4533))
                                    )
                                    else
                                        {5181}let v_4534: bool = (Cli_3936 = C) in
                                        (
                                            {5182}if v_4534 then
                                            (
                                                {5183}let pkCli_4535: bitstring = pub(skC) in
                                                {5184}let v_4536: bool = (Sess_3938 = A) in
                                                (
                                                    {5185}if v_4536 then
                                                    (
                                                        {5186}let pkSess_4537: bitstring = pub(skA) in
                                                        {5187}in(c, =GetEndpointRequest);
                                                        {5188}new SP_4538: bitstring;
                                                        {5189}new UP_4539: bitstring;
                                                        {5190}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
                                                    )
                                                    else
                                                        {5191}let v_4540: bool = (Sess_3938 = B) in
                                                        (
                                                            {5192}if v_4540 then
                                                            (
                                                                {5193}let pkSess_4541: bitstring = pub(skB) in
                                                                {5194}in(c, =GetEndpointRequest);
                                                                {5195}new SP_4542: bitstring;
                                                                {5196}new UP_4543: bitstring;
                                                                {5197}out(c, (GetEndpointResponse,pkSess_4541,None,SP_4542,UP_4543))
                                                            )
                                                            else
                                                                {5198}let v_4544: bool = (Sess_3938 = C) in
                                                                (
                                                                    {5199}if v_4544 then
                                                                    (
                                                                        {5200}let pkSess_4545: bitstring = pub(skC) in
                                                                        {5201}in(c, =GetEndpointRequest);
                                                                        {5202}new SP_4546: bitstring;
                                                                        {5203}new UP_4547: bitstring;
                                                                        {5204}out(c, (GetEndpointResponse,pkSess_4545,None,SP_4546,UP_4547))
                                                                    )
                                                                    else
                                                                        {5205}let pkSess_4548: bitstring = pub(sk(Sess_3938)) in
                                                                        {5206}in(c, =GetEndpointRequest);
                                                                        {5207}new SP_4549: bitstring;
                                                                        {5208}new UP_4550: bitstring;
                                                                        {5209}out(c, (GetEndpointResponse,pkSess_4548,None,SP_4549,UP_4550))
                                                                )
                                                                else
                                                                    {5210}let pkSess_4551: bitstring = fail-any in
                                                                    {5211}in(c, =GetEndpointRequest);
                                                                    {5212}new SP_4552: bitstring;
                                                                    {5213}new UP_4553: bitstring;
                                                                    {5214}out(c, (GetEndpointResponse,pkSess_4551,None,SP_4552,UP_4553))
                                                        )
                                                        else
                                                            {5215}let pkSess_4554: bitstring = fail-any in
                                                            {5216}in(c, =GetEndpointRequest);
                                                            {5217}new SP_4555: bitstring;
                                                            {5218}new UP_4556: bitstring;
                                                            {5219}out(c, (GetEndpointResponse,pkSess_4554,None,SP_4555,UP_4556))
                                                )
                                                else
                                                    {5220}let pkSess_4557: bitstring = fail-any in
                                                    {5221}in(c, =GetEndpointRequest);
                                                    {5222}new SP_4558: bitstring;
                                                    {5223}new UP_4559: bitstring;
                                                    {5224}out(c, (GetEndpointResponse,pkSess_4557,None,SP_4558,UP_4559))
                                            )
                                            else
                                                {5225}let pkCli_4560: bitstring = pub(sk(Cli_3936)) in
                                                {5226}let v_4561: bool = (Sess_3938 = A) in
                                                (
                                                    {5227}if v_4561 then
                                                    (
                                                        {5228}let pkSess_4562: bitstring = pub(skA) in
                                                        {5229}in(c, =GetEndpointRequest);
                                                        {5230}new SP_4563: bitstring;
                                                        {5231}new UP_4564: bitstring;
                                                        {5232}out(c, (GetEndpointResponse,pkSess_4562,None,SP_4563,UP_4564))
                                                    )
                                                    else
                                                        {5233}let v_4565: bool = (Sess_3938 = B) in
                                                        (
                                                            {5234}if v_4565 then
                                                            (
                                                                {5235}let pkSess_4566: bitstring = pub(skB) in
                                                                {5236}in(c, =GetEndpointRequest);
                                                                {5237}new SP_4567: bitstring;
                                                                {5238}new UP_4568: bitstring;
                                                                {5239}out(c, (GetEndpointResponse,pkSess_4566,None,SP_4567,UP_4568))
                                                            )
                                                            else
                                                                {5240}let v_4569: bool = (Sess_3938 = C) in
                                                                (
                                                                    {5241}if v_4569 then
                                                                    (
                                                                        {5242}let pkSess_4570: bitstring = pub(skC) in
                                                                        {5243}in(c, =GetEndpointRequest);
                                                                        {5244}new SP_4571: bitstring;
                                                                        {5245}new UP_4572: bitstring;
                                                                        {5246}out(c, (GetEndpointResponse,pkSess_4570,None,SP_4571,UP_4572))
                                                                    )
                                                                    else
                                                                        {5247}let pkSess_4573: bitstring = pub(sk(Sess_3938)) in
                                                                        {5248}in(c, =GetEndpointRequest);
                                                                        {5249}new SP_4574: bitstring;
                                                                        {5250}new UP_4575: bitstring;
                                                                        {5251}out(c, (GetEndpointResponse,pkSess_4573,None,SP_4574,UP_4575))
                                                                )
                                                                else
                                                                    {5252}let pkSess_4576: bitstring = fail-any in
                                                                    {5253}in(c, =GetEndpointRequest);
                                                                    {5254}new SP_4577: bitstring;
                                                                    {5255}new UP_4578: bitstring;
                                                                    {5256}out(c, (GetEndpointResponse,pkSess_4576,None,SP_4577,UP_4578))
                                                        )
                                                        else
                                                            {5257}let pkSess_4579: bitstring = fail-any in
                                                            {5258}in(c, =GetEndpointRequest);
                                                            {5259}new SP_4580: bitstring;
                                                            {5260}new UP_4581: bitstring;
                                                            {5261}out(c, (GetEndpointResponse,pkSess_4579,None,SP_4580,UP_4581))
                                                )
                                                else
                                                    {5262}let pkSess_4582: bitstring = fail-any in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_4583: bitstring;
                                                    {5265}new UP_4584: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_4582,None,SP_4583,UP_4584))
                                        )
                                        else
                                            {5267}let pkCli_4585: bitstring = fail-any in
                                            {5268}let v_4586: bool = (Sess_3938 = A) in
                                            (
                                                {5269}if v_4586 then
                                                (
                                                    {5270}let pkSess_4587: bitstring = pub(skA) in
                                                    {5271}in(c, =GetEndpointRequest);
                                                    {5272}new SP_4588: bitstring;
                                                    {5273}new UP_4589: bitstring;
                                                    {5274}out(c, (GetEndpointResponse,pkSess_4587,None,SP_4588,UP_4589))
                                                )
                                                else
                                                    {5275}let v_4590: bool = (Sess_3938 = B) in
                                                    (
                                                        {5276}if v_4590 then
                                                        (
                                                            {5277}let pkSess_4591: bitstring = pub(skB) in
                                                            {5278}in(c, =GetEndpointRequest);
                                                            {5279}new SP_4592: bitstring;
                                                            {5280}new UP_4593: bitstring;
                                                            {5281}out(c, (GetEndpointResponse,pkSess_4591,None,SP_4592,UP_4593))
                                                        )
                                                        else
                                                            {5282}let v_4594: bool = (Sess_3938 = C) in
                                                            (
                                                                {5283}if v_4594 then
                                                                (
                                                                    {5284}let pkSess_4595: bitstring = pub(skC) in
                                                                    {5285}in(c, =GetEndpointRequest);
                                                                    {5286}new SP_4596: bitstring;
                                                                    {5287}new UP_4597: bitstring;
                                                                    {5288}out(c, (GetEndpointResponse,pkSess_4595,None,SP_4596,UP_4597))
                                                                )
                                                                else
                                                                    {5289}let pkSess_4598: bitstring = pub(sk(Sess_3938)) in
                                                                    {5290}in(c, =GetEndpointRequest);
                                                                    {5291}new SP_4599: bitstring;
                                                                    {5292}new UP_4600: bitstring;
                                                                    {5293}out(c, (GetEndpointResponse,pkSess_4598,None,SP_4599,UP_4600))
                                                            )
                                                            else
                                                                {5294}let pkSess_4601: bitstring = fail-any in
                                                                {5295}in(c, =GetEndpointRequest);
                                                                {5296}new SP_4602: bitstring;
                                                                {5297}new UP_4603: bitstring;
                                                                {5298}out(c, (GetEndpointResponse,pkSess_4601,None,SP_4602,UP_4603))
                                                    )
                                                    else
                                                        {5299}let pkSess_4604: bitstring = fail-any in
                                                        {5300}in(c, =GetEndpointRequest);
                                                        {5301}new SP_4605: bitstring;
                                                        {5302}new UP_4606: bitstring;
                                                        {5303}out(c, (GetEndpointResponse,pkSess_4604,None,SP_4605,UP_4606))
                                            )
                                            else
                                                {5304}let pkSess_4607: bitstring = fail-any in
                                                {5305}in(c, =GetEndpointRequest);
                                                {5306}new SP_4608: bitstring;
                                                {5307}new UP_4609: bitstring;
                                                {5308}out(c, (GetEndpointResponse,pkSess_4607,None,SP_4608,UP_4609))
                                )
                                else
                                    {5309}let pkCli_4610: bitstring = fail-any in
                                    {5310}let v_4611: bool = (Sess_3938 = A) in
                                    (
                                        {5311}if v_4611 then
                                        (
                                            {5312}let pkSess_4612: bitstring = pub(skA) in
                                            {5313}in(c, =GetEndpointRequest);
                                            {5314}new SP_4613: bitstring;
                                            {5315}new UP_4614: bitstring;
                                            {5316}out(c, (GetEndpointResponse,pkSess_4612,None,SP_4613,UP_4614))
                                        )
                                        else
                                            {5317}let v_4615: bool = (Sess_3938 = B) in
                                            (
                                                {5318}if v_4615 then
                                                (
                                                    {5319}let pkSess_4616: bitstring = pub(skB) in
                                                    {5320}in(c, =GetEndpointRequest);
                                                    {5321}new SP_4617: bitstring;
                                                    {5322}new UP_4618: bitstring;
                                                    {5323}out(c, (GetEndpointResponse,pkSess_4616,None,SP_4617,UP_4618))
                                                )
                                                else
                                                    {5324}let v_4619: bool = (Sess_3938 = C) in
                                                    (
                                                        {5325}if v_4619 then
                                                        (
                                                            {5326}let pkSess_4620: bitstring = pub(skC) in
                                                            {5327}in(c, =GetEndpointRequest);
                                                            {5328}new SP_4621: bitstring;
                                                            {5329}new UP_4622: bitstring;
                                                            {5330}out(c, (GetEndpointResponse,pkSess_4620,None,SP_4621,UP_4622))
                                                        )
                                                        else
                                                            {5331}let pkSess_4623: bitstring = pub(sk(Sess_3938)) in
                                                            {5332}in(c, =GetEndpointRequest);
                                                            {5333}new SP_4624: bitstring;
                                                            {5334}new UP_4625: bitstring;
                                                            {5335}out(c, (GetEndpointResponse,pkSess_4623,None,SP_4624,UP_4625))
                                                    )
                                                    else
                                                        {5336}let pkSess_4626: bitstring = fail-any in
                                                        {5337}in(c, =GetEndpointRequest);
                                                        {5338}new SP_4627: bitstring;
                                                        {5339}new UP_4628: bitstring;
                                                        {5340}out(c, (GetEndpointResponse,pkSess_4626,None,SP_4627,UP_4628))
                                            )
                                            else
                                                {5341}let pkSess_4629: bitstring = fail-any in
                                                {5342}in(c, =GetEndpointRequest);
                                                {5343}new SP_4630: bitstring;
                                                {5344}new UP_4631: bitstring;
                                                {5345}out(c, (GetEndpointResponse,pkSess_4629,None,SP_4630,UP_4631))
                                    )
                                    else
                                        {5346}let pkSess_4632: bitstring = fail-any in
                                        {5347}in(c, =GetEndpointRequest);
                                        {5348}new SP_4633: bitstring;
                                        {5349}new UP_4634: bitstring;
                                        {5350}out(c, (GetEndpointResponse,pkSess_4632,None,SP_4633,UP_4634))
                        )
                        else
                            {5351}let pkCli_4635: bitstring = fail-any in
                            {5352}let v_4636: bool = (Sess_3938 = A) in
                            (
                                {5353}if v_4636 then
                                (
                                    {5354}let pkSess_4637: bitstring = pub(skA) in
                                    {5355}in(c, =GetEndpointRequest);
                                    {5356}new SP_4638: bitstring;
                                    {5357}new UP_4639: bitstring;
                                    {5358}out(c, (GetEndpointResponse,pkSess_4637,None,SP_4638,UP_4639))
                                )
                                else
                                    {5359}let v_4640: bool = (Sess_3938 = B) in
                                    (
                                        {5360}if v_4640 then
                                        (
                                            {5361}let pkSess_4641: bitstring = pub(skB) in
                                            {5362}in(c, =GetEndpointRequest);
                                            {5363}new SP_4642: bitstring;
                                            {5364}new UP_4643: bitstring;
                                            {5365}out(c, (GetEndpointResponse,pkSess_4641,None,SP_4642,UP_4643))
                                        )
                                        else
                                            {5366}let v_4644: bool = (Sess_3938 = C) in
                                            (
                                                {5367}if v_4644 then
                                                (
                                                    {5368}let pkSess_4645: bitstring = pub(skC) in
                                                    {5369}in(c, =GetEndpointRequest);
                                                    {5370}new SP_4646: bitstring;
                                                    {5371}new UP_4647: bitstring;
                                                    {5372}out(c, (GetEndpointResponse,pkSess_4645,None,SP_4646,UP_4647))
                                                )
                                                else
                                                    {5373}let pkSess_4648: bitstring = pub(sk(Sess_3938)) in
                                                    {5374}in(c, =GetEndpointRequest);
                                                    {5375}new SP_4649: bitstring;
                                                    {5376}new UP_4650: bitstring;
                                                    {5377}out(c, (GetEndpointResponse,pkSess_4648,None,SP_4649,UP_4650))
                                            )
                                            else
                                                {5378}let pkSess_4651: bitstring = fail-any in
                                                {5379}in(c, =GetEndpointRequest);
                                                {5380}new SP_4652: bitstring;
                                                {5381}new UP_4653: bitstring;
                                                {5382}out(c, (GetEndpointResponse,pkSess_4651,None,SP_4652,UP_4653))
                                    )
                                    else
                                        {5383}let pkSess_4654: bitstring = fail-any in
                                        {5384}in(c, =GetEndpointRequest);
                                        {5385}new SP_4655: bitstring;
                                        {5386}new UP_4656: bitstring;
                                        {5387}out(c, (GetEndpointResponse,pkSess_4654,None,SP_4655,UP_4656))
                            )
                            else
                                {5388}let pkSess_4657: bitstring = fail-any in
                                {5389}in(c, =GetEndpointRequest);
                                {5390}new SP_4658: bitstring;
                                {5391}new UP_4659: bitstring;
                                {5392}out(c, (GetEndpointResponse,pkSess_4657,None,SP_4658,UP_4659))
            )
            else
                {5393}let skDisco_4660: bitstring = fail-any in
                {5394}let pkDisco_4661: bitstring = pub(skDisco_4660) in
                {5395}let v_4662: bool = (Cli_3936 = A) in
                (
                    {5396}if v_4662 then
                    (
                        {5397}let pkCli_4663: bitstring = pub(skA) in
                        {5398}let v_4664: bool = (Sess_3938 = A) in
                        (
                            {5399}if v_4664 then
                            (
                                {5400}let pkSess_4665: bitstring = pub(skA) in
                                {5401}in(c, =GetEndpointRequest);
                                {5402}new SP_4666: bitstring;
                                {5403}new UP_4667: bitstring;
                                {5404}out(c, (GetEndpointResponse,pkSess_4665,None,SP_4666,UP_4667))
                            )
                            else
                                {5405}let v_4668: bool = (Sess_3938 = B) in
                                (
                                    {5406}if v_4668 then
                                    (
                                        {5407}let pkSess_4669: bitstring = pub(skB) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SP_4670: bitstring;
                                        {5410}new UP_4671: bitstring;
                                        {5411}out(c, (GetEndpointResponse,pkSess_4669,None,SP_4670,UP_4671))
                                    )
                                    else
                                        {5412}let v_4672: bool = (Sess_3938 = C) in
                                        (
                                            {5413}if v_4672 then
                                            (
                                                {5414}let pkSess_4673: bitstring = pub(skC) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SP_4674: bitstring;
                                                {5417}new UP_4675: bitstring;
                                                {5418}out(c, (GetEndpointResponse,pkSess_4673,None,SP_4674,UP_4675))
                                            )
                                            else
                                                {5419}let pkSess_4676: bitstring = pub(sk(Sess_3938)) in
                                                {5420}in(c, =GetEndpointRequest);
                                                {5421}new SP_4677: bitstring;
                                                {5422}new UP_4678: bitstring;
                                                {5423}out(c, (GetEndpointResponse,pkSess_4676,None,SP_4677,UP_4678))
                                        )
                                        else
                                            {5424}let pkSess_4679: bitstring = fail-any in
                                            {5425}in(c, =GetEndpointRequest);
                                            {5426}new SP_4680: bitstring;
                                            {5427}new UP_4681: bitstring;
                                            {5428}out(c, (GetEndpointResponse,pkSess_4679,None,SP_4680,UP_4681))
                                )
                                else
                                    {5429}let pkSess_4682: bitstring = fail-any in
                                    {5430}in(c, =GetEndpointRequest);
                                    {5431}new SP_4683: bitstring;
                                    {5432}new UP_4684: bitstring;
                                    {5433}out(c, (GetEndpointResponse,pkSess_4682,None,SP_4683,UP_4684))
                        )
                        else
                            {5434}let pkSess_4685: bitstring = fail-any in
                            {5435}in(c, =GetEndpointRequest);
                            {5436}new SP_4686: bitstring;
                            {5437}new UP_4687: bitstring;
                            {5438}out(c, (GetEndpointResponse,pkSess_4685,None,SP_4686,UP_4687))
                    )
                    else
                        {5439}let v_4688: bool = (Cli_3936 = B) in
                        (
                            {5440}if v_4688 then
                            (
                                {5441}let pkCli_4689: bitstring = pub(skB) in
                                {5442}let v_4690: bool = (Sess_3938 = A) in
                                (
                                    {5443}if v_4690 then
                                    (
                                        {5444}let pkSess_4691: bitstring = pub(skA) in
                                        {5445}in(c, =GetEndpointRequest);
                                        {5446}new SP_4692: bitstring;
                                        {5447}new UP_4693: bitstring;
                                        {5448}out(c, (GetEndpointResponse,pkSess_4691,None,SP_4692,UP_4693))
                                    )
                                    else
                                        {5449}let v_4694: bool = (Sess_3938 = B) in
                                        (
                                            {5450}if v_4694 then
                                            (
                                                {5451}let pkSess_4695: bitstring = pub(skB) in
                                                {5452}in(c, =GetEndpointRequest);
                                                {5453}new SP_4696: bitstring;
                                                {5454}new UP_4697: bitstring;
                                                {5455}out(c, (GetEndpointResponse,pkSess_4695,None,SP_4696,UP_4697))
                                            )
                                            else
                                                {5456}let v_4698: bool = (Sess_3938 = C) in
                                                (
                                                    {5457}if v_4698 then
                                                    (
                                                        {5458}let pkSess_4699: bitstring = pub(skC) in
                                                        {5459}in(c, =GetEndpointRequest);
                                                        {5460}new SP_4700: bitstring;
                                                        {5461}new UP_4701: bitstring;
                                                        {5462}out(c, (GetEndpointResponse,pkSess_4699,None,SP_4700,UP_4701))
                                                    )
                                                    else
                                                        {5463}let pkSess_4702: bitstring = pub(sk(Sess_3938)) in
                                                        {5464}in(c, =GetEndpointRequest);
                                                        {5465}new SP_4703: bitstring;
                                                        {5466}new UP_4704: bitstring;
                                                        {5467}out(c, (GetEndpointResponse,pkSess_4702,None,SP_4703,UP_4704))
                                                )
                                                else
                                                    {5468}let pkSess_4705: bitstring = fail-any in
                                                    {5469}in(c, =GetEndpointRequest);
                                                    {5470}new SP_4706: bitstring;
                                                    {5471}new UP_4707: bitstring;
                                                    {5472}out(c, (GetEndpointResponse,pkSess_4705,None,SP_4706,UP_4707))
                                        )
                                        else
                                            {5473}let pkSess_4708: bitstring = fail-any in
                                            {5474}in(c, =GetEndpointRequest);
                                            {5475}new SP_4709: bitstring;
                                            {5476}new UP_4710: bitstring;
                                            {5477}out(c, (GetEndpointResponse,pkSess_4708,None,SP_4709,UP_4710))
                                )
                                else
                                    {5478}let pkSess_4711: bitstring = fail-any in
                                    {5479}in(c, =GetEndpointRequest);
                                    {5480}new SP_4712: bitstring;
                                    {5481}new UP_4713: bitstring;
                                    {5482}out(c, (GetEndpointResponse,pkSess_4711,None,SP_4712,UP_4713))
                            )
                            else
                                {5483}let v_4714: bool = (Cli_3936 = C) in
                                (
                                    {5484}if v_4714 then
                                    (
                                        {5485}let pkCli_4715: bitstring = pub(skC) in
                                        {5486}let v_4716: bool = (Sess_3938 = A) in
                                        (
                                            {5487}if v_4716 then
                                            (
                                                {5488}let pkSess_4717: bitstring = pub(skA) in
                                                {5489}in(c, =GetEndpointRequest);
                                                {5490}new SP_4718: bitstring;
                                                {5491}new UP_4719: bitstring;
                                                {5492}out(c, (GetEndpointResponse,pkSess_4717,None,SP_4718,UP_4719))
                                            )
                                            else
                                                {5493}let v_4720: bool = (Sess_3938 = B) in
                                                (
                                                    {5494}if v_4720 then
                                                    (
                                                        {5495}let pkSess_4721: bitstring = pub(skB) in
                                                        {5496}in(c, =GetEndpointRequest);
                                                        {5497}new SP_4722: bitstring;
                                                        {5498}new UP_4723: bitstring;
                                                        {5499}out(c, (GetEndpointResponse,pkSess_4721,None,SP_4722,UP_4723))
                                                    )
                                                    else
                                                        {5500}let v_4724: bool = (Sess_3938 = C) in
                                                        (
                                                            {5501}if v_4724 then
                                                            (
                                                                {5502}let pkSess_4725: bitstring = pub(skC) in
                                                                {5503}in(c, =GetEndpointRequest);
                                                                {5504}new SP_4726: bitstring;
                                                                {5505}new UP_4727: bitstring;
                                                                {5506}out(c, (GetEndpointResponse,pkSess_4725,None,SP_4726,UP_4727))
                                                            )
                                                            else
                                                                {5507}let pkSess_4728: bitstring = pub(sk(Sess_3938)) in
                                                                {5508}in(c, =GetEndpointRequest);
                                                                {5509}new SP_4729: bitstring;
                                                                {5510}new UP_4730: bitstring;
                                                                {5511}out(c, (GetEndpointResponse,pkSess_4728,None,SP_4729,UP_4730))
                                                        )
                                                        else
                                                            {5512}let pkSess_4731: bitstring = fail-any in
                                                            {5513}in(c, =GetEndpointRequest);
                                                            {5514}new SP_4732: bitstring;
                                                            {5515}new UP_4733: bitstring;
                                                            {5516}out(c, (GetEndpointResponse,pkSess_4731,None,SP_4732,UP_4733))
                                                )
                                                else
                                                    {5517}let pkSess_4734: bitstring = fail-any in
                                                    {5518}in(c, =GetEndpointRequest);
                                                    {5519}new SP_4735: bitstring;
                                                    {5520}new UP_4736: bitstring;
                                                    {5521}out(c, (GetEndpointResponse,pkSess_4734,None,SP_4735,UP_4736))
                                        )
                                        else
                                            {5522}let pkSess_4737: bitstring = fail-any in
                                            {5523}in(c, =GetEndpointRequest);
                                            {5524}new SP_4738: bitstring;
                                            {5525}new UP_4739: bitstring;
                                            {5526}out(c, (GetEndpointResponse,pkSess_4737,None,SP_4738,UP_4739))
                                    )
                                    else
                                        {5527}let pkCli_4740: bitstring = pub(sk(Cli_3936)) in
                                        {5528}let v_4741: bool = (Sess_3938 = A) in
                                        (
                                            {5529}if v_4741 then
                                            (
                                                {5530}let pkSess_4742: bitstring = pub(skA) in
                                                {5531}in(c, =GetEndpointRequest);
                                                {5532}new SP_4743: bitstring;
                                                {5533}new UP_4744: bitstring;
                                                {5534}out(c, (GetEndpointResponse,pkSess_4742,None,SP_4743,UP_4744))
                                            )
                                            else
                                                {5535}let v_4745: bool = (Sess_3938 = B) in
                                                (
                                                    {5536}if v_4745 then
                                                    (
                                                        {5537}let pkSess_4746: bitstring = pub(skB) in
                                                        {5538}in(c, =GetEndpointRequest);
                                                        {5539}new SP_4747: bitstring;
                                                        {5540}new UP_4748: bitstring;
                                                        {5541}out(c, (GetEndpointResponse,pkSess_4746,None,SP_4747,UP_4748))
                                                    )
                                                    else
                                                        {5542}let v_4749: bool = (Sess_3938 = C) in
                                                        (
                                                            {5543}if v_4749 then
                                                            (
                                                                {5544}let pkSess_4750: bitstring = pub(skC) in
                                                                {5545}in(c, =GetEndpointRequest);
                                                                {5546}new SP_4751: bitstring;
                                                                {5547}new UP_4752: bitstring;
                                                                {5548}out(c, (GetEndpointResponse,pkSess_4750,None,SP_4751,UP_4752))
                                                            )
                                                            else
                                                                {5549}let pkSess_4753: bitstring = pub(sk(Sess_3938)) in
                                                                {5550}in(c, =GetEndpointRequest);
                                                                {5551}new SP_4754: bitstring;
                                                                {5552}new UP_4755: bitstring;
                                                                {5553}out(c, (GetEndpointResponse,pkSess_4753,None,SP_4754,UP_4755))
                                                        )
                                                        else
                                                            {5554}let pkSess_4756: bitstring = fail-any in
                                                            {5555}in(c, =GetEndpointRequest);
                                                            {5556}new SP_4757: bitstring;
                                                            {5557}new UP_4758: bitstring;
                                                            {5558}out(c, (GetEndpointResponse,pkSess_4756,None,SP_4757,UP_4758))
                                                )
                                                else
                                                    {5559}let pkSess_4759: bitstring = fail-any in
                                                    {5560}in(c, =GetEndpointRequest);
                                                    {5561}new SP_4760: bitstring;
                                                    {5562}new UP_4761: bitstring;
                                                    {5563}out(c, (GetEndpointResponse,pkSess_4759,None,SP_4760,UP_4761))
                                        )
                                        else
                                            {5564}let pkSess_4762: bitstring = fail-any in
                                            {5565}in(c, =GetEndpointRequest);
                                            {5566}new SP_4763: bitstring;
                                            {5567}new UP_4764: bitstring;
                                            {5568}out(c, (GetEndpointResponse,pkSess_4762,None,SP_4763,UP_4764))
                                )
                                else
                                    {5569}let pkCli_4765: bitstring = fail-any in
                                    {5570}let v_4766: bool = (Sess_3938 = A) in
                                    (
                                        {5571}if v_4766 then
                                        (
                                            {5572}let pkSess_4767: bitstring = pub(skA) in
                                            {5573}in(c, =GetEndpointRequest);
                                            {5574}new SP_4768: bitstring;
                                            {5575}new UP_4769: bitstring;
                                            {5576}out(c, (GetEndpointResponse,pkSess_4767,None,SP_4768,UP_4769))
                                        )
                                        else
                                            {5577}let v_4770: bool = (Sess_3938 = B) in
                                            (
                                                {5578}if v_4770 then
                                                (
                                                    {5579}let pkSess_4771: bitstring = pub(skB) in
                                                    {5580}in(c, =GetEndpointRequest);
                                                    {5581}new SP_4772: bitstring;
                                                    {5582}new UP_4773: bitstring;
                                                    {5583}out(c, (GetEndpointResponse,pkSess_4771,None,SP_4772,UP_4773))
                                                )
                                                else
                                                    {5584}let v_4774: bool = (Sess_3938 = C) in
                                                    (
                                                        {5585}if v_4774 then
                                                        (
                                                            {5586}let pkSess_4775: bitstring = pub(skC) in
                                                            {5587}in(c, =GetEndpointRequest);
                                                            {5588}new SP_4776: bitstring;
                                                            {5589}new UP_4777: bitstring;
                                                            {5590}out(c, (GetEndpointResponse,pkSess_4775,None,SP_4776,UP_4777))
                                                        )
                                                        else
                                                            {5591}let pkSess_4778: bitstring = pub(sk(Sess_3938)) in
                                                            {5592}in(c, =GetEndpointRequest);
                                                            {5593}new SP_4779: bitstring;
                                                            {5594}new UP_4780: bitstring;
                                                            {5595}out(c, (GetEndpointResponse,pkSess_4778,None,SP_4779,UP_4780))
                                                    )
                                                    else
                                                        {5596}let pkSess_4781: bitstring = fail-any in
                                                        {5597}in(c, =GetEndpointRequest);
                                                        {5598}new SP_4782: bitstring;
                                                        {5599}new UP_4783: bitstring;
                                                        {5600}out(c, (GetEndpointResponse,pkSess_4781,None,SP_4782,UP_4783))
                                            )
                                            else
                                                {5601}let pkSess_4784: bitstring = fail-any in
                                                {5602}in(c, =GetEndpointRequest);
                                                {5603}new SP_4785: bitstring;
                                                {5604}new UP_4786: bitstring;
                                                {5605}out(c, (GetEndpointResponse,pkSess_4784,None,SP_4785,UP_4786))
                                    )
                                    else
                                        {5606}let pkSess_4787: bitstring = fail-any in
                                        {5607}in(c, =GetEndpointRequest);
                                        {5608}new SP_4788: bitstring;
                                        {5609}new UP_4789: bitstring;
                                        {5610}out(c, (GetEndpointResponse,pkSess_4787,None,SP_4788,UP_4789))
                        )
                        else
                            {5611}let pkCli_4790: bitstring = fail-any in
                            {5612}let v_4791: bool = (Sess_3938 = A) in
                            (
                                {5613}if v_4791 then
                                (
                                    {5614}let pkSess_4792: bitstring = pub(skA) in
                                    {5615}in(c, =GetEndpointRequest);
                                    {5616}new SP_4793: bitstring;
                                    {5617}new UP_4794: bitstring;
                                    {5618}out(c, (GetEndpointResponse,pkSess_4792,None,SP_4793,UP_4794))
                                )
                                else
                                    {5619}let v_4795: bool = (Sess_3938 = B) in
                                    (
                                        {5620}if v_4795 then
                                        (
                                            {5621}let pkSess_4796: bitstring = pub(skB) in
                                            {5622}in(c, =GetEndpointRequest);
                                            {5623}new SP_4797: bitstring;
                                            {5624}new UP_4798: bitstring;
                                            {5625}out(c, (GetEndpointResponse,pkSess_4796,None,SP_4797,UP_4798))
                                        )
                                        else
                                            {5626}let v_4799: bool = (Sess_3938 = C) in
                                            (
                                                {5627}if v_4799 then
                                                (
                                                    {5628}let pkSess_4800: bitstring = pub(skC) in
                                                    {5629}in(c, =GetEndpointRequest);
                                                    {5630}new SP_4801: bitstring;
                                                    {5631}new UP_4802: bitstring;
                                                    {5632}out(c, (GetEndpointResponse,pkSess_4800,None,SP_4801,UP_4802))
                                                )
                                                else
                                                    {5633}let pkSess_4803: bitstring = pub(sk(Sess_3938)) in
                                                    {5634}in(c, =GetEndpointRequest);
                                                    {5635}new SP_4804: bitstring;
                                                    {5636}new UP_4805: bitstring;
                                                    {5637}out(c, (GetEndpointResponse,pkSess_4803,None,SP_4804,UP_4805))
                                            )
                                            else
                                                {5638}let pkSess_4806: bitstring = fail-any in
                                                {5639}in(c, =GetEndpointRequest);
                                                {5640}new SP_4807: bitstring;
                                                {5641}new UP_4808: bitstring;
                                                {5642}out(c, (GetEndpointResponse,pkSess_4806,None,SP_4807,UP_4808))
                                    )
                                    else
                                        {5643}let pkSess_4809: bitstring = fail-any in
                                        {5644}in(c, =GetEndpointRequest);
                                        {5645}new SP_4810: bitstring;
                                        {5646}new UP_4811: bitstring;
                                        {5647}out(c, (GetEndpointResponse,pkSess_4809,None,SP_4810,UP_4811))
                            )
                            else
                                {5648}let pkSess_4812: bitstring = fail-any in
                                {5649}in(c, =GetEndpointRequest);
                                {5650}new SP_4813: bitstring;
                                {5651}new UP_4814: bitstring;
                                {5652}out(c, (GetEndpointResponse,pkSess_4812,None,SP_4813,UP_4814))
                )
                else
                    {5653}let pkCli_4815: bitstring = fail-any in
                    {5654}let v_4816: bool = (Sess_3938 = A) in
                    (
                        {5655}if v_4816 then
                        (
                            {5656}let pkSess_4817: bitstring = pub(skA) in
                            {5657}in(c, =GetEndpointRequest);
                            {5658}new SP_4818: bitstring;
                            {5659}new UP_4819: bitstring;
                            {5660}out(c, (GetEndpointResponse,pkSess_4817,None,SP_4818,UP_4819))
                        )
                        else
                            {5661}let v_4820: bool = (Sess_3938 = B) in
                            (
                                {5662}if v_4820 then
                                (
                                    {5663}let pkSess_4821: bitstring = pub(skB) in
                                    {5664}in(c, =GetEndpointRequest);
                                    {5665}new SP_4822: bitstring;
                                    {5666}new UP_4823: bitstring;
                                    {5667}out(c, (GetEndpointResponse,pkSess_4821,None,SP_4822,UP_4823))
                                )
                                else
                                    {5668}let v_4824: bool = (Sess_3938 = C) in
                                    (
                                        {5669}if v_4824 then
                                        (
                                            {5670}let pkSess_4825: bitstring = pub(skC) in
                                            {5671}in(c, =GetEndpointRequest);
                                            {5672}new SP_4826: bitstring;
                                            {5673}new UP_4827: bitstring;
                                            {5674}out(c, (GetEndpointResponse,pkSess_4825,None,SP_4826,UP_4827))
                                        )
                                        else
                                            {5675}let pkSess_4828: bitstring = pub(sk(Sess_3938)) in
                                            {5676}in(c, =GetEndpointRequest);
                                            {5677}new SP_4829: bitstring;
                                            {5678}new UP_4830: bitstring;
                                            {5679}out(c, (GetEndpointResponse,pkSess_4828,None,SP_4829,UP_4830))
                                    )
                                    else
                                        {5680}let pkSess_4831: bitstring = fail-any in
                                        {5681}in(c, =GetEndpointRequest);
                                        {5682}new SP_4832: bitstring;
                                        {5683}new UP_4833: bitstring;
                                        {5684}out(c, (GetEndpointResponse,pkSess_4831,None,SP_4832,UP_4833))
                            )
                            else
                                {5685}let pkSess_4834: bitstring = fail-any in
                                {5686}in(c, =GetEndpointRequest);
                                {5687}new SP_4835: bitstring;
                                {5688}new UP_4836: bitstring;
                                {5689}out(c, (GetEndpointResponse,pkSess_4834,None,SP_4835,UP_4836))
                    )
                    else
                        {5690}let pkSess_4837: bitstring = fail-any in
                        {5691}in(c, =GetEndpointRequest);
                        {5692}new SP_4838: bitstring;
                        {5693}new UP_4839: bitstring;
                        {5694}out(c, (GetEndpointResponse,pkSess_4837,None,SP_4838,UP_4839))
    )
    else
        {5695}let skDisco_4840: bitstring = fail-any in
        {5696}let pkDisco_4841: bitstring = pub(skDisco_4840) in
        {5697}let v_4842: bool = (Cli_3936 = A) in
        (
            {5698}if v_4842 then
            (
                {5699}let pkCli_4843: bitstring = pub(skA) in
                {5700}let v_4844: bool = (Sess_3938 = A) in
                (
                    {5701}if v_4844 then
                    (
                        {5702}let pkSess_4845: bitstring = pub(skA) in
                        {5703}in(c, =GetEndpointRequest);
                        {5704}new SP_4846: bitstring;
                        {5705}new UP_4847: bitstring;
                        {5706}out(c, (GetEndpointResponse,pkSess_4845,None,SP_4846,UP_4847))
                    )
                    else
                        {5707}let v_4848: bool = (Sess_3938 = B) in
                        (
                            {5708}if v_4848 then
                            (
                                {5709}let pkSess_4849: bitstring = pub(skB) in
                                {5710}in(c, =GetEndpointRequest);
                                {5711}new SP_4850: bitstring;
                                {5712}new UP_4851: bitstring;
                                {5713}out(c, (GetEndpointResponse,pkSess_4849,None,SP_4850,UP_4851))
                            )
                            else
                                {5714}let v_4852: bool = (Sess_3938 = C) in
                                (
                                    {5715}if v_4852 then
                                    (
                                        {5716}let pkSess_4853: bitstring = pub(skC) in
                                        {5717}in(c, =GetEndpointRequest);
                                        {5718}new SP_4854: bitstring;
                                        {5719}new UP_4855: bitstring;
                                        {5720}out(c, (GetEndpointResponse,pkSess_4853,None,SP_4854,UP_4855))
                                    )
                                    else
                                        {5721}let pkSess_4856: bitstring = pub(sk(Sess_3938)) in
                                        {5722}in(c, =GetEndpointRequest);
                                        {5723}new SP_4857: bitstring;
                                        {5724}new UP_4858: bitstring;
                                        {5725}out(c, (GetEndpointResponse,pkSess_4856,None,SP_4857,UP_4858))
                                )
                                else
                                    {5726}let pkSess_4859: bitstring = fail-any in
                                    {5727}in(c, =GetEndpointRequest);
                                    {5728}new SP_4860: bitstring;
                                    {5729}new UP_4861: bitstring;
                                    {5730}out(c, (GetEndpointResponse,pkSess_4859,None,SP_4860,UP_4861))
                        )
                        else
                            {5731}let pkSess_4862: bitstring = fail-any in
                            {5732}in(c, =GetEndpointRequest);
                            {5733}new SP_4863: bitstring;
                            {5734}new UP_4864: bitstring;
                            {5735}out(c, (GetEndpointResponse,pkSess_4862,None,SP_4863,UP_4864))
                )
                else
                    {5736}let pkSess_4865: bitstring = fail-any in
                    {5737}in(c, =GetEndpointRequest);
                    {5738}new SP_4866: bitstring;
                    {5739}new UP_4867: bitstring;
                    {5740}out(c, (GetEndpointResponse,pkSess_4865,None,SP_4866,UP_4867))
            )
            else
                {5741}let v_4868: bool = (Cli_3936 = B) in
                (
                    {5742}if v_4868 then
                    (
                        {5743}let pkCli_4869: bitstring = pub(skB) in
                        {5744}let v_4870: bool = (Sess_3938 = A) in
                        (
                            {5745}if v_4870 then
                            (
                                {5746}let pkSess_4871: bitstring = pub(skA) in
                                {5747}in(c, =GetEndpointRequest);
                                {5748}new SP_4872: bitstring;
                                {5749}new UP_4873: bitstring;
                                {5750}out(c, (GetEndpointResponse,pkSess_4871,None,SP_4872,UP_4873))
                            )
                            else
                                {5751}let v_4874: bool = (Sess_3938 = B) in
                                (
                                    {5752}if v_4874 then
                                    (
                                        {5753}let pkSess_4875: bitstring = pub(skB) in
                                        {5754}in(c, =GetEndpointRequest);
                                        {5755}new SP_4876: bitstring;
                                        {5756}new UP_4877: bitstring;
                                        {5757}out(c, (GetEndpointResponse,pkSess_4875,None,SP_4876,UP_4877))
                                    )
                                    else
                                        {5758}let v_4878: bool = (Sess_3938 = C) in
                                        (
                                            {5759}if v_4878 then
                                            (
                                                {5760}let pkSess_4879: bitstring = pub(skC) in
                                                {5761}in(c, =GetEndpointRequest);
                                                {5762}new SP_4880: bitstring;
                                                {5763}new UP_4881: bitstring;
                                                {5764}out(c, (GetEndpointResponse,pkSess_4879,None,SP_4880,UP_4881))
                                            )
                                            else
                                                {5765}let pkSess_4882: bitstring = pub(sk(Sess_3938)) in
                                                {5766}in(c, =GetEndpointRequest);
                                                {5767}new SP_4883: bitstring;
                                                {5768}new UP_4884: bitstring;
                                                {5769}out(c, (GetEndpointResponse,pkSess_4882,None,SP_4883,UP_4884))
                                        )
                                        else
                                            {5770}let pkSess_4885: bitstring = fail-any in
                                            {5771}in(c, =GetEndpointRequest);
                                            {5772}new SP_4886: bitstring;
                                            {5773}new UP_4887: bitstring;
                                            {5774}out(c, (GetEndpointResponse,pkSess_4885,None,SP_4886,UP_4887))
                                )
                                else
                                    {5775}let pkSess_4888: bitstring = fail-any in
                                    {5776}in(c, =GetEndpointRequest);
                                    {5777}new SP_4889: bitstring;
                                    {5778}new UP_4890: bitstring;
                                    {5779}out(c, (GetEndpointResponse,pkSess_4888,None,SP_4889,UP_4890))
                        )
                        else
                            {5780}let pkSess_4891: bitstring = fail-any in
                            {5781}in(c, =GetEndpointRequest);
                            {5782}new SP_4892: bitstring;
                            {5783}new UP_4893: bitstring;
                            {5784}out(c, (GetEndpointResponse,pkSess_4891,None,SP_4892,UP_4893))
                    )
                    else
                        {5785}let v_4894: bool = (Cli_3936 = C) in
                        (
                            {5786}if v_4894 then
                            (
                                {5787}let pkCli_4895: bitstring = pub(skC) in
                                {5788}let v_4896: bool = (Sess_3938 = A) in
                                (
                                    {5789}if v_4896 then
                                    (
                                        {5790}let pkSess_4897: bitstring = pub(skA) in
                                        {5791}in(c, =GetEndpointRequest);
                                        {5792}new SP_4898: bitstring;
                                        {5793}new UP_4899: bitstring;
                                        {5794}out(c, (GetEndpointResponse,pkSess_4897,None,SP_4898,UP_4899))
                                    )
                                    else
                                        {5795}let v_4900: bool = (Sess_3938 = B) in
                                        (
                                            {5796}if v_4900 then
                                            (
                                                {5797}let pkSess_4901: bitstring = pub(skB) in
                                                {5798}in(c, =GetEndpointRequest);
                                                {5799}new SP_4902: bitstring;
                                                {5800}new UP_4903: bitstring;
                                                {5801}out(c, (GetEndpointResponse,pkSess_4901,None,SP_4902,UP_4903))
                                            )
                                            else
                                                {5802}let v_4904: bool = (Sess_3938 = C) in
                                                (
                                                    {5803}if v_4904 then
                                                    (
                                                        {5804}let pkSess_4905: bitstring = pub(skC) in
                                                        {5805}in(c, =GetEndpointRequest);
                                                        {5806}new SP_4906: bitstring;
                                                        {5807}new UP_4907: bitstring;
                                                        {5808}out(c, (GetEndpointResponse,pkSess_4905,None,SP_4906,UP_4907))
                                                    )
                                                    else
                                                        {5809}let pkSess_4908: bitstring = pub(sk(Sess_3938)) in
                                                        {5810}in(c, =GetEndpointRequest);
                                                        {5811}new SP_4909: bitstring;
                                                        {5812}new UP_4910: bitstring;
                                                        {5813}out(c, (GetEndpointResponse,pkSess_4908,None,SP_4909,UP_4910))
                                                )
                                                else
                                                    {5814}let pkSess_4911: bitstring = fail-any in
                                                    {5815}in(c, =GetEndpointRequest);
                                                    {5816}new SP_4912: bitstring;
                                                    {5817}new UP_4913: bitstring;
                                                    {5818}out(c, (GetEndpointResponse,pkSess_4911,None,SP_4912,UP_4913))
                                        )
                                        else
                                            {5819}let pkSess_4914: bitstring = fail-any in
                                            {5820}in(c, =GetEndpointRequest);
                                            {5821}new SP_4915: bitstring;
                                            {5822}new UP_4916: bitstring;
                                            {5823}out(c, (GetEndpointResponse,pkSess_4914,None,SP_4915,UP_4916))
                                )
                                else
                                    {5824}let pkSess_4917: bitstring = fail-any in
                                    {5825}in(c, =GetEndpointRequest);
                                    {5826}new SP_4918: bitstring;
                                    {5827}new UP_4919: bitstring;
                                    {5828}out(c, (GetEndpointResponse,pkSess_4917,None,SP_4918,UP_4919))
                            )
                            else
                                {5829}let pkCli_4920: bitstring = pub(sk(Cli_3936)) in
                                {5830}let v_4921: bool = (Sess_3938 = A) in
                                (
                                    {5831}if v_4921 then
                                    (
                                        {5832}let pkSess_4922: bitstring = pub(skA) in
                                        {5833}in(c, =GetEndpointRequest);
                                        {5834}new SP_4923: bitstring;
                                        {5835}new UP_4924: bitstring;
                                        {5836}out(c, (GetEndpointResponse,pkSess_4922,None,SP_4923,UP_4924))
                                    )
                                    else
                                        {5837}let v_4925: bool = (Sess_3938 = B) in
                                        (
                                            {5838}if v_4925 then
                                            (
                                                {5839}let pkSess_4926: bitstring = pub(skB) in
                                                {5840}in(c, =GetEndpointRequest);
                                                {5841}new SP_4927: bitstring;
                                                {5842}new UP_4928: bitstring;
                                                {5843}out(c, (GetEndpointResponse,pkSess_4926,None,SP_4927,UP_4928))
                                            )
                                            else
                                                {5844}let v_4929: bool = (Sess_3938 = C) in
                                                (
                                                    {5845}if v_4929 then
                                                    (
                                                        {5846}let pkSess_4930: bitstring = pub(skC) in
                                                        {5847}in(c, =GetEndpointRequest);
                                                        {5848}new SP_4931: bitstring;
                                                        {5849}new UP_4932: bitstring;
                                                        {5850}out(c, (GetEndpointResponse,pkSess_4930,None,SP_4931,UP_4932))
                                                    )
                                                    else
                                                        {5851}let pkSess_4933: bitstring = pub(sk(Sess_3938)) in
                                                        {5852}in(c, =GetEndpointRequest);
                                                        {5853}new SP_4934: bitstring;
                                                        {5854}new UP_4935: bitstring;
                                                        {5855}out(c, (GetEndpointResponse,pkSess_4933,None,SP_4934,UP_4935))
                                                )
                                                else
                                                    {5856}let pkSess_4936: bitstring = fail-any in
                                                    {5857}in(c, =GetEndpointRequest);
                                                    {5858}new SP_4937: bitstring;
                                                    {5859}new UP_4938: bitstring;
                                                    {5860}out(c, (GetEndpointResponse,pkSess_4936,None,SP_4937,UP_4938))
                                        )
                                        else
                                            {5861}let pkSess_4939: bitstring = fail-any in
                                            {5862}in(c, =GetEndpointRequest);
                                            {5863}new SP_4940: bitstring;
                                            {5864}new UP_4941: bitstring;
                                            {5865}out(c, (GetEndpointResponse,pkSess_4939,None,SP_4940,UP_4941))
                                )
                                else
                                    {5866}let pkSess_4942: bitstring = fail-any in
                                    {5867}in(c, =GetEndpointRequest);
                                    {5868}new SP_4943: bitstring;
                                    {5869}new UP_4944: bitstring;
                                    {5870}out(c, (GetEndpointResponse,pkSess_4942,None,SP_4943,UP_4944))
                        )
                        else
                            {5871}let pkCli_4945: bitstring = fail-any in
                            {5872}let v_4946: bool = (Sess_3938 = A) in
                            (
                                {5873}if v_4946 then
                                (
                                    {5874}let pkSess_4947: bitstring = pub(skA) in
                                    {5875}in(c, =GetEndpointRequest);
                                    {5876}new SP_4948: bitstring;
                                    {5877}new UP_4949: bitstring;
                                    {5878}out(c, (GetEndpointResponse,pkSess_4947,None,SP_4948,UP_4949))
                                )
                                else
                                    {5879}let v_4950: bool = (Sess_3938 = B) in
                                    (
                                        {5880}if v_4950 then
                                        (
                                            {5881}let pkSess_4951: bitstring = pub(skB) in
                                            {5882}in(c, =GetEndpointRequest);
                                            {5883}new SP_4952: bitstring;
                                            {5884}new UP_4953: bitstring;
                                            {5885}out(c, (GetEndpointResponse,pkSess_4951,None,SP_4952,UP_4953))
                                        )
                                        else
                                            {5886}let v_4954: bool = (Sess_3938 = C) in
                                            (
                                                {5887}if v_4954 then
                                                (
                                                    {5888}let pkSess_4955: bitstring = pub(skC) in
                                                    {5889}in(c, =GetEndpointRequest);
                                                    {5890}new SP_4956: bitstring;
                                                    {5891}new UP_4957: bitstring;
                                                    {5892}out(c, (GetEndpointResponse,pkSess_4955,None,SP_4956,UP_4957))
                                                )
                                                else
                                                    {5893}let pkSess_4958: bitstring = pub(sk(Sess_3938)) in
                                                    {5894}in(c, =GetEndpointRequest);
                                                    {5895}new SP_4959: bitstring;
                                                    {5896}new UP_4960: bitstring;
                                                    {5897}out(c, (GetEndpointResponse,pkSess_4958,None,SP_4959,UP_4960))
                                            )
                                            else
                                                {5898}let pkSess_4961: bitstring = fail-any in
                                                {5899}in(c, =GetEndpointRequest);
                                                {5900}new SP_4962: bitstring;
                                                {5901}new UP_4963: bitstring;
                                                {5902}out(c, (GetEndpointResponse,pkSess_4961,None,SP_4962,UP_4963))
                                    )
                                    else
                                        {5903}let pkSess_4964: bitstring = fail-any in
                                        {5904}in(c, =GetEndpointRequest);
                                        {5905}new SP_4965: bitstring;
                                        {5906}new UP_4966: bitstring;
                                        {5907}out(c, (GetEndpointResponse,pkSess_4964,None,SP_4965,UP_4966))
                            )
                            else
                                {5908}let pkSess_4967: bitstring = fail-any in
                                {5909}in(c, =GetEndpointRequest);
                                {5910}new SP_4968: bitstring;
                                {5911}new UP_4969: bitstring;
                                {5912}out(c, (GetEndpointResponse,pkSess_4967,None,SP_4968,UP_4969))
                )
                else
                    {5913}let pkCli_4970: bitstring = fail-any in
                    {5914}let v_4971: bool = (Sess_3938 = A) in
                    (
                        {5915}if v_4971 then
                        (
                            {5916}let pkSess_4972: bitstring = pub(skA) in
                            {5917}in(c, =GetEndpointRequest);
                            {5918}new SP_4973: bitstring;
                            {5919}new UP_4974: bitstring;
                            {5920}out(c, (GetEndpointResponse,pkSess_4972,None,SP_4973,UP_4974))
                        )
                        else
                            {5921}let v_4975: bool = (Sess_3938 = B) in
                            (
                                {5922}if v_4975 then
                                (
                                    {5923}let pkSess_4976: bitstring = pub(skB) in
                                    {5924}in(c, =GetEndpointRequest);
                                    {5925}new SP_4977: bitstring;
                                    {5926}new UP_4978: bitstring;
                                    {5927}out(c, (GetEndpointResponse,pkSess_4976,None,SP_4977,UP_4978))
                                )
                                else
                                    {5928}let v_4979: bool = (Sess_3938 = C) in
                                    (
                                        {5929}if v_4979 then
                                        (
                                            {5930}let pkSess_4980: bitstring = pub(skC) in
                                            {5931}in(c, =GetEndpointRequest);
                                            {5932}new SP_4981: bitstring;
                                            {5933}new UP_4982: bitstring;
                                            {5934}out(c, (GetEndpointResponse,pkSess_4980,None,SP_4981,UP_4982))
                                        )
                                        else
                                            {5935}let pkSess_4983: bitstring = pub(sk(Sess_3938)) in
                                            {5936}in(c, =GetEndpointRequest);
                                            {5937}new SP_4984: bitstring;
                                            {5938}new UP_4985: bitstring;
                                            {5939}out(c, (GetEndpointResponse,pkSess_4983,None,SP_4984,UP_4985))
                                    )
                                    else
                                        {5940}let pkSess_4986: bitstring = fail-any in
                                        {5941}in(c, =GetEndpointRequest);
                                        {5942}new SP_4987: bitstring;
                                        {5943}new UP_4988: bitstring;
                                        {5944}out(c, (GetEndpointResponse,pkSess_4986,None,SP_4987,UP_4988))
                            )
                            else
                                {5945}let pkSess_4989: bitstring = fail-any in
                                {5946}in(c, =GetEndpointRequest);
                                {5947}new SP_4990: bitstring;
                                {5948}new UP_4991: bitstring;
                                {5949}out(c, (GetEndpointResponse,pkSess_4989,None,SP_4990,UP_4991))
                    )
                    else
                        {5950}let pkSess_4992: bitstring = fail-any in
                        {5951}in(c, =GetEndpointRequest);
                        {5952}new SP_4993: bitstring;
                        {5953}new UP_4994: bitstring;
                        {5954}out(c, (GetEndpointResponse,pkSess_4992,None,SP_4993,UP_4994))
        )
        else
            {5955}let pkCli_4995: bitstring = fail-any in
            {5956}let v_4996: bool = (Sess_3938 = A) in
            (
                {5957}if v_4996 then
                (
                    {5958}let pkSess_4997: bitstring = pub(skA) in
                    {5959}in(c, =GetEndpointRequest);
                    {5960}new SP_4998: bitstring;
                    {5961}new UP_4999: bitstring;
                    {5962}out(c, (GetEndpointResponse,pkSess_4997,None,SP_4998,UP_4999))
                )
                else
                    {5963}let v_5000: bool = (Sess_3938 = B) in
                    (
                        {5964}if v_5000 then
                        (
                            {5965}let pkSess_5001: bitstring = pub(skB) in
                            {5966}in(c, =GetEndpointRequest);
                            {5967}new SP_5002: bitstring;
                            {5968}new UP_5003: bitstring;
                            {5969}out(c, (GetEndpointResponse,pkSess_5001,None,SP_5002,UP_5003))
                        )
                        else
                            {5970}let v_5004: bool = (Sess_3938 = C) in
                            (
                                {5971}if v_5004 then
                                (
                                    {5972}let pkSess_5005: bitstring = pub(skC) in
                                    {5973}in(c, =GetEndpointRequest);
                                    {5974}new SP_5006: bitstring;
                                    {5975}new UP_5007: bitstring;
                                    {5976}out(c, (GetEndpointResponse,pkSess_5005,None,SP_5006,UP_5007))
                                )
                                else
                                    {5977}let pkSess_5008: bitstring = pub(sk(Sess_3938)) in
                                    {5978}in(c, =GetEndpointRequest);
                                    {5979}new SP_5009: bitstring;
                                    {5980}new UP_5010: bitstring;
                                    {5981}out(c, (GetEndpointResponse,pkSess_5008,None,SP_5009,UP_5010))
                            )
                            else
                                {5982}let pkSess_5011: bitstring = fail-any in
                                {5983}in(c, =GetEndpointRequest);
                                {5984}new SP_5012: bitstring;
                                {5985}new UP_5013: bitstring;
                                {5986}out(c, (GetEndpointResponse,pkSess_5011,None,SP_5012,UP_5013))
                    )
                    else
                        {5987}let pkSess_5014: bitstring = fail-any in
                        {5988}in(c, =GetEndpointRequest);
                        {5989}new SP_5015: bitstring;
                        {5990}new UP_5016: bitstring;
                        {5991}out(c, (GetEndpointResponse,pkSess_5014,None,SP_5015,UP_5016))
            )
            else
                {5992}let pkSess_5017: bitstring = fail-any in
                {5993}in(c, =GetEndpointRequest);
                {5994}new SP_5018: bitstring;
                {5995}new UP_5019: bitstring;
                {5996}out(c, (GetEndpointResponse,pkSess_5017,None,SP_5018,UP_5019))
) | (
    {5997}!
    {5998}in(c, (Cli_5020: host,Disco_5021: host,Sess_5022: host));
    {5999}let v_5023: bool = (Sess_5022 = A) in
    (
        {6000}if v_5023 then
        (
            {6001}let skSess: bitstring = skA in
            {6002}let pkSess_5024: bitstring = pub(skSess) in
            {6003}let v_5025: bool = (Cli_5020 = A) in
            (
                {6004}if v_5025 then
                (
                    {6005}let pkCli_5026: bitstring = pub(skA) in
                    {6006}let v_5027: bool = (Disco_5021 = A) in
                    (
                        {6007}if v_5027 then
                        (
                            {6008}let pkDisco_5028: bitstring = pub(skA) in
                            {6009}in(c, (=pkCli_5026,em1: bitstring));
                            {6010}let m1_5029: bitstring = em1 in
                            {6011}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC: bitstring) = m1_5029 in
                            {6012}new Ns: bitstring;
                            {6013}new ST_5030: bitstring;
                            {6014}new TTL_5031: bitstring;
                            {6015}let gNs: bitstring = exp(g,Ns) in
                            {6016}let m2_5032: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs,ST_5030,TTL_5031) in
                            {6017}event beginSrv(Sess_5022,Cli_5020,gNs);
                            {6018}out(c, m2_5032);
                            {6019}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {6020}event endSrv(Cli_5020,Sess_5022,PartC)
                        )
                        else
                            {6021}let v_5033: bool = (Disco_5021 = B) in
                            (
                                {6022}if v_5033 then
                                (
                                    {6023}let pkDisco_5034: bitstring = pub(skB) in
                                    {6024}in(c, (=pkCli_5026,em1_5035: bitstring));
                                    {6025}let m1_5036: bitstring = em1_5035 in
                                    {6026}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC_5037: bitstring) = m1_5036 in
                                    {6027}new Ns_5038: bitstring;
                                    {6028}new ST_5039: bitstring;
                                    {6029}new TTL_5040: bitstring;
                                    {6030}let gNs_5041: bitstring = exp(g,Ns_5038) in
                                    {6031}let m2_5042: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5041,ST_5039,TTL_5040) in
                                    {6032}event beginSrv(Sess_5022,Cli_5020,gNs_5041);
                                    {6033}out(c, m2_5042);
                                    {6034}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {6035}event endSrv(Cli_5020,Sess_5022,PartC_5037)
                                )
                                else
                                    {6036}let v_5043: bool = (Disco_5021 = C) in
                                    (
                                        {6037}if v_5043 then
                                        (
                                            {6038}let pkDisco_5044: bitstring = pub(skC) in
                                            {6039}in(c, (=pkCli_5026,em1_5045: bitstring));
                                            {6040}let m1_5046: bitstring = em1_5045 in
                                            {6041}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC_5047: bitstring) = m1_5046 in
                                            {6042}new Ns_5048: bitstring;
                                            {6043}new ST_5049: bitstring;
                                            {6044}new TTL_5050: bitstring;
                                            {6045}let gNs_5051: bitstring = exp(g,Ns_5048) in
                                            {6046}let m2_5052: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5051,ST_5049,TTL_5050) in
                                            {6047}event beginSrv(Sess_5022,Cli_5020,gNs_5051);
                                            {6048}out(c, m2_5052);
                                            {6049}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6050}event endSrv(Cli_5020,Sess_5022,PartC_5047)
                                        )
                                        else
                                            {6051}let pkDisco_5053: bitstring = pub(sk(Disco_5021)) in
                                            {6052}in(c, (=pkCli_5026,em1_5054: bitstring));
                                            {6053}let m1_5055: bitstring = em1_5054 in
                                            {6054}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC_5056: bitstring) = m1_5055 in
                                            {6055}new Ns_5057: bitstring;
                                            {6056}new ST_5058: bitstring;
                                            {6057}new TTL_5059: bitstring;
                                            {6058}let gNs_5060: bitstring = exp(g,Ns_5057) in
                                            {6059}let m2_5061: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5060,ST_5058,TTL_5059) in
                                            {6060}event beginSrv(Sess_5022,Cli_5020,gNs_5060);
                                            {6061}out(c, m2_5061);
                                            {6062}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6063}event endSrv(Cli_5020,Sess_5022,PartC_5056)
                                    )
                                    else
                                        {6064}let pkDisco_5062: bitstring = fail-any in
                                        {6065}in(c, (=pkCli_5026,em1_5063: bitstring));
                                        {6066}let m1_5064: bitstring = em1_5063 in
                                        {6067}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC_5065: bitstring) = m1_5064 in
                                        {6068}new Ns_5066: bitstring;
                                        {6069}new ST_5067: bitstring;
                                        {6070}new TTL_5068: bitstring;
                                        {6071}let gNs_5069: bitstring = exp(g,Ns_5066) in
                                        {6072}let m2_5070: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5069,ST_5067,TTL_5068) in
                                        {6073}event beginSrv(Sess_5022,Cli_5020,gNs_5069);
                                        {6074}out(c, m2_5070);
                                        {6075}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6076}event endSrv(Cli_5020,Sess_5022,PartC_5065)
                            )
                            else
                                {6077}let pkDisco_5071: bitstring = fail-any in
                                {6078}in(c, (=pkCli_5026,em1_5072: bitstring));
                                {6079}let m1_5073: bitstring = em1_5072 in
                                {6080}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC_5074: bitstring) = m1_5073 in
                                {6081}new Ns_5075: bitstring;
                                {6082}new ST_5076: bitstring;
                                {6083}new TTL_5077: bitstring;
                                {6084}let gNs_5078: bitstring = exp(g,Ns_5075) in
                                {6085}let m2_5079: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5078,ST_5076,TTL_5077) in
                                {6086}event beginSrv(Sess_5022,Cli_5020,gNs_5078);
                                {6087}out(c, m2_5079);
                                {6088}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {6089}event endSrv(Cli_5020,Sess_5022,PartC_5074)
                    )
                    else
                        {6090}let pkDisco_5080: bitstring = fail-any in
                        {6091}in(c, (=pkCli_5026,em1_5081: bitstring));
                        {6092}let m1_5082: bitstring = em1_5081 in
                        {6093}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5026,PartC_5083: bitstring) = m1_5082 in
                        {6094}new Ns_5084: bitstring;
                        {6095}new ST_5085: bitstring;
                        {6096}new TTL_5086: bitstring;
                        {6097}let gNs_5087: bitstring = exp(g,Ns_5084) in
                        {6098}let m2_5088: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5087,ST_5085,TTL_5086) in
                        {6099}event beginSrv(Sess_5022,Cli_5020,gNs_5087);
                        {6100}out(c, m2_5088);
                        {6101}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                        {6102}event endSrv(Cli_5020,Sess_5022,PartC_5083)
                )
                else
                    {6103}let v_5089: bool = (Cli_5020 = B) in
                    (
                        {6104}if v_5089 then
                        (
                            {6105}let pkCli_5090: bitstring = pub(skB) in
                            {6106}let v_5091: bool = (Disco_5021 = A) in
                            (
                                {6107}if v_5091 then
                                (
                                    {6108}let pkDisco_5092: bitstring = pub(skA) in
                                    {6109}in(c, (=pkCli_5090,em1_5093: bitstring));
                                    {6110}let m1_5094: bitstring = em1_5093 in
                                    {6111}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5095: bitstring) = m1_5094 in
                                    {6112}new Ns_5096: bitstring;
                                    {6113}new ST_5097: bitstring;
                                    {6114}new TTL_5098: bitstring;
                                    {6115}let gNs_5099: bitstring = exp(g,Ns_5096) in
                                    {6116}let m2_5100: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5099,ST_5097,TTL_5098) in
                                    {6117}event beginSrv(Sess_5022,Cli_5020,gNs_5099);
                                    {6118}out(c, m2_5100);
                                    {6119}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {6120}event endSrv(Cli_5020,Sess_5022,PartC_5095)
                                )
                                else
                                    {6121}let v_5101: bool = (Disco_5021 = B) in
                                    (
                                        {6122}if v_5101 then
                                        (
                                            {6123}let pkDisco_5102: bitstring = pub(skB) in
                                            {6124}in(c, (=pkCli_5090,em1_5103: bitstring));
                                            {6125}let m1_5104: bitstring = em1_5103 in
                                            {6126}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5105: bitstring) = m1_5104 in
                                            {6127}new Ns_5106: bitstring;
                                            {6128}new ST_5107: bitstring;
                                            {6129}new TTL_5108: bitstring;
                                            {6130}let gNs_5109: bitstring = exp(g,Ns_5106) in
                                            {6131}let m2_5110: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5109,ST_5107,TTL_5108) in
                                            {6132}event beginSrv(Sess_5022,Cli_5020,gNs_5109);
                                            {6133}out(c, m2_5110);
                                            {6134}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6135}event endSrv(Cli_5020,Sess_5022,PartC_5105)
                                        )
                                        else
                                            {6136}let v_5111: bool = (Disco_5021 = C) in
                                            (
                                                {6137}if v_5111 then
                                                (
                                                    {6138}let pkDisco_5112: bitstring = pub(skC) in
                                                    {6139}in(c, (=pkCli_5090,em1_5113: bitstring));
                                                    {6140}let m1_5114: bitstring = em1_5113 in
                                                    {6141}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5115: bitstring) = m1_5114 in
                                                    {6142}new Ns_5116: bitstring;
                                                    {6143}new ST_5117: bitstring;
                                                    {6144}new TTL_5118: bitstring;
                                                    {6145}let gNs_5119: bitstring = exp(g,Ns_5116) in
                                                    {6146}let m2_5120: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5119,ST_5117,TTL_5118) in
                                                    {6147}event beginSrv(Sess_5022,Cli_5020,gNs_5119);
                                                    {6148}out(c, m2_5120);
                                                    {6149}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6150}event endSrv(Cli_5020,Sess_5022,PartC_5115)
                                                )
                                                else
                                                    {6151}let pkDisco_5121: bitstring = pub(sk(Disco_5021)) in
                                                    {6152}in(c, (=pkCli_5090,em1_5122: bitstring));
                                                    {6153}let m1_5123: bitstring = em1_5122 in
                                                    {6154}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5124: bitstring) = m1_5123 in
                                                    {6155}new Ns_5125: bitstring;
                                                    {6156}new ST_5126: bitstring;
                                                    {6157}new TTL_5127: bitstring;
                                                    {6158}let gNs_5128: bitstring = exp(g,Ns_5125) in
                                                    {6159}let m2_5129: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5128,ST_5126,TTL_5127) in
                                                    {6160}event beginSrv(Sess_5022,Cli_5020,gNs_5128);
                                                    {6161}out(c, m2_5129);
                                                    {6162}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6163}event endSrv(Cli_5020,Sess_5022,PartC_5124)
                                            )
                                            else
                                                {6164}let pkDisco_5130: bitstring = fail-any in
                                                {6165}in(c, (=pkCli_5090,em1_5131: bitstring));
                                                {6166}let m1_5132: bitstring = em1_5131 in
                                                {6167}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5133: bitstring) = m1_5132 in
                                                {6168}new Ns_5134: bitstring;
                                                {6169}new ST_5135: bitstring;
                                                {6170}new TTL_5136: bitstring;
                                                {6171}let gNs_5137: bitstring = exp(g,Ns_5134) in
                                                {6172}let m2_5138: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5137,ST_5135,TTL_5136) in
                                                {6173}event beginSrv(Sess_5022,Cli_5020,gNs_5137);
                                                {6174}out(c, m2_5138);
                                                {6175}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6176}event endSrv(Cli_5020,Sess_5022,PartC_5133)
                                    )
                                    else
                                        {6177}let pkDisco_5139: bitstring = fail-any in
                                        {6178}in(c, (=pkCli_5090,em1_5140: bitstring));
                                        {6179}let m1_5141: bitstring = em1_5140 in
                                        {6180}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5142: bitstring) = m1_5141 in
                                        {6181}new Ns_5143: bitstring;
                                        {6182}new ST_5144: bitstring;
                                        {6183}new TTL_5145: bitstring;
                                        {6184}let gNs_5146: bitstring = exp(g,Ns_5143) in
                                        {6185}let m2_5147: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5146,ST_5144,TTL_5145) in
                                        {6186}event beginSrv(Sess_5022,Cli_5020,gNs_5146);
                                        {6187}out(c, m2_5147);
                                        {6188}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6189}event endSrv(Cli_5020,Sess_5022,PartC_5142)
                            )
                            else
                                {6190}let pkDisco_5148: bitstring = fail-any in
                                {6191}in(c, (=pkCli_5090,em1_5149: bitstring));
                                {6192}let m1_5150: bitstring = em1_5149 in
                                {6193}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5090,PartC_5151: bitstring) = m1_5150 in
                                {6194}new Ns_5152: bitstring;
                                {6195}new ST_5153: bitstring;
                                {6196}new TTL_5154: bitstring;
                                {6197}let gNs_5155: bitstring = exp(g,Ns_5152) in
                                {6198}let m2_5156: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5155,ST_5153,TTL_5154) in
                                {6199}event beginSrv(Sess_5022,Cli_5020,gNs_5155);
                                {6200}out(c, m2_5156);
                                {6201}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {6202}event endSrv(Cli_5020,Sess_5022,PartC_5151)
                        )
                        else
                            {6203}let v_5157: bool = (Cli_5020 = C) in
                            (
                                {6204}if v_5157 then
                                (
                                    {6205}let pkCli_5158: bitstring = pub(skC) in
                                    {6206}let v_5159: bool = (Disco_5021 = A) in
                                    (
                                        {6207}if v_5159 then
                                        (
                                            {6208}let pkDisco_5160: bitstring = pub(skA) in
                                            {6209}in(c, (=pkCli_5158,em1_5161: bitstring));
                                            {6210}let m1_5162: bitstring = em1_5161 in
                                            {6211}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5163: bitstring) = m1_5162 in
                                            {6212}new Ns_5164: bitstring;
                                            {6213}new ST_5165: bitstring;
                                            {6214}new TTL_5166: bitstring;
                                            {6215}let gNs_5167: bitstring = exp(g,Ns_5164) in
                                            {6216}let m2_5168: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5167,ST_5165,TTL_5166) in
                                            {6217}event beginSrv(Sess_5022,Cli_5020,gNs_5167);
                                            {6218}out(c, m2_5168);
                                            {6219}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6220}event endSrv(Cli_5020,Sess_5022,PartC_5163)
                                        )
                                        else
                                            {6221}let v_5169: bool = (Disco_5021 = B) in
                                            (
                                                {6222}if v_5169 then
                                                (
                                                    {6223}let pkDisco_5170: bitstring = pub(skB) in
                                                    {6224}in(c, (=pkCli_5158,em1_5171: bitstring));
                                                    {6225}let m1_5172: bitstring = em1_5171 in
                                                    {6226}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5173: bitstring) = m1_5172 in
                                                    {6227}new Ns_5174: bitstring;
                                                    {6228}new ST_5175: bitstring;
                                                    {6229}new TTL_5176: bitstring;
                                                    {6230}let gNs_5177: bitstring = exp(g,Ns_5174) in
                                                    {6231}let m2_5178: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5177,ST_5175,TTL_5176) in
                                                    {6232}event beginSrv(Sess_5022,Cli_5020,gNs_5177);
                                                    {6233}out(c, m2_5178);
                                                    {6234}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6235}event endSrv(Cli_5020,Sess_5022,PartC_5173)
                                                )
                                                else
                                                    {6236}let v_5179: bool = (Disco_5021 = C) in
                                                    (
                                                        {6237}if v_5179 then
                                                        (
                                                            {6238}let pkDisco_5180: bitstring = pub(skC) in
                                                            {6239}in(c, (=pkCli_5158,em1_5181: bitstring));
                                                            {6240}let m1_5182: bitstring = em1_5181 in
                                                            {6241}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5183: bitstring) = m1_5182 in
                                                            {6242}new Ns_5184: bitstring;
                                                            {6243}new ST_5185: bitstring;
                                                            {6244}new TTL_5186: bitstring;
                                                            {6245}let gNs_5187: bitstring = exp(g,Ns_5184) in
                                                            {6246}let m2_5188: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5187,ST_5185,TTL_5186) in
                                                            {6247}event beginSrv(Sess_5022,Cli_5020,gNs_5187);
                                                            {6248}out(c, m2_5188);
                                                            {6249}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6250}event endSrv(Cli_5020,Sess_5022,PartC_5183)
                                                        )
                                                        else
                                                            {6251}let pkDisco_5189: bitstring = pub(sk(Disco_5021)) in
                                                            {6252}in(c, (=pkCli_5158,em1_5190: bitstring));
                                                            {6253}let m1_5191: bitstring = em1_5190 in
                                                            {6254}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5192: bitstring) = m1_5191 in
                                                            {6255}new Ns_5193: bitstring;
                                                            {6256}new ST_5194: bitstring;
                                                            {6257}new TTL_5195: bitstring;
                                                            {6258}let gNs_5196: bitstring = exp(g,Ns_5193) in
                                                            {6259}let m2_5197: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5196,ST_5194,TTL_5195) in
                                                            {6260}event beginSrv(Sess_5022,Cli_5020,gNs_5196);
                                                            {6261}out(c, m2_5197);
                                                            {6262}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6263}event endSrv(Cli_5020,Sess_5022,PartC_5192)
                                                    )
                                                    else
                                                        {6264}let pkDisco_5198: bitstring = fail-any in
                                                        {6265}in(c, (=pkCli_5158,em1_5199: bitstring));
                                                        {6266}let m1_5200: bitstring = em1_5199 in
                                                        {6267}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5201: bitstring) = m1_5200 in
                                                        {6268}new Ns_5202: bitstring;
                                                        {6269}new ST_5203: bitstring;
                                                        {6270}new TTL_5204: bitstring;
                                                        {6271}let gNs_5205: bitstring = exp(g,Ns_5202) in
                                                        {6272}let m2_5206: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5205,ST_5203,TTL_5204) in
                                                        {6273}event beginSrv(Sess_5022,Cli_5020,gNs_5205);
                                                        {6274}out(c, m2_5206);
                                                        {6275}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {6276}event endSrv(Cli_5020,Sess_5022,PartC_5201)
                                            )
                                            else
                                                {6277}let pkDisco_5207: bitstring = fail-any in
                                                {6278}in(c, (=pkCli_5158,em1_5208: bitstring));
                                                {6279}let m1_5209: bitstring = em1_5208 in
                                                {6280}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5210: bitstring) = m1_5209 in
                                                {6281}new Ns_5211: bitstring;
                                                {6282}new ST_5212: bitstring;
                                                {6283}new TTL_5213: bitstring;
                                                {6284}let gNs_5214: bitstring = exp(g,Ns_5211) in
                                                {6285}let m2_5215: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5214,ST_5212,TTL_5213) in
                                                {6286}event beginSrv(Sess_5022,Cli_5020,gNs_5214);
                                                {6287}out(c, m2_5215);
                                                {6288}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6289}event endSrv(Cli_5020,Sess_5022,PartC_5210)
                                    )
                                    else
                                        {6290}let pkDisco_5216: bitstring = fail-any in
                                        {6291}in(c, (=pkCli_5158,em1_5217: bitstring));
                                        {6292}let m1_5218: bitstring = em1_5217 in
                                        {6293}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5158,PartC_5219: bitstring) = m1_5218 in
                                        {6294}new Ns_5220: bitstring;
                                        {6295}new ST_5221: bitstring;
                                        {6296}new TTL_5222: bitstring;
                                        {6297}let gNs_5223: bitstring = exp(g,Ns_5220) in
                                        {6298}let m2_5224: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5223,ST_5221,TTL_5222) in
                                        {6299}event beginSrv(Sess_5022,Cli_5020,gNs_5223);
                                        {6300}out(c, m2_5224);
                                        {6301}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6302}event endSrv(Cli_5020,Sess_5022,PartC_5219)
                                )
                                else
                                    {6303}let pkCli_5225: bitstring = pub(sk(Cli_5020)) in
                                    {6304}let v_5226: bool = (Disco_5021 = A) in
                                    (
                                        {6305}if v_5226 then
                                        (
                                            {6306}let pkDisco_5227: bitstring = pub(skA) in
                                            {6307}in(c, (=pkCli_5225,em1_5228: bitstring));
                                            {6308}let m1_5229: bitstring = em1_5228 in
                                            {6309}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5230: bitstring) = m1_5229 in
                                            {6310}new Ns_5231: bitstring;
                                            {6311}new ST_5232: bitstring;
                                            {6312}new TTL_5233: bitstring;
                                            {6313}let gNs_5234: bitstring = exp(g,Ns_5231) in
                                            {6314}let m2_5235: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5234,ST_5232,TTL_5233) in
                                            {6315}event beginSrv(Sess_5022,Cli_5020,gNs_5234);
                                            {6316}out(c, m2_5235);
                                            {6317}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6318}event endSrv(Cli_5020,Sess_5022,PartC_5230)
                                        )
                                        else
                                            {6319}let v_5236: bool = (Disco_5021 = B) in
                                            (
                                                {6320}if v_5236 then
                                                (
                                                    {6321}let pkDisco_5237: bitstring = pub(skB) in
                                                    {6322}in(c, (=pkCli_5225,em1_5238: bitstring));
                                                    {6323}let m1_5239: bitstring = em1_5238 in
                                                    {6324}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5240: bitstring) = m1_5239 in
                                                    {6325}new Ns_5241: bitstring;
                                                    {6326}new ST_5242: bitstring;
                                                    {6327}new TTL_5243: bitstring;
                                                    {6328}let gNs_5244: bitstring = exp(g,Ns_5241) in
                                                    {6329}let m2_5245: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5244,ST_5242,TTL_5243) in
                                                    {6330}event beginSrv(Sess_5022,Cli_5020,gNs_5244);
                                                    {6331}out(c, m2_5245);
                                                    {6332}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6333}event endSrv(Cli_5020,Sess_5022,PartC_5240)
                                                )
                                                else
                                                    {6334}let v_5246: bool = (Disco_5021 = C) in
                                                    (
                                                        {6335}if v_5246 then
                                                        (
                                                            {6336}let pkDisco_5247: bitstring = pub(skC) in
                                                            {6337}in(c, (=pkCli_5225,em1_5248: bitstring));
                                                            {6338}let m1_5249: bitstring = em1_5248 in
                                                            {6339}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5250: bitstring) = m1_5249 in
                                                            {6340}new Ns_5251: bitstring;
                                                            {6341}new ST_5252: bitstring;
                                                            {6342}new TTL_5253: bitstring;
                                                            {6343}let gNs_5254: bitstring = exp(g,Ns_5251) in
                                                            {6344}let m2_5255: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5254,ST_5252,TTL_5253) in
                                                            {6345}event beginSrv(Sess_5022,Cli_5020,gNs_5254);
                                                            {6346}out(c, m2_5255);
                                                            {6347}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6348}event endSrv(Cli_5020,Sess_5022,PartC_5250)
                                                        )
                                                        else
                                                            {6349}let pkDisco_5256: bitstring = pub(sk(Disco_5021)) in
                                                            {6350}in(c, (=pkCli_5225,em1_5257: bitstring));
                                                            {6351}let m1_5258: bitstring = em1_5257 in
                                                            {6352}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5259: bitstring) = m1_5258 in
                                                            {6353}new Ns_5260: bitstring;
                                                            {6354}new ST_5261: bitstring;
                                                            {6355}new TTL_5262: bitstring;
                                                            {6356}let gNs_5263: bitstring = exp(g,Ns_5260) in
                                                            {6357}let m2_5264: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5263,ST_5261,TTL_5262) in
                                                            {6358}event beginSrv(Sess_5022,Cli_5020,gNs_5263);
                                                            {6359}out(c, m2_5264);
                                                            {6360}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6361}event endSrv(Cli_5020,Sess_5022,PartC_5259)
                                                    )
                                                    else
                                                        {6362}let pkDisco_5265: bitstring = fail-any in
                                                        {6363}in(c, (=pkCli_5225,em1_5266: bitstring));
                                                        {6364}let m1_5267: bitstring = em1_5266 in
                                                        {6365}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5268: bitstring) = m1_5267 in
                                                        {6366}new Ns_5269: bitstring;
                                                        {6367}new ST_5270: bitstring;
                                                        {6368}new TTL_5271: bitstring;
                                                        {6369}let gNs_5272: bitstring = exp(g,Ns_5269) in
                                                        {6370}let m2_5273: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5272,ST_5270,TTL_5271) in
                                                        {6371}event beginSrv(Sess_5022,Cli_5020,gNs_5272);
                                                        {6372}out(c, m2_5273);
                                                        {6373}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {6374}event endSrv(Cli_5020,Sess_5022,PartC_5268)
                                            )
                                            else
                                                {6375}let pkDisco_5274: bitstring = fail-any in
                                                {6376}in(c, (=pkCli_5225,em1_5275: bitstring));
                                                {6377}let m1_5276: bitstring = em1_5275 in
                                                {6378}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5277: bitstring) = m1_5276 in
                                                {6379}new Ns_5278: bitstring;
                                                {6380}new ST_5279: bitstring;
                                                {6381}new TTL_5280: bitstring;
                                                {6382}let gNs_5281: bitstring = exp(g,Ns_5278) in
                                                {6383}let m2_5282: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5281,ST_5279,TTL_5280) in
                                                {6384}event beginSrv(Sess_5022,Cli_5020,gNs_5281);
                                                {6385}out(c, m2_5282);
                                                {6386}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6387}event endSrv(Cli_5020,Sess_5022,PartC_5277)
                                    )
                                    else
                                        {6388}let pkDisco_5283: bitstring = fail-any in
                                        {6389}in(c, (=pkCli_5225,em1_5284: bitstring));
                                        {6390}let m1_5285: bitstring = em1_5284 in
                                        {6391}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5225,PartC_5286: bitstring) = m1_5285 in
                                        {6392}new Ns_5287: bitstring;
                                        {6393}new ST_5288: bitstring;
                                        {6394}new TTL_5289: bitstring;
                                        {6395}let gNs_5290: bitstring = exp(g,Ns_5287) in
                                        {6396}let m2_5291: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5290,ST_5288,TTL_5289) in
                                        {6397}event beginSrv(Sess_5022,Cli_5020,gNs_5290);
                                        {6398}out(c, m2_5291);
                                        {6399}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6400}event endSrv(Cli_5020,Sess_5022,PartC_5286)
                            )
                            else
                                {6401}let pkCli_5292: bitstring = fail-any in
                                {6402}let v_5293: bool = (Disco_5021 = A) in
                                (
                                    {6403}if v_5293 then
                                    (
                                        {6404}let pkDisco_5294: bitstring = pub(skA) in
                                        {6405}in(c, (=pkCli_5292,em1_5295: bitstring));
                                        {6406}let m1_5296: bitstring = em1_5295 in
                                        {6407}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5297: bitstring) = m1_5296 in
                                        {6408}new Ns_5298: bitstring;
                                        {6409}new ST_5299: bitstring;
                                        {6410}new TTL_5300: bitstring;
                                        {6411}let gNs_5301: bitstring = exp(g,Ns_5298) in
                                        {6412}let m2_5302: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5301,ST_5299,TTL_5300) in
                                        {6413}event beginSrv(Sess_5022,Cli_5020,gNs_5301);
                                        {6414}out(c, m2_5302);
                                        {6415}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6416}event endSrv(Cli_5020,Sess_5022,PartC_5297)
                                    )
                                    else
                                        {6417}let v_5303: bool = (Disco_5021 = B) in
                                        (
                                            {6418}if v_5303 then
                                            (
                                                {6419}let pkDisco_5304: bitstring = pub(skB) in
                                                {6420}in(c, (=pkCli_5292,em1_5305: bitstring));
                                                {6421}let m1_5306: bitstring = em1_5305 in
                                                {6422}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5307: bitstring) = m1_5306 in
                                                {6423}new Ns_5308: bitstring;
                                                {6424}new ST_5309: bitstring;
                                                {6425}new TTL_5310: bitstring;
                                                {6426}let gNs_5311: bitstring = exp(g,Ns_5308) in
                                                {6427}let m2_5312: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5311,ST_5309,TTL_5310) in
                                                {6428}event beginSrv(Sess_5022,Cli_5020,gNs_5311);
                                                {6429}out(c, m2_5312);
                                                {6430}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6431}event endSrv(Cli_5020,Sess_5022,PartC_5307)
                                            )
                                            else
                                                {6432}let v_5313: bool = (Disco_5021 = C) in
                                                (
                                                    {6433}if v_5313 then
                                                    (
                                                        {6434}let pkDisco_5314: bitstring = pub(skC) in
                                                        {6435}in(c, (=pkCli_5292,em1_5315: bitstring));
                                                        {6436}let m1_5316: bitstring = em1_5315 in
                                                        {6437}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5317: bitstring) = m1_5316 in
                                                        {6438}new Ns_5318: bitstring;
                                                        {6439}new ST_5319: bitstring;
                                                        {6440}new TTL_5320: bitstring;
                                                        {6441}let gNs_5321: bitstring = exp(g,Ns_5318) in
                                                        {6442}let m2_5322: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5321,ST_5319,TTL_5320) in
                                                        {6443}event beginSrv(Sess_5022,Cli_5020,gNs_5321);
                                                        {6444}out(c, m2_5322);
                                                        {6445}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {6446}event endSrv(Cli_5020,Sess_5022,PartC_5317)
                                                    )
                                                    else
                                                        {6447}let pkDisco_5323: bitstring = pub(sk(Disco_5021)) in
                                                        {6448}in(c, (=pkCli_5292,em1_5324: bitstring));
                                                        {6449}let m1_5325: bitstring = em1_5324 in
                                                        {6450}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5326: bitstring) = m1_5325 in
                                                        {6451}new Ns_5327: bitstring;
                                                        {6452}new ST_5328: bitstring;
                                                        {6453}new TTL_5329: bitstring;
                                                        {6454}let gNs_5330: bitstring = exp(g,Ns_5327) in
                                                        {6455}let m2_5331: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5330,ST_5328,TTL_5329) in
                                                        {6456}event beginSrv(Sess_5022,Cli_5020,gNs_5330);
                                                        {6457}out(c, m2_5331);
                                                        {6458}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {6459}event endSrv(Cli_5020,Sess_5022,PartC_5326)
                                                )
                                                else
                                                    {6460}let pkDisco_5332: bitstring = fail-any in
                                                    {6461}in(c, (=pkCli_5292,em1_5333: bitstring));
                                                    {6462}let m1_5334: bitstring = em1_5333 in
                                                    {6463}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5335: bitstring) = m1_5334 in
                                                    {6464}new Ns_5336: bitstring;
                                                    {6465}new ST_5337: bitstring;
                                                    {6466}new TTL_5338: bitstring;
                                                    {6467}let gNs_5339: bitstring = exp(g,Ns_5336) in
                                                    {6468}let m2_5340: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5339,ST_5337,TTL_5338) in
                                                    {6469}event beginSrv(Sess_5022,Cli_5020,gNs_5339);
                                                    {6470}out(c, m2_5340);
                                                    {6471}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6472}event endSrv(Cli_5020,Sess_5022,PartC_5335)
                                        )
                                        else
                                            {6473}let pkDisco_5341: bitstring = fail-any in
                                            {6474}in(c, (=pkCli_5292,em1_5342: bitstring));
                                            {6475}let m1_5343: bitstring = em1_5342 in
                                            {6476}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5344: bitstring) = m1_5343 in
                                            {6477}new Ns_5345: bitstring;
                                            {6478}new ST_5346: bitstring;
                                            {6479}new TTL_5347: bitstring;
                                            {6480}let gNs_5348: bitstring = exp(g,Ns_5345) in
                                            {6481}let m2_5349: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5348,ST_5346,TTL_5347) in
                                            {6482}event beginSrv(Sess_5022,Cli_5020,gNs_5348);
                                            {6483}out(c, m2_5349);
                                            {6484}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6485}event endSrv(Cli_5020,Sess_5022,PartC_5344)
                                )
                                else
                                    {6486}let pkDisco_5350: bitstring = fail-any in
                                    {6487}in(c, (=pkCli_5292,em1_5351: bitstring));
                                    {6488}let m1_5352: bitstring = em1_5351 in
                                    {6489}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5292,PartC_5353: bitstring) = m1_5352 in
                                    {6490}new Ns_5354: bitstring;
                                    {6491}new ST_5355: bitstring;
                                    {6492}new TTL_5356: bitstring;
                                    {6493}let gNs_5357: bitstring = exp(g,Ns_5354) in
                                    {6494}let m2_5358: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5357,ST_5355,TTL_5356) in
                                    {6495}event beginSrv(Sess_5022,Cli_5020,gNs_5357);
                                    {6496}out(c, m2_5358);
                                    {6497}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {6498}event endSrv(Cli_5020,Sess_5022,PartC_5353)
                    )
                    else
                        {6499}let pkCli_5359: bitstring = fail-any in
                        {6500}let v_5360: bool = (Disco_5021 = A) in
                        (
                            {6501}if v_5360 then
                            (
                                {6502}let pkDisco_5361: bitstring = pub(skA) in
                                {6503}in(c, (=pkCli_5359,em1_5362: bitstring));
                                {6504}let m1_5363: bitstring = em1_5362 in
                                {6505}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5364: bitstring) = m1_5363 in
                                {6506}new Ns_5365: bitstring;
                                {6507}new ST_5366: bitstring;
                                {6508}new TTL_5367: bitstring;
                                {6509}let gNs_5368: bitstring = exp(g,Ns_5365) in
                                {6510}let m2_5369: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5368,ST_5366,TTL_5367) in
                                {6511}event beginSrv(Sess_5022,Cli_5020,gNs_5368);
                                {6512}out(c, m2_5369);
                                {6513}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {6514}event endSrv(Cli_5020,Sess_5022,PartC_5364)
                            )
                            else
                                {6515}let v_5370: bool = (Disco_5021 = B) in
                                (
                                    {6516}if v_5370 then
                                    (
                                        {6517}let pkDisco_5371: bitstring = pub(skB) in
                                        {6518}in(c, (=pkCli_5359,em1_5372: bitstring));
                                        {6519}let m1_5373: bitstring = em1_5372 in
                                        {6520}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5374: bitstring) = m1_5373 in
                                        {6521}new Ns_5375: bitstring;
                                        {6522}new ST_5376: bitstring;
                                        {6523}new TTL_5377: bitstring;
                                        {6524}let gNs_5378: bitstring = exp(g,Ns_5375) in
                                        {6525}let m2_5379: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5378,ST_5376,TTL_5377) in
                                        {6526}event beginSrv(Sess_5022,Cli_5020,gNs_5378);
                                        {6527}out(c, m2_5379);
                                        {6528}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6529}event endSrv(Cli_5020,Sess_5022,PartC_5374)
                                    )
                                    else
                                        {6530}let v_5380: bool = (Disco_5021 = C) in
                                        (
                                            {6531}if v_5380 then
                                            (
                                                {6532}let pkDisco_5381: bitstring = pub(skC) in
                                                {6533}in(c, (=pkCli_5359,em1_5382: bitstring));
                                                {6534}let m1_5383: bitstring = em1_5382 in
                                                {6535}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5384: bitstring) = m1_5383 in
                                                {6536}new Ns_5385: bitstring;
                                                {6537}new ST_5386: bitstring;
                                                {6538}new TTL_5387: bitstring;
                                                {6539}let gNs_5388: bitstring = exp(g,Ns_5385) in
                                                {6540}let m2_5389: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5388,ST_5386,TTL_5387) in
                                                {6541}event beginSrv(Sess_5022,Cli_5020,gNs_5388);
                                                {6542}out(c, m2_5389);
                                                {6543}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6544}event endSrv(Cli_5020,Sess_5022,PartC_5384)
                                            )
                                            else
                                                {6545}let pkDisco_5390: bitstring = pub(sk(Disco_5021)) in
                                                {6546}in(c, (=pkCli_5359,em1_5391: bitstring));
                                                {6547}let m1_5392: bitstring = em1_5391 in
                                                {6548}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5393: bitstring) = m1_5392 in
                                                {6549}new Ns_5394: bitstring;
                                                {6550}new ST_5395: bitstring;
                                                {6551}new TTL_5396: bitstring;
                                                {6552}let gNs_5397: bitstring = exp(g,Ns_5394) in
                                                {6553}let m2_5398: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5397,ST_5395,TTL_5396) in
                                                {6554}event beginSrv(Sess_5022,Cli_5020,gNs_5397);
                                                {6555}out(c, m2_5398);
                                                {6556}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6557}event endSrv(Cli_5020,Sess_5022,PartC_5393)
                                        )
                                        else
                                            {6558}let pkDisco_5399: bitstring = fail-any in
                                            {6559}in(c, (=pkCli_5359,em1_5400: bitstring));
                                            {6560}let m1_5401: bitstring = em1_5400 in
                                            {6561}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5402: bitstring) = m1_5401 in
                                            {6562}new Ns_5403: bitstring;
                                            {6563}new ST_5404: bitstring;
                                            {6564}new TTL_5405: bitstring;
                                            {6565}let gNs_5406: bitstring = exp(g,Ns_5403) in
                                            {6566}let m2_5407: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5406,ST_5404,TTL_5405) in
                                            {6567}event beginSrv(Sess_5022,Cli_5020,gNs_5406);
                                            {6568}out(c, m2_5407);
                                            {6569}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6570}event endSrv(Cli_5020,Sess_5022,PartC_5402)
                                )
                                else
                                    {6571}let pkDisco_5408: bitstring = fail-any in
                                    {6572}in(c, (=pkCli_5359,em1_5409: bitstring));
                                    {6573}let m1_5410: bitstring = em1_5409 in
                                    {6574}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5411: bitstring) = m1_5410 in
                                    {6575}new Ns_5412: bitstring;
                                    {6576}new ST_5413: bitstring;
                                    {6577}new TTL_5414: bitstring;
                                    {6578}let gNs_5415: bitstring = exp(g,Ns_5412) in
                                    {6579}let m2_5416: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5415,ST_5413,TTL_5414) in
                                    {6580}event beginSrv(Sess_5022,Cli_5020,gNs_5415);
                                    {6581}out(c, m2_5416);
                                    {6582}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {6583}event endSrv(Cli_5020,Sess_5022,PartC_5411)
                        )
                        else
                            {6584}let pkDisco_5417: bitstring = fail-any in
                            {6585}in(c, (=pkCli_5359,em1_5418: bitstring));
                            {6586}let m1_5419: bitstring = em1_5418 in
                            {6587}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5359,PartC_5420: bitstring) = m1_5419 in
                            {6588}new Ns_5421: bitstring;
                            {6589}new ST_5422: bitstring;
                            {6590}new TTL_5423: bitstring;
                            {6591}let gNs_5424: bitstring = exp(g,Ns_5421) in
                            {6592}let m2_5425: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5424,ST_5422,TTL_5423) in
                            {6593}event beginSrv(Sess_5022,Cli_5020,gNs_5424);
                            {6594}out(c, m2_5425);
                            {6595}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {6596}event endSrv(Cli_5020,Sess_5022,PartC_5420)
            )
            else
                {6597}let pkCli_5426: bitstring = fail-any in
                {6598}let v_5427: bool = (Disco_5021 = A) in
                (
                    {6599}if v_5427 then
                    (
                        {6600}let pkDisco_5428: bitstring = pub(skA) in
                        {6601}in(c, (=pkCli_5426,em1_5429: bitstring));
                        {6602}let m1_5430: bitstring = em1_5429 in
                        {6603}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5431: bitstring) = m1_5430 in
                        {6604}new Ns_5432: bitstring;
                        {6605}new ST_5433: bitstring;
                        {6606}new TTL_5434: bitstring;
                        {6607}let gNs_5435: bitstring = exp(g,Ns_5432) in
                        {6608}let m2_5436: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5435,ST_5433,TTL_5434) in
                        {6609}event beginSrv(Sess_5022,Cli_5020,gNs_5435);
                        {6610}out(c, m2_5436);
                        {6611}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                        {6612}event endSrv(Cli_5020,Sess_5022,PartC_5431)
                    )
                    else
                        {6613}let v_5437: bool = (Disco_5021 = B) in
                        (
                            {6614}if v_5437 then
                            (
                                {6615}let pkDisco_5438: bitstring = pub(skB) in
                                {6616}in(c, (=pkCli_5426,em1_5439: bitstring));
                                {6617}let m1_5440: bitstring = em1_5439 in
                                {6618}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5441: bitstring) = m1_5440 in
                                {6619}new Ns_5442: bitstring;
                                {6620}new ST_5443: bitstring;
                                {6621}new TTL_5444: bitstring;
                                {6622}let gNs_5445: bitstring = exp(g,Ns_5442) in
                                {6623}let m2_5446: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5445,ST_5443,TTL_5444) in
                                {6624}event beginSrv(Sess_5022,Cli_5020,gNs_5445);
                                {6625}out(c, m2_5446);
                                {6626}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {6627}event endSrv(Cli_5020,Sess_5022,PartC_5441)
                            )
                            else
                                {6628}let v_5447: bool = (Disco_5021 = C) in
                                (
                                    {6629}if v_5447 then
                                    (
                                        {6630}let pkDisco_5448: bitstring = pub(skC) in
                                        {6631}in(c, (=pkCli_5426,em1_5449: bitstring));
                                        {6632}let m1_5450: bitstring = em1_5449 in
                                        {6633}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5451: bitstring) = m1_5450 in
                                        {6634}new Ns_5452: bitstring;
                                        {6635}new ST_5453: bitstring;
                                        {6636}new TTL_5454: bitstring;
                                        {6637}let gNs_5455: bitstring = exp(g,Ns_5452) in
                                        {6638}let m2_5456: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5455,ST_5453,TTL_5454) in
                                        {6639}event beginSrv(Sess_5022,Cli_5020,gNs_5455);
                                        {6640}out(c, m2_5456);
                                        {6641}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6642}event endSrv(Cli_5020,Sess_5022,PartC_5451)
                                    )
                                    else
                                        {6643}let pkDisco_5457: bitstring = pub(sk(Disco_5021)) in
                                        {6644}in(c, (=pkCli_5426,em1_5458: bitstring));
                                        {6645}let m1_5459: bitstring = em1_5458 in
                                        {6646}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5460: bitstring) = m1_5459 in
                                        {6647}new Ns_5461: bitstring;
                                        {6648}new ST_5462: bitstring;
                                        {6649}new TTL_5463: bitstring;
                                        {6650}let gNs_5464: bitstring = exp(g,Ns_5461) in
                                        {6651}let m2_5465: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5464,ST_5462,TTL_5463) in
                                        {6652}event beginSrv(Sess_5022,Cli_5020,gNs_5464);
                                        {6653}out(c, m2_5465);
                                        {6654}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6655}event endSrv(Cli_5020,Sess_5022,PartC_5460)
                                )
                                else
                                    {6656}let pkDisco_5466: bitstring = fail-any in
                                    {6657}in(c, (=pkCli_5426,em1_5467: bitstring));
                                    {6658}let m1_5468: bitstring = em1_5467 in
                                    {6659}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5469: bitstring) = m1_5468 in
                                    {6660}new Ns_5470: bitstring;
                                    {6661}new ST_5471: bitstring;
                                    {6662}new TTL_5472: bitstring;
                                    {6663}let gNs_5473: bitstring = exp(g,Ns_5470) in
                                    {6664}let m2_5474: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5473,ST_5471,TTL_5472) in
                                    {6665}event beginSrv(Sess_5022,Cli_5020,gNs_5473);
                                    {6666}out(c, m2_5474);
                                    {6667}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {6668}event endSrv(Cli_5020,Sess_5022,PartC_5469)
                        )
                        else
                            {6669}let pkDisco_5475: bitstring = fail-any in
                            {6670}in(c, (=pkCli_5426,em1_5476: bitstring));
                            {6671}let m1_5477: bitstring = em1_5476 in
                            {6672}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5478: bitstring) = m1_5477 in
                            {6673}new Ns_5479: bitstring;
                            {6674}new ST_5480: bitstring;
                            {6675}new TTL_5481: bitstring;
                            {6676}let gNs_5482: bitstring = exp(g,Ns_5479) in
                            {6677}let m2_5483: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5482,ST_5480,TTL_5481) in
                            {6678}event beginSrv(Sess_5022,Cli_5020,gNs_5482);
                            {6679}out(c, m2_5483);
                            {6680}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {6681}event endSrv(Cli_5020,Sess_5022,PartC_5478)
                )
                else
                    {6682}let pkDisco_5484: bitstring = fail-any in
                    {6683}in(c, (=pkCli_5426,em1_5485: bitstring));
                    {6684}let m1_5486: bitstring = em1_5485 in
                    {6685}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5426,PartC_5487: bitstring) = m1_5486 in
                    {6686}new Ns_5488: bitstring;
                    {6687}new ST_5489: bitstring;
                    {6688}new TTL_5490: bitstring;
                    {6689}let gNs_5491: bitstring = exp(g,Ns_5488) in
                    {6690}let m2_5492: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5491,ST_5489,TTL_5490) in
                    {6691}event beginSrv(Sess_5022,Cli_5020,gNs_5491);
                    {6692}out(c, m2_5492);
                    {6693}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                    {6694}event endSrv(Cli_5020,Sess_5022,PartC_5487)
        )
        else
            {6695}let v_5493: bool = (Sess_5022 = B) in
            (
                {6696}if v_5493 then
                (
                    {6697}let skSess_5494: bitstring = skB in
                    {6698}let pkSess_5495: bitstring = pub(skSess_5494) in
                    {6699}let v_5496: bool = (Cli_5020 = A) in
                    (
                        {6700}if v_5496 then
                        (
                            {6701}let pkCli_5497: bitstring = pub(skA) in
                            {6702}let v_5498: bool = (Disco_5021 = A) in
                            (
                                {6703}if v_5498 then
                                (
                                    {6704}let pkDisco_5499: bitstring = pub(skA) in
                                    {6705}in(c, (=pkCli_5497,em1_5500: bitstring));
                                    {6706}let m1_5501: bitstring = em1_5500 in
                                    {6707}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5502: bitstring) = m1_5501 in
                                    {6708}new Ns_5503: bitstring;
                                    {6709}new ST_5504: bitstring;
                                    {6710}new TTL_5505: bitstring;
                                    {6711}let gNs_5506: bitstring = exp(g,Ns_5503) in
                                    {6712}let m2_5507: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5506,ST_5504,TTL_5505) in
                                    {6713}event beginSrv(Sess_5022,Cli_5020,gNs_5506);
                                    {6714}out(c, m2_5507);
                                    {6715}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {6716}event endSrv(Cli_5020,Sess_5022,PartC_5502)
                                )
                                else
                                    {6717}let v_5508: bool = (Disco_5021 = B) in
                                    (
                                        {6718}if v_5508 then
                                        (
                                            {6719}let pkDisco_5509: bitstring = pub(skB) in
                                            {6720}in(c, (=pkCli_5497,em1_5510: bitstring));
                                            {6721}let m1_5511: bitstring = em1_5510 in
                                            {6722}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5512: bitstring) = m1_5511 in
                                            {6723}new Ns_5513: bitstring;
                                            {6724}new ST_5514: bitstring;
                                            {6725}new TTL_5515: bitstring;
                                            {6726}let gNs_5516: bitstring = exp(g,Ns_5513) in
                                            {6727}let m2_5517: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5516,ST_5514,TTL_5515) in
                                            {6728}event beginSrv(Sess_5022,Cli_5020,gNs_5516);
                                            {6729}out(c, m2_5517);
                                            {6730}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6731}event endSrv(Cli_5020,Sess_5022,PartC_5512)
                                        )
                                        else
                                            {6732}let v_5518: bool = (Disco_5021 = C) in
                                            (
                                                {6733}if v_5518 then
                                                (
                                                    {6734}let pkDisco_5519: bitstring = pub(skC) in
                                                    {6735}in(c, (=pkCli_5497,em1_5520: bitstring));
                                                    {6736}let m1_5521: bitstring = em1_5520 in
                                                    {6737}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5522: bitstring) = m1_5521 in
                                                    {6738}new Ns_5523: bitstring;
                                                    {6739}new ST_5524: bitstring;
                                                    {6740}new TTL_5525: bitstring;
                                                    {6741}let gNs_5526: bitstring = exp(g,Ns_5523) in
                                                    {6742}let m2_5527: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5526,ST_5524,TTL_5525) in
                                                    {6743}event beginSrv(Sess_5022,Cli_5020,gNs_5526);
                                                    {6744}out(c, m2_5527);
                                                    {6745}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6746}event endSrv(Cli_5020,Sess_5022,PartC_5522)
                                                )
                                                else
                                                    {6747}let pkDisco_5528: bitstring = pub(sk(Disco_5021)) in
                                                    {6748}in(c, (=pkCli_5497,em1_5529: bitstring));
                                                    {6749}let m1_5530: bitstring = em1_5529 in
                                                    {6750}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5531: bitstring) = m1_5530 in
                                                    {6751}new Ns_5532: bitstring;
                                                    {6752}new ST_5533: bitstring;
                                                    {6753}new TTL_5534: bitstring;
                                                    {6754}let gNs_5535: bitstring = exp(g,Ns_5532) in
                                                    {6755}let m2_5536: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5535,ST_5533,TTL_5534) in
                                                    {6756}event beginSrv(Sess_5022,Cli_5020,gNs_5535);
                                                    {6757}out(c, m2_5536);
                                                    {6758}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6759}event endSrv(Cli_5020,Sess_5022,PartC_5531)
                                            )
                                            else
                                                {6760}let pkDisco_5537: bitstring = fail-any in
                                                {6761}in(c, (=pkCli_5497,em1_5538: bitstring));
                                                {6762}let m1_5539: bitstring = em1_5538 in
                                                {6763}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5540: bitstring) = m1_5539 in
                                                {6764}new Ns_5541: bitstring;
                                                {6765}new ST_5542: bitstring;
                                                {6766}new TTL_5543: bitstring;
                                                {6767}let gNs_5544: bitstring = exp(g,Ns_5541) in
                                                {6768}let m2_5545: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5544,ST_5542,TTL_5543) in
                                                {6769}event beginSrv(Sess_5022,Cli_5020,gNs_5544);
                                                {6770}out(c, m2_5545);
                                                {6771}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6772}event endSrv(Cli_5020,Sess_5022,PartC_5540)
                                    )
                                    else
                                        {6773}let pkDisco_5546: bitstring = fail-any in
                                        {6774}in(c, (=pkCli_5497,em1_5547: bitstring));
                                        {6775}let m1_5548: bitstring = em1_5547 in
                                        {6776}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5549: bitstring) = m1_5548 in
                                        {6777}new Ns_5550: bitstring;
                                        {6778}new ST_5551: bitstring;
                                        {6779}new TTL_5552: bitstring;
                                        {6780}let gNs_5553: bitstring = exp(g,Ns_5550) in
                                        {6781}let m2_5554: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5553,ST_5551,TTL_5552) in
                                        {6782}event beginSrv(Sess_5022,Cli_5020,gNs_5553);
                                        {6783}out(c, m2_5554);
                                        {6784}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6785}event endSrv(Cli_5020,Sess_5022,PartC_5549)
                            )
                            else
                                {6786}let pkDisco_5555: bitstring = fail-any in
                                {6787}in(c, (=pkCli_5497,em1_5556: bitstring));
                                {6788}let m1_5557: bitstring = em1_5556 in
                                {6789}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5497,PartC_5558: bitstring) = m1_5557 in
                                {6790}new Ns_5559: bitstring;
                                {6791}new ST_5560: bitstring;
                                {6792}new TTL_5561: bitstring;
                                {6793}let gNs_5562: bitstring = exp(g,Ns_5559) in
                                {6794}let m2_5563: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5562,ST_5560,TTL_5561) in
                                {6795}event beginSrv(Sess_5022,Cli_5020,gNs_5562);
                                {6796}out(c, m2_5563);
                                {6797}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {6798}event endSrv(Cli_5020,Sess_5022,PartC_5558)
                        )
                        else
                            {6799}let v_5564: bool = (Cli_5020 = B) in
                            (
                                {6800}if v_5564 then
                                (
                                    {6801}let pkCli_5565: bitstring = pub(skB) in
                                    {6802}let v_5566: bool = (Disco_5021 = A) in
                                    (
                                        {6803}if v_5566 then
                                        (
                                            {6804}let pkDisco_5567: bitstring = pub(skA) in
                                            {6805}in(c, (=pkCli_5565,em1_5568: bitstring));
                                            {6806}let m1_5569: bitstring = em1_5568 in
                                            {6807}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5570: bitstring) = m1_5569 in
                                            {6808}new Ns_5571: bitstring;
                                            {6809}new ST_5572: bitstring;
                                            {6810}new TTL_5573: bitstring;
                                            {6811}let gNs_5574: bitstring = exp(g,Ns_5571) in
                                            {6812}let m2_5575: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5574,ST_5572,TTL_5573) in
                                            {6813}event beginSrv(Sess_5022,Cli_5020,gNs_5574);
                                            {6814}out(c, m2_5575);
                                            {6815}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {6816}event endSrv(Cli_5020,Sess_5022,PartC_5570)
                                        )
                                        else
                                            {6817}let v_5576: bool = (Disco_5021 = B) in
                                            (
                                                {6818}if v_5576 then
                                                (
                                                    {6819}let pkDisco_5577: bitstring = pub(skB) in
                                                    {6820}in(c, (=pkCli_5565,em1_5578: bitstring));
                                                    {6821}let m1_5579: bitstring = em1_5578 in
                                                    {6822}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5580: bitstring) = m1_5579 in
                                                    {6823}new Ns_5581: bitstring;
                                                    {6824}new ST_5582: bitstring;
                                                    {6825}new TTL_5583: bitstring;
                                                    {6826}let gNs_5584: bitstring = exp(g,Ns_5581) in
                                                    {6827}let m2_5585: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5584,ST_5582,TTL_5583) in
                                                    {6828}event beginSrv(Sess_5022,Cli_5020,gNs_5584);
                                                    {6829}out(c, m2_5585);
                                                    {6830}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6831}event endSrv(Cli_5020,Sess_5022,PartC_5580)
                                                )
                                                else
                                                    {6832}let v_5586: bool = (Disco_5021 = C) in
                                                    (
                                                        {6833}if v_5586 then
                                                        (
                                                            {6834}let pkDisco_5587: bitstring = pub(skC) in
                                                            {6835}in(c, (=pkCli_5565,em1_5588: bitstring));
                                                            {6836}let m1_5589: bitstring = em1_5588 in
                                                            {6837}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5590: bitstring) = m1_5589 in
                                                            {6838}new Ns_5591: bitstring;
                                                            {6839}new ST_5592: bitstring;
                                                            {6840}new TTL_5593: bitstring;
                                                            {6841}let gNs_5594: bitstring = exp(g,Ns_5591) in
                                                            {6842}let m2_5595: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5594,ST_5592,TTL_5593) in
                                                            {6843}event beginSrv(Sess_5022,Cli_5020,gNs_5594);
                                                            {6844}out(c, m2_5595);
                                                            {6845}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6846}event endSrv(Cli_5020,Sess_5022,PartC_5590)
                                                        )
                                                        else
                                                            {6847}let pkDisco_5596: bitstring = pub(sk(Disco_5021)) in
                                                            {6848}in(c, (=pkCli_5565,em1_5597: bitstring));
                                                            {6849}let m1_5598: bitstring = em1_5597 in
                                                            {6850}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5599: bitstring) = m1_5598 in
                                                            {6851}new Ns_5600: bitstring;
                                                            {6852}new ST_5601: bitstring;
                                                            {6853}new TTL_5602: bitstring;
                                                            {6854}let gNs_5603: bitstring = exp(g,Ns_5600) in
                                                            {6855}let m2_5604: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5603,ST_5601,TTL_5602) in
                                                            {6856}event beginSrv(Sess_5022,Cli_5020,gNs_5603);
                                                            {6857}out(c, m2_5604);
                                                            {6858}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6859}event endSrv(Cli_5020,Sess_5022,PartC_5599)
                                                    )
                                                    else
                                                        {6860}let pkDisco_5605: bitstring = fail-any in
                                                        {6861}in(c, (=pkCli_5565,em1_5606: bitstring));
                                                        {6862}let m1_5607: bitstring = em1_5606 in
                                                        {6863}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5608: bitstring) = m1_5607 in
                                                        {6864}new Ns_5609: bitstring;
                                                        {6865}new ST_5610: bitstring;
                                                        {6866}new TTL_5611: bitstring;
                                                        {6867}let gNs_5612: bitstring = exp(g,Ns_5609) in
                                                        {6868}let m2_5613: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5612,ST_5610,TTL_5611) in
                                                        {6869}event beginSrv(Sess_5022,Cli_5020,gNs_5612);
                                                        {6870}out(c, m2_5613);
                                                        {6871}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {6872}event endSrv(Cli_5020,Sess_5022,PartC_5608)
                                            )
                                            else
                                                {6873}let pkDisco_5614: bitstring = fail-any in
                                                {6874}in(c, (=pkCli_5565,em1_5615: bitstring));
                                                {6875}let m1_5616: bitstring = em1_5615 in
                                                {6876}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5617: bitstring) = m1_5616 in
                                                {6877}new Ns_5618: bitstring;
                                                {6878}new ST_5619: bitstring;
                                                {6879}new TTL_5620: bitstring;
                                                {6880}let gNs_5621: bitstring = exp(g,Ns_5618) in
                                                {6881}let m2_5622: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5621,ST_5619,TTL_5620) in
                                                {6882}event beginSrv(Sess_5022,Cli_5020,gNs_5621);
                                                {6883}out(c, m2_5622);
                                                {6884}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6885}event endSrv(Cli_5020,Sess_5022,PartC_5617)
                                    )
                                    else
                                        {6886}let pkDisco_5623: bitstring = fail-any in
                                        {6887}in(c, (=pkCli_5565,em1_5624: bitstring));
                                        {6888}let m1_5625: bitstring = em1_5624 in
                                        {6889}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5565,PartC_5626: bitstring) = m1_5625 in
                                        {6890}new Ns_5627: bitstring;
                                        {6891}new ST_5628: bitstring;
                                        {6892}new TTL_5629: bitstring;
                                        {6893}let gNs_5630: bitstring = exp(g,Ns_5627) in
                                        {6894}let m2_5631: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5630,ST_5628,TTL_5629) in
                                        {6895}event beginSrv(Sess_5022,Cli_5020,gNs_5630);
                                        {6896}out(c, m2_5631);
                                        {6897}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {6898}event endSrv(Cli_5020,Sess_5022,PartC_5626)
                                )
                                else
                                    {6899}let v_5632: bool = (Cli_5020 = C) in
                                    (
                                        {6900}if v_5632 then
                                        (
                                            {6901}let pkCli_5633: bitstring = pub(skC) in
                                            {6902}let v_5634: bool = (Disco_5021 = A) in
                                            (
                                                {6903}if v_5634 then
                                                (
                                                    {6904}let pkDisco_5635: bitstring = pub(skA) in
                                                    {6905}in(c, (=pkCli_5633,em1_5636: bitstring));
                                                    {6906}let m1_5637: bitstring = em1_5636 in
                                                    {6907}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5638: bitstring) = m1_5637 in
                                                    {6908}new Ns_5639: bitstring;
                                                    {6909}new ST_5640: bitstring;
                                                    {6910}new TTL_5641: bitstring;
                                                    {6911}let gNs_5642: bitstring = exp(g,Ns_5639) in
                                                    {6912}let m2_5643: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5642,ST_5640,TTL_5641) in
                                                    {6913}event beginSrv(Sess_5022,Cli_5020,gNs_5642);
                                                    {6914}out(c, m2_5643);
                                                    {6915}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {6916}event endSrv(Cli_5020,Sess_5022,PartC_5638)
                                                )
                                                else
                                                    {6917}let v_5644: bool = (Disco_5021 = B) in
                                                    (
                                                        {6918}if v_5644 then
                                                        (
                                                            {6919}let pkDisco_5645: bitstring = pub(skB) in
                                                            {6920}in(c, (=pkCli_5633,em1_5646: bitstring));
                                                            {6921}let m1_5647: bitstring = em1_5646 in
                                                            {6922}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5648: bitstring) = m1_5647 in
                                                            {6923}new Ns_5649: bitstring;
                                                            {6924}new ST_5650: bitstring;
                                                            {6925}new TTL_5651: bitstring;
                                                            {6926}let gNs_5652: bitstring = exp(g,Ns_5649) in
                                                            {6927}let m2_5653: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5652,ST_5650,TTL_5651) in
                                                            {6928}event beginSrv(Sess_5022,Cli_5020,gNs_5652);
                                                            {6929}out(c, m2_5653);
                                                            {6930}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {6931}event endSrv(Cli_5020,Sess_5022,PartC_5648)
                                                        )
                                                        else
                                                            {6932}let v_5654: bool = (Disco_5021 = C) in
                                                            (
                                                                {6933}if v_5654 then
                                                                (
                                                                    {6934}let pkDisco_5655: bitstring = pub(skC) in
                                                                    {6935}in(c, (=pkCli_5633,em1_5656: bitstring));
                                                                    {6936}let m1_5657: bitstring = em1_5656 in
                                                                    {6937}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5658: bitstring) = m1_5657 in
                                                                    {6938}new Ns_5659: bitstring;
                                                                    {6939}new ST_5660: bitstring;
                                                                    {6940}new TTL_5661: bitstring;
                                                                    {6941}let gNs_5662: bitstring = exp(g,Ns_5659) in
                                                                    {6942}let m2_5663: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5662,ST_5660,TTL_5661) in
                                                                    {6943}event beginSrv(Sess_5022,Cli_5020,gNs_5662);
                                                                    {6944}out(c, m2_5663);
                                                                    {6945}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {6946}event endSrv(Cli_5020,Sess_5022,PartC_5658)
                                                                )
                                                                else
                                                                    {6947}let pkDisco_5664: bitstring = pub(sk(Disco_5021)) in
                                                                    {6948}in(c, (=pkCli_5633,em1_5665: bitstring));
                                                                    {6949}let m1_5666: bitstring = em1_5665 in
                                                                    {6950}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5667: bitstring) = m1_5666 in
                                                                    {6951}new Ns_5668: bitstring;
                                                                    {6952}new ST_5669: bitstring;
                                                                    {6953}new TTL_5670: bitstring;
                                                                    {6954}let gNs_5671: bitstring = exp(g,Ns_5668) in
                                                                    {6955}let m2_5672: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5671,ST_5669,TTL_5670) in
                                                                    {6956}event beginSrv(Sess_5022,Cli_5020,gNs_5671);
                                                                    {6957}out(c, m2_5672);
                                                                    {6958}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {6959}event endSrv(Cli_5020,Sess_5022,PartC_5667)
                                                            )
                                                            else
                                                                {6960}let pkDisco_5673: bitstring = fail-any in
                                                                {6961}in(c, (=pkCli_5633,em1_5674: bitstring));
                                                                {6962}let m1_5675: bitstring = em1_5674 in
                                                                {6963}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5676: bitstring) = m1_5675 in
                                                                {6964}new Ns_5677: bitstring;
                                                                {6965}new ST_5678: bitstring;
                                                                {6966}new TTL_5679: bitstring;
                                                                {6967}let gNs_5680: bitstring = exp(g,Ns_5677) in
                                                                {6968}let m2_5681: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5680,ST_5678,TTL_5679) in
                                                                {6969}event beginSrv(Sess_5022,Cli_5020,gNs_5680);
                                                                {6970}out(c, m2_5681);
                                                                {6971}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {6972}event endSrv(Cli_5020,Sess_5022,PartC_5676)
                                                    )
                                                    else
                                                        {6973}let pkDisco_5682: bitstring = fail-any in
                                                        {6974}in(c, (=pkCli_5633,em1_5683: bitstring));
                                                        {6975}let m1_5684: bitstring = em1_5683 in
                                                        {6976}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5685: bitstring) = m1_5684 in
                                                        {6977}new Ns_5686: bitstring;
                                                        {6978}new ST_5687: bitstring;
                                                        {6979}new TTL_5688: bitstring;
                                                        {6980}let gNs_5689: bitstring = exp(g,Ns_5686) in
                                                        {6981}let m2_5690: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5689,ST_5687,TTL_5688) in
                                                        {6982}event beginSrv(Sess_5022,Cli_5020,gNs_5689);
                                                        {6983}out(c, m2_5690);
                                                        {6984}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {6985}event endSrv(Cli_5020,Sess_5022,PartC_5685)
                                            )
                                            else
                                                {6986}let pkDisco_5691: bitstring = fail-any in
                                                {6987}in(c, (=pkCli_5633,em1_5692: bitstring));
                                                {6988}let m1_5693: bitstring = em1_5692 in
                                                {6989}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5633,PartC_5694: bitstring) = m1_5693 in
                                                {6990}new Ns_5695: bitstring;
                                                {6991}new ST_5696: bitstring;
                                                {6992}new TTL_5697: bitstring;
                                                {6993}let gNs_5698: bitstring = exp(g,Ns_5695) in
                                                {6994}let m2_5699: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5698,ST_5696,TTL_5697) in
                                                {6995}event beginSrv(Sess_5022,Cli_5020,gNs_5698);
                                                {6996}out(c, m2_5699);
                                                {6997}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {6998}event endSrv(Cli_5020,Sess_5022,PartC_5694)
                                        )
                                        else
                                            {6999}let pkCli_5700: bitstring = pub(sk(Cli_5020)) in
                                            {7000}let v_5701: bool = (Disco_5021 = A) in
                                            (
                                                {7001}if v_5701 then
                                                (
                                                    {7002}let pkDisco_5702: bitstring = pub(skA) in
                                                    {7003}in(c, (=pkCli_5700,em1_5703: bitstring));
                                                    {7004}let m1_5704: bitstring = em1_5703 in
                                                    {7005}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5705: bitstring) = m1_5704 in
                                                    {7006}new Ns_5706: bitstring;
                                                    {7007}new ST_5707: bitstring;
                                                    {7008}new TTL_5708: bitstring;
                                                    {7009}let gNs_5709: bitstring = exp(g,Ns_5706) in
                                                    {7010}let m2_5710: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5709,ST_5707,TTL_5708) in
                                                    {7011}event beginSrv(Sess_5022,Cli_5020,gNs_5709);
                                                    {7012}out(c, m2_5710);
                                                    {7013}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7014}event endSrv(Cli_5020,Sess_5022,PartC_5705)
                                                )
                                                else
                                                    {7015}let v_5711: bool = (Disco_5021 = B) in
                                                    (
                                                        {7016}if v_5711 then
                                                        (
                                                            {7017}let pkDisco_5712: bitstring = pub(skB) in
                                                            {7018}in(c, (=pkCli_5700,em1_5713: bitstring));
                                                            {7019}let m1_5714: bitstring = em1_5713 in
                                                            {7020}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5715: bitstring) = m1_5714 in
                                                            {7021}new Ns_5716: bitstring;
                                                            {7022}new ST_5717: bitstring;
                                                            {7023}new TTL_5718: bitstring;
                                                            {7024}let gNs_5719: bitstring = exp(g,Ns_5716) in
                                                            {7025}let m2_5720: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5719,ST_5717,TTL_5718) in
                                                            {7026}event beginSrv(Sess_5022,Cli_5020,gNs_5719);
                                                            {7027}out(c, m2_5720);
                                                            {7028}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7029}event endSrv(Cli_5020,Sess_5022,PartC_5715)
                                                        )
                                                        else
                                                            {7030}let v_5721: bool = (Disco_5021 = C) in
                                                            (
                                                                {7031}if v_5721 then
                                                                (
                                                                    {7032}let pkDisco_5722: bitstring = pub(skC) in
                                                                    {7033}in(c, (=pkCli_5700,em1_5723: bitstring));
                                                                    {7034}let m1_5724: bitstring = em1_5723 in
                                                                    {7035}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5725: bitstring) = m1_5724 in
                                                                    {7036}new Ns_5726: bitstring;
                                                                    {7037}new ST_5727: bitstring;
                                                                    {7038}new TTL_5728: bitstring;
                                                                    {7039}let gNs_5729: bitstring = exp(g,Ns_5726) in
                                                                    {7040}let m2_5730: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5729,ST_5727,TTL_5728) in
                                                                    {7041}event beginSrv(Sess_5022,Cli_5020,gNs_5729);
                                                                    {7042}out(c, m2_5730);
                                                                    {7043}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {7044}event endSrv(Cli_5020,Sess_5022,PartC_5725)
                                                                )
                                                                else
                                                                    {7045}let pkDisco_5731: bitstring = pub(sk(Disco_5021)) in
                                                                    {7046}in(c, (=pkCli_5700,em1_5732: bitstring));
                                                                    {7047}let m1_5733: bitstring = em1_5732 in
                                                                    {7048}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5734: bitstring) = m1_5733 in
                                                                    {7049}new Ns_5735: bitstring;
                                                                    {7050}new ST_5736: bitstring;
                                                                    {7051}new TTL_5737: bitstring;
                                                                    {7052}let gNs_5738: bitstring = exp(g,Ns_5735) in
                                                                    {7053}let m2_5739: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5738,ST_5736,TTL_5737) in
                                                                    {7054}event beginSrv(Sess_5022,Cli_5020,gNs_5738);
                                                                    {7055}out(c, m2_5739);
                                                                    {7056}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {7057}event endSrv(Cli_5020,Sess_5022,PartC_5734)
                                                            )
                                                            else
                                                                {7058}let pkDisco_5740: bitstring = fail-any in
                                                                {7059}in(c, (=pkCli_5700,em1_5741: bitstring));
                                                                {7060}let m1_5742: bitstring = em1_5741 in
                                                                {7061}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5743: bitstring) = m1_5742 in
                                                                {7062}new Ns_5744: bitstring;
                                                                {7063}new ST_5745: bitstring;
                                                                {7064}new TTL_5746: bitstring;
                                                                {7065}let gNs_5747: bitstring = exp(g,Ns_5744) in
                                                                {7066}let m2_5748: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5747,ST_5745,TTL_5746) in
                                                                {7067}event beginSrv(Sess_5022,Cli_5020,gNs_5747);
                                                                {7068}out(c, m2_5748);
                                                                {7069}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7070}event endSrv(Cli_5020,Sess_5022,PartC_5743)
                                                    )
                                                    else
                                                        {7071}let pkDisco_5749: bitstring = fail-any in
                                                        {7072}in(c, (=pkCli_5700,em1_5750: bitstring));
                                                        {7073}let m1_5751: bitstring = em1_5750 in
                                                        {7074}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5752: bitstring) = m1_5751 in
                                                        {7075}new Ns_5753: bitstring;
                                                        {7076}new ST_5754: bitstring;
                                                        {7077}new TTL_5755: bitstring;
                                                        {7078}let gNs_5756: bitstring = exp(g,Ns_5753) in
                                                        {7079}let m2_5757: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5756,ST_5754,TTL_5755) in
                                                        {7080}event beginSrv(Sess_5022,Cli_5020,gNs_5756);
                                                        {7081}out(c, m2_5757);
                                                        {7082}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7083}event endSrv(Cli_5020,Sess_5022,PartC_5752)
                                            )
                                            else
                                                {7084}let pkDisco_5758: bitstring = fail-any in
                                                {7085}in(c, (=pkCli_5700,em1_5759: bitstring));
                                                {7086}let m1_5760: bitstring = em1_5759 in
                                                {7087}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5700,PartC_5761: bitstring) = m1_5760 in
                                                {7088}new Ns_5762: bitstring;
                                                {7089}new ST_5763: bitstring;
                                                {7090}new TTL_5764: bitstring;
                                                {7091}let gNs_5765: bitstring = exp(g,Ns_5762) in
                                                {7092}let m2_5766: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5765,ST_5763,TTL_5764) in
                                                {7093}event beginSrv(Sess_5022,Cli_5020,gNs_5765);
                                                {7094}out(c, m2_5766);
                                                {7095}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7096}event endSrv(Cli_5020,Sess_5022,PartC_5761)
                                    )
                                    else
                                        {7097}let pkCli_5767: bitstring = fail-any in
                                        {7098}let v_5768: bool = (Disco_5021 = A) in
                                        (
                                            {7099}if v_5768 then
                                            (
                                                {7100}let pkDisco_5769: bitstring = pub(skA) in
                                                {7101}in(c, (=pkCli_5767,em1_5770: bitstring));
                                                {7102}let m1_5771: bitstring = em1_5770 in
                                                {7103}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5772: bitstring) = m1_5771 in
                                                {7104}new Ns_5773: bitstring;
                                                {7105}new ST_5774: bitstring;
                                                {7106}new TTL_5775: bitstring;
                                                {7107}let gNs_5776: bitstring = exp(g,Ns_5773) in
                                                {7108}let m2_5777: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5776,ST_5774,TTL_5775) in
                                                {7109}event beginSrv(Sess_5022,Cli_5020,gNs_5776);
                                                {7110}out(c, m2_5777);
                                                {7111}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7112}event endSrv(Cli_5020,Sess_5022,PartC_5772)
                                            )
                                            else
                                                {7113}let v_5778: bool = (Disco_5021 = B) in
                                                (
                                                    {7114}if v_5778 then
                                                    (
                                                        {7115}let pkDisco_5779: bitstring = pub(skB) in
                                                        {7116}in(c, (=pkCli_5767,em1_5780: bitstring));
                                                        {7117}let m1_5781: bitstring = em1_5780 in
                                                        {7118}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5782: bitstring) = m1_5781 in
                                                        {7119}new Ns_5783: bitstring;
                                                        {7120}new ST_5784: bitstring;
                                                        {7121}new TTL_5785: bitstring;
                                                        {7122}let gNs_5786: bitstring = exp(g,Ns_5783) in
                                                        {7123}let m2_5787: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5786,ST_5784,TTL_5785) in
                                                        {7124}event beginSrv(Sess_5022,Cli_5020,gNs_5786);
                                                        {7125}out(c, m2_5787);
                                                        {7126}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7127}event endSrv(Cli_5020,Sess_5022,PartC_5782)
                                                    )
                                                    else
                                                        {7128}let v_5788: bool = (Disco_5021 = C) in
                                                        (
                                                            {7129}if v_5788 then
                                                            (
                                                                {7130}let pkDisco_5789: bitstring = pub(skC) in
                                                                {7131}in(c, (=pkCli_5767,em1_5790: bitstring));
                                                                {7132}let m1_5791: bitstring = em1_5790 in
                                                                {7133}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5792: bitstring) = m1_5791 in
                                                                {7134}new Ns_5793: bitstring;
                                                                {7135}new ST_5794: bitstring;
                                                                {7136}new TTL_5795: bitstring;
                                                                {7137}let gNs_5796: bitstring = exp(g,Ns_5793) in
                                                                {7138}let m2_5797: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5796,ST_5794,TTL_5795) in
                                                                {7139}event beginSrv(Sess_5022,Cli_5020,gNs_5796);
                                                                {7140}out(c, m2_5797);
                                                                {7141}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7142}event endSrv(Cli_5020,Sess_5022,PartC_5792)
                                                            )
                                                            else
                                                                {7143}let pkDisco_5798: bitstring = pub(sk(Disco_5021)) in
                                                                {7144}in(c, (=pkCli_5767,em1_5799: bitstring));
                                                                {7145}let m1_5800: bitstring = em1_5799 in
                                                                {7146}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5801: bitstring) = m1_5800 in
                                                                {7147}new Ns_5802: bitstring;
                                                                {7148}new ST_5803: bitstring;
                                                                {7149}new TTL_5804: bitstring;
                                                                {7150}let gNs_5805: bitstring = exp(g,Ns_5802) in
                                                                {7151}let m2_5806: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5805,ST_5803,TTL_5804) in
                                                                {7152}event beginSrv(Sess_5022,Cli_5020,gNs_5805);
                                                                {7153}out(c, m2_5806);
                                                                {7154}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7155}event endSrv(Cli_5020,Sess_5022,PartC_5801)
                                                        )
                                                        else
                                                            {7156}let pkDisco_5807: bitstring = fail-any in
                                                            {7157}in(c, (=pkCli_5767,em1_5808: bitstring));
                                                            {7158}let m1_5809: bitstring = em1_5808 in
                                                            {7159}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5810: bitstring) = m1_5809 in
                                                            {7160}new Ns_5811: bitstring;
                                                            {7161}new ST_5812: bitstring;
                                                            {7162}new TTL_5813: bitstring;
                                                            {7163}let gNs_5814: bitstring = exp(g,Ns_5811) in
                                                            {7164}let m2_5815: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5814,ST_5812,TTL_5813) in
                                                            {7165}event beginSrv(Sess_5022,Cli_5020,gNs_5814);
                                                            {7166}out(c, m2_5815);
                                                            {7167}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7168}event endSrv(Cli_5020,Sess_5022,PartC_5810)
                                                )
                                                else
                                                    {7169}let pkDisco_5816: bitstring = fail-any in
                                                    {7170}in(c, (=pkCli_5767,em1_5817: bitstring));
                                                    {7171}let m1_5818: bitstring = em1_5817 in
                                                    {7172}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5819: bitstring) = m1_5818 in
                                                    {7173}new Ns_5820: bitstring;
                                                    {7174}new ST_5821: bitstring;
                                                    {7175}new TTL_5822: bitstring;
                                                    {7176}let gNs_5823: bitstring = exp(g,Ns_5820) in
                                                    {7177}let m2_5824: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5823,ST_5821,TTL_5822) in
                                                    {7178}event beginSrv(Sess_5022,Cli_5020,gNs_5823);
                                                    {7179}out(c, m2_5824);
                                                    {7180}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7181}event endSrv(Cli_5020,Sess_5022,PartC_5819)
                                        )
                                        else
                                            {7182}let pkDisco_5825: bitstring = fail-any in
                                            {7183}in(c, (=pkCli_5767,em1_5826: bitstring));
                                            {7184}let m1_5827: bitstring = em1_5826 in
                                            {7185}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5767,PartC_5828: bitstring) = m1_5827 in
                                            {7186}new Ns_5829: bitstring;
                                            {7187}new ST_5830: bitstring;
                                            {7188}new TTL_5831: bitstring;
                                            {7189}let gNs_5832: bitstring = exp(g,Ns_5829) in
                                            {7190}let m2_5833: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5832,ST_5830,TTL_5831) in
                                            {7191}event beginSrv(Sess_5022,Cli_5020,gNs_5832);
                                            {7192}out(c, m2_5833);
                                            {7193}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {7194}event endSrv(Cli_5020,Sess_5022,PartC_5828)
                            )
                            else
                                {7195}let pkCli_5834: bitstring = fail-any in
                                {7196}let v_5835: bool = (Disco_5021 = A) in
                                (
                                    {7197}if v_5835 then
                                    (
                                        {7198}let pkDisco_5836: bitstring = pub(skA) in
                                        {7199}in(c, (=pkCli_5834,em1_5837: bitstring));
                                        {7200}let m1_5838: bitstring = em1_5837 in
                                        {7201}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5839: bitstring) = m1_5838 in
                                        {7202}new Ns_5840: bitstring;
                                        {7203}new ST_5841: bitstring;
                                        {7204}new TTL_5842: bitstring;
                                        {7205}let gNs_5843: bitstring = exp(g,Ns_5840) in
                                        {7206}let m2_5844: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5843,ST_5841,TTL_5842) in
                                        {7207}event beginSrv(Sess_5022,Cli_5020,gNs_5843);
                                        {7208}out(c, m2_5844);
                                        {7209}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {7210}event endSrv(Cli_5020,Sess_5022,PartC_5839)
                                    )
                                    else
                                        {7211}let v_5845: bool = (Disco_5021 = B) in
                                        (
                                            {7212}if v_5845 then
                                            (
                                                {7213}let pkDisco_5846: bitstring = pub(skB) in
                                                {7214}in(c, (=pkCli_5834,em1_5847: bitstring));
                                                {7215}let m1_5848: bitstring = em1_5847 in
                                                {7216}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5849: bitstring) = m1_5848 in
                                                {7217}new Ns_5850: bitstring;
                                                {7218}new ST_5851: bitstring;
                                                {7219}new TTL_5852: bitstring;
                                                {7220}let gNs_5853: bitstring = exp(g,Ns_5850) in
                                                {7221}let m2_5854: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5853,ST_5851,TTL_5852) in
                                                {7222}event beginSrv(Sess_5022,Cli_5020,gNs_5853);
                                                {7223}out(c, m2_5854);
                                                {7224}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7225}event endSrv(Cli_5020,Sess_5022,PartC_5849)
                                            )
                                            else
                                                {7226}let v_5855: bool = (Disco_5021 = C) in
                                                (
                                                    {7227}if v_5855 then
                                                    (
                                                        {7228}let pkDisco_5856: bitstring = pub(skC) in
                                                        {7229}in(c, (=pkCli_5834,em1_5857: bitstring));
                                                        {7230}let m1_5858: bitstring = em1_5857 in
                                                        {7231}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5859: bitstring) = m1_5858 in
                                                        {7232}new Ns_5860: bitstring;
                                                        {7233}new ST_5861: bitstring;
                                                        {7234}new TTL_5862: bitstring;
                                                        {7235}let gNs_5863: bitstring = exp(g,Ns_5860) in
                                                        {7236}let m2_5864: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5863,ST_5861,TTL_5862) in
                                                        {7237}event beginSrv(Sess_5022,Cli_5020,gNs_5863);
                                                        {7238}out(c, m2_5864);
                                                        {7239}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7240}event endSrv(Cli_5020,Sess_5022,PartC_5859)
                                                    )
                                                    else
                                                        {7241}let pkDisco_5865: bitstring = pub(sk(Disco_5021)) in
                                                        {7242}in(c, (=pkCli_5834,em1_5866: bitstring));
                                                        {7243}let m1_5867: bitstring = em1_5866 in
                                                        {7244}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5868: bitstring) = m1_5867 in
                                                        {7245}new Ns_5869: bitstring;
                                                        {7246}new ST_5870: bitstring;
                                                        {7247}new TTL_5871: bitstring;
                                                        {7248}let gNs_5872: bitstring = exp(g,Ns_5869) in
                                                        {7249}let m2_5873: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5872,ST_5870,TTL_5871) in
                                                        {7250}event beginSrv(Sess_5022,Cli_5020,gNs_5872);
                                                        {7251}out(c, m2_5873);
                                                        {7252}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7253}event endSrv(Cli_5020,Sess_5022,PartC_5868)
                                                )
                                                else
                                                    {7254}let pkDisco_5874: bitstring = fail-any in
                                                    {7255}in(c, (=pkCli_5834,em1_5875: bitstring));
                                                    {7256}let m1_5876: bitstring = em1_5875 in
                                                    {7257}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5877: bitstring) = m1_5876 in
                                                    {7258}new Ns_5878: bitstring;
                                                    {7259}new ST_5879: bitstring;
                                                    {7260}new TTL_5880: bitstring;
                                                    {7261}let gNs_5881: bitstring = exp(g,Ns_5878) in
                                                    {7262}let m2_5882: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5881,ST_5879,TTL_5880) in
                                                    {7263}event beginSrv(Sess_5022,Cli_5020,gNs_5881);
                                                    {7264}out(c, m2_5882);
                                                    {7265}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7266}event endSrv(Cli_5020,Sess_5022,PartC_5877)
                                        )
                                        else
                                            {7267}let pkDisco_5883: bitstring = fail-any in
                                            {7268}in(c, (=pkCli_5834,em1_5884: bitstring));
                                            {7269}let m1_5885: bitstring = em1_5884 in
                                            {7270}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5886: bitstring) = m1_5885 in
                                            {7271}new Ns_5887: bitstring;
                                            {7272}new ST_5888: bitstring;
                                            {7273}new TTL_5889: bitstring;
                                            {7274}let gNs_5890: bitstring = exp(g,Ns_5887) in
                                            {7275}let m2_5891: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5890,ST_5888,TTL_5889) in
                                            {7276}event beginSrv(Sess_5022,Cli_5020,gNs_5890);
                                            {7277}out(c, m2_5891);
                                            {7278}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {7279}event endSrv(Cli_5020,Sess_5022,PartC_5886)
                                )
                                else
                                    {7280}let pkDisco_5892: bitstring = fail-any in
                                    {7281}in(c, (=pkCli_5834,em1_5893: bitstring));
                                    {7282}let m1_5894: bitstring = em1_5893 in
                                    {7283}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5834,PartC_5895: bitstring) = m1_5894 in
                                    {7284}new Ns_5896: bitstring;
                                    {7285}new ST_5897: bitstring;
                                    {7286}new TTL_5898: bitstring;
                                    {7287}let gNs_5899: bitstring = exp(g,Ns_5896) in
                                    {7288}let m2_5900: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5899,ST_5897,TTL_5898) in
                                    {7289}event beginSrv(Sess_5022,Cli_5020,gNs_5899);
                                    {7290}out(c, m2_5900);
                                    {7291}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {7292}event endSrv(Cli_5020,Sess_5022,PartC_5895)
                    )
                    else
                        {7293}let pkCli_5901: bitstring = fail-any in
                        {7294}let v_5902: bool = (Disco_5021 = A) in
                        (
                            {7295}if v_5902 then
                            (
                                {7296}let pkDisco_5903: bitstring = pub(skA) in
                                {7297}in(c, (=pkCli_5901,em1_5904: bitstring));
                                {7298}let m1_5905: bitstring = em1_5904 in
                                {7299}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5906: bitstring) = m1_5905 in
                                {7300}new Ns_5907: bitstring;
                                {7301}new ST_5908: bitstring;
                                {7302}new TTL_5909: bitstring;
                                {7303}let gNs_5910: bitstring = exp(g,Ns_5907) in
                                {7304}let m2_5911: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5910,ST_5908,TTL_5909) in
                                {7305}event beginSrv(Sess_5022,Cli_5020,gNs_5910);
                                {7306}out(c, m2_5911);
                                {7307}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {7308}event endSrv(Cli_5020,Sess_5022,PartC_5906)
                            )
                            else
                                {7309}let v_5912: bool = (Disco_5021 = B) in
                                (
                                    {7310}if v_5912 then
                                    (
                                        {7311}let pkDisco_5913: bitstring = pub(skB) in
                                        {7312}in(c, (=pkCli_5901,em1_5914: bitstring));
                                        {7313}let m1_5915: bitstring = em1_5914 in
                                        {7314}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5916: bitstring) = m1_5915 in
                                        {7315}new Ns_5917: bitstring;
                                        {7316}new ST_5918: bitstring;
                                        {7317}new TTL_5919: bitstring;
                                        {7318}let gNs_5920: bitstring = exp(g,Ns_5917) in
                                        {7319}let m2_5921: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5920,ST_5918,TTL_5919) in
                                        {7320}event beginSrv(Sess_5022,Cli_5020,gNs_5920);
                                        {7321}out(c, m2_5921);
                                        {7322}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {7323}event endSrv(Cli_5020,Sess_5022,PartC_5916)
                                    )
                                    else
                                        {7324}let v_5922: bool = (Disco_5021 = C) in
                                        (
                                            {7325}if v_5922 then
                                            (
                                                {7326}let pkDisco_5923: bitstring = pub(skC) in
                                                {7327}in(c, (=pkCli_5901,em1_5924: bitstring));
                                                {7328}let m1_5925: bitstring = em1_5924 in
                                                {7329}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5926: bitstring) = m1_5925 in
                                                {7330}new Ns_5927: bitstring;
                                                {7331}new ST_5928: bitstring;
                                                {7332}new TTL_5929: bitstring;
                                                {7333}let gNs_5930: bitstring = exp(g,Ns_5927) in
                                                {7334}let m2_5931: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5930,ST_5928,TTL_5929) in
                                                {7335}event beginSrv(Sess_5022,Cli_5020,gNs_5930);
                                                {7336}out(c, m2_5931);
                                                {7337}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7338}event endSrv(Cli_5020,Sess_5022,PartC_5926)
                                            )
                                            else
                                                {7339}let pkDisco_5932: bitstring = pub(sk(Disco_5021)) in
                                                {7340}in(c, (=pkCli_5901,em1_5933: bitstring));
                                                {7341}let m1_5934: bitstring = em1_5933 in
                                                {7342}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5935: bitstring) = m1_5934 in
                                                {7343}new Ns_5936: bitstring;
                                                {7344}new ST_5937: bitstring;
                                                {7345}new TTL_5938: bitstring;
                                                {7346}let gNs_5939: bitstring = exp(g,Ns_5936) in
                                                {7347}let m2_5940: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5939,ST_5937,TTL_5938) in
                                                {7348}event beginSrv(Sess_5022,Cli_5020,gNs_5939);
                                                {7349}out(c, m2_5940);
                                                {7350}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7351}event endSrv(Cli_5020,Sess_5022,PartC_5935)
                                        )
                                        else
                                            {7352}let pkDisco_5941: bitstring = fail-any in
                                            {7353}in(c, (=pkCli_5901,em1_5942: bitstring));
                                            {7354}let m1_5943: bitstring = em1_5942 in
                                            {7355}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5944: bitstring) = m1_5943 in
                                            {7356}new Ns_5945: bitstring;
                                            {7357}new ST_5946: bitstring;
                                            {7358}new TTL_5947: bitstring;
                                            {7359}let gNs_5948: bitstring = exp(g,Ns_5945) in
                                            {7360}let m2_5949: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5948,ST_5946,TTL_5947) in
                                            {7361}event beginSrv(Sess_5022,Cli_5020,gNs_5948);
                                            {7362}out(c, m2_5949);
                                            {7363}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {7364}event endSrv(Cli_5020,Sess_5022,PartC_5944)
                                )
                                else
                                    {7365}let pkDisco_5950: bitstring = fail-any in
                                    {7366}in(c, (=pkCli_5901,em1_5951: bitstring));
                                    {7367}let m1_5952: bitstring = em1_5951 in
                                    {7368}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5953: bitstring) = m1_5952 in
                                    {7369}new Ns_5954: bitstring;
                                    {7370}new ST_5955: bitstring;
                                    {7371}new TTL_5956: bitstring;
                                    {7372}let gNs_5957: bitstring = exp(g,Ns_5954) in
                                    {7373}let m2_5958: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5957,ST_5955,TTL_5956) in
                                    {7374}event beginSrv(Sess_5022,Cli_5020,gNs_5957);
                                    {7375}out(c, m2_5958);
                                    {7376}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {7377}event endSrv(Cli_5020,Sess_5022,PartC_5953)
                        )
                        else
                            {7378}let pkDisco_5959: bitstring = fail-any in
                            {7379}in(c, (=pkCli_5901,em1_5960: bitstring));
                            {7380}let m1_5961: bitstring = em1_5960 in
                            {7381}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5901,PartC_5962: bitstring) = m1_5961 in
                            {7382}new Ns_5963: bitstring;
                            {7383}new ST_5964: bitstring;
                            {7384}new TTL_5965: bitstring;
                            {7385}let gNs_5966: bitstring = exp(g,Ns_5963) in
                            {7386}let m2_5967: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5966,ST_5964,TTL_5965) in
                            {7387}event beginSrv(Sess_5022,Cli_5020,gNs_5966);
                            {7388}out(c, m2_5967);
                            {7389}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {7390}event endSrv(Cli_5020,Sess_5022,PartC_5962)
                )
                else
                    {7391}let =true = (Sess_5022 = C) in
                    (
                        {7392}let skSess_5968: bitstring = skC in
                        {7393}let pkSess_5969: bitstring = pub(skSess_5968) in
                        {7394}let v_5970: bool = (Cli_5020 = A) in
                        (
                            {7395}if v_5970 then
                            (
                                {7396}let pkCli_5971: bitstring = pub(skA) in
                                {7397}let v_5972: bool = (Disco_5021 = A) in
                                (
                                    {7398}if v_5972 then
                                    (
                                        {7399}let pkDisco_5973: bitstring = pub(skA) in
                                        {7400}in(c, (=pkCli_5971,em1_5974: bitstring));
                                        {7401}let m1_5975: bitstring = em1_5974 in
                                        {7402}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_5976: bitstring) = m1_5975 in
                                        {7403}new Ns_5977: bitstring;
                                        {7404}new ST_5978: bitstring;
                                        {7405}new TTL_5979: bitstring;
                                        {7406}let gNs_5980: bitstring = exp(g,Ns_5977) in
                                        {7407}let m2_5981: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5980,ST_5978,TTL_5979) in
                                        {7408}event beginSrv(Sess_5022,Cli_5020,gNs_5980);
                                        {7409}out(c, m2_5981);
                                        {7410}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {7411}event endSrv(Cli_5020,Sess_5022,PartC_5976)
                                    )
                                    else
                                        {7412}let v_5982: bool = (Disco_5021 = B) in
                                        (
                                            {7413}if v_5982 then
                                            (
                                                {7414}let pkDisco_5983: bitstring = pub(skB) in
                                                {7415}in(c, (=pkCli_5971,em1_5984: bitstring));
                                                {7416}let m1_5985: bitstring = em1_5984 in
                                                {7417}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_5986: bitstring) = m1_5985 in
                                                {7418}new Ns_5987: bitstring;
                                                {7419}new ST_5988: bitstring;
                                                {7420}new TTL_5989: bitstring;
                                                {7421}let gNs_5990: bitstring = exp(g,Ns_5987) in
                                                {7422}let m2_5991: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_5990,ST_5988,TTL_5989) in
                                                {7423}event beginSrv(Sess_5022,Cli_5020,gNs_5990);
                                                {7424}out(c, m2_5991);
                                                {7425}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7426}event endSrv(Cli_5020,Sess_5022,PartC_5986)
                                            )
                                            else
                                                {7427}let v_5992: bool = (Disco_5021 = C) in
                                                (
                                                    {7428}if v_5992 then
                                                    (
                                                        {7429}let pkDisco_5993: bitstring = pub(skC) in
                                                        {7430}in(c, (=pkCli_5971,em1_5994: bitstring));
                                                        {7431}let m1_5995: bitstring = em1_5994 in
                                                        {7432}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_5996: bitstring) = m1_5995 in
                                                        {7433}new Ns_5997: bitstring;
                                                        {7434}new ST_5998: bitstring;
                                                        {7435}new TTL_5999: bitstring;
                                                        {7436}let gNs_6000: bitstring = exp(g,Ns_5997) in
                                                        {7437}let m2_6001: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6000,ST_5998,TTL_5999) in
                                                        {7438}event beginSrv(Sess_5022,Cli_5020,gNs_6000);
                                                        {7439}out(c, m2_6001);
                                                        {7440}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7441}event endSrv(Cli_5020,Sess_5022,PartC_5996)
                                                    )
                                                    else
                                                        {7442}let pkDisco_6002: bitstring = pub(sk(Disco_5021)) in
                                                        {7443}in(c, (=pkCli_5971,em1_6003: bitstring));
                                                        {7444}let m1_6004: bitstring = em1_6003 in
                                                        {7445}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_6005: bitstring) = m1_6004 in
                                                        {7446}new Ns_6006: bitstring;
                                                        {7447}new ST_6007: bitstring;
                                                        {7448}new TTL_6008: bitstring;
                                                        {7449}let gNs_6009: bitstring = exp(g,Ns_6006) in
                                                        {7450}let m2_6010: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6009,ST_6007,TTL_6008) in
                                                        {7451}event beginSrv(Sess_5022,Cli_5020,gNs_6009);
                                                        {7452}out(c, m2_6010);
                                                        {7453}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7454}event endSrv(Cli_5020,Sess_5022,PartC_6005)
                                                )
                                                else
                                                    {7455}let pkDisco_6011: bitstring = fail-any in
                                                    {7456}in(c, (=pkCli_5971,em1_6012: bitstring));
                                                    {7457}let m1_6013: bitstring = em1_6012 in
                                                    {7458}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_6014: bitstring) = m1_6013 in
                                                    {7459}new Ns_6015: bitstring;
                                                    {7460}new ST_6016: bitstring;
                                                    {7461}new TTL_6017: bitstring;
                                                    {7462}let gNs_6018: bitstring = exp(g,Ns_6015) in
                                                    {7463}let m2_6019: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6018,ST_6016,TTL_6017) in
                                                    {7464}event beginSrv(Sess_5022,Cli_5020,gNs_6018);
                                                    {7465}out(c, m2_6019);
                                                    {7466}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7467}event endSrv(Cli_5020,Sess_5022,PartC_6014)
                                        )
                                        else
                                            {7468}let pkDisco_6020: bitstring = fail-any in
                                            {7469}in(c, (=pkCli_5971,em1_6021: bitstring));
                                            {7470}let m1_6022: bitstring = em1_6021 in
                                            {7471}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_6023: bitstring) = m1_6022 in
                                            {7472}new Ns_6024: bitstring;
                                            {7473}new ST_6025: bitstring;
                                            {7474}new TTL_6026: bitstring;
                                            {7475}let gNs_6027: bitstring = exp(g,Ns_6024) in
                                            {7476}let m2_6028: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6027,ST_6025,TTL_6026) in
                                            {7477}event beginSrv(Sess_5022,Cli_5020,gNs_6027);
                                            {7478}out(c, m2_6028);
                                            {7479}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {7480}event endSrv(Cli_5020,Sess_5022,PartC_6023)
                                )
                                else
                                    {7481}let pkDisco_6029: bitstring = fail-any in
                                    {7482}in(c, (=pkCli_5971,em1_6030: bitstring));
                                    {7483}let m1_6031: bitstring = em1_6030 in
                                    {7484}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_5971,PartC_6032: bitstring) = m1_6031 in
                                    {7485}new Ns_6033: bitstring;
                                    {7486}new ST_6034: bitstring;
                                    {7487}new TTL_6035: bitstring;
                                    {7488}let gNs_6036: bitstring = exp(g,Ns_6033) in
                                    {7489}let m2_6037: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6036,ST_6034,TTL_6035) in
                                    {7490}event beginSrv(Sess_5022,Cli_5020,gNs_6036);
                                    {7491}out(c, m2_6037);
                                    {7492}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {7493}event endSrv(Cli_5020,Sess_5022,PartC_6032)
                            )
                            else
                                {7494}let v_6038: bool = (Cli_5020 = B) in
                                (
                                    {7495}if v_6038 then
                                    (
                                        {7496}let pkCli_6039: bitstring = pub(skB) in
                                        {7497}let v_6040: bool = (Disco_5021 = A) in
                                        (
                                            {7498}if v_6040 then
                                            (
                                                {7499}let pkDisco_6041: bitstring = pub(skA) in
                                                {7500}in(c, (=pkCli_6039,em1_6042: bitstring));
                                                {7501}let m1_6043: bitstring = em1_6042 in
                                                {7502}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6044: bitstring) = m1_6043 in
                                                {7503}new Ns_6045: bitstring;
                                                {7504}new ST_6046: bitstring;
                                                {7505}new TTL_6047: bitstring;
                                                {7506}let gNs_6048: bitstring = exp(g,Ns_6045) in
                                                {7507}let m2_6049: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6048,ST_6046,TTL_6047) in
                                                {7508}event beginSrv(Sess_5022,Cli_5020,gNs_6048);
                                                {7509}out(c, m2_6049);
                                                {7510}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7511}event endSrv(Cli_5020,Sess_5022,PartC_6044)
                                            )
                                            else
                                                {7512}let v_6050: bool = (Disco_5021 = B) in
                                                (
                                                    {7513}if v_6050 then
                                                    (
                                                        {7514}let pkDisco_6051: bitstring = pub(skB) in
                                                        {7515}in(c, (=pkCli_6039,em1_6052: bitstring));
                                                        {7516}let m1_6053: bitstring = em1_6052 in
                                                        {7517}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6054: bitstring) = m1_6053 in
                                                        {7518}new Ns_6055: bitstring;
                                                        {7519}new ST_6056: bitstring;
                                                        {7520}new TTL_6057: bitstring;
                                                        {7521}let gNs_6058: bitstring = exp(g,Ns_6055) in
                                                        {7522}let m2_6059: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6058,ST_6056,TTL_6057) in
                                                        {7523}event beginSrv(Sess_5022,Cli_5020,gNs_6058);
                                                        {7524}out(c, m2_6059);
                                                        {7525}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7526}event endSrv(Cli_5020,Sess_5022,PartC_6054)
                                                    )
                                                    else
                                                        {7527}let v_6060: bool = (Disco_5021 = C) in
                                                        (
                                                            {7528}if v_6060 then
                                                            (
                                                                {7529}let pkDisco_6061: bitstring = pub(skC) in
                                                                {7530}in(c, (=pkCli_6039,em1_6062: bitstring));
                                                                {7531}let m1_6063: bitstring = em1_6062 in
                                                                {7532}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6064: bitstring) = m1_6063 in
                                                                {7533}new Ns_6065: bitstring;
                                                                {7534}new ST_6066: bitstring;
                                                                {7535}new TTL_6067: bitstring;
                                                                {7536}let gNs_6068: bitstring = exp(g,Ns_6065) in
                                                                {7537}let m2_6069: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6068,ST_6066,TTL_6067) in
                                                                {7538}event beginSrv(Sess_5022,Cli_5020,gNs_6068);
                                                                {7539}out(c, m2_6069);
                                                                {7540}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7541}event endSrv(Cli_5020,Sess_5022,PartC_6064)
                                                            )
                                                            else
                                                                {7542}let pkDisco_6070: bitstring = pub(sk(Disco_5021)) in
                                                                {7543}in(c, (=pkCli_6039,em1_6071: bitstring));
                                                                {7544}let m1_6072: bitstring = em1_6071 in
                                                                {7545}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6073: bitstring) = m1_6072 in
                                                                {7546}new Ns_6074: bitstring;
                                                                {7547}new ST_6075: bitstring;
                                                                {7548}new TTL_6076: bitstring;
                                                                {7549}let gNs_6077: bitstring = exp(g,Ns_6074) in
                                                                {7550}let m2_6078: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6077,ST_6075,TTL_6076) in
                                                                {7551}event beginSrv(Sess_5022,Cli_5020,gNs_6077);
                                                                {7552}out(c, m2_6078);
                                                                {7553}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7554}event endSrv(Cli_5020,Sess_5022,PartC_6073)
                                                        )
                                                        else
                                                            {7555}let pkDisco_6079: bitstring = fail-any in
                                                            {7556}in(c, (=pkCli_6039,em1_6080: bitstring));
                                                            {7557}let m1_6081: bitstring = em1_6080 in
                                                            {7558}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6082: bitstring) = m1_6081 in
                                                            {7559}new Ns_6083: bitstring;
                                                            {7560}new ST_6084: bitstring;
                                                            {7561}new TTL_6085: bitstring;
                                                            {7562}let gNs_6086: bitstring = exp(g,Ns_6083) in
                                                            {7563}let m2_6087: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6086,ST_6084,TTL_6085) in
                                                            {7564}event beginSrv(Sess_5022,Cli_5020,gNs_6086);
                                                            {7565}out(c, m2_6087);
                                                            {7566}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7567}event endSrv(Cli_5020,Sess_5022,PartC_6082)
                                                )
                                                else
                                                    {7568}let pkDisco_6088: bitstring = fail-any in
                                                    {7569}in(c, (=pkCli_6039,em1_6089: bitstring));
                                                    {7570}let m1_6090: bitstring = em1_6089 in
                                                    {7571}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6091: bitstring) = m1_6090 in
                                                    {7572}new Ns_6092: bitstring;
                                                    {7573}new ST_6093: bitstring;
                                                    {7574}new TTL_6094: bitstring;
                                                    {7575}let gNs_6095: bitstring = exp(g,Ns_6092) in
                                                    {7576}let m2_6096: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6095,ST_6093,TTL_6094) in
                                                    {7577}event beginSrv(Sess_5022,Cli_5020,gNs_6095);
                                                    {7578}out(c, m2_6096);
                                                    {7579}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7580}event endSrv(Cli_5020,Sess_5022,PartC_6091)
                                        )
                                        else
                                            {7581}let pkDisco_6097: bitstring = fail-any in
                                            {7582}in(c, (=pkCli_6039,em1_6098: bitstring));
                                            {7583}let m1_6099: bitstring = em1_6098 in
                                            {7584}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6039,PartC_6100: bitstring) = m1_6099 in
                                            {7585}new Ns_6101: bitstring;
                                            {7586}new ST_6102: bitstring;
                                            {7587}new TTL_6103: bitstring;
                                            {7588}let gNs_6104: bitstring = exp(g,Ns_6101) in
                                            {7589}let m2_6105: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6104,ST_6102,TTL_6103) in
                                            {7590}event beginSrv(Sess_5022,Cli_5020,gNs_6104);
                                            {7591}out(c, m2_6105);
                                            {7592}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {7593}event endSrv(Cli_5020,Sess_5022,PartC_6100)
                                    )
                                    else
                                        {7594}let v_6106: bool = (Cli_5020 = C) in
                                        (
                                            {7595}if v_6106 then
                                            (
                                                {7596}let pkCli_6107: bitstring = pub(skC) in
                                                {7597}let v_6108: bool = (Disco_5021 = A) in
                                                (
                                                    {7598}if v_6108 then
                                                    (
                                                        {7599}let pkDisco_6109: bitstring = pub(skA) in
                                                        {7600}in(c, (=pkCli_6107,em1_6110: bitstring));
                                                        {7601}let m1_6111: bitstring = em1_6110 in
                                                        {7602}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6112: bitstring) = m1_6111 in
                                                        {7603}new Ns_6113: bitstring;
                                                        {7604}new ST_6114: bitstring;
                                                        {7605}new TTL_6115: bitstring;
                                                        {7606}let gNs_6116: bitstring = exp(g,Ns_6113) in
                                                        {7607}let m2_6117: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6116,ST_6114,TTL_6115) in
                                                        {7608}event beginSrv(Sess_5022,Cli_5020,gNs_6116);
                                                        {7609}out(c, m2_6117);
                                                        {7610}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7611}event endSrv(Cli_5020,Sess_5022,PartC_6112)
                                                    )
                                                    else
                                                        {7612}let v_6118: bool = (Disco_5021 = B) in
                                                        (
                                                            {7613}if v_6118 then
                                                            (
                                                                {7614}let pkDisco_6119: bitstring = pub(skB) in
                                                                {7615}in(c, (=pkCli_6107,em1_6120: bitstring));
                                                                {7616}let m1_6121: bitstring = em1_6120 in
                                                                {7617}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6122: bitstring) = m1_6121 in
                                                                {7618}new Ns_6123: bitstring;
                                                                {7619}new ST_6124: bitstring;
                                                                {7620}new TTL_6125: bitstring;
                                                                {7621}let gNs_6126: bitstring = exp(g,Ns_6123) in
                                                                {7622}let m2_6127: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6126,ST_6124,TTL_6125) in
                                                                {7623}event beginSrv(Sess_5022,Cli_5020,gNs_6126);
                                                                {7624}out(c, m2_6127);
                                                                {7625}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7626}event endSrv(Cli_5020,Sess_5022,PartC_6122)
                                                            )
                                                            else
                                                                {7627}let v_6128: bool = (Disco_5021 = C) in
                                                                (
                                                                    {7628}if v_6128 then
                                                                    (
                                                                        {7629}let pkDisco_6129: bitstring = pub(skC) in
                                                                        {7630}in(c, (=pkCli_6107,em1_6130: bitstring));
                                                                        {7631}let m1_6131: bitstring = em1_6130 in
                                                                        {7632}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6132: bitstring) = m1_6131 in
                                                                        {7633}new Ns_6133: bitstring;
                                                                        {7634}new ST_6134: bitstring;
                                                                        {7635}new TTL_6135: bitstring;
                                                                        {7636}let gNs_6136: bitstring = exp(g,Ns_6133) in
                                                                        {7637}let m2_6137: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6136,ST_6134,TTL_6135) in
                                                                        {7638}event beginSrv(Sess_5022,Cli_5020,gNs_6136);
                                                                        {7639}out(c, m2_6137);
                                                                        {7640}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {7641}event endSrv(Cli_5020,Sess_5022,PartC_6132)
                                                                    )
                                                                    else
                                                                        {7642}let pkDisco_6138: bitstring = pub(sk(Disco_5021)) in
                                                                        {7643}in(c, (=pkCli_6107,em1_6139: bitstring));
                                                                        {7644}let m1_6140: bitstring = em1_6139 in
                                                                        {7645}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6141: bitstring) = m1_6140 in
                                                                        {7646}new Ns_6142: bitstring;
                                                                        {7647}new ST_6143: bitstring;
                                                                        {7648}new TTL_6144: bitstring;
                                                                        {7649}let gNs_6145: bitstring = exp(g,Ns_6142) in
                                                                        {7650}let m2_6146: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6145,ST_6143,TTL_6144) in
                                                                        {7651}event beginSrv(Sess_5022,Cli_5020,gNs_6145);
                                                                        {7652}out(c, m2_6146);
                                                                        {7653}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {7654}event endSrv(Cli_5020,Sess_5022,PartC_6141)
                                                                )
                                                                else
                                                                    {7655}let pkDisco_6147: bitstring = fail-any in
                                                                    {7656}in(c, (=pkCli_6107,em1_6148: bitstring));
                                                                    {7657}let m1_6149: bitstring = em1_6148 in
                                                                    {7658}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6150: bitstring) = m1_6149 in
                                                                    {7659}new Ns_6151: bitstring;
                                                                    {7660}new ST_6152: bitstring;
                                                                    {7661}new TTL_6153: bitstring;
                                                                    {7662}let gNs_6154: bitstring = exp(g,Ns_6151) in
                                                                    {7663}let m2_6155: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6154,ST_6152,TTL_6153) in
                                                                    {7664}event beginSrv(Sess_5022,Cli_5020,gNs_6154);
                                                                    {7665}out(c, m2_6155);
                                                                    {7666}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {7667}event endSrv(Cli_5020,Sess_5022,PartC_6150)
                                                        )
                                                        else
                                                            {7668}let pkDisco_6156: bitstring = fail-any in
                                                            {7669}in(c, (=pkCli_6107,em1_6157: bitstring));
                                                            {7670}let m1_6158: bitstring = em1_6157 in
                                                            {7671}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6159: bitstring) = m1_6158 in
                                                            {7672}new Ns_6160: bitstring;
                                                            {7673}new ST_6161: bitstring;
                                                            {7674}new TTL_6162: bitstring;
                                                            {7675}let gNs_6163: bitstring = exp(g,Ns_6160) in
                                                            {7676}let m2_6164: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6163,ST_6161,TTL_6162) in
                                                            {7677}event beginSrv(Sess_5022,Cli_5020,gNs_6163);
                                                            {7678}out(c, m2_6164);
                                                            {7679}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7680}event endSrv(Cli_5020,Sess_5022,PartC_6159)
                                                )
                                                else
                                                    {7681}let pkDisco_6165: bitstring = fail-any in
                                                    {7682}in(c, (=pkCli_6107,em1_6166: bitstring));
                                                    {7683}let m1_6167: bitstring = em1_6166 in
                                                    {7684}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6107,PartC_6168: bitstring) = m1_6167 in
                                                    {7685}new Ns_6169: bitstring;
                                                    {7686}new ST_6170: bitstring;
                                                    {7687}new TTL_6171: bitstring;
                                                    {7688}let gNs_6172: bitstring = exp(g,Ns_6169) in
                                                    {7689}let m2_6173: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6172,ST_6170,TTL_6171) in
                                                    {7690}event beginSrv(Sess_5022,Cli_5020,gNs_6172);
                                                    {7691}out(c, m2_6173);
                                                    {7692}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7693}event endSrv(Cli_5020,Sess_5022,PartC_6168)
                                            )
                                            else
                                                {7694}let pkCli_6174: bitstring = pub(sk(Cli_5020)) in
                                                {7695}let v_6175: bool = (Disco_5021 = A) in
                                                (
                                                    {7696}if v_6175 then
                                                    (
                                                        {7697}let pkDisco_6176: bitstring = pub(skA) in
                                                        {7698}in(c, (=pkCli_6174,em1_6177: bitstring));
                                                        {7699}let m1_6178: bitstring = em1_6177 in
                                                        {7700}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6179: bitstring) = m1_6178 in
                                                        {7701}new Ns_6180: bitstring;
                                                        {7702}new ST_6181: bitstring;
                                                        {7703}new TTL_6182: bitstring;
                                                        {7704}let gNs_6183: bitstring = exp(g,Ns_6180) in
                                                        {7705}let m2_6184: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6183,ST_6181,TTL_6182) in
                                                        {7706}event beginSrv(Sess_5022,Cli_5020,gNs_6183);
                                                        {7707}out(c, m2_6184);
                                                        {7708}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7709}event endSrv(Cli_5020,Sess_5022,PartC_6179)
                                                    )
                                                    else
                                                        {7710}let v_6185: bool = (Disco_5021 = B) in
                                                        (
                                                            {7711}if v_6185 then
                                                            (
                                                                {7712}let pkDisco_6186: bitstring = pub(skB) in
                                                                {7713}in(c, (=pkCli_6174,em1_6187: bitstring));
                                                                {7714}let m1_6188: bitstring = em1_6187 in
                                                                {7715}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6189: bitstring) = m1_6188 in
                                                                {7716}new Ns_6190: bitstring;
                                                                {7717}new ST_6191: bitstring;
                                                                {7718}new TTL_6192: bitstring;
                                                                {7719}let gNs_6193: bitstring = exp(g,Ns_6190) in
                                                                {7720}let m2_6194: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6193,ST_6191,TTL_6192) in
                                                                {7721}event beginSrv(Sess_5022,Cli_5020,gNs_6193);
                                                                {7722}out(c, m2_6194);
                                                                {7723}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7724}event endSrv(Cli_5020,Sess_5022,PartC_6189)
                                                            )
                                                            else
                                                                {7725}let v_6195: bool = (Disco_5021 = C) in
                                                                (
                                                                    {7726}if v_6195 then
                                                                    (
                                                                        {7727}let pkDisco_6196: bitstring = pub(skC) in
                                                                        {7728}in(c, (=pkCli_6174,em1_6197: bitstring));
                                                                        {7729}let m1_6198: bitstring = em1_6197 in
                                                                        {7730}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6199: bitstring) = m1_6198 in
                                                                        {7731}new Ns_6200: bitstring;
                                                                        {7732}new ST_6201: bitstring;
                                                                        {7733}new TTL_6202: bitstring;
                                                                        {7734}let gNs_6203: bitstring = exp(g,Ns_6200) in
                                                                        {7735}let m2_6204: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6203,ST_6201,TTL_6202) in
                                                                        {7736}event beginSrv(Sess_5022,Cli_5020,gNs_6203);
                                                                        {7737}out(c, m2_6204);
                                                                        {7738}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {7739}event endSrv(Cli_5020,Sess_5022,PartC_6199)
                                                                    )
                                                                    else
                                                                        {7740}let pkDisco_6205: bitstring = pub(sk(Disco_5021)) in
                                                                        {7741}in(c, (=pkCli_6174,em1_6206: bitstring));
                                                                        {7742}let m1_6207: bitstring = em1_6206 in
                                                                        {7743}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6208: bitstring) = m1_6207 in
                                                                        {7744}new Ns_6209: bitstring;
                                                                        {7745}new ST_6210: bitstring;
                                                                        {7746}new TTL_6211: bitstring;
                                                                        {7747}let gNs_6212: bitstring = exp(g,Ns_6209) in
                                                                        {7748}let m2_6213: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6212,ST_6210,TTL_6211) in
                                                                        {7749}event beginSrv(Sess_5022,Cli_5020,gNs_6212);
                                                                        {7750}out(c, m2_6213);
                                                                        {7751}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {7752}event endSrv(Cli_5020,Sess_5022,PartC_6208)
                                                                )
                                                                else
                                                                    {7753}let pkDisco_6214: bitstring = fail-any in
                                                                    {7754}in(c, (=pkCli_6174,em1_6215: bitstring));
                                                                    {7755}let m1_6216: bitstring = em1_6215 in
                                                                    {7756}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6217: bitstring) = m1_6216 in
                                                                    {7757}new Ns_6218: bitstring;
                                                                    {7758}new ST_6219: bitstring;
                                                                    {7759}new TTL_6220: bitstring;
                                                                    {7760}let gNs_6221: bitstring = exp(g,Ns_6218) in
                                                                    {7761}let m2_6222: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6221,ST_6219,TTL_6220) in
                                                                    {7762}event beginSrv(Sess_5022,Cli_5020,gNs_6221);
                                                                    {7763}out(c, m2_6222);
                                                                    {7764}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {7765}event endSrv(Cli_5020,Sess_5022,PartC_6217)
                                                        )
                                                        else
                                                            {7766}let pkDisco_6223: bitstring = fail-any in
                                                            {7767}in(c, (=pkCli_6174,em1_6224: bitstring));
                                                            {7768}let m1_6225: bitstring = em1_6224 in
                                                            {7769}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6226: bitstring) = m1_6225 in
                                                            {7770}new Ns_6227: bitstring;
                                                            {7771}new ST_6228: bitstring;
                                                            {7772}new TTL_6229: bitstring;
                                                            {7773}let gNs_6230: bitstring = exp(g,Ns_6227) in
                                                            {7774}let m2_6231: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6230,ST_6228,TTL_6229) in
                                                            {7775}event beginSrv(Sess_5022,Cli_5020,gNs_6230);
                                                            {7776}out(c, m2_6231);
                                                            {7777}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7778}event endSrv(Cli_5020,Sess_5022,PartC_6226)
                                                )
                                                else
                                                    {7779}let pkDisco_6232: bitstring = fail-any in
                                                    {7780}in(c, (=pkCli_6174,em1_6233: bitstring));
                                                    {7781}let m1_6234: bitstring = em1_6233 in
                                                    {7782}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6174,PartC_6235: bitstring) = m1_6234 in
                                                    {7783}new Ns_6236: bitstring;
                                                    {7784}new ST_6237: bitstring;
                                                    {7785}new TTL_6238: bitstring;
                                                    {7786}let gNs_6239: bitstring = exp(g,Ns_6236) in
                                                    {7787}let m2_6240: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6239,ST_6237,TTL_6238) in
                                                    {7788}event beginSrv(Sess_5022,Cli_5020,gNs_6239);
                                                    {7789}out(c, m2_6240);
                                                    {7790}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7791}event endSrv(Cli_5020,Sess_5022,PartC_6235)
                                        )
                                        else
                                            {7792}let pkCli_6241: bitstring = fail-any in
                                            {7793}let v_6242: bool = (Disco_5021 = A) in
                                            (
                                                {7794}if v_6242 then
                                                (
                                                    {7795}let pkDisco_6243: bitstring = pub(skA) in
                                                    {7796}in(c, (=pkCli_6241,em1_6244: bitstring));
                                                    {7797}let m1_6245: bitstring = em1_6244 in
                                                    {7798}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6246: bitstring) = m1_6245 in
                                                    {7799}new Ns_6247: bitstring;
                                                    {7800}new ST_6248: bitstring;
                                                    {7801}new TTL_6249: bitstring;
                                                    {7802}let gNs_6250: bitstring = exp(g,Ns_6247) in
                                                    {7803}let m2_6251: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6250,ST_6248,TTL_6249) in
                                                    {7804}event beginSrv(Sess_5022,Cli_5020,gNs_6250);
                                                    {7805}out(c, m2_6251);
                                                    {7806}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7807}event endSrv(Cli_5020,Sess_5022,PartC_6246)
                                                )
                                                else
                                                    {7808}let v_6252: bool = (Disco_5021 = B) in
                                                    (
                                                        {7809}if v_6252 then
                                                        (
                                                            {7810}let pkDisco_6253: bitstring = pub(skB) in
                                                            {7811}in(c, (=pkCli_6241,em1_6254: bitstring));
                                                            {7812}let m1_6255: bitstring = em1_6254 in
                                                            {7813}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6256: bitstring) = m1_6255 in
                                                            {7814}new Ns_6257: bitstring;
                                                            {7815}new ST_6258: bitstring;
                                                            {7816}new TTL_6259: bitstring;
                                                            {7817}let gNs_6260: bitstring = exp(g,Ns_6257) in
                                                            {7818}let m2_6261: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6260,ST_6258,TTL_6259) in
                                                            {7819}event beginSrv(Sess_5022,Cli_5020,gNs_6260);
                                                            {7820}out(c, m2_6261);
                                                            {7821}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7822}event endSrv(Cli_5020,Sess_5022,PartC_6256)
                                                        )
                                                        else
                                                            {7823}let v_6262: bool = (Disco_5021 = C) in
                                                            (
                                                                {7824}if v_6262 then
                                                                (
                                                                    {7825}let pkDisco_6263: bitstring = pub(skC) in
                                                                    {7826}in(c, (=pkCli_6241,em1_6264: bitstring));
                                                                    {7827}let m1_6265: bitstring = em1_6264 in
                                                                    {7828}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6266: bitstring) = m1_6265 in
                                                                    {7829}new Ns_6267: bitstring;
                                                                    {7830}new ST_6268: bitstring;
                                                                    {7831}new TTL_6269: bitstring;
                                                                    {7832}let gNs_6270: bitstring = exp(g,Ns_6267) in
                                                                    {7833}let m2_6271: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6270,ST_6268,TTL_6269) in
                                                                    {7834}event beginSrv(Sess_5022,Cli_5020,gNs_6270);
                                                                    {7835}out(c, m2_6271);
                                                                    {7836}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {7837}event endSrv(Cli_5020,Sess_5022,PartC_6266)
                                                                )
                                                                else
                                                                    {7838}let pkDisco_6272: bitstring = pub(sk(Disco_5021)) in
                                                                    {7839}in(c, (=pkCli_6241,em1_6273: bitstring));
                                                                    {7840}let m1_6274: bitstring = em1_6273 in
                                                                    {7841}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6275: bitstring) = m1_6274 in
                                                                    {7842}new Ns_6276: bitstring;
                                                                    {7843}new ST_6277: bitstring;
                                                                    {7844}new TTL_6278: bitstring;
                                                                    {7845}let gNs_6279: bitstring = exp(g,Ns_6276) in
                                                                    {7846}let m2_6280: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6279,ST_6277,TTL_6278) in
                                                                    {7847}event beginSrv(Sess_5022,Cli_5020,gNs_6279);
                                                                    {7848}out(c, m2_6280);
                                                                    {7849}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {7850}event endSrv(Cli_5020,Sess_5022,PartC_6275)
                                                            )
                                                            else
                                                                {7851}let pkDisco_6281: bitstring = fail-any in
                                                                {7852}in(c, (=pkCli_6241,em1_6282: bitstring));
                                                                {7853}let m1_6283: bitstring = em1_6282 in
                                                                {7854}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6284: bitstring) = m1_6283 in
                                                                {7855}new Ns_6285: bitstring;
                                                                {7856}new ST_6286: bitstring;
                                                                {7857}new TTL_6287: bitstring;
                                                                {7858}let gNs_6288: bitstring = exp(g,Ns_6285) in
                                                                {7859}let m2_6289: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6288,ST_6286,TTL_6287) in
                                                                {7860}event beginSrv(Sess_5022,Cli_5020,gNs_6288);
                                                                {7861}out(c, m2_6289);
                                                                {7862}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {7863}event endSrv(Cli_5020,Sess_5022,PartC_6284)
                                                    )
                                                    else
                                                        {7864}let pkDisco_6290: bitstring = fail-any in
                                                        {7865}in(c, (=pkCli_6241,em1_6291: bitstring));
                                                        {7866}let m1_6292: bitstring = em1_6291 in
                                                        {7867}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6293: bitstring) = m1_6292 in
                                                        {7868}new Ns_6294: bitstring;
                                                        {7869}new ST_6295: bitstring;
                                                        {7870}new TTL_6296: bitstring;
                                                        {7871}let gNs_6297: bitstring = exp(g,Ns_6294) in
                                                        {7872}let m2_6298: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6297,ST_6295,TTL_6296) in
                                                        {7873}event beginSrv(Sess_5022,Cli_5020,gNs_6297);
                                                        {7874}out(c, m2_6298);
                                                        {7875}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7876}event endSrv(Cli_5020,Sess_5022,PartC_6293)
                                            )
                                            else
                                                {7877}let pkDisco_6299: bitstring = fail-any in
                                                {7878}in(c, (=pkCli_6241,em1_6300: bitstring));
                                                {7879}let m1_6301: bitstring = em1_6300 in
                                                {7880}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6241,PartC_6302: bitstring) = m1_6301 in
                                                {7881}new Ns_6303: bitstring;
                                                {7882}new ST_6304: bitstring;
                                                {7883}new TTL_6305: bitstring;
                                                {7884}let gNs_6306: bitstring = exp(g,Ns_6303) in
                                                {7885}let m2_6307: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6306,ST_6304,TTL_6305) in
                                                {7886}event beginSrv(Sess_5022,Cli_5020,gNs_6306);
                                                {7887}out(c, m2_6307);
                                                {7888}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7889}event endSrv(Cli_5020,Sess_5022,PartC_6302)
                                )
                                else
                                    {7890}let pkCli_6308: bitstring = fail-any in
                                    {7891}let v_6309: bool = (Disco_5021 = A) in
                                    (
                                        {7892}if v_6309 then
                                        (
                                            {7893}let pkDisco_6310: bitstring = pub(skA) in
                                            {7894}in(c, (=pkCli_6308,em1_6311: bitstring));
                                            {7895}let m1_6312: bitstring = em1_6311 in
                                            {7896}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6313: bitstring) = m1_6312 in
                                            {7897}new Ns_6314: bitstring;
                                            {7898}new ST_6315: bitstring;
                                            {7899}new TTL_6316: bitstring;
                                            {7900}let gNs_6317: bitstring = exp(g,Ns_6314) in
                                            {7901}let m2_6318: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6317,ST_6315,TTL_6316) in
                                            {7902}event beginSrv(Sess_5022,Cli_5020,gNs_6317);
                                            {7903}out(c, m2_6318);
                                            {7904}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {7905}event endSrv(Cli_5020,Sess_5022,PartC_6313)
                                        )
                                        else
                                            {7906}let v_6319: bool = (Disco_5021 = B) in
                                            (
                                                {7907}if v_6319 then
                                                (
                                                    {7908}let pkDisco_6320: bitstring = pub(skB) in
                                                    {7909}in(c, (=pkCli_6308,em1_6321: bitstring));
                                                    {7910}let m1_6322: bitstring = em1_6321 in
                                                    {7911}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6323: bitstring) = m1_6322 in
                                                    {7912}new Ns_6324: bitstring;
                                                    {7913}new ST_6325: bitstring;
                                                    {7914}new TTL_6326: bitstring;
                                                    {7915}let gNs_6327: bitstring = exp(g,Ns_6324) in
                                                    {7916}let m2_6328: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6327,ST_6325,TTL_6326) in
                                                    {7917}event beginSrv(Sess_5022,Cli_5020,gNs_6327);
                                                    {7918}out(c, m2_6328);
                                                    {7919}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {7920}event endSrv(Cli_5020,Sess_5022,PartC_6323)
                                                )
                                                else
                                                    {7921}let v_6329: bool = (Disco_5021 = C) in
                                                    (
                                                        {7922}if v_6329 then
                                                        (
                                                            {7923}let pkDisco_6330: bitstring = pub(skC) in
                                                            {7924}in(c, (=pkCli_6308,em1_6331: bitstring));
                                                            {7925}let m1_6332: bitstring = em1_6331 in
                                                            {7926}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6333: bitstring) = m1_6332 in
                                                            {7927}new Ns_6334: bitstring;
                                                            {7928}new ST_6335: bitstring;
                                                            {7929}new TTL_6336: bitstring;
                                                            {7930}let gNs_6337: bitstring = exp(g,Ns_6334) in
                                                            {7931}let m2_6338: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6337,ST_6335,TTL_6336) in
                                                            {7932}event beginSrv(Sess_5022,Cli_5020,gNs_6337);
                                                            {7933}out(c, m2_6338);
                                                            {7934}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7935}event endSrv(Cli_5020,Sess_5022,PartC_6333)
                                                        )
                                                        else
                                                            {7936}let pkDisco_6339: bitstring = pub(sk(Disco_5021)) in
                                                            {7937}in(c, (=pkCli_6308,em1_6340: bitstring));
                                                            {7938}let m1_6341: bitstring = em1_6340 in
                                                            {7939}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6342: bitstring) = m1_6341 in
                                                            {7940}new Ns_6343: bitstring;
                                                            {7941}new ST_6344: bitstring;
                                                            {7942}new TTL_6345: bitstring;
                                                            {7943}let gNs_6346: bitstring = exp(g,Ns_6343) in
                                                            {7944}let m2_6347: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6346,ST_6344,TTL_6345) in
                                                            {7945}event beginSrv(Sess_5022,Cli_5020,gNs_6346);
                                                            {7946}out(c, m2_6347);
                                                            {7947}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {7948}event endSrv(Cli_5020,Sess_5022,PartC_6342)
                                                    )
                                                    else
                                                        {7949}let pkDisco_6348: bitstring = fail-any in
                                                        {7950}in(c, (=pkCli_6308,em1_6349: bitstring));
                                                        {7951}let m1_6350: bitstring = em1_6349 in
                                                        {7952}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6351: bitstring) = m1_6350 in
                                                        {7953}new Ns_6352: bitstring;
                                                        {7954}new ST_6353: bitstring;
                                                        {7955}new TTL_6354: bitstring;
                                                        {7956}let gNs_6355: bitstring = exp(g,Ns_6352) in
                                                        {7957}let m2_6356: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6355,ST_6353,TTL_6354) in
                                                        {7958}event beginSrv(Sess_5022,Cli_5020,gNs_6355);
                                                        {7959}out(c, m2_6356);
                                                        {7960}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {7961}event endSrv(Cli_5020,Sess_5022,PartC_6351)
                                            )
                                            else
                                                {7962}let pkDisco_6357: bitstring = fail-any in
                                                {7963}in(c, (=pkCli_6308,em1_6358: bitstring));
                                                {7964}let m1_6359: bitstring = em1_6358 in
                                                {7965}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6360: bitstring) = m1_6359 in
                                                {7966}new Ns_6361: bitstring;
                                                {7967}new ST_6362: bitstring;
                                                {7968}new TTL_6363: bitstring;
                                                {7969}let gNs_6364: bitstring = exp(g,Ns_6361) in
                                                {7970}let m2_6365: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6364,ST_6362,TTL_6363) in
                                                {7971}event beginSrv(Sess_5022,Cli_5020,gNs_6364);
                                                {7972}out(c, m2_6365);
                                                {7973}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {7974}event endSrv(Cli_5020,Sess_5022,PartC_6360)
                                    )
                                    else
                                        {7975}let pkDisco_6366: bitstring = fail-any in
                                        {7976}in(c, (=pkCli_6308,em1_6367: bitstring));
                                        {7977}let m1_6368: bitstring = em1_6367 in
                                        {7978}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6308,PartC_6369: bitstring) = m1_6368 in
                                        {7979}new Ns_6370: bitstring;
                                        {7980}new ST_6371: bitstring;
                                        {7981}new TTL_6372: bitstring;
                                        {7982}let gNs_6373: bitstring = exp(g,Ns_6370) in
                                        {7983}let m2_6374: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6373,ST_6371,TTL_6372) in
                                        {7984}event beginSrv(Sess_5022,Cli_5020,gNs_6373);
                                        {7985}out(c, m2_6374);
                                        {7986}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {7987}event endSrv(Cli_5020,Sess_5022,PartC_6369)
                        )
                        else
                            {7988}let pkCli_6375: bitstring = fail-any in
                            {7989}let v_6376: bool = (Disco_5021 = A) in
                            (
                                {7990}if v_6376 then
                                (
                                    {7991}let pkDisco_6377: bitstring = pub(skA) in
                                    {7992}in(c, (=pkCli_6375,em1_6378: bitstring));
                                    {7993}let m1_6379: bitstring = em1_6378 in
                                    {7994}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6380: bitstring) = m1_6379 in
                                    {7995}new Ns_6381: bitstring;
                                    {7996}new ST_6382: bitstring;
                                    {7997}new TTL_6383: bitstring;
                                    {7998}let gNs_6384: bitstring = exp(g,Ns_6381) in
                                    {7999}let m2_6385: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6384,ST_6382,TTL_6383) in
                                    {8000}event beginSrv(Sess_5022,Cli_5020,gNs_6384);
                                    {8001}out(c, m2_6385);
                                    {8002}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {8003}event endSrv(Cli_5020,Sess_5022,PartC_6380)
                                )
                                else
                                    {8004}let v_6386: bool = (Disco_5021 = B) in
                                    (
                                        {8005}if v_6386 then
                                        (
                                            {8006}let pkDisco_6387: bitstring = pub(skB) in
                                            {8007}in(c, (=pkCli_6375,em1_6388: bitstring));
                                            {8008}let m1_6389: bitstring = em1_6388 in
                                            {8009}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6390: bitstring) = m1_6389 in
                                            {8010}new Ns_6391: bitstring;
                                            {8011}new ST_6392: bitstring;
                                            {8012}new TTL_6393: bitstring;
                                            {8013}let gNs_6394: bitstring = exp(g,Ns_6391) in
                                            {8014}let m2_6395: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6394,ST_6392,TTL_6393) in
                                            {8015}event beginSrv(Sess_5022,Cli_5020,gNs_6394);
                                            {8016}out(c, m2_6395);
                                            {8017}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8018}event endSrv(Cli_5020,Sess_5022,PartC_6390)
                                        )
                                        else
                                            {8019}let v_6396: bool = (Disco_5021 = C) in
                                            (
                                                {8020}if v_6396 then
                                                (
                                                    {8021}let pkDisco_6397: bitstring = pub(skC) in
                                                    {8022}in(c, (=pkCli_6375,em1_6398: bitstring));
                                                    {8023}let m1_6399: bitstring = em1_6398 in
                                                    {8024}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6400: bitstring) = m1_6399 in
                                                    {8025}new Ns_6401: bitstring;
                                                    {8026}new ST_6402: bitstring;
                                                    {8027}new TTL_6403: bitstring;
                                                    {8028}let gNs_6404: bitstring = exp(g,Ns_6401) in
                                                    {8029}let m2_6405: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6404,ST_6402,TTL_6403) in
                                                    {8030}event beginSrv(Sess_5022,Cli_5020,gNs_6404);
                                                    {8031}out(c, m2_6405);
                                                    {8032}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8033}event endSrv(Cli_5020,Sess_5022,PartC_6400)
                                                )
                                                else
                                                    {8034}let pkDisco_6406: bitstring = pub(sk(Disco_5021)) in
                                                    {8035}in(c, (=pkCli_6375,em1_6407: bitstring));
                                                    {8036}let m1_6408: bitstring = em1_6407 in
                                                    {8037}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6409: bitstring) = m1_6408 in
                                                    {8038}new Ns_6410: bitstring;
                                                    {8039}new ST_6411: bitstring;
                                                    {8040}new TTL_6412: bitstring;
                                                    {8041}let gNs_6413: bitstring = exp(g,Ns_6410) in
                                                    {8042}let m2_6414: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6413,ST_6411,TTL_6412) in
                                                    {8043}event beginSrv(Sess_5022,Cli_5020,gNs_6413);
                                                    {8044}out(c, m2_6414);
                                                    {8045}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8046}event endSrv(Cli_5020,Sess_5022,PartC_6409)
                                            )
                                            else
                                                {8047}let pkDisco_6415: bitstring = fail-any in
                                                {8048}in(c, (=pkCli_6375,em1_6416: bitstring));
                                                {8049}let m1_6417: bitstring = em1_6416 in
                                                {8050}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6418: bitstring) = m1_6417 in
                                                {8051}new Ns_6419: bitstring;
                                                {8052}new ST_6420: bitstring;
                                                {8053}new TTL_6421: bitstring;
                                                {8054}let gNs_6422: bitstring = exp(g,Ns_6419) in
                                                {8055}let m2_6423: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6422,ST_6420,TTL_6421) in
                                                {8056}event beginSrv(Sess_5022,Cli_5020,gNs_6422);
                                                {8057}out(c, m2_6423);
                                                {8058}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8059}event endSrv(Cli_5020,Sess_5022,PartC_6418)
                                    )
                                    else
                                        {8060}let pkDisco_6424: bitstring = fail-any in
                                        {8061}in(c, (=pkCli_6375,em1_6425: bitstring));
                                        {8062}let m1_6426: bitstring = em1_6425 in
                                        {8063}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6427: bitstring) = m1_6426 in
                                        {8064}new Ns_6428: bitstring;
                                        {8065}new ST_6429: bitstring;
                                        {8066}new TTL_6430: bitstring;
                                        {8067}let gNs_6431: bitstring = exp(g,Ns_6428) in
                                        {8068}let m2_6432: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6431,ST_6429,TTL_6430) in
                                        {8069}event beginSrv(Sess_5022,Cli_5020,gNs_6431);
                                        {8070}out(c, m2_6432);
                                        {8071}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {8072}event endSrv(Cli_5020,Sess_5022,PartC_6427)
                            )
                            else
                                {8073}let pkDisco_6433: bitstring = fail-any in
                                {8074}in(c, (=pkCli_6375,em1_6434: bitstring));
                                {8075}let m1_6435: bitstring = em1_6434 in
                                {8076}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6375,PartC_6436: bitstring) = m1_6435 in
                                {8077}new Ns_6437: bitstring;
                                {8078}new ST_6438: bitstring;
                                {8079}new TTL_6439: bitstring;
                                {8080}let gNs_6440: bitstring = exp(g,Ns_6437) in
                                {8081}let m2_6441: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6440,ST_6438,TTL_6439) in
                                {8082}event beginSrv(Sess_5022,Cli_5020,gNs_6440);
                                {8083}out(c, m2_6441);
                                {8084}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {8085}event endSrv(Cli_5020,Sess_5022,PartC_6436)
                    )
                    else
                        {8086}let skSess_6442: bitstring = fail-any in
                        {8087}let pkSess_6443: bitstring = pub(skSess_6442) in
                        {8088}let v_6444: bool = (Cli_5020 = A) in
                        (
                            {8089}if v_6444 then
                            (
                                {8090}let pkCli_6445: bitstring = pub(skA) in
                                {8091}let v_6446: bool = (Disco_5021 = A) in
                                (
                                    {8092}if v_6446 then
                                    (
                                        {8093}let pkDisco_6447: bitstring = pub(skA) in
                                        {8094}in(c, (=pkCli_6445,em1_6448: bitstring));
                                        {8095}let m1_6449: bitstring = em1_6448 in
                                        {8096}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6450: bitstring) = m1_6449 in
                                        {8097}new Ns_6451: bitstring;
                                        {8098}new ST_6452: bitstring;
                                        {8099}new TTL_6453: bitstring;
                                        {8100}let gNs_6454: bitstring = exp(g,Ns_6451) in
                                        {8101}let m2_6455: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6454,ST_6452,TTL_6453) in
                                        {8102}event beginSrv(Sess_5022,Cli_5020,gNs_6454);
                                        {8103}out(c, m2_6455);
                                        {8104}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {8105}event endSrv(Cli_5020,Sess_5022,PartC_6450)
                                    )
                                    else
                                        {8106}let v_6456: bool = (Disco_5021 = B) in
                                        (
                                            {8107}if v_6456 then
                                            (
                                                {8108}let pkDisco_6457: bitstring = pub(skB) in
                                                {8109}in(c, (=pkCli_6445,em1_6458: bitstring));
                                                {8110}let m1_6459: bitstring = em1_6458 in
                                                {8111}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6460: bitstring) = m1_6459 in
                                                {8112}new Ns_6461: bitstring;
                                                {8113}new ST_6462: bitstring;
                                                {8114}new TTL_6463: bitstring;
                                                {8115}let gNs_6464: bitstring = exp(g,Ns_6461) in
                                                {8116}let m2_6465: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6464,ST_6462,TTL_6463) in
                                                {8117}event beginSrv(Sess_5022,Cli_5020,gNs_6464);
                                                {8118}out(c, m2_6465);
                                                {8119}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8120}event endSrv(Cli_5020,Sess_5022,PartC_6460)
                                            )
                                            else
                                                {8121}let v_6466: bool = (Disco_5021 = C) in
                                                (
                                                    {8122}if v_6466 then
                                                    (
                                                        {8123}let pkDisco_6467: bitstring = pub(skC) in
                                                        {8124}in(c, (=pkCli_6445,em1_6468: bitstring));
                                                        {8125}let m1_6469: bitstring = em1_6468 in
                                                        {8126}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6470: bitstring) = m1_6469 in
                                                        {8127}new Ns_6471: bitstring;
                                                        {8128}new ST_6472: bitstring;
                                                        {8129}new TTL_6473: bitstring;
                                                        {8130}let gNs_6474: bitstring = exp(g,Ns_6471) in
                                                        {8131}let m2_6475: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6474,ST_6472,TTL_6473) in
                                                        {8132}event beginSrv(Sess_5022,Cli_5020,gNs_6474);
                                                        {8133}out(c, m2_6475);
                                                        {8134}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8135}event endSrv(Cli_5020,Sess_5022,PartC_6470)
                                                    )
                                                    else
                                                        {8136}let pkDisco_6476: bitstring = pub(sk(Disco_5021)) in
                                                        {8137}in(c, (=pkCli_6445,em1_6477: bitstring));
                                                        {8138}let m1_6478: bitstring = em1_6477 in
                                                        {8139}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6479: bitstring) = m1_6478 in
                                                        {8140}new Ns_6480: bitstring;
                                                        {8141}new ST_6481: bitstring;
                                                        {8142}new TTL_6482: bitstring;
                                                        {8143}let gNs_6483: bitstring = exp(g,Ns_6480) in
                                                        {8144}let m2_6484: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6483,ST_6481,TTL_6482) in
                                                        {8145}event beginSrv(Sess_5022,Cli_5020,gNs_6483);
                                                        {8146}out(c, m2_6484);
                                                        {8147}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8148}event endSrv(Cli_5020,Sess_5022,PartC_6479)
                                                )
                                                else
                                                    {8149}let pkDisco_6485: bitstring = fail-any in
                                                    {8150}in(c, (=pkCli_6445,em1_6486: bitstring));
                                                    {8151}let m1_6487: bitstring = em1_6486 in
                                                    {8152}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6488: bitstring) = m1_6487 in
                                                    {8153}new Ns_6489: bitstring;
                                                    {8154}new ST_6490: bitstring;
                                                    {8155}new TTL_6491: bitstring;
                                                    {8156}let gNs_6492: bitstring = exp(g,Ns_6489) in
                                                    {8157}let m2_6493: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6492,ST_6490,TTL_6491) in
                                                    {8158}event beginSrv(Sess_5022,Cli_5020,gNs_6492);
                                                    {8159}out(c, m2_6493);
                                                    {8160}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8161}event endSrv(Cli_5020,Sess_5022,PartC_6488)
                                        )
                                        else
                                            {8162}let pkDisco_6494: bitstring = fail-any in
                                            {8163}in(c, (=pkCli_6445,em1_6495: bitstring));
                                            {8164}let m1_6496: bitstring = em1_6495 in
                                            {8165}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6497: bitstring) = m1_6496 in
                                            {8166}new Ns_6498: bitstring;
                                            {8167}new ST_6499: bitstring;
                                            {8168}new TTL_6500: bitstring;
                                            {8169}let gNs_6501: bitstring = exp(g,Ns_6498) in
                                            {8170}let m2_6502: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6501,ST_6499,TTL_6500) in
                                            {8171}event beginSrv(Sess_5022,Cli_5020,gNs_6501);
                                            {8172}out(c, m2_6502);
                                            {8173}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8174}event endSrv(Cli_5020,Sess_5022,PartC_6497)
                                )
                                else
                                    {8175}let pkDisco_6503: bitstring = fail-any in
                                    {8176}in(c, (=pkCli_6445,em1_6504: bitstring));
                                    {8177}let m1_6505: bitstring = em1_6504 in
                                    {8178}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6445,PartC_6506: bitstring) = m1_6505 in
                                    {8179}new Ns_6507: bitstring;
                                    {8180}new ST_6508: bitstring;
                                    {8181}new TTL_6509: bitstring;
                                    {8182}let gNs_6510: bitstring = exp(g,Ns_6507) in
                                    {8183}let m2_6511: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6510,ST_6508,TTL_6509) in
                                    {8184}event beginSrv(Sess_5022,Cli_5020,gNs_6510);
                                    {8185}out(c, m2_6511);
                                    {8186}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {8187}event endSrv(Cli_5020,Sess_5022,PartC_6506)
                            )
                            else
                                {8188}let v_6512: bool = (Cli_5020 = B) in
                                (
                                    {8189}if v_6512 then
                                    (
                                        {8190}let pkCli_6513: bitstring = pub(skB) in
                                        {8191}let v_6514: bool = (Disco_5021 = A) in
                                        (
                                            {8192}if v_6514 then
                                            (
                                                {8193}let pkDisco_6515: bitstring = pub(skA) in
                                                {8194}in(c, (=pkCli_6513,em1_6516: bitstring));
                                                {8195}let m1_6517: bitstring = em1_6516 in
                                                {8196}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6518: bitstring) = m1_6517 in
                                                {8197}new Ns_6519: bitstring;
                                                {8198}new ST_6520: bitstring;
                                                {8199}new TTL_6521: bitstring;
                                                {8200}let gNs_6522: bitstring = exp(g,Ns_6519) in
                                                {8201}let m2_6523: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6522,ST_6520,TTL_6521) in
                                                {8202}event beginSrv(Sess_5022,Cli_5020,gNs_6522);
                                                {8203}out(c, m2_6523);
                                                {8204}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8205}event endSrv(Cli_5020,Sess_5022,PartC_6518)
                                            )
                                            else
                                                {8206}let v_6524: bool = (Disco_5021 = B) in
                                                (
                                                    {8207}if v_6524 then
                                                    (
                                                        {8208}let pkDisco_6525: bitstring = pub(skB) in
                                                        {8209}in(c, (=pkCli_6513,em1_6526: bitstring));
                                                        {8210}let m1_6527: bitstring = em1_6526 in
                                                        {8211}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6528: bitstring) = m1_6527 in
                                                        {8212}new Ns_6529: bitstring;
                                                        {8213}new ST_6530: bitstring;
                                                        {8214}new TTL_6531: bitstring;
                                                        {8215}let gNs_6532: bitstring = exp(g,Ns_6529) in
                                                        {8216}let m2_6533: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6532,ST_6530,TTL_6531) in
                                                        {8217}event beginSrv(Sess_5022,Cli_5020,gNs_6532);
                                                        {8218}out(c, m2_6533);
                                                        {8219}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8220}event endSrv(Cli_5020,Sess_5022,PartC_6528)
                                                    )
                                                    else
                                                        {8221}let v_6534: bool = (Disco_5021 = C) in
                                                        (
                                                            {8222}if v_6534 then
                                                            (
                                                                {8223}let pkDisco_6535: bitstring = pub(skC) in
                                                                {8224}in(c, (=pkCli_6513,em1_6536: bitstring));
                                                                {8225}let m1_6537: bitstring = em1_6536 in
                                                                {8226}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6538: bitstring) = m1_6537 in
                                                                {8227}new Ns_6539: bitstring;
                                                                {8228}new ST_6540: bitstring;
                                                                {8229}new TTL_6541: bitstring;
                                                                {8230}let gNs_6542: bitstring = exp(g,Ns_6539) in
                                                                {8231}let m2_6543: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6542,ST_6540,TTL_6541) in
                                                                {8232}event beginSrv(Sess_5022,Cli_5020,gNs_6542);
                                                                {8233}out(c, m2_6543);
                                                                {8234}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {8235}event endSrv(Cli_5020,Sess_5022,PartC_6538)
                                                            )
                                                            else
                                                                {8236}let pkDisco_6544: bitstring = pub(sk(Disco_5021)) in
                                                                {8237}in(c, (=pkCli_6513,em1_6545: bitstring));
                                                                {8238}let m1_6546: bitstring = em1_6545 in
                                                                {8239}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6547: bitstring) = m1_6546 in
                                                                {8240}new Ns_6548: bitstring;
                                                                {8241}new ST_6549: bitstring;
                                                                {8242}new TTL_6550: bitstring;
                                                                {8243}let gNs_6551: bitstring = exp(g,Ns_6548) in
                                                                {8244}let m2_6552: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6551,ST_6549,TTL_6550) in
                                                                {8245}event beginSrv(Sess_5022,Cli_5020,gNs_6551);
                                                                {8246}out(c, m2_6552);
                                                                {8247}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {8248}event endSrv(Cli_5020,Sess_5022,PartC_6547)
                                                        )
                                                        else
                                                            {8249}let pkDisco_6553: bitstring = fail-any in
                                                            {8250}in(c, (=pkCli_6513,em1_6554: bitstring));
                                                            {8251}let m1_6555: bitstring = em1_6554 in
                                                            {8252}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6556: bitstring) = m1_6555 in
                                                            {8253}new Ns_6557: bitstring;
                                                            {8254}new ST_6558: bitstring;
                                                            {8255}new TTL_6559: bitstring;
                                                            {8256}let gNs_6560: bitstring = exp(g,Ns_6557) in
                                                            {8257}let m2_6561: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6560,ST_6558,TTL_6559) in
                                                            {8258}event beginSrv(Sess_5022,Cli_5020,gNs_6560);
                                                            {8259}out(c, m2_6561);
                                                            {8260}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {8261}event endSrv(Cli_5020,Sess_5022,PartC_6556)
                                                )
                                                else
                                                    {8262}let pkDisco_6562: bitstring = fail-any in
                                                    {8263}in(c, (=pkCli_6513,em1_6563: bitstring));
                                                    {8264}let m1_6564: bitstring = em1_6563 in
                                                    {8265}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6565: bitstring) = m1_6564 in
                                                    {8266}new Ns_6566: bitstring;
                                                    {8267}new ST_6567: bitstring;
                                                    {8268}new TTL_6568: bitstring;
                                                    {8269}let gNs_6569: bitstring = exp(g,Ns_6566) in
                                                    {8270}let m2_6570: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6569,ST_6567,TTL_6568) in
                                                    {8271}event beginSrv(Sess_5022,Cli_5020,gNs_6569);
                                                    {8272}out(c, m2_6570);
                                                    {8273}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8274}event endSrv(Cli_5020,Sess_5022,PartC_6565)
                                        )
                                        else
                                            {8275}let pkDisco_6571: bitstring = fail-any in
                                            {8276}in(c, (=pkCli_6513,em1_6572: bitstring));
                                            {8277}let m1_6573: bitstring = em1_6572 in
                                            {8278}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6513,PartC_6574: bitstring) = m1_6573 in
                                            {8279}new Ns_6575: bitstring;
                                            {8280}new ST_6576: bitstring;
                                            {8281}new TTL_6577: bitstring;
                                            {8282}let gNs_6578: bitstring = exp(g,Ns_6575) in
                                            {8283}let m2_6579: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6578,ST_6576,TTL_6577) in
                                            {8284}event beginSrv(Sess_5022,Cli_5020,gNs_6578);
                                            {8285}out(c, m2_6579);
                                            {8286}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8287}event endSrv(Cli_5020,Sess_5022,PartC_6574)
                                    )
                                    else
                                        {8288}let v_6580: bool = (Cli_5020 = C) in
                                        (
                                            {8289}if v_6580 then
                                            (
                                                {8290}let pkCli_6581: bitstring = pub(skC) in
                                                {8291}let v_6582: bool = (Disco_5021 = A) in
                                                (
                                                    {8292}if v_6582 then
                                                    (
                                                        {8293}let pkDisco_6583: bitstring = pub(skA) in
                                                        {8294}in(c, (=pkCli_6581,em1_6584: bitstring));
                                                        {8295}let m1_6585: bitstring = em1_6584 in
                                                        {8296}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6586: bitstring) = m1_6585 in
                                                        {8297}new Ns_6587: bitstring;
                                                        {8298}new ST_6588: bitstring;
                                                        {8299}new TTL_6589: bitstring;
                                                        {8300}let gNs_6590: bitstring = exp(g,Ns_6587) in
                                                        {8301}let m2_6591: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6590,ST_6588,TTL_6589) in
                                                        {8302}event beginSrv(Sess_5022,Cli_5020,gNs_6590);
                                                        {8303}out(c, m2_6591);
                                                        {8304}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8305}event endSrv(Cli_5020,Sess_5022,PartC_6586)
                                                    )
                                                    else
                                                        {8306}let v_6592: bool = (Disco_5021 = B) in
                                                        (
                                                            {8307}if v_6592 then
                                                            (
                                                                {8308}let pkDisco_6593: bitstring = pub(skB) in
                                                                {8309}in(c, (=pkCli_6581,em1_6594: bitstring));
                                                                {8310}let m1_6595: bitstring = em1_6594 in
                                                                {8311}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6596: bitstring) = m1_6595 in
                                                                {8312}new Ns_6597: bitstring;
                                                                {8313}new ST_6598: bitstring;
                                                                {8314}new TTL_6599: bitstring;
                                                                {8315}let gNs_6600: bitstring = exp(g,Ns_6597) in
                                                                {8316}let m2_6601: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6600,ST_6598,TTL_6599) in
                                                                {8317}event beginSrv(Sess_5022,Cli_5020,gNs_6600);
                                                                {8318}out(c, m2_6601);
                                                                {8319}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {8320}event endSrv(Cli_5020,Sess_5022,PartC_6596)
                                                            )
                                                            else
                                                                {8321}let v_6602: bool = (Disco_5021 = C) in
                                                                (
                                                                    {8322}if v_6602 then
                                                                    (
                                                                        {8323}let pkDisco_6603: bitstring = pub(skC) in
                                                                        {8324}in(c, (=pkCli_6581,em1_6604: bitstring));
                                                                        {8325}let m1_6605: bitstring = em1_6604 in
                                                                        {8326}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6606: bitstring) = m1_6605 in
                                                                        {8327}new Ns_6607: bitstring;
                                                                        {8328}new ST_6608: bitstring;
                                                                        {8329}new TTL_6609: bitstring;
                                                                        {8330}let gNs_6610: bitstring = exp(g,Ns_6607) in
                                                                        {8331}let m2_6611: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6610,ST_6608,TTL_6609) in
                                                                        {8332}event beginSrv(Sess_5022,Cli_5020,gNs_6610);
                                                                        {8333}out(c, m2_6611);
                                                                        {8334}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {8335}event endSrv(Cli_5020,Sess_5022,PartC_6606)
                                                                    )
                                                                    else
                                                                        {8336}let pkDisco_6612: bitstring = pub(sk(Disco_5021)) in
                                                                        {8337}in(c, (=pkCli_6581,em1_6613: bitstring));
                                                                        {8338}let m1_6614: bitstring = em1_6613 in
                                                                        {8339}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6615: bitstring) = m1_6614 in
                                                                        {8340}new Ns_6616: bitstring;
                                                                        {8341}new ST_6617: bitstring;
                                                                        {8342}new TTL_6618: bitstring;
                                                                        {8343}let gNs_6619: bitstring = exp(g,Ns_6616) in
                                                                        {8344}let m2_6620: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6619,ST_6617,TTL_6618) in
                                                                        {8345}event beginSrv(Sess_5022,Cli_5020,gNs_6619);
                                                                        {8346}out(c, m2_6620);
                                                                        {8347}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {8348}event endSrv(Cli_5020,Sess_5022,PartC_6615)
                                                                )
                                                                else
                                                                    {8349}let pkDisco_6621: bitstring = fail-any in
                                                                    {8350}in(c, (=pkCli_6581,em1_6622: bitstring));
                                                                    {8351}let m1_6623: bitstring = em1_6622 in
                                                                    {8352}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6624: bitstring) = m1_6623 in
                                                                    {8353}new Ns_6625: bitstring;
                                                                    {8354}new ST_6626: bitstring;
                                                                    {8355}new TTL_6627: bitstring;
                                                                    {8356}let gNs_6628: bitstring = exp(g,Ns_6625) in
                                                                    {8357}let m2_6629: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6628,ST_6626,TTL_6627) in
                                                                    {8358}event beginSrv(Sess_5022,Cli_5020,gNs_6628);
                                                                    {8359}out(c, m2_6629);
                                                                    {8360}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {8361}event endSrv(Cli_5020,Sess_5022,PartC_6624)
                                                        )
                                                        else
                                                            {8362}let pkDisco_6630: bitstring = fail-any in
                                                            {8363}in(c, (=pkCli_6581,em1_6631: bitstring));
                                                            {8364}let m1_6632: bitstring = em1_6631 in
                                                            {8365}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6633: bitstring) = m1_6632 in
                                                            {8366}new Ns_6634: bitstring;
                                                            {8367}new ST_6635: bitstring;
                                                            {8368}new TTL_6636: bitstring;
                                                            {8369}let gNs_6637: bitstring = exp(g,Ns_6634) in
                                                            {8370}let m2_6638: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6637,ST_6635,TTL_6636) in
                                                            {8371}event beginSrv(Sess_5022,Cli_5020,gNs_6637);
                                                            {8372}out(c, m2_6638);
                                                            {8373}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {8374}event endSrv(Cli_5020,Sess_5022,PartC_6633)
                                                )
                                                else
                                                    {8375}let pkDisco_6639: bitstring = fail-any in
                                                    {8376}in(c, (=pkCli_6581,em1_6640: bitstring));
                                                    {8377}let m1_6641: bitstring = em1_6640 in
                                                    {8378}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6581,PartC_6642: bitstring) = m1_6641 in
                                                    {8379}new Ns_6643: bitstring;
                                                    {8380}new ST_6644: bitstring;
                                                    {8381}new TTL_6645: bitstring;
                                                    {8382}let gNs_6646: bitstring = exp(g,Ns_6643) in
                                                    {8383}let m2_6647: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6646,ST_6644,TTL_6645) in
                                                    {8384}event beginSrv(Sess_5022,Cli_5020,gNs_6646);
                                                    {8385}out(c, m2_6647);
                                                    {8386}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8387}event endSrv(Cli_5020,Sess_5022,PartC_6642)
                                            )
                                            else
                                                {8388}let pkCli_6648: bitstring = pub(sk(Cli_5020)) in
                                                {8389}let v_6649: bool = (Disco_5021 = A) in
                                                (
                                                    {8390}if v_6649 then
                                                    (
                                                        {8391}let pkDisco_6650: bitstring = pub(skA) in
                                                        {8392}in(c, (=pkCli_6648,em1_6651: bitstring));
                                                        {8393}let m1_6652: bitstring = em1_6651 in
                                                        {8394}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6653: bitstring) = m1_6652 in
                                                        {8395}new Ns_6654: bitstring;
                                                        {8396}new ST_6655: bitstring;
                                                        {8397}new TTL_6656: bitstring;
                                                        {8398}let gNs_6657: bitstring = exp(g,Ns_6654) in
                                                        {8399}let m2_6658: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6657,ST_6655,TTL_6656) in
                                                        {8400}event beginSrv(Sess_5022,Cli_5020,gNs_6657);
                                                        {8401}out(c, m2_6658);
                                                        {8402}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8403}event endSrv(Cli_5020,Sess_5022,PartC_6653)
                                                    )
                                                    else
                                                        {8404}let v_6659: bool = (Disco_5021 = B) in
                                                        (
                                                            {8405}if v_6659 then
                                                            (
                                                                {8406}let pkDisco_6660: bitstring = pub(skB) in
                                                                {8407}in(c, (=pkCli_6648,em1_6661: bitstring));
                                                                {8408}let m1_6662: bitstring = em1_6661 in
                                                                {8409}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6663: bitstring) = m1_6662 in
                                                                {8410}new Ns_6664: bitstring;
                                                                {8411}new ST_6665: bitstring;
                                                                {8412}new TTL_6666: bitstring;
                                                                {8413}let gNs_6667: bitstring = exp(g,Ns_6664) in
                                                                {8414}let m2_6668: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6667,ST_6665,TTL_6666) in
                                                                {8415}event beginSrv(Sess_5022,Cli_5020,gNs_6667);
                                                                {8416}out(c, m2_6668);
                                                                {8417}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {8418}event endSrv(Cli_5020,Sess_5022,PartC_6663)
                                                            )
                                                            else
                                                                {8419}let v_6669: bool = (Disco_5021 = C) in
                                                                (
                                                                    {8420}if v_6669 then
                                                                    (
                                                                        {8421}let pkDisco_6670: bitstring = pub(skC) in
                                                                        {8422}in(c, (=pkCli_6648,em1_6671: bitstring));
                                                                        {8423}let m1_6672: bitstring = em1_6671 in
                                                                        {8424}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6673: bitstring) = m1_6672 in
                                                                        {8425}new Ns_6674: bitstring;
                                                                        {8426}new ST_6675: bitstring;
                                                                        {8427}new TTL_6676: bitstring;
                                                                        {8428}let gNs_6677: bitstring = exp(g,Ns_6674) in
                                                                        {8429}let m2_6678: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6677,ST_6675,TTL_6676) in
                                                                        {8430}event beginSrv(Sess_5022,Cli_5020,gNs_6677);
                                                                        {8431}out(c, m2_6678);
                                                                        {8432}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {8433}event endSrv(Cli_5020,Sess_5022,PartC_6673)
                                                                    )
                                                                    else
                                                                        {8434}let pkDisco_6679: bitstring = pub(sk(Disco_5021)) in
                                                                        {8435}in(c, (=pkCli_6648,em1_6680: bitstring));
                                                                        {8436}let m1_6681: bitstring = em1_6680 in
                                                                        {8437}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6682: bitstring) = m1_6681 in
                                                                        {8438}new Ns_6683: bitstring;
                                                                        {8439}new ST_6684: bitstring;
                                                                        {8440}new TTL_6685: bitstring;
                                                                        {8441}let gNs_6686: bitstring = exp(g,Ns_6683) in
                                                                        {8442}let m2_6687: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6686,ST_6684,TTL_6685) in
                                                                        {8443}event beginSrv(Sess_5022,Cli_5020,gNs_6686);
                                                                        {8444}out(c, m2_6687);
                                                                        {8445}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                        {8446}event endSrv(Cli_5020,Sess_5022,PartC_6682)
                                                                )
                                                                else
                                                                    {8447}let pkDisco_6688: bitstring = fail-any in
                                                                    {8448}in(c, (=pkCli_6648,em1_6689: bitstring));
                                                                    {8449}let m1_6690: bitstring = em1_6689 in
                                                                    {8450}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6691: bitstring) = m1_6690 in
                                                                    {8451}new Ns_6692: bitstring;
                                                                    {8452}new ST_6693: bitstring;
                                                                    {8453}new TTL_6694: bitstring;
                                                                    {8454}let gNs_6695: bitstring = exp(g,Ns_6692) in
                                                                    {8455}let m2_6696: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6695,ST_6693,TTL_6694) in
                                                                    {8456}event beginSrv(Sess_5022,Cli_5020,gNs_6695);
                                                                    {8457}out(c, m2_6696);
                                                                    {8458}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {8459}event endSrv(Cli_5020,Sess_5022,PartC_6691)
                                                        )
                                                        else
                                                            {8460}let pkDisco_6697: bitstring = fail-any in
                                                            {8461}in(c, (=pkCli_6648,em1_6698: bitstring));
                                                            {8462}let m1_6699: bitstring = em1_6698 in
                                                            {8463}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6700: bitstring) = m1_6699 in
                                                            {8464}new Ns_6701: bitstring;
                                                            {8465}new ST_6702: bitstring;
                                                            {8466}new TTL_6703: bitstring;
                                                            {8467}let gNs_6704: bitstring = exp(g,Ns_6701) in
                                                            {8468}let m2_6705: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6704,ST_6702,TTL_6703) in
                                                            {8469}event beginSrv(Sess_5022,Cli_5020,gNs_6704);
                                                            {8470}out(c, m2_6705);
                                                            {8471}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {8472}event endSrv(Cli_5020,Sess_5022,PartC_6700)
                                                )
                                                else
                                                    {8473}let pkDisco_6706: bitstring = fail-any in
                                                    {8474}in(c, (=pkCli_6648,em1_6707: bitstring));
                                                    {8475}let m1_6708: bitstring = em1_6707 in
                                                    {8476}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6648,PartC_6709: bitstring) = m1_6708 in
                                                    {8477}new Ns_6710: bitstring;
                                                    {8478}new ST_6711: bitstring;
                                                    {8479}new TTL_6712: bitstring;
                                                    {8480}let gNs_6713: bitstring = exp(g,Ns_6710) in
                                                    {8481}let m2_6714: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6713,ST_6711,TTL_6712) in
                                                    {8482}event beginSrv(Sess_5022,Cli_5020,gNs_6713);
                                                    {8483}out(c, m2_6714);
                                                    {8484}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8485}event endSrv(Cli_5020,Sess_5022,PartC_6709)
                                        )
                                        else
                                            {8486}let pkCli_6715: bitstring = fail-any in
                                            {8487}let v_6716: bool = (Disco_5021 = A) in
                                            (
                                                {8488}if v_6716 then
                                                (
                                                    {8489}let pkDisco_6717: bitstring = pub(skA) in
                                                    {8490}in(c, (=pkCli_6715,em1_6718: bitstring));
                                                    {8491}let m1_6719: bitstring = em1_6718 in
                                                    {8492}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6720: bitstring) = m1_6719 in
                                                    {8493}new Ns_6721: bitstring;
                                                    {8494}new ST_6722: bitstring;
                                                    {8495}new TTL_6723: bitstring;
                                                    {8496}let gNs_6724: bitstring = exp(g,Ns_6721) in
                                                    {8497}let m2_6725: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6724,ST_6722,TTL_6723) in
                                                    {8498}event beginSrv(Sess_5022,Cli_5020,gNs_6724);
                                                    {8499}out(c, m2_6725);
                                                    {8500}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8501}event endSrv(Cli_5020,Sess_5022,PartC_6720)
                                                )
                                                else
                                                    {8502}let v_6726: bool = (Disco_5021 = B) in
                                                    (
                                                        {8503}if v_6726 then
                                                        (
                                                            {8504}let pkDisco_6727: bitstring = pub(skB) in
                                                            {8505}in(c, (=pkCli_6715,em1_6728: bitstring));
                                                            {8506}let m1_6729: bitstring = em1_6728 in
                                                            {8507}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6730: bitstring) = m1_6729 in
                                                            {8508}new Ns_6731: bitstring;
                                                            {8509}new ST_6732: bitstring;
                                                            {8510}new TTL_6733: bitstring;
                                                            {8511}let gNs_6734: bitstring = exp(g,Ns_6731) in
                                                            {8512}let m2_6735: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6734,ST_6732,TTL_6733) in
                                                            {8513}event beginSrv(Sess_5022,Cli_5020,gNs_6734);
                                                            {8514}out(c, m2_6735);
                                                            {8515}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {8516}event endSrv(Cli_5020,Sess_5022,PartC_6730)
                                                        )
                                                        else
                                                            {8517}let v_6736: bool = (Disco_5021 = C) in
                                                            (
                                                                {8518}if v_6736 then
                                                                (
                                                                    {8519}let pkDisco_6737: bitstring = pub(skC) in
                                                                    {8520}in(c, (=pkCli_6715,em1_6738: bitstring));
                                                                    {8521}let m1_6739: bitstring = em1_6738 in
                                                                    {8522}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6740: bitstring) = m1_6739 in
                                                                    {8523}new Ns_6741: bitstring;
                                                                    {8524}new ST_6742: bitstring;
                                                                    {8525}new TTL_6743: bitstring;
                                                                    {8526}let gNs_6744: bitstring = exp(g,Ns_6741) in
                                                                    {8527}let m2_6745: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6744,ST_6742,TTL_6743) in
                                                                    {8528}event beginSrv(Sess_5022,Cli_5020,gNs_6744);
                                                                    {8529}out(c, m2_6745);
                                                                    {8530}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {8531}event endSrv(Cli_5020,Sess_5022,PartC_6740)
                                                                )
                                                                else
                                                                    {8532}let pkDisco_6746: bitstring = pub(sk(Disco_5021)) in
                                                                    {8533}in(c, (=pkCli_6715,em1_6747: bitstring));
                                                                    {8534}let m1_6748: bitstring = em1_6747 in
                                                                    {8535}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6749: bitstring) = m1_6748 in
                                                                    {8536}new Ns_6750: bitstring;
                                                                    {8537}new ST_6751: bitstring;
                                                                    {8538}new TTL_6752: bitstring;
                                                                    {8539}let gNs_6753: bitstring = exp(g,Ns_6750) in
                                                                    {8540}let m2_6754: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6753,ST_6751,TTL_6752) in
                                                                    {8541}event beginSrv(Sess_5022,Cli_5020,gNs_6753);
                                                                    {8542}out(c, m2_6754);
                                                                    {8543}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                    {8544}event endSrv(Cli_5020,Sess_5022,PartC_6749)
                                                            )
                                                            else
                                                                {8545}let pkDisco_6755: bitstring = fail-any in
                                                                {8546}in(c, (=pkCli_6715,em1_6756: bitstring));
                                                                {8547}let m1_6757: bitstring = em1_6756 in
                                                                {8548}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6758: bitstring) = m1_6757 in
                                                                {8549}new Ns_6759: bitstring;
                                                                {8550}new ST_6760: bitstring;
                                                                {8551}new TTL_6761: bitstring;
                                                                {8552}let gNs_6762: bitstring = exp(g,Ns_6759) in
                                                                {8553}let m2_6763: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6762,ST_6760,TTL_6761) in
                                                                {8554}event beginSrv(Sess_5022,Cli_5020,gNs_6762);
                                                                {8555}out(c, m2_6763);
                                                                {8556}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {8557}event endSrv(Cli_5020,Sess_5022,PartC_6758)
                                                    )
                                                    else
                                                        {8558}let pkDisco_6764: bitstring = fail-any in
                                                        {8559}in(c, (=pkCli_6715,em1_6765: bitstring));
                                                        {8560}let m1_6766: bitstring = em1_6765 in
                                                        {8561}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6767: bitstring) = m1_6766 in
                                                        {8562}new Ns_6768: bitstring;
                                                        {8563}new ST_6769: bitstring;
                                                        {8564}new TTL_6770: bitstring;
                                                        {8565}let gNs_6771: bitstring = exp(g,Ns_6768) in
                                                        {8566}let m2_6772: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6771,ST_6769,TTL_6770) in
                                                        {8567}event beginSrv(Sess_5022,Cli_5020,gNs_6771);
                                                        {8568}out(c, m2_6772);
                                                        {8569}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8570}event endSrv(Cli_5020,Sess_5022,PartC_6767)
                                            )
                                            else
                                                {8571}let pkDisco_6773: bitstring = fail-any in
                                                {8572}in(c, (=pkCli_6715,em1_6774: bitstring));
                                                {8573}let m1_6775: bitstring = em1_6774 in
                                                {8574}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6715,PartC_6776: bitstring) = m1_6775 in
                                                {8575}new Ns_6777: bitstring;
                                                {8576}new ST_6778: bitstring;
                                                {8577}new TTL_6779: bitstring;
                                                {8578}let gNs_6780: bitstring = exp(g,Ns_6777) in
                                                {8579}let m2_6781: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6780,ST_6778,TTL_6779) in
                                                {8580}event beginSrv(Sess_5022,Cli_5020,gNs_6780);
                                                {8581}out(c, m2_6781);
                                                {8582}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8583}event endSrv(Cli_5020,Sess_5022,PartC_6776)
                                )
                                else
                                    {8584}let pkCli_6782: bitstring = fail-any in
                                    {8585}let v_6783: bool = (Disco_5021 = A) in
                                    (
                                        {8586}if v_6783 then
                                        (
                                            {8587}let pkDisco_6784: bitstring = pub(skA) in
                                            {8588}in(c, (=pkCli_6782,em1_6785: bitstring));
                                            {8589}let m1_6786: bitstring = em1_6785 in
                                            {8590}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6787: bitstring) = m1_6786 in
                                            {8591}new Ns_6788: bitstring;
                                            {8592}new ST_6789: bitstring;
                                            {8593}new TTL_6790: bitstring;
                                            {8594}let gNs_6791: bitstring = exp(g,Ns_6788) in
                                            {8595}let m2_6792: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6791,ST_6789,TTL_6790) in
                                            {8596}event beginSrv(Sess_5022,Cli_5020,gNs_6791);
                                            {8597}out(c, m2_6792);
                                            {8598}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8599}event endSrv(Cli_5020,Sess_5022,PartC_6787)
                                        )
                                        else
                                            {8600}let v_6793: bool = (Disco_5021 = B) in
                                            (
                                                {8601}if v_6793 then
                                                (
                                                    {8602}let pkDisco_6794: bitstring = pub(skB) in
                                                    {8603}in(c, (=pkCli_6782,em1_6795: bitstring));
                                                    {8604}let m1_6796: bitstring = em1_6795 in
                                                    {8605}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6797: bitstring) = m1_6796 in
                                                    {8606}new Ns_6798: bitstring;
                                                    {8607}new ST_6799: bitstring;
                                                    {8608}new TTL_6800: bitstring;
                                                    {8609}let gNs_6801: bitstring = exp(g,Ns_6798) in
                                                    {8610}let m2_6802: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6801,ST_6799,TTL_6800) in
                                                    {8611}event beginSrv(Sess_5022,Cli_5020,gNs_6801);
                                                    {8612}out(c, m2_6802);
                                                    {8613}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8614}event endSrv(Cli_5020,Sess_5022,PartC_6797)
                                                )
                                                else
                                                    {8615}let v_6803: bool = (Disco_5021 = C) in
                                                    (
                                                        {8616}if v_6803 then
                                                        (
                                                            {8617}let pkDisco_6804: bitstring = pub(skC) in
                                                            {8618}in(c, (=pkCli_6782,em1_6805: bitstring));
                                                            {8619}let m1_6806: bitstring = em1_6805 in
                                                            {8620}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6807: bitstring) = m1_6806 in
                                                            {8621}new Ns_6808: bitstring;
                                                            {8622}new ST_6809: bitstring;
                                                            {8623}new TTL_6810: bitstring;
                                                            {8624}let gNs_6811: bitstring = exp(g,Ns_6808) in
                                                            {8625}let m2_6812: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6811,ST_6809,TTL_6810) in
                                                            {8626}event beginSrv(Sess_5022,Cli_5020,gNs_6811);
                                                            {8627}out(c, m2_6812);
                                                            {8628}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {8629}event endSrv(Cli_5020,Sess_5022,PartC_6807)
                                                        )
                                                        else
                                                            {8630}let pkDisco_6813: bitstring = pub(sk(Disco_5021)) in
                                                            {8631}in(c, (=pkCli_6782,em1_6814: bitstring));
                                                            {8632}let m1_6815: bitstring = em1_6814 in
                                                            {8633}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6816: bitstring) = m1_6815 in
                                                            {8634}new Ns_6817: bitstring;
                                                            {8635}new ST_6818: bitstring;
                                                            {8636}new TTL_6819: bitstring;
                                                            {8637}let gNs_6820: bitstring = exp(g,Ns_6817) in
                                                            {8638}let m2_6821: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6820,ST_6818,TTL_6819) in
                                                            {8639}event beginSrv(Sess_5022,Cli_5020,gNs_6820);
                                                            {8640}out(c, m2_6821);
                                                            {8641}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {8642}event endSrv(Cli_5020,Sess_5022,PartC_6816)
                                                    )
                                                    else
                                                        {8643}let pkDisco_6822: bitstring = fail-any in
                                                        {8644}in(c, (=pkCli_6782,em1_6823: bitstring));
                                                        {8645}let m1_6824: bitstring = em1_6823 in
                                                        {8646}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6825: bitstring) = m1_6824 in
                                                        {8647}new Ns_6826: bitstring;
                                                        {8648}new ST_6827: bitstring;
                                                        {8649}new TTL_6828: bitstring;
                                                        {8650}let gNs_6829: bitstring = exp(g,Ns_6826) in
                                                        {8651}let m2_6830: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6829,ST_6827,TTL_6828) in
                                                        {8652}event beginSrv(Sess_5022,Cli_5020,gNs_6829);
                                                        {8653}out(c, m2_6830);
                                                        {8654}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8655}event endSrv(Cli_5020,Sess_5022,PartC_6825)
                                            )
                                            else
                                                {8656}let pkDisco_6831: bitstring = fail-any in
                                                {8657}in(c, (=pkCli_6782,em1_6832: bitstring));
                                                {8658}let m1_6833: bitstring = em1_6832 in
                                                {8659}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6834: bitstring) = m1_6833 in
                                                {8660}new Ns_6835: bitstring;
                                                {8661}new ST_6836: bitstring;
                                                {8662}new TTL_6837: bitstring;
                                                {8663}let gNs_6838: bitstring = exp(g,Ns_6835) in
                                                {8664}let m2_6839: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6838,ST_6836,TTL_6837) in
                                                {8665}event beginSrv(Sess_5022,Cli_5020,gNs_6838);
                                                {8666}out(c, m2_6839);
                                                {8667}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8668}event endSrv(Cli_5020,Sess_5022,PartC_6834)
                                    )
                                    else
                                        {8669}let pkDisco_6840: bitstring = fail-any in
                                        {8670}in(c, (=pkCli_6782,em1_6841: bitstring));
                                        {8671}let m1_6842: bitstring = em1_6841 in
                                        {8672}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6782,PartC_6843: bitstring) = m1_6842 in
                                        {8673}new Ns_6844: bitstring;
                                        {8674}new ST_6845: bitstring;
                                        {8675}new TTL_6846: bitstring;
                                        {8676}let gNs_6847: bitstring = exp(g,Ns_6844) in
                                        {8677}let m2_6848: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6847,ST_6845,TTL_6846) in
                                        {8678}event beginSrv(Sess_5022,Cli_5020,gNs_6847);
                                        {8679}out(c, m2_6848);
                                        {8680}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {8681}event endSrv(Cli_5020,Sess_5022,PartC_6843)
                        )
                        else
                            {8682}let pkCli_6849: bitstring = fail-any in
                            {8683}let v_6850: bool = (Disco_5021 = A) in
                            (
                                {8684}if v_6850 then
                                (
                                    {8685}let pkDisco_6851: bitstring = pub(skA) in
                                    {8686}in(c, (=pkCli_6849,em1_6852: bitstring));
                                    {8687}let m1_6853: bitstring = em1_6852 in
                                    {8688}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6854: bitstring) = m1_6853 in
                                    {8689}new Ns_6855: bitstring;
                                    {8690}new ST_6856: bitstring;
                                    {8691}new TTL_6857: bitstring;
                                    {8692}let gNs_6858: bitstring = exp(g,Ns_6855) in
                                    {8693}let m2_6859: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6858,ST_6856,TTL_6857) in
                                    {8694}event beginSrv(Sess_5022,Cli_5020,gNs_6858);
                                    {8695}out(c, m2_6859);
                                    {8696}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {8697}event endSrv(Cli_5020,Sess_5022,PartC_6854)
                                )
                                else
                                    {8698}let v_6860: bool = (Disco_5021 = B) in
                                    (
                                        {8699}if v_6860 then
                                        (
                                            {8700}let pkDisco_6861: bitstring = pub(skB) in
                                            {8701}in(c, (=pkCli_6849,em1_6862: bitstring));
                                            {8702}let m1_6863: bitstring = em1_6862 in
                                            {8703}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6864: bitstring) = m1_6863 in
                                            {8704}new Ns_6865: bitstring;
                                            {8705}new ST_6866: bitstring;
                                            {8706}new TTL_6867: bitstring;
                                            {8707}let gNs_6868: bitstring = exp(g,Ns_6865) in
                                            {8708}let m2_6869: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6868,ST_6866,TTL_6867) in
                                            {8709}event beginSrv(Sess_5022,Cli_5020,gNs_6868);
                                            {8710}out(c, m2_6869);
                                            {8711}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8712}event endSrv(Cli_5020,Sess_5022,PartC_6864)
                                        )
                                        else
                                            {8713}let v_6870: bool = (Disco_5021 = C) in
                                            (
                                                {8714}if v_6870 then
                                                (
                                                    {8715}let pkDisco_6871: bitstring = pub(skC) in
                                                    {8716}in(c, (=pkCli_6849,em1_6872: bitstring));
                                                    {8717}let m1_6873: bitstring = em1_6872 in
                                                    {8718}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6874: bitstring) = m1_6873 in
                                                    {8719}new Ns_6875: bitstring;
                                                    {8720}new ST_6876: bitstring;
                                                    {8721}new TTL_6877: bitstring;
                                                    {8722}let gNs_6878: bitstring = exp(g,Ns_6875) in
                                                    {8723}let m2_6879: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6878,ST_6876,TTL_6877) in
                                                    {8724}event beginSrv(Sess_5022,Cli_5020,gNs_6878);
                                                    {8725}out(c, m2_6879);
                                                    {8726}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8727}event endSrv(Cli_5020,Sess_5022,PartC_6874)
                                                )
                                                else
                                                    {8728}let pkDisco_6880: bitstring = pub(sk(Disco_5021)) in
                                                    {8729}in(c, (=pkCli_6849,em1_6881: bitstring));
                                                    {8730}let m1_6882: bitstring = em1_6881 in
                                                    {8731}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6883: bitstring) = m1_6882 in
                                                    {8732}new Ns_6884: bitstring;
                                                    {8733}new ST_6885: bitstring;
                                                    {8734}new TTL_6886: bitstring;
                                                    {8735}let gNs_6887: bitstring = exp(g,Ns_6884) in
                                                    {8736}let m2_6888: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6887,ST_6885,TTL_6886) in
                                                    {8737}event beginSrv(Sess_5022,Cli_5020,gNs_6887);
                                                    {8738}out(c, m2_6888);
                                                    {8739}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8740}event endSrv(Cli_5020,Sess_5022,PartC_6883)
                                            )
                                            else
                                                {8741}let pkDisco_6889: bitstring = fail-any in
                                                {8742}in(c, (=pkCli_6849,em1_6890: bitstring));
                                                {8743}let m1_6891: bitstring = em1_6890 in
                                                {8744}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6892: bitstring) = m1_6891 in
                                                {8745}new Ns_6893: bitstring;
                                                {8746}new ST_6894: bitstring;
                                                {8747}new TTL_6895: bitstring;
                                                {8748}let gNs_6896: bitstring = exp(g,Ns_6893) in
                                                {8749}let m2_6897: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6896,ST_6894,TTL_6895) in
                                                {8750}event beginSrv(Sess_5022,Cli_5020,gNs_6896);
                                                {8751}out(c, m2_6897);
                                                {8752}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8753}event endSrv(Cli_5020,Sess_5022,PartC_6892)
                                    )
                                    else
                                        {8754}let pkDisco_6898: bitstring = fail-any in
                                        {8755}in(c, (=pkCli_6849,em1_6899: bitstring));
                                        {8756}let m1_6900: bitstring = em1_6899 in
                                        {8757}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6901: bitstring) = m1_6900 in
                                        {8758}new Ns_6902: bitstring;
                                        {8759}new ST_6903: bitstring;
                                        {8760}new TTL_6904: bitstring;
                                        {8761}let gNs_6905: bitstring = exp(g,Ns_6902) in
                                        {8762}let m2_6906: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6905,ST_6903,TTL_6904) in
                                        {8763}event beginSrv(Sess_5022,Cli_5020,gNs_6905);
                                        {8764}out(c, m2_6906);
                                        {8765}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {8766}event endSrv(Cli_5020,Sess_5022,PartC_6901)
                            )
                            else
                                {8767}let pkDisco_6907: bitstring = fail-any in
                                {8768}in(c, (=pkCli_6849,em1_6908: bitstring));
                                {8769}let m1_6909: bitstring = em1_6908 in
                                {8770}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6849,PartC_6910: bitstring) = m1_6909 in
                                {8771}new Ns_6911: bitstring;
                                {8772}new ST_6912: bitstring;
                                {8773}new TTL_6913: bitstring;
                                {8774}let gNs_6914: bitstring = exp(g,Ns_6911) in
                                {8775}let m2_6915: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6914,ST_6912,TTL_6913) in
                                {8776}event beginSrv(Sess_5022,Cli_5020,gNs_6914);
                                {8777}out(c, m2_6915);
                                {8778}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {8779}event endSrv(Cli_5020,Sess_5022,PartC_6910)
            )
            else
                {8780}let skSess_6916: bitstring = fail-any in
                {8781}let pkSess_6917: bitstring = pub(skSess_6916) in
                {8782}let v_6918: bool = (Cli_5020 = A) in
                (
                    {8783}if v_6918 then
                    (
                        {8784}let pkCli_6919: bitstring = pub(skA) in
                        {8785}let v_6920: bool = (Disco_5021 = A) in
                        (
                            {8786}if v_6920 then
                            (
                                {8787}let pkDisco_6921: bitstring = pub(skA) in
                                {8788}in(c, (=pkCli_6919,em1_6922: bitstring));
                                {8789}let m1_6923: bitstring = em1_6922 in
                                {8790}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6924: bitstring) = m1_6923 in
                                {8791}new Ns_6925: bitstring;
                                {8792}new ST_6926: bitstring;
                                {8793}new TTL_6927: bitstring;
                                {8794}let gNs_6928: bitstring = exp(g,Ns_6925) in
                                {8795}let m2_6929: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6928,ST_6926,TTL_6927) in
                                {8796}event beginSrv(Sess_5022,Cli_5020,gNs_6928);
                                {8797}out(c, m2_6929);
                                {8798}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {8799}event endSrv(Cli_5020,Sess_5022,PartC_6924)
                            )
                            else
                                {8800}let v_6930: bool = (Disco_5021 = B) in
                                (
                                    {8801}if v_6930 then
                                    (
                                        {8802}let pkDisco_6931: bitstring = pub(skB) in
                                        {8803}in(c, (=pkCli_6919,em1_6932: bitstring));
                                        {8804}let m1_6933: bitstring = em1_6932 in
                                        {8805}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6934: bitstring) = m1_6933 in
                                        {8806}new Ns_6935: bitstring;
                                        {8807}new ST_6936: bitstring;
                                        {8808}new TTL_6937: bitstring;
                                        {8809}let gNs_6938: bitstring = exp(g,Ns_6935) in
                                        {8810}let m2_6939: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6938,ST_6936,TTL_6937) in
                                        {8811}event beginSrv(Sess_5022,Cli_5020,gNs_6938);
                                        {8812}out(c, m2_6939);
                                        {8813}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {8814}event endSrv(Cli_5020,Sess_5022,PartC_6934)
                                    )
                                    else
                                        {8815}let v_6940: bool = (Disco_5021 = C) in
                                        (
                                            {8816}if v_6940 then
                                            (
                                                {8817}let pkDisco_6941: bitstring = pub(skC) in
                                                {8818}in(c, (=pkCli_6919,em1_6942: bitstring));
                                                {8819}let m1_6943: bitstring = em1_6942 in
                                                {8820}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6944: bitstring) = m1_6943 in
                                                {8821}new Ns_6945: bitstring;
                                                {8822}new ST_6946: bitstring;
                                                {8823}new TTL_6947: bitstring;
                                                {8824}let gNs_6948: bitstring = exp(g,Ns_6945) in
                                                {8825}let m2_6949: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6948,ST_6946,TTL_6947) in
                                                {8826}event beginSrv(Sess_5022,Cli_5020,gNs_6948);
                                                {8827}out(c, m2_6949);
                                                {8828}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8829}event endSrv(Cli_5020,Sess_5022,PartC_6944)
                                            )
                                            else
                                                {8830}let pkDisco_6950: bitstring = pub(sk(Disco_5021)) in
                                                {8831}in(c, (=pkCli_6919,em1_6951: bitstring));
                                                {8832}let m1_6952: bitstring = em1_6951 in
                                                {8833}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6953: bitstring) = m1_6952 in
                                                {8834}new Ns_6954: bitstring;
                                                {8835}new ST_6955: bitstring;
                                                {8836}new TTL_6956: bitstring;
                                                {8837}let gNs_6957: bitstring = exp(g,Ns_6954) in
                                                {8838}let m2_6958: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6957,ST_6955,TTL_6956) in
                                                {8839}event beginSrv(Sess_5022,Cli_5020,gNs_6957);
                                                {8840}out(c, m2_6958);
                                                {8841}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8842}event endSrv(Cli_5020,Sess_5022,PartC_6953)
                                        )
                                        else
                                            {8843}let pkDisco_6959: bitstring = fail-any in
                                            {8844}in(c, (=pkCli_6919,em1_6960: bitstring));
                                            {8845}let m1_6961: bitstring = em1_6960 in
                                            {8846}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6962: bitstring) = m1_6961 in
                                            {8847}new Ns_6963: bitstring;
                                            {8848}new ST_6964: bitstring;
                                            {8849}new TTL_6965: bitstring;
                                            {8850}let gNs_6966: bitstring = exp(g,Ns_6963) in
                                            {8851}let m2_6967: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6966,ST_6964,TTL_6965) in
                                            {8852}event beginSrv(Sess_5022,Cli_5020,gNs_6966);
                                            {8853}out(c, m2_6967);
                                            {8854}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8855}event endSrv(Cli_5020,Sess_5022,PartC_6962)
                                )
                                else
                                    {8856}let pkDisco_6968: bitstring = fail-any in
                                    {8857}in(c, (=pkCli_6919,em1_6969: bitstring));
                                    {8858}let m1_6970: bitstring = em1_6969 in
                                    {8859}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6971: bitstring) = m1_6970 in
                                    {8860}new Ns_6972: bitstring;
                                    {8861}new ST_6973: bitstring;
                                    {8862}new TTL_6974: bitstring;
                                    {8863}let gNs_6975: bitstring = exp(g,Ns_6972) in
                                    {8864}let m2_6976: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6975,ST_6973,TTL_6974) in
                                    {8865}event beginSrv(Sess_5022,Cli_5020,gNs_6975);
                                    {8866}out(c, m2_6976);
                                    {8867}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {8868}event endSrv(Cli_5020,Sess_5022,PartC_6971)
                        )
                        else
                            {8869}let pkDisco_6977: bitstring = fail-any in
                            {8870}in(c, (=pkCli_6919,em1_6978: bitstring));
                            {8871}let m1_6979: bitstring = em1_6978 in
                            {8872}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6919,PartC_6980: bitstring) = m1_6979 in
                            {8873}new Ns_6981: bitstring;
                            {8874}new ST_6982: bitstring;
                            {8875}new TTL_6983: bitstring;
                            {8876}let gNs_6984: bitstring = exp(g,Ns_6981) in
                            {8877}let m2_6985: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6984,ST_6982,TTL_6983) in
                            {8878}event beginSrv(Sess_5022,Cli_5020,gNs_6984);
                            {8879}out(c, m2_6985);
                            {8880}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {8881}event endSrv(Cli_5020,Sess_5022,PartC_6980)
                    )
                    else
                        {8882}let v_6986: bool = (Cli_5020 = B) in
                        (
                            {8883}if v_6986 then
                            (
                                {8884}let pkCli_6987: bitstring = pub(skB) in
                                {8885}let v_6988: bool = (Disco_5021 = A) in
                                (
                                    {8886}if v_6988 then
                                    (
                                        {8887}let pkDisco_6989: bitstring = pub(skA) in
                                        {8888}in(c, (=pkCli_6987,em1_6990: bitstring));
                                        {8889}let m1_6991: bitstring = em1_6990 in
                                        {8890}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_6992: bitstring) = m1_6991 in
                                        {8891}new Ns_6993: bitstring;
                                        {8892}new ST_6994: bitstring;
                                        {8893}new TTL_6995: bitstring;
                                        {8894}let gNs_6996: bitstring = exp(g,Ns_6993) in
                                        {8895}let m2_6997: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_6996,ST_6994,TTL_6995) in
                                        {8896}event beginSrv(Sess_5022,Cli_5020,gNs_6996);
                                        {8897}out(c, m2_6997);
                                        {8898}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {8899}event endSrv(Cli_5020,Sess_5022,PartC_6992)
                                    )
                                    else
                                        {8900}let v_6998: bool = (Disco_5021 = B) in
                                        (
                                            {8901}if v_6998 then
                                            (
                                                {8902}let pkDisco_6999: bitstring = pub(skB) in
                                                {8903}in(c, (=pkCli_6987,em1_7000: bitstring));
                                                {8904}let m1_7001: bitstring = em1_7000 in
                                                {8905}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_7002: bitstring) = m1_7001 in
                                                {8906}new Ns_7003: bitstring;
                                                {8907}new ST_7004: bitstring;
                                                {8908}new TTL_7005: bitstring;
                                                {8909}let gNs_7006: bitstring = exp(g,Ns_7003) in
                                                {8910}let m2_7007: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7006,ST_7004,TTL_7005) in
                                                {8911}event beginSrv(Sess_5022,Cli_5020,gNs_7006);
                                                {8912}out(c, m2_7007);
                                                {8913}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8914}event endSrv(Cli_5020,Sess_5022,PartC_7002)
                                            )
                                            else
                                                {8915}let v_7008: bool = (Disco_5021 = C) in
                                                (
                                                    {8916}if v_7008 then
                                                    (
                                                        {8917}let pkDisco_7009: bitstring = pub(skC) in
                                                        {8918}in(c, (=pkCli_6987,em1_7010: bitstring));
                                                        {8919}let m1_7011: bitstring = em1_7010 in
                                                        {8920}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_7012: bitstring) = m1_7011 in
                                                        {8921}new Ns_7013: bitstring;
                                                        {8922}new ST_7014: bitstring;
                                                        {8923}new TTL_7015: bitstring;
                                                        {8924}let gNs_7016: bitstring = exp(g,Ns_7013) in
                                                        {8925}let m2_7017: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7016,ST_7014,TTL_7015) in
                                                        {8926}event beginSrv(Sess_5022,Cli_5020,gNs_7016);
                                                        {8927}out(c, m2_7017);
                                                        {8928}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8929}event endSrv(Cli_5020,Sess_5022,PartC_7012)
                                                    )
                                                    else
                                                        {8930}let pkDisco_7018: bitstring = pub(sk(Disco_5021)) in
                                                        {8931}in(c, (=pkCli_6987,em1_7019: bitstring));
                                                        {8932}let m1_7020: bitstring = em1_7019 in
                                                        {8933}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_7021: bitstring) = m1_7020 in
                                                        {8934}new Ns_7022: bitstring;
                                                        {8935}new ST_7023: bitstring;
                                                        {8936}new TTL_7024: bitstring;
                                                        {8937}let gNs_7025: bitstring = exp(g,Ns_7022) in
                                                        {8938}let m2_7026: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7025,ST_7023,TTL_7024) in
                                                        {8939}event beginSrv(Sess_5022,Cli_5020,gNs_7025);
                                                        {8940}out(c, m2_7026);
                                                        {8941}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {8942}event endSrv(Cli_5020,Sess_5022,PartC_7021)
                                                )
                                                else
                                                    {8943}let pkDisco_7027: bitstring = fail-any in
                                                    {8944}in(c, (=pkCli_6987,em1_7028: bitstring));
                                                    {8945}let m1_7029: bitstring = em1_7028 in
                                                    {8946}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_7030: bitstring) = m1_7029 in
                                                    {8947}new Ns_7031: bitstring;
                                                    {8948}new ST_7032: bitstring;
                                                    {8949}new TTL_7033: bitstring;
                                                    {8950}let gNs_7034: bitstring = exp(g,Ns_7031) in
                                                    {8951}let m2_7035: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7034,ST_7032,TTL_7033) in
                                                    {8952}event beginSrv(Sess_5022,Cli_5020,gNs_7034);
                                                    {8953}out(c, m2_7035);
                                                    {8954}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {8955}event endSrv(Cli_5020,Sess_5022,PartC_7030)
                                        )
                                        else
                                            {8956}let pkDisco_7036: bitstring = fail-any in
                                            {8957}in(c, (=pkCli_6987,em1_7037: bitstring));
                                            {8958}let m1_7038: bitstring = em1_7037 in
                                            {8959}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_7039: bitstring) = m1_7038 in
                                            {8960}new Ns_7040: bitstring;
                                            {8961}new ST_7041: bitstring;
                                            {8962}new TTL_7042: bitstring;
                                            {8963}let gNs_7043: bitstring = exp(g,Ns_7040) in
                                            {8964}let m2_7044: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7043,ST_7041,TTL_7042) in
                                            {8965}event beginSrv(Sess_5022,Cli_5020,gNs_7043);
                                            {8966}out(c, m2_7044);
                                            {8967}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {8968}event endSrv(Cli_5020,Sess_5022,PartC_7039)
                                )
                                else
                                    {8969}let pkDisco_7045: bitstring = fail-any in
                                    {8970}in(c, (=pkCli_6987,em1_7046: bitstring));
                                    {8971}let m1_7047: bitstring = em1_7046 in
                                    {8972}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_6987,PartC_7048: bitstring) = m1_7047 in
                                    {8973}new Ns_7049: bitstring;
                                    {8974}new ST_7050: bitstring;
                                    {8975}new TTL_7051: bitstring;
                                    {8976}let gNs_7052: bitstring = exp(g,Ns_7049) in
                                    {8977}let m2_7053: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7052,ST_7050,TTL_7051) in
                                    {8978}event beginSrv(Sess_5022,Cli_5020,gNs_7052);
                                    {8979}out(c, m2_7053);
                                    {8980}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {8981}event endSrv(Cli_5020,Sess_5022,PartC_7048)
                            )
                            else
                                {8982}let v_7054: bool = (Cli_5020 = C) in
                                (
                                    {8983}if v_7054 then
                                    (
                                        {8984}let pkCli_7055: bitstring = pub(skC) in
                                        {8985}let v_7056: bool = (Disco_5021 = A) in
                                        (
                                            {8986}if v_7056 then
                                            (
                                                {8987}let pkDisco_7057: bitstring = pub(skA) in
                                                {8988}in(c, (=pkCli_7055,em1_7058: bitstring));
                                                {8989}let m1_7059: bitstring = em1_7058 in
                                                {8990}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7060: bitstring) = m1_7059 in
                                                {8991}new Ns_7061: bitstring;
                                                {8992}new ST_7062: bitstring;
                                                {8993}new TTL_7063: bitstring;
                                                {8994}let gNs_7064: bitstring = exp(g,Ns_7061) in
                                                {8995}let m2_7065: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7064,ST_7062,TTL_7063) in
                                                {8996}event beginSrv(Sess_5022,Cli_5020,gNs_7064);
                                                {8997}out(c, m2_7065);
                                                {8998}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {8999}event endSrv(Cli_5020,Sess_5022,PartC_7060)
                                            )
                                            else
                                                {9000}let v_7066: bool = (Disco_5021 = B) in
                                                (
                                                    {9001}if v_7066 then
                                                    (
                                                        {9002}let pkDisco_7067: bitstring = pub(skB) in
                                                        {9003}in(c, (=pkCli_7055,em1_7068: bitstring));
                                                        {9004}let m1_7069: bitstring = em1_7068 in
                                                        {9005}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7070: bitstring) = m1_7069 in
                                                        {9006}new Ns_7071: bitstring;
                                                        {9007}new ST_7072: bitstring;
                                                        {9008}new TTL_7073: bitstring;
                                                        {9009}let gNs_7074: bitstring = exp(g,Ns_7071) in
                                                        {9010}let m2_7075: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7074,ST_7072,TTL_7073) in
                                                        {9011}event beginSrv(Sess_5022,Cli_5020,gNs_7074);
                                                        {9012}out(c, m2_7075);
                                                        {9013}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9014}event endSrv(Cli_5020,Sess_5022,PartC_7070)
                                                    )
                                                    else
                                                        {9015}let v_7076: bool = (Disco_5021 = C) in
                                                        (
                                                            {9016}if v_7076 then
                                                            (
                                                                {9017}let pkDisco_7077: bitstring = pub(skC) in
                                                                {9018}in(c, (=pkCli_7055,em1_7078: bitstring));
                                                                {9019}let m1_7079: bitstring = em1_7078 in
                                                                {9020}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7080: bitstring) = m1_7079 in
                                                                {9021}new Ns_7081: bitstring;
                                                                {9022}new ST_7082: bitstring;
                                                                {9023}new TTL_7083: bitstring;
                                                                {9024}let gNs_7084: bitstring = exp(g,Ns_7081) in
                                                                {9025}let m2_7085: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7084,ST_7082,TTL_7083) in
                                                                {9026}event beginSrv(Sess_5022,Cli_5020,gNs_7084);
                                                                {9027}out(c, m2_7085);
                                                                {9028}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {9029}event endSrv(Cli_5020,Sess_5022,PartC_7080)
                                                            )
                                                            else
                                                                {9030}let pkDisco_7086: bitstring = pub(sk(Disco_5021)) in
                                                                {9031}in(c, (=pkCli_7055,em1_7087: bitstring));
                                                                {9032}let m1_7088: bitstring = em1_7087 in
                                                                {9033}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7089: bitstring) = m1_7088 in
                                                                {9034}new Ns_7090: bitstring;
                                                                {9035}new ST_7091: bitstring;
                                                                {9036}new TTL_7092: bitstring;
                                                                {9037}let gNs_7093: bitstring = exp(g,Ns_7090) in
                                                                {9038}let m2_7094: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7093,ST_7091,TTL_7092) in
                                                                {9039}event beginSrv(Sess_5022,Cli_5020,gNs_7093);
                                                                {9040}out(c, m2_7094);
                                                                {9041}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {9042}event endSrv(Cli_5020,Sess_5022,PartC_7089)
                                                        )
                                                        else
                                                            {9043}let pkDisco_7095: bitstring = fail-any in
                                                            {9044}in(c, (=pkCli_7055,em1_7096: bitstring));
                                                            {9045}let m1_7097: bitstring = em1_7096 in
                                                            {9046}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7098: bitstring) = m1_7097 in
                                                            {9047}new Ns_7099: bitstring;
                                                            {9048}new ST_7100: bitstring;
                                                            {9049}new TTL_7101: bitstring;
                                                            {9050}let gNs_7102: bitstring = exp(g,Ns_7099) in
                                                            {9051}let m2_7103: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7102,ST_7100,TTL_7101) in
                                                            {9052}event beginSrv(Sess_5022,Cli_5020,gNs_7102);
                                                            {9053}out(c, m2_7103);
                                                            {9054}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {9055}event endSrv(Cli_5020,Sess_5022,PartC_7098)
                                                )
                                                else
                                                    {9056}let pkDisco_7104: bitstring = fail-any in
                                                    {9057}in(c, (=pkCli_7055,em1_7105: bitstring));
                                                    {9058}let m1_7106: bitstring = em1_7105 in
                                                    {9059}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7107: bitstring) = m1_7106 in
                                                    {9060}new Ns_7108: bitstring;
                                                    {9061}new ST_7109: bitstring;
                                                    {9062}new TTL_7110: bitstring;
                                                    {9063}let gNs_7111: bitstring = exp(g,Ns_7108) in
                                                    {9064}let m2_7112: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7111,ST_7109,TTL_7110) in
                                                    {9065}event beginSrv(Sess_5022,Cli_5020,gNs_7111);
                                                    {9066}out(c, m2_7112);
                                                    {9067}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9068}event endSrv(Cli_5020,Sess_5022,PartC_7107)
                                        )
                                        else
                                            {9069}let pkDisco_7113: bitstring = fail-any in
                                            {9070}in(c, (=pkCli_7055,em1_7114: bitstring));
                                            {9071}let m1_7115: bitstring = em1_7114 in
                                            {9072}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7055,PartC_7116: bitstring) = m1_7115 in
                                            {9073}new Ns_7117: bitstring;
                                            {9074}new ST_7118: bitstring;
                                            {9075}new TTL_7119: bitstring;
                                            {9076}let gNs_7120: bitstring = exp(g,Ns_7117) in
                                            {9077}let m2_7121: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7120,ST_7118,TTL_7119) in
                                            {9078}event beginSrv(Sess_5022,Cli_5020,gNs_7120);
                                            {9079}out(c, m2_7121);
                                            {9080}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9081}event endSrv(Cli_5020,Sess_5022,PartC_7116)
                                    )
                                    else
                                        {9082}let pkCli_7122: bitstring = pub(sk(Cli_5020)) in
                                        {9083}let v_7123: bool = (Disco_5021 = A) in
                                        (
                                            {9084}if v_7123 then
                                            (
                                                {9085}let pkDisco_7124: bitstring = pub(skA) in
                                                {9086}in(c, (=pkCli_7122,em1_7125: bitstring));
                                                {9087}let m1_7126: bitstring = em1_7125 in
                                                {9088}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7127: bitstring) = m1_7126 in
                                                {9089}new Ns_7128: bitstring;
                                                {9090}new ST_7129: bitstring;
                                                {9091}new TTL_7130: bitstring;
                                                {9092}let gNs_7131: bitstring = exp(g,Ns_7128) in
                                                {9093}let m2_7132: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7131,ST_7129,TTL_7130) in
                                                {9094}event beginSrv(Sess_5022,Cli_5020,gNs_7131);
                                                {9095}out(c, m2_7132);
                                                {9096}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9097}event endSrv(Cli_5020,Sess_5022,PartC_7127)
                                            )
                                            else
                                                {9098}let v_7133: bool = (Disco_5021 = B) in
                                                (
                                                    {9099}if v_7133 then
                                                    (
                                                        {9100}let pkDisco_7134: bitstring = pub(skB) in
                                                        {9101}in(c, (=pkCli_7122,em1_7135: bitstring));
                                                        {9102}let m1_7136: bitstring = em1_7135 in
                                                        {9103}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7137: bitstring) = m1_7136 in
                                                        {9104}new Ns_7138: bitstring;
                                                        {9105}new ST_7139: bitstring;
                                                        {9106}new TTL_7140: bitstring;
                                                        {9107}let gNs_7141: bitstring = exp(g,Ns_7138) in
                                                        {9108}let m2_7142: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7141,ST_7139,TTL_7140) in
                                                        {9109}event beginSrv(Sess_5022,Cli_5020,gNs_7141);
                                                        {9110}out(c, m2_7142);
                                                        {9111}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9112}event endSrv(Cli_5020,Sess_5022,PartC_7137)
                                                    )
                                                    else
                                                        {9113}let v_7143: bool = (Disco_5021 = C) in
                                                        (
                                                            {9114}if v_7143 then
                                                            (
                                                                {9115}let pkDisco_7144: bitstring = pub(skC) in
                                                                {9116}in(c, (=pkCli_7122,em1_7145: bitstring));
                                                                {9117}let m1_7146: bitstring = em1_7145 in
                                                                {9118}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7147: bitstring) = m1_7146 in
                                                                {9119}new Ns_7148: bitstring;
                                                                {9120}new ST_7149: bitstring;
                                                                {9121}new TTL_7150: bitstring;
                                                                {9122}let gNs_7151: bitstring = exp(g,Ns_7148) in
                                                                {9123}let m2_7152: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7151,ST_7149,TTL_7150) in
                                                                {9124}event beginSrv(Sess_5022,Cli_5020,gNs_7151);
                                                                {9125}out(c, m2_7152);
                                                                {9126}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {9127}event endSrv(Cli_5020,Sess_5022,PartC_7147)
                                                            )
                                                            else
                                                                {9128}let pkDisco_7153: bitstring = pub(sk(Disco_5021)) in
                                                                {9129}in(c, (=pkCli_7122,em1_7154: bitstring));
                                                                {9130}let m1_7155: bitstring = em1_7154 in
                                                                {9131}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7156: bitstring) = m1_7155 in
                                                                {9132}new Ns_7157: bitstring;
                                                                {9133}new ST_7158: bitstring;
                                                                {9134}new TTL_7159: bitstring;
                                                                {9135}let gNs_7160: bitstring = exp(g,Ns_7157) in
                                                                {9136}let m2_7161: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7160,ST_7158,TTL_7159) in
                                                                {9137}event beginSrv(Sess_5022,Cli_5020,gNs_7160);
                                                                {9138}out(c, m2_7161);
                                                                {9139}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                                {9140}event endSrv(Cli_5020,Sess_5022,PartC_7156)
                                                        )
                                                        else
                                                            {9141}let pkDisco_7162: bitstring = fail-any in
                                                            {9142}in(c, (=pkCli_7122,em1_7163: bitstring));
                                                            {9143}let m1_7164: bitstring = em1_7163 in
                                                            {9144}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7165: bitstring) = m1_7164 in
                                                            {9145}new Ns_7166: bitstring;
                                                            {9146}new ST_7167: bitstring;
                                                            {9147}new TTL_7168: bitstring;
                                                            {9148}let gNs_7169: bitstring = exp(g,Ns_7166) in
                                                            {9149}let m2_7170: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7169,ST_7167,TTL_7168) in
                                                            {9150}event beginSrv(Sess_5022,Cli_5020,gNs_7169);
                                                            {9151}out(c, m2_7170);
                                                            {9152}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {9153}event endSrv(Cli_5020,Sess_5022,PartC_7165)
                                                )
                                                else
                                                    {9154}let pkDisco_7171: bitstring = fail-any in
                                                    {9155}in(c, (=pkCli_7122,em1_7172: bitstring));
                                                    {9156}let m1_7173: bitstring = em1_7172 in
                                                    {9157}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7174: bitstring) = m1_7173 in
                                                    {9158}new Ns_7175: bitstring;
                                                    {9159}new ST_7176: bitstring;
                                                    {9160}new TTL_7177: bitstring;
                                                    {9161}let gNs_7178: bitstring = exp(g,Ns_7175) in
                                                    {9162}let m2_7179: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7178,ST_7176,TTL_7177) in
                                                    {9163}event beginSrv(Sess_5022,Cli_5020,gNs_7178);
                                                    {9164}out(c, m2_7179);
                                                    {9165}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9166}event endSrv(Cli_5020,Sess_5022,PartC_7174)
                                        )
                                        else
                                            {9167}let pkDisco_7180: bitstring = fail-any in
                                            {9168}in(c, (=pkCli_7122,em1_7181: bitstring));
                                            {9169}let m1_7182: bitstring = em1_7181 in
                                            {9170}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7122,PartC_7183: bitstring) = m1_7182 in
                                            {9171}new Ns_7184: bitstring;
                                            {9172}new ST_7185: bitstring;
                                            {9173}new TTL_7186: bitstring;
                                            {9174}let gNs_7187: bitstring = exp(g,Ns_7184) in
                                            {9175}let m2_7188: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7187,ST_7185,TTL_7186) in
                                            {9176}event beginSrv(Sess_5022,Cli_5020,gNs_7187);
                                            {9177}out(c, m2_7188);
                                            {9178}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9179}event endSrv(Cli_5020,Sess_5022,PartC_7183)
                                )
                                else
                                    {9180}let pkCli_7189: bitstring = fail-any in
                                    {9181}let v_7190: bool = (Disco_5021 = A) in
                                    (
                                        {9182}if v_7190 then
                                        (
                                            {9183}let pkDisco_7191: bitstring = pub(skA) in
                                            {9184}in(c, (=pkCli_7189,em1_7192: bitstring));
                                            {9185}let m1_7193: bitstring = em1_7192 in
                                            {9186}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7194: bitstring) = m1_7193 in
                                            {9187}new Ns_7195: bitstring;
                                            {9188}new ST_7196: bitstring;
                                            {9189}new TTL_7197: bitstring;
                                            {9190}let gNs_7198: bitstring = exp(g,Ns_7195) in
                                            {9191}let m2_7199: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7198,ST_7196,TTL_7197) in
                                            {9192}event beginSrv(Sess_5022,Cli_5020,gNs_7198);
                                            {9193}out(c, m2_7199);
                                            {9194}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9195}event endSrv(Cli_5020,Sess_5022,PartC_7194)
                                        )
                                        else
                                            {9196}let v_7200: bool = (Disco_5021 = B) in
                                            (
                                                {9197}if v_7200 then
                                                (
                                                    {9198}let pkDisco_7201: bitstring = pub(skB) in
                                                    {9199}in(c, (=pkCli_7189,em1_7202: bitstring));
                                                    {9200}let m1_7203: bitstring = em1_7202 in
                                                    {9201}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7204: bitstring) = m1_7203 in
                                                    {9202}new Ns_7205: bitstring;
                                                    {9203}new ST_7206: bitstring;
                                                    {9204}new TTL_7207: bitstring;
                                                    {9205}let gNs_7208: bitstring = exp(g,Ns_7205) in
                                                    {9206}let m2_7209: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7208,ST_7206,TTL_7207) in
                                                    {9207}event beginSrv(Sess_5022,Cli_5020,gNs_7208);
                                                    {9208}out(c, m2_7209);
                                                    {9209}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9210}event endSrv(Cli_5020,Sess_5022,PartC_7204)
                                                )
                                                else
                                                    {9211}let v_7210: bool = (Disco_5021 = C) in
                                                    (
                                                        {9212}if v_7210 then
                                                        (
                                                            {9213}let pkDisco_7211: bitstring = pub(skC) in
                                                            {9214}in(c, (=pkCli_7189,em1_7212: bitstring));
                                                            {9215}let m1_7213: bitstring = em1_7212 in
                                                            {9216}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7214: bitstring) = m1_7213 in
                                                            {9217}new Ns_7215: bitstring;
                                                            {9218}new ST_7216: bitstring;
                                                            {9219}new TTL_7217: bitstring;
                                                            {9220}let gNs_7218: bitstring = exp(g,Ns_7215) in
                                                            {9221}let m2_7219: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7218,ST_7216,TTL_7217) in
                                                            {9222}event beginSrv(Sess_5022,Cli_5020,gNs_7218);
                                                            {9223}out(c, m2_7219);
                                                            {9224}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {9225}event endSrv(Cli_5020,Sess_5022,PartC_7214)
                                                        )
                                                        else
                                                            {9226}let pkDisco_7220: bitstring = pub(sk(Disco_5021)) in
                                                            {9227}in(c, (=pkCli_7189,em1_7221: bitstring));
                                                            {9228}let m1_7222: bitstring = em1_7221 in
                                                            {9229}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7223: bitstring) = m1_7222 in
                                                            {9230}new Ns_7224: bitstring;
                                                            {9231}new ST_7225: bitstring;
                                                            {9232}new TTL_7226: bitstring;
                                                            {9233}let gNs_7227: bitstring = exp(g,Ns_7224) in
                                                            {9234}let m2_7228: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7227,ST_7225,TTL_7226) in
                                                            {9235}event beginSrv(Sess_5022,Cli_5020,gNs_7227);
                                                            {9236}out(c, m2_7228);
                                                            {9237}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                            {9238}event endSrv(Cli_5020,Sess_5022,PartC_7223)
                                                    )
                                                    else
                                                        {9239}let pkDisco_7229: bitstring = fail-any in
                                                        {9240}in(c, (=pkCli_7189,em1_7230: bitstring));
                                                        {9241}let m1_7231: bitstring = em1_7230 in
                                                        {9242}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7232: bitstring) = m1_7231 in
                                                        {9243}new Ns_7233: bitstring;
                                                        {9244}new ST_7234: bitstring;
                                                        {9245}new TTL_7235: bitstring;
                                                        {9246}let gNs_7236: bitstring = exp(g,Ns_7233) in
                                                        {9247}let m2_7237: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7236,ST_7234,TTL_7235) in
                                                        {9248}event beginSrv(Sess_5022,Cli_5020,gNs_7236);
                                                        {9249}out(c, m2_7237);
                                                        {9250}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9251}event endSrv(Cli_5020,Sess_5022,PartC_7232)
                                            )
                                            else
                                                {9252}let pkDisco_7238: bitstring = fail-any in
                                                {9253}in(c, (=pkCli_7189,em1_7239: bitstring));
                                                {9254}let m1_7240: bitstring = em1_7239 in
                                                {9255}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7241: bitstring) = m1_7240 in
                                                {9256}new Ns_7242: bitstring;
                                                {9257}new ST_7243: bitstring;
                                                {9258}new TTL_7244: bitstring;
                                                {9259}let gNs_7245: bitstring = exp(g,Ns_7242) in
                                                {9260}let m2_7246: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7245,ST_7243,TTL_7244) in
                                                {9261}event beginSrv(Sess_5022,Cli_5020,gNs_7245);
                                                {9262}out(c, m2_7246);
                                                {9263}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9264}event endSrv(Cli_5020,Sess_5022,PartC_7241)
                                    )
                                    else
                                        {9265}let pkDisco_7247: bitstring = fail-any in
                                        {9266}in(c, (=pkCli_7189,em1_7248: bitstring));
                                        {9267}let m1_7249: bitstring = em1_7248 in
                                        {9268}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7189,PartC_7250: bitstring) = m1_7249 in
                                        {9269}new Ns_7251: bitstring;
                                        {9270}new ST_7252: bitstring;
                                        {9271}new TTL_7253: bitstring;
                                        {9272}let gNs_7254: bitstring = exp(g,Ns_7251) in
                                        {9273}let m2_7255: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7254,ST_7252,TTL_7253) in
                                        {9274}event beginSrv(Sess_5022,Cli_5020,gNs_7254);
                                        {9275}out(c, m2_7255);
                                        {9276}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9277}event endSrv(Cli_5020,Sess_5022,PartC_7250)
                        )
                        else
                            {9278}let pkCli_7256: bitstring = fail-any in
                            {9279}let v_7257: bool = (Disco_5021 = A) in
                            (
                                {9280}if v_7257 then
                                (
                                    {9281}let pkDisco_7258: bitstring = pub(skA) in
                                    {9282}in(c, (=pkCli_7256,em1_7259: bitstring));
                                    {9283}let m1_7260: bitstring = em1_7259 in
                                    {9284}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7261: bitstring) = m1_7260 in
                                    {9285}new Ns_7262: bitstring;
                                    {9286}new ST_7263: bitstring;
                                    {9287}new TTL_7264: bitstring;
                                    {9288}let gNs_7265: bitstring = exp(g,Ns_7262) in
                                    {9289}let m2_7266: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7265,ST_7263,TTL_7264) in
                                    {9290}event beginSrv(Sess_5022,Cli_5020,gNs_7265);
                                    {9291}out(c, m2_7266);
                                    {9292}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9293}event endSrv(Cli_5020,Sess_5022,PartC_7261)
                                )
                                else
                                    {9294}let v_7267: bool = (Disco_5021 = B) in
                                    (
                                        {9295}if v_7267 then
                                        (
                                            {9296}let pkDisco_7268: bitstring = pub(skB) in
                                            {9297}in(c, (=pkCli_7256,em1_7269: bitstring));
                                            {9298}let m1_7270: bitstring = em1_7269 in
                                            {9299}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7271: bitstring) = m1_7270 in
                                            {9300}new Ns_7272: bitstring;
                                            {9301}new ST_7273: bitstring;
                                            {9302}new TTL_7274: bitstring;
                                            {9303}let gNs_7275: bitstring = exp(g,Ns_7272) in
                                            {9304}let m2_7276: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7275,ST_7273,TTL_7274) in
                                            {9305}event beginSrv(Sess_5022,Cli_5020,gNs_7275);
                                            {9306}out(c, m2_7276);
                                            {9307}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9308}event endSrv(Cli_5020,Sess_5022,PartC_7271)
                                        )
                                        else
                                            {9309}let v_7277: bool = (Disco_5021 = C) in
                                            (
                                                {9310}if v_7277 then
                                                (
                                                    {9311}let pkDisco_7278: bitstring = pub(skC) in
                                                    {9312}in(c, (=pkCli_7256,em1_7279: bitstring));
                                                    {9313}let m1_7280: bitstring = em1_7279 in
                                                    {9314}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7281: bitstring) = m1_7280 in
                                                    {9315}new Ns_7282: bitstring;
                                                    {9316}new ST_7283: bitstring;
                                                    {9317}new TTL_7284: bitstring;
                                                    {9318}let gNs_7285: bitstring = exp(g,Ns_7282) in
                                                    {9319}let m2_7286: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7285,ST_7283,TTL_7284) in
                                                    {9320}event beginSrv(Sess_5022,Cli_5020,gNs_7285);
                                                    {9321}out(c, m2_7286);
                                                    {9322}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9323}event endSrv(Cli_5020,Sess_5022,PartC_7281)
                                                )
                                                else
                                                    {9324}let pkDisco_7287: bitstring = pub(sk(Disco_5021)) in
                                                    {9325}in(c, (=pkCli_7256,em1_7288: bitstring));
                                                    {9326}let m1_7289: bitstring = em1_7288 in
                                                    {9327}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7290: bitstring) = m1_7289 in
                                                    {9328}new Ns_7291: bitstring;
                                                    {9329}new ST_7292: bitstring;
                                                    {9330}new TTL_7293: bitstring;
                                                    {9331}let gNs_7294: bitstring = exp(g,Ns_7291) in
                                                    {9332}let m2_7295: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7294,ST_7292,TTL_7293) in
                                                    {9333}event beginSrv(Sess_5022,Cli_5020,gNs_7294);
                                                    {9334}out(c, m2_7295);
                                                    {9335}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9336}event endSrv(Cli_5020,Sess_5022,PartC_7290)
                                            )
                                            else
                                                {9337}let pkDisco_7296: bitstring = fail-any in
                                                {9338}in(c, (=pkCli_7256,em1_7297: bitstring));
                                                {9339}let m1_7298: bitstring = em1_7297 in
                                                {9340}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7299: bitstring) = m1_7298 in
                                                {9341}new Ns_7300: bitstring;
                                                {9342}new ST_7301: bitstring;
                                                {9343}new TTL_7302: bitstring;
                                                {9344}let gNs_7303: bitstring = exp(g,Ns_7300) in
                                                {9345}let m2_7304: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7303,ST_7301,TTL_7302) in
                                                {9346}event beginSrv(Sess_5022,Cli_5020,gNs_7303);
                                                {9347}out(c, m2_7304);
                                                {9348}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9349}event endSrv(Cli_5020,Sess_5022,PartC_7299)
                                    )
                                    else
                                        {9350}let pkDisco_7305: bitstring = fail-any in
                                        {9351}in(c, (=pkCli_7256,em1_7306: bitstring));
                                        {9352}let m1_7307: bitstring = em1_7306 in
                                        {9353}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7308: bitstring) = m1_7307 in
                                        {9354}new Ns_7309: bitstring;
                                        {9355}new ST_7310: bitstring;
                                        {9356}new TTL_7311: bitstring;
                                        {9357}let gNs_7312: bitstring = exp(g,Ns_7309) in
                                        {9358}let m2_7313: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7312,ST_7310,TTL_7311) in
                                        {9359}event beginSrv(Sess_5022,Cli_5020,gNs_7312);
                                        {9360}out(c, m2_7313);
                                        {9361}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9362}event endSrv(Cli_5020,Sess_5022,PartC_7308)
                            )
                            else
                                {9363}let pkDisco_7314: bitstring = fail-any in
                                {9364}in(c, (=pkCli_7256,em1_7315: bitstring));
                                {9365}let m1_7316: bitstring = em1_7315 in
                                {9366}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7256,PartC_7317: bitstring) = m1_7316 in
                                {9367}new Ns_7318: bitstring;
                                {9368}new ST_7319: bitstring;
                                {9369}new TTL_7320: bitstring;
                                {9370}let gNs_7321: bitstring = exp(g,Ns_7318) in
                                {9371}let m2_7322: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7321,ST_7319,TTL_7320) in
                                {9372}event beginSrv(Sess_5022,Cli_5020,gNs_7321);
                                {9373}out(c, m2_7322);
                                {9374}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {9375}event endSrv(Cli_5020,Sess_5022,PartC_7317)
                )
                else
                    {9376}let pkCli_7323: bitstring = fail-any in
                    {9377}let v_7324: bool = (Disco_5021 = A) in
                    (
                        {9378}if v_7324 then
                        (
                            {9379}let pkDisco_7325: bitstring = pub(skA) in
                            {9380}in(c, (=pkCli_7323,em1_7326: bitstring));
                            {9381}let m1_7327: bitstring = em1_7326 in
                            {9382}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7328: bitstring) = m1_7327 in
                            {9383}new Ns_7329: bitstring;
                            {9384}new ST_7330: bitstring;
                            {9385}new TTL_7331: bitstring;
                            {9386}let gNs_7332: bitstring = exp(g,Ns_7329) in
                            {9387}let m2_7333: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7332,ST_7330,TTL_7331) in
                            {9388}event beginSrv(Sess_5022,Cli_5020,gNs_7332);
                            {9389}out(c, m2_7333);
                            {9390}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {9391}event endSrv(Cli_5020,Sess_5022,PartC_7328)
                        )
                        else
                            {9392}let v_7334: bool = (Disco_5021 = B) in
                            (
                                {9393}if v_7334 then
                                (
                                    {9394}let pkDisco_7335: bitstring = pub(skB) in
                                    {9395}in(c, (=pkCli_7323,em1_7336: bitstring));
                                    {9396}let m1_7337: bitstring = em1_7336 in
                                    {9397}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7338: bitstring) = m1_7337 in
                                    {9398}new Ns_7339: bitstring;
                                    {9399}new ST_7340: bitstring;
                                    {9400}new TTL_7341: bitstring;
                                    {9401}let gNs_7342: bitstring = exp(g,Ns_7339) in
                                    {9402}let m2_7343: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7342,ST_7340,TTL_7341) in
                                    {9403}event beginSrv(Sess_5022,Cli_5020,gNs_7342);
                                    {9404}out(c, m2_7343);
                                    {9405}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9406}event endSrv(Cli_5020,Sess_5022,PartC_7338)
                                )
                                else
                                    {9407}let v_7344: bool = (Disco_5021 = C) in
                                    (
                                        {9408}if v_7344 then
                                        (
                                            {9409}let pkDisco_7345: bitstring = pub(skC) in
                                            {9410}in(c, (=pkCli_7323,em1_7346: bitstring));
                                            {9411}let m1_7347: bitstring = em1_7346 in
                                            {9412}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7348: bitstring) = m1_7347 in
                                            {9413}new Ns_7349: bitstring;
                                            {9414}new ST_7350: bitstring;
                                            {9415}new TTL_7351: bitstring;
                                            {9416}let gNs_7352: bitstring = exp(g,Ns_7349) in
                                            {9417}let m2_7353: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7352,ST_7350,TTL_7351) in
                                            {9418}event beginSrv(Sess_5022,Cli_5020,gNs_7352);
                                            {9419}out(c, m2_7353);
                                            {9420}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9421}event endSrv(Cli_5020,Sess_5022,PartC_7348)
                                        )
                                        else
                                            {9422}let pkDisco_7354: bitstring = pub(sk(Disco_5021)) in
                                            {9423}in(c, (=pkCli_7323,em1_7355: bitstring));
                                            {9424}let m1_7356: bitstring = em1_7355 in
                                            {9425}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7357: bitstring) = m1_7356 in
                                            {9426}new Ns_7358: bitstring;
                                            {9427}new ST_7359: bitstring;
                                            {9428}new TTL_7360: bitstring;
                                            {9429}let gNs_7361: bitstring = exp(g,Ns_7358) in
                                            {9430}let m2_7362: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7361,ST_7359,TTL_7360) in
                                            {9431}event beginSrv(Sess_5022,Cli_5020,gNs_7361);
                                            {9432}out(c, m2_7362);
                                            {9433}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9434}event endSrv(Cli_5020,Sess_5022,PartC_7357)
                                    )
                                    else
                                        {9435}let pkDisco_7363: bitstring = fail-any in
                                        {9436}in(c, (=pkCli_7323,em1_7364: bitstring));
                                        {9437}let m1_7365: bitstring = em1_7364 in
                                        {9438}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7366: bitstring) = m1_7365 in
                                        {9439}new Ns_7367: bitstring;
                                        {9440}new ST_7368: bitstring;
                                        {9441}new TTL_7369: bitstring;
                                        {9442}let gNs_7370: bitstring = exp(g,Ns_7367) in
                                        {9443}let m2_7371: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7370,ST_7368,TTL_7369) in
                                        {9444}event beginSrv(Sess_5022,Cli_5020,gNs_7370);
                                        {9445}out(c, m2_7371);
                                        {9446}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9447}event endSrv(Cli_5020,Sess_5022,PartC_7366)
                            )
                            else
                                {9448}let pkDisco_7372: bitstring = fail-any in
                                {9449}in(c, (=pkCli_7323,em1_7373: bitstring));
                                {9450}let m1_7374: bitstring = em1_7373 in
                                {9451}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7375: bitstring) = m1_7374 in
                                {9452}new Ns_7376: bitstring;
                                {9453}new ST_7377: bitstring;
                                {9454}new TTL_7378: bitstring;
                                {9455}let gNs_7379: bitstring = exp(g,Ns_7376) in
                                {9456}let m2_7380: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7379,ST_7377,TTL_7378) in
                                {9457}event beginSrv(Sess_5022,Cli_5020,gNs_7379);
                                {9458}out(c, m2_7380);
                                {9459}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {9460}event endSrv(Cli_5020,Sess_5022,PartC_7375)
                    )
                    else
                        {9461}let pkDisco_7381: bitstring = fail-any in
                        {9462}in(c, (=pkCli_7323,em1_7382: bitstring));
                        {9463}let m1_7383: bitstring = em1_7382 in
                        {9464}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7323,PartC_7384: bitstring) = m1_7383 in
                        {9465}new Ns_7385: bitstring;
                        {9466}new ST_7386: bitstring;
                        {9467}new TTL_7387: bitstring;
                        {9468}let gNs_7388: bitstring = exp(g,Ns_7385) in
                        {9469}let m2_7389: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7388,ST_7386,TTL_7387) in
                        {9470}event beginSrv(Sess_5022,Cli_5020,gNs_7388);
                        {9471}out(c, m2_7389);
                        {9472}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                        {9473}event endSrv(Cli_5020,Sess_5022,PartC_7384)
    )
    else
        {9474}let skSess_7390: bitstring = fail-any in
        {9475}let pkSess_7391: bitstring = pub(skSess_7390) in
        {9476}let v_7392: bool = (Cli_5020 = A) in
        (
            {9477}if v_7392 then
            (
                {9478}let pkCli_7393: bitstring = pub(skA) in
                {9479}let v_7394: bool = (Disco_5021 = A) in
                (
                    {9480}if v_7394 then
                    (
                        {9481}let pkDisco_7395: bitstring = pub(skA) in
                        {9482}in(c, (=pkCli_7393,em1_7396: bitstring));
                        {9483}let m1_7397: bitstring = em1_7396 in
                        {9484}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7398: bitstring) = m1_7397 in
                        {9485}new Ns_7399: bitstring;
                        {9486}new ST_7400: bitstring;
                        {9487}new TTL_7401: bitstring;
                        {9488}let gNs_7402: bitstring = exp(g,Ns_7399) in
                        {9489}let m2_7403: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7402,ST_7400,TTL_7401) in
                        {9490}event beginSrv(Sess_5022,Cli_5020,gNs_7402);
                        {9491}out(c, m2_7403);
                        {9492}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                        {9493}event endSrv(Cli_5020,Sess_5022,PartC_7398)
                    )
                    else
                        {9494}let v_7404: bool = (Disco_5021 = B) in
                        (
                            {9495}if v_7404 then
                            (
                                {9496}let pkDisco_7405: bitstring = pub(skB) in
                                {9497}in(c, (=pkCli_7393,em1_7406: bitstring));
                                {9498}let m1_7407: bitstring = em1_7406 in
                                {9499}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7408: bitstring) = m1_7407 in
                                {9500}new Ns_7409: bitstring;
                                {9501}new ST_7410: bitstring;
                                {9502}new TTL_7411: bitstring;
                                {9503}let gNs_7412: bitstring = exp(g,Ns_7409) in
                                {9504}let m2_7413: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7412,ST_7410,TTL_7411) in
                                {9505}event beginSrv(Sess_5022,Cli_5020,gNs_7412);
                                {9506}out(c, m2_7413);
                                {9507}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {9508}event endSrv(Cli_5020,Sess_5022,PartC_7408)
                            )
                            else
                                {9509}let v_7414: bool = (Disco_5021 = C) in
                                (
                                    {9510}if v_7414 then
                                    (
                                        {9511}let pkDisco_7415: bitstring = pub(skC) in
                                        {9512}in(c, (=pkCli_7393,em1_7416: bitstring));
                                        {9513}let m1_7417: bitstring = em1_7416 in
                                        {9514}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7418: bitstring) = m1_7417 in
                                        {9515}new Ns_7419: bitstring;
                                        {9516}new ST_7420: bitstring;
                                        {9517}new TTL_7421: bitstring;
                                        {9518}let gNs_7422: bitstring = exp(g,Ns_7419) in
                                        {9519}let m2_7423: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7422,ST_7420,TTL_7421) in
                                        {9520}event beginSrv(Sess_5022,Cli_5020,gNs_7422);
                                        {9521}out(c, m2_7423);
                                        {9522}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9523}event endSrv(Cli_5020,Sess_5022,PartC_7418)
                                    )
                                    else
                                        {9524}let pkDisco_7424: bitstring = pub(sk(Disco_5021)) in
                                        {9525}in(c, (=pkCli_7393,em1_7425: bitstring));
                                        {9526}let m1_7426: bitstring = em1_7425 in
                                        {9527}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7427: bitstring) = m1_7426 in
                                        {9528}new Ns_7428: bitstring;
                                        {9529}new ST_7429: bitstring;
                                        {9530}new TTL_7430: bitstring;
                                        {9531}let gNs_7431: bitstring = exp(g,Ns_7428) in
                                        {9532}let m2_7432: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7431,ST_7429,TTL_7430) in
                                        {9533}event beginSrv(Sess_5022,Cli_5020,gNs_7431);
                                        {9534}out(c, m2_7432);
                                        {9535}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9536}event endSrv(Cli_5020,Sess_5022,PartC_7427)
                                )
                                else
                                    {9537}let pkDisco_7433: bitstring = fail-any in
                                    {9538}in(c, (=pkCli_7393,em1_7434: bitstring));
                                    {9539}let m1_7435: bitstring = em1_7434 in
                                    {9540}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7436: bitstring) = m1_7435 in
                                    {9541}new Ns_7437: bitstring;
                                    {9542}new ST_7438: bitstring;
                                    {9543}new TTL_7439: bitstring;
                                    {9544}let gNs_7440: bitstring = exp(g,Ns_7437) in
                                    {9545}let m2_7441: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7440,ST_7438,TTL_7439) in
                                    {9546}event beginSrv(Sess_5022,Cli_5020,gNs_7440);
                                    {9547}out(c, m2_7441);
                                    {9548}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9549}event endSrv(Cli_5020,Sess_5022,PartC_7436)
                        )
                        else
                            {9550}let pkDisco_7442: bitstring = fail-any in
                            {9551}in(c, (=pkCli_7393,em1_7443: bitstring));
                            {9552}let m1_7444: bitstring = em1_7443 in
                            {9553}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7445: bitstring) = m1_7444 in
                            {9554}new Ns_7446: bitstring;
                            {9555}new ST_7447: bitstring;
                            {9556}new TTL_7448: bitstring;
                            {9557}let gNs_7449: bitstring = exp(g,Ns_7446) in
                            {9558}let m2_7450: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7449,ST_7447,TTL_7448) in
                            {9559}event beginSrv(Sess_5022,Cli_5020,gNs_7449);
                            {9560}out(c, m2_7450);
                            {9561}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {9562}event endSrv(Cli_5020,Sess_5022,PartC_7445)
                )
                else
                    {9563}let pkDisco_7451: bitstring = fail-any in
                    {9564}in(c, (=pkCli_7393,em1_7452: bitstring));
                    {9565}let m1_7453: bitstring = em1_7452 in
                    {9566}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7393,PartC_7454: bitstring) = m1_7453 in
                    {9567}new Ns_7455: bitstring;
                    {9568}new ST_7456: bitstring;
                    {9569}new TTL_7457: bitstring;
                    {9570}let gNs_7458: bitstring = exp(g,Ns_7455) in
                    {9571}let m2_7459: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7458,ST_7456,TTL_7457) in
                    {9572}event beginSrv(Sess_5022,Cli_5020,gNs_7458);
                    {9573}out(c, m2_7459);
                    {9574}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                    {9575}event endSrv(Cli_5020,Sess_5022,PartC_7454)
            )
            else
                {9576}let v_7460: bool = (Cli_5020 = B) in
                (
                    {9577}if v_7460 then
                    (
                        {9578}let pkCli_7461: bitstring = pub(skB) in
                        {9579}let v_7462: bool = (Disco_5021 = A) in
                        (
                            {9580}if v_7462 then
                            (
                                {9581}let pkDisco_7463: bitstring = pub(skA) in
                                {9582}in(c, (=pkCli_7461,em1_7464: bitstring));
                                {9583}let m1_7465: bitstring = em1_7464 in
                                {9584}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7466: bitstring) = m1_7465 in
                                {9585}new Ns_7467: bitstring;
                                {9586}new ST_7468: bitstring;
                                {9587}new TTL_7469: bitstring;
                                {9588}let gNs_7470: bitstring = exp(g,Ns_7467) in
                                {9589}let m2_7471: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7470,ST_7468,TTL_7469) in
                                {9590}event beginSrv(Sess_5022,Cli_5020,gNs_7470);
                                {9591}out(c, m2_7471);
                                {9592}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {9593}event endSrv(Cli_5020,Sess_5022,PartC_7466)
                            )
                            else
                                {9594}let v_7472: bool = (Disco_5021 = B) in
                                (
                                    {9595}if v_7472 then
                                    (
                                        {9596}let pkDisco_7473: bitstring = pub(skB) in
                                        {9597}in(c, (=pkCli_7461,em1_7474: bitstring));
                                        {9598}let m1_7475: bitstring = em1_7474 in
                                        {9599}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7476: bitstring) = m1_7475 in
                                        {9600}new Ns_7477: bitstring;
                                        {9601}new ST_7478: bitstring;
                                        {9602}new TTL_7479: bitstring;
                                        {9603}let gNs_7480: bitstring = exp(g,Ns_7477) in
                                        {9604}let m2_7481: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7480,ST_7478,TTL_7479) in
                                        {9605}event beginSrv(Sess_5022,Cli_5020,gNs_7480);
                                        {9606}out(c, m2_7481);
                                        {9607}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9608}event endSrv(Cli_5020,Sess_5022,PartC_7476)
                                    )
                                    else
                                        {9609}let v_7482: bool = (Disco_5021 = C) in
                                        (
                                            {9610}if v_7482 then
                                            (
                                                {9611}let pkDisco_7483: bitstring = pub(skC) in
                                                {9612}in(c, (=pkCli_7461,em1_7484: bitstring));
                                                {9613}let m1_7485: bitstring = em1_7484 in
                                                {9614}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7486: bitstring) = m1_7485 in
                                                {9615}new Ns_7487: bitstring;
                                                {9616}new ST_7488: bitstring;
                                                {9617}new TTL_7489: bitstring;
                                                {9618}let gNs_7490: bitstring = exp(g,Ns_7487) in
                                                {9619}let m2_7491: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7490,ST_7488,TTL_7489) in
                                                {9620}event beginSrv(Sess_5022,Cli_5020,gNs_7490);
                                                {9621}out(c, m2_7491);
                                                {9622}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9623}event endSrv(Cli_5020,Sess_5022,PartC_7486)
                                            )
                                            else
                                                {9624}let pkDisco_7492: bitstring = pub(sk(Disco_5021)) in
                                                {9625}in(c, (=pkCli_7461,em1_7493: bitstring));
                                                {9626}let m1_7494: bitstring = em1_7493 in
                                                {9627}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7495: bitstring) = m1_7494 in
                                                {9628}new Ns_7496: bitstring;
                                                {9629}new ST_7497: bitstring;
                                                {9630}new TTL_7498: bitstring;
                                                {9631}let gNs_7499: bitstring = exp(g,Ns_7496) in
                                                {9632}let m2_7500: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7499,ST_7497,TTL_7498) in
                                                {9633}event beginSrv(Sess_5022,Cli_5020,gNs_7499);
                                                {9634}out(c, m2_7500);
                                                {9635}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9636}event endSrv(Cli_5020,Sess_5022,PartC_7495)
                                        )
                                        else
                                            {9637}let pkDisco_7501: bitstring = fail-any in
                                            {9638}in(c, (=pkCli_7461,em1_7502: bitstring));
                                            {9639}let m1_7503: bitstring = em1_7502 in
                                            {9640}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7504: bitstring) = m1_7503 in
                                            {9641}new Ns_7505: bitstring;
                                            {9642}new ST_7506: bitstring;
                                            {9643}new TTL_7507: bitstring;
                                            {9644}let gNs_7508: bitstring = exp(g,Ns_7505) in
                                            {9645}let m2_7509: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7508,ST_7506,TTL_7507) in
                                            {9646}event beginSrv(Sess_5022,Cli_5020,gNs_7508);
                                            {9647}out(c, m2_7509);
                                            {9648}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9649}event endSrv(Cli_5020,Sess_5022,PartC_7504)
                                )
                                else
                                    {9650}let pkDisco_7510: bitstring = fail-any in
                                    {9651}in(c, (=pkCli_7461,em1_7511: bitstring));
                                    {9652}let m1_7512: bitstring = em1_7511 in
                                    {9653}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7513: bitstring) = m1_7512 in
                                    {9654}new Ns_7514: bitstring;
                                    {9655}new ST_7515: bitstring;
                                    {9656}new TTL_7516: bitstring;
                                    {9657}let gNs_7517: bitstring = exp(g,Ns_7514) in
                                    {9658}let m2_7518: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7517,ST_7515,TTL_7516) in
                                    {9659}event beginSrv(Sess_5022,Cli_5020,gNs_7517);
                                    {9660}out(c, m2_7518);
                                    {9661}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9662}event endSrv(Cli_5020,Sess_5022,PartC_7513)
                        )
                        else
                            {9663}let pkDisco_7519: bitstring = fail-any in
                            {9664}in(c, (=pkCli_7461,em1_7520: bitstring));
                            {9665}let m1_7521: bitstring = em1_7520 in
                            {9666}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7461,PartC_7522: bitstring) = m1_7521 in
                            {9667}new Ns_7523: bitstring;
                            {9668}new ST_7524: bitstring;
                            {9669}new TTL_7525: bitstring;
                            {9670}let gNs_7526: bitstring = exp(g,Ns_7523) in
                            {9671}let m2_7527: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7526,ST_7524,TTL_7525) in
                            {9672}event beginSrv(Sess_5022,Cli_5020,gNs_7526);
                            {9673}out(c, m2_7527);
                            {9674}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {9675}event endSrv(Cli_5020,Sess_5022,PartC_7522)
                    )
                    else
                        {9676}let v_7528: bool = (Cli_5020 = C) in
                        (
                            {9677}if v_7528 then
                            (
                                {9678}let pkCli_7529: bitstring = pub(skC) in
                                {9679}let v_7530: bool = (Disco_5021 = A) in
                                (
                                    {9680}if v_7530 then
                                    (
                                        {9681}let pkDisco_7531: bitstring = pub(skA) in
                                        {9682}in(c, (=pkCli_7529,em1_7532: bitstring));
                                        {9683}let m1_7533: bitstring = em1_7532 in
                                        {9684}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7534: bitstring) = m1_7533 in
                                        {9685}new Ns_7535: bitstring;
                                        {9686}new ST_7536: bitstring;
                                        {9687}new TTL_7537: bitstring;
                                        {9688}let gNs_7538: bitstring = exp(g,Ns_7535) in
                                        {9689}let m2_7539: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7538,ST_7536,TTL_7537) in
                                        {9690}event beginSrv(Sess_5022,Cli_5020,gNs_7538);
                                        {9691}out(c, m2_7539);
                                        {9692}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9693}event endSrv(Cli_5020,Sess_5022,PartC_7534)
                                    )
                                    else
                                        {9694}let v_7540: bool = (Disco_5021 = B) in
                                        (
                                            {9695}if v_7540 then
                                            (
                                                {9696}let pkDisco_7541: bitstring = pub(skB) in
                                                {9697}in(c, (=pkCli_7529,em1_7542: bitstring));
                                                {9698}let m1_7543: bitstring = em1_7542 in
                                                {9699}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7544: bitstring) = m1_7543 in
                                                {9700}new Ns_7545: bitstring;
                                                {9701}new ST_7546: bitstring;
                                                {9702}new TTL_7547: bitstring;
                                                {9703}let gNs_7548: bitstring = exp(g,Ns_7545) in
                                                {9704}let m2_7549: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7548,ST_7546,TTL_7547) in
                                                {9705}event beginSrv(Sess_5022,Cli_5020,gNs_7548);
                                                {9706}out(c, m2_7549);
                                                {9707}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9708}event endSrv(Cli_5020,Sess_5022,PartC_7544)
                                            )
                                            else
                                                {9709}let v_7550: bool = (Disco_5021 = C) in
                                                (
                                                    {9710}if v_7550 then
                                                    (
                                                        {9711}let pkDisco_7551: bitstring = pub(skC) in
                                                        {9712}in(c, (=pkCli_7529,em1_7552: bitstring));
                                                        {9713}let m1_7553: bitstring = em1_7552 in
                                                        {9714}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7554: bitstring) = m1_7553 in
                                                        {9715}new Ns_7555: bitstring;
                                                        {9716}new ST_7556: bitstring;
                                                        {9717}new TTL_7557: bitstring;
                                                        {9718}let gNs_7558: bitstring = exp(g,Ns_7555) in
                                                        {9719}let m2_7559: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7558,ST_7556,TTL_7557) in
                                                        {9720}event beginSrv(Sess_5022,Cli_5020,gNs_7558);
                                                        {9721}out(c, m2_7559);
                                                        {9722}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9723}event endSrv(Cli_5020,Sess_5022,PartC_7554)
                                                    )
                                                    else
                                                        {9724}let pkDisco_7560: bitstring = pub(sk(Disco_5021)) in
                                                        {9725}in(c, (=pkCli_7529,em1_7561: bitstring));
                                                        {9726}let m1_7562: bitstring = em1_7561 in
                                                        {9727}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7563: bitstring) = m1_7562 in
                                                        {9728}new Ns_7564: bitstring;
                                                        {9729}new ST_7565: bitstring;
                                                        {9730}new TTL_7566: bitstring;
                                                        {9731}let gNs_7567: bitstring = exp(g,Ns_7564) in
                                                        {9732}let m2_7568: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7567,ST_7565,TTL_7566) in
                                                        {9733}event beginSrv(Sess_5022,Cli_5020,gNs_7567);
                                                        {9734}out(c, m2_7568);
                                                        {9735}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9736}event endSrv(Cli_5020,Sess_5022,PartC_7563)
                                                )
                                                else
                                                    {9737}let pkDisco_7569: bitstring = fail-any in
                                                    {9738}in(c, (=pkCli_7529,em1_7570: bitstring));
                                                    {9739}let m1_7571: bitstring = em1_7570 in
                                                    {9740}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7572: bitstring) = m1_7571 in
                                                    {9741}new Ns_7573: bitstring;
                                                    {9742}new ST_7574: bitstring;
                                                    {9743}new TTL_7575: bitstring;
                                                    {9744}let gNs_7576: bitstring = exp(g,Ns_7573) in
                                                    {9745}let m2_7577: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7576,ST_7574,TTL_7575) in
                                                    {9746}event beginSrv(Sess_5022,Cli_5020,gNs_7576);
                                                    {9747}out(c, m2_7577);
                                                    {9748}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9749}event endSrv(Cli_5020,Sess_5022,PartC_7572)
                                        )
                                        else
                                            {9750}let pkDisco_7578: bitstring = fail-any in
                                            {9751}in(c, (=pkCli_7529,em1_7579: bitstring));
                                            {9752}let m1_7580: bitstring = em1_7579 in
                                            {9753}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7581: bitstring) = m1_7580 in
                                            {9754}new Ns_7582: bitstring;
                                            {9755}new ST_7583: bitstring;
                                            {9756}new TTL_7584: bitstring;
                                            {9757}let gNs_7585: bitstring = exp(g,Ns_7582) in
                                            {9758}let m2_7586: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7585,ST_7583,TTL_7584) in
                                            {9759}event beginSrv(Sess_5022,Cli_5020,gNs_7585);
                                            {9760}out(c, m2_7586);
                                            {9761}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9762}event endSrv(Cli_5020,Sess_5022,PartC_7581)
                                )
                                else
                                    {9763}let pkDisco_7587: bitstring = fail-any in
                                    {9764}in(c, (=pkCli_7529,em1_7588: bitstring));
                                    {9765}let m1_7589: bitstring = em1_7588 in
                                    {9766}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7529,PartC_7590: bitstring) = m1_7589 in
                                    {9767}new Ns_7591: bitstring;
                                    {9768}new ST_7592: bitstring;
                                    {9769}new TTL_7593: bitstring;
                                    {9770}let gNs_7594: bitstring = exp(g,Ns_7591) in
                                    {9771}let m2_7595: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7594,ST_7592,TTL_7593) in
                                    {9772}event beginSrv(Sess_5022,Cli_5020,gNs_7594);
                                    {9773}out(c, m2_7595);
                                    {9774}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9775}event endSrv(Cli_5020,Sess_5022,PartC_7590)
                            )
                            else
                                {9776}let pkCli_7596: bitstring = pub(sk(Cli_5020)) in
                                {9777}let v_7597: bool = (Disco_5021 = A) in
                                (
                                    {9778}if v_7597 then
                                    (
                                        {9779}let pkDisco_7598: bitstring = pub(skA) in
                                        {9780}in(c, (=pkCli_7596,em1_7599: bitstring));
                                        {9781}let m1_7600: bitstring = em1_7599 in
                                        {9782}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7601: bitstring) = m1_7600 in
                                        {9783}new Ns_7602: bitstring;
                                        {9784}new ST_7603: bitstring;
                                        {9785}new TTL_7604: bitstring;
                                        {9786}let gNs_7605: bitstring = exp(g,Ns_7602) in
                                        {9787}let m2_7606: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7605,ST_7603,TTL_7604) in
                                        {9788}event beginSrv(Sess_5022,Cli_5020,gNs_7605);
                                        {9789}out(c, m2_7606);
                                        {9790}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9791}event endSrv(Cli_5020,Sess_5022,PartC_7601)
                                    )
                                    else
                                        {9792}let v_7607: bool = (Disco_5021 = B) in
                                        (
                                            {9793}if v_7607 then
                                            (
                                                {9794}let pkDisco_7608: bitstring = pub(skB) in
                                                {9795}in(c, (=pkCli_7596,em1_7609: bitstring));
                                                {9796}let m1_7610: bitstring = em1_7609 in
                                                {9797}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7611: bitstring) = m1_7610 in
                                                {9798}new Ns_7612: bitstring;
                                                {9799}new ST_7613: bitstring;
                                                {9800}new TTL_7614: bitstring;
                                                {9801}let gNs_7615: bitstring = exp(g,Ns_7612) in
                                                {9802}let m2_7616: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7615,ST_7613,TTL_7614) in
                                                {9803}event beginSrv(Sess_5022,Cli_5020,gNs_7615);
                                                {9804}out(c, m2_7616);
                                                {9805}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9806}event endSrv(Cli_5020,Sess_5022,PartC_7611)
                                            )
                                            else
                                                {9807}let v_7617: bool = (Disco_5021 = C) in
                                                (
                                                    {9808}if v_7617 then
                                                    (
                                                        {9809}let pkDisco_7618: bitstring = pub(skC) in
                                                        {9810}in(c, (=pkCli_7596,em1_7619: bitstring));
                                                        {9811}let m1_7620: bitstring = em1_7619 in
                                                        {9812}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7621: bitstring) = m1_7620 in
                                                        {9813}new Ns_7622: bitstring;
                                                        {9814}new ST_7623: bitstring;
                                                        {9815}new TTL_7624: bitstring;
                                                        {9816}let gNs_7625: bitstring = exp(g,Ns_7622) in
                                                        {9817}let m2_7626: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7625,ST_7623,TTL_7624) in
                                                        {9818}event beginSrv(Sess_5022,Cli_5020,gNs_7625);
                                                        {9819}out(c, m2_7626);
                                                        {9820}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9821}event endSrv(Cli_5020,Sess_5022,PartC_7621)
                                                    )
                                                    else
                                                        {9822}let pkDisco_7627: bitstring = pub(sk(Disco_5021)) in
                                                        {9823}in(c, (=pkCli_7596,em1_7628: bitstring));
                                                        {9824}let m1_7629: bitstring = em1_7628 in
                                                        {9825}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7630: bitstring) = m1_7629 in
                                                        {9826}new Ns_7631: bitstring;
                                                        {9827}new ST_7632: bitstring;
                                                        {9828}new TTL_7633: bitstring;
                                                        {9829}let gNs_7634: bitstring = exp(g,Ns_7631) in
                                                        {9830}let m2_7635: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7634,ST_7632,TTL_7633) in
                                                        {9831}event beginSrv(Sess_5022,Cli_5020,gNs_7634);
                                                        {9832}out(c, m2_7635);
                                                        {9833}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                        {9834}event endSrv(Cli_5020,Sess_5022,PartC_7630)
                                                )
                                                else
                                                    {9835}let pkDisco_7636: bitstring = fail-any in
                                                    {9836}in(c, (=pkCli_7596,em1_7637: bitstring));
                                                    {9837}let m1_7638: bitstring = em1_7637 in
                                                    {9838}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7639: bitstring) = m1_7638 in
                                                    {9839}new Ns_7640: bitstring;
                                                    {9840}new ST_7641: bitstring;
                                                    {9841}new TTL_7642: bitstring;
                                                    {9842}let gNs_7643: bitstring = exp(g,Ns_7640) in
                                                    {9843}let m2_7644: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7643,ST_7641,TTL_7642) in
                                                    {9844}event beginSrv(Sess_5022,Cli_5020,gNs_7643);
                                                    {9845}out(c, m2_7644);
                                                    {9846}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9847}event endSrv(Cli_5020,Sess_5022,PartC_7639)
                                        )
                                        else
                                            {9848}let pkDisco_7645: bitstring = fail-any in
                                            {9849}in(c, (=pkCli_7596,em1_7646: bitstring));
                                            {9850}let m1_7647: bitstring = em1_7646 in
                                            {9851}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7648: bitstring) = m1_7647 in
                                            {9852}new Ns_7649: bitstring;
                                            {9853}new ST_7650: bitstring;
                                            {9854}new TTL_7651: bitstring;
                                            {9855}let gNs_7652: bitstring = exp(g,Ns_7649) in
                                            {9856}let m2_7653: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7652,ST_7650,TTL_7651) in
                                            {9857}event beginSrv(Sess_5022,Cli_5020,gNs_7652);
                                            {9858}out(c, m2_7653);
                                            {9859}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9860}event endSrv(Cli_5020,Sess_5022,PartC_7648)
                                )
                                else
                                    {9861}let pkDisco_7654: bitstring = fail-any in
                                    {9862}in(c, (=pkCli_7596,em1_7655: bitstring));
                                    {9863}let m1_7656: bitstring = em1_7655 in
                                    {9864}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7596,PartC_7657: bitstring) = m1_7656 in
                                    {9865}new Ns_7658: bitstring;
                                    {9866}new ST_7659: bitstring;
                                    {9867}new TTL_7660: bitstring;
                                    {9868}let gNs_7661: bitstring = exp(g,Ns_7658) in
                                    {9869}let m2_7662: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7661,ST_7659,TTL_7660) in
                                    {9870}event beginSrv(Sess_5022,Cli_5020,gNs_7661);
                                    {9871}out(c, m2_7662);
                                    {9872}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9873}event endSrv(Cli_5020,Sess_5022,PartC_7657)
                        )
                        else
                            {9874}let pkCli_7663: bitstring = fail-any in
                            {9875}let v_7664: bool = (Disco_5021 = A) in
                            (
                                {9876}if v_7664 then
                                (
                                    {9877}let pkDisco_7665: bitstring = pub(skA) in
                                    {9878}in(c, (=pkCli_7663,em1_7666: bitstring));
                                    {9879}let m1_7667: bitstring = em1_7666 in
                                    {9880}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7668: bitstring) = m1_7667 in
                                    {9881}new Ns_7669: bitstring;
                                    {9882}new ST_7670: bitstring;
                                    {9883}new TTL_7671: bitstring;
                                    {9884}let gNs_7672: bitstring = exp(g,Ns_7669) in
                                    {9885}let m2_7673: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7672,ST_7670,TTL_7671) in
                                    {9886}event beginSrv(Sess_5022,Cli_5020,gNs_7672);
                                    {9887}out(c, m2_7673);
                                    {9888}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {9889}event endSrv(Cli_5020,Sess_5022,PartC_7668)
                                )
                                else
                                    {9890}let v_7674: bool = (Disco_5021 = B) in
                                    (
                                        {9891}if v_7674 then
                                        (
                                            {9892}let pkDisco_7675: bitstring = pub(skB) in
                                            {9893}in(c, (=pkCli_7663,em1_7676: bitstring));
                                            {9894}let m1_7677: bitstring = em1_7676 in
                                            {9895}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7678: bitstring) = m1_7677 in
                                            {9896}new Ns_7679: bitstring;
                                            {9897}new ST_7680: bitstring;
                                            {9898}new TTL_7681: bitstring;
                                            {9899}let gNs_7682: bitstring = exp(g,Ns_7679) in
                                            {9900}let m2_7683: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7682,ST_7680,TTL_7681) in
                                            {9901}event beginSrv(Sess_5022,Cli_5020,gNs_7682);
                                            {9902}out(c, m2_7683);
                                            {9903}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {9904}event endSrv(Cli_5020,Sess_5022,PartC_7678)
                                        )
                                        else
                                            {9905}let v_7684: bool = (Disco_5021 = C) in
                                            (
                                                {9906}if v_7684 then
                                                (
                                                    {9907}let pkDisco_7685: bitstring = pub(skC) in
                                                    {9908}in(c, (=pkCli_7663,em1_7686: bitstring));
                                                    {9909}let m1_7687: bitstring = em1_7686 in
                                                    {9910}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7688: bitstring) = m1_7687 in
                                                    {9911}new Ns_7689: bitstring;
                                                    {9912}new ST_7690: bitstring;
                                                    {9913}new TTL_7691: bitstring;
                                                    {9914}let gNs_7692: bitstring = exp(g,Ns_7689) in
                                                    {9915}let m2_7693: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7692,ST_7690,TTL_7691) in
                                                    {9916}event beginSrv(Sess_5022,Cli_5020,gNs_7692);
                                                    {9917}out(c, m2_7693);
                                                    {9918}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9919}event endSrv(Cli_5020,Sess_5022,PartC_7688)
                                                )
                                                else
                                                    {9920}let pkDisco_7694: bitstring = pub(sk(Disco_5021)) in
                                                    {9921}in(c, (=pkCli_7663,em1_7695: bitstring));
                                                    {9922}let m1_7696: bitstring = em1_7695 in
                                                    {9923}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7697: bitstring) = m1_7696 in
                                                    {9924}new Ns_7698: bitstring;
                                                    {9925}new ST_7699: bitstring;
                                                    {9926}new TTL_7700: bitstring;
                                                    {9927}let gNs_7701: bitstring = exp(g,Ns_7698) in
                                                    {9928}let m2_7702: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7701,ST_7699,TTL_7700) in
                                                    {9929}event beginSrv(Sess_5022,Cli_5020,gNs_7701);
                                                    {9930}out(c, m2_7702);
                                                    {9931}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                    {9932}event endSrv(Cli_5020,Sess_5022,PartC_7697)
                                            )
                                            else
                                                {9933}let pkDisco_7703: bitstring = fail-any in
                                                {9934}in(c, (=pkCli_7663,em1_7704: bitstring));
                                                {9935}let m1_7705: bitstring = em1_7704 in
                                                {9936}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7706: bitstring) = m1_7705 in
                                                {9937}new Ns_7707: bitstring;
                                                {9938}new ST_7708: bitstring;
                                                {9939}new TTL_7709: bitstring;
                                                {9940}let gNs_7710: bitstring = exp(g,Ns_7707) in
                                                {9941}let m2_7711: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7710,ST_7708,TTL_7709) in
                                                {9942}event beginSrv(Sess_5022,Cli_5020,gNs_7710);
                                                {9943}out(c, m2_7711);
                                                {9944}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                                {9945}event endSrv(Cli_5020,Sess_5022,PartC_7706)
                                    )
                                    else
                                        {9946}let pkDisco_7712: bitstring = fail-any in
                                        {9947}in(c, (=pkCli_7663,em1_7713: bitstring));
                                        {9948}let m1_7714: bitstring = em1_7713 in
                                        {9949}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7715: bitstring) = m1_7714 in
                                        {9950}new Ns_7716: bitstring;
                                        {9951}new ST_7717: bitstring;
                                        {9952}new TTL_7718: bitstring;
                                        {9953}let gNs_7719: bitstring = exp(g,Ns_7716) in
                                        {9954}let m2_7720: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7719,ST_7717,TTL_7718) in
                                        {9955}event beginSrv(Sess_5022,Cli_5020,gNs_7719);
                                        {9956}out(c, m2_7720);
                                        {9957}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {9958}event endSrv(Cli_5020,Sess_5022,PartC_7715)
                            )
                            else
                                {9959}let pkDisco_7721: bitstring = fail-any in
                                {9960}in(c, (=pkCli_7663,em1_7722: bitstring));
                                {9961}let m1_7723: bitstring = em1_7722 in
                                {9962}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7663,PartC_7724: bitstring) = m1_7723 in
                                {9963}new Ns_7725: bitstring;
                                {9964}new ST_7726: bitstring;
                                {9965}new TTL_7727: bitstring;
                                {9966}let gNs_7728: bitstring = exp(g,Ns_7725) in
                                {9967}let m2_7729: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7728,ST_7726,TTL_7727) in
                                {9968}event beginSrv(Sess_5022,Cli_5020,gNs_7728);
                                {9969}out(c, m2_7729);
                                {9970}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {9971}event endSrv(Cli_5020,Sess_5022,PartC_7724)
                )
                else
                    {9972}let pkCli_7730: bitstring = fail-any in
                    {9973}let v_7731: bool = (Disco_5021 = A) in
                    (
                        {9974}if v_7731 then
                        (
                            {9975}let pkDisco_7732: bitstring = pub(skA) in
                            {9976}in(c, (=pkCli_7730,em1_7733: bitstring));
                            {9977}let m1_7734: bitstring = em1_7733 in
                            {9978}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7735: bitstring) = m1_7734 in
                            {9979}new Ns_7736: bitstring;
                            {9980}new ST_7737: bitstring;
                            {9981}new TTL_7738: bitstring;
                            {9982}let gNs_7739: bitstring = exp(g,Ns_7736) in
                            {9983}let m2_7740: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7739,ST_7737,TTL_7738) in
                            {9984}event beginSrv(Sess_5022,Cli_5020,gNs_7739);
                            {9985}out(c, m2_7740);
                            {9986}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {9987}event endSrv(Cli_5020,Sess_5022,PartC_7735)
                        )
                        else
                            {9988}let v_7741: bool = (Disco_5021 = B) in
                            (
                                {9989}if v_7741 then
                                (
                                    {9990}let pkDisco_7742: bitstring = pub(skB) in
                                    {9991}in(c, (=pkCli_7730,em1_7743: bitstring));
                                    {9992}let m1_7744: bitstring = em1_7743 in
                                    {9993}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7745: bitstring) = m1_7744 in
                                    {9994}new Ns_7746: bitstring;
                                    {9995}new ST_7747: bitstring;
                                    {9996}new TTL_7748: bitstring;
                                    {9997}let gNs_7749: bitstring = exp(g,Ns_7746) in
                                    {9998}let m2_7750: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7749,ST_7747,TTL_7748) in
                                    {9999}event beginSrv(Sess_5022,Cli_5020,gNs_7749);
                                    {10000}out(c, m2_7750);
                                    {10001}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {10002}event endSrv(Cli_5020,Sess_5022,PartC_7745)
                                )
                                else
                                    {10003}let v_7751: bool = (Disco_5021 = C) in
                                    (
                                        {10004}if v_7751 then
                                        (
                                            {10005}let pkDisco_7752: bitstring = pub(skC) in
                                            {10006}in(c, (=pkCli_7730,em1_7753: bitstring));
                                            {10007}let m1_7754: bitstring = em1_7753 in
                                            {10008}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7755: bitstring) = m1_7754 in
                                            {10009}new Ns_7756: bitstring;
                                            {10010}new ST_7757: bitstring;
                                            {10011}new TTL_7758: bitstring;
                                            {10012}let gNs_7759: bitstring = exp(g,Ns_7756) in
                                            {10013}let m2_7760: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7759,ST_7757,TTL_7758) in
                                            {10014}event beginSrv(Sess_5022,Cli_5020,gNs_7759);
                                            {10015}out(c, m2_7760);
                                            {10016}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {10017}event endSrv(Cli_5020,Sess_5022,PartC_7755)
                                        )
                                        else
                                            {10018}let pkDisco_7761: bitstring = pub(sk(Disco_5021)) in
                                            {10019}in(c, (=pkCli_7730,em1_7762: bitstring));
                                            {10020}let m1_7763: bitstring = em1_7762 in
                                            {10021}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7764: bitstring) = m1_7763 in
                                            {10022}new Ns_7765: bitstring;
                                            {10023}new ST_7766: bitstring;
                                            {10024}new TTL_7767: bitstring;
                                            {10025}let gNs_7768: bitstring = exp(g,Ns_7765) in
                                            {10026}let m2_7769: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7768,ST_7766,TTL_7767) in
                                            {10027}event beginSrv(Sess_5022,Cli_5020,gNs_7768);
                                            {10028}out(c, m2_7769);
                                            {10029}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                            {10030}event endSrv(Cli_5020,Sess_5022,PartC_7764)
                                    )
                                    else
                                        {10031}let pkDisco_7770: bitstring = fail-any in
                                        {10032}in(c, (=pkCli_7730,em1_7771: bitstring));
                                        {10033}let m1_7772: bitstring = em1_7771 in
                                        {10034}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7773: bitstring) = m1_7772 in
                                        {10035}new Ns_7774: bitstring;
                                        {10036}new ST_7775: bitstring;
                                        {10037}new TTL_7776: bitstring;
                                        {10038}let gNs_7777: bitstring = exp(g,Ns_7774) in
                                        {10039}let m2_7778: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7777,ST_7775,TTL_7776) in
                                        {10040}event beginSrv(Sess_5022,Cli_5020,gNs_7777);
                                        {10041}out(c, m2_7778);
                                        {10042}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                        {10043}event endSrv(Cli_5020,Sess_5022,PartC_7773)
                            )
                            else
                                {10044}let pkDisco_7779: bitstring = fail-any in
                                {10045}in(c, (=pkCli_7730,em1_7780: bitstring));
                                {10046}let m1_7781: bitstring = em1_7780 in
                                {10047}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7782: bitstring) = m1_7781 in
                                {10048}new Ns_7783: bitstring;
                                {10049}new ST_7784: bitstring;
                                {10050}new TTL_7785: bitstring;
                                {10051}let gNs_7786: bitstring = exp(g,Ns_7783) in
                                {10052}let m2_7787: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7786,ST_7784,TTL_7785) in
                                {10053}event beginSrv(Sess_5022,Cli_5020,gNs_7786);
                                {10054}out(c, m2_7787);
                                {10055}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {10056}event endSrv(Cli_5020,Sess_5022,PartC_7782)
                    )
                    else
                        {10057}let pkDisco_7788: bitstring = fail-any in
                        {10058}in(c, (=pkCli_7730,em1_7789: bitstring));
                        {10059}let m1_7790: bitstring = em1_7789 in
                        {10060}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7730,PartC_7791: bitstring) = m1_7790 in
                        {10061}new Ns_7792: bitstring;
                        {10062}new ST_7793: bitstring;
                        {10063}new TTL_7794: bitstring;
                        {10064}let gNs_7795: bitstring = exp(g,Ns_7792) in
                        {10065}let m2_7796: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7795,ST_7793,TTL_7794) in
                        {10066}event beginSrv(Sess_5022,Cli_5020,gNs_7795);
                        {10067}out(c, m2_7796);
                        {10068}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                        {10069}event endSrv(Cli_5020,Sess_5022,PartC_7791)
        )
        else
            {10070}let pkCli_7797: bitstring = fail-any in
            {10071}let v_7798: bool = (Disco_5021 = A) in
            (
                {10072}if v_7798 then
                (
                    {10073}let pkDisco_7799: bitstring = pub(skA) in
                    {10074}in(c, (=pkCli_7797,em1_7800: bitstring));
                    {10075}let m1_7801: bitstring = em1_7800 in
                    {10076}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7802: bitstring) = m1_7801 in
                    {10077}new Ns_7803: bitstring;
                    {10078}new ST_7804: bitstring;
                    {10079}new TTL_7805: bitstring;
                    {10080}let gNs_7806: bitstring = exp(g,Ns_7803) in
                    {10081}let m2_7807: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7806,ST_7804,TTL_7805) in
                    {10082}event beginSrv(Sess_5022,Cli_5020,gNs_7806);
                    {10083}out(c, m2_7807);
                    {10084}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                    {10085}event endSrv(Cli_5020,Sess_5022,PartC_7802)
                )
                else
                    {10086}let v_7808: bool = (Disco_5021 = B) in
                    (
                        {10087}if v_7808 then
                        (
                            {10088}let pkDisco_7809: bitstring = pub(skB) in
                            {10089}in(c, (=pkCli_7797,em1_7810: bitstring));
                            {10090}let m1_7811: bitstring = em1_7810 in
                            {10091}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7812: bitstring) = m1_7811 in
                            {10092}new Ns_7813: bitstring;
                            {10093}new ST_7814: bitstring;
                            {10094}new TTL_7815: bitstring;
                            {10095}let gNs_7816: bitstring = exp(g,Ns_7813) in
                            {10096}let m2_7817: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7816,ST_7814,TTL_7815) in
                            {10097}event beginSrv(Sess_5022,Cli_5020,gNs_7816);
                            {10098}out(c, m2_7817);
                            {10099}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                            {10100}event endSrv(Cli_5020,Sess_5022,PartC_7812)
                        )
                        else
                            {10101}let v_7818: bool = (Disco_5021 = C) in
                            (
                                {10102}if v_7818 then
                                (
                                    {10103}let pkDisco_7819: bitstring = pub(skC) in
                                    {10104}in(c, (=pkCli_7797,em1_7820: bitstring));
                                    {10105}let m1_7821: bitstring = em1_7820 in
                                    {10106}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7822: bitstring) = m1_7821 in
                                    {10107}new Ns_7823: bitstring;
                                    {10108}new ST_7824: bitstring;
                                    {10109}new TTL_7825: bitstring;
                                    {10110}let gNs_7826: bitstring = exp(g,Ns_7823) in
                                    {10111}let m2_7827: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7826,ST_7824,TTL_7825) in
                                    {10112}event beginSrv(Sess_5022,Cli_5020,gNs_7826);
                                    {10113}out(c, m2_7827);
                                    {10114}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {10115}event endSrv(Cli_5020,Sess_5022,PartC_7822)
                                )
                                else
                                    {10116}let pkDisco_7828: bitstring = pub(sk(Disco_5021)) in
                                    {10117}in(c, (=pkCli_7797,em1_7829: bitstring));
                                    {10118}let m1_7830: bitstring = em1_7829 in
                                    {10119}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7831: bitstring) = m1_7830 in
                                    {10120}new Ns_7832: bitstring;
                                    {10121}new ST_7833: bitstring;
                                    {10122}new TTL_7834: bitstring;
                                    {10123}let gNs_7835: bitstring = exp(g,Ns_7832) in
                                    {10124}let m2_7836: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7835,ST_7833,TTL_7834) in
                                    {10125}event beginSrv(Sess_5022,Cli_5020,gNs_7835);
                                    {10126}out(c, m2_7836);
                                    {10127}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                    {10128}event endSrv(Cli_5020,Sess_5022,PartC_7831)
                            )
                            else
                                {10129}let pkDisco_7837: bitstring = fail-any in
                                {10130}in(c, (=pkCli_7797,em1_7838: bitstring));
                                {10131}let m1_7839: bitstring = em1_7838 in
                                {10132}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7840: bitstring) = m1_7839 in
                                {10133}new Ns_7841: bitstring;
                                {10134}new ST_7842: bitstring;
                                {10135}new TTL_7843: bitstring;
                                {10136}let gNs_7844: bitstring = exp(g,Ns_7841) in
                                {10137}let m2_7845: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7844,ST_7842,TTL_7843) in
                                {10138}event beginSrv(Sess_5022,Cli_5020,gNs_7844);
                                {10139}out(c, m2_7845);
                                {10140}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                                {10141}event endSrv(Cli_5020,Sess_5022,PartC_7840)
                    )
                    else
                        {10142}let pkDisco_7846: bitstring = fail-any in
                        {10143}in(c, (=pkCli_7797,em1_7847: bitstring));
                        {10144}let m1_7848: bitstring = em1_7847 in
                        {10145}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7849: bitstring) = m1_7848 in
                        {10146}new Ns_7850: bitstring;
                        {10147}new ST_7851: bitstring;
                        {10148}new TTL_7852: bitstring;
                        {10149}let gNs_7853: bitstring = exp(g,Ns_7850) in
                        {10150}let m2_7854: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7853,ST_7851,TTL_7852) in
                        {10151}event beginSrv(Sess_5022,Cli_5020,gNs_7853);
                        {10152}out(c, m2_7854);
                        {10153}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                        {10154}event endSrv(Cli_5020,Sess_5022,PartC_7849)
            )
            else
                {10155}let pkDisco_7855: bitstring = fail-any in
                {10156}in(c, (=pkCli_7797,em1_7856: bitstring));
                {10157}let m1_7857: bitstring = em1_7856 in
                {10158}let (=OpenSecureChannelRequest,=Sess_5022,=pkCli_7797,PartC_7858: bitstring) = m1_7857 in
                {10159}new Ns_7859: bitstring;
                {10160}new ST_7860: bitstring;
                {10161}new TTL_7861: bitstring;
                {10162}let gNs_7862: bitstring = exp(g,Ns_7859) in
                {10163}let m2_7863: bitstring = (OpenSecureChannelResponse,Cli_5020,gNs_7862,ST_7860,TTL_7861) in
                {10164}event beginSrv(Sess_5022,Cli_5020,gNs_7862);
                {10165}out(c, m2_7863);
                {10166}if ((Cli_5020 = A) || ((Cli_5020 = B) || (Cli_5020 = C))) then
                {10167}event endSrv(Cli_5020,Sess_5022,PartC_7858)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 63 rules. 301 rules in the queue.
400 rules inserted. The rule base contains 99 rules. 301 rules in the queue.
600 rules inserted. The rule base contains 99 rules. 299 rules in the queue.
800 rules inserted. The rule base contains 107 rules. 277 rules in the queue.
1000 rules inserted. The rule base contains 75 rules. 273 rules in the queue.
1200 rules inserted. The rule base contains 147 rules. 205 rules in the queue.
1400 rules inserted. The rule base contains 250 rules. 135 rules in the queue.
1600 rules inserted. The rule base contains 426 rules. 18 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
goal reachable: attacker(N_41153) -> end(endCli(B[],C[],N_41153))

1. The attacker initially knows B[].
attacker(B[]).

2. The attacker initially knows C[].
attacker(C[]).

3. By 2, the attacker may know C[].
By 1, the attacker may know B[].
By 1, the attacker may know B[].
Using the function 3-tuple the attacker may obtain (C[],B[],B[]).
attacker((C[],B[],B[])).

4. The attacker has some term UP_41182.
attacker(UP_41182).

5. The attacker has some term SP_41181.
attacker(SP_41181).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skB[]).
By 6, the attacker may know None.
By 5, the attacker may know SP_41181.
By 4, the attacker may know UP_41182.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skB[]),None,SP_41181,UP_41182).
attacker((GetEndpointResponse,pub(skB[]),None,SP_41181,UP_41182)).

10. The attacker has some term TTL_41180.
attacker(TTL_41180).

11. The attacker has some term ST_41179.
attacker(ST_41179).

12. We assume as hypothesis that
attacker(N_41186).

13. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

14. By 13, the attacker may know OpenSecureChannelResponse.
By 2, the attacker may know C[].
By 12, the attacker may know N_41186.
By 11, the attacker may know ST_41179.
By 10, the attacker may know TTL_41180.
Using the function 5-tuple the attacker may obtain (OpenSecureChannelResponse,C[],N_41186,ST_41179,TTL_41180).
attacker((OpenSecureChannelResponse,C[],N_41186,ST_41179,TTL_41180)).

15. The message (C[],B[],B[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skB[]),None,SP_41181,UP_41182) that the attacker may have by 9 may be received at input {1526}.
The message (OpenSecureChannelResponse,C[],N_41186,ST_41179,TTL_41180) that the attacker may have by 14 may be received at input {1532}.
So event endCli(B[],C[],N_41186) may be executed at {1536}.
end(endCli(B[],C[],N_41186)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,B)) at {8} in copy a_41191

out(c, GetEndpointRequest) at {1525} in copy a_41191

in(c, (GetEndpointResponse,pub(skB),None,a_41189,a_41190)) at {1526} in copy a_41191

new Nc_1750 creating Nc_71012 at {1527} in copy a_41191

event(beginCli(C,B,exp(g,Nc_71012))) at {1530} in copy a_41191

out(c, (pub(skC),(OpenSecureChannelRequest,B,pub(skC),exp(g,Nc_71012)))) at {1531} in copy a_41191

in(c, (OpenSecureChannelResponse,C,a,a_41187,a_41188)) at {1532} in copy a_41191

event(endCli(B,C,a)) at {1536} in copy a_41191

The event endCli(B,C,a) is executed.
A trace has been found.
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is false.
-- Query event(endSrv(X_71048,Y_71049,N_71050)) ==> event(beginCli(X_71048,Y_71049,N_71050))
Completing...
200 rules inserted. The rule base contains 63 rules. 301 rules in the queue.
400 rules inserted. The rule base contains 99 rules. 301 rules in the queue.
600 rules inserted. The rule base contains 99 rules. 299 rules in the queue.
800 rules inserted. The rule base contains 111 rules. 273 rules in the queue.
1000 rules inserted. The rule base contains 78 rules. 270 rules in the queue.
1200 rules inserted. The rule base contains 149 rules. 203 rules in the queue.
1400 rules inserted. The rule base contains 262 rules. 124 rules in the queue.
1600 rules inserted. The rule base contains 444 rules. 0 rules in the queue.
Starting query event(endSrv(X_71048,Y_71049,N_71050)) ==> event(beginCli(X_71048,Y_71049,N_71050))
goal reachable: attacker(N_103560) -> end(endSrv(B[],C[],N_103560))

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows B[].
attacker(B[]).

3. By 2, the attacker may know B[].
By 2, the attacker may know B[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (B[],B[],C[]).
attacker((B[],B[],C[])).

4. We assume as hypothesis that
attacker(N_103585).

5. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 1, the attacker may know C[].
By 5, the attacker may know pub(skB[]).
By 4, the attacker may know N_103585.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelRequest,C[],pub(skB[]),N_103585).
attacker((OpenSecureChannelRequest,C[],pub(skB[]),N_103585)).

8. By 5, the attacker may know pub(skB[]).
By 7, the attacker may know (OpenSecureChannelRequest,C[],pub(skB[]),N_103585).
Using the function 2-tuple the attacker may obtain (pub(skB[]),(OpenSecureChannelRequest,C[],pub(skB[]),N_103585)).
attacker((pub(skB[]),(OpenSecureChannelRequest,C[],pub(skB[]),N_103585))).

9. The message (B[],B[],C[]) that the attacker may have by 3 may be received at input {5998}.
The message (pub(skB[]),(OpenSecureChannelRequest,C[],pub(skB[]),N_103585)) that the attacker may have by 8 may be received at input {7515}.
So event endSrv(B[],C[],N_103585) may be executed at {7526}.
end(endSrv(B[],C[],N_103585)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (B,B,C)) at {5998} in copy a_103587

in(c, (pub(skB),(OpenSecureChannelRequest,C,pub(skB),a_103586))) at {7515} in copy a_103587

new Ns_6055 creating Ns_128552 at {7518} in copy a_103587

new ST_6056 creating ST_128553 at {7519} in copy a_103587

new TTL_6057 creating TTL_128554 at {7520} in copy a_103587

event(beginSrv(C,B,exp(g,Ns_128552))) at {7523} in copy a_103587

out(c, (OpenSecureChannelResponse,B,exp(g,Ns_128552),ST_128553,TTL_128554)) at {7524} in copy a_103587

event(endSrv(B,C,a_103586)) at {7526} in copy a_103587

The event endSrv(B,C,a_103586) is executed.
A trace has been found.
RESULT event(endSrv(X_71048,Y_71049,N_71050)) ==> event(beginCli(X_71048,Y_71049,N_71050)) is false.
