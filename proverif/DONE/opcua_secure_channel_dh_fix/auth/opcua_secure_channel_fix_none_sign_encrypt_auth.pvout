Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let gNc: bitstring = exp(g,Nc) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc) in
                            {24}event beginCli(Cli,Sess,gNc);
                            {25}out(c, (pkCli,m1));
                            {26}in(c, em2: bitstring);
                            {27}let m2: bitstring = em2 in
                            {28}let (=OpenSecureChannelResponse,=Cli,PartS: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {29}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {30}event endCli(Sess,Cli,PartS)
                        )
                        else
                            {31}let v_522: bool = (Sess = B) in
                            (
                                {32}if v_522 then
                                (
                                    {33}let pkSess_523: bitstring = pub(skB) in
                                    {34}out(c, GetEndpointRequest);
                                    {35}in(c, (=GetEndpointResponse,=pkSess_523,=None,SP_524: bitstring,UP_525: bitstring));
                                    {36}new Nc_526: bitstring;
                                    {37}let gNc_527: bitstring = exp(g,Nc_526) in
                                    {38}let m1_528: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_527) in
                                    {39}event beginCli(Cli,Sess,gNc_527);
                                    {40}out(c, (pkCli,m1_528));
                                    {41}in(c, em2_529: bitstring);
                                    {42}let m2_530: bitstring = em2_529 in
                                    {43}let (=OpenSecureChannelResponse,=Cli,PartS_531: bitstring,ST_532: bitstring,TTL_533: bitstring) = m2_530 in
                                    {44}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {45}event endCli(Sess,Cli,PartS_531)
                                )
                                else
                                    {46}let v_534: bool = (Sess = C) in
                                    (
                                        {47}if v_534 then
                                        (
                                            {48}let pkSess_535: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (=GetEndpointResponse,=pkSess_535,=None,SP_536: bitstring,UP_537: bitstring));
                                            {51}new Nc_538: bitstring;
                                            {52}let gNc_539: bitstring = exp(g,Nc_538) in
                                            {53}let m1_540: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_539) in
                                            {54}event beginCli(Cli,Sess,gNc_539);
                                            {55}out(c, (pkCli,m1_540));
                                            {56}in(c, em2_541: bitstring);
                                            {57}let m2_542: bitstring = em2_541 in
                                            {58}let (=OpenSecureChannelResponse,=Cli,PartS_543: bitstring,ST_544: bitstring,TTL_545: bitstring) = m2_542 in
                                            {59}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {60}event endCli(Sess,Cli,PartS_543)
                                        )
                                        else
                                            {61}let pkSess_546: bitstring = pub(sk(Sess)) in
                                            {62}out(c, GetEndpointRequest);
                                            {63}in(c, (=GetEndpointResponse,=pkSess_546,=None,SP_547: bitstring,UP_548: bitstring));
                                            {64}new Nc_549: bitstring;
                                            {65}let gNc_550: bitstring = exp(g,Nc_549) in
                                            {66}let m1_551: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_550) in
                                            {67}event beginCli(Cli,Sess,gNc_550);
                                            {68}out(c, (pkCli,m1_551));
                                            {69}in(c, em2_552: bitstring);
                                            {70}let m2_553: bitstring = em2_552 in
                                            {71}let (=OpenSecureChannelResponse,=Cli,PartS_554: bitstring,ST_555: bitstring,TTL_556: bitstring) = m2_553 in
                                            {72}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {73}event endCli(Sess,Cli,PartS_554)
                                    )
                                    else
                                        {74}let pkSess_557: bitstring = fail-any in
                                        {75}out(c, GetEndpointRequest);
                                        {76}in(c, (=GetEndpointResponse,=pkSess_557,=None,SP_558: bitstring,UP_559: bitstring));
                                        {77}new Nc_560: bitstring;
                                        {78}let gNc_561: bitstring = exp(g,Nc_560) in
                                        {79}let m1_562: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_561) in
                                        {80}event beginCli(Cli,Sess,gNc_561);
                                        {81}out(c, (pkCli,m1_562));
                                        {82}in(c, em2_563: bitstring);
                                        {83}let m2_564: bitstring = em2_563 in
                                        {84}let (=OpenSecureChannelResponse,=Cli,PartS_565: bitstring,ST_566: bitstring,TTL_567: bitstring) = m2_564 in
                                        {85}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {86}event endCli(Sess,Cli,PartS_565)
                            )
                            else
                                {87}let pkSess_568: bitstring = fail-any in
                                {88}out(c, GetEndpointRequest);
                                {89}in(c, (=GetEndpointResponse,=pkSess_568,=None,SP_569: bitstring,UP_570: bitstring));
                                {90}new Nc_571: bitstring;
                                {91}let gNc_572: bitstring = exp(g,Nc_571) in
                                {92}let m1_573: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_572) in
                                {93}event beginCli(Cli,Sess,gNc_572);
                                {94}out(c, (pkCli,m1_573));
                                {95}in(c, em2_574: bitstring);
                                {96}let m2_575: bitstring = em2_574 in
                                {97}let (=OpenSecureChannelResponse,=Cli,PartS_576: bitstring,ST_577: bitstring,TTL_578: bitstring) = m2_575 in
                                {98}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {99}event endCli(Sess,Cli,PartS_576)
                    )
                    else
                        {100}let pkSess_579: bitstring = fail-any in
                        {101}out(c, GetEndpointRequest);
                        {102}in(c, (=GetEndpointResponse,=pkSess_579,=None,SP_580: bitstring,UP_581: bitstring));
                        {103}new Nc_582: bitstring;
                        {104}let gNc_583: bitstring = exp(g,Nc_582) in
                        {105}let m1_584: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_583) in
                        {106}event beginCli(Cli,Sess,gNc_583);
                        {107}out(c, (pkCli,m1_584));
                        {108}in(c, em2_585: bitstring);
                        {109}let m2_586: bitstring = em2_585 in
                        {110}let (=OpenSecureChannelResponse,=Cli,PartS_587: bitstring,ST_588: bitstring,TTL_589: bitstring) = m2_586 in
                        {111}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {112}event endCli(Sess,Cli,PartS_587)
                )
                else
                    {113}let v_590: bool = (Disco = B) in
                    (
                        {114}if v_590 then
                        (
                            {115}let pkDisco_591: bitstring = pub(skB) in
                            {116}let v_592: bool = (Sess = A) in
                            (
                                {117}if v_592 then
                                (
                                    {118}let pkSess_593: bitstring = pub(skA) in
                                    {119}out(c, GetEndpointRequest);
                                    {120}in(c, (=GetEndpointResponse,=pkSess_593,=None,SP_594: bitstring,UP_595: bitstring));
                                    {121}new Nc_596: bitstring;
                                    {122}let gNc_597: bitstring = exp(g,Nc_596) in
                                    {123}let m1_598: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_597) in
                                    {124}event beginCli(Cli,Sess,gNc_597);
                                    {125}out(c, (pkCli,m1_598));
                                    {126}in(c, em2_599: bitstring);
                                    {127}let m2_600: bitstring = em2_599 in
                                    {128}let (=OpenSecureChannelResponse,=Cli,PartS_601: bitstring,ST_602: bitstring,TTL_603: bitstring) = m2_600 in
                                    {129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {130}event endCli(Sess,Cli,PartS_601)
                                )
                                else
                                    {131}let v_604: bool = (Sess = B) in
                                    (
                                        {132}if v_604 then
                                        (
                                            {133}let pkSess_605: bitstring = pub(skB) in
                                            {134}out(c, GetEndpointRequest);
                                            {135}in(c, (=GetEndpointResponse,=pkSess_605,=None,SP_606: bitstring,UP_607: bitstring));
                                            {136}new Nc_608: bitstring;
                                            {137}let gNc_609: bitstring = exp(g,Nc_608) in
                                            {138}let m1_610: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_609) in
                                            {139}event beginCli(Cli,Sess,gNc_609);
                                            {140}out(c, (pkCli,m1_610));
                                            {141}in(c, em2_611: bitstring);
                                            {142}let m2_612: bitstring = em2_611 in
                                            {143}let (=OpenSecureChannelResponse,=Cli,PartS_613: bitstring,ST_614: bitstring,TTL_615: bitstring) = m2_612 in
                                            {144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {145}event endCli(Sess,Cli,PartS_613)
                                        )
                                        else
                                            {146}let v_616: bool = (Sess = C) in
                                            (
                                                {147}if v_616 then
                                                (
                                                    {148}let pkSess_617: bitstring = pub(skC) in
                                                    {149}out(c, GetEndpointRequest);
                                                    {150}in(c, (=GetEndpointResponse,=pkSess_617,=None,SP_618: bitstring,UP_619: bitstring));
                                                    {151}new Nc_620: bitstring;
                                                    {152}let gNc_621: bitstring = exp(g,Nc_620) in
                                                    {153}let m1_622: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_621) in
                                                    {154}event beginCli(Cli,Sess,gNc_621);
                                                    {155}out(c, (pkCli,m1_622));
                                                    {156}in(c, em2_623: bitstring);
                                                    {157}let m2_624: bitstring = em2_623 in
                                                    {158}let (=OpenSecureChannelResponse,=Cli,PartS_625: bitstring,ST_626: bitstring,TTL_627: bitstring) = m2_624 in
                                                    {159}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {160}event endCli(Sess,Cli,PartS_625)
                                                )
                                                else
                                                    {161}let pkSess_628: bitstring = pub(sk(Sess)) in
                                                    {162}out(c, GetEndpointRequest);
                                                    {163}in(c, (=GetEndpointResponse,=pkSess_628,=None,SP_629: bitstring,UP_630: bitstring));
                                                    {164}new Nc_631: bitstring;
                                                    {165}let gNc_632: bitstring = exp(g,Nc_631) in
                                                    {166}let m1_633: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_632) in
                                                    {167}event beginCli(Cli,Sess,gNc_632);
                                                    {168}out(c, (pkCli,m1_633));
                                                    {169}in(c, em2_634: bitstring);
                                                    {170}let m2_635: bitstring = em2_634 in
                                                    {171}let (=OpenSecureChannelResponse,=Cli,PartS_636: bitstring,ST_637: bitstring,TTL_638: bitstring) = m2_635 in
                                                    {172}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {173}event endCli(Sess,Cli,PartS_636)
                                            )
                                            else
                                                {174}let pkSess_639: bitstring = fail-any in
                                                {175}out(c, GetEndpointRequest);
                                                {176}in(c, (=GetEndpointResponse,=pkSess_639,=None,SP_640: bitstring,UP_641: bitstring));
                                                {177}new Nc_642: bitstring;
                                                {178}let gNc_643: bitstring = exp(g,Nc_642) in
                                                {179}let m1_644: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_643) in
                                                {180}event beginCli(Cli,Sess,gNc_643);
                                                {181}out(c, (pkCli,m1_644));
                                                {182}in(c, em2_645: bitstring);
                                                {183}let m2_646: bitstring = em2_645 in
                                                {184}let (=OpenSecureChannelResponse,=Cli,PartS_647: bitstring,ST_648: bitstring,TTL_649: bitstring) = m2_646 in
                                                {185}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {186}event endCli(Sess,Cli,PartS_647)
                                    )
                                    else
                                        {187}let pkSess_650: bitstring = fail-any in
                                        {188}out(c, GetEndpointRequest);
                                        {189}in(c, (=GetEndpointResponse,=pkSess_650,=None,SP_651: bitstring,UP_652: bitstring));
                                        {190}new Nc_653: bitstring;
                                        {191}let gNc_654: bitstring = exp(g,Nc_653) in
                                        {192}let m1_655: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_654) in
                                        {193}event beginCli(Cli,Sess,gNc_654);
                                        {194}out(c, (pkCli,m1_655));
                                        {195}in(c, em2_656: bitstring);
                                        {196}let m2_657: bitstring = em2_656 in
                                        {197}let (=OpenSecureChannelResponse,=Cli,PartS_658: bitstring,ST_659: bitstring,TTL_660: bitstring) = m2_657 in
                                        {198}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {199}event endCli(Sess,Cli,PartS_658)
                            )
                            else
                                {200}let pkSess_661: bitstring = fail-any in
                                {201}out(c, GetEndpointRequest);
                                {202}in(c, (=GetEndpointResponse,=pkSess_661,=None,SP_662: bitstring,UP_663: bitstring));
                                {203}new Nc_664: bitstring;
                                {204}let gNc_665: bitstring = exp(g,Nc_664) in
                                {205}let m1_666: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_665) in
                                {206}event beginCli(Cli,Sess,gNc_665);
                                {207}out(c, (pkCli,m1_666));
                                {208}in(c, em2_667: bitstring);
                                {209}let m2_668: bitstring = em2_667 in
                                {210}let (=OpenSecureChannelResponse,=Cli,PartS_669: bitstring,ST_670: bitstring,TTL_671: bitstring) = m2_668 in
                                {211}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {212}event endCli(Sess,Cli,PartS_669)
                        )
                        else
                            {213}let v_672: bool = (Disco = C) in
                            (
                                {214}if v_672 then
                                (
                                    {215}let pkDisco_673: bitstring = pub(skC) in
                                    {216}let v_674: bool = (Sess = A) in
                                    (
                                        {217}if v_674 then
                                        (
                                            {218}let pkSess_675: bitstring = pub(skA) in
                                            {219}out(c, GetEndpointRequest);
                                            {220}in(c, (=GetEndpointResponse,=pkSess_675,=None,SP_676: bitstring,UP_677: bitstring));
                                            {221}new Nc_678: bitstring;
                                            {222}let gNc_679: bitstring = exp(g,Nc_678) in
                                            {223}let m1_680: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_679) in
                                            {224}event beginCli(Cli,Sess,gNc_679);
                                            {225}out(c, (pkCli,m1_680));
                                            {226}in(c, em2_681: bitstring);
                                            {227}let m2_682: bitstring = em2_681 in
                                            {228}let (=OpenSecureChannelResponse,=Cli,PartS_683: bitstring,ST_684: bitstring,TTL_685: bitstring) = m2_682 in
                                            {229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {230}event endCli(Sess,Cli,PartS_683)
                                        )
                                        else
                                            {231}let v_686: bool = (Sess = B) in
                                            (
                                                {232}if v_686 then
                                                (
                                                    {233}let pkSess_687: bitstring = pub(skB) in
                                                    {234}out(c, GetEndpointRequest);
                                                    {235}in(c, (=GetEndpointResponse,=pkSess_687,=None,SP_688: bitstring,UP_689: bitstring));
                                                    {236}new Nc_690: bitstring;
                                                    {237}let gNc_691: bitstring = exp(g,Nc_690) in
                                                    {238}let m1_692: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_691) in
                                                    {239}event beginCli(Cli,Sess,gNc_691);
                                                    {240}out(c, (pkCli,m1_692));
                                                    {241}in(c, em2_693: bitstring);
                                                    {242}let m2_694: bitstring = em2_693 in
                                                    {243}let (=OpenSecureChannelResponse,=Cli,PartS_695: bitstring,ST_696: bitstring,TTL_697: bitstring) = m2_694 in
                                                    {244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {245}event endCli(Sess,Cli,PartS_695)
                                                )
                                                else
                                                    {246}let v_698: bool = (Sess = C) in
                                                    (
                                                        {247}if v_698 then
                                                        (
                                                            {248}let pkSess_699: bitstring = pub(skC) in
                                                            {249}out(c, GetEndpointRequest);
                                                            {250}in(c, (=GetEndpointResponse,=pkSess_699,=None,SP_700: bitstring,UP_701: bitstring));
                                                            {251}new Nc_702: bitstring;
                                                            {252}let gNc_703: bitstring = exp(g,Nc_702) in
                                                            {253}let m1_704: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_703) in
                                                            {254}event beginCli(Cli,Sess,gNc_703);
                                                            {255}out(c, (pkCli,m1_704));
                                                            {256}in(c, em2_705: bitstring);
                                                            {257}let m2_706: bitstring = em2_705 in
                                                            {258}let (=OpenSecureChannelResponse,=Cli,PartS_707: bitstring,ST_708: bitstring,TTL_709: bitstring) = m2_706 in
                                                            {259}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {260}event endCli(Sess,Cli,PartS_707)
                                                        )
                                                        else
                                                            {261}let pkSess_710: bitstring = pub(sk(Sess)) in
                                                            {262}out(c, GetEndpointRequest);
                                                            {263}in(c, (=GetEndpointResponse,=pkSess_710,=None,SP_711: bitstring,UP_712: bitstring));
                                                            {264}new Nc_713: bitstring;
                                                            {265}let gNc_714: bitstring = exp(g,Nc_713) in
                                                            {266}let m1_715: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_714) in
                                                            {267}event beginCli(Cli,Sess,gNc_714);
                                                            {268}out(c, (pkCli,m1_715));
                                                            {269}in(c, em2_716: bitstring);
                                                            {270}let m2_717: bitstring = em2_716 in
                                                            {271}let (=OpenSecureChannelResponse,=Cli,PartS_718: bitstring,ST_719: bitstring,TTL_720: bitstring) = m2_717 in
                                                            {272}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {273}event endCli(Sess,Cli,PartS_718)
                                                    )
                                                    else
                                                        {274}let pkSess_721: bitstring = fail-any in
                                                        {275}out(c, GetEndpointRequest);
                                                        {276}in(c, (=GetEndpointResponse,=pkSess_721,=None,SP_722: bitstring,UP_723: bitstring));
                                                        {277}new Nc_724: bitstring;
                                                        {278}let gNc_725: bitstring = exp(g,Nc_724) in
                                                        {279}let m1_726: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_725) in
                                                        {280}event beginCli(Cli,Sess,gNc_725);
                                                        {281}out(c, (pkCli,m1_726));
                                                        {282}in(c, em2_727: bitstring);
                                                        {283}let m2_728: bitstring = em2_727 in
                                                        {284}let (=OpenSecureChannelResponse,=Cli,PartS_729: bitstring,ST_730: bitstring,TTL_731: bitstring) = m2_728 in
                                                        {285}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {286}event endCli(Sess,Cli,PartS_729)
                                            )
                                            else
                                                {287}let pkSess_732: bitstring = fail-any in
                                                {288}out(c, GetEndpointRequest);
                                                {289}in(c, (=GetEndpointResponse,=pkSess_732,=None,SP_733: bitstring,UP_734: bitstring));
                                                {290}new Nc_735: bitstring;
                                                {291}let gNc_736: bitstring = exp(g,Nc_735) in
                                                {292}let m1_737: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_736) in
                                                {293}event beginCli(Cli,Sess,gNc_736);
                                                {294}out(c, (pkCli,m1_737));
                                                {295}in(c, em2_738: bitstring);
                                                {296}let m2_739: bitstring = em2_738 in
                                                {297}let (=OpenSecureChannelResponse,=Cli,PartS_740: bitstring,ST_741: bitstring,TTL_742: bitstring) = m2_739 in
                                                {298}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {299}event endCli(Sess,Cli,PartS_740)
                                    )
                                    else
                                        {300}let pkSess_743: bitstring = fail-any in
                                        {301}out(c, GetEndpointRequest);
                                        {302}in(c, (=GetEndpointResponse,=pkSess_743,=None,SP_744: bitstring,UP_745: bitstring));
                                        {303}new Nc_746: bitstring;
                                        {304}let gNc_747: bitstring = exp(g,Nc_746) in
                                        {305}let m1_748: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_747) in
                                        {306}event beginCli(Cli,Sess,gNc_747);
                                        {307}out(c, (pkCli,m1_748));
                                        {308}in(c, em2_749: bitstring);
                                        {309}let m2_750: bitstring = em2_749 in
                                        {310}let (=OpenSecureChannelResponse,=Cli,PartS_751: bitstring,ST_752: bitstring,TTL_753: bitstring) = m2_750 in
                                        {311}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {312}event endCli(Sess,Cli,PartS_751)
                                )
                                else
                                    {313}let pkDisco_754: bitstring = pub(sk(Disco)) in
                                    {314}let v_755: bool = (Sess = A) in
                                    (
                                        {315}if v_755 then
                                        (
                                            {316}let pkSess_756: bitstring = pub(skA) in
                                            {317}out(c, GetEndpointRequest);
                                            {318}in(c, (=GetEndpointResponse,=pkSess_756,=None,SP_757: bitstring,UP_758: bitstring));
                                            {319}new Nc_759: bitstring;
                                            {320}let gNc_760: bitstring = exp(g,Nc_759) in
                                            {321}let m1_761: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_760) in
                                            {322}event beginCli(Cli,Sess,gNc_760);
                                            {323}out(c, (pkCli,m1_761));
                                            {324}in(c, em2_762: bitstring);
                                            {325}let m2_763: bitstring = em2_762 in
                                            {326}let (=OpenSecureChannelResponse,=Cli,PartS_764: bitstring,ST_765: bitstring,TTL_766: bitstring) = m2_763 in
                                            {327}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {328}event endCli(Sess,Cli,PartS_764)
                                        )
                                        else
                                            {329}let v_767: bool = (Sess = B) in
                                            (
                                                {330}if v_767 then
                                                (
                                                    {331}let pkSess_768: bitstring = pub(skB) in
                                                    {332}out(c, GetEndpointRequest);
                                                    {333}in(c, (=GetEndpointResponse,=pkSess_768,=None,SP_769: bitstring,UP_770: bitstring));
                                                    {334}new Nc_771: bitstring;
                                                    {335}let gNc_772: bitstring = exp(g,Nc_771) in
                                                    {336}let m1_773: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_772) in
                                                    {337}event beginCli(Cli,Sess,gNc_772);
                                                    {338}out(c, (pkCli,m1_773));
                                                    {339}in(c, em2_774: bitstring);
                                                    {340}let m2_775: bitstring = em2_774 in
                                                    {341}let (=OpenSecureChannelResponse,=Cli,PartS_776: bitstring,ST_777: bitstring,TTL_778: bitstring) = m2_775 in
                                                    {342}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {343}event endCli(Sess,Cli,PartS_776)
                                                )
                                                else
                                                    {344}let v_779: bool = (Sess = C) in
                                                    (
                                                        {345}if v_779 then
                                                        (
                                                            {346}let pkSess_780: bitstring = pub(skC) in
                                                            {347}out(c, GetEndpointRequest);
                                                            {348}in(c, (=GetEndpointResponse,=pkSess_780,=None,SP_781: bitstring,UP_782: bitstring));
                                                            {349}new Nc_783: bitstring;
                                                            {350}let gNc_784: bitstring = exp(g,Nc_783) in
                                                            {351}let m1_785: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_784) in
                                                            {352}event beginCli(Cli,Sess,gNc_784);
                                                            {353}out(c, (pkCli,m1_785));
                                                            {354}in(c, em2_786: bitstring);
                                                            {355}let m2_787: bitstring = em2_786 in
                                                            {356}let (=OpenSecureChannelResponse,=Cli,PartS_788: bitstring,ST_789: bitstring,TTL_790: bitstring) = m2_787 in
                                                            {357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {358}event endCli(Sess,Cli,PartS_788)
                                                        )
                                                        else
                                                            {359}let pkSess_791: bitstring = pub(sk(Sess)) in
                                                            {360}out(c, GetEndpointRequest);
                                                            {361}in(c, (=GetEndpointResponse,=pkSess_791,=None,SP_792: bitstring,UP_793: bitstring));
                                                            {362}new Nc_794: bitstring;
                                                            {363}let gNc_795: bitstring = exp(g,Nc_794) in
                                                            {364}let m1_796: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_795) in
                                                            {365}event beginCli(Cli,Sess,gNc_795);
                                                            {366}out(c, (pkCli,m1_796));
                                                            {367}in(c, em2_797: bitstring);
                                                            {368}let m2_798: bitstring = em2_797 in
                                                            {369}let (=OpenSecureChannelResponse,=Cli,PartS_799: bitstring,ST_800: bitstring,TTL_801: bitstring) = m2_798 in
                                                            {370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {371}event endCli(Sess,Cli,PartS_799)
                                                    )
                                                    else
                                                        {372}let pkSess_802: bitstring = fail-any in
                                                        {373}out(c, GetEndpointRequest);
                                                        {374}in(c, (=GetEndpointResponse,=pkSess_802,=None,SP_803: bitstring,UP_804: bitstring));
                                                        {375}new Nc_805: bitstring;
                                                        {376}let gNc_806: bitstring = exp(g,Nc_805) in
                                                        {377}let m1_807: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_806) in
                                                        {378}event beginCli(Cli,Sess,gNc_806);
                                                        {379}out(c, (pkCli,m1_807));
                                                        {380}in(c, em2_808: bitstring);
                                                        {381}let m2_809: bitstring = em2_808 in
                                                        {382}let (=OpenSecureChannelResponse,=Cli,PartS_810: bitstring,ST_811: bitstring,TTL_812: bitstring) = m2_809 in
                                                        {383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {384}event endCli(Sess,Cli,PartS_810)
                                            )
                                            else
                                                {385}let pkSess_813: bitstring = fail-any in
                                                {386}out(c, GetEndpointRequest);
                                                {387}in(c, (=GetEndpointResponse,=pkSess_813,=None,SP_814: bitstring,UP_815: bitstring));
                                                {388}new Nc_816: bitstring;
                                                {389}let gNc_817: bitstring = exp(g,Nc_816) in
                                                {390}let m1_818: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_817) in
                                                {391}event beginCli(Cli,Sess,gNc_817);
                                                {392}out(c, (pkCli,m1_818));
                                                {393}in(c, em2_819: bitstring);
                                                {394}let m2_820: bitstring = em2_819 in
                                                {395}let (=OpenSecureChannelResponse,=Cli,PartS_821: bitstring,ST_822: bitstring,TTL_823: bitstring) = m2_820 in
                                                {396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {397}event endCli(Sess,Cli,PartS_821)
                                    )
                                    else
                                        {398}let pkSess_824: bitstring = fail-any in
                                        {399}out(c, GetEndpointRequest);
                                        {400}in(c, (=GetEndpointResponse,=pkSess_824,=None,SP_825: bitstring,UP_826: bitstring));
                                        {401}new Nc_827: bitstring;
                                        {402}let gNc_828: bitstring = exp(g,Nc_827) in
                                        {403}let m1_829: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_828) in
                                        {404}event beginCli(Cli,Sess,gNc_828);
                                        {405}out(c, (pkCli,m1_829));
                                        {406}in(c, em2_830: bitstring);
                                        {407}let m2_831: bitstring = em2_830 in
                                        {408}let (=OpenSecureChannelResponse,=Cli,PartS_832: bitstring,ST_833: bitstring,TTL_834: bitstring) = m2_831 in
                                        {409}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {410}event endCli(Sess,Cli,PartS_832)
                            )
                            else
                                {411}let pkDisco_835: bitstring = fail-any in
                                {412}let v_836: bool = (Sess = A) in
                                (
                                    {413}if v_836 then
                                    (
                                        {414}let pkSess_837: bitstring = pub(skA) in
                                        {415}out(c, GetEndpointRequest);
                                        {416}in(c, (=GetEndpointResponse,=pkSess_837,=None,SP_838: bitstring,UP_839: bitstring));
                                        {417}new Nc_840: bitstring;
                                        {418}let gNc_841: bitstring = exp(g,Nc_840) in
                                        {419}let m1_842: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_841) in
                                        {420}event beginCli(Cli,Sess,gNc_841);
                                        {421}out(c, (pkCli,m1_842));
                                        {422}in(c, em2_843: bitstring);
                                        {423}let m2_844: bitstring = em2_843 in
                                        {424}let (=OpenSecureChannelResponse,=Cli,PartS_845: bitstring,ST_846: bitstring,TTL_847: bitstring) = m2_844 in
                                        {425}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {426}event endCli(Sess,Cli,PartS_845)
                                    )
                                    else
                                        {427}let v_848: bool = (Sess = B) in
                                        (
                                            {428}if v_848 then
                                            (
                                                {429}let pkSess_849: bitstring = pub(skB) in
                                                {430}out(c, GetEndpointRequest);
                                                {431}in(c, (=GetEndpointResponse,=pkSess_849,=None,SP_850: bitstring,UP_851: bitstring));
                                                {432}new Nc_852: bitstring;
                                                {433}let gNc_853: bitstring = exp(g,Nc_852) in
                                                {434}let m1_854: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_853) in
                                                {435}event beginCli(Cli,Sess,gNc_853);
                                                {436}out(c, (pkCli,m1_854));
                                                {437}in(c, em2_855: bitstring);
                                                {438}let m2_856: bitstring = em2_855 in
                                                {439}let (=OpenSecureChannelResponse,=Cli,PartS_857: bitstring,ST_858: bitstring,TTL_859: bitstring) = m2_856 in
                                                {440}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {441}event endCli(Sess,Cli,PartS_857)
                                            )
                                            else
                                                {442}let v_860: bool = (Sess = C) in
                                                (
                                                    {443}if v_860 then
                                                    (
                                                        {444}let pkSess_861: bitstring = pub(skC) in
                                                        {445}out(c, GetEndpointRequest);
                                                        {446}in(c, (=GetEndpointResponse,=pkSess_861,=None,SP_862: bitstring,UP_863: bitstring));
                                                        {447}new Nc_864: bitstring;
                                                        {448}let gNc_865: bitstring = exp(g,Nc_864) in
                                                        {449}let m1_866: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_865) in
                                                        {450}event beginCli(Cli,Sess,gNc_865);
                                                        {451}out(c, (pkCli,m1_866));
                                                        {452}in(c, em2_867: bitstring);
                                                        {453}let m2_868: bitstring = em2_867 in
                                                        {454}let (=OpenSecureChannelResponse,=Cli,PartS_869: bitstring,ST_870: bitstring,TTL_871: bitstring) = m2_868 in
                                                        {455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {456}event endCli(Sess,Cli,PartS_869)
                                                    )
                                                    else
                                                        {457}let pkSess_872: bitstring = pub(sk(Sess)) in
                                                        {458}out(c, GetEndpointRequest);
                                                        {459}in(c, (=GetEndpointResponse,=pkSess_872,=None,SP_873: bitstring,UP_874: bitstring));
                                                        {460}new Nc_875: bitstring;
                                                        {461}let gNc_876: bitstring = exp(g,Nc_875) in
                                                        {462}let m1_877: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_876) in
                                                        {463}event beginCli(Cli,Sess,gNc_876);
                                                        {464}out(c, (pkCli,m1_877));
                                                        {465}in(c, em2_878: bitstring);
                                                        {466}let m2_879: bitstring = em2_878 in
                                                        {467}let (=OpenSecureChannelResponse,=Cli,PartS_880: bitstring,ST_881: bitstring,TTL_882: bitstring) = m2_879 in
                                                        {468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {469}event endCli(Sess,Cli,PartS_880)
                                                )
                                                else
                                                    {470}let pkSess_883: bitstring = fail-any in
                                                    {471}out(c, GetEndpointRequest);
                                                    {472}in(c, (=GetEndpointResponse,=pkSess_883,=None,SP_884: bitstring,UP_885: bitstring));
                                                    {473}new Nc_886: bitstring;
                                                    {474}let gNc_887: bitstring = exp(g,Nc_886) in
                                                    {475}let m1_888: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_887) in
                                                    {476}event beginCli(Cli,Sess,gNc_887);
                                                    {477}out(c, (pkCli,m1_888));
                                                    {478}in(c, em2_889: bitstring);
                                                    {479}let m2_890: bitstring = em2_889 in
                                                    {480}let (=OpenSecureChannelResponse,=Cli,PartS_891: bitstring,ST_892: bitstring,TTL_893: bitstring) = m2_890 in
                                                    {481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {482}event endCli(Sess,Cli,PartS_891)
                                        )
                                        else
                                            {483}let pkSess_894: bitstring = fail-any in
                                            {484}out(c, GetEndpointRequest);
                                            {485}in(c, (=GetEndpointResponse,=pkSess_894,=None,SP_895: bitstring,UP_896: bitstring));
                                            {486}new Nc_897: bitstring;
                                            {487}let gNc_898: bitstring = exp(g,Nc_897) in
                                            {488}let m1_899: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_898) in
                                            {489}event beginCli(Cli,Sess,gNc_898);
                                            {490}out(c, (pkCli,m1_899));
                                            {491}in(c, em2_900: bitstring);
                                            {492}let m2_901: bitstring = em2_900 in
                                            {493}let (=OpenSecureChannelResponse,=Cli,PartS_902: bitstring,ST_903: bitstring,TTL_904: bitstring) = m2_901 in
                                            {494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {495}event endCli(Sess,Cli,PartS_902)
                                )
                                else
                                    {496}let pkSess_905: bitstring = fail-any in
                                    {497}out(c, GetEndpointRequest);
                                    {498}in(c, (=GetEndpointResponse,=pkSess_905,=None,SP_906: bitstring,UP_907: bitstring));
                                    {499}new Nc_908: bitstring;
                                    {500}let gNc_909: bitstring = exp(g,Nc_908) in
                                    {501}let m1_910: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_909) in
                                    {502}event beginCli(Cli,Sess,gNc_909);
                                    {503}out(c, (pkCli,m1_910));
                                    {504}in(c, em2_911: bitstring);
                                    {505}let m2_912: bitstring = em2_911 in
                                    {506}let (=OpenSecureChannelResponse,=Cli,PartS_913: bitstring,ST_914: bitstring,TTL_915: bitstring) = m2_912 in
                                    {507}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {508}event endCli(Sess,Cli,PartS_913)
                    )
                    else
                        {509}let pkDisco_916: bitstring = fail-any in
                        {510}let v_917: bool = (Sess = A) in
                        (
                            {511}if v_917 then
                            (
                                {512}let pkSess_918: bitstring = pub(skA) in
                                {513}out(c, GetEndpointRequest);
                                {514}in(c, (=GetEndpointResponse,=pkSess_918,=None,SP_919: bitstring,UP_920: bitstring));
                                {515}new Nc_921: bitstring;
                                {516}let gNc_922: bitstring = exp(g,Nc_921) in
                                {517}let m1_923: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_922) in
                                {518}event beginCli(Cli,Sess,gNc_922);
                                {519}out(c, (pkCli,m1_923));
                                {520}in(c, em2_924: bitstring);
                                {521}let m2_925: bitstring = em2_924 in
                                {522}let (=OpenSecureChannelResponse,=Cli,PartS_926: bitstring,ST_927: bitstring,TTL_928: bitstring) = m2_925 in
                                {523}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {524}event endCli(Sess,Cli,PartS_926)
                            )
                            else
                                {525}let v_929: bool = (Sess = B) in
                                (
                                    {526}if v_929 then
                                    (
                                        {527}let pkSess_930: bitstring = pub(skB) in
                                        {528}out(c, GetEndpointRequest);
                                        {529}in(c, (=GetEndpointResponse,=pkSess_930,=None,SP_931: bitstring,UP_932: bitstring));
                                        {530}new Nc_933: bitstring;
                                        {531}let gNc_934: bitstring = exp(g,Nc_933) in
                                        {532}let m1_935: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_934) in
                                        {533}event beginCli(Cli,Sess,gNc_934);
                                        {534}out(c, (pkCli,m1_935));
                                        {535}in(c, em2_936: bitstring);
                                        {536}let m2_937: bitstring = em2_936 in
                                        {537}let (=OpenSecureChannelResponse,=Cli,PartS_938: bitstring,ST_939: bitstring,TTL_940: bitstring) = m2_937 in
                                        {538}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {539}event endCli(Sess,Cli,PartS_938)
                                    )
                                    else
                                        {540}let v_941: bool = (Sess = C) in
                                        (
                                            {541}if v_941 then
                                            (
                                                {542}let pkSess_942: bitstring = pub(skC) in
                                                {543}out(c, GetEndpointRequest);
                                                {544}in(c, (=GetEndpointResponse,=pkSess_942,=None,SP_943: bitstring,UP_944: bitstring));
                                                {545}new Nc_945: bitstring;
                                                {546}let gNc_946: bitstring = exp(g,Nc_945) in
                                                {547}let m1_947: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_946) in
                                                {548}event beginCli(Cli,Sess,gNc_946);
                                                {549}out(c, (pkCli,m1_947));
                                                {550}in(c, em2_948: bitstring);
                                                {551}let m2_949: bitstring = em2_948 in
                                                {552}let (=OpenSecureChannelResponse,=Cli,PartS_950: bitstring,ST_951: bitstring,TTL_952: bitstring) = m2_949 in
                                                {553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {554}event endCli(Sess,Cli,PartS_950)
                                            )
                                            else
                                                {555}let pkSess_953: bitstring = pub(sk(Sess)) in
                                                {556}out(c, GetEndpointRequest);
                                                {557}in(c, (=GetEndpointResponse,=pkSess_953,=None,SP_954: bitstring,UP_955: bitstring));
                                                {558}new Nc_956: bitstring;
                                                {559}let gNc_957: bitstring = exp(g,Nc_956) in
                                                {560}let m1_958: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_957) in
                                                {561}event beginCli(Cli,Sess,gNc_957);
                                                {562}out(c, (pkCli,m1_958));
                                                {563}in(c, em2_959: bitstring);
                                                {564}let m2_960: bitstring = em2_959 in
                                                {565}let (=OpenSecureChannelResponse,=Cli,PartS_961: bitstring,ST_962: bitstring,TTL_963: bitstring) = m2_960 in
                                                {566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {567}event endCli(Sess,Cli,PartS_961)
                                        )
                                        else
                                            {568}let pkSess_964: bitstring = fail-any in
                                            {569}out(c, GetEndpointRequest);
                                            {570}in(c, (=GetEndpointResponse,=pkSess_964,=None,SP_965: bitstring,UP_966: bitstring));
                                            {571}new Nc_967: bitstring;
                                            {572}let gNc_968: bitstring = exp(g,Nc_967) in
                                            {573}let m1_969: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_968) in
                                            {574}event beginCli(Cli,Sess,gNc_968);
                                            {575}out(c, (pkCli,m1_969));
                                            {576}in(c, em2_970: bitstring);
                                            {577}let m2_971: bitstring = em2_970 in
                                            {578}let (=OpenSecureChannelResponse,=Cli,PartS_972: bitstring,ST_973: bitstring,TTL_974: bitstring) = m2_971 in
                                            {579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {580}event endCli(Sess,Cli,PartS_972)
                                )
                                else
                                    {581}let pkSess_975: bitstring = fail-any in
                                    {582}out(c, GetEndpointRequest);
                                    {583}in(c, (=GetEndpointResponse,=pkSess_975,=None,SP_976: bitstring,UP_977: bitstring));
                                    {584}new Nc_978: bitstring;
                                    {585}let gNc_979: bitstring = exp(g,Nc_978) in
                                    {586}let m1_980: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_979) in
                                    {587}event beginCli(Cli,Sess,gNc_979);
                                    {588}out(c, (pkCli,m1_980));
                                    {589}in(c, em2_981: bitstring);
                                    {590}let m2_982: bitstring = em2_981 in
                                    {591}let (=OpenSecureChannelResponse,=Cli,PartS_983: bitstring,ST_984: bitstring,TTL_985: bitstring) = m2_982 in
                                    {592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {593}event endCli(Sess,Cli,PartS_983)
                        )
                        else
                            {594}let pkSess_986: bitstring = fail-any in
                            {595}out(c, GetEndpointRequest);
                            {596}in(c, (=GetEndpointResponse,=pkSess_986,=None,SP_987: bitstring,UP_988: bitstring));
                            {597}new Nc_989: bitstring;
                            {598}let gNc_990: bitstring = exp(g,Nc_989) in
                            {599}let m1_991: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_990) in
                            {600}event beginCli(Cli,Sess,gNc_990);
                            {601}out(c, (pkCli,m1_991));
                            {602}in(c, em2_992: bitstring);
                            {603}let m2_993: bitstring = em2_992 in
                            {604}let (=OpenSecureChannelResponse,=Cli,PartS_994: bitstring,ST_995: bitstring,TTL_996: bitstring) = m2_993 in
                            {605}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {606}event endCli(Sess,Cli,PartS_994)
            )
            else
                {607}let pkDisco_997: bitstring = fail-any in
                {608}let v_998: bool = (Sess = A) in
                (
                    {609}if v_998 then
                    (
                        {610}let pkSess_999: bitstring = pub(skA) in
                        {611}out(c, GetEndpointRequest);
                        {612}in(c, (=GetEndpointResponse,=pkSess_999,=None,SP_1000: bitstring,UP_1001: bitstring));
                        {613}new Nc_1002: bitstring;
                        {614}let gNc_1003: bitstring = exp(g,Nc_1002) in
                        {615}let m1_1004: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1003) in
                        {616}event beginCli(Cli,Sess,gNc_1003);
                        {617}out(c, (pkCli,m1_1004));
                        {618}in(c, em2_1005: bitstring);
                        {619}let m2_1006: bitstring = em2_1005 in
                        {620}let (=OpenSecureChannelResponse,=Cli,PartS_1007: bitstring,ST_1008: bitstring,TTL_1009: bitstring) = m2_1006 in
                        {621}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {622}event endCli(Sess,Cli,PartS_1007)
                    )
                    else
                        {623}let v_1010: bool = (Sess = B) in
                        (
                            {624}if v_1010 then
                            (
                                {625}let pkSess_1011: bitstring = pub(skB) in
                                {626}out(c, GetEndpointRequest);
                                {627}in(c, (=GetEndpointResponse,=pkSess_1011,=None,SP_1012: bitstring,UP_1013: bitstring));
                                {628}new Nc_1014: bitstring;
                                {629}let gNc_1015: bitstring = exp(g,Nc_1014) in
                                {630}let m1_1016: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1015) in
                                {631}event beginCli(Cli,Sess,gNc_1015);
                                {632}out(c, (pkCli,m1_1016));
                                {633}in(c, em2_1017: bitstring);
                                {634}let m2_1018: bitstring = em2_1017 in
                                {635}let (=OpenSecureChannelResponse,=Cli,PartS_1019: bitstring,ST_1020: bitstring,TTL_1021: bitstring) = m2_1018 in
                                {636}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {637}event endCli(Sess,Cli,PartS_1019)
                            )
                            else
                                {638}let v_1022: bool = (Sess = C) in
                                (
                                    {639}if v_1022 then
                                    (
                                        {640}let pkSess_1023: bitstring = pub(skC) in
                                        {641}out(c, GetEndpointRequest);
                                        {642}in(c, (=GetEndpointResponse,=pkSess_1023,=None,SP_1024: bitstring,UP_1025: bitstring));
                                        {643}new Nc_1026: bitstring;
                                        {644}let gNc_1027: bitstring = exp(g,Nc_1026) in
                                        {645}let m1_1028: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1027) in
                                        {646}event beginCli(Cli,Sess,gNc_1027);
                                        {647}out(c, (pkCli,m1_1028));
                                        {648}in(c, em2_1029: bitstring);
                                        {649}let m2_1030: bitstring = em2_1029 in
                                        {650}let (=OpenSecureChannelResponse,=Cli,PartS_1031: bitstring,ST_1032: bitstring,TTL_1033: bitstring) = m2_1030 in
                                        {651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {652}event endCli(Sess,Cli,PartS_1031)
                                    )
                                    else
                                        {653}let pkSess_1034: bitstring = pub(sk(Sess)) in
                                        {654}out(c, GetEndpointRequest);
                                        {655}in(c, (=GetEndpointResponse,=pkSess_1034,=None,SP_1035: bitstring,UP_1036: bitstring));
                                        {656}new Nc_1037: bitstring;
                                        {657}let gNc_1038: bitstring = exp(g,Nc_1037) in
                                        {658}let m1_1039: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1038) in
                                        {659}event beginCli(Cli,Sess,gNc_1038);
                                        {660}out(c, (pkCli,m1_1039));
                                        {661}in(c, em2_1040: bitstring);
                                        {662}let m2_1041: bitstring = em2_1040 in
                                        {663}let (=OpenSecureChannelResponse,=Cli,PartS_1042: bitstring,ST_1043: bitstring,TTL_1044: bitstring) = m2_1041 in
                                        {664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {665}event endCli(Sess,Cli,PartS_1042)
                                )
                                else
                                    {666}let pkSess_1045: bitstring = fail-any in
                                    {667}out(c, GetEndpointRequest);
                                    {668}in(c, (=GetEndpointResponse,=pkSess_1045,=None,SP_1046: bitstring,UP_1047: bitstring));
                                    {669}new Nc_1048: bitstring;
                                    {670}let gNc_1049: bitstring = exp(g,Nc_1048) in
                                    {671}let m1_1050: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1049) in
                                    {672}event beginCli(Cli,Sess,gNc_1049);
                                    {673}out(c, (pkCli,m1_1050));
                                    {674}in(c, em2_1051: bitstring);
                                    {675}let m2_1052: bitstring = em2_1051 in
                                    {676}let (=OpenSecureChannelResponse,=Cli,PartS_1053: bitstring,ST_1054: bitstring,TTL_1055: bitstring) = m2_1052 in
                                    {677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {678}event endCli(Sess,Cli,PartS_1053)
                        )
                        else
                            {679}let pkSess_1056: bitstring = fail-any in
                            {680}out(c, GetEndpointRequest);
                            {681}in(c, (=GetEndpointResponse,=pkSess_1056,=None,SP_1057: bitstring,UP_1058: bitstring));
                            {682}new Nc_1059: bitstring;
                            {683}let gNc_1060: bitstring = exp(g,Nc_1059) in
                            {684}let m1_1061: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1060) in
                            {685}event beginCli(Cli,Sess,gNc_1060);
                            {686}out(c, (pkCli,m1_1061));
                            {687}in(c, em2_1062: bitstring);
                            {688}let m2_1063: bitstring = em2_1062 in
                            {689}let (=OpenSecureChannelResponse,=Cli,PartS_1064: bitstring,ST_1065: bitstring,TTL_1066: bitstring) = m2_1063 in
                            {690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {691}event endCli(Sess,Cli,PartS_1064)
                )
                else
                    {692}let pkSess_1067: bitstring = fail-any in
                    {693}out(c, GetEndpointRequest);
                    {694}in(c, (=GetEndpointResponse,=pkSess_1067,=None,SP_1068: bitstring,UP_1069: bitstring));
                    {695}new Nc_1070: bitstring;
                    {696}let gNc_1071: bitstring = exp(g,Nc_1070) in
                    {697}let m1_1072: bitstring = (OpenSecureChannelRequest,Sess,pkCli,gNc_1071) in
                    {698}event beginCli(Cli,Sess,gNc_1071);
                    {699}out(c, (pkCli,m1_1072));
                    {700}in(c, em2_1073: bitstring);
                    {701}let m2_1074: bitstring = em2_1073 in
                    {702}let (=OpenSecureChannelResponse,=Cli,PartS_1075: bitstring,ST_1076: bitstring,TTL_1077: bitstring) = m2_1074 in
                    {703}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {704}event endCli(Sess,Cli,PartS_1075)
        )
        else
            {705}let v_1078: bool = (Cli = B) in
            (
                {706}if v_1078 then
                (
                    {707}let skCli_1079: bitstring = skB in
                    {708}let pkCli_1080: bitstring = pub(skCli_1079) in
                    {709}let v_1081: bool = (Disco = A) in
                    (
                        {710}if v_1081 then
                        (
                            {711}let pkDisco_1082: bitstring = pub(skA) in
                            {712}let v_1083: bool = (Sess = A) in
                            (
                                {713}if v_1083 then
                                (
                                    {714}let pkSess_1084: bitstring = pub(skA) in
                                    {715}out(c, GetEndpointRequest);
                                    {716}in(c, (=GetEndpointResponse,=pkSess_1084,=None,SP_1085: bitstring,UP_1086: bitstring));
                                    {717}new Nc_1087: bitstring;
                                    {718}let gNc_1088: bitstring = exp(g,Nc_1087) in
                                    {719}let m1_1089: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1088) in
                                    {720}event beginCli(Cli,Sess,gNc_1088);
                                    {721}out(c, (pkCli_1080,m1_1089));
                                    {722}in(c, em2_1090: bitstring);
                                    {723}let m2_1091: bitstring = em2_1090 in
                                    {724}let (=OpenSecureChannelResponse,=Cli,PartS_1092: bitstring,ST_1093: bitstring,TTL_1094: bitstring) = m2_1091 in
                                    {725}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {726}event endCli(Sess,Cli,PartS_1092)
                                )
                                else
                                    {727}let v_1095: bool = (Sess = B) in
                                    (
                                        {728}if v_1095 then
                                        (
                                            {729}let pkSess_1096: bitstring = pub(skB) in
                                            {730}out(c, GetEndpointRequest);
                                            {731}in(c, (=GetEndpointResponse,=pkSess_1096,=None,SP_1097: bitstring,UP_1098: bitstring));
                                            {732}new Nc_1099: bitstring;
                                            {733}let gNc_1100: bitstring = exp(g,Nc_1099) in
                                            {734}let m1_1101: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1100) in
                                            {735}event beginCli(Cli,Sess,gNc_1100);
                                            {736}out(c, (pkCli_1080,m1_1101));
                                            {737}in(c, em2_1102: bitstring);
                                            {738}let m2_1103: bitstring = em2_1102 in
                                            {739}let (=OpenSecureChannelResponse,=Cli,PartS_1104: bitstring,ST_1105: bitstring,TTL_1106: bitstring) = m2_1103 in
                                            {740}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {741}event endCli(Sess,Cli,PartS_1104)
                                        )
                                        else
                                            {742}let v_1107: bool = (Sess = C) in
                                            (
                                                {743}if v_1107 then
                                                (
                                                    {744}let pkSess_1108: bitstring = pub(skC) in
                                                    {745}out(c, GetEndpointRequest);
                                                    {746}in(c, (=GetEndpointResponse,=pkSess_1108,=None,SP_1109: bitstring,UP_1110: bitstring));
                                                    {747}new Nc_1111: bitstring;
                                                    {748}let gNc_1112: bitstring = exp(g,Nc_1111) in
                                                    {749}let m1_1113: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1112) in
                                                    {750}event beginCli(Cli,Sess,gNc_1112);
                                                    {751}out(c, (pkCli_1080,m1_1113));
                                                    {752}in(c, em2_1114: bitstring);
                                                    {753}let m2_1115: bitstring = em2_1114 in
                                                    {754}let (=OpenSecureChannelResponse,=Cli,PartS_1116: bitstring,ST_1117: bitstring,TTL_1118: bitstring) = m2_1115 in
                                                    {755}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {756}event endCli(Sess,Cli,PartS_1116)
                                                )
                                                else
                                                    {757}let pkSess_1119: bitstring = pub(sk(Sess)) in
                                                    {758}out(c, GetEndpointRequest);
                                                    {759}in(c, (=GetEndpointResponse,=pkSess_1119,=None,SP_1120: bitstring,UP_1121: bitstring));
                                                    {760}new Nc_1122: bitstring;
                                                    {761}let gNc_1123: bitstring = exp(g,Nc_1122) in
                                                    {762}let m1_1124: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1123) in
                                                    {763}event beginCli(Cli,Sess,gNc_1123);
                                                    {764}out(c, (pkCli_1080,m1_1124));
                                                    {765}in(c, em2_1125: bitstring);
                                                    {766}let m2_1126: bitstring = em2_1125 in
                                                    {767}let (=OpenSecureChannelResponse,=Cli,PartS_1127: bitstring,ST_1128: bitstring,TTL_1129: bitstring) = m2_1126 in
                                                    {768}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {769}event endCli(Sess,Cli,PartS_1127)
                                            )
                                            else
                                                {770}let pkSess_1130: bitstring = fail-any in
                                                {771}out(c, GetEndpointRequest);
                                                {772}in(c, (=GetEndpointResponse,=pkSess_1130,=None,SP_1131: bitstring,UP_1132: bitstring));
                                                {773}new Nc_1133: bitstring;
                                                {774}let gNc_1134: bitstring = exp(g,Nc_1133) in
                                                {775}let m1_1135: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1134) in
                                                {776}event beginCli(Cli,Sess,gNc_1134);
                                                {777}out(c, (pkCli_1080,m1_1135));
                                                {778}in(c, em2_1136: bitstring);
                                                {779}let m2_1137: bitstring = em2_1136 in
                                                {780}let (=OpenSecureChannelResponse,=Cli,PartS_1138: bitstring,ST_1139: bitstring,TTL_1140: bitstring) = m2_1137 in
                                                {781}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {782}event endCli(Sess,Cli,PartS_1138)
                                    )
                                    else
                                        {783}let pkSess_1141: bitstring = fail-any in
                                        {784}out(c, GetEndpointRequest);
                                        {785}in(c, (=GetEndpointResponse,=pkSess_1141,=None,SP_1142: bitstring,UP_1143: bitstring));
                                        {786}new Nc_1144: bitstring;
                                        {787}let gNc_1145: bitstring = exp(g,Nc_1144) in
                                        {788}let m1_1146: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1145) in
                                        {789}event beginCli(Cli,Sess,gNc_1145);
                                        {790}out(c, (pkCli_1080,m1_1146));
                                        {791}in(c, em2_1147: bitstring);
                                        {792}let m2_1148: bitstring = em2_1147 in
                                        {793}let (=OpenSecureChannelResponse,=Cli,PartS_1149: bitstring,ST_1150: bitstring,TTL_1151: bitstring) = m2_1148 in
                                        {794}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {795}event endCli(Sess,Cli,PartS_1149)
                            )
                            else
                                {796}let pkSess_1152: bitstring = fail-any in
                                {797}out(c, GetEndpointRequest);
                                {798}in(c, (=GetEndpointResponse,=pkSess_1152,=None,SP_1153: bitstring,UP_1154: bitstring));
                                {799}new Nc_1155: bitstring;
                                {800}let gNc_1156: bitstring = exp(g,Nc_1155) in
                                {801}let m1_1157: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1156) in
                                {802}event beginCli(Cli,Sess,gNc_1156);
                                {803}out(c, (pkCli_1080,m1_1157));
                                {804}in(c, em2_1158: bitstring);
                                {805}let m2_1159: bitstring = em2_1158 in
                                {806}let (=OpenSecureChannelResponse,=Cli,PartS_1160: bitstring,ST_1161: bitstring,TTL_1162: bitstring) = m2_1159 in
                                {807}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {808}event endCli(Sess,Cli,PartS_1160)
                        )
                        else
                            {809}let v_1163: bool = (Disco = B) in
                            (
                                {810}if v_1163 then
                                (
                                    {811}let pkDisco_1164: bitstring = pub(skB) in
                                    {812}let v_1165: bool = (Sess = A) in
                                    (
                                        {813}if v_1165 then
                                        (
                                            {814}let pkSess_1166: bitstring = pub(skA) in
                                            {815}out(c, GetEndpointRequest);
                                            {816}in(c, (=GetEndpointResponse,=pkSess_1166,=None,SP_1167: bitstring,UP_1168: bitstring));
                                            {817}new Nc_1169: bitstring;
                                            {818}let gNc_1170: bitstring = exp(g,Nc_1169) in
                                            {819}let m1_1171: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1170) in
                                            {820}event beginCli(Cli,Sess,gNc_1170);
                                            {821}out(c, (pkCli_1080,m1_1171));
                                            {822}in(c, em2_1172: bitstring);
                                            {823}let m2_1173: bitstring = em2_1172 in
                                            {824}let (=OpenSecureChannelResponse,=Cli,PartS_1174: bitstring,ST_1175: bitstring,TTL_1176: bitstring) = m2_1173 in
                                            {825}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {826}event endCli(Sess,Cli,PartS_1174)
                                        )
                                        else
                                            {827}let v_1177: bool = (Sess = B) in
                                            (
                                                {828}if v_1177 then
                                                (
                                                    {829}let pkSess_1178: bitstring = pub(skB) in
                                                    {830}out(c, GetEndpointRequest);
                                                    {831}in(c, (=GetEndpointResponse,=pkSess_1178,=None,SP_1179: bitstring,UP_1180: bitstring));
                                                    {832}new Nc_1181: bitstring;
                                                    {833}let gNc_1182: bitstring = exp(g,Nc_1181) in
                                                    {834}let m1_1183: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1182) in
                                                    {835}event beginCli(Cli,Sess,gNc_1182);
                                                    {836}out(c, (pkCli_1080,m1_1183));
                                                    {837}in(c, em2_1184: bitstring);
                                                    {838}let m2_1185: bitstring = em2_1184 in
                                                    {839}let (=OpenSecureChannelResponse,=Cli,PartS_1186: bitstring,ST_1187: bitstring,TTL_1188: bitstring) = m2_1185 in
                                                    {840}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {841}event endCli(Sess,Cli,PartS_1186)
                                                )
                                                else
                                                    {842}let v_1189: bool = (Sess = C) in
                                                    (
                                                        {843}if v_1189 then
                                                        (
                                                            {844}let pkSess_1190: bitstring = pub(skC) in
                                                            {845}out(c, GetEndpointRequest);
                                                            {846}in(c, (=GetEndpointResponse,=pkSess_1190,=None,SP_1191: bitstring,UP_1192: bitstring));
                                                            {847}new Nc_1193: bitstring;
                                                            {848}let gNc_1194: bitstring = exp(g,Nc_1193) in
                                                            {849}let m1_1195: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1194) in
                                                            {850}event beginCli(Cli,Sess,gNc_1194);
                                                            {851}out(c, (pkCli_1080,m1_1195));
                                                            {852}in(c, em2_1196: bitstring);
                                                            {853}let m2_1197: bitstring = em2_1196 in
                                                            {854}let (=OpenSecureChannelResponse,=Cli,PartS_1198: bitstring,ST_1199: bitstring,TTL_1200: bitstring) = m2_1197 in
                                                            {855}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {856}event endCli(Sess,Cli,PartS_1198)
                                                        )
                                                        else
                                                            {857}let pkSess_1201: bitstring = pub(sk(Sess)) in
                                                            {858}out(c, GetEndpointRequest);
                                                            {859}in(c, (=GetEndpointResponse,=pkSess_1201,=None,SP_1202: bitstring,UP_1203: bitstring));
                                                            {860}new Nc_1204: bitstring;
                                                            {861}let gNc_1205: bitstring = exp(g,Nc_1204) in
                                                            {862}let m1_1206: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1205) in
                                                            {863}event beginCli(Cli,Sess,gNc_1205);
                                                            {864}out(c, (pkCli_1080,m1_1206));
                                                            {865}in(c, em2_1207: bitstring);
                                                            {866}let m2_1208: bitstring = em2_1207 in
                                                            {867}let (=OpenSecureChannelResponse,=Cli,PartS_1209: bitstring,ST_1210: bitstring,TTL_1211: bitstring) = m2_1208 in
                                                            {868}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {869}event endCli(Sess,Cli,PartS_1209)
                                                    )
                                                    else
                                                        {870}let pkSess_1212: bitstring = fail-any in
                                                        {871}out(c, GetEndpointRequest);
                                                        {872}in(c, (=GetEndpointResponse,=pkSess_1212,=None,SP_1213: bitstring,UP_1214: bitstring));
                                                        {873}new Nc_1215: bitstring;
                                                        {874}let gNc_1216: bitstring = exp(g,Nc_1215) in
                                                        {875}let m1_1217: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1216) in
                                                        {876}event beginCli(Cli,Sess,gNc_1216);
                                                        {877}out(c, (pkCli_1080,m1_1217));
                                                        {878}in(c, em2_1218: bitstring);
                                                        {879}let m2_1219: bitstring = em2_1218 in
                                                        {880}let (=OpenSecureChannelResponse,=Cli,PartS_1220: bitstring,ST_1221: bitstring,TTL_1222: bitstring) = m2_1219 in
                                                        {881}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {882}event endCli(Sess,Cli,PartS_1220)
                                            )
                                            else
                                                {883}let pkSess_1223: bitstring = fail-any in
                                                {884}out(c, GetEndpointRequest);
                                                {885}in(c, (=GetEndpointResponse,=pkSess_1223,=None,SP_1224: bitstring,UP_1225: bitstring));
                                                {886}new Nc_1226: bitstring;
                                                {887}let gNc_1227: bitstring = exp(g,Nc_1226) in
                                                {888}let m1_1228: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1227) in
                                                {889}event beginCli(Cli,Sess,gNc_1227);
                                                {890}out(c, (pkCli_1080,m1_1228));
                                                {891}in(c, em2_1229: bitstring);
                                                {892}let m2_1230: bitstring = em2_1229 in
                                                {893}let (=OpenSecureChannelResponse,=Cli,PartS_1231: bitstring,ST_1232: bitstring,TTL_1233: bitstring) = m2_1230 in
                                                {894}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {895}event endCli(Sess,Cli,PartS_1231)
                                    )
                                    else
                                        {896}let pkSess_1234: bitstring = fail-any in
                                        {897}out(c, GetEndpointRequest);
                                        {898}in(c, (=GetEndpointResponse,=pkSess_1234,=None,SP_1235: bitstring,UP_1236: bitstring));
                                        {899}new Nc_1237: bitstring;
                                        {900}let gNc_1238: bitstring = exp(g,Nc_1237) in
                                        {901}let m1_1239: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1238) in
                                        {902}event beginCli(Cli,Sess,gNc_1238);
                                        {903}out(c, (pkCli_1080,m1_1239));
                                        {904}in(c, em2_1240: bitstring);
                                        {905}let m2_1241: bitstring = em2_1240 in
                                        {906}let (=OpenSecureChannelResponse,=Cli,PartS_1242: bitstring,ST_1243: bitstring,TTL_1244: bitstring) = m2_1241 in
                                        {907}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {908}event endCli(Sess,Cli,PartS_1242)
                                )
                                else
                                    {909}let v_1245: bool = (Disco = C) in
                                    (
                                        {910}if v_1245 then
                                        (
                                            {911}let pkDisco_1246: bitstring = pub(skC) in
                                            {912}let v_1247: bool = (Sess = A) in
                                            (
                                                {913}if v_1247 then
                                                (
                                                    {914}let pkSess_1248: bitstring = pub(skA) in
                                                    {915}out(c, GetEndpointRequest);
                                                    {916}in(c, (=GetEndpointResponse,=pkSess_1248,=None,SP_1249: bitstring,UP_1250: bitstring));
                                                    {917}new Nc_1251: bitstring;
                                                    {918}let gNc_1252: bitstring = exp(g,Nc_1251) in
                                                    {919}let m1_1253: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1252) in
                                                    {920}event beginCli(Cli,Sess,gNc_1252);
                                                    {921}out(c, (pkCli_1080,m1_1253));
                                                    {922}in(c, em2_1254: bitstring);
                                                    {923}let m2_1255: bitstring = em2_1254 in
                                                    {924}let (=OpenSecureChannelResponse,=Cli,PartS_1256: bitstring,ST_1257: bitstring,TTL_1258: bitstring) = m2_1255 in
                                                    {925}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {926}event endCli(Sess,Cli,PartS_1256)
                                                )
                                                else
                                                    {927}let v_1259: bool = (Sess = B) in
                                                    (
                                                        {928}if v_1259 then
                                                        (
                                                            {929}let pkSess_1260: bitstring = pub(skB) in
                                                            {930}out(c, GetEndpointRequest);
                                                            {931}in(c, (=GetEndpointResponse,=pkSess_1260,=None,SP_1261: bitstring,UP_1262: bitstring));
                                                            {932}new Nc_1263: bitstring;
                                                            {933}let gNc_1264: bitstring = exp(g,Nc_1263) in
                                                            {934}let m1_1265: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1264) in
                                                            {935}event beginCli(Cli,Sess,gNc_1264);
                                                            {936}out(c, (pkCli_1080,m1_1265));
                                                            {937}in(c, em2_1266: bitstring);
                                                            {938}let m2_1267: bitstring = em2_1266 in
                                                            {939}let (=OpenSecureChannelResponse,=Cli,PartS_1268: bitstring,ST_1269: bitstring,TTL_1270: bitstring) = m2_1267 in
                                                            {940}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {941}event endCli(Sess,Cli,PartS_1268)
                                                        )
                                                        else
                                                            {942}let v_1271: bool = (Sess = C) in
                                                            (
                                                                {943}if v_1271 then
                                                                (
                                                                    {944}let pkSess_1272: bitstring = pub(skC) in
                                                                    {945}out(c, GetEndpointRequest);
                                                                    {946}in(c, (=GetEndpointResponse,=pkSess_1272,=None,SP_1273: bitstring,UP_1274: bitstring));
                                                                    {947}new Nc_1275: bitstring;
                                                                    {948}let gNc_1276: bitstring = exp(g,Nc_1275) in
                                                                    {949}let m1_1277: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1276) in
                                                                    {950}event beginCli(Cli,Sess,gNc_1276);
                                                                    {951}out(c, (pkCli_1080,m1_1277));
                                                                    {952}in(c, em2_1278: bitstring);
                                                                    {953}let m2_1279: bitstring = em2_1278 in
                                                                    {954}let (=OpenSecureChannelResponse,=Cli,PartS_1280: bitstring,ST_1281: bitstring,TTL_1282: bitstring) = m2_1279 in
                                                                    {955}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {956}event endCli(Sess,Cli,PartS_1280)
                                                                )
                                                                else
                                                                    {957}let pkSess_1283: bitstring = pub(sk(Sess)) in
                                                                    {958}out(c, GetEndpointRequest);
                                                                    {959}in(c, (=GetEndpointResponse,=pkSess_1283,=None,SP_1284: bitstring,UP_1285: bitstring));
                                                                    {960}new Nc_1286: bitstring;
                                                                    {961}let gNc_1287: bitstring = exp(g,Nc_1286) in
                                                                    {962}let m1_1288: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1287) in
                                                                    {963}event beginCli(Cli,Sess,gNc_1287);
                                                                    {964}out(c, (pkCli_1080,m1_1288));
                                                                    {965}in(c, em2_1289: bitstring);
                                                                    {966}let m2_1290: bitstring = em2_1289 in
                                                                    {967}let (=OpenSecureChannelResponse,=Cli,PartS_1291: bitstring,ST_1292: bitstring,TTL_1293: bitstring) = m2_1290 in
                                                                    {968}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {969}event endCli(Sess,Cli,PartS_1291)
                                                            )
                                                            else
                                                                {970}let pkSess_1294: bitstring = fail-any in
                                                                {971}out(c, GetEndpointRequest);
                                                                {972}in(c, (=GetEndpointResponse,=pkSess_1294,=None,SP_1295: bitstring,UP_1296: bitstring));
                                                                {973}new Nc_1297: bitstring;
                                                                {974}let gNc_1298: bitstring = exp(g,Nc_1297) in
                                                                {975}let m1_1299: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1298) in
                                                                {976}event beginCli(Cli,Sess,gNc_1298);
                                                                {977}out(c, (pkCli_1080,m1_1299));
                                                                {978}in(c, em2_1300: bitstring);
                                                                {979}let m2_1301: bitstring = em2_1300 in
                                                                {980}let (=OpenSecureChannelResponse,=Cli,PartS_1302: bitstring,ST_1303: bitstring,TTL_1304: bitstring) = m2_1301 in
                                                                {981}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {982}event endCli(Sess,Cli,PartS_1302)
                                                    )
                                                    else
                                                        {983}let pkSess_1305: bitstring = fail-any in
                                                        {984}out(c, GetEndpointRequest);
                                                        {985}in(c, (=GetEndpointResponse,=pkSess_1305,=None,SP_1306: bitstring,UP_1307: bitstring));
                                                        {986}new Nc_1308: bitstring;
                                                        {987}let gNc_1309: bitstring = exp(g,Nc_1308) in
                                                        {988}let m1_1310: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1309) in
                                                        {989}event beginCli(Cli,Sess,gNc_1309);
                                                        {990}out(c, (pkCli_1080,m1_1310));
                                                        {991}in(c, em2_1311: bitstring);
                                                        {992}let m2_1312: bitstring = em2_1311 in
                                                        {993}let (=OpenSecureChannelResponse,=Cli,PartS_1313: bitstring,ST_1314: bitstring,TTL_1315: bitstring) = m2_1312 in
                                                        {994}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {995}event endCli(Sess,Cli,PartS_1313)
                                            )
                                            else
                                                {996}let pkSess_1316: bitstring = fail-any in
                                                {997}out(c, GetEndpointRequest);
                                                {998}in(c, (=GetEndpointResponse,=pkSess_1316,=None,SP_1317: bitstring,UP_1318: bitstring));
                                                {999}new Nc_1319: bitstring;
                                                {1000}let gNc_1320: bitstring = exp(g,Nc_1319) in
                                                {1001}let m1_1321: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1320) in
                                                {1002}event beginCli(Cli,Sess,gNc_1320);
                                                {1003}out(c, (pkCli_1080,m1_1321));
                                                {1004}in(c, em2_1322: bitstring);
                                                {1005}let m2_1323: bitstring = em2_1322 in
                                                {1006}let (=OpenSecureChannelResponse,=Cli,PartS_1324: bitstring,ST_1325: bitstring,TTL_1326: bitstring) = m2_1323 in
                                                {1007}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1008}event endCli(Sess,Cli,PartS_1324)
                                        )
                                        else
                                            {1009}let pkDisco_1327: bitstring = pub(sk(Disco)) in
                                            {1010}let v_1328: bool = (Sess = A) in
                                            (
                                                {1011}if v_1328 then
                                                (
                                                    {1012}let pkSess_1329: bitstring = pub(skA) in
                                                    {1013}out(c, GetEndpointRequest);
                                                    {1014}in(c, (=GetEndpointResponse,=pkSess_1329,=None,SP_1330: bitstring,UP_1331: bitstring));
                                                    {1015}new Nc_1332: bitstring;
                                                    {1016}let gNc_1333: bitstring = exp(g,Nc_1332) in
                                                    {1017}let m1_1334: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1333) in
                                                    {1018}event beginCli(Cli,Sess,gNc_1333);
                                                    {1019}out(c, (pkCli_1080,m1_1334));
                                                    {1020}in(c, em2_1335: bitstring);
                                                    {1021}let m2_1336: bitstring = em2_1335 in
                                                    {1022}let (=OpenSecureChannelResponse,=Cli,PartS_1337: bitstring,ST_1338: bitstring,TTL_1339: bitstring) = m2_1336 in
                                                    {1023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1024}event endCli(Sess,Cli,PartS_1337)
                                                )
                                                else
                                                    {1025}let v_1340: bool = (Sess = B) in
                                                    (
                                                        {1026}if v_1340 then
                                                        (
                                                            {1027}let pkSess_1341: bitstring = pub(skB) in
                                                            {1028}out(c, GetEndpointRequest);
                                                            {1029}in(c, (=GetEndpointResponse,=pkSess_1341,=None,SP_1342: bitstring,UP_1343: bitstring));
                                                            {1030}new Nc_1344: bitstring;
                                                            {1031}let gNc_1345: bitstring = exp(g,Nc_1344) in
                                                            {1032}let m1_1346: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1345) in
                                                            {1033}event beginCli(Cli,Sess,gNc_1345);
                                                            {1034}out(c, (pkCli_1080,m1_1346));
                                                            {1035}in(c, em2_1347: bitstring);
                                                            {1036}let m2_1348: bitstring = em2_1347 in
                                                            {1037}let (=OpenSecureChannelResponse,=Cli,PartS_1349: bitstring,ST_1350: bitstring,TTL_1351: bitstring) = m2_1348 in
                                                            {1038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1039}event endCli(Sess,Cli,PartS_1349)
                                                        )
                                                        else
                                                            {1040}let v_1352: bool = (Sess = C) in
                                                            (
                                                                {1041}if v_1352 then
                                                                (
                                                                    {1042}let pkSess_1353: bitstring = pub(skC) in
                                                                    {1043}out(c, GetEndpointRequest);
                                                                    {1044}in(c, (=GetEndpointResponse,=pkSess_1353,=None,SP_1354: bitstring,UP_1355: bitstring));
                                                                    {1045}new Nc_1356: bitstring;
                                                                    {1046}let gNc_1357: bitstring = exp(g,Nc_1356) in
                                                                    {1047}let m1_1358: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1357) in
                                                                    {1048}event beginCli(Cli,Sess,gNc_1357);
                                                                    {1049}out(c, (pkCli_1080,m1_1358));
                                                                    {1050}in(c, em2_1359: bitstring);
                                                                    {1051}let m2_1360: bitstring = em2_1359 in
                                                                    {1052}let (=OpenSecureChannelResponse,=Cli,PartS_1361: bitstring,ST_1362: bitstring,TTL_1363: bitstring) = m2_1360 in
                                                                    {1053}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1054}event endCli(Sess,Cli,PartS_1361)
                                                                )
                                                                else
                                                                    {1055}let pkSess_1364: bitstring = pub(sk(Sess)) in
                                                                    {1056}out(c, GetEndpointRequest);
                                                                    {1057}in(c, (=GetEndpointResponse,=pkSess_1364,=None,SP_1365: bitstring,UP_1366: bitstring));
                                                                    {1058}new Nc_1367: bitstring;
                                                                    {1059}let gNc_1368: bitstring = exp(g,Nc_1367) in
                                                                    {1060}let m1_1369: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1368) in
                                                                    {1061}event beginCli(Cli,Sess,gNc_1368);
                                                                    {1062}out(c, (pkCli_1080,m1_1369));
                                                                    {1063}in(c, em2_1370: bitstring);
                                                                    {1064}let m2_1371: bitstring = em2_1370 in
                                                                    {1065}let (=OpenSecureChannelResponse,=Cli,PartS_1372: bitstring,ST_1373: bitstring,TTL_1374: bitstring) = m2_1371 in
                                                                    {1066}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1067}event endCli(Sess,Cli,PartS_1372)
                                                            )
                                                            else
                                                                {1068}let pkSess_1375: bitstring = fail-any in
                                                                {1069}out(c, GetEndpointRequest);
                                                                {1070}in(c, (=GetEndpointResponse,=pkSess_1375,=None,SP_1376: bitstring,UP_1377: bitstring));
                                                                {1071}new Nc_1378: bitstring;
                                                                {1072}let gNc_1379: bitstring = exp(g,Nc_1378) in
                                                                {1073}let m1_1380: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1379) in
                                                                {1074}event beginCli(Cli,Sess,gNc_1379);
                                                                {1075}out(c, (pkCli_1080,m1_1380));
                                                                {1076}in(c, em2_1381: bitstring);
                                                                {1077}let m2_1382: bitstring = em2_1381 in
                                                                {1078}let (=OpenSecureChannelResponse,=Cli,PartS_1383: bitstring,ST_1384: bitstring,TTL_1385: bitstring) = m2_1382 in
                                                                {1079}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1080}event endCli(Sess,Cli,PartS_1383)
                                                    )
                                                    else
                                                        {1081}let pkSess_1386: bitstring = fail-any in
                                                        {1082}out(c, GetEndpointRequest);
                                                        {1083}in(c, (=GetEndpointResponse,=pkSess_1386,=None,SP_1387: bitstring,UP_1388: bitstring));
                                                        {1084}new Nc_1389: bitstring;
                                                        {1085}let gNc_1390: bitstring = exp(g,Nc_1389) in
                                                        {1086}let m1_1391: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1390) in
                                                        {1087}event beginCli(Cli,Sess,gNc_1390);
                                                        {1088}out(c, (pkCli_1080,m1_1391));
                                                        {1089}in(c, em2_1392: bitstring);
                                                        {1090}let m2_1393: bitstring = em2_1392 in
                                                        {1091}let (=OpenSecureChannelResponse,=Cli,PartS_1394: bitstring,ST_1395: bitstring,TTL_1396: bitstring) = m2_1393 in
                                                        {1092}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1093}event endCli(Sess,Cli,PartS_1394)
                                            )
                                            else
                                                {1094}let pkSess_1397: bitstring = fail-any in
                                                {1095}out(c, GetEndpointRequest);
                                                {1096}in(c, (=GetEndpointResponse,=pkSess_1397,=None,SP_1398: bitstring,UP_1399: bitstring));
                                                {1097}new Nc_1400: bitstring;
                                                {1098}let gNc_1401: bitstring = exp(g,Nc_1400) in
                                                {1099}let m1_1402: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1401) in
                                                {1100}event beginCli(Cli,Sess,gNc_1401);
                                                {1101}out(c, (pkCli_1080,m1_1402));
                                                {1102}in(c, em2_1403: bitstring);
                                                {1103}let m2_1404: bitstring = em2_1403 in
                                                {1104}let (=OpenSecureChannelResponse,=Cli,PartS_1405: bitstring,ST_1406: bitstring,TTL_1407: bitstring) = m2_1404 in
                                                {1105}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1106}event endCli(Sess,Cli,PartS_1405)
                                    )
                                    else
                                        {1107}let pkDisco_1408: bitstring = fail-any in
                                        {1108}let v_1409: bool = (Sess = A) in
                                        (
                                            {1109}if v_1409 then
                                            (
                                                {1110}let pkSess_1410: bitstring = pub(skA) in
                                                {1111}out(c, GetEndpointRequest);
                                                {1112}in(c, (=GetEndpointResponse,=pkSess_1410,=None,SP_1411: bitstring,UP_1412: bitstring));
                                                {1113}new Nc_1413: bitstring;
                                                {1114}let gNc_1414: bitstring = exp(g,Nc_1413) in
                                                {1115}let m1_1415: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1414) in
                                                {1116}event beginCli(Cli,Sess,gNc_1414);
                                                {1117}out(c, (pkCli_1080,m1_1415));
                                                {1118}in(c, em2_1416: bitstring);
                                                {1119}let m2_1417: bitstring = em2_1416 in
                                                {1120}let (=OpenSecureChannelResponse,=Cli,PartS_1418: bitstring,ST_1419: bitstring,TTL_1420: bitstring) = m2_1417 in
                                                {1121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1122}event endCli(Sess,Cli,PartS_1418)
                                            )
                                            else
                                                {1123}let v_1421: bool = (Sess = B) in
                                                (
                                                    {1124}if v_1421 then
                                                    (
                                                        {1125}let pkSess_1422: bitstring = pub(skB) in
                                                        {1126}out(c, GetEndpointRequest);
                                                        {1127}in(c, (=GetEndpointResponse,=pkSess_1422,=None,SP_1423: bitstring,UP_1424: bitstring));
                                                        {1128}new Nc_1425: bitstring;
                                                        {1129}let gNc_1426: bitstring = exp(g,Nc_1425) in
                                                        {1130}let m1_1427: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1426) in
                                                        {1131}event beginCli(Cli,Sess,gNc_1426);
                                                        {1132}out(c, (pkCli_1080,m1_1427));
                                                        {1133}in(c, em2_1428: bitstring);
                                                        {1134}let m2_1429: bitstring = em2_1428 in
                                                        {1135}let (=OpenSecureChannelResponse,=Cli,PartS_1430: bitstring,ST_1431: bitstring,TTL_1432: bitstring) = m2_1429 in
                                                        {1136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1137}event endCli(Sess,Cli,PartS_1430)
                                                    )
                                                    else
                                                        {1138}let v_1433: bool = (Sess = C) in
                                                        (
                                                            {1139}if v_1433 then
                                                            (
                                                                {1140}let pkSess_1434: bitstring = pub(skC) in
                                                                {1141}out(c, GetEndpointRequest);
                                                                {1142}in(c, (=GetEndpointResponse,=pkSess_1434,=None,SP_1435: bitstring,UP_1436: bitstring));
                                                                {1143}new Nc_1437: bitstring;
                                                                {1144}let gNc_1438: bitstring = exp(g,Nc_1437) in
                                                                {1145}let m1_1439: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1438) in
                                                                {1146}event beginCli(Cli,Sess,gNc_1438);
                                                                {1147}out(c, (pkCli_1080,m1_1439));
                                                                {1148}in(c, em2_1440: bitstring);
                                                                {1149}let m2_1441: bitstring = em2_1440 in
                                                                {1150}let (=OpenSecureChannelResponse,=Cli,PartS_1442: bitstring,ST_1443: bitstring,TTL_1444: bitstring) = m2_1441 in
                                                                {1151}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1152}event endCli(Sess,Cli,PartS_1442)
                                                            )
                                                            else
                                                                {1153}let pkSess_1445: bitstring = pub(sk(Sess)) in
                                                                {1154}out(c, GetEndpointRequest);
                                                                {1155}in(c, (=GetEndpointResponse,=pkSess_1445,=None,SP_1446: bitstring,UP_1447: bitstring));
                                                                {1156}new Nc_1448: bitstring;
                                                                {1157}let gNc_1449: bitstring = exp(g,Nc_1448) in
                                                                {1158}let m1_1450: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1449) in
                                                                {1159}event beginCli(Cli,Sess,gNc_1449);
                                                                {1160}out(c, (pkCli_1080,m1_1450));
                                                                {1161}in(c, em2_1451: bitstring);
                                                                {1162}let m2_1452: bitstring = em2_1451 in
                                                                {1163}let (=OpenSecureChannelResponse,=Cli,PartS_1453: bitstring,ST_1454: bitstring,TTL_1455: bitstring) = m2_1452 in
                                                                {1164}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1165}event endCli(Sess,Cli,PartS_1453)
                                                        )
                                                        else
                                                            {1166}let pkSess_1456: bitstring = fail-any in
                                                            {1167}out(c, GetEndpointRequest);
                                                            {1168}in(c, (=GetEndpointResponse,=pkSess_1456,=None,SP_1457: bitstring,UP_1458: bitstring));
                                                            {1169}new Nc_1459: bitstring;
                                                            {1170}let gNc_1460: bitstring = exp(g,Nc_1459) in
                                                            {1171}let m1_1461: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1460) in
                                                            {1172}event beginCli(Cli,Sess,gNc_1460);
                                                            {1173}out(c, (pkCli_1080,m1_1461));
                                                            {1174}in(c, em2_1462: bitstring);
                                                            {1175}let m2_1463: bitstring = em2_1462 in
                                                            {1176}let (=OpenSecureChannelResponse,=Cli,PartS_1464: bitstring,ST_1465: bitstring,TTL_1466: bitstring) = m2_1463 in
                                                            {1177}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1178}event endCli(Sess,Cli,PartS_1464)
                                                )
                                                else
                                                    {1179}let pkSess_1467: bitstring = fail-any in
                                                    {1180}out(c, GetEndpointRequest);
                                                    {1181}in(c, (=GetEndpointResponse,=pkSess_1467,=None,SP_1468: bitstring,UP_1469: bitstring));
                                                    {1182}new Nc_1470: bitstring;
                                                    {1183}let gNc_1471: bitstring = exp(g,Nc_1470) in
                                                    {1184}let m1_1472: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1471) in
                                                    {1185}event beginCli(Cli,Sess,gNc_1471);
                                                    {1186}out(c, (pkCli_1080,m1_1472));
                                                    {1187}in(c, em2_1473: bitstring);
                                                    {1188}let m2_1474: bitstring = em2_1473 in
                                                    {1189}let (=OpenSecureChannelResponse,=Cli,PartS_1475: bitstring,ST_1476: bitstring,TTL_1477: bitstring) = m2_1474 in
                                                    {1190}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1191}event endCli(Sess,Cli,PartS_1475)
                                        )
                                        else
                                            {1192}let pkSess_1478: bitstring = fail-any in
                                            {1193}out(c, GetEndpointRequest);
                                            {1194}in(c, (=GetEndpointResponse,=pkSess_1478,=None,SP_1479: bitstring,UP_1480: bitstring));
                                            {1195}new Nc_1481: bitstring;
                                            {1196}let gNc_1482: bitstring = exp(g,Nc_1481) in
                                            {1197}let m1_1483: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1482) in
                                            {1198}event beginCli(Cli,Sess,gNc_1482);
                                            {1199}out(c, (pkCli_1080,m1_1483));
                                            {1200}in(c, em2_1484: bitstring);
                                            {1201}let m2_1485: bitstring = em2_1484 in
                                            {1202}let (=OpenSecureChannelResponse,=Cli,PartS_1486: bitstring,ST_1487: bitstring,TTL_1488: bitstring) = m2_1485 in
                                            {1203}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1204}event endCli(Sess,Cli,PartS_1486)
                            )
                            else
                                {1205}let pkDisco_1489: bitstring = fail-any in
                                {1206}let v_1490: bool = (Sess = A) in
                                (
                                    {1207}if v_1490 then
                                    (
                                        {1208}let pkSess_1491: bitstring = pub(skA) in
                                        {1209}out(c, GetEndpointRequest);
                                        {1210}in(c, (=GetEndpointResponse,=pkSess_1491,=None,SP_1492: bitstring,UP_1493: bitstring));
                                        {1211}new Nc_1494: bitstring;
                                        {1212}let gNc_1495: bitstring = exp(g,Nc_1494) in
                                        {1213}let m1_1496: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1495) in
                                        {1214}event beginCli(Cli,Sess,gNc_1495);
                                        {1215}out(c, (pkCli_1080,m1_1496));
                                        {1216}in(c, em2_1497: bitstring);
                                        {1217}let m2_1498: bitstring = em2_1497 in
                                        {1218}let (=OpenSecureChannelResponse,=Cli,PartS_1499: bitstring,ST_1500: bitstring,TTL_1501: bitstring) = m2_1498 in
                                        {1219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1220}event endCli(Sess,Cli,PartS_1499)
                                    )
                                    else
                                        {1221}let v_1502: bool = (Sess = B) in
                                        (
                                            {1222}if v_1502 then
                                            (
                                                {1223}let pkSess_1503: bitstring = pub(skB) in
                                                {1224}out(c, GetEndpointRequest);
                                                {1225}in(c, (=GetEndpointResponse,=pkSess_1503,=None,SP_1504: bitstring,UP_1505: bitstring));
                                                {1226}new Nc_1506: bitstring;
                                                {1227}let gNc_1507: bitstring = exp(g,Nc_1506) in
                                                {1228}let m1_1508: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1507) in
                                                {1229}event beginCli(Cli,Sess,gNc_1507);
                                                {1230}out(c, (pkCli_1080,m1_1508));
                                                {1231}in(c, em2_1509: bitstring);
                                                {1232}let m2_1510: bitstring = em2_1509 in
                                                {1233}let (=OpenSecureChannelResponse,=Cli,PartS_1511: bitstring,ST_1512: bitstring,TTL_1513: bitstring) = m2_1510 in
                                                {1234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1235}event endCli(Sess,Cli,PartS_1511)
                                            )
                                            else
                                                {1236}let v_1514: bool = (Sess = C) in
                                                (
                                                    {1237}if v_1514 then
                                                    (
                                                        {1238}let pkSess_1515: bitstring = pub(skC) in
                                                        {1239}out(c, GetEndpointRequest);
                                                        {1240}in(c, (=GetEndpointResponse,=pkSess_1515,=None,SP_1516: bitstring,UP_1517: bitstring));
                                                        {1241}new Nc_1518: bitstring;
                                                        {1242}let gNc_1519: bitstring = exp(g,Nc_1518) in
                                                        {1243}let m1_1520: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1519) in
                                                        {1244}event beginCli(Cli,Sess,gNc_1519);
                                                        {1245}out(c, (pkCli_1080,m1_1520));
                                                        {1246}in(c, em2_1521: bitstring);
                                                        {1247}let m2_1522: bitstring = em2_1521 in
                                                        {1248}let (=OpenSecureChannelResponse,=Cli,PartS_1523: bitstring,ST_1524: bitstring,TTL_1525: bitstring) = m2_1522 in
                                                        {1249}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1250}event endCli(Sess,Cli,PartS_1523)
                                                    )
                                                    else
                                                        {1251}let pkSess_1526: bitstring = pub(sk(Sess)) in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (=GetEndpointResponse,=pkSess_1526,=None,SP_1527: bitstring,UP_1528: bitstring));
                                                        {1254}new Nc_1529: bitstring;
                                                        {1255}let gNc_1530: bitstring = exp(g,Nc_1529) in
                                                        {1256}let m1_1531: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1530) in
                                                        {1257}event beginCli(Cli,Sess,gNc_1530);
                                                        {1258}out(c, (pkCli_1080,m1_1531));
                                                        {1259}in(c, em2_1532: bitstring);
                                                        {1260}let m2_1533: bitstring = em2_1532 in
                                                        {1261}let (=OpenSecureChannelResponse,=Cli,PartS_1534: bitstring,ST_1535: bitstring,TTL_1536: bitstring) = m2_1533 in
                                                        {1262}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1263}event endCli(Sess,Cli,PartS_1534)
                                                )
                                                else
                                                    {1264}let pkSess_1537: bitstring = fail-any in
                                                    {1265}out(c, GetEndpointRequest);
                                                    {1266}in(c, (=GetEndpointResponse,=pkSess_1537,=None,SP_1538: bitstring,UP_1539: bitstring));
                                                    {1267}new Nc_1540: bitstring;
                                                    {1268}let gNc_1541: bitstring = exp(g,Nc_1540) in
                                                    {1269}let m1_1542: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1541) in
                                                    {1270}event beginCli(Cli,Sess,gNc_1541);
                                                    {1271}out(c, (pkCli_1080,m1_1542));
                                                    {1272}in(c, em2_1543: bitstring);
                                                    {1273}let m2_1544: bitstring = em2_1543 in
                                                    {1274}let (=OpenSecureChannelResponse,=Cli,PartS_1545: bitstring,ST_1546: bitstring,TTL_1547: bitstring) = m2_1544 in
                                                    {1275}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1276}event endCli(Sess,Cli,PartS_1545)
                                        )
                                        else
                                            {1277}let pkSess_1548: bitstring = fail-any in
                                            {1278}out(c, GetEndpointRequest);
                                            {1279}in(c, (=GetEndpointResponse,=pkSess_1548,=None,SP_1549: bitstring,UP_1550: bitstring));
                                            {1280}new Nc_1551: bitstring;
                                            {1281}let gNc_1552: bitstring = exp(g,Nc_1551) in
                                            {1282}let m1_1553: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1552) in
                                            {1283}event beginCli(Cli,Sess,gNc_1552);
                                            {1284}out(c, (pkCli_1080,m1_1553));
                                            {1285}in(c, em2_1554: bitstring);
                                            {1286}let m2_1555: bitstring = em2_1554 in
                                            {1287}let (=OpenSecureChannelResponse,=Cli,PartS_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                            {1288}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1289}event endCli(Sess,Cli,PartS_1556)
                                )
                                else
                                    {1290}let pkSess_1559: bitstring = fail-any in
                                    {1291}out(c, GetEndpointRequest);
                                    {1292}in(c, (=GetEndpointResponse,=pkSess_1559,=None,SP_1560: bitstring,UP_1561: bitstring));
                                    {1293}new Nc_1562: bitstring;
                                    {1294}let gNc_1563: bitstring = exp(g,Nc_1562) in
                                    {1295}let m1_1564: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1563) in
                                    {1296}event beginCli(Cli,Sess,gNc_1563);
                                    {1297}out(c, (pkCli_1080,m1_1564));
                                    {1298}in(c, em2_1565: bitstring);
                                    {1299}let m2_1566: bitstring = em2_1565 in
                                    {1300}let (=OpenSecureChannelResponse,=Cli,PartS_1567: bitstring,ST_1568: bitstring,TTL_1569: bitstring) = m2_1566 in
                                    {1301}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1302}event endCli(Sess,Cli,PartS_1567)
                    )
                    else
                        {1303}let pkDisco_1570: bitstring = fail-any in
                        {1304}let v_1571: bool = (Sess = A) in
                        (
                            {1305}if v_1571 then
                            (
                                {1306}let pkSess_1572: bitstring = pub(skA) in
                                {1307}out(c, GetEndpointRequest);
                                {1308}in(c, (=GetEndpointResponse,=pkSess_1572,=None,SP_1573: bitstring,UP_1574: bitstring));
                                {1309}new Nc_1575: bitstring;
                                {1310}let gNc_1576: bitstring = exp(g,Nc_1575) in
                                {1311}let m1_1577: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1576) in
                                {1312}event beginCli(Cli,Sess,gNc_1576);
                                {1313}out(c, (pkCli_1080,m1_1577));
                                {1314}in(c, em2_1578: bitstring);
                                {1315}let m2_1579: bitstring = em2_1578 in
                                {1316}let (=OpenSecureChannelResponse,=Cli,PartS_1580: bitstring,ST_1581: bitstring,TTL_1582: bitstring) = m2_1579 in
                                {1317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {1318}event endCli(Sess,Cli,PartS_1580)
                            )
                            else
                                {1319}let v_1583: bool = (Sess = B) in
                                (
                                    {1320}if v_1583 then
                                    (
                                        {1321}let pkSess_1584: bitstring = pub(skB) in
                                        {1322}out(c, GetEndpointRequest);
                                        {1323}in(c, (=GetEndpointResponse,=pkSess_1584,=None,SP_1585: bitstring,UP_1586: bitstring));
                                        {1324}new Nc_1587: bitstring;
                                        {1325}let gNc_1588: bitstring = exp(g,Nc_1587) in
                                        {1326}let m1_1589: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1588) in
                                        {1327}event beginCli(Cli,Sess,gNc_1588);
                                        {1328}out(c, (pkCli_1080,m1_1589));
                                        {1329}in(c, em2_1590: bitstring);
                                        {1330}let m2_1591: bitstring = em2_1590 in
                                        {1331}let (=OpenSecureChannelResponse,=Cli,PartS_1592: bitstring,ST_1593: bitstring,TTL_1594: bitstring) = m2_1591 in
                                        {1332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1333}event endCli(Sess,Cli,PartS_1592)
                                    )
                                    else
                                        {1334}let v_1595: bool = (Sess = C) in
                                        (
                                            {1335}if v_1595 then
                                            (
                                                {1336}let pkSess_1596: bitstring = pub(skC) in
                                                {1337}out(c, GetEndpointRequest);
                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1596,=None,SP_1597: bitstring,UP_1598: bitstring));
                                                {1339}new Nc_1599: bitstring;
                                                {1340}let gNc_1600: bitstring = exp(g,Nc_1599) in
                                                {1341}let m1_1601: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1600) in
                                                {1342}event beginCli(Cli,Sess,gNc_1600);
                                                {1343}out(c, (pkCli_1080,m1_1601));
                                                {1344}in(c, em2_1602: bitstring);
                                                {1345}let m2_1603: bitstring = em2_1602 in
                                                {1346}let (=OpenSecureChannelResponse,=Cli,PartS_1604: bitstring,ST_1605: bitstring,TTL_1606: bitstring) = m2_1603 in
                                                {1347}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1348}event endCli(Sess,Cli,PartS_1604)
                                            )
                                            else
                                                {1349}let pkSess_1607: bitstring = pub(sk(Sess)) in
                                                {1350}out(c, GetEndpointRequest);
                                                {1351}in(c, (=GetEndpointResponse,=pkSess_1607,=None,SP_1608: bitstring,UP_1609: bitstring));
                                                {1352}new Nc_1610: bitstring;
                                                {1353}let gNc_1611: bitstring = exp(g,Nc_1610) in
                                                {1354}let m1_1612: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1611) in
                                                {1355}event beginCli(Cli,Sess,gNc_1611);
                                                {1356}out(c, (pkCli_1080,m1_1612));
                                                {1357}in(c, em2_1613: bitstring);
                                                {1358}let m2_1614: bitstring = em2_1613 in
                                                {1359}let (=OpenSecureChannelResponse,=Cli,PartS_1615: bitstring,ST_1616: bitstring,TTL_1617: bitstring) = m2_1614 in
                                                {1360}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1361}event endCli(Sess,Cli,PartS_1615)
                                        )
                                        else
                                            {1362}let pkSess_1618: bitstring = fail-any in
                                            {1363}out(c, GetEndpointRequest);
                                            {1364}in(c, (=GetEndpointResponse,=pkSess_1618,=None,SP_1619: bitstring,UP_1620: bitstring));
                                            {1365}new Nc_1621: bitstring;
                                            {1366}let gNc_1622: bitstring = exp(g,Nc_1621) in
                                            {1367}let m1_1623: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1622) in
                                            {1368}event beginCli(Cli,Sess,gNc_1622);
                                            {1369}out(c, (pkCli_1080,m1_1623));
                                            {1370}in(c, em2_1624: bitstring);
                                            {1371}let m2_1625: bitstring = em2_1624 in
                                            {1372}let (=OpenSecureChannelResponse,=Cli,PartS_1626: bitstring,ST_1627: bitstring,TTL_1628: bitstring) = m2_1625 in
                                            {1373}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1374}event endCli(Sess,Cli,PartS_1626)
                                )
                                else
                                    {1375}let pkSess_1629: bitstring = fail-any in
                                    {1376}out(c, GetEndpointRequest);
                                    {1377}in(c, (=GetEndpointResponse,=pkSess_1629,=None,SP_1630: bitstring,UP_1631: bitstring));
                                    {1378}new Nc_1632: bitstring;
                                    {1379}let gNc_1633: bitstring = exp(g,Nc_1632) in
                                    {1380}let m1_1634: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1633) in
                                    {1381}event beginCli(Cli,Sess,gNc_1633);
                                    {1382}out(c, (pkCli_1080,m1_1634));
                                    {1383}in(c, em2_1635: bitstring);
                                    {1384}let m2_1636: bitstring = em2_1635 in
                                    {1385}let (=OpenSecureChannelResponse,=Cli,PartS_1637: bitstring,ST_1638: bitstring,TTL_1639: bitstring) = m2_1636 in
                                    {1386}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1387}event endCli(Sess,Cli,PartS_1637)
                        )
                        else
                            {1388}let pkSess_1640: bitstring = fail-any in
                            {1389}out(c, GetEndpointRequest);
                            {1390}in(c, (=GetEndpointResponse,=pkSess_1640,=None,SP_1641: bitstring,UP_1642: bitstring));
                            {1391}new Nc_1643: bitstring;
                            {1392}let gNc_1644: bitstring = exp(g,Nc_1643) in
                            {1393}let m1_1645: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1080,gNc_1644) in
                            {1394}event beginCli(Cli,Sess,gNc_1644);
                            {1395}out(c, (pkCli_1080,m1_1645));
                            {1396}in(c, em2_1646: bitstring);
                            {1397}let m2_1647: bitstring = em2_1646 in
                            {1398}let (=OpenSecureChannelResponse,=Cli,PartS_1648: bitstring,ST_1649: bitstring,TTL_1650: bitstring) = m2_1647 in
                            {1399}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {1400}event endCli(Sess,Cli,PartS_1648)
                )
                else
                    {1401}let =true = (Cli = C) in
                    (
                        {1402}let skCli_1651: bitstring = skC in
                        {1403}let pkCli_1652: bitstring = pub(skCli_1651) in
                        {1404}let v_1653: bool = (Disco = A) in
                        (
                            {1405}if v_1653 then
                            (
                                {1406}let pkDisco_1654: bitstring = pub(skA) in
                                {1407}let v_1655: bool = (Sess = A) in
                                (
                                    {1408}if v_1655 then
                                    (
                                        {1409}let pkSess_1656: bitstring = pub(skA) in
                                        {1410}out(c, GetEndpointRequest);
                                        {1411}in(c, (=GetEndpointResponse,=pkSess_1656,=None,SP_1657: bitstring,UP_1658: bitstring));
                                        {1412}new Nc_1659: bitstring;
                                        {1413}let gNc_1660: bitstring = exp(g,Nc_1659) in
                                        {1414}let m1_1661: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1660) in
                                        {1415}event beginCli(Cli,Sess,gNc_1660);
                                        {1416}out(c, (pkCli_1652,m1_1661));
                                        {1417}in(c, em2_1662: bitstring);
                                        {1418}let m2_1663: bitstring = em2_1662 in
                                        {1419}let (=OpenSecureChannelResponse,=Cli,PartS_1664: bitstring,ST_1665: bitstring,TTL_1666: bitstring) = m2_1663 in
                                        {1420}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1421}event endCli(Sess,Cli,PartS_1664)
                                    )
                                    else
                                        {1422}let v_1667: bool = (Sess = B) in
                                        (
                                            {1423}if v_1667 then
                                            (
                                                {1424}let pkSess_1668: bitstring = pub(skB) in
                                                {1425}out(c, GetEndpointRequest);
                                                {1426}in(c, (=GetEndpointResponse,=pkSess_1668,=None,SP_1669: bitstring,UP_1670: bitstring));
                                                {1427}new Nc_1671: bitstring;
                                                {1428}let gNc_1672: bitstring = exp(g,Nc_1671) in
                                                {1429}let m1_1673: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1672) in
                                                {1430}event beginCli(Cli,Sess,gNc_1672);
                                                {1431}out(c, (pkCli_1652,m1_1673));
                                                {1432}in(c, em2_1674: bitstring);
                                                {1433}let m2_1675: bitstring = em2_1674 in
                                                {1434}let (=OpenSecureChannelResponse,=Cli,PartS_1676: bitstring,ST_1677: bitstring,TTL_1678: bitstring) = m2_1675 in
                                                {1435}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1436}event endCli(Sess,Cli,PartS_1676)
                                            )
                                            else
                                                {1437}let v_1679: bool = (Sess = C) in
                                                (
                                                    {1438}if v_1679 then
                                                    (
                                                        {1439}let pkSess_1680: bitstring = pub(skC) in
                                                        {1440}out(c, GetEndpointRequest);
                                                        {1441}in(c, (=GetEndpointResponse,=pkSess_1680,=None,SP_1681: bitstring,UP_1682: bitstring));
                                                        {1442}new Nc_1683: bitstring;
                                                        {1443}let gNc_1684: bitstring = exp(g,Nc_1683) in
                                                        {1444}let m1_1685: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1684) in
                                                        {1445}event beginCli(Cli,Sess,gNc_1684);
                                                        {1446}out(c, (pkCli_1652,m1_1685));
                                                        {1447}in(c, em2_1686: bitstring);
                                                        {1448}let m2_1687: bitstring = em2_1686 in
                                                        {1449}let (=OpenSecureChannelResponse,=Cli,PartS_1688: bitstring,ST_1689: bitstring,TTL_1690: bitstring) = m2_1687 in
                                                        {1450}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1451}event endCli(Sess,Cli,PartS_1688)
                                                    )
                                                    else
                                                        {1452}let pkSess_1691: bitstring = pub(sk(Sess)) in
                                                        {1453}out(c, GetEndpointRequest);
                                                        {1454}in(c, (=GetEndpointResponse,=pkSess_1691,=None,SP_1692: bitstring,UP_1693: bitstring));
                                                        {1455}new Nc_1694: bitstring;
                                                        {1456}let gNc_1695: bitstring = exp(g,Nc_1694) in
                                                        {1457}let m1_1696: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1695) in
                                                        {1458}event beginCli(Cli,Sess,gNc_1695);
                                                        {1459}out(c, (pkCli_1652,m1_1696));
                                                        {1460}in(c, em2_1697: bitstring);
                                                        {1461}let m2_1698: bitstring = em2_1697 in
                                                        {1462}let (=OpenSecureChannelResponse,=Cli,PartS_1699: bitstring,ST_1700: bitstring,TTL_1701: bitstring) = m2_1698 in
                                                        {1463}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1464}event endCli(Sess,Cli,PartS_1699)
                                                )
                                                else
                                                    {1465}let pkSess_1702: bitstring = fail-any in
                                                    {1466}out(c, GetEndpointRequest);
                                                    {1467}in(c, (=GetEndpointResponse,=pkSess_1702,=None,SP_1703: bitstring,UP_1704: bitstring));
                                                    {1468}new Nc_1705: bitstring;
                                                    {1469}let gNc_1706: bitstring = exp(g,Nc_1705) in
                                                    {1470}let m1_1707: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1706) in
                                                    {1471}event beginCli(Cli,Sess,gNc_1706);
                                                    {1472}out(c, (pkCli_1652,m1_1707));
                                                    {1473}in(c, em2_1708: bitstring);
                                                    {1474}let m2_1709: bitstring = em2_1708 in
                                                    {1475}let (=OpenSecureChannelResponse,=Cli,PartS_1710: bitstring,ST_1711: bitstring,TTL_1712: bitstring) = m2_1709 in
                                                    {1476}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1477}event endCli(Sess,Cli,PartS_1710)
                                        )
                                        else
                                            {1478}let pkSess_1713: bitstring = fail-any in
                                            {1479}out(c, GetEndpointRequest);
                                            {1480}in(c, (=GetEndpointResponse,=pkSess_1713,=None,SP_1714: bitstring,UP_1715: bitstring));
                                            {1481}new Nc_1716: bitstring;
                                            {1482}let gNc_1717: bitstring = exp(g,Nc_1716) in
                                            {1483}let m1_1718: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1717) in
                                            {1484}event beginCli(Cli,Sess,gNc_1717);
                                            {1485}out(c, (pkCli_1652,m1_1718));
                                            {1486}in(c, em2_1719: bitstring);
                                            {1487}let m2_1720: bitstring = em2_1719 in
                                            {1488}let (=OpenSecureChannelResponse,=Cli,PartS_1721: bitstring,ST_1722: bitstring,TTL_1723: bitstring) = m2_1720 in
                                            {1489}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1490}event endCli(Sess,Cli,PartS_1721)
                                )
                                else
                                    {1491}let pkSess_1724: bitstring = fail-any in
                                    {1492}out(c, GetEndpointRequest);
                                    {1493}in(c, (=GetEndpointResponse,=pkSess_1724,=None,SP_1725: bitstring,UP_1726: bitstring));
                                    {1494}new Nc_1727: bitstring;
                                    {1495}let gNc_1728: bitstring = exp(g,Nc_1727) in
                                    {1496}let m1_1729: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1728) in
                                    {1497}event beginCli(Cli,Sess,gNc_1728);
                                    {1498}out(c, (pkCli_1652,m1_1729));
                                    {1499}in(c, em2_1730: bitstring);
                                    {1500}let m2_1731: bitstring = em2_1730 in
                                    {1501}let (=OpenSecureChannelResponse,=Cli,PartS_1732: bitstring,ST_1733: bitstring,TTL_1734: bitstring) = m2_1731 in
                                    {1502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {1503}event endCli(Sess,Cli,PartS_1732)
                            )
                            else
                                {1504}let v_1735: bool = (Disco = B) in
                                (
                                    {1505}if v_1735 then
                                    (
                                        {1506}let pkDisco_1736: bitstring = pub(skB) in
                                        {1507}let v_1737: bool = (Sess = A) in
                                        (
                                            {1508}if v_1737 then
                                            (
                                                {1509}let pkSess_1738: bitstring = pub(skA) in
                                                {1510}out(c, GetEndpointRequest);
                                                {1511}in(c, (=GetEndpointResponse,=pkSess_1738,=None,SP_1739: bitstring,UP_1740: bitstring));
                                                {1512}new Nc_1741: bitstring;
                                                {1513}let gNc_1742: bitstring = exp(g,Nc_1741) in
                                                {1514}let m1_1743: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1742) in
                                                {1515}event beginCli(Cli,Sess,gNc_1742);
                                                {1516}out(c, (pkCli_1652,m1_1743));
                                                {1517}in(c, em2_1744: bitstring);
                                                {1518}let m2_1745: bitstring = em2_1744 in
                                                {1519}let (=OpenSecureChannelResponse,=Cli,PartS_1746: bitstring,ST_1747: bitstring,TTL_1748: bitstring) = m2_1745 in
                                                {1520}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1521}event endCli(Sess,Cli,PartS_1746)
                                            )
                                            else
                                                {1522}let v_1749: bool = (Sess = B) in
                                                (
                                                    {1523}if v_1749 then
                                                    (
                                                        {1524}let pkSess_1750: bitstring = pub(skB) in
                                                        {1525}out(c, GetEndpointRequest);
                                                        {1526}in(c, (=GetEndpointResponse,=pkSess_1750,=None,SP_1751: bitstring,UP_1752: bitstring));
                                                        {1527}new Nc_1753: bitstring;
                                                        {1528}let gNc_1754: bitstring = exp(g,Nc_1753) in
                                                        {1529}let m1_1755: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1754) in
                                                        {1530}event beginCli(Cli,Sess,gNc_1754);
                                                        {1531}out(c, (pkCli_1652,m1_1755));
                                                        {1532}in(c, em2_1756: bitstring);
                                                        {1533}let m2_1757: bitstring = em2_1756 in
                                                        {1534}let (=OpenSecureChannelResponse,=Cli,PartS_1758: bitstring,ST_1759: bitstring,TTL_1760: bitstring) = m2_1757 in
                                                        {1535}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1536}event endCli(Sess,Cli,PartS_1758)
                                                    )
                                                    else
                                                        {1537}let v_1761: bool = (Sess = C) in
                                                        (
                                                            {1538}if v_1761 then
                                                            (
                                                                {1539}let pkSess_1762: bitstring = pub(skC) in
                                                                {1540}out(c, GetEndpointRequest);
                                                                {1541}in(c, (=GetEndpointResponse,=pkSess_1762,=None,SP_1763: bitstring,UP_1764: bitstring));
                                                                {1542}new Nc_1765: bitstring;
                                                                {1543}let gNc_1766: bitstring = exp(g,Nc_1765) in
                                                                {1544}let m1_1767: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1766) in
                                                                {1545}event beginCli(Cli,Sess,gNc_1766);
                                                                {1546}out(c, (pkCli_1652,m1_1767));
                                                                {1547}in(c, em2_1768: bitstring);
                                                                {1548}let m2_1769: bitstring = em2_1768 in
                                                                {1549}let (=OpenSecureChannelResponse,=Cli,PartS_1770: bitstring,ST_1771: bitstring,TTL_1772: bitstring) = m2_1769 in
                                                                {1550}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1551}event endCli(Sess,Cli,PartS_1770)
                                                            )
                                                            else
                                                                {1552}let pkSess_1773: bitstring = pub(sk(Sess)) in
                                                                {1553}out(c, GetEndpointRequest);
                                                                {1554}in(c, (=GetEndpointResponse,=pkSess_1773,=None,SP_1774: bitstring,UP_1775: bitstring));
                                                                {1555}new Nc_1776: bitstring;
                                                                {1556}let gNc_1777: bitstring = exp(g,Nc_1776) in
                                                                {1557}let m1_1778: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1777) in
                                                                {1558}event beginCli(Cli,Sess,gNc_1777);
                                                                {1559}out(c, (pkCli_1652,m1_1778));
                                                                {1560}in(c, em2_1779: bitstring);
                                                                {1561}let m2_1780: bitstring = em2_1779 in
                                                                {1562}let (=OpenSecureChannelResponse,=Cli,PartS_1781: bitstring,ST_1782: bitstring,TTL_1783: bitstring) = m2_1780 in
                                                                {1563}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1564}event endCli(Sess,Cli,PartS_1781)
                                                        )
                                                        else
                                                            {1565}let pkSess_1784: bitstring = fail-any in
                                                            {1566}out(c, GetEndpointRequest);
                                                            {1567}in(c, (=GetEndpointResponse,=pkSess_1784,=None,SP_1785: bitstring,UP_1786: bitstring));
                                                            {1568}new Nc_1787: bitstring;
                                                            {1569}let gNc_1788: bitstring = exp(g,Nc_1787) in
                                                            {1570}let m1_1789: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1788) in
                                                            {1571}event beginCli(Cli,Sess,gNc_1788);
                                                            {1572}out(c, (pkCli_1652,m1_1789));
                                                            {1573}in(c, em2_1790: bitstring);
                                                            {1574}let m2_1791: bitstring = em2_1790 in
                                                            {1575}let (=OpenSecureChannelResponse,=Cli,PartS_1792: bitstring,ST_1793: bitstring,TTL_1794: bitstring) = m2_1791 in
                                                            {1576}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1577}event endCli(Sess,Cli,PartS_1792)
                                                )
                                                else
                                                    {1578}let pkSess_1795: bitstring = fail-any in
                                                    {1579}out(c, GetEndpointRequest);
                                                    {1580}in(c, (=GetEndpointResponse,=pkSess_1795,=None,SP_1796: bitstring,UP_1797: bitstring));
                                                    {1581}new Nc_1798: bitstring;
                                                    {1582}let gNc_1799: bitstring = exp(g,Nc_1798) in
                                                    {1583}let m1_1800: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1799) in
                                                    {1584}event beginCli(Cli,Sess,gNc_1799);
                                                    {1585}out(c, (pkCli_1652,m1_1800));
                                                    {1586}in(c, em2_1801: bitstring);
                                                    {1587}let m2_1802: bitstring = em2_1801 in
                                                    {1588}let (=OpenSecureChannelResponse,=Cli,PartS_1803: bitstring,ST_1804: bitstring,TTL_1805: bitstring) = m2_1802 in
                                                    {1589}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1590}event endCli(Sess,Cli,PartS_1803)
                                        )
                                        else
                                            {1591}let pkSess_1806: bitstring = fail-any in
                                            {1592}out(c, GetEndpointRequest);
                                            {1593}in(c, (=GetEndpointResponse,=pkSess_1806,=None,SP_1807: bitstring,UP_1808: bitstring));
                                            {1594}new Nc_1809: bitstring;
                                            {1595}let gNc_1810: bitstring = exp(g,Nc_1809) in
                                            {1596}let m1_1811: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1810) in
                                            {1597}event beginCli(Cli,Sess,gNc_1810);
                                            {1598}out(c, (pkCli_1652,m1_1811));
                                            {1599}in(c, em2_1812: bitstring);
                                            {1600}let m2_1813: bitstring = em2_1812 in
                                            {1601}let (=OpenSecureChannelResponse,=Cli,PartS_1814: bitstring,ST_1815: bitstring,TTL_1816: bitstring) = m2_1813 in
                                            {1602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1603}event endCli(Sess,Cli,PartS_1814)
                                    )
                                    else
                                        {1604}let v_1817: bool = (Disco = C) in
                                        (
                                            {1605}if v_1817 then
                                            (
                                                {1606}let pkDisco_1818: bitstring = pub(skC) in
                                                {1607}let v_1819: bool = (Sess = A) in
                                                (
                                                    {1608}if v_1819 then
                                                    (
                                                        {1609}let pkSess_1820: bitstring = pub(skA) in
                                                        {1610}out(c, GetEndpointRequest);
                                                        {1611}in(c, (=GetEndpointResponse,=pkSess_1820,=None,SP_1821: bitstring,UP_1822: bitstring));
                                                        {1612}new Nc_1823: bitstring;
                                                        {1613}let gNc_1824: bitstring = exp(g,Nc_1823) in
                                                        {1614}let m1_1825: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1824) in
                                                        {1615}event beginCli(Cli,Sess,gNc_1824);
                                                        {1616}out(c, (pkCli_1652,m1_1825));
                                                        {1617}in(c, em2_1826: bitstring);
                                                        {1618}let m2_1827: bitstring = em2_1826 in
                                                        {1619}let (=OpenSecureChannelResponse,=Cli,PartS_1828: bitstring,ST_1829: bitstring,TTL_1830: bitstring) = m2_1827 in
                                                        {1620}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1621}event endCli(Sess,Cli,PartS_1828)
                                                    )
                                                    else
                                                        {1622}let v_1831: bool = (Sess = B) in
                                                        (
                                                            {1623}if v_1831 then
                                                            (
                                                                {1624}let pkSess_1832: bitstring = pub(skB) in
                                                                {1625}out(c, GetEndpointRequest);
                                                                {1626}in(c, (=GetEndpointResponse,=pkSess_1832,=None,SP_1833: bitstring,UP_1834: bitstring));
                                                                {1627}new Nc_1835: bitstring;
                                                                {1628}let gNc_1836: bitstring = exp(g,Nc_1835) in
                                                                {1629}let m1_1837: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1836) in
                                                                {1630}event beginCli(Cli,Sess,gNc_1836);
                                                                {1631}out(c, (pkCli_1652,m1_1837));
                                                                {1632}in(c, em2_1838: bitstring);
                                                                {1633}let m2_1839: bitstring = em2_1838 in
                                                                {1634}let (=OpenSecureChannelResponse,=Cli,PartS_1840: bitstring,ST_1841: bitstring,TTL_1842: bitstring) = m2_1839 in
                                                                {1635}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1636}event endCli(Sess,Cli,PartS_1840)
                                                            )
                                                            else
                                                                {1637}let v_1843: bool = (Sess = C) in
                                                                (
                                                                    {1638}if v_1843 then
                                                                    (
                                                                        {1639}let pkSess_1844: bitstring = pub(skC) in
                                                                        {1640}out(c, GetEndpointRequest);
                                                                        {1641}in(c, (=GetEndpointResponse,=pkSess_1844,=None,SP_1845: bitstring,UP_1846: bitstring));
                                                                        {1642}new Nc_1847: bitstring;
                                                                        {1643}let gNc_1848: bitstring = exp(g,Nc_1847) in
                                                                        {1644}let m1_1849: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1848) in
                                                                        {1645}event beginCli(Cli,Sess,gNc_1848);
                                                                        {1646}out(c, (pkCli_1652,m1_1849));
                                                                        {1647}in(c, em2_1850: bitstring);
                                                                        {1648}let m2_1851: bitstring = em2_1850 in
                                                                        {1649}let (=OpenSecureChannelResponse,=Cli,PartS_1852: bitstring,ST_1853: bitstring,TTL_1854: bitstring) = m2_1851 in
                                                                        {1650}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1651}event endCli(Sess,Cli,PartS_1852)
                                                                    )
                                                                    else
                                                                        {1652}let pkSess_1855: bitstring = pub(sk(Sess)) in
                                                                        {1653}out(c, GetEndpointRequest);
                                                                        {1654}in(c, (=GetEndpointResponse,=pkSess_1855,=None,SP_1856: bitstring,UP_1857: bitstring));
                                                                        {1655}new Nc_1858: bitstring;
                                                                        {1656}let gNc_1859: bitstring = exp(g,Nc_1858) in
                                                                        {1657}let m1_1860: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1859) in
                                                                        {1658}event beginCli(Cli,Sess,gNc_1859);
                                                                        {1659}out(c, (pkCli_1652,m1_1860));
                                                                        {1660}in(c, em2_1861: bitstring);
                                                                        {1661}let m2_1862: bitstring = em2_1861 in
                                                                        {1662}let (=OpenSecureChannelResponse,=Cli,PartS_1863: bitstring,ST_1864: bitstring,TTL_1865: bitstring) = m2_1862 in
                                                                        {1663}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1664}event endCli(Sess,Cli,PartS_1863)
                                                                )
                                                                else
                                                                    {1665}let pkSess_1866: bitstring = fail-any in
                                                                    {1666}out(c, GetEndpointRequest);
                                                                    {1667}in(c, (=GetEndpointResponse,=pkSess_1866,=None,SP_1867: bitstring,UP_1868: bitstring));
                                                                    {1668}new Nc_1869: bitstring;
                                                                    {1669}let gNc_1870: bitstring = exp(g,Nc_1869) in
                                                                    {1670}let m1_1871: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1870) in
                                                                    {1671}event beginCli(Cli,Sess,gNc_1870);
                                                                    {1672}out(c, (pkCli_1652,m1_1871));
                                                                    {1673}in(c, em2_1872: bitstring);
                                                                    {1674}let m2_1873: bitstring = em2_1872 in
                                                                    {1675}let (=OpenSecureChannelResponse,=Cli,PartS_1874: bitstring,ST_1875: bitstring,TTL_1876: bitstring) = m2_1873 in
                                                                    {1676}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1677}event endCli(Sess,Cli,PartS_1874)
                                                        )
                                                        else
                                                            {1678}let pkSess_1877: bitstring = fail-any in
                                                            {1679}out(c, GetEndpointRequest);
                                                            {1680}in(c, (=GetEndpointResponse,=pkSess_1877,=None,SP_1878: bitstring,UP_1879: bitstring));
                                                            {1681}new Nc_1880: bitstring;
                                                            {1682}let gNc_1881: bitstring = exp(g,Nc_1880) in
                                                            {1683}let m1_1882: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1881) in
                                                            {1684}event beginCli(Cli,Sess,gNc_1881);
                                                            {1685}out(c, (pkCli_1652,m1_1882));
                                                            {1686}in(c, em2_1883: bitstring);
                                                            {1687}let m2_1884: bitstring = em2_1883 in
                                                            {1688}let (=OpenSecureChannelResponse,=Cli,PartS_1885: bitstring,ST_1886: bitstring,TTL_1887: bitstring) = m2_1884 in
                                                            {1689}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1690}event endCli(Sess,Cli,PartS_1885)
                                                )
                                                else
                                                    {1691}let pkSess_1888: bitstring = fail-any in
                                                    {1692}out(c, GetEndpointRequest);
                                                    {1693}in(c, (=GetEndpointResponse,=pkSess_1888,=None,SP_1889: bitstring,UP_1890: bitstring));
                                                    {1694}new Nc_1891: bitstring;
                                                    {1695}let gNc_1892: bitstring = exp(g,Nc_1891) in
                                                    {1696}let m1_1893: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1892) in
                                                    {1697}event beginCli(Cli,Sess,gNc_1892);
                                                    {1698}out(c, (pkCli_1652,m1_1893));
                                                    {1699}in(c, em2_1894: bitstring);
                                                    {1700}let m2_1895: bitstring = em2_1894 in
                                                    {1701}let (=OpenSecureChannelResponse,=Cli,PartS_1896: bitstring,ST_1897: bitstring,TTL_1898: bitstring) = m2_1895 in
                                                    {1702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1703}event endCli(Sess,Cli,PartS_1896)
                                            )
                                            else
                                                {1704}let pkDisco_1899: bitstring = pub(sk(Disco)) in
                                                {1705}let v_1900: bool = (Sess = A) in
                                                (
                                                    {1706}if v_1900 then
                                                    (
                                                        {1707}let pkSess_1901: bitstring = pub(skA) in
                                                        {1708}out(c, GetEndpointRequest);
                                                        {1709}in(c, (=GetEndpointResponse,=pkSess_1901,=None,SP_1902: bitstring,UP_1903: bitstring));
                                                        {1710}new Nc_1904: bitstring;
                                                        {1711}let gNc_1905: bitstring = exp(g,Nc_1904) in
                                                        {1712}let m1_1906: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1905) in
                                                        {1713}event beginCli(Cli,Sess,gNc_1905);
                                                        {1714}out(c, (pkCli_1652,m1_1906));
                                                        {1715}in(c, em2_1907: bitstring);
                                                        {1716}let m2_1908: bitstring = em2_1907 in
                                                        {1717}let (=OpenSecureChannelResponse,=Cli,PartS_1909: bitstring,ST_1910: bitstring,TTL_1911: bitstring) = m2_1908 in
                                                        {1718}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1719}event endCli(Sess,Cli,PartS_1909)
                                                    )
                                                    else
                                                        {1720}let v_1912: bool = (Sess = B) in
                                                        (
                                                            {1721}if v_1912 then
                                                            (
                                                                {1722}let pkSess_1913: bitstring = pub(skB) in
                                                                {1723}out(c, GetEndpointRequest);
                                                                {1724}in(c, (=GetEndpointResponse,=pkSess_1913,=None,SP_1914: bitstring,UP_1915: bitstring));
                                                                {1725}new Nc_1916: bitstring;
                                                                {1726}let gNc_1917: bitstring = exp(g,Nc_1916) in
                                                                {1727}let m1_1918: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1917) in
                                                                {1728}event beginCli(Cli,Sess,gNc_1917);
                                                                {1729}out(c, (pkCli_1652,m1_1918));
                                                                {1730}in(c, em2_1919: bitstring);
                                                                {1731}let m2_1920: bitstring = em2_1919 in
                                                                {1732}let (=OpenSecureChannelResponse,=Cli,PartS_1921: bitstring,ST_1922: bitstring,TTL_1923: bitstring) = m2_1920 in
                                                                {1733}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1734}event endCli(Sess,Cli,PartS_1921)
                                                            )
                                                            else
                                                                {1735}let v_1924: bool = (Sess = C) in
                                                                (
                                                                    {1736}if v_1924 then
                                                                    (
                                                                        {1737}let pkSess_1925: bitstring = pub(skC) in
                                                                        {1738}out(c, GetEndpointRequest);
                                                                        {1739}in(c, (=GetEndpointResponse,=pkSess_1925,=None,SP_1926: bitstring,UP_1927: bitstring));
                                                                        {1740}new Nc_1928: bitstring;
                                                                        {1741}let gNc_1929: bitstring = exp(g,Nc_1928) in
                                                                        {1742}let m1_1930: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1929) in
                                                                        {1743}event beginCli(Cli,Sess,gNc_1929);
                                                                        {1744}out(c, (pkCli_1652,m1_1930));
                                                                        {1745}in(c, em2_1931: bitstring);
                                                                        {1746}let m2_1932: bitstring = em2_1931 in
                                                                        {1747}let (=OpenSecureChannelResponse,=Cli,PartS_1933: bitstring,ST_1934: bitstring,TTL_1935: bitstring) = m2_1932 in
                                                                        {1748}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1749}event endCli(Sess,Cli,PartS_1933)
                                                                    )
                                                                    else
                                                                        {1750}let pkSess_1936: bitstring = pub(sk(Sess)) in
                                                                        {1751}out(c, GetEndpointRequest);
                                                                        {1752}in(c, (=GetEndpointResponse,=pkSess_1936,=None,SP_1937: bitstring,UP_1938: bitstring));
                                                                        {1753}new Nc_1939: bitstring;
                                                                        {1754}let gNc_1940: bitstring = exp(g,Nc_1939) in
                                                                        {1755}let m1_1941: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1940) in
                                                                        {1756}event beginCli(Cli,Sess,gNc_1940);
                                                                        {1757}out(c, (pkCli_1652,m1_1941));
                                                                        {1758}in(c, em2_1942: bitstring);
                                                                        {1759}let m2_1943: bitstring = em2_1942 in
                                                                        {1760}let (=OpenSecureChannelResponse,=Cli,PartS_1944: bitstring,ST_1945: bitstring,TTL_1946: bitstring) = m2_1943 in
                                                                        {1761}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {1762}event endCli(Sess,Cli,PartS_1944)
                                                                )
                                                                else
                                                                    {1763}let pkSess_1947: bitstring = fail-any in
                                                                    {1764}out(c, GetEndpointRequest);
                                                                    {1765}in(c, (=GetEndpointResponse,=pkSess_1947,=None,SP_1948: bitstring,UP_1949: bitstring));
                                                                    {1766}new Nc_1950: bitstring;
                                                                    {1767}let gNc_1951: bitstring = exp(g,Nc_1950) in
                                                                    {1768}let m1_1952: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1951) in
                                                                    {1769}event beginCli(Cli,Sess,gNc_1951);
                                                                    {1770}out(c, (pkCli_1652,m1_1952));
                                                                    {1771}in(c, em2_1953: bitstring);
                                                                    {1772}let m2_1954: bitstring = em2_1953 in
                                                                    {1773}let (=OpenSecureChannelResponse,=Cli,PartS_1955: bitstring,ST_1956: bitstring,TTL_1957: bitstring) = m2_1954 in
                                                                    {1774}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1775}event endCli(Sess,Cli,PartS_1955)
                                                        )
                                                        else
                                                            {1776}let pkSess_1958: bitstring = fail-any in
                                                            {1777}out(c, GetEndpointRequest);
                                                            {1778}in(c, (=GetEndpointResponse,=pkSess_1958,=None,SP_1959: bitstring,UP_1960: bitstring));
                                                            {1779}new Nc_1961: bitstring;
                                                            {1780}let gNc_1962: bitstring = exp(g,Nc_1961) in
                                                            {1781}let m1_1963: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1962) in
                                                            {1782}event beginCli(Cli,Sess,gNc_1962);
                                                            {1783}out(c, (pkCli_1652,m1_1963));
                                                            {1784}in(c, em2_1964: bitstring);
                                                            {1785}let m2_1965: bitstring = em2_1964 in
                                                            {1786}let (=OpenSecureChannelResponse,=Cli,PartS_1966: bitstring,ST_1967: bitstring,TTL_1968: bitstring) = m2_1965 in
                                                            {1787}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1788}event endCli(Sess,Cli,PartS_1966)
                                                )
                                                else
                                                    {1789}let pkSess_1969: bitstring = fail-any in
                                                    {1790}out(c, GetEndpointRequest);
                                                    {1791}in(c, (=GetEndpointResponse,=pkSess_1969,=None,SP_1970: bitstring,UP_1971: bitstring));
                                                    {1792}new Nc_1972: bitstring;
                                                    {1793}let gNc_1973: bitstring = exp(g,Nc_1972) in
                                                    {1794}let m1_1974: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1973) in
                                                    {1795}event beginCli(Cli,Sess,gNc_1973);
                                                    {1796}out(c, (pkCli_1652,m1_1974));
                                                    {1797}in(c, em2_1975: bitstring);
                                                    {1798}let m2_1976: bitstring = em2_1975 in
                                                    {1799}let (=OpenSecureChannelResponse,=Cli,PartS_1977: bitstring,ST_1978: bitstring,TTL_1979: bitstring) = m2_1976 in
                                                    {1800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1801}event endCli(Sess,Cli,PartS_1977)
                                        )
                                        else
                                            {1802}let pkDisco_1980: bitstring = fail-any in
                                            {1803}let v_1981: bool = (Sess = A) in
                                            (
                                                {1804}if v_1981 then
                                                (
                                                    {1805}let pkSess_1982: bitstring = pub(skA) in
                                                    {1806}out(c, GetEndpointRequest);
                                                    {1807}in(c, (=GetEndpointResponse,=pkSess_1982,=None,SP_1983: bitstring,UP_1984: bitstring));
                                                    {1808}new Nc_1985: bitstring;
                                                    {1809}let gNc_1986: bitstring = exp(g,Nc_1985) in
                                                    {1810}let m1_1987: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1986) in
                                                    {1811}event beginCli(Cli,Sess,gNc_1986);
                                                    {1812}out(c, (pkCli_1652,m1_1987));
                                                    {1813}in(c, em2_1988: bitstring);
                                                    {1814}let m2_1989: bitstring = em2_1988 in
                                                    {1815}let (=OpenSecureChannelResponse,=Cli,PartS_1990: bitstring,ST_1991: bitstring,TTL_1992: bitstring) = m2_1989 in
                                                    {1816}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1817}event endCli(Sess,Cli,PartS_1990)
                                                )
                                                else
                                                    {1818}let v_1993: bool = (Sess = B) in
                                                    (
                                                        {1819}if v_1993 then
                                                        (
                                                            {1820}let pkSess_1994: bitstring = pub(skB) in
                                                            {1821}out(c, GetEndpointRequest);
                                                            {1822}in(c, (=GetEndpointResponse,=pkSess_1994,=None,SP_1995: bitstring,UP_1996: bitstring));
                                                            {1823}new Nc_1997: bitstring;
                                                            {1824}let gNc_1998: bitstring = exp(g,Nc_1997) in
                                                            {1825}let m1_1999: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_1998) in
                                                            {1826}event beginCli(Cli,Sess,gNc_1998);
                                                            {1827}out(c, (pkCli_1652,m1_1999));
                                                            {1828}in(c, em2_2000: bitstring);
                                                            {1829}let m2_2001: bitstring = em2_2000 in
                                                            {1830}let (=OpenSecureChannelResponse,=Cli,PartS_2002: bitstring,ST_2003: bitstring,TTL_2004: bitstring) = m2_2001 in
                                                            {1831}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1832}event endCli(Sess,Cli,PartS_2002)
                                                        )
                                                        else
                                                            {1833}let v_2005: bool = (Sess = C) in
                                                            (
                                                                {1834}if v_2005 then
                                                                (
                                                                    {1835}let pkSess_2006: bitstring = pub(skC) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (=GetEndpointResponse,=pkSess_2006,=None,SP_2007: bitstring,UP_2008: bitstring));
                                                                    {1838}new Nc_2009: bitstring;
                                                                    {1839}let gNc_2010: bitstring = exp(g,Nc_2009) in
                                                                    {1840}let m1_2011: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2010) in
                                                                    {1841}event beginCli(Cli,Sess,gNc_2010);
                                                                    {1842}out(c, (pkCli_1652,m1_2011));
                                                                    {1843}in(c, em2_2012: bitstring);
                                                                    {1844}let m2_2013: bitstring = em2_2012 in
                                                                    {1845}let (=OpenSecureChannelResponse,=Cli,PartS_2014: bitstring,ST_2015: bitstring,TTL_2016: bitstring) = m2_2013 in
                                                                    {1846}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1847}event endCli(Sess,Cli,PartS_2014)
                                                                )
                                                                else
                                                                    {1848}let pkSess_2017: bitstring = pub(sk(Sess)) in
                                                                    {1849}out(c, GetEndpointRequest);
                                                                    {1850}in(c, (=GetEndpointResponse,=pkSess_2017,=None,SP_2018: bitstring,UP_2019: bitstring));
                                                                    {1851}new Nc_2020: bitstring;
                                                                    {1852}let gNc_2021: bitstring = exp(g,Nc_2020) in
                                                                    {1853}let m1_2022: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2021) in
                                                                    {1854}event beginCli(Cli,Sess,gNc_2021);
                                                                    {1855}out(c, (pkCli_1652,m1_2022));
                                                                    {1856}in(c, em2_2023: bitstring);
                                                                    {1857}let m2_2024: bitstring = em2_2023 in
                                                                    {1858}let (=OpenSecureChannelResponse,=Cli,PartS_2025: bitstring,ST_2026: bitstring,TTL_2027: bitstring) = m2_2024 in
                                                                    {1859}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {1860}event endCli(Sess,Cli,PartS_2025)
                                                            )
                                                            else
                                                                {1861}let pkSess_2028: bitstring = fail-any in
                                                                {1862}out(c, GetEndpointRequest);
                                                                {1863}in(c, (=GetEndpointResponse,=pkSess_2028,=None,SP_2029: bitstring,UP_2030: bitstring));
                                                                {1864}new Nc_2031: bitstring;
                                                                {1865}let gNc_2032: bitstring = exp(g,Nc_2031) in
                                                                {1866}let m1_2033: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2032) in
                                                                {1867}event beginCli(Cli,Sess,gNc_2032);
                                                                {1868}out(c, (pkCli_1652,m1_2033));
                                                                {1869}in(c, em2_2034: bitstring);
                                                                {1870}let m2_2035: bitstring = em2_2034 in
                                                                {1871}let (=OpenSecureChannelResponse,=Cli,PartS_2036: bitstring,ST_2037: bitstring,TTL_2038: bitstring) = m2_2035 in
                                                                {1872}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {1873}event endCli(Sess,Cli,PartS_2036)
                                                    )
                                                    else
                                                        {1874}let pkSess_2039: bitstring = fail-any in
                                                        {1875}out(c, GetEndpointRequest);
                                                        {1876}in(c, (=GetEndpointResponse,=pkSess_2039,=None,SP_2040: bitstring,UP_2041: bitstring));
                                                        {1877}new Nc_2042: bitstring;
                                                        {1878}let gNc_2043: bitstring = exp(g,Nc_2042) in
                                                        {1879}let m1_2044: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2043) in
                                                        {1880}event beginCli(Cli,Sess,gNc_2043);
                                                        {1881}out(c, (pkCli_1652,m1_2044));
                                                        {1882}in(c, em2_2045: bitstring);
                                                        {1883}let m2_2046: bitstring = em2_2045 in
                                                        {1884}let (=OpenSecureChannelResponse,=Cli,PartS_2047: bitstring,ST_2048: bitstring,TTL_2049: bitstring) = m2_2046 in
                                                        {1885}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1886}event endCli(Sess,Cli,PartS_2047)
                                            )
                                            else
                                                {1887}let pkSess_2050: bitstring = fail-any in
                                                {1888}out(c, GetEndpointRequest);
                                                {1889}in(c, (=GetEndpointResponse,=pkSess_2050,=None,SP_2051: bitstring,UP_2052: bitstring));
                                                {1890}new Nc_2053: bitstring;
                                                {1891}let gNc_2054: bitstring = exp(g,Nc_2053) in
                                                {1892}let m1_2055: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2054) in
                                                {1893}event beginCli(Cli,Sess,gNc_2054);
                                                {1894}out(c, (pkCli_1652,m1_2055));
                                                {1895}in(c, em2_2056: bitstring);
                                                {1896}let m2_2057: bitstring = em2_2056 in
                                                {1897}let (=OpenSecureChannelResponse,=Cli,PartS_2058: bitstring,ST_2059: bitstring,TTL_2060: bitstring) = m2_2057 in
                                                {1898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1899}event endCli(Sess,Cli,PartS_2058)
                                )
                                else
                                    {1900}let pkDisco_2061: bitstring = fail-any in
                                    {1901}let v_2062: bool = (Sess = A) in
                                    (
                                        {1902}if v_2062 then
                                        (
                                            {1903}let pkSess_2063: bitstring = pub(skA) in
                                            {1904}out(c, GetEndpointRequest);
                                            {1905}in(c, (=GetEndpointResponse,=pkSess_2063,=None,SP_2064: bitstring,UP_2065: bitstring));
                                            {1906}new Nc_2066: bitstring;
                                            {1907}let gNc_2067: bitstring = exp(g,Nc_2066) in
                                            {1908}let m1_2068: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2067) in
                                            {1909}event beginCli(Cli,Sess,gNc_2067);
                                            {1910}out(c, (pkCli_1652,m1_2068));
                                            {1911}in(c, em2_2069: bitstring);
                                            {1912}let m2_2070: bitstring = em2_2069 in
                                            {1913}let (=OpenSecureChannelResponse,=Cli,PartS_2071: bitstring,ST_2072: bitstring,TTL_2073: bitstring) = m2_2070 in
                                            {1914}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {1915}event endCli(Sess,Cli,PartS_2071)
                                        )
                                        else
                                            {1916}let v_2074: bool = (Sess = B) in
                                            (
                                                {1917}if v_2074 then
                                                (
                                                    {1918}let pkSess_2075: bitstring = pub(skB) in
                                                    {1919}out(c, GetEndpointRequest);
                                                    {1920}in(c, (=GetEndpointResponse,=pkSess_2075,=None,SP_2076: bitstring,UP_2077: bitstring));
                                                    {1921}new Nc_2078: bitstring;
                                                    {1922}let gNc_2079: bitstring = exp(g,Nc_2078) in
                                                    {1923}let m1_2080: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2079) in
                                                    {1924}event beginCli(Cli,Sess,gNc_2079);
                                                    {1925}out(c, (pkCli_1652,m1_2080));
                                                    {1926}in(c, em2_2081: bitstring);
                                                    {1927}let m2_2082: bitstring = em2_2081 in
                                                    {1928}let (=OpenSecureChannelResponse,=Cli,PartS_2083: bitstring,ST_2084: bitstring,TTL_2085: bitstring) = m2_2082 in
                                                    {1929}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {1930}event endCli(Sess,Cli,PartS_2083)
                                                )
                                                else
                                                    {1931}let v_2086: bool = (Sess = C) in
                                                    (
                                                        {1932}if v_2086 then
                                                        (
                                                            {1933}let pkSess_2087: bitstring = pub(skC) in
                                                            {1934}out(c, GetEndpointRequest);
                                                            {1935}in(c, (=GetEndpointResponse,=pkSess_2087,=None,SP_2088: bitstring,UP_2089: bitstring));
                                                            {1936}new Nc_2090: bitstring;
                                                            {1937}let gNc_2091: bitstring = exp(g,Nc_2090) in
                                                            {1938}let m1_2092: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2091) in
                                                            {1939}event beginCli(Cli,Sess,gNc_2091);
                                                            {1940}out(c, (pkCli_1652,m1_2092));
                                                            {1941}in(c, em2_2093: bitstring);
                                                            {1942}let m2_2094: bitstring = em2_2093 in
                                                            {1943}let (=OpenSecureChannelResponse,=Cli,PartS_2095: bitstring,ST_2096: bitstring,TTL_2097: bitstring) = m2_2094 in
                                                            {1944}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1945}event endCli(Sess,Cli,PartS_2095)
                                                        )
                                                        else
                                                            {1946}let pkSess_2098: bitstring = pub(sk(Sess)) in
                                                            {1947}out(c, GetEndpointRequest);
                                                            {1948}in(c, (=GetEndpointResponse,=pkSess_2098,=None,SP_2099: bitstring,UP_2100: bitstring));
                                                            {1949}new Nc_2101: bitstring;
                                                            {1950}let gNc_2102: bitstring = exp(g,Nc_2101) in
                                                            {1951}let m1_2103: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2102) in
                                                            {1952}event beginCli(Cli,Sess,gNc_2102);
                                                            {1953}out(c, (pkCli_1652,m1_2103));
                                                            {1954}in(c, em2_2104: bitstring);
                                                            {1955}let m2_2105: bitstring = em2_2104 in
                                                            {1956}let (=OpenSecureChannelResponse,=Cli,PartS_2106: bitstring,ST_2107: bitstring,TTL_2108: bitstring) = m2_2105 in
                                                            {1957}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {1958}event endCli(Sess,Cli,PartS_2106)
                                                    )
                                                    else
                                                        {1959}let pkSess_2109: bitstring = fail-any in
                                                        {1960}out(c, GetEndpointRequest);
                                                        {1961}in(c, (=GetEndpointResponse,=pkSess_2109,=None,SP_2110: bitstring,UP_2111: bitstring));
                                                        {1962}new Nc_2112: bitstring;
                                                        {1963}let gNc_2113: bitstring = exp(g,Nc_2112) in
                                                        {1964}let m1_2114: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2113) in
                                                        {1965}event beginCli(Cli,Sess,gNc_2113);
                                                        {1966}out(c, (pkCli_1652,m1_2114));
                                                        {1967}in(c, em2_2115: bitstring);
                                                        {1968}let m2_2116: bitstring = em2_2115 in
                                                        {1969}let (=OpenSecureChannelResponse,=Cli,PartS_2117: bitstring,ST_2118: bitstring,TTL_2119: bitstring) = m2_2116 in
                                                        {1970}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {1971}event endCli(Sess,Cli,PartS_2117)
                                            )
                                            else
                                                {1972}let pkSess_2120: bitstring = fail-any in
                                                {1973}out(c, GetEndpointRequest);
                                                {1974}in(c, (=GetEndpointResponse,=pkSess_2120,=None,SP_2121: bitstring,UP_2122: bitstring));
                                                {1975}new Nc_2123: bitstring;
                                                {1976}let gNc_2124: bitstring = exp(g,Nc_2123) in
                                                {1977}let m1_2125: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2124) in
                                                {1978}event beginCli(Cli,Sess,gNc_2124);
                                                {1979}out(c, (pkCli_1652,m1_2125));
                                                {1980}in(c, em2_2126: bitstring);
                                                {1981}let m2_2127: bitstring = em2_2126 in
                                                {1982}let (=OpenSecureChannelResponse,=Cli,PartS_2128: bitstring,ST_2129: bitstring,TTL_2130: bitstring) = m2_2127 in
                                                {1983}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {1984}event endCli(Sess,Cli,PartS_2128)
                                    )
                                    else
                                        {1985}let pkSess_2131: bitstring = fail-any in
                                        {1986}out(c, GetEndpointRequest);
                                        {1987}in(c, (=GetEndpointResponse,=pkSess_2131,=None,SP_2132: bitstring,UP_2133: bitstring));
                                        {1988}new Nc_2134: bitstring;
                                        {1989}let gNc_2135: bitstring = exp(g,Nc_2134) in
                                        {1990}let m1_2136: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2135) in
                                        {1991}event beginCli(Cli,Sess,gNc_2135);
                                        {1992}out(c, (pkCli_1652,m1_2136));
                                        {1993}in(c, em2_2137: bitstring);
                                        {1994}let m2_2138: bitstring = em2_2137 in
                                        {1995}let (=OpenSecureChannelResponse,=Cli,PartS_2139: bitstring,ST_2140: bitstring,TTL_2141: bitstring) = m2_2138 in
                                        {1996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {1997}event endCli(Sess,Cli,PartS_2139)
                        )
                        else
                            {1998}let pkDisco_2142: bitstring = fail-any in
                            {1999}let v_2143: bool = (Sess = A) in
                            (
                                {2000}if v_2143 then
                                (
                                    {2001}let pkSess_2144: bitstring = pub(skA) in
                                    {2002}out(c, GetEndpointRequest);
                                    {2003}in(c, (=GetEndpointResponse,=pkSess_2144,=None,SP_2145: bitstring,UP_2146: bitstring));
                                    {2004}new Nc_2147: bitstring;
                                    {2005}let gNc_2148: bitstring = exp(g,Nc_2147) in
                                    {2006}let m1_2149: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2148) in
                                    {2007}event beginCli(Cli,Sess,gNc_2148);
                                    {2008}out(c, (pkCli_1652,m1_2149));
                                    {2009}in(c, em2_2150: bitstring);
                                    {2010}let m2_2151: bitstring = em2_2150 in
                                    {2011}let (=OpenSecureChannelResponse,=Cli,PartS_2152: bitstring,ST_2153: bitstring,TTL_2154: bitstring) = m2_2151 in
                                    {2012}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2013}event endCli(Sess,Cli,PartS_2152)
                                )
                                else
                                    {2014}let v_2155: bool = (Sess = B) in
                                    (
                                        {2015}if v_2155 then
                                        (
                                            {2016}let pkSess_2156: bitstring = pub(skB) in
                                            {2017}out(c, GetEndpointRequest);
                                            {2018}in(c, (=GetEndpointResponse,=pkSess_2156,=None,SP_2157: bitstring,UP_2158: bitstring));
                                            {2019}new Nc_2159: bitstring;
                                            {2020}let gNc_2160: bitstring = exp(g,Nc_2159) in
                                            {2021}let m1_2161: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2160) in
                                            {2022}event beginCli(Cli,Sess,gNc_2160);
                                            {2023}out(c, (pkCli_1652,m1_2161));
                                            {2024}in(c, em2_2162: bitstring);
                                            {2025}let m2_2163: bitstring = em2_2162 in
                                            {2026}let (=OpenSecureChannelResponse,=Cli,PartS_2164: bitstring,ST_2165: bitstring,TTL_2166: bitstring) = m2_2163 in
                                            {2027}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2028}event endCli(Sess,Cli,PartS_2164)
                                        )
                                        else
                                            {2029}let v_2167: bool = (Sess = C) in
                                            (
                                                {2030}if v_2167 then
                                                (
                                                    {2031}let pkSess_2168: bitstring = pub(skC) in
                                                    {2032}out(c, GetEndpointRequest);
                                                    {2033}in(c, (=GetEndpointResponse,=pkSess_2168,=None,SP_2169: bitstring,UP_2170: bitstring));
                                                    {2034}new Nc_2171: bitstring;
                                                    {2035}let gNc_2172: bitstring = exp(g,Nc_2171) in
                                                    {2036}let m1_2173: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2172) in
                                                    {2037}event beginCli(Cli,Sess,gNc_2172);
                                                    {2038}out(c, (pkCli_1652,m1_2173));
                                                    {2039}in(c, em2_2174: bitstring);
                                                    {2040}let m2_2175: bitstring = em2_2174 in
                                                    {2041}let (=OpenSecureChannelResponse,=Cli,PartS_2176: bitstring,ST_2177: bitstring,TTL_2178: bitstring) = m2_2175 in
                                                    {2042}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2043}event endCli(Sess,Cli,PartS_2176)
                                                )
                                                else
                                                    {2044}let pkSess_2179: bitstring = pub(sk(Sess)) in
                                                    {2045}out(c, GetEndpointRequest);
                                                    {2046}in(c, (=GetEndpointResponse,=pkSess_2179,=None,SP_2180: bitstring,UP_2181: bitstring));
                                                    {2047}new Nc_2182: bitstring;
                                                    {2048}let gNc_2183: bitstring = exp(g,Nc_2182) in
                                                    {2049}let m1_2184: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2183) in
                                                    {2050}event beginCli(Cli,Sess,gNc_2183);
                                                    {2051}out(c, (pkCli_1652,m1_2184));
                                                    {2052}in(c, em2_2185: bitstring);
                                                    {2053}let m2_2186: bitstring = em2_2185 in
                                                    {2054}let (=OpenSecureChannelResponse,=Cli,PartS_2187: bitstring,ST_2188: bitstring,TTL_2189: bitstring) = m2_2186 in
                                                    {2055}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2056}event endCli(Sess,Cli,PartS_2187)
                                            )
                                            else
                                                {2057}let pkSess_2190: bitstring = fail-any in
                                                {2058}out(c, GetEndpointRequest);
                                                {2059}in(c, (=GetEndpointResponse,=pkSess_2190,=None,SP_2191: bitstring,UP_2192: bitstring));
                                                {2060}new Nc_2193: bitstring;
                                                {2061}let gNc_2194: bitstring = exp(g,Nc_2193) in
                                                {2062}let m1_2195: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2194) in
                                                {2063}event beginCli(Cli,Sess,gNc_2194);
                                                {2064}out(c, (pkCli_1652,m1_2195));
                                                {2065}in(c, em2_2196: bitstring);
                                                {2066}let m2_2197: bitstring = em2_2196 in
                                                {2067}let (=OpenSecureChannelResponse,=Cli,PartS_2198: bitstring,ST_2199: bitstring,TTL_2200: bitstring) = m2_2197 in
                                                {2068}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2069}event endCli(Sess,Cli,PartS_2198)
                                    )
                                    else
                                        {2070}let pkSess_2201: bitstring = fail-any in
                                        {2071}out(c, GetEndpointRequest);
                                        {2072}in(c, (=GetEndpointResponse,=pkSess_2201,=None,SP_2202: bitstring,UP_2203: bitstring));
                                        {2073}new Nc_2204: bitstring;
                                        {2074}let gNc_2205: bitstring = exp(g,Nc_2204) in
                                        {2075}let m1_2206: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2205) in
                                        {2076}event beginCli(Cli,Sess,gNc_2205);
                                        {2077}out(c, (pkCli_1652,m1_2206));
                                        {2078}in(c, em2_2207: bitstring);
                                        {2079}let m2_2208: bitstring = em2_2207 in
                                        {2080}let (=OpenSecureChannelResponse,=Cli,PartS_2209: bitstring,ST_2210: bitstring,TTL_2211: bitstring) = m2_2208 in
                                        {2081}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2082}event endCli(Sess,Cli,PartS_2209)
                            )
                            else
                                {2083}let pkSess_2212: bitstring = fail-any in
                                {2084}out(c, GetEndpointRequest);
                                {2085}in(c, (=GetEndpointResponse,=pkSess_2212,=None,SP_2213: bitstring,UP_2214: bitstring));
                                {2086}new Nc_2215: bitstring;
                                {2087}let gNc_2216: bitstring = exp(g,Nc_2215) in
                                {2088}let m1_2217: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1652,gNc_2216) in
                                {2089}event beginCli(Cli,Sess,gNc_2216);
                                {2090}out(c, (pkCli_1652,m1_2217));
                                {2091}in(c, em2_2218: bitstring);
                                {2092}let m2_2219: bitstring = em2_2218 in
                                {2093}let (=OpenSecureChannelResponse,=Cli,PartS_2220: bitstring,ST_2221: bitstring,TTL_2222: bitstring) = m2_2219 in
                                {2094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2095}event endCli(Sess,Cli,PartS_2220)
                    )
                    else
                        {2096}let skCli_2223: bitstring = fail-any in
                        {2097}let pkCli_2224: bitstring = pub(skCli_2223) in
                        {2098}let v_2225: bool = (Disco = A) in
                        (
                            {2099}if v_2225 then
                            (
                                {2100}let pkDisco_2226: bitstring = pub(skA) in
                                {2101}let v_2227: bool = (Sess = A) in
                                (
                                    {2102}if v_2227 then
                                    (
                                        {2103}let pkSess_2228: bitstring = pub(skA) in
                                        {2104}out(c, GetEndpointRequest);
                                        {2105}in(c, (=GetEndpointResponse,=pkSess_2228,=None,SP_2229: bitstring,UP_2230: bitstring));
                                        {2106}new Nc_2231: bitstring;
                                        {2107}let gNc_2232: bitstring = exp(g,Nc_2231) in
                                        {2108}let m1_2233: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2232) in
                                        {2109}event beginCli(Cli,Sess,gNc_2232);
                                        {2110}out(c, (pkCli_2224,m1_2233));
                                        {2111}in(c, em2_2234: bitstring);
                                        {2112}let m2_2235: bitstring = em2_2234 in
                                        {2113}let (=OpenSecureChannelResponse,=Cli,PartS_2236: bitstring,ST_2237: bitstring,TTL_2238: bitstring) = m2_2235 in
                                        {2114}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2115}event endCli(Sess,Cli,PartS_2236)
                                    )
                                    else
                                        {2116}let v_2239: bool = (Sess = B) in
                                        (
                                            {2117}if v_2239 then
                                            (
                                                {2118}let pkSess_2240: bitstring = pub(skB) in
                                                {2119}out(c, GetEndpointRequest);
                                                {2120}in(c, (=GetEndpointResponse,=pkSess_2240,=None,SP_2241: bitstring,UP_2242: bitstring));
                                                {2121}new Nc_2243: bitstring;
                                                {2122}let gNc_2244: bitstring = exp(g,Nc_2243) in
                                                {2123}let m1_2245: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2244) in
                                                {2124}event beginCli(Cli,Sess,gNc_2244);
                                                {2125}out(c, (pkCli_2224,m1_2245));
                                                {2126}in(c, em2_2246: bitstring);
                                                {2127}let m2_2247: bitstring = em2_2246 in
                                                {2128}let (=OpenSecureChannelResponse,=Cli,PartS_2248: bitstring,ST_2249: bitstring,TTL_2250: bitstring) = m2_2247 in
                                                {2129}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2130}event endCli(Sess,Cli,PartS_2248)
                                            )
                                            else
                                                {2131}let v_2251: bool = (Sess = C) in
                                                (
                                                    {2132}if v_2251 then
                                                    (
                                                        {2133}let pkSess_2252: bitstring = pub(skC) in
                                                        {2134}out(c, GetEndpointRequest);
                                                        {2135}in(c, (=GetEndpointResponse,=pkSess_2252,=None,SP_2253: bitstring,UP_2254: bitstring));
                                                        {2136}new Nc_2255: bitstring;
                                                        {2137}let gNc_2256: bitstring = exp(g,Nc_2255) in
                                                        {2138}let m1_2257: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2256) in
                                                        {2139}event beginCli(Cli,Sess,gNc_2256);
                                                        {2140}out(c, (pkCli_2224,m1_2257));
                                                        {2141}in(c, em2_2258: bitstring);
                                                        {2142}let m2_2259: bitstring = em2_2258 in
                                                        {2143}let (=OpenSecureChannelResponse,=Cli,PartS_2260: bitstring,ST_2261: bitstring,TTL_2262: bitstring) = m2_2259 in
                                                        {2144}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2145}event endCli(Sess,Cli,PartS_2260)
                                                    )
                                                    else
                                                        {2146}let pkSess_2263: bitstring = pub(sk(Sess)) in
                                                        {2147}out(c, GetEndpointRequest);
                                                        {2148}in(c, (=GetEndpointResponse,=pkSess_2263,=None,SP_2264: bitstring,UP_2265: bitstring));
                                                        {2149}new Nc_2266: bitstring;
                                                        {2150}let gNc_2267: bitstring = exp(g,Nc_2266) in
                                                        {2151}let m1_2268: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2267) in
                                                        {2152}event beginCli(Cli,Sess,gNc_2267);
                                                        {2153}out(c, (pkCli_2224,m1_2268));
                                                        {2154}in(c, em2_2269: bitstring);
                                                        {2155}let m2_2270: bitstring = em2_2269 in
                                                        {2156}let (=OpenSecureChannelResponse,=Cli,PartS_2271: bitstring,ST_2272: bitstring,TTL_2273: bitstring) = m2_2270 in
                                                        {2157}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2158}event endCli(Sess,Cli,PartS_2271)
                                                )
                                                else
                                                    {2159}let pkSess_2274: bitstring = fail-any in
                                                    {2160}out(c, GetEndpointRequest);
                                                    {2161}in(c, (=GetEndpointResponse,=pkSess_2274,=None,SP_2275: bitstring,UP_2276: bitstring));
                                                    {2162}new Nc_2277: bitstring;
                                                    {2163}let gNc_2278: bitstring = exp(g,Nc_2277) in
                                                    {2164}let m1_2279: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2278) in
                                                    {2165}event beginCli(Cli,Sess,gNc_2278);
                                                    {2166}out(c, (pkCli_2224,m1_2279));
                                                    {2167}in(c, em2_2280: bitstring);
                                                    {2168}let m2_2281: bitstring = em2_2280 in
                                                    {2169}let (=OpenSecureChannelResponse,=Cli,PartS_2282: bitstring,ST_2283: bitstring,TTL_2284: bitstring) = m2_2281 in
                                                    {2170}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2171}event endCli(Sess,Cli,PartS_2282)
                                        )
                                        else
                                            {2172}let pkSess_2285: bitstring = fail-any in
                                            {2173}out(c, GetEndpointRequest);
                                            {2174}in(c, (=GetEndpointResponse,=pkSess_2285,=None,SP_2286: bitstring,UP_2287: bitstring));
                                            {2175}new Nc_2288: bitstring;
                                            {2176}let gNc_2289: bitstring = exp(g,Nc_2288) in
                                            {2177}let m1_2290: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2289) in
                                            {2178}event beginCli(Cli,Sess,gNc_2289);
                                            {2179}out(c, (pkCli_2224,m1_2290));
                                            {2180}in(c, em2_2291: bitstring);
                                            {2181}let m2_2292: bitstring = em2_2291 in
                                            {2182}let (=OpenSecureChannelResponse,=Cli,PartS_2293: bitstring,ST_2294: bitstring,TTL_2295: bitstring) = m2_2292 in
                                            {2183}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2184}event endCli(Sess,Cli,PartS_2293)
                                )
                                else
                                    {2185}let pkSess_2296: bitstring = fail-any in
                                    {2186}out(c, GetEndpointRequest);
                                    {2187}in(c, (=GetEndpointResponse,=pkSess_2296,=None,SP_2297: bitstring,UP_2298: bitstring));
                                    {2188}new Nc_2299: bitstring;
                                    {2189}let gNc_2300: bitstring = exp(g,Nc_2299) in
                                    {2190}let m1_2301: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2300) in
                                    {2191}event beginCli(Cli,Sess,gNc_2300);
                                    {2192}out(c, (pkCli_2224,m1_2301));
                                    {2193}in(c, em2_2302: bitstring);
                                    {2194}let m2_2303: bitstring = em2_2302 in
                                    {2195}let (=OpenSecureChannelResponse,=Cli,PartS_2304: bitstring,ST_2305: bitstring,TTL_2306: bitstring) = m2_2303 in
                                    {2196}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2197}event endCli(Sess,Cli,PartS_2304)
                            )
                            else
                                {2198}let v_2307: bool = (Disco = B) in
                                (
                                    {2199}if v_2307 then
                                    (
                                        {2200}let pkDisco_2308: bitstring = pub(skB) in
                                        {2201}let v_2309: bool = (Sess = A) in
                                        (
                                            {2202}if v_2309 then
                                            (
                                                {2203}let pkSess_2310: bitstring = pub(skA) in
                                                {2204}out(c, GetEndpointRequest);
                                                {2205}in(c, (=GetEndpointResponse,=pkSess_2310,=None,SP_2311: bitstring,UP_2312: bitstring));
                                                {2206}new Nc_2313: bitstring;
                                                {2207}let gNc_2314: bitstring = exp(g,Nc_2313) in
                                                {2208}let m1_2315: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2314) in
                                                {2209}event beginCli(Cli,Sess,gNc_2314);
                                                {2210}out(c, (pkCli_2224,m1_2315));
                                                {2211}in(c, em2_2316: bitstring);
                                                {2212}let m2_2317: bitstring = em2_2316 in
                                                {2213}let (=OpenSecureChannelResponse,=Cli,PartS_2318: bitstring,ST_2319: bitstring,TTL_2320: bitstring) = m2_2317 in
                                                {2214}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2215}event endCli(Sess,Cli,PartS_2318)
                                            )
                                            else
                                                {2216}let v_2321: bool = (Sess = B) in
                                                (
                                                    {2217}if v_2321 then
                                                    (
                                                        {2218}let pkSess_2322: bitstring = pub(skB) in
                                                        {2219}out(c, GetEndpointRequest);
                                                        {2220}in(c, (=GetEndpointResponse,=pkSess_2322,=None,SP_2323: bitstring,UP_2324: bitstring));
                                                        {2221}new Nc_2325: bitstring;
                                                        {2222}let gNc_2326: bitstring = exp(g,Nc_2325) in
                                                        {2223}let m1_2327: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2326) in
                                                        {2224}event beginCli(Cli,Sess,gNc_2326);
                                                        {2225}out(c, (pkCli_2224,m1_2327));
                                                        {2226}in(c, em2_2328: bitstring);
                                                        {2227}let m2_2329: bitstring = em2_2328 in
                                                        {2228}let (=OpenSecureChannelResponse,=Cli,PartS_2330: bitstring,ST_2331: bitstring,TTL_2332: bitstring) = m2_2329 in
                                                        {2229}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2230}event endCli(Sess,Cli,PartS_2330)
                                                    )
                                                    else
                                                        {2231}let v_2333: bool = (Sess = C) in
                                                        (
                                                            {2232}if v_2333 then
                                                            (
                                                                {2233}let pkSess_2334: bitstring = pub(skC) in
                                                                {2234}out(c, GetEndpointRequest);
                                                                {2235}in(c, (=GetEndpointResponse,=pkSess_2334,=None,SP_2335: bitstring,UP_2336: bitstring));
                                                                {2236}new Nc_2337: bitstring;
                                                                {2237}let gNc_2338: bitstring = exp(g,Nc_2337) in
                                                                {2238}let m1_2339: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2338) in
                                                                {2239}event beginCli(Cli,Sess,gNc_2338);
                                                                {2240}out(c, (pkCli_2224,m1_2339));
                                                                {2241}in(c, em2_2340: bitstring);
                                                                {2242}let m2_2341: bitstring = em2_2340 in
                                                                {2243}let (=OpenSecureChannelResponse,=Cli,PartS_2342: bitstring,ST_2343: bitstring,TTL_2344: bitstring) = m2_2341 in
                                                                {2244}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2245}event endCli(Sess,Cli,PartS_2342)
                                                            )
                                                            else
                                                                {2246}let pkSess_2345: bitstring = pub(sk(Sess)) in
                                                                {2247}out(c, GetEndpointRequest);
                                                                {2248}in(c, (=GetEndpointResponse,=pkSess_2345,=None,SP_2346: bitstring,UP_2347: bitstring));
                                                                {2249}new Nc_2348: bitstring;
                                                                {2250}let gNc_2349: bitstring = exp(g,Nc_2348) in
                                                                {2251}let m1_2350: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2349) in
                                                                {2252}event beginCli(Cli,Sess,gNc_2349);
                                                                {2253}out(c, (pkCli_2224,m1_2350));
                                                                {2254}in(c, em2_2351: bitstring);
                                                                {2255}let m2_2352: bitstring = em2_2351 in
                                                                {2256}let (=OpenSecureChannelResponse,=Cli,PartS_2353: bitstring,ST_2354: bitstring,TTL_2355: bitstring) = m2_2352 in
                                                                {2257}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2258}event endCli(Sess,Cli,PartS_2353)
                                                        )
                                                        else
                                                            {2259}let pkSess_2356: bitstring = fail-any in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2356,=None,SP_2357: bitstring,UP_2358: bitstring));
                                                            {2262}new Nc_2359: bitstring;
                                                            {2263}let gNc_2360: bitstring = exp(g,Nc_2359) in
                                                            {2264}let m1_2361: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2360) in
                                                            {2265}event beginCli(Cli,Sess,gNc_2360);
                                                            {2266}out(c, (pkCli_2224,m1_2361));
                                                            {2267}in(c, em2_2362: bitstring);
                                                            {2268}let m2_2363: bitstring = em2_2362 in
                                                            {2269}let (=OpenSecureChannelResponse,=Cli,PartS_2364: bitstring,ST_2365: bitstring,TTL_2366: bitstring) = m2_2363 in
                                                            {2270}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2271}event endCli(Sess,Cli,PartS_2364)
                                                )
                                                else
                                                    {2272}let pkSess_2367: bitstring = fail-any in
                                                    {2273}out(c, GetEndpointRequest);
                                                    {2274}in(c, (=GetEndpointResponse,=pkSess_2367,=None,SP_2368: bitstring,UP_2369: bitstring));
                                                    {2275}new Nc_2370: bitstring;
                                                    {2276}let gNc_2371: bitstring = exp(g,Nc_2370) in
                                                    {2277}let m1_2372: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2371) in
                                                    {2278}event beginCli(Cli,Sess,gNc_2371);
                                                    {2279}out(c, (pkCli_2224,m1_2372));
                                                    {2280}in(c, em2_2373: bitstring);
                                                    {2281}let m2_2374: bitstring = em2_2373 in
                                                    {2282}let (=OpenSecureChannelResponse,=Cli,PartS_2375: bitstring,ST_2376: bitstring,TTL_2377: bitstring) = m2_2374 in
                                                    {2283}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2284}event endCli(Sess,Cli,PartS_2375)
                                        )
                                        else
                                            {2285}let pkSess_2378: bitstring = fail-any in
                                            {2286}out(c, GetEndpointRequest);
                                            {2287}in(c, (=GetEndpointResponse,=pkSess_2378,=None,SP_2379: bitstring,UP_2380: bitstring));
                                            {2288}new Nc_2381: bitstring;
                                            {2289}let gNc_2382: bitstring = exp(g,Nc_2381) in
                                            {2290}let m1_2383: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2382) in
                                            {2291}event beginCli(Cli,Sess,gNc_2382);
                                            {2292}out(c, (pkCli_2224,m1_2383));
                                            {2293}in(c, em2_2384: bitstring);
                                            {2294}let m2_2385: bitstring = em2_2384 in
                                            {2295}let (=OpenSecureChannelResponse,=Cli,PartS_2386: bitstring,ST_2387: bitstring,TTL_2388: bitstring) = m2_2385 in
                                            {2296}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2297}event endCli(Sess,Cli,PartS_2386)
                                    )
                                    else
                                        {2298}let v_2389: bool = (Disco = C) in
                                        (
                                            {2299}if v_2389 then
                                            (
                                                {2300}let pkDisco_2390: bitstring = pub(skC) in
                                                {2301}let v_2391: bool = (Sess = A) in
                                                (
                                                    {2302}if v_2391 then
                                                    (
                                                        {2303}let pkSess_2392: bitstring = pub(skA) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2392,=None,SP_2393: bitstring,UP_2394: bitstring));
                                                        {2306}new Nc_2395: bitstring;
                                                        {2307}let gNc_2396: bitstring = exp(g,Nc_2395) in
                                                        {2308}let m1_2397: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2396) in
                                                        {2309}event beginCli(Cli,Sess,gNc_2396);
                                                        {2310}out(c, (pkCli_2224,m1_2397));
                                                        {2311}in(c, em2_2398: bitstring);
                                                        {2312}let m2_2399: bitstring = em2_2398 in
                                                        {2313}let (=OpenSecureChannelResponse,=Cli,PartS_2400: bitstring,ST_2401: bitstring,TTL_2402: bitstring) = m2_2399 in
                                                        {2314}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2315}event endCli(Sess,Cli,PartS_2400)
                                                    )
                                                    else
                                                        {2316}let v_2403: bool = (Sess = B) in
                                                        (
                                                            {2317}if v_2403 then
                                                            (
                                                                {2318}let pkSess_2404: bitstring = pub(skB) in
                                                                {2319}out(c, GetEndpointRequest);
                                                                {2320}in(c, (=GetEndpointResponse,=pkSess_2404,=None,SP_2405: bitstring,UP_2406: bitstring));
                                                                {2321}new Nc_2407: bitstring;
                                                                {2322}let gNc_2408: bitstring = exp(g,Nc_2407) in
                                                                {2323}let m1_2409: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2408) in
                                                                {2324}event beginCli(Cli,Sess,gNc_2408);
                                                                {2325}out(c, (pkCli_2224,m1_2409));
                                                                {2326}in(c, em2_2410: bitstring);
                                                                {2327}let m2_2411: bitstring = em2_2410 in
                                                                {2328}let (=OpenSecureChannelResponse,=Cli,PartS_2412: bitstring,ST_2413: bitstring,TTL_2414: bitstring) = m2_2411 in
                                                                {2329}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2330}event endCli(Sess,Cli,PartS_2412)
                                                            )
                                                            else
                                                                {2331}let v_2415: bool = (Sess = C) in
                                                                (
                                                                    {2332}if v_2415 then
                                                                    (
                                                                        {2333}let pkSess_2416: bitstring = pub(skC) in
                                                                        {2334}out(c, GetEndpointRequest);
                                                                        {2335}in(c, (=GetEndpointResponse,=pkSess_2416,=None,SP_2417: bitstring,UP_2418: bitstring));
                                                                        {2336}new Nc_2419: bitstring;
                                                                        {2337}let gNc_2420: bitstring = exp(g,Nc_2419) in
                                                                        {2338}let m1_2421: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2420) in
                                                                        {2339}event beginCli(Cli,Sess,gNc_2420);
                                                                        {2340}out(c, (pkCli_2224,m1_2421));
                                                                        {2341}in(c, em2_2422: bitstring);
                                                                        {2342}let m2_2423: bitstring = em2_2422 in
                                                                        {2343}let (=OpenSecureChannelResponse,=Cli,PartS_2424: bitstring,ST_2425: bitstring,TTL_2426: bitstring) = m2_2423 in
                                                                        {2344}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2345}event endCli(Sess,Cli,PartS_2424)
                                                                    )
                                                                    else
                                                                        {2346}let pkSess_2427: bitstring = pub(sk(Sess)) in
                                                                        {2347}out(c, GetEndpointRequest);
                                                                        {2348}in(c, (=GetEndpointResponse,=pkSess_2427,=None,SP_2428: bitstring,UP_2429: bitstring));
                                                                        {2349}new Nc_2430: bitstring;
                                                                        {2350}let gNc_2431: bitstring = exp(g,Nc_2430) in
                                                                        {2351}let m1_2432: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2431) in
                                                                        {2352}event beginCli(Cli,Sess,gNc_2431);
                                                                        {2353}out(c, (pkCli_2224,m1_2432));
                                                                        {2354}in(c, em2_2433: bitstring);
                                                                        {2355}let m2_2434: bitstring = em2_2433 in
                                                                        {2356}let (=OpenSecureChannelResponse,=Cli,PartS_2435: bitstring,ST_2436: bitstring,TTL_2437: bitstring) = m2_2434 in
                                                                        {2357}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2358}event endCli(Sess,Cli,PartS_2435)
                                                                )
                                                                else
                                                                    {2359}let pkSess_2438: bitstring = fail-any in
                                                                    {2360}out(c, GetEndpointRequest);
                                                                    {2361}in(c, (=GetEndpointResponse,=pkSess_2438,=None,SP_2439: bitstring,UP_2440: bitstring));
                                                                    {2362}new Nc_2441: bitstring;
                                                                    {2363}let gNc_2442: bitstring = exp(g,Nc_2441) in
                                                                    {2364}let m1_2443: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2442) in
                                                                    {2365}event beginCli(Cli,Sess,gNc_2442);
                                                                    {2366}out(c, (pkCli_2224,m1_2443));
                                                                    {2367}in(c, em2_2444: bitstring);
                                                                    {2368}let m2_2445: bitstring = em2_2444 in
                                                                    {2369}let (=OpenSecureChannelResponse,=Cli,PartS_2446: bitstring,ST_2447: bitstring,TTL_2448: bitstring) = m2_2445 in
                                                                    {2370}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2371}event endCli(Sess,Cli,PartS_2446)
                                                        )
                                                        else
                                                            {2372}let pkSess_2449: bitstring = fail-any in
                                                            {2373}out(c, GetEndpointRequest);
                                                            {2374}in(c, (=GetEndpointResponse,=pkSess_2449,=None,SP_2450: bitstring,UP_2451: bitstring));
                                                            {2375}new Nc_2452: bitstring;
                                                            {2376}let gNc_2453: bitstring = exp(g,Nc_2452) in
                                                            {2377}let m1_2454: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2453) in
                                                            {2378}event beginCli(Cli,Sess,gNc_2453);
                                                            {2379}out(c, (pkCli_2224,m1_2454));
                                                            {2380}in(c, em2_2455: bitstring);
                                                            {2381}let m2_2456: bitstring = em2_2455 in
                                                            {2382}let (=OpenSecureChannelResponse,=Cli,PartS_2457: bitstring,ST_2458: bitstring,TTL_2459: bitstring) = m2_2456 in
                                                            {2383}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2384}event endCli(Sess,Cli,PartS_2457)
                                                )
                                                else
                                                    {2385}let pkSess_2460: bitstring = fail-any in
                                                    {2386}out(c, GetEndpointRequest);
                                                    {2387}in(c, (=GetEndpointResponse,=pkSess_2460,=None,SP_2461: bitstring,UP_2462: bitstring));
                                                    {2388}new Nc_2463: bitstring;
                                                    {2389}let gNc_2464: bitstring = exp(g,Nc_2463) in
                                                    {2390}let m1_2465: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2464) in
                                                    {2391}event beginCli(Cli,Sess,gNc_2464);
                                                    {2392}out(c, (pkCli_2224,m1_2465));
                                                    {2393}in(c, em2_2466: bitstring);
                                                    {2394}let m2_2467: bitstring = em2_2466 in
                                                    {2395}let (=OpenSecureChannelResponse,=Cli,PartS_2468: bitstring,ST_2469: bitstring,TTL_2470: bitstring) = m2_2467 in
                                                    {2396}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2397}event endCli(Sess,Cli,PartS_2468)
                                            )
                                            else
                                                {2398}let pkDisco_2471: bitstring = pub(sk(Disco)) in
                                                {2399}let v_2472: bool = (Sess = A) in
                                                (
                                                    {2400}if v_2472 then
                                                    (
                                                        {2401}let pkSess_2473: bitstring = pub(skA) in
                                                        {2402}out(c, GetEndpointRequest);
                                                        {2403}in(c, (=GetEndpointResponse,=pkSess_2473,=None,SP_2474: bitstring,UP_2475: bitstring));
                                                        {2404}new Nc_2476: bitstring;
                                                        {2405}let gNc_2477: bitstring = exp(g,Nc_2476) in
                                                        {2406}let m1_2478: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2477) in
                                                        {2407}event beginCli(Cli,Sess,gNc_2477);
                                                        {2408}out(c, (pkCli_2224,m1_2478));
                                                        {2409}in(c, em2_2479: bitstring);
                                                        {2410}let m2_2480: bitstring = em2_2479 in
                                                        {2411}let (=OpenSecureChannelResponse,=Cli,PartS_2481: bitstring,ST_2482: bitstring,TTL_2483: bitstring) = m2_2480 in
                                                        {2412}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2413}event endCli(Sess,Cli,PartS_2481)
                                                    )
                                                    else
                                                        {2414}let v_2484: bool = (Sess = B) in
                                                        (
                                                            {2415}if v_2484 then
                                                            (
                                                                {2416}let pkSess_2485: bitstring = pub(skB) in
                                                                {2417}out(c, GetEndpointRequest);
                                                                {2418}in(c, (=GetEndpointResponse,=pkSess_2485,=None,SP_2486: bitstring,UP_2487: bitstring));
                                                                {2419}new Nc_2488: bitstring;
                                                                {2420}let gNc_2489: bitstring = exp(g,Nc_2488) in
                                                                {2421}let m1_2490: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2489) in
                                                                {2422}event beginCli(Cli,Sess,gNc_2489);
                                                                {2423}out(c, (pkCli_2224,m1_2490));
                                                                {2424}in(c, em2_2491: bitstring);
                                                                {2425}let m2_2492: bitstring = em2_2491 in
                                                                {2426}let (=OpenSecureChannelResponse,=Cli,PartS_2493: bitstring,ST_2494: bitstring,TTL_2495: bitstring) = m2_2492 in
                                                                {2427}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2428}event endCli(Sess,Cli,PartS_2493)
                                                            )
                                                            else
                                                                {2429}let v_2496: bool = (Sess = C) in
                                                                (
                                                                    {2430}if v_2496 then
                                                                    (
                                                                        {2431}let pkSess_2497: bitstring = pub(skC) in
                                                                        {2432}out(c, GetEndpointRequest);
                                                                        {2433}in(c, (=GetEndpointResponse,=pkSess_2497,=None,SP_2498: bitstring,UP_2499: bitstring));
                                                                        {2434}new Nc_2500: bitstring;
                                                                        {2435}let gNc_2501: bitstring = exp(g,Nc_2500) in
                                                                        {2436}let m1_2502: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2501) in
                                                                        {2437}event beginCli(Cli,Sess,gNc_2501);
                                                                        {2438}out(c, (pkCli_2224,m1_2502));
                                                                        {2439}in(c, em2_2503: bitstring);
                                                                        {2440}let m2_2504: bitstring = em2_2503 in
                                                                        {2441}let (=OpenSecureChannelResponse,=Cli,PartS_2505: bitstring,ST_2506: bitstring,TTL_2507: bitstring) = m2_2504 in
                                                                        {2442}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2443}event endCli(Sess,Cli,PartS_2505)
                                                                    )
                                                                    else
                                                                        {2444}let pkSess_2508: bitstring = pub(sk(Sess)) in
                                                                        {2445}out(c, GetEndpointRequest);
                                                                        {2446}in(c, (=GetEndpointResponse,=pkSess_2508,=None,SP_2509: bitstring,UP_2510: bitstring));
                                                                        {2447}new Nc_2511: bitstring;
                                                                        {2448}let gNc_2512: bitstring = exp(g,Nc_2511) in
                                                                        {2449}let m1_2513: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2512) in
                                                                        {2450}event beginCli(Cli,Sess,gNc_2512);
                                                                        {2451}out(c, (pkCli_2224,m1_2513));
                                                                        {2452}in(c, em2_2514: bitstring);
                                                                        {2453}let m2_2515: bitstring = em2_2514 in
                                                                        {2454}let (=OpenSecureChannelResponse,=Cli,PartS_2516: bitstring,ST_2517: bitstring,TTL_2518: bitstring) = m2_2515 in
                                                                        {2455}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                        {2456}event endCli(Sess,Cli,PartS_2516)
                                                                )
                                                                else
                                                                    {2457}let pkSess_2519: bitstring = fail-any in
                                                                    {2458}out(c, GetEndpointRequest);
                                                                    {2459}in(c, (=GetEndpointResponse,=pkSess_2519,=None,SP_2520: bitstring,UP_2521: bitstring));
                                                                    {2460}new Nc_2522: bitstring;
                                                                    {2461}let gNc_2523: bitstring = exp(g,Nc_2522) in
                                                                    {2462}let m1_2524: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2523) in
                                                                    {2463}event beginCli(Cli,Sess,gNc_2523);
                                                                    {2464}out(c, (pkCli_2224,m1_2524));
                                                                    {2465}in(c, em2_2525: bitstring);
                                                                    {2466}let m2_2526: bitstring = em2_2525 in
                                                                    {2467}let (=OpenSecureChannelResponse,=Cli,PartS_2527: bitstring,ST_2528: bitstring,TTL_2529: bitstring) = m2_2526 in
                                                                    {2468}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2469}event endCli(Sess,Cli,PartS_2527)
                                                        )
                                                        else
                                                            {2470}let pkSess_2530: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (=GetEndpointResponse,=pkSess_2530,=None,SP_2531: bitstring,UP_2532: bitstring));
                                                            {2473}new Nc_2533: bitstring;
                                                            {2474}let gNc_2534: bitstring = exp(g,Nc_2533) in
                                                            {2475}let m1_2535: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2534) in
                                                            {2476}event beginCli(Cli,Sess,gNc_2534);
                                                            {2477}out(c, (pkCli_2224,m1_2535));
                                                            {2478}in(c, em2_2536: bitstring);
                                                            {2479}let m2_2537: bitstring = em2_2536 in
                                                            {2480}let (=OpenSecureChannelResponse,=Cli,PartS_2538: bitstring,ST_2539: bitstring,TTL_2540: bitstring) = m2_2537 in
                                                            {2481}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2482}event endCli(Sess,Cli,PartS_2538)
                                                )
                                                else
                                                    {2483}let pkSess_2541: bitstring = fail-any in
                                                    {2484}out(c, GetEndpointRequest);
                                                    {2485}in(c, (=GetEndpointResponse,=pkSess_2541,=None,SP_2542: bitstring,UP_2543: bitstring));
                                                    {2486}new Nc_2544: bitstring;
                                                    {2487}let gNc_2545: bitstring = exp(g,Nc_2544) in
                                                    {2488}let m1_2546: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2545) in
                                                    {2489}event beginCli(Cli,Sess,gNc_2545);
                                                    {2490}out(c, (pkCli_2224,m1_2546));
                                                    {2491}in(c, em2_2547: bitstring);
                                                    {2492}let m2_2548: bitstring = em2_2547 in
                                                    {2493}let (=OpenSecureChannelResponse,=Cli,PartS_2549: bitstring,ST_2550: bitstring,TTL_2551: bitstring) = m2_2548 in
                                                    {2494}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2495}event endCli(Sess,Cli,PartS_2549)
                                        )
                                        else
                                            {2496}let pkDisco_2552: bitstring = fail-any in
                                            {2497}let v_2553: bool = (Sess = A) in
                                            (
                                                {2498}if v_2553 then
                                                (
                                                    {2499}let pkSess_2554: bitstring = pub(skA) in
                                                    {2500}out(c, GetEndpointRequest);
                                                    {2501}in(c, (=GetEndpointResponse,=pkSess_2554,=None,SP_2555: bitstring,UP_2556: bitstring));
                                                    {2502}new Nc_2557: bitstring;
                                                    {2503}let gNc_2558: bitstring = exp(g,Nc_2557) in
                                                    {2504}let m1_2559: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2558) in
                                                    {2505}event beginCli(Cli,Sess,gNc_2558);
                                                    {2506}out(c, (pkCli_2224,m1_2559));
                                                    {2507}in(c, em2_2560: bitstring);
                                                    {2508}let m2_2561: bitstring = em2_2560 in
                                                    {2509}let (=OpenSecureChannelResponse,=Cli,PartS_2562: bitstring,ST_2563: bitstring,TTL_2564: bitstring) = m2_2561 in
                                                    {2510}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2511}event endCli(Sess,Cli,PartS_2562)
                                                )
                                                else
                                                    {2512}let v_2565: bool = (Sess = B) in
                                                    (
                                                        {2513}if v_2565 then
                                                        (
                                                            {2514}let pkSess_2566: bitstring = pub(skB) in
                                                            {2515}out(c, GetEndpointRequest);
                                                            {2516}in(c, (=GetEndpointResponse,=pkSess_2566,=None,SP_2567: bitstring,UP_2568: bitstring));
                                                            {2517}new Nc_2569: bitstring;
                                                            {2518}let gNc_2570: bitstring = exp(g,Nc_2569) in
                                                            {2519}let m1_2571: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2570) in
                                                            {2520}event beginCli(Cli,Sess,gNc_2570);
                                                            {2521}out(c, (pkCli_2224,m1_2571));
                                                            {2522}in(c, em2_2572: bitstring);
                                                            {2523}let m2_2573: bitstring = em2_2572 in
                                                            {2524}let (=OpenSecureChannelResponse,=Cli,PartS_2574: bitstring,ST_2575: bitstring,TTL_2576: bitstring) = m2_2573 in
                                                            {2525}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2526}event endCli(Sess,Cli,PartS_2574)
                                                        )
                                                        else
                                                            {2527}let v_2577: bool = (Sess = C) in
                                                            (
                                                                {2528}if v_2577 then
                                                                (
                                                                    {2529}let pkSess_2578: bitstring = pub(skC) in
                                                                    {2530}out(c, GetEndpointRequest);
                                                                    {2531}in(c, (=GetEndpointResponse,=pkSess_2578,=None,SP_2579: bitstring,UP_2580: bitstring));
                                                                    {2532}new Nc_2581: bitstring;
                                                                    {2533}let gNc_2582: bitstring = exp(g,Nc_2581) in
                                                                    {2534}let m1_2583: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2582) in
                                                                    {2535}event beginCli(Cli,Sess,gNc_2582);
                                                                    {2536}out(c, (pkCli_2224,m1_2583));
                                                                    {2537}in(c, em2_2584: bitstring);
                                                                    {2538}let m2_2585: bitstring = em2_2584 in
                                                                    {2539}let (=OpenSecureChannelResponse,=Cli,PartS_2586: bitstring,ST_2587: bitstring,TTL_2588: bitstring) = m2_2585 in
                                                                    {2540}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2541}event endCli(Sess,Cli,PartS_2586)
                                                                )
                                                                else
                                                                    {2542}let pkSess_2589: bitstring = pub(sk(Sess)) in
                                                                    {2543}out(c, GetEndpointRequest);
                                                                    {2544}in(c, (=GetEndpointResponse,=pkSess_2589,=None,SP_2590: bitstring,UP_2591: bitstring));
                                                                    {2545}new Nc_2592: bitstring;
                                                                    {2546}let gNc_2593: bitstring = exp(g,Nc_2592) in
                                                                    {2547}let m1_2594: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2593) in
                                                                    {2548}event beginCli(Cli,Sess,gNc_2593);
                                                                    {2549}out(c, (pkCli_2224,m1_2594));
                                                                    {2550}in(c, em2_2595: bitstring);
                                                                    {2551}let m2_2596: bitstring = em2_2595 in
                                                                    {2552}let (=OpenSecureChannelResponse,=Cli,PartS_2597: bitstring,ST_2598: bitstring,TTL_2599: bitstring) = m2_2596 in
                                                                    {2553}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                    {2554}event endCli(Sess,Cli,PartS_2597)
                                                            )
                                                            else
                                                                {2555}let pkSess_2600: bitstring = fail-any in
                                                                {2556}out(c, GetEndpointRequest);
                                                                {2557}in(c, (=GetEndpointResponse,=pkSess_2600,=None,SP_2601: bitstring,UP_2602: bitstring));
                                                                {2558}new Nc_2603: bitstring;
                                                                {2559}let gNc_2604: bitstring = exp(g,Nc_2603) in
                                                                {2560}let m1_2605: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2604) in
                                                                {2561}event beginCli(Cli,Sess,gNc_2604);
                                                                {2562}out(c, (pkCli_2224,m1_2605));
                                                                {2563}in(c, em2_2606: bitstring);
                                                                {2564}let m2_2607: bitstring = em2_2606 in
                                                                {2565}let (=OpenSecureChannelResponse,=Cli,PartS_2608: bitstring,ST_2609: bitstring,TTL_2610: bitstring) = m2_2607 in
                                                                {2566}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {2567}event endCli(Sess,Cli,PartS_2608)
                                                    )
                                                    else
                                                        {2568}let pkSess_2611: bitstring = fail-any in
                                                        {2569}out(c, GetEndpointRequest);
                                                        {2570}in(c, (=GetEndpointResponse,=pkSess_2611,=None,SP_2612: bitstring,UP_2613: bitstring));
                                                        {2571}new Nc_2614: bitstring;
                                                        {2572}let gNc_2615: bitstring = exp(g,Nc_2614) in
                                                        {2573}let m1_2616: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2615) in
                                                        {2574}event beginCli(Cli,Sess,gNc_2615);
                                                        {2575}out(c, (pkCli_2224,m1_2616));
                                                        {2576}in(c, em2_2617: bitstring);
                                                        {2577}let m2_2618: bitstring = em2_2617 in
                                                        {2578}let (=OpenSecureChannelResponse,=Cli,PartS_2619: bitstring,ST_2620: bitstring,TTL_2621: bitstring) = m2_2618 in
                                                        {2579}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2580}event endCli(Sess,Cli,PartS_2619)
                                            )
                                            else
                                                {2581}let pkSess_2622: bitstring = fail-any in
                                                {2582}out(c, GetEndpointRequest);
                                                {2583}in(c, (=GetEndpointResponse,=pkSess_2622,=None,SP_2623: bitstring,UP_2624: bitstring));
                                                {2584}new Nc_2625: bitstring;
                                                {2585}let gNc_2626: bitstring = exp(g,Nc_2625) in
                                                {2586}let m1_2627: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2626) in
                                                {2587}event beginCli(Cli,Sess,gNc_2626);
                                                {2588}out(c, (pkCli_2224,m1_2627));
                                                {2589}in(c, em2_2628: bitstring);
                                                {2590}let m2_2629: bitstring = em2_2628 in
                                                {2591}let (=OpenSecureChannelResponse,=Cli,PartS_2630: bitstring,ST_2631: bitstring,TTL_2632: bitstring) = m2_2629 in
                                                {2592}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2593}event endCli(Sess,Cli,PartS_2630)
                                )
                                else
                                    {2594}let pkDisco_2633: bitstring = fail-any in
                                    {2595}let v_2634: bool = (Sess = A) in
                                    (
                                        {2596}if v_2634 then
                                        (
                                            {2597}let pkSess_2635: bitstring = pub(skA) in
                                            {2598}out(c, GetEndpointRequest);
                                            {2599}in(c, (=GetEndpointResponse,=pkSess_2635,=None,SP_2636: bitstring,UP_2637: bitstring));
                                            {2600}new Nc_2638: bitstring;
                                            {2601}let gNc_2639: bitstring = exp(g,Nc_2638) in
                                            {2602}let m1_2640: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2639) in
                                            {2603}event beginCli(Cli,Sess,gNc_2639);
                                            {2604}out(c, (pkCli_2224,m1_2640));
                                            {2605}in(c, em2_2641: bitstring);
                                            {2606}let m2_2642: bitstring = em2_2641 in
                                            {2607}let (=OpenSecureChannelResponse,=Cli,PartS_2643: bitstring,ST_2644: bitstring,TTL_2645: bitstring) = m2_2642 in
                                            {2608}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2609}event endCli(Sess,Cli,PartS_2643)
                                        )
                                        else
                                            {2610}let v_2646: bool = (Sess = B) in
                                            (
                                                {2611}if v_2646 then
                                                (
                                                    {2612}let pkSess_2647: bitstring = pub(skB) in
                                                    {2613}out(c, GetEndpointRequest);
                                                    {2614}in(c, (=GetEndpointResponse,=pkSess_2647,=None,SP_2648: bitstring,UP_2649: bitstring));
                                                    {2615}new Nc_2650: bitstring;
                                                    {2616}let gNc_2651: bitstring = exp(g,Nc_2650) in
                                                    {2617}let m1_2652: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2651) in
                                                    {2618}event beginCli(Cli,Sess,gNc_2651);
                                                    {2619}out(c, (pkCli_2224,m1_2652));
                                                    {2620}in(c, em2_2653: bitstring);
                                                    {2621}let m2_2654: bitstring = em2_2653 in
                                                    {2622}let (=OpenSecureChannelResponse,=Cli,PartS_2655: bitstring,ST_2656: bitstring,TTL_2657: bitstring) = m2_2654 in
                                                    {2623}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2624}event endCli(Sess,Cli,PartS_2655)
                                                )
                                                else
                                                    {2625}let v_2658: bool = (Sess = C) in
                                                    (
                                                        {2626}if v_2658 then
                                                        (
                                                            {2627}let pkSess_2659: bitstring = pub(skC) in
                                                            {2628}out(c, GetEndpointRequest);
                                                            {2629}in(c, (=GetEndpointResponse,=pkSess_2659,=None,SP_2660: bitstring,UP_2661: bitstring));
                                                            {2630}new Nc_2662: bitstring;
                                                            {2631}let gNc_2663: bitstring = exp(g,Nc_2662) in
                                                            {2632}let m1_2664: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2663) in
                                                            {2633}event beginCli(Cli,Sess,gNc_2663);
                                                            {2634}out(c, (pkCli_2224,m1_2664));
                                                            {2635}in(c, em2_2665: bitstring);
                                                            {2636}let m2_2666: bitstring = em2_2665 in
                                                            {2637}let (=OpenSecureChannelResponse,=Cli,PartS_2667: bitstring,ST_2668: bitstring,TTL_2669: bitstring) = m2_2666 in
                                                            {2638}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2639}event endCli(Sess,Cli,PartS_2667)
                                                        )
                                                        else
                                                            {2640}let pkSess_2670: bitstring = pub(sk(Sess)) in
                                                            {2641}out(c, GetEndpointRequest);
                                                            {2642}in(c, (=GetEndpointResponse,=pkSess_2670,=None,SP_2671: bitstring,UP_2672: bitstring));
                                                            {2643}new Nc_2673: bitstring;
                                                            {2644}let gNc_2674: bitstring = exp(g,Nc_2673) in
                                                            {2645}let m1_2675: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2674) in
                                                            {2646}event beginCli(Cli,Sess,gNc_2674);
                                                            {2647}out(c, (pkCli_2224,m1_2675));
                                                            {2648}in(c, em2_2676: bitstring);
                                                            {2649}let m2_2677: bitstring = em2_2676 in
                                                            {2650}let (=OpenSecureChannelResponse,=Cli,PartS_2678: bitstring,ST_2679: bitstring,TTL_2680: bitstring) = m2_2677 in
                                                            {2651}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {2652}event endCli(Sess,Cli,PartS_2678)
                                                    )
                                                    else
                                                        {2653}let pkSess_2681: bitstring = fail-any in
                                                        {2654}out(c, GetEndpointRequest);
                                                        {2655}in(c, (=GetEndpointResponse,=pkSess_2681,=None,SP_2682: bitstring,UP_2683: bitstring));
                                                        {2656}new Nc_2684: bitstring;
                                                        {2657}let gNc_2685: bitstring = exp(g,Nc_2684) in
                                                        {2658}let m1_2686: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2685) in
                                                        {2659}event beginCli(Cli,Sess,gNc_2685);
                                                        {2660}out(c, (pkCli_2224,m1_2686));
                                                        {2661}in(c, em2_2687: bitstring);
                                                        {2662}let m2_2688: bitstring = em2_2687 in
                                                        {2663}let (=OpenSecureChannelResponse,=Cli,PartS_2689: bitstring,ST_2690: bitstring,TTL_2691: bitstring) = m2_2688 in
                                                        {2664}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2665}event endCli(Sess,Cli,PartS_2689)
                                            )
                                            else
                                                {2666}let pkSess_2692: bitstring = fail-any in
                                                {2667}out(c, GetEndpointRequest);
                                                {2668}in(c, (=GetEndpointResponse,=pkSess_2692,=None,SP_2693: bitstring,UP_2694: bitstring));
                                                {2669}new Nc_2695: bitstring;
                                                {2670}let gNc_2696: bitstring = exp(g,Nc_2695) in
                                                {2671}let m1_2697: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2696) in
                                                {2672}event beginCli(Cli,Sess,gNc_2696);
                                                {2673}out(c, (pkCli_2224,m1_2697));
                                                {2674}in(c, em2_2698: bitstring);
                                                {2675}let m2_2699: bitstring = em2_2698 in
                                                {2676}let (=OpenSecureChannelResponse,=Cli,PartS_2700: bitstring,ST_2701: bitstring,TTL_2702: bitstring) = m2_2699 in
                                                {2677}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2678}event endCli(Sess,Cli,PartS_2700)
                                    )
                                    else
                                        {2679}let pkSess_2703: bitstring = fail-any in
                                        {2680}out(c, GetEndpointRequest);
                                        {2681}in(c, (=GetEndpointResponse,=pkSess_2703,=None,SP_2704: bitstring,UP_2705: bitstring));
                                        {2682}new Nc_2706: bitstring;
                                        {2683}let gNc_2707: bitstring = exp(g,Nc_2706) in
                                        {2684}let m1_2708: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2707) in
                                        {2685}event beginCli(Cli,Sess,gNc_2707);
                                        {2686}out(c, (pkCli_2224,m1_2708));
                                        {2687}in(c, em2_2709: bitstring);
                                        {2688}let m2_2710: bitstring = em2_2709 in
                                        {2689}let (=OpenSecureChannelResponse,=Cli,PartS_2711: bitstring,ST_2712: bitstring,TTL_2713: bitstring) = m2_2710 in
                                        {2690}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2691}event endCli(Sess,Cli,PartS_2711)
                        )
                        else
                            {2692}let pkDisco_2714: bitstring = fail-any in
                            {2693}let v_2715: bool = (Sess = A) in
                            (
                                {2694}if v_2715 then
                                (
                                    {2695}let pkSess_2716: bitstring = pub(skA) in
                                    {2696}out(c, GetEndpointRequest);
                                    {2697}in(c, (=GetEndpointResponse,=pkSess_2716,=None,SP_2717: bitstring,UP_2718: bitstring));
                                    {2698}new Nc_2719: bitstring;
                                    {2699}let gNc_2720: bitstring = exp(g,Nc_2719) in
                                    {2700}let m1_2721: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2720) in
                                    {2701}event beginCli(Cli,Sess,gNc_2720);
                                    {2702}out(c, (pkCli_2224,m1_2721));
                                    {2703}in(c, em2_2722: bitstring);
                                    {2704}let m2_2723: bitstring = em2_2722 in
                                    {2705}let (=OpenSecureChannelResponse,=Cli,PartS_2724: bitstring,ST_2725: bitstring,TTL_2726: bitstring) = m2_2723 in
                                    {2706}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2707}event endCli(Sess,Cli,PartS_2724)
                                )
                                else
                                    {2708}let v_2727: bool = (Sess = B) in
                                    (
                                        {2709}if v_2727 then
                                        (
                                            {2710}let pkSess_2728: bitstring = pub(skB) in
                                            {2711}out(c, GetEndpointRequest);
                                            {2712}in(c, (=GetEndpointResponse,=pkSess_2728,=None,SP_2729: bitstring,UP_2730: bitstring));
                                            {2713}new Nc_2731: bitstring;
                                            {2714}let gNc_2732: bitstring = exp(g,Nc_2731) in
                                            {2715}let m1_2733: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2732) in
                                            {2716}event beginCli(Cli,Sess,gNc_2732);
                                            {2717}out(c, (pkCli_2224,m1_2733));
                                            {2718}in(c, em2_2734: bitstring);
                                            {2719}let m2_2735: bitstring = em2_2734 in
                                            {2720}let (=OpenSecureChannelResponse,=Cli,PartS_2736: bitstring,ST_2737: bitstring,TTL_2738: bitstring) = m2_2735 in
                                            {2721}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2722}event endCli(Sess,Cli,PartS_2736)
                                        )
                                        else
                                            {2723}let v_2739: bool = (Sess = C) in
                                            (
                                                {2724}if v_2739 then
                                                (
                                                    {2725}let pkSess_2740: bitstring = pub(skC) in
                                                    {2726}out(c, GetEndpointRequest);
                                                    {2727}in(c, (=GetEndpointResponse,=pkSess_2740,=None,SP_2741: bitstring,UP_2742: bitstring));
                                                    {2728}new Nc_2743: bitstring;
                                                    {2729}let gNc_2744: bitstring = exp(g,Nc_2743) in
                                                    {2730}let m1_2745: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2744) in
                                                    {2731}event beginCli(Cli,Sess,gNc_2744);
                                                    {2732}out(c, (pkCli_2224,m1_2745));
                                                    {2733}in(c, em2_2746: bitstring);
                                                    {2734}let m2_2747: bitstring = em2_2746 in
                                                    {2735}let (=OpenSecureChannelResponse,=Cli,PartS_2748: bitstring,ST_2749: bitstring,TTL_2750: bitstring) = m2_2747 in
                                                    {2736}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2737}event endCli(Sess,Cli,PartS_2748)
                                                )
                                                else
                                                    {2738}let pkSess_2751: bitstring = pub(sk(Sess)) in
                                                    {2739}out(c, GetEndpointRequest);
                                                    {2740}in(c, (=GetEndpointResponse,=pkSess_2751,=None,SP_2752: bitstring,UP_2753: bitstring));
                                                    {2741}new Nc_2754: bitstring;
                                                    {2742}let gNc_2755: bitstring = exp(g,Nc_2754) in
                                                    {2743}let m1_2756: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2755) in
                                                    {2744}event beginCli(Cli,Sess,gNc_2755);
                                                    {2745}out(c, (pkCli_2224,m1_2756));
                                                    {2746}in(c, em2_2757: bitstring);
                                                    {2747}let m2_2758: bitstring = em2_2757 in
                                                    {2748}let (=OpenSecureChannelResponse,=Cli,PartS_2759: bitstring,ST_2760: bitstring,TTL_2761: bitstring) = m2_2758 in
                                                    {2749}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2750}event endCli(Sess,Cli,PartS_2759)
                                            )
                                            else
                                                {2751}let pkSess_2762: bitstring = fail-any in
                                                {2752}out(c, GetEndpointRequest);
                                                {2753}in(c, (=GetEndpointResponse,=pkSess_2762,=None,SP_2763: bitstring,UP_2764: bitstring));
                                                {2754}new Nc_2765: bitstring;
                                                {2755}let gNc_2766: bitstring = exp(g,Nc_2765) in
                                                {2756}let m1_2767: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2766) in
                                                {2757}event beginCli(Cli,Sess,gNc_2766);
                                                {2758}out(c, (pkCli_2224,m1_2767));
                                                {2759}in(c, em2_2768: bitstring);
                                                {2760}let m2_2769: bitstring = em2_2768 in
                                                {2761}let (=OpenSecureChannelResponse,=Cli,PartS_2770: bitstring,ST_2771: bitstring,TTL_2772: bitstring) = m2_2769 in
                                                {2762}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2763}event endCli(Sess,Cli,PartS_2770)
                                    )
                                    else
                                        {2764}let pkSess_2773: bitstring = fail-any in
                                        {2765}out(c, GetEndpointRequest);
                                        {2766}in(c, (=GetEndpointResponse,=pkSess_2773,=None,SP_2774: bitstring,UP_2775: bitstring));
                                        {2767}new Nc_2776: bitstring;
                                        {2768}let gNc_2777: bitstring = exp(g,Nc_2776) in
                                        {2769}let m1_2778: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2777) in
                                        {2770}event beginCli(Cli,Sess,gNc_2777);
                                        {2771}out(c, (pkCli_2224,m1_2778));
                                        {2772}in(c, em2_2779: bitstring);
                                        {2773}let m2_2780: bitstring = em2_2779 in
                                        {2774}let (=OpenSecureChannelResponse,=Cli,PartS_2781: bitstring,ST_2782: bitstring,TTL_2783: bitstring) = m2_2780 in
                                        {2775}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2776}event endCli(Sess,Cli,PartS_2781)
                            )
                            else
                                {2777}let pkSess_2784: bitstring = fail-any in
                                {2778}out(c, GetEndpointRequest);
                                {2779}in(c, (=GetEndpointResponse,=pkSess_2784,=None,SP_2785: bitstring,UP_2786: bitstring));
                                {2780}new Nc_2787: bitstring;
                                {2781}let gNc_2788: bitstring = exp(g,Nc_2787) in
                                {2782}let m1_2789: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2224,gNc_2788) in
                                {2783}event beginCli(Cli,Sess,gNc_2788);
                                {2784}out(c, (pkCli_2224,m1_2789));
                                {2785}in(c, em2_2790: bitstring);
                                {2786}let m2_2791: bitstring = em2_2790 in
                                {2787}let (=OpenSecureChannelResponse,=Cli,PartS_2792: bitstring,ST_2793: bitstring,TTL_2794: bitstring) = m2_2791 in
                                {2788}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2789}event endCli(Sess,Cli,PartS_2792)
            )
            else
                {2790}let skCli_2795: bitstring = fail-any in
                {2791}let pkCli_2796: bitstring = pub(skCli_2795) in
                {2792}let v_2797: bool = (Disco = A) in
                (
                    {2793}if v_2797 then
                    (
                        {2794}let pkDisco_2798: bitstring = pub(skA) in
                        {2795}let v_2799: bool = (Sess = A) in
                        (
                            {2796}if v_2799 then
                            (
                                {2797}let pkSess_2800: bitstring = pub(skA) in
                                {2798}out(c, GetEndpointRequest);
                                {2799}in(c, (=GetEndpointResponse,=pkSess_2800,=None,SP_2801: bitstring,UP_2802: bitstring));
                                {2800}new Nc_2803: bitstring;
                                {2801}let gNc_2804: bitstring = exp(g,Nc_2803) in
                                {2802}let m1_2805: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2804) in
                                {2803}event beginCli(Cli,Sess,gNc_2804);
                                {2804}out(c, (pkCli_2796,m1_2805));
                                {2805}in(c, em2_2806: bitstring);
                                {2806}let m2_2807: bitstring = em2_2806 in
                                {2807}let (=OpenSecureChannelResponse,=Cli,PartS_2808: bitstring,ST_2809: bitstring,TTL_2810: bitstring) = m2_2807 in
                                {2808}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {2809}event endCli(Sess,Cli,PartS_2808)
                            )
                            else
                                {2810}let v_2811: bool = (Sess = B) in
                                (
                                    {2811}if v_2811 then
                                    (
                                        {2812}let pkSess_2812: bitstring = pub(skB) in
                                        {2813}out(c, GetEndpointRequest);
                                        {2814}in(c, (=GetEndpointResponse,=pkSess_2812,=None,SP_2813: bitstring,UP_2814: bitstring));
                                        {2815}new Nc_2815: bitstring;
                                        {2816}let gNc_2816: bitstring = exp(g,Nc_2815) in
                                        {2817}let m1_2817: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2816) in
                                        {2818}event beginCli(Cli,Sess,gNc_2816);
                                        {2819}out(c, (pkCli_2796,m1_2817));
                                        {2820}in(c, em2_2818: bitstring);
                                        {2821}let m2_2819: bitstring = em2_2818 in
                                        {2822}let (=OpenSecureChannelResponse,=Cli,PartS_2820: bitstring,ST_2821: bitstring,TTL_2822: bitstring) = m2_2819 in
                                        {2823}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2824}event endCli(Sess,Cli,PartS_2820)
                                    )
                                    else
                                        {2825}let v_2823: bool = (Sess = C) in
                                        (
                                            {2826}if v_2823 then
                                            (
                                                {2827}let pkSess_2824: bitstring = pub(skC) in
                                                {2828}out(c, GetEndpointRequest);
                                                {2829}in(c, (=GetEndpointResponse,=pkSess_2824,=None,SP_2825: bitstring,UP_2826: bitstring));
                                                {2830}new Nc_2827: bitstring;
                                                {2831}let gNc_2828: bitstring = exp(g,Nc_2827) in
                                                {2832}let m1_2829: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2828) in
                                                {2833}event beginCli(Cli,Sess,gNc_2828);
                                                {2834}out(c, (pkCli_2796,m1_2829));
                                                {2835}in(c, em2_2830: bitstring);
                                                {2836}let m2_2831: bitstring = em2_2830 in
                                                {2837}let (=OpenSecureChannelResponse,=Cli,PartS_2832: bitstring,ST_2833: bitstring,TTL_2834: bitstring) = m2_2831 in
                                                {2838}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2839}event endCli(Sess,Cli,PartS_2832)
                                            )
                                            else
                                                {2840}let pkSess_2835: bitstring = pub(sk(Sess)) in
                                                {2841}out(c, GetEndpointRequest);
                                                {2842}in(c, (=GetEndpointResponse,=pkSess_2835,=None,SP_2836: bitstring,UP_2837: bitstring));
                                                {2843}new Nc_2838: bitstring;
                                                {2844}let gNc_2839: bitstring = exp(g,Nc_2838) in
                                                {2845}let m1_2840: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2839) in
                                                {2846}event beginCli(Cli,Sess,gNc_2839);
                                                {2847}out(c, (pkCli_2796,m1_2840));
                                                {2848}in(c, em2_2841: bitstring);
                                                {2849}let m2_2842: bitstring = em2_2841 in
                                                {2850}let (=OpenSecureChannelResponse,=Cli,PartS_2843: bitstring,ST_2844: bitstring,TTL_2845: bitstring) = m2_2842 in
                                                {2851}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2852}event endCli(Sess,Cli,PartS_2843)
                                        )
                                        else
                                            {2853}let pkSess_2846: bitstring = fail-any in
                                            {2854}out(c, GetEndpointRequest);
                                            {2855}in(c, (=GetEndpointResponse,=pkSess_2846,=None,SP_2847: bitstring,UP_2848: bitstring));
                                            {2856}new Nc_2849: bitstring;
                                            {2857}let gNc_2850: bitstring = exp(g,Nc_2849) in
                                            {2858}let m1_2851: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2850) in
                                            {2859}event beginCli(Cli,Sess,gNc_2850);
                                            {2860}out(c, (pkCli_2796,m1_2851));
                                            {2861}in(c, em2_2852: bitstring);
                                            {2862}let m2_2853: bitstring = em2_2852 in
                                            {2863}let (=OpenSecureChannelResponse,=Cli,PartS_2854: bitstring,ST_2855: bitstring,TTL_2856: bitstring) = m2_2853 in
                                            {2864}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2865}event endCli(Sess,Cli,PartS_2854)
                                )
                                else
                                    {2866}let pkSess_2857: bitstring = fail-any in
                                    {2867}out(c, GetEndpointRequest);
                                    {2868}in(c, (=GetEndpointResponse,=pkSess_2857,=None,SP_2858: bitstring,UP_2859: bitstring));
                                    {2869}new Nc_2860: bitstring;
                                    {2870}let gNc_2861: bitstring = exp(g,Nc_2860) in
                                    {2871}let m1_2862: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2861) in
                                    {2872}event beginCli(Cli,Sess,gNc_2861);
                                    {2873}out(c, (pkCli_2796,m1_2862));
                                    {2874}in(c, em2_2863: bitstring);
                                    {2875}let m2_2864: bitstring = em2_2863 in
                                    {2876}let (=OpenSecureChannelResponse,=Cli,PartS_2865: bitstring,ST_2866: bitstring,TTL_2867: bitstring) = m2_2864 in
                                    {2877}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2878}event endCli(Sess,Cli,PartS_2865)
                        )
                        else
                            {2879}let pkSess_2868: bitstring = fail-any in
                            {2880}out(c, GetEndpointRequest);
                            {2881}in(c, (=GetEndpointResponse,=pkSess_2868,=None,SP_2869: bitstring,UP_2870: bitstring));
                            {2882}new Nc_2871: bitstring;
                            {2883}let gNc_2872: bitstring = exp(g,Nc_2871) in
                            {2884}let m1_2873: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2872) in
                            {2885}event beginCli(Cli,Sess,gNc_2872);
                            {2886}out(c, (pkCli_2796,m1_2873));
                            {2887}in(c, em2_2874: bitstring);
                            {2888}let m2_2875: bitstring = em2_2874 in
                            {2889}let (=OpenSecureChannelResponse,=Cli,PartS_2876: bitstring,ST_2877: bitstring,TTL_2878: bitstring) = m2_2875 in
                            {2890}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {2891}event endCli(Sess,Cli,PartS_2876)
                    )
                    else
                        {2892}let v_2879: bool = (Disco = B) in
                        (
                            {2893}if v_2879 then
                            (
                                {2894}let pkDisco_2880: bitstring = pub(skB) in
                                {2895}let v_2881: bool = (Sess = A) in
                                (
                                    {2896}if v_2881 then
                                    (
                                        {2897}let pkSess_2882: bitstring = pub(skA) in
                                        {2898}out(c, GetEndpointRequest);
                                        {2899}in(c, (=GetEndpointResponse,=pkSess_2882,=None,SP_2883: bitstring,UP_2884: bitstring));
                                        {2900}new Nc_2885: bitstring;
                                        {2901}let gNc_2886: bitstring = exp(g,Nc_2885) in
                                        {2902}let m1_2887: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2886) in
                                        {2903}event beginCli(Cli,Sess,gNc_2886);
                                        {2904}out(c, (pkCli_2796,m1_2887));
                                        {2905}in(c, em2_2888: bitstring);
                                        {2906}let m2_2889: bitstring = em2_2888 in
                                        {2907}let (=OpenSecureChannelResponse,=Cli,PartS_2890: bitstring,ST_2891: bitstring,TTL_2892: bitstring) = m2_2889 in
                                        {2908}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {2909}event endCli(Sess,Cli,PartS_2890)
                                    )
                                    else
                                        {2910}let v_2893: bool = (Sess = B) in
                                        (
                                            {2911}if v_2893 then
                                            (
                                                {2912}let pkSess_2894: bitstring = pub(skB) in
                                                {2913}out(c, GetEndpointRequest);
                                                {2914}in(c, (=GetEndpointResponse,=pkSess_2894,=None,SP_2895: bitstring,UP_2896: bitstring));
                                                {2915}new Nc_2897: bitstring;
                                                {2916}let gNc_2898: bitstring = exp(g,Nc_2897) in
                                                {2917}let m1_2899: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2898) in
                                                {2918}event beginCli(Cli,Sess,gNc_2898);
                                                {2919}out(c, (pkCli_2796,m1_2899));
                                                {2920}in(c, em2_2900: bitstring);
                                                {2921}let m2_2901: bitstring = em2_2900 in
                                                {2922}let (=OpenSecureChannelResponse,=Cli,PartS_2902: bitstring,ST_2903: bitstring,TTL_2904: bitstring) = m2_2901 in
                                                {2923}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {2924}event endCli(Sess,Cli,PartS_2902)
                                            )
                                            else
                                                {2925}let v_2905: bool = (Sess = C) in
                                                (
                                                    {2926}if v_2905 then
                                                    (
                                                        {2927}let pkSess_2906: bitstring = pub(skC) in
                                                        {2928}out(c, GetEndpointRequest);
                                                        {2929}in(c, (=GetEndpointResponse,=pkSess_2906,=None,SP_2907: bitstring,UP_2908: bitstring));
                                                        {2930}new Nc_2909: bitstring;
                                                        {2931}let gNc_2910: bitstring = exp(g,Nc_2909) in
                                                        {2932}let m1_2911: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2910) in
                                                        {2933}event beginCli(Cli,Sess,gNc_2910);
                                                        {2934}out(c, (pkCli_2796,m1_2911));
                                                        {2935}in(c, em2_2912: bitstring);
                                                        {2936}let m2_2913: bitstring = em2_2912 in
                                                        {2937}let (=OpenSecureChannelResponse,=Cli,PartS_2914: bitstring,ST_2915: bitstring,TTL_2916: bitstring) = m2_2913 in
                                                        {2938}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2939}event endCli(Sess,Cli,PartS_2914)
                                                    )
                                                    else
                                                        {2940}let pkSess_2917: bitstring = pub(sk(Sess)) in
                                                        {2941}out(c, GetEndpointRequest);
                                                        {2942}in(c, (=GetEndpointResponse,=pkSess_2917,=None,SP_2918: bitstring,UP_2919: bitstring));
                                                        {2943}new Nc_2920: bitstring;
                                                        {2944}let gNc_2921: bitstring = exp(g,Nc_2920) in
                                                        {2945}let m1_2922: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2921) in
                                                        {2946}event beginCli(Cli,Sess,gNc_2921);
                                                        {2947}out(c, (pkCli_2796,m1_2922));
                                                        {2948}in(c, em2_2923: bitstring);
                                                        {2949}let m2_2924: bitstring = em2_2923 in
                                                        {2950}let (=OpenSecureChannelResponse,=Cli,PartS_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                                        {2951}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {2952}event endCli(Sess,Cli,PartS_2925)
                                                )
                                                else
                                                    {2953}let pkSess_2928: bitstring = fail-any in
                                                    {2954}out(c, GetEndpointRequest);
                                                    {2955}in(c, (=GetEndpointResponse,=pkSess_2928,=None,SP_2929: bitstring,UP_2930: bitstring));
                                                    {2956}new Nc_2931: bitstring;
                                                    {2957}let gNc_2932: bitstring = exp(g,Nc_2931) in
                                                    {2958}let m1_2933: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2932) in
                                                    {2959}event beginCli(Cli,Sess,gNc_2932);
                                                    {2960}out(c, (pkCli_2796,m1_2933));
                                                    {2961}in(c, em2_2934: bitstring);
                                                    {2962}let m2_2935: bitstring = em2_2934 in
                                                    {2963}let (=OpenSecureChannelResponse,=Cli,PartS_2936: bitstring,ST_2937: bitstring,TTL_2938: bitstring) = m2_2935 in
                                                    {2964}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {2965}event endCli(Sess,Cli,PartS_2936)
                                        )
                                        else
                                            {2966}let pkSess_2939: bitstring = fail-any in
                                            {2967}out(c, GetEndpointRequest);
                                            {2968}in(c, (=GetEndpointResponse,=pkSess_2939,=None,SP_2940: bitstring,UP_2941: bitstring));
                                            {2969}new Nc_2942: bitstring;
                                            {2970}let gNc_2943: bitstring = exp(g,Nc_2942) in
                                            {2971}let m1_2944: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2943) in
                                            {2972}event beginCli(Cli,Sess,gNc_2943);
                                            {2973}out(c, (pkCli_2796,m1_2944));
                                            {2974}in(c, em2_2945: bitstring);
                                            {2975}let m2_2946: bitstring = em2_2945 in
                                            {2976}let (=OpenSecureChannelResponse,=Cli,PartS_2947: bitstring,ST_2948: bitstring,TTL_2949: bitstring) = m2_2946 in
                                            {2977}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {2978}event endCli(Sess,Cli,PartS_2947)
                                )
                                else
                                    {2979}let pkSess_2950: bitstring = fail-any in
                                    {2980}out(c, GetEndpointRequest);
                                    {2981}in(c, (=GetEndpointResponse,=pkSess_2950,=None,SP_2951: bitstring,UP_2952: bitstring));
                                    {2982}new Nc_2953: bitstring;
                                    {2983}let gNc_2954: bitstring = exp(g,Nc_2953) in
                                    {2984}let m1_2955: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2954) in
                                    {2985}event beginCli(Cli,Sess,gNc_2954);
                                    {2986}out(c, (pkCli_2796,m1_2955));
                                    {2987}in(c, em2_2956: bitstring);
                                    {2988}let m2_2957: bitstring = em2_2956 in
                                    {2989}let (=OpenSecureChannelResponse,=Cli,PartS_2958: bitstring,ST_2959: bitstring,TTL_2960: bitstring) = m2_2957 in
                                    {2990}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {2991}event endCli(Sess,Cli,PartS_2958)
                            )
                            else
                                {2992}let v_2961: bool = (Disco = C) in
                                (
                                    {2993}if v_2961 then
                                    (
                                        {2994}let pkDisco_2962: bitstring = pub(skC) in
                                        {2995}let v_2963: bool = (Sess = A) in
                                        (
                                            {2996}if v_2963 then
                                            (
                                                {2997}let pkSess_2964: bitstring = pub(skA) in
                                                {2998}out(c, GetEndpointRequest);
                                                {2999}in(c, (=GetEndpointResponse,=pkSess_2964,=None,SP_2965: bitstring,UP_2966: bitstring));
                                                {3000}new Nc_2967: bitstring;
                                                {3001}let gNc_2968: bitstring = exp(g,Nc_2967) in
                                                {3002}let m1_2969: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2968) in
                                                {3003}event beginCli(Cli,Sess,gNc_2968);
                                                {3004}out(c, (pkCli_2796,m1_2969));
                                                {3005}in(c, em2_2970: bitstring);
                                                {3006}let m2_2971: bitstring = em2_2970 in
                                                {3007}let (=OpenSecureChannelResponse,=Cli,PartS_2972: bitstring,ST_2973: bitstring,TTL_2974: bitstring) = m2_2971 in
                                                {3008}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3009}event endCli(Sess,Cli,PartS_2972)
                                            )
                                            else
                                                {3010}let v_2975: bool = (Sess = B) in
                                                (
                                                    {3011}if v_2975 then
                                                    (
                                                        {3012}let pkSess_2976: bitstring = pub(skB) in
                                                        {3013}out(c, GetEndpointRequest);
                                                        {3014}in(c, (=GetEndpointResponse,=pkSess_2976,=None,SP_2977: bitstring,UP_2978: bitstring));
                                                        {3015}new Nc_2979: bitstring;
                                                        {3016}let gNc_2980: bitstring = exp(g,Nc_2979) in
                                                        {3017}let m1_2981: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2980) in
                                                        {3018}event beginCli(Cli,Sess,gNc_2980);
                                                        {3019}out(c, (pkCli_2796,m1_2981));
                                                        {3020}in(c, em2_2982: bitstring);
                                                        {3021}let m2_2983: bitstring = em2_2982 in
                                                        {3022}let (=OpenSecureChannelResponse,=Cli,PartS_2984: bitstring,ST_2985: bitstring,TTL_2986: bitstring) = m2_2983 in
                                                        {3023}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3024}event endCli(Sess,Cli,PartS_2984)
                                                    )
                                                    else
                                                        {3025}let v_2987: bool = (Sess = C) in
                                                        (
                                                            {3026}if v_2987 then
                                                            (
                                                                {3027}let pkSess_2988: bitstring = pub(skC) in
                                                                {3028}out(c, GetEndpointRequest);
                                                                {3029}in(c, (=GetEndpointResponse,=pkSess_2988,=None,SP_2989: bitstring,UP_2990: bitstring));
                                                                {3030}new Nc_2991: bitstring;
                                                                {3031}let gNc_2992: bitstring = exp(g,Nc_2991) in
                                                                {3032}let m1_2993: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_2992) in
                                                                {3033}event beginCli(Cli,Sess,gNc_2992);
                                                                {3034}out(c, (pkCli_2796,m1_2993));
                                                                {3035}in(c, em2_2994: bitstring);
                                                                {3036}let m2_2995: bitstring = em2_2994 in
                                                                {3037}let (=OpenSecureChannelResponse,=Cli,PartS_2996: bitstring,ST_2997: bitstring,TTL_2998: bitstring) = m2_2995 in
                                                                {3038}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3039}event endCli(Sess,Cli,PartS_2996)
                                                            )
                                                            else
                                                                {3040}let pkSess_2999: bitstring = pub(sk(Sess)) in
                                                                {3041}out(c, GetEndpointRequest);
                                                                {3042}in(c, (=GetEndpointResponse,=pkSess_2999,=None,SP_3000: bitstring,UP_3001: bitstring));
                                                                {3043}new Nc_3002: bitstring;
                                                                {3044}let gNc_3003: bitstring = exp(g,Nc_3002) in
                                                                {3045}let m1_3004: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3003) in
                                                                {3046}event beginCli(Cli,Sess,gNc_3003);
                                                                {3047}out(c, (pkCli_2796,m1_3004));
                                                                {3048}in(c, em2_3005: bitstring);
                                                                {3049}let m2_3006: bitstring = em2_3005 in
                                                                {3050}let (=OpenSecureChannelResponse,=Cli,PartS_3007: bitstring,ST_3008: bitstring,TTL_3009: bitstring) = m2_3006 in
                                                                {3051}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3052}event endCli(Sess,Cli,PartS_3007)
                                                        )
                                                        else
                                                            {3053}let pkSess_3010: bitstring = fail-any in
                                                            {3054}out(c, GetEndpointRequest);
                                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3010,=None,SP_3011: bitstring,UP_3012: bitstring));
                                                            {3056}new Nc_3013: bitstring;
                                                            {3057}let gNc_3014: bitstring = exp(g,Nc_3013) in
                                                            {3058}let m1_3015: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3014) in
                                                            {3059}event beginCli(Cli,Sess,gNc_3014);
                                                            {3060}out(c, (pkCli_2796,m1_3015));
                                                            {3061}in(c, em2_3016: bitstring);
                                                            {3062}let m2_3017: bitstring = em2_3016 in
                                                            {3063}let (=OpenSecureChannelResponse,=Cli,PartS_3018: bitstring,ST_3019: bitstring,TTL_3020: bitstring) = m2_3017 in
                                                            {3064}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3065}event endCli(Sess,Cli,PartS_3018)
                                                )
                                                else
                                                    {3066}let pkSess_3021: bitstring = fail-any in
                                                    {3067}out(c, GetEndpointRequest);
                                                    {3068}in(c, (=GetEndpointResponse,=pkSess_3021,=None,SP_3022: bitstring,UP_3023: bitstring));
                                                    {3069}new Nc_3024: bitstring;
                                                    {3070}let gNc_3025: bitstring = exp(g,Nc_3024) in
                                                    {3071}let m1_3026: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3025) in
                                                    {3072}event beginCli(Cli,Sess,gNc_3025);
                                                    {3073}out(c, (pkCli_2796,m1_3026));
                                                    {3074}in(c, em2_3027: bitstring);
                                                    {3075}let m2_3028: bitstring = em2_3027 in
                                                    {3076}let (=OpenSecureChannelResponse,=Cli,PartS_3029: bitstring,ST_3030: bitstring,TTL_3031: bitstring) = m2_3028 in
                                                    {3077}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3078}event endCli(Sess,Cli,PartS_3029)
                                        )
                                        else
                                            {3079}let pkSess_3032: bitstring = fail-any in
                                            {3080}out(c, GetEndpointRequest);
                                            {3081}in(c, (=GetEndpointResponse,=pkSess_3032,=None,SP_3033: bitstring,UP_3034: bitstring));
                                            {3082}new Nc_3035: bitstring;
                                            {3083}let gNc_3036: bitstring = exp(g,Nc_3035) in
                                            {3084}let m1_3037: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3036) in
                                            {3085}event beginCli(Cli,Sess,gNc_3036);
                                            {3086}out(c, (pkCli_2796,m1_3037));
                                            {3087}in(c, em2_3038: bitstring);
                                            {3088}let m2_3039: bitstring = em2_3038 in
                                            {3089}let (=OpenSecureChannelResponse,=Cli,PartS_3040: bitstring,ST_3041: bitstring,TTL_3042: bitstring) = m2_3039 in
                                            {3090}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3091}event endCli(Sess,Cli,PartS_3040)
                                    )
                                    else
                                        {3092}let pkDisco_3043: bitstring = pub(sk(Disco)) in
                                        {3093}let v_3044: bool = (Sess = A) in
                                        (
                                            {3094}if v_3044 then
                                            (
                                                {3095}let pkSess_3045: bitstring = pub(skA) in
                                                {3096}out(c, GetEndpointRequest);
                                                {3097}in(c, (=GetEndpointResponse,=pkSess_3045,=None,SP_3046: bitstring,UP_3047: bitstring));
                                                {3098}new Nc_3048: bitstring;
                                                {3099}let gNc_3049: bitstring = exp(g,Nc_3048) in
                                                {3100}let m1_3050: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3049) in
                                                {3101}event beginCli(Cli,Sess,gNc_3049);
                                                {3102}out(c, (pkCli_2796,m1_3050));
                                                {3103}in(c, em2_3051: bitstring);
                                                {3104}let m2_3052: bitstring = em2_3051 in
                                                {3105}let (=OpenSecureChannelResponse,=Cli,PartS_3053: bitstring,ST_3054: bitstring,TTL_3055: bitstring) = m2_3052 in
                                                {3106}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3107}event endCli(Sess,Cli,PartS_3053)
                                            )
                                            else
                                                {3108}let v_3056: bool = (Sess = B) in
                                                (
                                                    {3109}if v_3056 then
                                                    (
                                                        {3110}let pkSess_3057: bitstring = pub(skB) in
                                                        {3111}out(c, GetEndpointRequest);
                                                        {3112}in(c, (=GetEndpointResponse,=pkSess_3057,=None,SP_3058: bitstring,UP_3059: bitstring));
                                                        {3113}new Nc_3060: bitstring;
                                                        {3114}let gNc_3061: bitstring = exp(g,Nc_3060) in
                                                        {3115}let m1_3062: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3061) in
                                                        {3116}event beginCli(Cli,Sess,gNc_3061);
                                                        {3117}out(c, (pkCli_2796,m1_3062));
                                                        {3118}in(c, em2_3063: bitstring);
                                                        {3119}let m2_3064: bitstring = em2_3063 in
                                                        {3120}let (=OpenSecureChannelResponse,=Cli,PartS_3065: bitstring,ST_3066: bitstring,TTL_3067: bitstring) = m2_3064 in
                                                        {3121}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3122}event endCli(Sess,Cli,PartS_3065)
                                                    )
                                                    else
                                                        {3123}let v_3068: bool = (Sess = C) in
                                                        (
                                                            {3124}if v_3068 then
                                                            (
                                                                {3125}let pkSess_3069: bitstring = pub(skC) in
                                                                {3126}out(c, GetEndpointRequest);
                                                                {3127}in(c, (=GetEndpointResponse,=pkSess_3069,=None,SP_3070: bitstring,UP_3071: bitstring));
                                                                {3128}new Nc_3072: bitstring;
                                                                {3129}let gNc_3073: bitstring = exp(g,Nc_3072) in
                                                                {3130}let m1_3074: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3073) in
                                                                {3131}event beginCli(Cli,Sess,gNc_3073);
                                                                {3132}out(c, (pkCli_2796,m1_3074));
                                                                {3133}in(c, em2_3075: bitstring);
                                                                {3134}let m2_3076: bitstring = em2_3075 in
                                                                {3135}let (=OpenSecureChannelResponse,=Cli,PartS_3077: bitstring,ST_3078: bitstring,TTL_3079: bitstring) = m2_3076 in
                                                                {3136}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3137}event endCli(Sess,Cli,PartS_3077)
                                                            )
                                                            else
                                                                {3138}let pkSess_3080: bitstring = pub(sk(Sess)) in
                                                                {3139}out(c, GetEndpointRequest);
                                                                {3140}in(c, (=GetEndpointResponse,=pkSess_3080,=None,SP_3081: bitstring,UP_3082: bitstring));
                                                                {3141}new Nc_3083: bitstring;
                                                                {3142}let gNc_3084: bitstring = exp(g,Nc_3083) in
                                                                {3143}let m1_3085: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3084) in
                                                                {3144}event beginCli(Cli,Sess,gNc_3084);
                                                                {3145}out(c, (pkCli_2796,m1_3085));
                                                                {3146}in(c, em2_3086: bitstring);
                                                                {3147}let m2_3087: bitstring = em2_3086 in
                                                                {3148}let (=OpenSecureChannelResponse,=Cli,PartS_3088: bitstring,ST_3089: bitstring,TTL_3090: bitstring) = m2_3087 in
                                                                {3149}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                                {3150}event endCli(Sess,Cli,PartS_3088)
                                                        )
                                                        else
                                                            {3151}let pkSess_3091: bitstring = fail-any in
                                                            {3152}out(c, GetEndpointRequest);
                                                            {3153}in(c, (=GetEndpointResponse,=pkSess_3091,=None,SP_3092: bitstring,UP_3093: bitstring));
                                                            {3154}new Nc_3094: bitstring;
                                                            {3155}let gNc_3095: bitstring = exp(g,Nc_3094) in
                                                            {3156}let m1_3096: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3095) in
                                                            {3157}event beginCli(Cli,Sess,gNc_3095);
                                                            {3158}out(c, (pkCli_2796,m1_3096));
                                                            {3159}in(c, em2_3097: bitstring);
                                                            {3160}let m2_3098: bitstring = em2_3097 in
                                                            {3161}let (=OpenSecureChannelResponse,=Cli,PartS_3099: bitstring,ST_3100: bitstring,TTL_3101: bitstring) = m2_3098 in
                                                            {3162}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3163}event endCli(Sess,Cli,PartS_3099)
                                                )
                                                else
                                                    {3164}let pkSess_3102: bitstring = fail-any in
                                                    {3165}out(c, GetEndpointRequest);
                                                    {3166}in(c, (=GetEndpointResponse,=pkSess_3102,=None,SP_3103: bitstring,UP_3104: bitstring));
                                                    {3167}new Nc_3105: bitstring;
                                                    {3168}let gNc_3106: bitstring = exp(g,Nc_3105) in
                                                    {3169}let m1_3107: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3106) in
                                                    {3170}event beginCli(Cli,Sess,gNc_3106);
                                                    {3171}out(c, (pkCli_2796,m1_3107));
                                                    {3172}in(c, em2_3108: bitstring);
                                                    {3173}let m2_3109: bitstring = em2_3108 in
                                                    {3174}let (=OpenSecureChannelResponse,=Cli,PartS_3110: bitstring,ST_3111: bitstring,TTL_3112: bitstring) = m2_3109 in
                                                    {3175}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3176}event endCli(Sess,Cli,PartS_3110)
                                        )
                                        else
                                            {3177}let pkSess_3113: bitstring = fail-any in
                                            {3178}out(c, GetEndpointRequest);
                                            {3179}in(c, (=GetEndpointResponse,=pkSess_3113,=None,SP_3114: bitstring,UP_3115: bitstring));
                                            {3180}new Nc_3116: bitstring;
                                            {3181}let gNc_3117: bitstring = exp(g,Nc_3116) in
                                            {3182}let m1_3118: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3117) in
                                            {3183}event beginCli(Cli,Sess,gNc_3117);
                                            {3184}out(c, (pkCli_2796,m1_3118));
                                            {3185}in(c, em2_3119: bitstring);
                                            {3186}let m2_3120: bitstring = em2_3119 in
                                            {3187}let (=OpenSecureChannelResponse,=Cli,PartS_3121: bitstring,ST_3122: bitstring,TTL_3123: bitstring) = m2_3120 in
                                            {3188}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3189}event endCli(Sess,Cli,PartS_3121)
                                )
                                else
                                    {3190}let pkDisco_3124: bitstring = fail-any in
                                    {3191}let v_3125: bool = (Sess = A) in
                                    (
                                        {3192}if v_3125 then
                                        (
                                            {3193}let pkSess_3126: bitstring = pub(skA) in
                                            {3194}out(c, GetEndpointRequest);
                                            {3195}in(c, (=GetEndpointResponse,=pkSess_3126,=None,SP_3127: bitstring,UP_3128: bitstring));
                                            {3196}new Nc_3129: bitstring;
                                            {3197}let gNc_3130: bitstring = exp(g,Nc_3129) in
                                            {3198}let m1_3131: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3130) in
                                            {3199}event beginCli(Cli,Sess,gNc_3130);
                                            {3200}out(c, (pkCli_2796,m1_3131));
                                            {3201}in(c, em2_3132: bitstring);
                                            {3202}let m2_3133: bitstring = em2_3132 in
                                            {3203}let (=OpenSecureChannelResponse,=Cli,PartS_3134: bitstring,ST_3135: bitstring,TTL_3136: bitstring) = m2_3133 in
                                            {3204}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3205}event endCli(Sess,Cli,PartS_3134)
                                        )
                                        else
                                            {3206}let v_3137: bool = (Sess = B) in
                                            (
                                                {3207}if v_3137 then
                                                (
                                                    {3208}let pkSess_3138: bitstring = pub(skB) in
                                                    {3209}out(c, GetEndpointRequest);
                                                    {3210}in(c, (=GetEndpointResponse,=pkSess_3138,=None,SP_3139: bitstring,UP_3140: bitstring));
                                                    {3211}new Nc_3141: bitstring;
                                                    {3212}let gNc_3142: bitstring = exp(g,Nc_3141) in
                                                    {3213}let m1_3143: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3142) in
                                                    {3214}event beginCli(Cli,Sess,gNc_3142);
                                                    {3215}out(c, (pkCli_2796,m1_3143));
                                                    {3216}in(c, em2_3144: bitstring);
                                                    {3217}let m2_3145: bitstring = em2_3144 in
                                                    {3218}let (=OpenSecureChannelResponse,=Cli,PartS_3146: bitstring,ST_3147: bitstring,TTL_3148: bitstring) = m2_3145 in
                                                    {3219}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3220}event endCli(Sess,Cli,PartS_3146)
                                                )
                                                else
                                                    {3221}let v_3149: bool = (Sess = C) in
                                                    (
                                                        {3222}if v_3149 then
                                                        (
                                                            {3223}let pkSess_3150: bitstring = pub(skC) in
                                                            {3224}out(c, GetEndpointRequest);
                                                            {3225}in(c, (=GetEndpointResponse,=pkSess_3150,=None,SP_3151: bitstring,UP_3152: bitstring));
                                                            {3226}new Nc_3153: bitstring;
                                                            {3227}let gNc_3154: bitstring = exp(g,Nc_3153) in
                                                            {3228}let m1_3155: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3154) in
                                                            {3229}event beginCli(Cli,Sess,gNc_3154);
                                                            {3230}out(c, (pkCli_2796,m1_3155));
                                                            {3231}in(c, em2_3156: bitstring);
                                                            {3232}let m2_3157: bitstring = em2_3156 in
                                                            {3233}let (=OpenSecureChannelResponse,=Cli,PartS_3158: bitstring,ST_3159: bitstring,TTL_3160: bitstring) = m2_3157 in
                                                            {3234}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3235}event endCli(Sess,Cli,PartS_3158)
                                                        )
                                                        else
                                                            {3236}let pkSess_3161: bitstring = pub(sk(Sess)) in
                                                            {3237}out(c, GetEndpointRequest);
                                                            {3238}in(c, (=GetEndpointResponse,=pkSess_3161,=None,SP_3162: bitstring,UP_3163: bitstring));
                                                            {3239}new Nc_3164: bitstring;
                                                            {3240}let gNc_3165: bitstring = exp(g,Nc_3164) in
                                                            {3241}let m1_3166: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3165) in
                                                            {3242}event beginCli(Cli,Sess,gNc_3165);
                                                            {3243}out(c, (pkCli_2796,m1_3166));
                                                            {3244}in(c, em2_3167: bitstring);
                                                            {3245}let m2_3168: bitstring = em2_3167 in
                                                            {3246}let (=OpenSecureChannelResponse,=Cli,PartS_3169: bitstring,ST_3170: bitstring,TTL_3171: bitstring) = m2_3168 in
                                                            {3247}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                            {3248}event endCli(Sess,Cli,PartS_3169)
                                                    )
                                                    else
                                                        {3249}let pkSess_3172: bitstring = fail-any in
                                                        {3250}out(c, GetEndpointRequest);
                                                        {3251}in(c, (=GetEndpointResponse,=pkSess_3172,=None,SP_3173: bitstring,UP_3174: bitstring));
                                                        {3252}new Nc_3175: bitstring;
                                                        {3253}let gNc_3176: bitstring = exp(g,Nc_3175) in
                                                        {3254}let m1_3177: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3176) in
                                                        {3255}event beginCli(Cli,Sess,gNc_3176);
                                                        {3256}out(c, (pkCli_2796,m1_3177));
                                                        {3257}in(c, em2_3178: bitstring);
                                                        {3258}let m2_3179: bitstring = em2_3178 in
                                                        {3259}let (=OpenSecureChannelResponse,=Cli,PartS_3180: bitstring,ST_3181: bitstring,TTL_3182: bitstring) = m2_3179 in
                                                        {3260}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3261}event endCli(Sess,Cli,PartS_3180)
                                            )
                                            else
                                                {3262}let pkSess_3183: bitstring = fail-any in
                                                {3263}out(c, GetEndpointRequest);
                                                {3264}in(c, (=GetEndpointResponse,=pkSess_3183,=None,SP_3184: bitstring,UP_3185: bitstring));
                                                {3265}new Nc_3186: bitstring;
                                                {3266}let gNc_3187: bitstring = exp(g,Nc_3186) in
                                                {3267}let m1_3188: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3187) in
                                                {3268}event beginCli(Cli,Sess,gNc_3187);
                                                {3269}out(c, (pkCli_2796,m1_3188));
                                                {3270}in(c, em2_3189: bitstring);
                                                {3271}let m2_3190: bitstring = em2_3189 in
                                                {3272}let (=OpenSecureChannelResponse,=Cli,PartS_3191: bitstring,ST_3192: bitstring,TTL_3193: bitstring) = m2_3190 in
                                                {3273}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3274}event endCli(Sess,Cli,PartS_3191)
                                    )
                                    else
                                        {3275}let pkSess_3194: bitstring = fail-any in
                                        {3276}out(c, GetEndpointRequest);
                                        {3277}in(c, (=GetEndpointResponse,=pkSess_3194,=None,SP_3195: bitstring,UP_3196: bitstring));
                                        {3278}new Nc_3197: bitstring;
                                        {3279}let gNc_3198: bitstring = exp(g,Nc_3197) in
                                        {3280}let m1_3199: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3198) in
                                        {3281}event beginCli(Cli,Sess,gNc_3198);
                                        {3282}out(c, (pkCli_2796,m1_3199));
                                        {3283}in(c, em2_3200: bitstring);
                                        {3284}let m2_3201: bitstring = em2_3200 in
                                        {3285}let (=OpenSecureChannelResponse,=Cli,PartS_3202: bitstring,ST_3203: bitstring,TTL_3204: bitstring) = m2_3201 in
                                        {3286}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3287}event endCli(Sess,Cli,PartS_3202)
                        )
                        else
                            {3288}let pkDisco_3205: bitstring = fail-any in
                            {3289}let v_3206: bool = (Sess = A) in
                            (
                                {3290}if v_3206 then
                                (
                                    {3291}let pkSess_3207: bitstring = pub(skA) in
                                    {3292}out(c, GetEndpointRequest);
                                    {3293}in(c, (=GetEndpointResponse,=pkSess_3207,=None,SP_3208: bitstring,UP_3209: bitstring));
                                    {3294}new Nc_3210: bitstring;
                                    {3295}let gNc_3211: bitstring = exp(g,Nc_3210) in
                                    {3296}let m1_3212: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3211) in
                                    {3297}event beginCli(Cli,Sess,gNc_3211);
                                    {3298}out(c, (pkCli_2796,m1_3212));
                                    {3299}in(c, em2_3213: bitstring);
                                    {3300}let m2_3214: bitstring = em2_3213 in
                                    {3301}let (=OpenSecureChannelResponse,=Cli,PartS_3215: bitstring,ST_3216: bitstring,TTL_3217: bitstring) = m2_3214 in
                                    {3302}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3303}event endCli(Sess,Cli,PartS_3215)
                                )
                                else
                                    {3304}let v_3218: bool = (Sess = B) in
                                    (
                                        {3305}if v_3218 then
                                        (
                                            {3306}let pkSess_3219: bitstring = pub(skB) in
                                            {3307}out(c, GetEndpointRequest);
                                            {3308}in(c, (=GetEndpointResponse,=pkSess_3219,=None,SP_3220: bitstring,UP_3221: bitstring));
                                            {3309}new Nc_3222: bitstring;
                                            {3310}let gNc_3223: bitstring = exp(g,Nc_3222) in
                                            {3311}let m1_3224: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3223) in
                                            {3312}event beginCli(Cli,Sess,gNc_3223);
                                            {3313}out(c, (pkCli_2796,m1_3224));
                                            {3314}in(c, em2_3225: bitstring);
                                            {3315}let m2_3226: bitstring = em2_3225 in
                                            {3316}let (=OpenSecureChannelResponse,=Cli,PartS_3227: bitstring,ST_3228: bitstring,TTL_3229: bitstring) = m2_3226 in
                                            {3317}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3318}event endCli(Sess,Cli,PartS_3227)
                                        )
                                        else
                                            {3319}let v_3230: bool = (Sess = C) in
                                            (
                                                {3320}if v_3230 then
                                                (
                                                    {3321}let pkSess_3231: bitstring = pub(skC) in
                                                    {3322}out(c, GetEndpointRequest);
                                                    {3323}in(c, (=GetEndpointResponse,=pkSess_3231,=None,SP_3232: bitstring,UP_3233: bitstring));
                                                    {3324}new Nc_3234: bitstring;
                                                    {3325}let gNc_3235: bitstring = exp(g,Nc_3234) in
                                                    {3326}let m1_3236: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3235) in
                                                    {3327}event beginCli(Cli,Sess,gNc_3235);
                                                    {3328}out(c, (pkCli_2796,m1_3236));
                                                    {3329}in(c, em2_3237: bitstring);
                                                    {3330}let m2_3238: bitstring = em2_3237 in
                                                    {3331}let (=OpenSecureChannelResponse,=Cli,PartS_3239: bitstring,ST_3240: bitstring,TTL_3241: bitstring) = m2_3238 in
                                                    {3332}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3333}event endCli(Sess,Cli,PartS_3239)
                                                )
                                                else
                                                    {3334}let pkSess_3242: bitstring = pub(sk(Sess)) in
                                                    {3335}out(c, GetEndpointRequest);
                                                    {3336}in(c, (=GetEndpointResponse,=pkSess_3242,=None,SP_3243: bitstring,UP_3244: bitstring));
                                                    {3337}new Nc_3245: bitstring;
                                                    {3338}let gNc_3246: bitstring = exp(g,Nc_3245) in
                                                    {3339}let m1_3247: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3246) in
                                                    {3340}event beginCli(Cli,Sess,gNc_3246);
                                                    {3341}out(c, (pkCli_2796,m1_3247));
                                                    {3342}in(c, em2_3248: bitstring);
                                                    {3343}let m2_3249: bitstring = em2_3248 in
                                                    {3344}let (=OpenSecureChannelResponse,=Cli,PartS_3250: bitstring,ST_3251: bitstring,TTL_3252: bitstring) = m2_3249 in
                                                    {3345}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3346}event endCli(Sess,Cli,PartS_3250)
                                            )
                                            else
                                                {3347}let pkSess_3253: bitstring = fail-any in
                                                {3348}out(c, GetEndpointRequest);
                                                {3349}in(c, (=GetEndpointResponse,=pkSess_3253,=None,SP_3254: bitstring,UP_3255: bitstring));
                                                {3350}new Nc_3256: bitstring;
                                                {3351}let gNc_3257: bitstring = exp(g,Nc_3256) in
                                                {3352}let m1_3258: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3257) in
                                                {3353}event beginCli(Cli,Sess,gNc_3257);
                                                {3354}out(c, (pkCli_2796,m1_3258));
                                                {3355}in(c, em2_3259: bitstring);
                                                {3356}let m2_3260: bitstring = em2_3259 in
                                                {3357}let (=OpenSecureChannelResponse,=Cli,PartS_3261: bitstring,ST_3262: bitstring,TTL_3263: bitstring) = m2_3260 in
                                                {3358}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3359}event endCli(Sess,Cli,PartS_3261)
                                    )
                                    else
                                        {3360}let pkSess_3264: bitstring = fail-any in
                                        {3361}out(c, GetEndpointRequest);
                                        {3362}in(c, (=GetEndpointResponse,=pkSess_3264,=None,SP_3265: bitstring,UP_3266: bitstring));
                                        {3363}new Nc_3267: bitstring;
                                        {3364}let gNc_3268: bitstring = exp(g,Nc_3267) in
                                        {3365}let m1_3269: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3268) in
                                        {3366}event beginCli(Cli,Sess,gNc_3268);
                                        {3367}out(c, (pkCli_2796,m1_3269));
                                        {3368}in(c, em2_3270: bitstring);
                                        {3369}let m2_3271: bitstring = em2_3270 in
                                        {3370}let (=OpenSecureChannelResponse,=Cli,PartS_3272: bitstring,ST_3273: bitstring,TTL_3274: bitstring) = m2_3271 in
                                        {3371}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3372}event endCli(Sess,Cli,PartS_3272)
                            )
                            else
                                {3373}let pkSess_3275: bitstring = fail-any in
                                {3374}out(c, GetEndpointRequest);
                                {3375}in(c, (=GetEndpointResponse,=pkSess_3275,=None,SP_3276: bitstring,UP_3277: bitstring));
                                {3376}new Nc_3278: bitstring;
                                {3377}let gNc_3279: bitstring = exp(g,Nc_3278) in
                                {3378}let m1_3280: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3279) in
                                {3379}event beginCli(Cli,Sess,gNc_3279);
                                {3380}out(c, (pkCli_2796,m1_3280));
                                {3381}in(c, em2_3281: bitstring);
                                {3382}let m2_3282: bitstring = em2_3281 in
                                {3383}let (=OpenSecureChannelResponse,=Cli,PartS_3283: bitstring,ST_3284: bitstring,TTL_3285: bitstring) = m2_3282 in
                                {3384}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3385}event endCli(Sess,Cli,PartS_3283)
                )
                else
                    {3386}let pkDisco_3286: bitstring = fail-any in
                    {3387}let v_3287: bool = (Sess = A) in
                    (
                        {3388}if v_3287 then
                        (
                            {3389}let pkSess_3288: bitstring = pub(skA) in
                            {3390}out(c, GetEndpointRequest);
                            {3391}in(c, (=GetEndpointResponse,=pkSess_3288,=None,SP_3289: bitstring,UP_3290: bitstring));
                            {3392}new Nc_3291: bitstring;
                            {3393}let gNc_3292: bitstring = exp(g,Nc_3291) in
                            {3394}let m1_3293: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3292) in
                            {3395}event beginCli(Cli,Sess,gNc_3292);
                            {3396}out(c, (pkCli_2796,m1_3293));
                            {3397}in(c, em2_3294: bitstring);
                            {3398}let m2_3295: bitstring = em2_3294 in
                            {3399}let (=OpenSecureChannelResponse,=Cli,PartS_3296: bitstring,ST_3297: bitstring,TTL_3298: bitstring) = m2_3295 in
                            {3400}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3401}event endCli(Sess,Cli,PartS_3296)
                        )
                        else
                            {3402}let v_3299: bool = (Sess = B) in
                            (
                                {3403}if v_3299 then
                                (
                                    {3404}let pkSess_3300: bitstring = pub(skB) in
                                    {3405}out(c, GetEndpointRequest);
                                    {3406}in(c, (=GetEndpointResponse,=pkSess_3300,=None,SP_3301: bitstring,UP_3302: bitstring));
                                    {3407}new Nc_3303: bitstring;
                                    {3408}let gNc_3304: bitstring = exp(g,Nc_3303) in
                                    {3409}let m1_3305: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3304) in
                                    {3410}event beginCli(Cli,Sess,gNc_3304);
                                    {3411}out(c, (pkCli_2796,m1_3305));
                                    {3412}in(c, em2_3306: bitstring);
                                    {3413}let m2_3307: bitstring = em2_3306 in
                                    {3414}let (=OpenSecureChannelResponse,=Cli,PartS_3308: bitstring,ST_3309: bitstring,TTL_3310: bitstring) = m2_3307 in
                                    {3415}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3416}event endCli(Sess,Cli,PartS_3308)
                                )
                                else
                                    {3417}let v_3311: bool = (Sess = C) in
                                    (
                                        {3418}if v_3311 then
                                        (
                                            {3419}let pkSess_3312: bitstring = pub(skC) in
                                            {3420}out(c, GetEndpointRequest);
                                            {3421}in(c, (=GetEndpointResponse,=pkSess_3312,=None,SP_3313: bitstring,UP_3314: bitstring));
                                            {3422}new Nc_3315: bitstring;
                                            {3423}let gNc_3316: bitstring = exp(g,Nc_3315) in
                                            {3424}let m1_3317: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3316) in
                                            {3425}event beginCli(Cli,Sess,gNc_3316);
                                            {3426}out(c, (pkCli_2796,m1_3317));
                                            {3427}in(c, em2_3318: bitstring);
                                            {3428}let m2_3319: bitstring = em2_3318 in
                                            {3429}let (=OpenSecureChannelResponse,=Cli,PartS_3320: bitstring,ST_3321: bitstring,TTL_3322: bitstring) = m2_3319 in
                                            {3430}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3431}event endCli(Sess,Cli,PartS_3320)
                                        )
                                        else
                                            {3432}let pkSess_3323: bitstring = pub(sk(Sess)) in
                                            {3433}out(c, GetEndpointRequest);
                                            {3434}in(c, (=GetEndpointResponse,=pkSess_3323,=None,SP_3324: bitstring,UP_3325: bitstring));
                                            {3435}new Nc_3326: bitstring;
                                            {3436}let gNc_3327: bitstring = exp(g,Nc_3326) in
                                            {3437}let m1_3328: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3327) in
                                            {3438}event beginCli(Cli,Sess,gNc_3327);
                                            {3439}out(c, (pkCli_2796,m1_3328));
                                            {3440}in(c, em2_3329: bitstring);
                                            {3441}let m2_3330: bitstring = em2_3329 in
                                            {3442}let (=OpenSecureChannelResponse,=Cli,PartS_3331: bitstring,ST_3332: bitstring,TTL_3333: bitstring) = m2_3330 in
                                            {3443}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3444}event endCli(Sess,Cli,PartS_3331)
                                    )
                                    else
                                        {3445}let pkSess_3334: bitstring = fail-any in
                                        {3446}out(c, GetEndpointRequest);
                                        {3447}in(c, (=GetEndpointResponse,=pkSess_3334,=None,SP_3335: bitstring,UP_3336: bitstring));
                                        {3448}new Nc_3337: bitstring;
                                        {3449}let gNc_3338: bitstring = exp(g,Nc_3337) in
                                        {3450}let m1_3339: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3338) in
                                        {3451}event beginCli(Cli,Sess,gNc_3338);
                                        {3452}out(c, (pkCli_2796,m1_3339));
                                        {3453}in(c, em2_3340: bitstring);
                                        {3454}let m2_3341: bitstring = em2_3340 in
                                        {3455}let (=OpenSecureChannelResponse,=Cli,PartS_3342: bitstring,ST_3343: bitstring,TTL_3344: bitstring) = m2_3341 in
                                        {3456}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3457}event endCli(Sess,Cli,PartS_3342)
                            )
                            else
                                {3458}let pkSess_3345: bitstring = fail-any in
                                {3459}out(c, GetEndpointRequest);
                                {3460}in(c, (=GetEndpointResponse,=pkSess_3345,=None,SP_3346: bitstring,UP_3347: bitstring));
                                {3461}new Nc_3348: bitstring;
                                {3462}let gNc_3349: bitstring = exp(g,Nc_3348) in
                                {3463}let m1_3350: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3349) in
                                {3464}event beginCli(Cli,Sess,gNc_3349);
                                {3465}out(c, (pkCli_2796,m1_3350));
                                {3466}in(c, em2_3351: bitstring);
                                {3467}let m2_3352: bitstring = em2_3351 in
                                {3468}let (=OpenSecureChannelResponse,=Cli,PartS_3353: bitstring,ST_3354: bitstring,TTL_3355: bitstring) = m2_3352 in
                                {3469}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3470}event endCli(Sess,Cli,PartS_3353)
                    )
                    else
                        {3471}let pkSess_3356: bitstring = fail-any in
                        {3472}out(c, GetEndpointRequest);
                        {3473}in(c, (=GetEndpointResponse,=pkSess_3356,=None,SP_3357: bitstring,UP_3358: bitstring));
                        {3474}new Nc_3359: bitstring;
                        {3475}let gNc_3360: bitstring = exp(g,Nc_3359) in
                        {3476}let m1_3361: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2796,gNc_3360) in
                        {3477}event beginCli(Cli,Sess,gNc_3360);
                        {3478}out(c, (pkCli_2796,m1_3361));
                        {3479}in(c, em2_3362: bitstring);
                        {3480}let m2_3363: bitstring = em2_3362 in
                        {3481}let (=OpenSecureChannelResponse,=Cli,PartS_3364: bitstring,ST_3365: bitstring,TTL_3366: bitstring) = m2_3363 in
                        {3482}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3483}event endCli(Sess,Cli,PartS_3364)
    )
    else
        {3484}let skCli_3367: bitstring = fail-any in
        {3485}let pkCli_3368: bitstring = pub(skCli_3367) in
        {3486}let v_3369: bool = (Disco = A) in
        (
            {3487}if v_3369 then
            (
                {3488}let pkDisco_3370: bitstring = pub(skA) in
                {3489}let v_3371: bool = (Sess = A) in
                (
                    {3490}if v_3371 then
                    (
                        {3491}let pkSess_3372: bitstring = pub(skA) in
                        {3492}out(c, GetEndpointRequest);
                        {3493}in(c, (=GetEndpointResponse,=pkSess_3372,=None,SP_3373: bitstring,UP_3374: bitstring));
                        {3494}new Nc_3375: bitstring;
                        {3495}let gNc_3376: bitstring = exp(g,Nc_3375) in
                        {3496}let m1_3377: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3376) in
                        {3497}event beginCli(Cli,Sess,gNc_3376);
                        {3498}out(c, (pkCli_3368,m1_3377));
                        {3499}in(c, em2_3378: bitstring);
                        {3500}let m2_3379: bitstring = em2_3378 in
                        {3501}let (=OpenSecureChannelResponse,=Cli,PartS_3380: bitstring,ST_3381: bitstring,TTL_3382: bitstring) = m2_3379 in
                        {3502}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {3503}event endCli(Sess,Cli,PartS_3380)
                    )
                    else
                        {3504}let v_3383: bool = (Sess = B) in
                        (
                            {3505}if v_3383 then
                            (
                                {3506}let pkSess_3384: bitstring = pub(skB) in
                                {3507}out(c, GetEndpointRequest);
                                {3508}in(c, (=GetEndpointResponse,=pkSess_3384,=None,SP_3385: bitstring,UP_3386: bitstring));
                                {3509}new Nc_3387: bitstring;
                                {3510}let gNc_3388: bitstring = exp(g,Nc_3387) in
                                {3511}let m1_3389: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3388) in
                                {3512}event beginCli(Cli,Sess,gNc_3388);
                                {3513}out(c, (pkCli_3368,m1_3389));
                                {3514}in(c, em2_3390: bitstring);
                                {3515}let m2_3391: bitstring = em2_3390 in
                                {3516}let (=OpenSecureChannelResponse,=Cli,PartS_3392: bitstring,ST_3393: bitstring,TTL_3394: bitstring) = m2_3391 in
                                {3517}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3518}event endCli(Sess,Cli,PartS_3392)
                            )
                            else
                                {3519}let v_3395: bool = (Sess = C) in
                                (
                                    {3520}if v_3395 then
                                    (
                                        {3521}let pkSess_3396: bitstring = pub(skC) in
                                        {3522}out(c, GetEndpointRequest);
                                        {3523}in(c, (=GetEndpointResponse,=pkSess_3396,=None,SP_3397: bitstring,UP_3398: bitstring));
                                        {3524}new Nc_3399: bitstring;
                                        {3525}let gNc_3400: bitstring = exp(g,Nc_3399) in
                                        {3526}let m1_3401: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3400) in
                                        {3527}event beginCli(Cli,Sess,gNc_3400);
                                        {3528}out(c, (pkCli_3368,m1_3401));
                                        {3529}in(c, em2_3402: bitstring);
                                        {3530}let m2_3403: bitstring = em2_3402 in
                                        {3531}let (=OpenSecureChannelResponse,=Cli,PartS_3404: bitstring,ST_3405: bitstring,TTL_3406: bitstring) = m2_3403 in
                                        {3532}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3533}event endCli(Sess,Cli,PartS_3404)
                                    )
                                    else
                                        {3534}let pkSess_3407: bitstring = pub(sk(Sess)) in
                                        {3535}out(c, GetEndpointRequest);
                                        {3536}in(c, (=GetEndpointResponse,=pkSess_3407,=None,SP_3408: bitstring,UP_3409: bitstring));
                                        {3537}new Nc_3410: bitstring;
                                        {3538}let gNc_3411: bitstring = exp(g,Nc_3410) in
                                        {3539}let m1_3412: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3411) in
                                        {3540}event beginCli(Cli,Sess,gNc_3411);
                                        {3541}out(c, (pkCli_3368,m1_3412));
                                        {3542}in(c, em2_3413: bitstring);
                                        {3543}let m2_3414: bitstring = em2_3413 in
                                        {3544}let (=OpenSecureChannelResponse,=Cli,PartS_3415: bitstring,ST_3416: bitstring,TTL_3417: bitstring) = m2_3414 in
                                        {3545}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3546}event endCli(Sess,Cli,PartS_3415)
                                )
                                else
                                    {3547}let pkSess_3418: bitstring = fail-any in
                                    {3548}out(c, GetEndpointRequest);
                                    {3549}in(c, (=GetEndpointResponse,=pkSess_3418,=None,SP_3419: bitstring,UP_3420: bitstring));
                                    {3550}new Nc_3421: bitstring;
                                    {3551}let gNc_3422: bitstring = exp(g,Nc_3421) in
                                    {3552}let m1_3423: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3422) in
                                    {3553}event beginCli(Cli,Sess,gNc_3422);
                                    {3554}out(c, (pkCli_3368,m1_3423));
                                    {3555}in(c, em2_3424: bitstring);
                                    {3556}let m2_3425: bitstring = em2_3424 in
                                    {3557}let (=OpenSecureChannelResponse,=Cli,PartS_3426: bitstring,ST_3427: bitstring,TTL_3428: bitstring) = m2_3425 in
                                    {3558}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3559}event endCli(Sess,Cli,PartS_3426)
                        )
                        else
                            {3560}let pkSess_3429: bitstring = fail-any in
                            {3561}out(c, GetEndpointRequest);
                            {3562}in(c, (=GetEndpointResponse,=pkSess_3429,=None,SP_3430: bitstring,UP_3431: bitstring));
                            {3563}new Nc_3432: bitstring;
                            {3564}let gNc_3433: bitstring = exp(g,Nc_3432) in
                            {3565}let m1_3434: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3433) in
                            {3566}event beginCli(Cli,Sess,gNc_3433);
                            {3567}out(c, (pkCli_3368,m1_3434));
                            {3568}in(c, em2_3435: bitstring);
                            {3569}let m2_3436: bitstring = em2_3435 in
                            {3570}let (=OpenSecureChannelResponse,=Cli,PartS_3437: bitstring,ST_3438: bitstring,TTL_3439: bitstring) = m2_3436 in
                            {3571}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3572}event endCli(Sess,Cli,PartS_3437)
                )
                else
                    {3573}let pkSess_3440: bitstring = fail-any in
                    {3574}out(c, GetEndpointRequest);
                    {3575}in(c, (=GetEndpointResponse,=pkSess_3440,=None,SP_3441: bitstring,UP_3442: bitstring));
                    {3576}new Nc_3443: bitstring;
                    {3577}let gNc_3444: bitstring = exp(g,Nc_3443) in
                    {3578}let m1_3445: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3444) in
                    {3579}event beginCli(Cli,Sess,gNc_3444);
                    {3580}out(c, (pkCli_3368,m1_3445));
                    {3581}in(c, em2_3446: bitstring);
                    {3582}let m2_3447: bitstring = em2_3446 in
                    {3583}let (=OpenSecureChannelResponse,=Cli,PartS_3448: bitstring,ST_3449: bitstring,TTL_3450: bitstring) = m2_3447 in
                    {3584}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {3585}event endCli(Sess,Cli,PartS_3448)
            )
            else
                {3586}let v_3451: bool = (Disco = B) in
                (
                    {3587}if v_3451 then
                    (
                        {3588}let pkDisco_3452: bitstring = pub(skB) in
                        {3589}let v_3453: bool = (Sess = A) in
                        (
                            {3590}if v_3453 then
                            (
                                {3591}let pkSess_3454: bitstring = pub(skA) in
                                {3592}out(c, GetEndpointRequest);
                                {3593}in(c, (=GetEndpointResponse,=pkSess_3454,=None,SP_3455: bitstring,UP_3456: bitstring));
                                {3594}new Nc_3457: bitstring;
                                {3595}let gNc_3458: bitstring = exp(g,Nc_3457) in
                                {3596}let m1_3459: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3458) in
                                {3597}event beginCli(Cli,Sess,gNc_3458);
                                {3598}out(c, (pkCli_3368,m1_3459));
                                {3599}in(c, em2_3460: bitstring);
                                {3600}let m2_3461: bitstring = em2_3460 in
                                {3601}let (=OpenSecureChannelResponse,=Cli,PartS_3462: bitstring,ST_3463: bitstring,TTL_3464: bitstring) = m2_3461 in
                                {3602}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3603}event endCli(Sess,Cli,PartS_3462)
                            )
                            else
                                {3604}let v_3465: bool = (Sess = B) in
                                (
                                    {3605}if v_3465 then
                                    (
                                        {3606}let pkSess_3466: bitstring = pub(skB) in
                                        {3607}out(c, GetEndpointRequest);
                                        {3608}in(c, (=GetEndpointResponse,=pkSess_3466,=None,SP_3467: bitstring,UP_3468: bitstring));
                                        {3609}new Nc_3469: bitstring;
                                        {3610}let gNc_3470: bitstring = exp(g,Nc_3469) in
                                        {3611}let m1_3471: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3470) in
                                        {3612}event beginCli(Cli,Sess,gNc_3470);
                                        {3613}out(c, (pkCli_3368,m1_3471));
                                        {3614}in(c, em2_3472: bitstring);
                                        {3615}let m2_3473: bitstring = em2_3472 in
                                        {3616}let (=OpenSecureChannelResponse,=Cli,PartS_3474: bitstring,ST_3475: bitstring,TTL_3476: bitstring) = m2_3473 in
                                        {3617}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3618}event endCli(Sess,Cli,PartS_3474)
                                    )
                                    else
                                        {3619}let v_3477: bool = (Sess = C) in
                                        (
                                            {3620}if v_3477 then
                                            (
                                                {3621}let pkSess_3478: bitstring = pub(skC) in
                                                {3622}out(c, GetEndpointRequest);
                                                {3623}in(c, (=GetEndpointResponse,=pkSess_3478,=None,SP_3479: bitstring,UP_3480: bitstring));
                                                {3624}new Nc_3481: bitstring;
                                                {3625}let gNc_3482: bitstring = exp(g,Nc_3481) in
                                                {3626}let m1_3483: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3482) in
                                                {3627}event beginCli(Cli,Sess,gNc_3482);
                                                {3628}out(c, (pkCli_3368,m1_3483));
                                                {3629}in(c, em2_3484: bitstring);
                                                {3630}let m2_3485: bitstring = em2_3484 in
                                                {3631}let (=OpenSecureChannelResponse,=Cli,PartS_3486: bitstring,ST_3487: bitstring,TTL_3488: bitstring) = m2_3485 in
                                                {3632}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3633}event endCli(Sess,Cli,PartS_3486)
                                            )
                                            else
                                                {3634}let pkSess_3489: bitstring = pub(sk(Sess)) in
                                                {3635}out(c, GetEndpointRequest);
                                                {3636}in(c, (=GetEndpointResponse,=pkSess_3489,=None,SP_3490: bitstring,UP_3491: bitstring));
                                                {3637}new Nc_3492: bitstring;
                                                {3638}let gNc_3493: bitstring = exp(g,Nc_3492) in
                                                {3639}let m1_3494: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3493) in
                                                {3640}event beginCli(Cli,Sess,gNc_3493);
                                                {3641}out(c, (pkCli_3368,m1_3494));
                                                {3642}in(c, em2_3495: bitstring);
                                                {3643}let m2_3496: bitstring = em2_3495 in
                                                {3644}let (=OpenSecureChannelResponse,=Cli,PartS_3497: bitstring,ST_3498: bitstring,TTL_3499: bitstring) = m2_3496 in
                                                {3645}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3646}event endCli(Sess,Cli,PartS_3497)
                                        )
                                        else
                                            {3647}let pkSess_3500: bitstring = fail-any in
                                            {3648}out(c, GetEndpointRequest);
                                            {3649}in(c, (=GetEndpointResponse,=pkSess_3500,=None,SP_3501: bitstring,UP_3502: bitstring));
                                            {3650}new Nc_3503: bitstring;
                                            {3651}let gNc_3504: bitstring = exp(g,Nc_3503) in
                                            {3652}let m1_3505: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3504) in
                                            {3653}event beginCli(Cli,Sess,gNc_3504);
                                            {3654}out(c, (pkCli_3368,m1_3505));
                                            {3655}in(c, em2_3506: bitstring);
                                            {3656}let m2_3507: bitstring = em2_3506 in
                                            {3657}let (=OpenSecureChannelResponse,=Cli,PartS_3508: bitstring,ST_3509: bitstring,TTL_3510: bitstring) = m2_3507 in
                                            {3658}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3659}event endCli(Sess,Cli,PartS_3508)
                                )
                                else
                                    {3660}let pkSess_3511: bitstring = fail-any in
                                    {3661}out(c, GetEndpointRequest);
                                    {3662}in(c, (=GetEndpointResponse,=pkSess_3511,=None,SP_3512: bitstring,UP_3513: bitstring));
                                    {3663}new Nc_3514: bitstring;
                                    {3664}let gNc_3515: bitstring = exp(g,Nc_3514) in
                                    {3665}let m1_3516: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3515) in
                                    {3666}event beginCli(Cli,Sess,gNc_3515);
                                    {3667}out(c, (pkCli_3368,m1_3516));
                                    {3668}in(c, em2_3517: bitstring);
                                    {3669}let m2_3518: bitstring = em2_3517 in
                                    {3670}let (=OpenSecureChannelResponse,=Cli,PartS_3519: bitstring,ST_3520: bitstring,TTL_3521: bitstring) = m2_3518 in
                                    {3671}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3672}event endCli(Sess,Cli,PartS_3519)
                        )
                        else
                            {3673}let pkSess_3522: bitstring = fail-any in
                            {3674}out(c, GetEndpointRequest);
                            {3675}in(c, (=GetEndpointResponse,=pkSess_3522,=None,SP_3523: bitstring,UP_3524: bitstring));
                            {3676}new Nc_3525: bitstring;
                            {3677}let gNc_3526: bitstring = exp(g,Nc_3525) in
                            {3678}let m1_3527: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3526) in
                            {3679}event beginCli(Cli,Sess,gNc_3526);
                            {3680}out(c, (pkCli_3368,m1_3527));
                            {3681}in(c, em2_3528: bitstring);
                            {3682}let m2_3529: bitstring = em2_3528 in
                            {3683}let (=OpenSecureChannelResponse,=Cli,PartS_3530: bitstring,ST_3531: bitstring,TTL_3532: bitstring) = m2_3529 in
                            {3684}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3685}event endCli(Sess,Cli,PartS_3530)
                    )
                    else
                        {3686}let v_3533: bool = (Disco = C) in
                        (
                            {3687}if v_3533 then
                            (
                                {3688}let pkDisco_3534: bitstring = pub(skC) in
                                {3689}let v_3535: bool = (Sess = A) in
                                (
                                    {3690}if v_3535 then
                                    (
                                        {3691}let pkSess_3536: bitstring = pub(skA) in
                                        {3692}out(c, GetEndpointRequest);
                                        {3693}in(c, (=GetEndpointResponse,=pkSess_3536,=None,SP_3537: bitstring,UP_3538: bitstring));
                                        {3694}new Nc_3539: bitstring;
                                        {3695}let gNc_3540: bitstring = exp(g,Nc_3539) in
                                        {3696}let m1_3541: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3540) in
                                        {3697}event beginCli(Cli,Sess,gNc_3540);
                                        {3698}out(c, (pkCli_3368,m1_3541));
                                        {3699}in(c, em2_3542: bitstring);
                                        {3700}let m2_3543: bitstring = em2_3542 in
                                        {3701}let (=OpenSecureChannelResponse,=Cli,PartS_3544: bitstring,ST_3545: bitstring,TTL_3546: bitstring) = m2_3543 in
                                        {3702}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3703}event endCli(Sess,Cli,PartS_3544)
                                    )
                                    else
                                        {3704}let v_3547: bool = (Sess = B) in
                                        (
                                            {3705}if v_3547 then
                                            (
                                                {3706}let pkSess_3548: bitstring = pub(skB) in
                                                {3707}out(c, GetEndpointRequest);
                                                {3708}in(c, (=GetEndpointResponse,=pkSess_3548,=None,SP_3549: bitstring,UP_3550: bitstring));
                                                {3709}new Nc_3551: bitstring;
                                                {3710}let gNc_3552: bitstring = exp(g,Nc_3551) in
                                                {3711}let m1_3553: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3552) in
                                                {3712}event beginCli(Cli,Sess,gNc_3552);
                                                {3713}out(c, (pkCli_3368,m1_3553));
                                                {3714}in(c, em2_3554: bitstring);
                                                {3715}let m2_3555: bitstring = em2_3554 in
                                                {3716}let (=OpenSecureChannelResponse,=Cli,PartS_3556: bitstring,ST_3557: bitstring,TTL_3558: bitstring) = m2_3555 in
                                                {3717}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3718}event endCli(Sess,Cli,PartS_3556)
                                            )
                                            else
                                                {3719}let v_3559: bool = (Sess = C) in
                                                (
                                                    {3720}if v_3559 then
                                                    (
                                                        {3721}let pkSess_3560: bitstring = pub(skC) in
                                                        {3722}out(c, GetEndpointRequest);
                                                        {3723}in(c, (=GetEndpointResponse,=pkSess_3560,=None,SP_3561: bitstring,UP_3562: bitstring));
                                                        {3724}new Nc_3563: bitstring;
                                                        {3725}let gNc_3564: bitstring = exp(g,Nc_3563) in
                                                        {3726}let m1_3565: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3564) in
                                                        {3727}event beginCli(Cli,Sess,gNc_3564);
                                                        {3728}out(c, (pkCli_3368,m1_3565));
                                                        {3729}in(c, em2_3566: bitstring);
                                                        {3730}let m2_3567: bitstring = em2_3566 in
                                                        {3731}let (=OpenSecureChannelResponse,=Cli,PartS_3568: bitstring,ST_3569: bitstring,TTL_3570: bitstring) = m2_3567 in
                                                        {3732}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3733}event endCli(Sess,Cli,PartS_3568)
                                                    )
                                                    else
                                                        {3734}let pkSess_3571: bitstring = pub(sk(Sess)) in
                                                        {3735}out(c, GetEndpointRequest);
                                                        {3736}in(c, (=GetEndpointResponse,=pkSess_3571,=None,SP_3572: bitstring,UP_3573: bitstring));
                                                        {3737}new Nc_3574: bitstring;
                                                        {3738}let gNc_3575: bitstring = exp(g,Nc_3574) in
                                                        {3739}let m1_3576: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3575) in
                                                        {3740}event beginCli(Cli,Sess,gNc_3575);
                                                        {3741}out(c, (pkCli_3368,m1_3576));
                                                        {3742}in(c, em2_3577: bitstring);
                                                        {3743}let m2_3578: bitstring = em2_3577 in
                                                        {3744}let (=OpenSecureChannelResponse,=Cli,PartS_3579: bitstring,ST_3580: bitstring,TTL_3581: bitstring) = m2_3578 in
                                                        {3745}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3746}event endCli(Sess,Cli,PartS_3579)
                                                )
                                                else
                                                    {3747}let pkSess_3582: bitstring = fail-any in
                                                    {3748}out(c, GetEndpointRequest);
                                                    {3749}in(c, (=GetEndpointResponse,=pkSess_3582,=None,SP_3583: bitstring,UP_3584: bitstring));
                                                    {3750}new Nc_3585: bitstring;
                                                    {3751}let gNc_3586: bitstring = exp(g,Nc_3585) in
                                                    {3752}let m1_3587: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3586) in
                                                    {3753}event beginCli(Cli,Sess,gNc_3586);
                                                    {3754}out(c, (pkCli_3368,m1_3587));
                                                    {3755}in(c, em2_3588: bitstring);
                                                    {3756}let m2_3589: bitstring = em2_3588 in
                                                    {3757}let (=OpenSecureChannelResponse,=Cli,PartS_3590: bitstring,ST_3591: bitstring,TTL_3592: bitstring) = m2_3589 in
                                                    {3758}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3759}event endCli(Sess,Cli,PartS_3590)
                                        )
                                        else
                                            {3760}let pkSess_3593: bitstring = fail-any in
                                            {3761}out(c, GetEndpointRequest);
                                            {3762}in(c, (=GetEndpointResponse,=pkSess_3593,=None,SP_3594: bitstring,UP_3595: bitstring));
                                            {3763}new Nc_3596: bitstring;
                                            {3764}let gNc_3597: bitstring = exp(g,Nc_3596) in
                                            {3765}let m1_3598: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3597) in
                                            {3766}event beginCli(Cli,Sess,gNc_3597);
                                            {3767}out(c, (pkCli_3368,m1_3598));
                                            {3768}in(c, em2_3599: bitstring);
                                            {3769}let m2_3600: bitstring = em2_3599 in
                                            {3770}let (=OpenSecureChannelResponse,=Cli,PartS_3601: bitstring,ST_3602: bitstring,TTL_3603: bitstring) = m2_3600 in
                                            {3771}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3772}event endCli(Sess,Cli,PartS_3601)
                                )
                                else
                                    {3773}let pkSess_3604: bitstring = fail-any in
                                    {3774}out(c, GetEndpointRequest);
                                    {3775}in(c, (=GetEndpointResponse,=pkSess_3604,=None,SP_3605: bitstring,UP_3606: bitstring));
                                    {3776}new Nc_3607: bitstring;
                                    {3777}let gNc_3608: bitstring = exp(g,Nc_3607) in
                                    {3778}let m1_3609: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3608) in
                                    {3779}event beginCli(Cli,Sess,gNc_3608);
                                    {3780}out(c, (pkCli_3368,m1_3609));
                                    {3781}in(c, em2_3610: bitstring);
                                    {3782}let m2_3611: bitstring = em2_3610 in
                                    {3783}let (=OpenSecureChannelResponse,=Cli,PartS_3612: bitstring,ST_3613: bitstring,TTL_3614: bitstring) = m2_3611 in
                                    {3784}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3785}event endCli(Sess,Cli,PartS_3612)
                            )
                            else
                                {3786}let pkDisco_3615: bitstring = pub(sk(Disco)) in
                                {3787}let v_3616: bool = (Sess = A) in
                                (
                                    {3788}if v_3616 then
                                    (
                                        {3789}let pkSess_3617: bitstring = pub(skA) in
                                        {3790}out(c, GetEndpointRequest);
                                        {3791}in(c, (=GetEndpointResponse,=pkSess_3617,=None,SP_3618: bitstring,UP_3619: bitstring));
                                        {3792}new Nc_3620: bitstring;
                                        {3793}let gNc_3621: bitstring = exp(g,Nc_3620) in
                                        {3794}let m1_3622: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3621) in
                                        {3795}event beginCli(Cli,Sess,gNc_3621);
                                        {3796}out(c, (pkCli_3368,m1_3622));
                                        {3797}in(c, em2_3623: bitstring);
                                        {3798}let m2_3624: bitstring = em2_3623 in
                                        {3799}let (=OpenSecureChannelResponse,=Cli,PartS_3625: bitstring,ST_3626: bitstring,TTL_3627: bitstring) = m2_3624 in
                                        {3800}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3801}event endCli(Sess,Cli,PartS_3625)
                                    )
                                    else
                                        {3802}let v_3628: bool = (Sess = B) in
                                        (
                                            {3803}if v_3628 then
                                            (
                                                {3804}let pkSess_3629: bitstring = pub(skB) in
                                                {3805}out(c, GetEndpointRequest);
                                                {3806}in(c, (=GetEndpointResponse,=pkSess_3629,=None,SP_3630: bitstring,UP_3631: bitstring));
                                                {3807}new Nc_3632: bitstring;
                                                {3808}let gNc_3633: bitstring = exp(g,Nc_3632) in
                                                {3809}let m1_3634: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3633) in
                                                {3810}event beginCli(Cli,Sess,gNc_3633);
                                                {3811}out(c, (pkCli_3368,m1_3634));
                                                {3812}in(c, em2_3635: bitstring);
                                                {3813}let m2_3636: bitstring = em2_3635 in
                                                {3814}let (=OpenSecureChannelResponse,=Cli,PartS_3637: bitstring,ST_3638: bitstring,TTL_3639: bitstring) = m2_3636 in
                                                {3815}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3816}event endCli(Sess,Cli,PartS_3637)
                                            )
                                            else
                                                {3817}let v_3640: bool = (Sess = C) in
                                                (
                                                    {3818}if v_3640 then
                                                    (
                                                        {3819}let pkSess_3641: bitstring = pub(skC) in
                                                        {3820}out(c, GetEndpointRequest);
                                                        {3821}in(c, (=GetEndpointResponse,=pkSess_3641,=None,SP_3642: bitstring,UP_3643: bitstring));
                                                        {3822}new Nc_3644: bitstring;
                                                        {3823}let gNc_3645: bitstring = exp(g,Nc_3644) in
                                                        {3824}let m1_3646: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3645) in
                                                        {3825}event beginCli(Cli,Sess,gNc_3645);
                                                        {3826}out(c, (pkCli_3368,m1_3646));
                                                        {3827}in(c, em2_3647: bitstring);
                                                        {3828}let m2_3648: bitstring = em2_3647 in
                                                        {3829}let (=OpenSecureChannelResponse,=Cli,PartS_3649: bitstring,ST_3650: bitstring,TTL_3651: bitstring) = m2_3648 in
                                                        {3830}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3831}event endCli(Sess,Cli,PartS_3649)
                                                    )
                                                    else
                                                        {3832}let pkSess_3652: bitstring = pub(sk(Sess)) in
                                                        {3833}out(c, GetEndpointRequest);
                                                        {3834}in(c, (=GetEndpointResponse,=pkSess_3652,=None,SP_3653: bitstring,UP_3654: bitstring));
                                                        {3835}new Nc_3655: bitstring;
                                                        {3836}let gNc_3656: bitstring = exp(g,Nc_3655) in
                                                        {3837}let m1_3657: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3656) in
                                                        {3838}event beginCli(Cli,Sess,gNc_3656);
                                                        {3839}out(c, (pkCli_3368,m1_3657));
                                                        {3840}in(c, em2_3658: bitstring);
                                                        {3841}let m2_3659: bitstring = em2_3658 in
                                                        {3842}let (=OpenSecureChannelResponse,=Cli,PartS_3660: bitstring,ST_3661: bitstring,TTL_3662: bitstring) = m2_3659 in
                                                        {3843}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                        {3844}event endCli(Sess,Cli,PartS_3660)
                                                )
                                                else
                                                    {3845}let pkSess_3663: bitstring = fail-any in
                                                    {3846}out(c, GetEndpointRequest);
                                                    {3847}in(c, (=GetEndpointResponse,=pkSess_3663,=None,SP_3664: bitstring,UP_3665: bitstring));
                                                    {3848}new Nc_3666: bitstring;
                                                    {3849}let gNc_3667: bitstring = exp(g,Nc_3666) in
                                                    {3850}let m1_3668: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3667) in
                                                    {3851}event beginCli(Cli,Sess,gNc_3667);
                                                    {3852}out(c, (pkCli_3368,m1_3668));
                                                    {3853}in(c, em2_3669: bitstring);
                                                    {3854}let m2_3670: bitstring = em2_3669 in
                                                    {3855}let (=OpenSecureChannelResponse,=Cli,PartS_3671: bitstring,ST_3672: bitstring,TTL_3673: bitstring) = m2_3670 in
                                                    {3856}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3857}event endCli(Sess,Cli,PartS_3671)
                                        )
                                        else
                                            {3858}let pkSess_3674: bitstring = fail-any in
                                            {3859}out(c, GetEndpointRequest);
                                            {3860}in(c, (=GetEndpointResponse,=pkSess_3674,=None,SP_3675: bitstring,UP_3676: bitstring));
                                            {3861}new Nc_3677: bitstring;
                                            {3862}let gNc_3678: bitstring = exp(g,Nc_3677) in
                                            {3863}let m1_3679: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3678) in
                                            {3864}event beginCli(Cli,Sess,gNc_3678);
                                            {3865}out(c, (pkCli_3368,m1_3679));
                                            {3866}in(c, em2_3680: bitstring);
                                            {3867}let m2_3681: bitstring = em2_3680 in
                                            {3868}let (=OpenSecureChannelResponse,=Cli,PartS_3682: bitstring,ST_3683: bitstring,TTL_3684: bitstring) = m2_3681 in
                                            {3869}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3870}event endCli(Sess,Cli,PartS_3682)
                                )
                                else
                                    {3871}let pkSess_3685: bitstring = fail-any in
                                    {3872}out(c, GetEndpointRequest);
                                    {3873}in(c, (=GetEndpointResponse,=pkSess_3685,=None,SP_3686: bitstring,UP_3687: bitstring));
                                    {3874}new Nc_3688: bitstring;
                                    {3875}let gNc_3689: bitstring = exp(g,Nc_3688) in
                                    {3876}let m1_3690: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3689) in
                                    {3877}event beginCli(Cli,Sess,gNc_3689);
                                    {3878}out(c, (pkCli_3368,m1_3690));
                                    {3879}in(c, em2_3691: bitstring);
                                    {3880}let m2_3692: bitstring = em2_3691 in
                                    {3881}let (=OpenSecureChannelResponse,=Cli,PartS_3693: bitstring,ST_3694: bitstring,TTL_3695: bitstring) = m2_3692 in
                                    {3882}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3883}event endCli(Sess,Cli,PartS_3693)
                        )
                        else
                            {3884}let pkDisco_3696: bitstring = fail-any in
                            {3885}let v_3697: bool = (Sess = A) in
                            (
                                {3886}if v_3697 then
                                (
                                    {3887}let pkSess_3698: bitstring = pub(skA) in
                                    {3888}out(c, GetEndpointRequest);
                                    {3889}in(c, (=GetEndpointResponse,=pkSess_3698,=None,SP_3699: bitstring,UP_3700: bitstring));
                                    {3890}new Nc_3701: bitstring;
                                    {3891}let gNc_3702: bitstring = exp(g,Nc_3701) in
                                    {3892}let m1_3703: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3702) in
                                    {3893}event beginCli(Cli,Sess,gNc_3702);
                                    {3894}out(c, (pkCli_3368,m1_3703));
                                    {3895}in(c, em2_3704: bitstring);
                                    {3896}let m2_3705: bitstring = em2_3704 in
                                    {3897}let (=OpenSecureChannelResponse,=Cli,PartS_3706: bitstring,ST_3707: bitstring,TTL_3708: bitstring) = m2_3705 in
                                    {3898}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {3899}event endCli(Sess,Cli,PartS_3706)
                                )
                                else
                                    {3900}let v_3709: bool = (Sess = B) in
                                    (
                                        {3901}if v_3709 then
                                        (
                                            {3902}let pkSess_3710: bitstring = pub(skB) in
                                            {3903}out(c, GetEndpointRequest);
                                            {3904}in(c, (=GetEndpointResponse,=pkSess_3710,=None,SP_3711: bitstring,UP_3712: bitstring));
                                            {3905}new Nc_3713: bitstring;
                                            {3906}let gNc_3714: bitstring = exp(g,Nc_3713) in
                                            {3907}let m1_3715: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3714) in
                                            {3908}event beginCli(Cli,Sess,gNc_3714);
                                            {3909}out(c, (pkCli_3368,m1_3715));
                                            {3910}in(c, em2_3716: bitstring);
                                            {3911}let m2_3717: bitstring = em2_3716 in
                                            {3912}let (=OpenSecureChannelResponse,=Cli,PartS_3718: bitstring,ST_3719: bitstring,TTL_3720: bitstring) = m2_3717 in
                                            {3913}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {3914}event endCli(Sess,Cli,PartS_3718)
                                        )
                                        else
                                            {3915}let v_3721: bool = (Sess = C) in
                                            (
                                                {3916}if v_3721 then
                                                (
                                                    {3917}let pkSess_3722: bitstring = pub(skC) in
                                                    {3918}out(c, GetEndpointRequest);
                                                    {3919}in(c, (=GetEndpointResponse,=pkSess_3722,=None,SP_3723: bitstring,UP_3724: bitstring));
                                                    {3920}new Nc_3725: bitstring;
                                                    {3921}let gNc_3726: bitstring = exp(g,Nc_3725) in
                                                    {3922}let m1_3727: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3726) in
                                                    {3923}event beginCli(Cli,Sess,gNc_3726);
                                                    {3924}out(c, (pkCli_3368,m1_3727));
                                                    {3925}in(c, em2_3728: bitstring);
                                                    {3926}let m2_3729: bitstring = em2_3728 in
                                                    {3927}let (=OpenSecureChannelResponse,=Cli,PartS_3730: bitstring,ST_3731: bitstring,TTL_3732: bitstring) = m2_3729 in
                                                    {3928}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3929}event endCli(Sess,Cli,PartS_3730)
                                                )
                                                else
                                                    {3930}let pkSess_3733: bitstring = pub(sk(Sess)) in
                                                    {3931}out(c, GetEndpointRequest);
                                                    {3932}in(c, (=GetEndpointResponse,=pkSess_3733,=None,SP_3734: bitstring,UP_3735: bitstring));
                                                    {3933}new Nc_3736: bitstring;
                                                    {3934}let gNc_3737: bitstring = exp(g,Nc_3736) in
                                                    {3935}let m1_3738: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3737) in
                                                    {3936}event beginCli(Cli,Sess,gNc_3737);
                                                    {3937}out(c, (pkCli_3368,m1_3738));
                                                    {3938}in(c, em2_3739: bitstring);
                                                    {3939}let m2_3740: bitstring = em2_3739 in
                                                    {3940}let (=OpenSecureChannelResponse,=Cli,PartS_3741: bitstring,ST_3742: bitstring,TTL_3743: bitstring) = m2_3740 in
                                                    {3941}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                    {3942}event endCli(Sess,Cli,PartS_3741)
                                            )
                                            else
                                                {3943}let pkSess_3744: bitstring = fail-any in
                                                {3944}out(c, GetEndpointRequest);
                                                {3945}in(c, (=GetEndpointResponse,=pkSess_3744,=None,SP_3745: bitstring,UP_3746: bitstring));
                                                {3946}new Nc_3747: bitstring;
                                                {3947}let gNc_3748: bitstring = exp(g,Nc_3747) in
                                                {3948}let m1_3749: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3748) in
                                                {3949}event beginCli(Cli,Sess,gNc_3748);
                                                {3950}out(c, (pkCli_3368,m1_3749));
                                                {3951}in(c, em2_3750: bitstring);
                                                {3952}let m2_3751: bitstring = em2_3750 in
                                                {3953}let (=OpenSecureChannelResponse,=Cli,PartS_3752: bitstring,ST_3753: bitstring,TTL_3754: bitstring) = m2_3751 in
                                                {3954}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                                {3955}event endCli(Sess,Cli,PartS_3752)
                                    )
                                    else
                                        {3956}let pkSess_3755: bitstring = fail-any in
                                        {3957}out(c, GetEndpointRequest);
                                        {3958}in(c, (=GetEndpointResponse,=pkSess_3755,=None,SP_3756: bitstring,UP_3757: bitstring));
                                        {3959}new Nc_3758: bitstring;
                                        {3960}let gNc_3759: bitstring = exp(g,Nc_3758) in
                                        {3961}let m1_3760: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3759) in
                                        {3962}event beginCli(Cli,Sess,gNc_3759);
                                        {3963}out(c, (pkCli_3368,m1_3760));
                                        {3964}in(c, em2_3761: bitstring);
                                        {3965}let m2_3762: bitstring = em2_3761 in
                                        {3966}let (=OpenSecureChannelResponse,=Cli,PartS_3763: bitstring,ST_3764: bitstring,TTL_3765: bitstring) = m2_3762 in
                                        {3967}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {3968}event endCli(Sess,Cli,PartS_3763)
                            )
                            else
                                {3969}let pkSess_3766: bitstring = fail-any in
                                {3970}out(c, GetEndpointRequest);
                                {3971}in(c, (=GetEndpointResponse,=pkSess_3766,=None,SP_3767: bitstring,UP_3768: bitstring));
                                {3972}new Nc_3769: bitstring;
                                {3973}let gNc_3770: bitstring = exp(g,Nc_3769) in
                                {3974}let m1_3771: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3770) in
                                {3975}event beginCli(Cli,Sess,gNc_3770);
                                {3976}out(c, (pkCli_3368,m1_3771));
                                {3977}in(c, em2_3772: bitstring);
                                {3978}let m2_3773: bitstring = em2_3772 in
                                {3979}let (=OpenSecureChannelResponse,=Cli,PartS_3774: bitstring,ST_3775: bitstring,TTL_3776: bitstring) = m2_3773 in
                                {3980}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {3981}event endCli(Sess,Cli,PartS_3774)
                )
                else
                    {3982}let pkDisco_3777: bitstring = fail-any in
                    {3983}let v_3778: bool = (Sess = A) in
                    (
                        {3984}if v_3778 then
                        (
                            {3985}let pkSess_3779: bitstring = pub(skA) in
                            {3986}out(c, GetEndpointRequest);
                            {3987}in(c, (=GetEndpointResponse,=pkSess_3779,=None,SP_3780: bitstring,UP_3781: bitstring));
                            {3988}new Nc_3782: bitstring;
                            {3989}let gNc_3783: bitstring = exp(g,Nc_3782) in
                            {3990}let m1_3784: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3783) in
                            {3991}event beginCli(Cli,Sess,gNc_3783);
                            {3992}out(c, (pkCli_3368,m1_3784));
                            {3993}in(c, em2_3785: bitstring);
                            {3994}let m2_3786: bitstring = em2_3785 in
                            {3995}let (=OpenSecureChannelResponse,=Cli,PartS_3787: bitstring,ST_3788: bitstring,TTL_3789: bitstring) = m2_3786 in
                            {3996}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {3997}event endCli(Sess,Cli,PartS_3787)
                        )
                        else
                            {3998}let v_3790: bool = (Sess = B) in
                            (
                                {3999}if v_3790 then
                                (
                                    {4000}let pkSess_3791: bitstring = pub(skB) in
                                    {4001}out(c, GetEndpointRequest);
                                    {4002}in(c, (=GetEndpointResponse,=pkSess_3791,=None,SP_3792: bitstring,UP_3793: bitstring));
                                    {4003}new Nc_3794: bitstring;
                                    {4004}let gNc_3795: bitstring = exp(g,Nc_3794) in
                                    {4005}let m1_3796: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3795) in
                                    {4006}event beginCli(Cli,Sess,gNc_3795);
                                    {4007}out(c, (pkCli_3368,m1_3796));
                                    {4008}in(c, em2_3797: bitstring);
                                    {4009}let m2_3798: bitstring = em2_3797 in
                                    {4010}let (=OpenSecureChannelResponse,=Cli,PartS_3799: bitstring,ST_3800: bitstring,TTL_3801: bitstring) = m2_3798 in
                                    {4011}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4012}event endCli(Sess,Cli,PartS_3799)
                                )
                                else
                                    {4013}let v_3802: bool = (Sess = C) in
                                    (
                                        {4014}if v_3802 then
                                        (
                                            {4015}let pkSess_3803: bitstring = pub(skC) in
                                            {4016}out(c, GetEndpointRequest);
                                            {4017}in(c, (=GetEndpointResponse,=pkSess_3803,=None,SP_3804: bitstring,UP_3805: bitstring));
                                            {4018}new Nc_3806: bitstring;
                                            {4019}let gNc_3807: bitstring = exp(g,Nc_3806) in
                                            {4020}let m1_3808: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3807) in
                                            {4021}event beginCli(Cli,Sess,gNc_3807);
                                            {4022}out(c, (pkCli_3368,m1_3808));
                                            {4023}in(c, em2_3809: bitstring);
                                            {4024}let m2_3810: bitstring = em2_3809 in
                                            {4025}let (=OpenSecureChannelResponse,=Cli,PartS_3811: bitstring,ST_3812: bitstring,TTL_3813: bitstring) = m2_3810 in
                                            {4026}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4027}event endCli(Sess,Cli,PartS_3811)
                                        )
                                        else
                                            {4028}let pkSess_3814: bitstring = pub(sk(Sess)) in
                                            {4029}out(c, GetEndpointRequest);
                                            {4030}in(c, (=GetEndpointResponse,=pkSess_3814,=None,SP_3815: bitstring,UP_3816: bitstring));
                                            {4031}new Nc_3817: bitstring;
                                            {4032}let gNc_3818: bitstring = exp(g,Nc_3817) in
                                            {4033}let m1_3819: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3818) in
                                            {4034}event beginCli(Cli,Sess,gNc_3818);
                                            {4035}out(c, (pkCli_3368,m1_3819));
                                            {4036}in(c, em2_3820: bitstring);
                                            {4037}let m2_3821: bitstring = em2_3820 in
                                            {4038}let (=OpenSecureChannelResponse,=Cli,PartS_3822: bitstring,ST_3823: bitstring,TTL_3824: bitstring) = m2_3821 in
                                            {4039}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                            {4040}event endCli(Sess,Cli,PartS_3822)
                                    )
                                    else
                                        {4041}let pkSess_3825: bitstring = fail-any in
                                        {4042}out(c, GetEndpointRequest);
                                        {4043}in(c, (=GetEndpointResponse,=pkSess_3825,=None,SP_3826: bitstring,UP_3827: bitstring));
                                        {4044}new Nc_3828: bitstring;
                                        {4045}let gNc_3829: bitstring = exp(g,Nc_3828) in
                                        {4046}let m1_3830: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3829) in
                                        {4047}event beginCli(Cli,Sess,gNc_3829);
                                        {4048}out(c, (pkCli_3368,m1_3830));
                                        {4049}in(c, em2_3831: bitstring);
                                        {4050}let m2_3832: bitstring = em2_3831 in
                                        {4051}let (=OpenSecureChannelResponse,=Cli,PartS_3833: bitstring,ST_3834: bitstring,TTL_3835: bitstring) = m2_3832 in
                                        {4052}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                        {4053}event endCli(Sess,Cli,PartS_3833)
                            )
                            else
                                {4054}let pkSess_3836: bitstring = fail-any in
                                {4055}out(c, GetEndpointRequest);
                                {4056}in(c, (=GetEndpointResponse,=pkSess_3836,=None,SP_3837: bitstring,UP_3838: bitstring));
                                {4057}new Nc_3839: bitstring;
                                {4058}let gNc_3840: bitstring = exp(g,Nc_3839) in
                                {4059}let m1_3841: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3840) in
                                {4060}event beginCli(Cli,Sess,gNc_3840);
                                {4061}out(c, (pkCli_3368,m1_3841));
                                {4062}in(c, em2_3842: bitstring);
                                {4063}let m2_3843: bitstring = em2_3842 in
                                {4064}let (=OpenSecureChannelResponse,=Cli,PartS_3844: bitstring,ST_3845: bitstring,TTL_3846: bitstring) = m2_3843 in
                                {4065}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4066}event endCli(Sess,Cli,PartS_3844)
                    )
                    else
                        {4067}let pkSess_3847: bitstring = fail-any in
                        {4068}out(c, GetEndpointRequest);
                        {4069}in(c, (=GetEndpointResponse,=pkSess_3847,=None,SP_3848: bitstring,UP_3849: bitstring));
                        {4070}new Nc_3850: bitstring;
                        {4071}let gNc_3851: bitstring = exp(g,Nc_3850) in
                        {4072}let m1_3852: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3851) in
                        {4073}event beginCli(Cli,Sess,gNc_3851);
                        {4074}out(c, (pkCli_3368,m1_3852));
                        {4075}in(c, em2_3853: bitstring);
                        {4076}let m2_3854: bitstring = em2_3853 in
                        {4077}let (=OpenSecureChannelResponse,=Cli,PartS_3855: bitstring,ST_3856: bitstring,TTL_3857: bitstring) = m2_3854 in
                        {4078}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4079}event endCli(Sess,Cli,PartS_3855)
        )
        else
            {4080}let pkDisco_3858: bitstring = fail-any in
            {4081}let v_3859: bool = (Sess = A) in
            (
                {4082}if v_3859 then
                (
                    {4083}let pkSess_3860: bitstring = pub(skA) in
                    {4084}out(c, GetEndpointRequest);
                    {4085}in(c, (=GetEndpointResponse,=pkSess_3860,=None,SP_3861: bitstring,UP_3862: bitstring));
                    {4086}new Nc_3863: bitstring;
                    {4087}let gNc_3864: bitstring = exp(g,Nc_3863) in
                    {4088}let m1_3865: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3864) in
                    {4089}event beginCli(Cli,Sess,gNc_3864);
                    {4090}out(c, (pkCli_3368,m1_3865));
                    {4091}in(c, em2_3866: bitstring);
                    {4092}let m2_3867: bitstring = em2_3866 in
                    {4093}let (=OpenSecureChannelResponse,=Cli,PartS_3868: bitstring,ST_3869: bitstring,TTL_3870: bitstring) = m2_3867 in
                    {4094}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                    {4095}event endCli(Sess,Cli,PartS_3868)
                )
                else
                    {4096}let v_3871: bool = (Sess = B) in
                    (
                        {4097}if v_3871 then
                        (
                            {4098}let pkSess_3872: bitstring = pub(skB) in
                            {4099}out(c, GetEndpointRequest);
                            {4100}in(c, (=GetEndpointResponse,=pkSess_3872,=None,SP_3873: bitstring,UP_3874: bitstring));
                            {4101}new Nc_3875: bitstring;
                            {4102}let gNc_3876: bitstring = exp(g,Nc_3875) in
                            {4103}let m1_3877: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3876) in
                            {4104}event beginCli(Cli,Sess,gNc_3876);
                            {4105}out(c, (pkCli_3368,m1_3877));
                            {4106}in(c, em2_3878: bitstring);
                            {4107}let m2_3879: bitstring = em2_3878 in
                            {4108}let (=OpenSecureChannelResponse,=Cli,PartS_3880: bitstring,ST_3881: bitstring,TTL_3882: bitstring) = m2_3879 in
                            {4109}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                            {4110}event endCli(Sess,Cli,PartS_3880)
                        )
                        else
                            {4111}let v_3883: bool = (Sess = C) in
                            (
                                {4112}if v_3883 then
                                (
                                    {4113}let pkSess_3884: bitstring = pub(skC) in
                                    {4114}out(c, GetEndpointRequest);
                                    {4115}in(c, (=GetEndpointResponse,=pkSess_3884,=None,SP_3885: bitstring,UP_3886: bitstring));
                                    {4116}new Nc_3887: bitstring;
                                    {4117}let gNc_3888: bitstring = exp(g,Nc_3887) in
                                    {4118}let m1_3889: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3888) in
                                    {4119}event beginCli(Cli,Sess,gNc_3888);
                                    {4120}out(c, (pkCli_3368,m1_3889));
                                    {4121}in(c, em2_3890: bitstring);
                                    {4122}let m2_3891: bitstring = em2_3890 in
                                    {4123}let (=OpenSecureChannelResponse,=Cli,PartS_3892: bitstring,ST_3893: bitstring,TTL_3894: bitstring) = m2_3891 in
                                    {4124}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4125}event endCli(Sess,Cli,PartS_3892)
                                )
                                else
                                    {4126}let pkSess_3895: bitstring = pub(sk(Sess)) in
                                    {4127}out(c, GetEndpointRequest);
                                    {4128}in(c, (=GetEndpointResponse,=pkSess_3895,=None,SP_3896: bitstring,UP_3897: bitstring));
                                    {4129}new Nc_3898: bitstring;
                                    {4130}let gNc_3899: bitstring = exp(g,Nc_3898) in
                                    {4131}let m1_3900: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3899) in
                                    {4132}event beginCli(Cli,Sess,gNc_3899);
                                    {4133}out(c, (pkCli_3368,m1_3900));
                                    {4134}in(c, em2_3901: bitstring);
                                    {4135}let m2_3902: bitstring = em2_3901 in
                                    {4136}let (=OpenSecureChannelResponse,=Cli,PartS_3903: bitstring,ST_3904: bitstring,TTL_3905: bitstring) = m2_3902 in
                                    {4137}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                    {4138}event endCli(Sess,Cli,PartS_3903)
                            )
                            else
                                {4139}let pkSess_3906: bitstring = fail-any in
                                {4140}out(c, GetEndpointRequest);
                                {4141}in(c, (=GetEndpointResponse,=pkSess_3906,=None,SP_3907: bitstring,UP_3908: bitstring));
                                {4142}new Nc_3909: bitstring;
                                {4143}let gNc_3910: bitstring = exp(g,Nc_3909) in
                                {4144}let m1_3911: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3910) in
                                {4145}event beginCli(Cli,Sess,gNc_3910);
                                {4146}out(c, (pkCli_3368,m1_3911));
                                {4147}in(c, em2_3912: bitstring);
                                {4148}let m2_3913: bitstring = em2_3912 in
                                {4149}let (=OpenSecureChannelResponse,=Cli,PartS_3914: bitstring,ST_3915: bitstring,TTL_3916: bitstring) = m2_3913 in
                                {4150}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                                {4151}event endCli(Sess,Cli,PartS_3914)
                    )
                    else
                        {4152}let pkSess_3917: bitstring = fail-any in
                        {4153}out(c, GetEndpointRequest);
                        {4154}in(c, (=GetEndpointResponse,=pkSess_3917,=None,SP_3918: bitstring,UP_3919: bitstring));
                        {4155}new Nc_3920: bitstring;
                        {4156}let gNc_3921: bitstring = exp(g,Nc_3920) in
                        {4157}let m1_3922: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3921) in
                        {4158}event beginCli(Cli,Sess,gNc_3921);
                        {4159}out(c, (pkCli_3368,m1_3922));
                        {4160}in(c, em2_3923: bitstring);
                        {4161}let m2_3924: bitstring = em2_3923 in
                        {4162}let (=OpenSecureChannelResponse,=Cli,PartS_3925: bitstring,ST_3926: bitstring,TTL_3927: bitstring) = m2_3924 in
                        {4163}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                        {4164}event endCli(Sess,Cli,PartS_3925)
            )
            else
                {4165}let pkSess_3928: bitstring = fail-any in
                {4166}out(c, GetEndpointRequest);
                {4167}in(c, (=GetEndpointResponse,=pkSess_3928,=None,SP_3929: bitstring,UP_3930: bitstring));
                {4168}new Nc_3931: bitstring;
                {4169}let gNc_3932: bitstring = exp(g,Nc_3931) in
                {4170}let m1_3933: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3368,gNc_3932) in
                {4171}event beginCli(Cli,Sess,gNc_3932);
                {4172}out(c, (pkCli_3368,m1_3933));
                {4173}in(c, em2_3934: bitstring);
                {4174}let m2_3935: bitstring = em2_3934 in
                {4175}let (=OpenSecureChannelResponse,=Cli,PartS_3936: bitstring,ST_3937: bitstring,TTL_3938: bitstring) = m2_3935 in
                {4176}if ((Sess = A) || ((Sess = B) || (Sess = C))) then
                {4177}event endCli(Sess,Cli,PartS_3936)
) | (
    {4178}!
    {4179}in(c, (Cli_3939: host,Disco_3940: host,Sess_3941: host));
    {4180}let v_3942: bool = (Disco_3940 = A) in
    (
        {4181}if v_3942 then
        (
            {4182}let skDisco: bitstring = skA in
            {4183}let pkDisco_3943: bitstring = pub(skDisco) in
            {4184}let v_3944: bool = (Cli_3939 = A) in
            (
                {4185}if v_3944 then
                (
                    {4186}let pkCli_3945: bitstring = pub(skA) in
                    {4187}let v_3946: bool = (Sess_3941 = A) in
                    (
                        {4188}if v_3946 then
                        (
                            {4189}let pkSess_3947: bitstring = pub(skA) in
                            {4190}in(c, =GetEndpointRequest);
                            {4191}new SP_3948: bitstring;
                            {4192}new UP_3949: bitstring;
                            {4193}out(c, (GetEndpointResponse,pkSess_3947,SignAndEncrypt,SP_3948,UP_3949))
                        )
                        else
                            {4194}let v_3950: bool = (Sess_3941 = B) in
                            (
                                {4195}if v_3950 then
                                (
                                    {4196}let pkSess_3951: bitstring = pub(skB) in
                                    {4197}in(c, =GetEndpointRequest);
                                    {4198}new SP_3952: bitstring;
                                    {4199}new UP_3953: bitstring;
                                    {4200}out(c, (GetEndpointResponse,pkSess_3951,SignAndEncrypt,SP_3952,UP_3953))
                                )
                                else
                                    {4201}let v_3954: bool = (Sess_3941 = C) in
                                    (
                                        {4202}if v_3954 then
                                        (
                                            {4203}let pkSess_3955: bitstring = pub(skC) in
                                            {4204}in(c, =GetEndpointRequest);
                                            {4205}new SP_3956: bitstring;
                                            {4206}new UP_3957: bitstring;
                                            {4207}out(c, (GetEndpointResponse,pkSess_3955,SignAndEncrypt,SP_3956,UP_3957))
                                        )
                                        else
                                            {4208}let pkSess_3958: bitstring = pub(sk(Sess_3941)) in
                                            {4209}in(c, =GetEndpointRequest);
                                            {4210}new SP_3959: bitstring;
                                            {4211}new UP_3960: bitstring;
                                            {4212}out(c, (GetEndpointResponse,pkSess_3958,SignAndEncrypt,SP_3959,UP_3960))
                                    )
                                    else
                                        {4213}let pkSess_3961: bitstring = fail-any in
                                        {4214}in(c, =GetEndpointRequest);
                                        {4215}new SP_3962: bitstring;
                                        {4216}new UP_3963: bitstring;
                                        {4217}out(c, (GetEndpointResponse,pkSess_3961,SignAndEncrypt,SP_3962,UP_3963))
                            )
                            else
                                {4218}let pkSess_3964: bitstring = fail-any in
                                {4219}in(c, =GetEndpointRequest);
                                {4220}new SP_3965: bitstring;
                                {4221}new UP_3966: bitstring;
                                {4222}out(c, (GetEndpointResponse,pkSess_3964,SignAndEncrypt,SP_3965,UP_3966))
                    )
                    else
                        {4223}let pkSess_3967: bitstring = fail-any in
                        {4224}in(c, =GetEndpointRequest);
                        {4225}new SP_3968: bitstring;
                        {4226}new UP_3969: bitstring;
                        {4227}out(c, (GetEndpointResponse,pkSess_3967,SignAndEncrypt,SP_3968,UP_3969))
                )
                else
                    {4228}let v_3970: bool = (Cli_3939 = B) in
                    (
                        {4229}if v_3970 then
                        (
                            {4230}let pkCli_3971: bitstring = pub(skB) in
                            {4231}let v_3972: bool = (Sess_3941 = A) in
                            (
                                {4232}if v_3972 then
                                (
                                    {4233}let pkSess_3973: bitstring = pub(skA) in
                                    {4234}in(c, =GetEndpointRequest);
                                    {4235}new SP_3974: bitstring;
                                    {4236}new UP_3975: bitstring;
                                    {4237}out(c, (GetEndpointResponse,pkSess_3973,SignAndEncrypt,SP_3974,UP_3975))
                                )
                                else
                                    {4238}let v_3976: bool = (Sess_3941 = B) in
                                    (
                                        {4239}if v_3976 then
                                        (
                                            {4240}let pkSess_3977: bitstring = pub(skB) in
                                            {4241}in(c, =GetEndpointRequest);
                                            {4242}new SP_3978: bitstring;
                                            {4243}new UP_3979: bitstring;
                                            {4244}out(c, (GetEndpointResponse,pkSess_3977,SignAndEncrypt,SP_3978,UP_3979))
                                        )
                                        else
                                            {4245}let v_3980: bool = (Sess_3941 = C) in
                                            (
                                                {4246}if v_3980 then
                                                (
                                                    {4247}let pkSess_3981: bitstring = pub(skC) in
                                                    {4248}in(c, =GetEndpointRequest);
                                                    {4249}new SP_3982: bitstring;
                                                    {4250}new UP_3983: bitstring;
                                                    {4251}out(c, (GetEndpointResponse,pkSess_3981,SignAndEncrypt,SP_3982,UP_3983))
                                                )
                                                else
                                                    {4252}let pkSess_3984: bitstring = pub(sk(Sess_3941)) in
                                                    {4253}in(c, =GetEndpointRequest);
                                                    {4254}new SP_3985: bitstring;
                                                    {4255}new UP_3986: bitstring;
                                                    {4256}out(c, (GetEndpointResponse,pkSess_3984,SignAndEncrypt,SP_3985,UP_3986))
                                            )
                                            else
                                                {4257}let pkSess_3987: bitstring = fail-any in
                                                {4258}in(c, =GetEndpointRequest);
                                                {4259}new SP_3988: bitstring;
                                                {4260}new UP_3989: bitstring;
                                                {4261}out(c, (GetEndpointResponse,pkSess_3987,SignAndEncrypt,SP_3988,UP_3989))
                                    )
                                    else
                                        {4262}let pkSess_3990: bitstring = fail-any in
                                        {4263}in(c, =GetEndpointRequest);
                                        {4264}new SP_3991: bitstring;
                                        {4265}new UP_3992: bitstring;
                                        {4266}out(c, (GetEndpointResponse,pkSess_3990,SignAndEncrypt,SP_3991,UP_3992))
                            )
                            else
                                {4267}let pkSess_3993: bitstring = fail-any in
                                {4268}in(c, =GetEndpointRequest);
                                {4269}new SP_3994: bitstring;
                                {4270}new UP_3995: bitstring;
                                {4271}out(c, (GetEndpointResponse,pkSess_3993,SignAndEncrypt,SP_3994,UP_3995))
                        )
                        else
                            {4272}let v_3996: bool = (Cli_3939 = C) in
                            (
                                {4273}if v_3996 then
                                (
                                    {4274}let pkCli_3997: bitstring = pub(skC) in
                                    {4275}let v_3998: bool = (Sess_3941 = A) in
                                    (
                                        {4276}if v_3998 then
                                        (
                                            {4277}let pkSess_3999: bitstring = pub(skA) in
                                            {4278}in(c, =GetEndpointRequest);
                                            {4279}new SP_4000: bitstring;
                                            {4280}new UP_4001: bitstring;
                                            {4281}out(c, (GetEndpointResponse,pkSess_3999,SignAndEncrypt,SP_4000,UP_4001))
                                        )
                                        else
                                            {4282}let v_4002: bool = (Sess_3941 = B) in
                                            (
                                                {4283}if v_4002 then
                                                (
                                                    {4284}let pkSess_4003: bitstring = pub(skB) in
                                                    {4285}in(c, =GetEndpointRequest);
                                                    {4286}new SP_4004: bitstring;
                                                    {4287}new UP_4005: bitstring;
                                                    {4288}out(c, (GetEndpointResponse,pkSess_4003,SignAndEncrypt,SP_4004,UP_4005))
                                                )
                                                else
                                                    {4289}let v_4006: bool = (Sess_3941 = C) in
                                                    (
                                                        {4290}if v_4006 then
                                                        (
                                                            {4291}let pkSess_4007: bitstring = pub(skC) in
                                                            {4292}in(c, =GetEndpointRequest);
                                                            {4293}new SP_4008: bitstring;
                                                            {4294}new UP_4009: bitstring;
                                                            {4295}out(c, (GetEndpointResponse,pkSess_4007,SignAndEncrypt,SP_4008,UP_4009))
                                                        )
                                                        else
                                                            {4296}let pkSess_4010: bitstring = pub(sk(Sess_3941)) in
                                                            {4297}in(c, =GetEndpointRequest);
                                                            {4298}new SP_4011: bitstring;
                                                            {4299}new UP_4012: bitstring;
                                                            {4300}out(c, (GetEndpointResponse,pkSess_4010,SignAndEncrypt,SP_4011,UP_4012))
                                                    )
                                                    else
                                                        {4301}let pkSess_4013: bitstring = fail-any in
                                                        {4302}in(c, =GetEndpointRequest);
                                                        {4303}new SP_4014: bitstring;
                                                        {4304}new UP_4015: bitstring;
                                                        {4305}out(c, (GetEndpointResponse,pkSess_4013,SignAndEncrypt,SP_4014,UP_4015))
                                            )
                                            else
                                                {4306}let pkSess_4016: bitstring = fail-any in
                                                {4307}in(c, =GetEndpointRequest);
                                                {4308}new SP_4017: bitstring;
                                                {4309}new UP_4018: bitstring;
                                                {4310}out(c, (GetEndpointResponse,pkSess_4016,SignAndEncrypt,SP_4017,UP_4018))
                                    )
                                    else
                                        {4311}let pkSess_4019: bitstring = fail-any in
                                        {4312}in(c, =GetEndpointRequest);
                                        {4313}new SP_4020: bitstring;
                                        {4314}new UP_4021: bitstring;
                                        {4315}out(c, (GetEndpointResponse,pkSess_4019,SignAndEncrypt,SP_4020,UP_4021))
                                )
                                else
                                    {4316}let pkCli_4022: bitstring = pub(sk(Cli_3939)) in
                                    {4317}let v_4023: bool = (Sess_3941 = A) in
                                    (
                                        {4318}if v_4023 then
                                        (
                                            {4319}let pkSess_4024: bitstring = pub(skA) in
                                            {4320}in(c, =GetEndpointRequest);
                                            {4321}new SP_4025: bitstring;
                                            {4322}new UP_4026: bitstring;
                                            {4323}out(c, (GetEndpointResponse,pkSess_4024,SignAndEncrypt,SP_4025,UP_4026))
                                        )
                                        else
                                            {4324}let v_4027: bool = (Sess_3941 = B) in
                                            (
                                                {4325}if v_4027 then
                                                (
                                                    {4326}let pkSess_4028: bitstring = pub(skB) in
                                                    {4327}in(c, =GetEndpointRequest);
                                                    {4328}new SP_4029: bitstring;
                                                    {4329}new UP_4030: bitstring;
                                                    {4330}out(c, (GetEndpointResponse,pkSess_4028,SignAndEncrypt,SP_4029,UP_4030))
                                                )
                                                else
                                                    {4331}let v_4031: bool = (Sess_3941 = C) in
                                                    (
                                                        {4332}if v_4031 then
                                                        (
                                                            {4333}let pkSess_4032: bitstring = pub(skC) in
                                                            {4334}in(c, =GetEndpointRequest);
                                                            {4335}new SP_4033: bitstring;
                                                            {4336}new UP_4034: bitstring;
                                                            {4337}out(c, (GetEndpointResponse,pkSess_4032,SignAndEncrypt,SP_4033,UP_4034))
                                                        )
                                                        else
                                                            {4338}let pkSess_4035: bitstring = pub(sk(Sess_3941)) in
                                                            {4339}in(c, =GetEndpointRequest);
                                                            {4340}new SP_4036: bitstring;
                                                            {4341}new UP_4037: bitstring;
                                                            {4342}out(c, (GetEndpointResponse,pkSess_4035,SignAndEncrypt,SP_4036,UP_4037))
                                                    )
                                                    else
                                                        {4343}let pkSess_4038: bitstring = fail-any in
                                                        {4344}in(c, =GetEndpointRequest);
                                                        {4345}new SP_4039: bitstring;
                                                        {4346}new UP_4040: bitstring;
                                                        {4347}out(c, (GetEndpointResponse,pkSess_4038,SignAndEncrypt,SP_4039,UP_4040))
                                            )
                                            else
                                                {4348}let pkSess_4041: bitstring = fail-any in
                                                {4349}in(c, =GetEndpointRequest);
                                                {4350}new SP_4042: bitstring;
                                                {4351}new UP_4043: bitstring;
                                                {4352}out(c, (GetEndpointResponse,pkSess_4041,SignAndEncrypt,SP_4042,UP_4043))
                                    )
                                    else
                                        {4353}let pkSess_4044: bitstring = fail-any in
                                        {4354}in(c, =GetEndpointRequest);
                                        {4355}new SP_4045: bitstring;
                                        {4356}new UP_4046: bitstring;
                                        {4357}out(c, (GetEndpointResponse,pkSess_4044,SignAndEncrypt,SP_4045,UP_4046))
                            )
                            else
                                {4358}let pkCli_4047: bitstring = fail-any in
                                {4359}let v_4048: bool = (Sess_3941 = A) in
                                (
                                    {4360}if v_4048 then
                                    (
                                        {4361}let pkSess_4049: bitstring = pub(skA) in
                                        {4362}in(c, =GetEndpointRequest);
                                        {4363}new SP_4050: bitstring;
                                        {4364}new UP_4051: bitstring;
                                        {4365}out(c, (GetEndpointResponse,pkSess_4049,SignAndEncrypt,SP_4050,UP_4051))
                                    )
                                    else
                                        {4366}let v_4052: bool = (Sess_3941 = B) in
                                        (
                                            {4367}if v_4052 then
                                            (
                                                {4368}let pkSess_4053: bitstring = pub(skB) in
                                                {4369}in(c, =GetEndpointRequest);
                                                {4370}new SP_4054: bitstring;
                                                {4371}new UP_4055: bitstring;
                                                {4372}out(c, (GetEndpointResponse,pkSess_4053,SignAndEncrypt,SP_4054,UP_4055))
                                            )
                                            else
                                                {4373}let v_4056: bool = (Sess_3941 = C) in
                                                (
                                                    {4374}if v_4056 then
                                                    (
                                                        {4375}let pkSess_4057: bitstring = pub(skC) in
                                                        {4376}in(c, =GetEndpointRequest);
                                                        {4377}new SP_4058: bitstring;
                                                        {4378}new UP_4059: bitstring;
                                                        {4379}out(c, (GetEndpointResponse,pkSess_4057,SignAndEncrypt,SP_4058,UP_4059))
                                                    )
                                                    else
                                                        {4380}let pkSess_4060: bitstring = pub(sk(Sess_3941)) in
                                                        {4381}in(c, =GetEndpointRequest);
                                                        {4382}new SP_4061: bitstring;
                                                        {4383}new UP_4062: bitstring;
                                                        {4384}out(c, (GetEndpointResponse,pkSess_4060,SignAndEncrypt,SP_4061,UP_4062))
                                                )
                                                else
                                                    {4385}let pkSess_4063: bitstring = fail-any in
                                                    {4386}in(c, =GetEndpointRequest);
                                                    {4387}new SP_4064: bitstring;
                                                    {4388}new UP_4065: bitstring;
                                                    {4389}out(c, (GetEndpointResponse,pkSess_4063,SignAndEncrypt,SP_4064,UP_4065))
                                        )
                                        else
                                            {4390}let pkSess_4066: bitstring = fail-any in
                                            {4391}in(c, =GetEndpointRequest);
                                            {4392}new SP_4067: bitstring;
                                            {4393}new UP_4068: bitstring;
                                            {4394}out(c, (GetEndpointResponse,pkSess_4066,SignAndEncrypt,SP_4067,UP_4068))
                                )
                                else
                                    {4395}let pkSess_4069: bitstring = fail-any in
                                    {4396}in(c, =GetEndpointRequest);
                                    {4397}new SP_4070: bitstring;
                                    {4398}new UP_4071: bitstring;
                                    {4399}out(c, (GetEndpointResponse,pkSess_4069,SignAndEncrypt,SP_4070,UP_4071))
                    )
                    else
                        {4400}let pkCli_4072: bitstring = fail-any in
                        {4401}let v_4073: bool = (Sess_3941 = A) in
                        (
                            {4402}if v_4073 then
                            (
                                {4403}let pkSess_4074: bitstring = pub(skA) in
                                {4404}in(c, =GetEndpointRequest);
                                {4405}new SP_4075: bitstring;
                                {4406}new UP_4076: bitstring;
                                {4407}out(c, (GetEndpointResponse,pkSess_4074,SignAndEncrypt,SP_4075,UP_4076))
                            )
                            else
                                {4408}let v_4077: bool = (Sess_3941 = B) in
                                (
                                    {4409}if v_4077 then
                                    (
                                        {4410}let pkSess_4078: bitstring = pub(skB) in
                                        {4411}in(c, =GetEndpointRequest);
                                        {4412}new SP_4079: bitstring;
                                        {4413}new UP_4080: bitstring;
                                        {4414}out(c, (GetEndpointResponse,pkSess_4078,SignAndEncrypt,SP_4079,UP_4080))
                                    )
                                    else
                                        {4415}let v_4081: bool = (Sess_3941 = C) in
                                        (
                                            {4416}if v_4081 then
                                            (
                                                {4417}let pkSess_4082: bitstring = pub(skC) in
                                                {4418}in(c, =GetEndpointRequest);
                                                {4419}new SP_4083: bitstring;
                                                {4420}new UP_4084: bitstring;
                                                {4421}out(c, (GetEndpointResponse,pkSess_4082,SignAndEncrypt,SP_4083,UP_4084))
                                            )
                                            else
                                                {4422}let pkSess_4085: bitstring = pub(sk(Sess_3941)) in
                                                {4423}in(c, =GetEndpointRequest);
                                                {4424}new SP_4086: bitstring;
                                                {4425}new UP_4087: bitstring;
                                                {4426}out(c, (GetEndpointResponse,pkSess_4085,SignAndEncrypt,SP_4086,UP_4087))
                                        )
                                        else
                                            {4427}let pkSess_4088: bitstring = fail-any in
                                            {4428}in(c, =GetEndpointRequest);
                                            {4429}new SP_4089: bitstring;
                                            {4430}new UP_4090: bitstring;
                                            {4431}out(c, (GetEndpointResponse,pkSess_4088,SignAndEncrypt,SP_4089,UP_4090))
                                )
                                else
                                    {4432}let pkSess_4091: bitstring = fail-any in
                                    {4433}in(c, =GetEndpointRequest);
                                    {4434}new SP_4092: bitstring;
                                    {4435}new UP_4093: bitstring;
                                    {4436}out(c, (GetEndpointResponse,pkSess_4091,SignAndEncrypt,SP_4092,UP_4093))
                        )
                        else
                            {4437}let pkSess_4094: bitstring = fail-any in
                            {4438}in(c, =GetEndpointRequest);
                            {4439}new SP_4095: bitstring;
                            {4440}new UP_4096: bitstring;
                            {4441}out(c, (GetEndpointResponse,pkSess_4094,SignAndEncrypt,SP_4095,UP_4096))
            )
            else
                {4442}let pkCli_4097: bitstring = fail-any in
                {4443}let v_4098: bool = (Sess_3941 = A) in
                (
                    {4444}if v_4098 then
                    (
                        {4445}let pkSess_4099: bitstring = pub(skA) in
                        {4446}in(c, =GetEndpointRequest);
                        {4447}new SP_4100: bitstring;
                        {4448}new UP_4101: bitstring;
                        {4449}out(c, (GetEndpointResponse,pkSess_4099,SignAndEncrypt,SP_4100,UP_4101))
                    )
                    else
                        {4450}let v_4102: bool = (Sess_3941 = B) in
                        (
                            {4451}if v_4102 then
                            (
                                {4452}let pkSess_4103: bitstring = pub(skB) in
                                {4453}in(c, =GetEndpointRequest);
                                {4454}new SP_4104: bitstring;
                                {4455}new UP_4105: bitstring;
                                {4456}out(c, (GetEndpointResponse,pkSess_4103,SignAndEncrypt,SP_4104,UP_4105))
                            )
                            else
                                {4457}let v_4106: bool = (Sess_3941 = C) in
                                (
                                    {4458}if v_4106 then
                                    (
                                        {4459}let pkSess_4107: bitstring = pub(skC) in
                                        {4460}in(c, =GetEndpointRequest);
                                        {4461}new SP_4108: bitstring;
                                        {4462}new UP_4109: bitstring;
                                        {4463}out(c, (GetEndpointResponse,pkSess_4107,SignAndEncrypt,SP_4108,UP_4109))
                                    )
                                    else
                                        {4464}let pkSess_4110: bitstring = pub(sk(Sess_3941)) in
                                        {4465}in(c, =GetEndpointRequest);
                                        {4466}new SP_4111: bitstring;
                                        {4467}new UP_4112: bitstring;
                                        {4468}out(c, (GetEndpointResponse,pkSess_4110,SignAndEncrypt,SP_4111,UP_4112))
                                )
                                else
                                    {4469}let pkSess_4113: bitstring = fail-any in
                                    {4470}in(c, =GetEndpointRequest);
                                    {4471}new SP_4114: bitstring;
                                    {4472}new UP_4115: bitstring;
                                    {4473}out(c, (GetEndpointResponse,pkSess_4113,SignAndEncrypt,SP_4114,UP_4115))
                        )
                        else
                            {4474}let pkSess_4116: bitstring = fail-any in
                            {4475}in(c, =GetEndpointRequest);
                            {4476}new SP_4117: bitstring;
                            {4477}new UP_4118: bitstring;
                            {4478}out(c, (GetEndpointResponse,pkSess_4116,SignAndEncrypt,SP_4117,UP_4118))
                )
                else
                    {4479}let pkSess_4119: bitstring = fail-any in
                    {4480}in(c, =GetEndpointRequest);
                    {4481}new SP_4120: bitstring;
                    {4482}new UP_4121: bitstring;
                    {4483}out(c, (GetEndpointResponse,pkSess_4119,SignAndEncrypt,SP_4120,UP_4121))
        )
        else
            {4484}let v_4122: bool = (Disco_3940 = B) in
            (
                {4485}if v_4122 then
                (
                    {4486}let skDisco_4123: bitstring = skB in
                    {4487}let pkDisco_4124: bitstring = pub(skDisco_4123) in
                    {4488}let v_4125: bool = (Cli_3939 = A) in
                    (
                        {4489}if v_4125 then
                        (
                            {4490}let pkCli_4126: bitstring = pub(skA) in
                            {4491}let v_4127: bool = (Sess_3941 = A) in
                            (
                                {4492}if v_4127 then
                                (
                                    {4493}let pkSess_4128: bitstring = pub(skA) in
                                    {4494}in(c, =GetEndpointRequest);
                                    {4495}new SP_4129: bitstring;
                                    {4496}new UP_4130: bitstring;
                                    {4497}out(c, (GetEndpointResponse,pkSess_4128,SignAndEncrypt,SP_4129,UP_4130))
                                )
                                else
                                    {4498}let v_4131: bool = (Sess_3941 = B) in
                                    (
                                        {4499}if v_4131 then
                                        (
                                            {4500}let pkSess_4132: bitstring = pub(skB) in
                                            {4501}in(c, =GetEndpointRequest);
                                            {4502}new SP_4133: bitstring;
                                            {4503}new UP_4134: bitstring;
                                            {4504}out(c, (GetEndpointResponse,pkSess_4132,SignAndEncrypt,SP_4133,UP_4134))
                                        )
                                        else
                                            {4505}let v_4135: bool = (Sess_3941 = C) in
                                            (
                                                {4506}if v_4135 then
                                                (
                                                    {4507}let pkSess_4136: bitstring = pub(skC) in
                                                    {4508}in(c, =GetEndpointRequest);
                                                    {4509}new SP_4137: bitstring;
                                                    {4510}new UP_4138: bitstring;
                                                    {4511}out(c, (GetEndpointResponse,pkSess_4136,SignAndEncrypt,SP_4137,UP_4138))
                                                )
                                                else
                                                    {4512}let pkSess_4139: bitstring = pub(sk(Sess_3941)) in
                                                    {4513}in(c, =GetEndpointRequest);
                                                    {4514}new SP_4140: bitstring;
                                                    {4515}new UP_4141: bitstring;
                                                    {4516}out(c, (GetEndpointResponse,pkSess_4139,SignAndEncrypt,SP_4140,UP_4141))
                                            )
                                            else
                                                {4517}let pkSess_4142: bitstring = fail-any in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4143: bitstring;
                                                {4520}new UP_4144: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4142,SignAndEncrypt,SP_4143,UP_4144))
                                    )
                                    else
                                        {4522}let pkSess_4145: bitstring = fail-any in
                                        {4523}in(c, =GetEndpointRequest);
                                        {4524}new SP_4146: bitstring;
                                        {4525}new UP_4147: bitstring;
                                        {4526}out(c, (GetEndpointResponse,pkSess_4145,SignAndEncrypt,SP_4146,UP_4147))
                            )
                            else
                                {4527}let pkSess_4148: bitstring = fail-any in
                                {4528}in(c, =GetEndpointRequest);
                                {4529}new SP_4149: bitstring;
                                {4530}new UP_4150: bitstring;
                                {4531}out(c, (GetEndpointResponse,pkSess_4148,SignAndEncrypt,SP_4149,UP_4150))
                        )
                        else
                            {4532}let v_4151: bool = (Cli_3939 = B) in
                            (
                                {4533}if v_4151 then
                                (
                                    {4534}let pkCli_4152: bitstring = pub(skB) in
                                    {4535}let v_4153: bool = (Sess_3941 = A) in
                                    (
                                        {4536}if v_4153 then
                                        (
                                            {4537}let pkSess_4154: bitstring = pub(skA) in
                                            {4538}in(c, =GetEndpointRequest);
                                            {4539}new SP_4155: bitstring;
                                            {4540}new UP_4156: bitstring;
                                            {4541}out(c, (GetEndpointResponse,pkSess_4154,SignAndEncrypt,SP_4155,UP_4156))
                                        )
                                        else
                                            {4542}let v_4157: bool = (Sess_3941 = B) in
                                            (
                                                {4543}if v_4157 then
                                                (
                                                    {4544}let pkSess_4158: bitstring = pub(skB) in
                                                    {4545}in(c, =GetEndpointRequest);
                                                    {4546}new SP_4159: bitstring;
                                                    {4547}new UP_4160: bitstring;
                                                    {4548}out(c, (GetEndpointResponse,pkSess_4158,SignAndEncrypt,SP_4159,UP_4160))
                                                )
                                                else
                                                    {4549}let v_4161: bool = (Sess_3941 = C) in
                                                    (
                                                        {4550}if v_4161 then
                                                        (
                                                            {4551}let pkSess_4162: bitstring = pub(skC) in
                                                            {4552}in(c, =GetEndpointRequest);
                                                            {4553}new SP_4163: bitstring;
                                                            {4554}new UP_4164: bitstring;
                                                            {4555}out(c, (GetEndpointResponse,pkSess_4162,SignAndEncrypt,SP_4163,UP_4164))
                                                        )
                                                        else
                                                            {4556}let pkSess_4165: bitstring = pub(sk(Sess_3941)) in
                                                            {4557}in(c, =GetEndpointRequest);
                                                            {4558}new SP_4166: bitstring;
                                                            {4559}new UP_4167: bitstring;
                                                            {4560}out(c, (GetEndpointResponse,pkSess_4165,SignAndEncrypt,SP_4166,UP_4167))
                                                    )
                                                    else
                                                        {4561}let pkSess_4168: bitstring = fail-any in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4169: bitstring;
                                                        {4564}new UP_4170: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4168,SignAndEncrypt,SP_4169,UP_4170))
                                            )
                                            else
                                                {4566}let pkSess_4171: bitstring = fail-any in
                                                {4567}in(c, =GetEndpointRequest);
                                                {4568}new SP_4172: bitstring;
                                                {4569}new UP_4173: bitstring;
                                                {4570}out(c, (GetEndpointResponse,pkSess_4171,SignAndEncrypt,SP_4172,UP_4173))
                                    )
                                    else
                                        {4571}let pkSess_4174: bitstring = fail-any in
                                        {4572}in(c, =GetEndpointRequest);
                                        {4573}new SP_4175: bitstring;
                                        {4574}new UP_4176: bitstring;
                                        {4575}out(c, (GetEndpointResponse,pkSess_4174,SignAndEncrypt,SP_4175,UP_4176))
                                )
                                else
                                    {4576}let v_4177: bool = (Cli_3939 = C) in
                                    (
                                        {4577}if v_4177 then
                                        (
                                            {4578}let pkCli_4178: bitstring = pub(skC) in
                                            {4579}let v_4179: bool = (Sess_3941 = A) in
                                            (
                                                {4580}if v_4179 then
                                                (
                                                    {4581}let pkSess_4180: bitstring = pub(skA) in
                                                    {4582}in(c, =GetEndpointRequest);
                                                    {4583}new SP_4181: bitstring;
                                                    {4584}new UP_4182: bitstring;
                                                    {4585}out(c, (GetEndpointResponse,pkSess_4180,SignAndEncrypt,SP_4181,UP_4182))
                                                )
                                                else
                                                    {4586}let v_4183: bool = (Sess_3941 = B) in
                                                    (
                                                        {4587}if v_4183 then
                                                        (
                                                            {4588}let pkSess_4184: bitstring = pub(skB) in
                                                            {4589}in(c, =GetEndpointRequest);
                                                            {4590}new SP_4185: bitstring;
                                                            {4591}new UP_4186: bitstring;
                                                            {4592}out(c, (GetEndpointResponse,pkSess_4184,SignAndEncrypt,SP_4185,UP_4186))
                                                        )
                                                        else
                                                            {4593}let v_4187: bool = (Sess_3941 = C) in
                                                            (
                                                                {4594}if v_4187 then
                                                                (
                                                                    {4595}let pkSess_4188: bitstring = pub(skC) in
                                                                    {4596}in(c, =GetEndpointRequest);
                                                                    {4597}new SP_4189: bitstring;
                                                                    {4598}new UP_4190: bitstring;
                                                                    {4599}out(c, (GetEndpointResponse,pkSess_4188,SignAndEncrypt,SP_4189,UP_4190))
                                                                )
                                                                else
                                                                    {4600}let pkSess_4191: bitstring = pub(sk(Sess_3941)) in
                                                                    {4601}in(c, =GetEndpointRequest);
                                                                    {4602}new SP_4192: bitstring;
                                                                    {4603}new UP_4193: bitstring;
                                                                    {4604}out(c, (GetEndpointResponse,pkSess_4191,SignAndEncrypt,SP_4192,UP_4193))
                                                            )
                                                            else
                                                                {4605}let pkSess_4194: bitstring = fail-any in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4195: bitstring;
                                                                {4608}new UP_4196: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4194,SignAndEncrypt,SP_4195,UP_4196))
                                                    )
                                                    else
                                                        {4610}let pkSess_4197: bitstring = fail-any in
                                                        {4611}in(c, =GetEndpointRequest);
                                                        {4612}new SP_4198: bitstring;
                                                        {4613}new UP_4199: bitstring;
                                                        {4614}out(c, (GetEndpointResponse,pkSess_4197,SignAndEncrypt,SP_4198,UP_4199))
                                            )
                                            else
                                                {4615}let pkSess_4200: bitstring = fail-any in
                                                {4616}in(c, =GetEndpointRequest);
                                                {4617}new SP_4201: bitstring;
                                                {4618}new UP_4202: bitstring;
                                                {4619}out(c, (GetEndpointResponse,pkSess_4200,SignAndEncrypt,SP_4201,UP_4202))
                                        )
                                        else
                                            {4620}let pkCli_4203: bitstring = pub(sk(Cli_3939)) in
                                            {4621}let v_4204: bool = (Sess_3941 = A) in
                                            (
                                                {4622}if v_4204 then
                                                (
                                                    {4623}let pkSess_4205: bitstring = pub(skA) in
                                                    {4624}in(c, =GetEndpointRequest);
                                                    {4625}new SP_4206: bitstring;
                                                    {4626}new UP_4207: bitstring;
                                                    {4627}out(c, (GetEndpointResponse,pkSess_4205,SignAndEncrypt,SP_4206,UP_4207))
                                                )
                                                else
                                                    {4628}let v_4208: bool = (Sess_3941 = B) in
                                                    (
                                                        {4629}if v_4208 then
                                                        (
                                                            {4630}let pkSess_4209: bitstring = pub(skB) in
                                                            {4631}in(c, =GetEndpointRequest);
                                                            {4632}new SP_4210: bitstring;
                                                            {4633}new UP_4211: bitstring;
                                                            {4634}out(c, (GetEndpointResponse,pkSess_4209,SignAndEncrypt,SP_4210,UP_4211))
                                                        )
                                                        else
                                                            {4635}let v_4212: bool = (Sess_3941 = C) in
                                                            (
                                                                {4636}if v_4212 then
                                                                (
                                                                    {4637}let pkSess_4213: bitstring = pub(skC) in
                                                                    {4638}in(c, =GetEndpointRequest);
                                                                    {4639}new SP_4214: bitstring;
                                                                    {4640}new UP_4215: bitstring;
                                                                    {4641}out(c, (GetEndpointResponse,pkSess_4213,SignAndEncrypt,SP_4214,UP_4215))
                                                                )
                                                                else
                                                                    {4642}let pkSess_4216: bitstring = pub(sk(Sess_3941)) in
                                                                    {4643}in(c, =GetEndpointRequest);
                                                                    {4644}new SP_4217: bitstring;
                                                                    {4645}new UP_4218: bitstring;
                                                                    {4646}out(c, (GetEndpointResponse,pkSess_4216,SignAndEncrypt,SP_4217,UP_4218))
                                                            )
                                                            else
                                                                {4647}let pkSess_4219: bitstring = fail-any in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4220: bitstring;
                                                                {4650}new UP_4221: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4219,SignAndEncrypt,SP_4220,UP_4221))
                                                    )
                                                    else
                                                        {4652}let pkSess_4222: bitstring = fail-any in
                                                        {4653}in(c, =GetEndpointRequest);
                                                        {4654}new SP_4223: bitstring;
                                                        {4655}new UP_4224: bitstring;
                                                        {4656}out(c, (GetEndpointResponse,pkSess_4222,SignAndEncrypt,SP_4223,UP_4224))
                                            )
                                            else
                                                {4657}let pkSess_4225: bitstring = fail-any in
                                                {4658}in(c, =GetEndpointRequest);
                                                {4659}new SP_4226: bitstring;
                                                {4660}new UP_4227: bitstring;
                                                {4661}out(c, (GetEndpointResponse,pkSess_4225,SignAndEncrypt,SP_4226,UP_4227))
                                    )
                                    else
                                        {4662}let pkCli_4228: bitstring = fail-any in
                                        {4663}let v_4229: bool = (Sess_3941 = A) in
                                        (
                                            {4664}if v_4229 then
                                            (
                                                {4665}let pkSess_4230: bitstring = pub(skA) in
                                                {4666}in(c, =GetEndpointRequest);
                                                {4667}new SP_4231: bitstring;
                                                {4668}new UP_4232: bitstring;
                                                {4669}out(c, (GetEndpointResponse,pkSess_4230,SignAndEncrypt,SP_4231,UP_4232))
                                            )
                                            else
                                                {4670}let v_4233: bool = (Sess_3941 = B) in
                                                (
                                                    {4671}if v_4233 then
                                                    (
                                                        {4672}let pkSess_4234: bitstring = pub(skB) in
                                                        {4673}in(c, =GetEndpointRequest);
                                                        {4674}new SP_4235: bitstring;
                                                        {4675}new UP_4236: bitstring;
                                                        {4676}out(c, (GetEndpointResponse,pkSess_4234,SignAndEncrypt,SP_4235,UP_4236))
                                                    )
                                                    else
                                                        {4677}let v_4237: bool = (Sess_3941 = C) in
                                                        (
                                                            {4678}if v_4237 then
                                                            (
                                                                {4679}let pkSess_4238: bitstring = pub(skC) in
                                                                {4680}in(c, =GetEndpointRequest);
                                                                {4681}new SP_4239: bitstring;
                                                                {4682}new UP_4240: bitstring;
                                                                {4683}out(c, (GetEndpointResponse,pkSess_4238,SignAndEncrypt,SP_4239,UP_4240))
                                                            )
                                                            else
                                                                {4684}let pkSess_4241: bitstring = pub(sk(Sess_3941)) in
                                                                {4685}in(c, =GetEndpointRequest);
                                                                {4686}new SP_4242: bitstring;
                                                                {4687}new UP_4243: bitstring;
                                                                {4688}out(c, (GetEndpointResponse,pkSess_4241,SignAndEncrypt,SP_4242,UP_4243))
                                                        )
                                                        else
                                                            {4689}let pkSess_4244: bitstring = fail-any in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4245: bitstring;
                                                            {4692}new UP_4246: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4244,SignAndEncrypt,SP_4245,UP_4246))
                                                )
                                                else
                                                    {4694}let pkSess_4247: bitstring = fail-any in
                                                    {4695}in(c, =GetEndpointRequest);
                                                    {4696}new SP_4248: bitstring;
                                                    {4697}new UP_4249: bitstring;
                                                    {4698}out(c, (GetEndpointResponse,pkSess_4247,SignAndEncrypt,SP_4248,UP_4249))
                                        )
                                        else
                                            {4699}let pkSess_4250: bitstring = fail-any in
                                            {4700}in(c, =GetEndpointRequest);
                                            {4701}new SP_4251: bitstring;
                                            {4702}new UP_4252: bitstring;
                                            {4703}out(c, (GetEndpointResponse,pkSess_4250,SignAndEncrypt,SP_4251,UP_4252))
                            )
                            else
                                {4704}let pkCli_4253: bitstring = fail-any in
                                {4705}let v_4254: bool = (Sess_3941 = A) in
                                (
                                    {4706}if v_4254 then
                                    (
                                        {4707}let pkSess_4255: bitstring = pub(skA) in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SP_4256: bitstring;
                                        {4710}new UP_4257: bitstring;
                                        {4711}out(c, (GetEndpointResponse,pkSess_4255,SignAndEncrypt,SP_4256,UP_4257))
                                    )
                                    else
                                        {4712}let v_4258: bool = (Sess_3941 = B) in
                                        (
                                            {4713}if v_4258 then
                                            (
                                                {4714}let pkSess_4259: bitstring = pub(skB) in
                                                {4715}in(c, =GetEndpointRequest);
                                                {4716}new SP_4260: bitstring;
                                                {4717}new UP_4261: bitstring;
                                                {4718}out(c, (GetEndpointResponse,pkSess_4259,SignAndEncrypt,SP_4260,UP_4261))
                                            )
                                            else
                                                {4719}let v_4262: bool = (Sess_3941 = C) in
                                                (
                                                    {4720}if v_4262 then
                                                    (
                                                        {4721}let pkSess_4263: bitstring = pub(skC) in
                                                        {4722}in(c, =GetEndpointRequest);
                                                        {4723}new SP_4264: bitstring;
                                                        {4724}new UP_4265: bitstring;
                                                        {4725}out(c, (GetEndpointResponse,pkSess_4263,SignAndEncrypt,SP_4264,UP_4265))
                                                    )
                                                    else
                                                        {4726}let pkSess_4266: bitstring = pub(sk(Sess_3941)) in
                                                        {4727}in(c, =GetEndpointRequest);
                                                        {4728}new SP_4267: bitstring;
                                                        {4729}new UP_4268: bitstring;
                                                        {4730}out(c, (GetEndpointResponse,pkSess_4266,SignAndEncrypt,SP_4267,UP_4268))
                                                )
                                                else
                                                    {4731}let pkSess_4269: bitstring = fail-any in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4270: bitstring;
                                                    {4734}new UP_4271: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4269,SignAndEncrypt,SP_4270,UP_4271))
                                        )
                                        else
                                            {4736}let pkSess_4272: bitstring = fail-any in
                                            {4737}in(c, =GetEndpointRequest);
                                            {4738}new SP_4273: bitstring;
                                            {4739}new UP_4274: bitstring;
                                            {4740}out(c, (GetEndpointResponse,pkSess_4272,SignAndEncrypt,SP_4273,UP_4274))
                                )
                                else
                                    {4741}let pkSess_4275: bitstring = fail-any in
                                    {4742}in(c, =GetEndpointRequest);
                                    {4743}new SP_4276: bitstring;
                                    {4744}new UP_4277: bitstring;
                                    {4745}out(c, (GetEndpointResponse,pkSess_4275,SignAndEncrypt,SP_4276,UP_4277))
                    )
                    else
                        {4746}let pkCli_4278: bitstring = fail-any in
                        {4747}let v_4279: bool = (Sess_3941 = A) in
                        (
                            {4748}if v_4279 then
                            (
                                {4749}let pkSess_4280: bitstring = pub(skA) in
                                {4750}in(c, =GetEndpointRequest);
                                {4751}new SP_4281: bitstring;
                                {4752}new UP_4282: bitstring;
                                {4753}out(c, (GetEndpointResponse,pkSess_4280,SignAndEncrypt,SP_4281,UP_4282))
                            )
                            else
                                {4754}let v_4283: bool = (Sess_3941 = B) in
                                (
                                    {4755}if v_4283 then
                                    (
                                        {4756}let pkSess_4284: bitstring = pub(skB) in
                                        {4757}in(c, =GetEndpointRequest);
                                        {4758}new SP_4285: bitstring;
                                        {4759}new UP_4286: bitstring;
                                        {4760}out(c, (GetEndpointResponse,pkSess_4284,SignAndEncrypt,SP_4285,UP_4286))
                                    )
                                    else
                                        {4761}let v_4287: bool = (Sess_3941 = C) in
                                        (
                                            {4762}if v_4287 then
                                            (
                                                {4763}let pkSess_4288: bitstring = pub(skC) in
                                                {4764}in(c, =GetEndpointRequest);
                                                {4765}new SP_4289: bitstring;
                                                {4766}new UP_4290: bitstring;
                                                {4767}out(c, (GetEndpointResponse,pkSess_4288,SignAndEncrypt,SP_4289,UP_4290))
                                            )
                                            else
                                                {4768}let pkSess_4291: bitstring = pub(sk(Sess_3941)) in
                                                {4769}in(c, =GetEndpointRequest);
                                                {4770}new SP_4292: bitstring;
                                                {4771}new UP_4293: bitstring;
                                                {4772}out(c, (GetEndpointResponse,pkSess_4291,SignAndEncrypt,SP_4292,UP_4293))
                                        )
                                        else
                                            {4773}let pkSess_4294: bitstring = fail-any in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4295: bitstring;
                                            {4776}new UP_4296: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4294,SignAndEncrypt,SP_4295,UP_4296))
                                )
                                else
                                    {4778}let pkSess_4297: bitstring = fail-any in
                                    {4779}in(c, =GetEndpointRequest);
                                    {4780}new SP_4298: bitstring;
                                    {4781}new UP_4299: bitstring;
                                    {4782}out(c, (GetEndpointResponse,pkSess_4297,SignAndEncrypt,SP_4298,UP_4299))
                        )
                        else
                            {4783}let pkSess_4300: bitstring = fail-any in
                            {4784}in(c, =GetEndpointRequest);
                            {4785}new SP_4301: bitstring;
                            {4786}new UP_4302: bitstring;
                            {4787}out(c, (GetEndpointResponse,pkSess_4300,SignAndEncrypt,SP_4301,UP_4302))
                )
                else
                    {4788}let =true = (Disco_3940 = C) in
                    (
                        {4789}let skDisco_4303: bitstring = skC in
                        {4790}let pkDisco_4304: bitstring = pub(skDisco_4303) in
                        {4791}let v_4305: bool = (Cli_3939 = A) in
                        (
                            {4792}if v_4305 then
                            (
                                {4793}let pkCli_4306: bitstring = pub(skA) in
                                {4794}let v_4307: bool = (Sess_3941 = A) in
                                (
                                    {4795}if v_4307 then
                                    (
                                        {4796}let pkSess_4308: bitstring = pub(skA) in
                                        {4797}in(c, =GetEndpointRequest);
                                        {4798}new SP_4309: bitstring;
                                        {4799}new UP_4310: bitstring;
                                        {4800}out(c, (GetEndpointResponse,pkSess_4308,SignAndEncrypt,SP_4309,UP_4310))
                                    )
                                    else
                                        {4801}let v_4311: bool = (Sess_3941 = B) in
                                        (
                                            {4802}if v_4311 then
                                            (
                                                {4803}let pkSess_4312: bitstring = pub(skB) in
                                                {4804}in(c, =GetEndpointRequest);
                                                {4805}new SP_4313: bitstring;
                                                {4806}new UP_4314: bitstring;
                                                {4807}out(c, (GetEndpointResponse,pkSess_4312,SignAndEncrypt,SP_4313,UP_4314))
                                            )
                                            else
                                                {4808}let v_4315: bool = (Sess_3941 = C) in
                                                (
                                                    {4809}if v_4315 then
                                                    (
                                                        {4810}let pkSess_4316: bitstring = pub(skC) in
                                                        {4811}in(c, =GetEndpointRequest);
                                                        {4812}new SP_4317: bitstring;
                                                        {4813}new UP_4318: bitstring;
                                                        {4814}out(c, (GetEndpointResponse,pkSess_4316,SignAndEncrypt,SP_4317,UP_4318))
                                                    )
                                                    else
                                                        {4815}let pkSess_4319: bitstring = pub(sk(Sess_3941)) in
                                                        {4816}in(c, =GetEndpointRequest);
                                                        {4817}new SP_4320: bitstring;
                                                        {4818}new UP_4321: bitstring;
                                                        {4819}out(c, (GetEndpointResponse,pkSess_4319,SignAndEncrypt,SP_4320,UP_4321))
                                                )
                                                else
                                                    {4820}let pkSess_4322: bitstring = fail-any in
                                                    {4821}in(c, =GetEndpointRequest);
                                                    {4822}new SP_4323: bitstring;
                                                    {4823}new UP_4324: bitstring;
                                                    {4824}out(c, (GetEndpointResponse,pkSess_4322,SignAndEncrypt,SP_4323,UP_4324))
                                        )
                                        else
                                            {4825}let pkSess_4325: bitstring = fail-any in
                                            {4826}in(c, =GetEndpointRequest);
                                            {4827}new SP_4326: bitstring;
                                            {4828}new UP_4327: bitstring;
                                            {4829}out(c, (GetEndpointResponse,pkSess_4325,SignAndEncrypt,SP_4326,UP_4327))
                                )
                                else
                                    {4830}let pkSess_4328: bitstring = fail-any in
                                    {4831}in(c, =GetEndpointRequest);
                                    {4832}new SP_4329: bitstring;
                                    {4833}new UP_4330: bitstring;
                                    {4834}out(c, (GetEndpointResponse,pkSess_4328,SignAndEncrypt,SP_4329,UP_4330))
                            )
                            else
                                {4835}let v_4331: bool = (Cli_3939 = B) in
                                (
                                    {4836}if v_4331 then
                                    (
                                        {4837}let pkCli_4332: bitstring = pub(skB) in
                                        {4838}let v_4333: bool = (Sess_3941 = A) in
                                        (
                                            {4839}if v_4333 then
                                            (
                                                {4840}let pkSess_4334: bitstring = pub(skA) in
                                                {4841}in(c, =GetEndpointRequest);
                                                {4842}new SP_4335: bitstring;
                                                {4843}new UP_4336: bitstring;
                                                {4844}out(c, (GetEndpointResponse,pkSess_4334,SignAndEncrypt,SP_4335,UP_4336))
                                            )
                                            else
                                                {4845}let v_4337: bool = (Sess_3941 = B) in
                                                (
                                                    {4846}if v_4337 then
                                                    (
                                                        {4847}let pkSess_4338: bitstring = pub(skB) in
                                                        {4848}in(c, =GetEndpointRequest);
                                                        {4849}new SP_4339: bitstring;
                                                        {4850}new UP_4340: bitstring;
                                                        {4851}out(c, (GetEndpointResponse,pkSess_4338,SignAndEncrypt,SP_4339,UP_4340))
                                                    )
                                                    else
                                                        {4852}let v_4341: bool = (Sess_3941 = C) in
                                                        (
                                                            {4853}if v_4341 then
                                                            (
                                                                {4854}let pkSess_4342: bitstring = pub(skC) in
                                                                {4855}in(c, =GetEndpointRequest);
                                                                {4856}new SP_4343: bitstring;
                                                                {4857}new UP_4344: bitstring;
                                                                {4858}out(c, (GetEndpointResponse,pkSess_4342,SignAndEncrypt,SP_4343,UP_4344))
                                                            )
                                                            else
                                                                {4859}let pkSess_4345: bitstring = pub(sk(Sess_3941)) in
                                                                {4860}in(c, =GetEndpointRequest);
                                                                {4861}new SP_4346: bitstring;
                                                                {4862}new UP_4347: bitstring;
                                                                {4863}out(c, (GetEndpointResponse,pkSess_4345,SignAndEncrypt,SP_4346,UP_4347))
                                                        )
                                                        else
                                                            {4864}let pkSess_4348: bitstring = fail-any in
                                                            {4865}in(c, =GetEndpointRequest);
                                                            {4866}new SP_4349: bitstring;
                                                            {4867}new UP_4350: bitstring;
                                                            {4868}out(c, (GetEndpointResponse,pkSess_4348,SignAndEncrypt,SP_4349,UP_4350))
                                                )
                                                else
                                                    {4869}let pkSess_4351: bitstring = fail-any in
                                                    {4870}in(c, =GetEndpointRequest);
                                                    {4871}new SP_4352: bitstring;
                                                    {4872}new UP_4353: bitstring;
                                                    {4873}out(c, (GetEndpointResponse,pkSess_4351,SignAndEncrypt,SP_4352,UP_4353))
                                        )
                                        else
                                            {4874}let pkSess_4354: bitstring = fail-any in
                                            {4875}in(c, =GetEndpointRequest);
                                            {4876}new SP_4355: bitstring;
                                            {4877}new UP_4356: bitstring;
                                            {4878}out(c, (GetEndpointResponse,pkSess_4354,SignAndEncrypt,SP_4355,UP_4356))
                                    )
                                    else
                                        {4879}let v_4357: bool = (Cli_3939 = C) in
                                        (
                                            {4880}if v_4357 then
                                            (
                                                {4881}let pkCli_4358: bitstring = pub(skC) in
                                                {4882}let v_4359: bool = (Sess_3941 = A) in
                                                (
                                                    {4883}if v_4359 then
                                                    (
                                                        {4884}let pkSess_4360: bitstring = pub(skA) in
                                                        {4885}in(c, =GetEndpointRequest);
                                                        {4886}new SP_4361: bitstring;
                                                        {4887}new UP_4362: bitstring;
                                                        {4888}out(c, (GetEndpointResponse,pkSess_4360,SignAndEncrypt,SP_4361,UP_4362))
                                                    )
                                                    else
                                                        {4889}let v_4363: bool = (Sess_3941 = B) in
                                                        (
                                                            {4890}if v_4363 then
                                                            (
                                                                {4891}let pkSess_4364: bitstring = pub(skB) in
                                                                {4892}in(c, =GetEndpointRequest);
                                                                {4893}new SP_4365: bitstring;
                                                                {4894}new UP_4366: bitstring;
                                                                {4895}out(c, (GetEndpointResponse,pkSess_4364,SignAndEncrypt,SP_4365,UP_4366))
                                                            )
                                                            else
                                                                {4896}let v_4367: bool = (Sess_3941 = C) in
                                                                (
                                                                    {4897}if v_4367 then
                                                                    (
                                                                        {4898}let pkSess_4368: bitstring = pub(skC) in
                                                                        {4899}in(c, =GetEndpointRequest);
                                                                        {4900}new SP_4369: bitstring;
                                                                        {4901}new UP_4370: bitstring;
                                                                        {4902}out(c, (GetEndpointResponse,pkSess_4368,SignAndEncrypt,SP_4369,UP_4370))
                                                                    )
                                                                    else
                                                                        {4903}let pkSess_4371: bitstring = pub(sk(Sess_3941)) in
                                                                        {4904}in(c, =GetEndpointRequest);
                                                                        {4905}new SP_4372: bitstring;
                                                                        {4906}new UP_4373: bitstring;
                                                                        {4907}out(c, (GetEndpointResponse,pkSess_4371,SignAndEncrypt,SP_4372,UP_4373))
                                                                )
                                                                else
                                                                    {4908}let pkSess_4374: bitstring = fail-any in
                                                                    {4909}in(c, =GetEndpointRequest);
                                                                    {4910}new SP_4375: bitstring;
                                                                    {4911}new UP_4376: bitstring;
                                                                    {4912}out(c, (GetEndpointResponse,pkSess_4374,SignAndEncrypt,SP_4375,UP_4376))
                                                        )
                                                        else
                                                            {4913}let pkSess_4377: bitstring = fail-any in
                                                            {4914}in(c, =GetEndpointRequest);
                                                            {4915}new SP_4378: bitstring;
                                                            {4916}new UP_4379: bitstring;
                                                            {4917}out(c, (GetEndpointResponse,pkSess_4377,SignAndEncrypt,SP_4378,UP_4379))
                                                )
                                                else
                                                    {4918}let pkSess_4380: bitstring = fail-any in
                                                    {4919}in(c, =GetEndpointRequest);
                                                    {4920}new SP_4381: bitstring;
                                                    {4921}new UP_4382: bitstring;
                                                    {4922}out(c, (GetEndpointResponse,pkSess_4380,SignAndEncrypt,SP_4381,UP_4382))
                                            )
                                            else
                                                {4923}let pkCli_4383: bitstring = pub(sk(Cli_3939)) in
                                                {4924}let v_4384: bool = (Sess_3941 = A) in
                                                (
                                                    {4925}if v_4384 then
                                                    (
                                                        {4926}let pkSess_4385: bitstring = pub(skA) in
                                                        {4927}in(c, =GetEndpointRequest);
                                                        {4928}new SP_4386: bitstring;
                                                        {4929}new UP_4387: bitstring;
                                                        {4930}out(c, (GetEndpointResponse,pkSess_4385,SignAndEncrypt,SP_4386,UP_4387))
                                                    )
                                                    else
                                                        {4931}let v_4388: bool = (Sess_3941 = B) in
                                                        (
                                                            {4932}if v_4388 then
                                                            (
                                                                {4933}let pkSess_4389: bitstring = pub(skB) in
                                                                {4934}in(c, =GetEndpointRequest);
                                                                {4935}new SP_4390: bitstring;
                                                                {4936}new UP_4391: bitstring;
                                                                {4937}out(c, (GetEndpointResponse,pkSess_4389,SignAndEncrypt,SP_4390,UP_4391))
                                                            )
                                                            else
                                                                {4938}let v_4392: bool = (Sess_3941 = C) in
                                                                (
                                                                    {4939}if v_4392 then
                                                                    (
                                                                        {4940}let pkSess_4393: bitstring = pub(skC) in
                                                                        {4941}in(c, =GetEndpointRequest);
                                                                        {4942}new SP_4394: bitstring;
                                                                        {4943}new UP_4395: bitstring;
                                                                        {4944}out(c, (GetEndpointResponse,pkSess_4393,SignAndEncrypt,SP_4394,UP_4395))
                                                                    )
                                                                    else
                                                                        {4945}let pkSess_4396: bitstring = pub(sk(Sess_3941)) in
                                                                        {4946}in(c, =GetEndpointRequest);
                                                                        {4947}new SP_4397: bitstring;
                                                                        {4948}new UP_4398: bitstring;
                                                                        {4949}out(c, (GetEndpointResponse,pkSess_4396,SignAndEncrypt,SP_4397,UP_4398))
                                                                )
                                                                else
                                                                    {4950}let pkSess_4399: bitstring = fail-any in
                                                                    {4951}in(c, =GetEndpointRequest);
                                                                    {4952}new SP_4400: bitstring;
                                                                    {4953}new UP_4401: bitstring;
                                                                    {4954}out(c, (GetEndpointResponse,pkSess_4399,SignAndEncrypt,SP_4400,UP_4401))
                                                        )
                                                        else
                                                            {4955}let pkSess_4402: bitstring = fail-any in
                                                            {4956}in(c, =GetEndpointRequest);
                                                            {4957}new SP_4403: bitstring;
                                                            {4958}new UP_4404: bitstring;
                                                            {4959}out(c, (GetEndpointResponse,pkSess_4402,SignAndEncrypt,SP_4403,UP_4404))
                                                )
                                                else
                                                    {4960}let pkSess_4405: bitstring = fail-any in
                                                    {4961}in(c, =GetEndpointRequest);
                                                    {4962}new SP_4406: bitstring;
                                                    {4963}new UP_4407: bitstring;
                                                    {4964}out(c, (GetEndpointResponse,pkSess_4405,SignAndEncrypt,SP_4406,UP_4407))
                                        )
                                        else
                                            {4965}let pkCli_4408: bitstring = fail-any in
                                            {4966}let v_4409: bool = (Sess_3941 = A) in
                                            (
                                                {4967}if v_4409 then
                                                (
                                                    {4968}let pkSess_4410: bitstring = pub(skA) in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4411: bitstring;
                                                    {4971}new UP_4412: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4410,SignAndEncrypt,SP_4411,UP_4412))
                                                )
                                                else
                                                    {4973}let v_4413: bool = (Sess_3941 = B) in
                                                    (
                                                        {4974}if v_4413 then
                                                        (
                                                            {4975}let pkSess_4414: bitstring = pub(skB) in
                                                            {4976}in(c, =GetEndpointRequest);
                                                            {4977}new SP_4415: bitstring;
                                                            {4978}new UP_4416: bitstring;
                                                            {4979}out(c, (GetEndpointResponse,pkSess_4414,SignAndEncrypt,SP_4415,UP_4416))
                                                        )
                                                        else
                                                            {4980}let v_4417: bool = (Sess_3941 = C) in
                                                            (
                                                                {4981}if v_4417 then
                                                                (
                                                                    {4982}let pkSess_4418: bitstring = pub(skC) in
                                                                    {4983}in(c, =GetEndpointRequest);
                                                                    {4984}new SP_4419: bitstring;
                                                                    {4985}new UP_4420: bitstring;
                                                                    {4986}out(c, (GetEndpointResponse,pkSess_4418,SignAndEncrypt,SP_4419,UP_4420))
                                                                )
                                                                else
                                                                    {4987}let pkSess_4421: bitstring = pub(sk(Sess_3941)) in
                                                                    {4988}in(c, =GetEndpointRequest);
                                                                    {4989}new SP_4422: bitstring;
                                                                    {4990}new UP_4423: bitstring;
                                                                    {4991}out(c, (GetEndpointResponse,pkSess_4421,SignAndEncrypt,SP_4422,UP_4423))
                                                            )
                                                            else
                                                                {4992}let pkSess_4424: bitstring = fail-any in
                                                                {4993}in(c, =GetEndpointRequest);
                                                                {4994}new SP_4425: bitstring;
                                                                {4995}new UP_4426: bitstring;
                                                                {4996}out(c, (GetEndpointResponse,pkSess_4424,SignAndEncrypt,SP_4425,UP_4426))
                                                    )
                                                    else
                                                        {4997}let pkSess_4427: bitstring = fail-any in
                                                        {4998}in(c, =GetEndpointRequest);
                                                        {4999}new SP_4428: bitstring;
                                                        {5000}new UP_4429: bitstring;
                                                        {5001}out(c, (GetEndpointResponse,pkSess_4427,SignAndEncrypt,SP_4428,UP_4429))
                                            )
                                            else
                                                {5002}let pkSess_4430: bitstring = fail-any in
                                                {5003}in(c, =GetEndpointRequest);
                                                {5004}new SP_4431: bitstring;
                                                {5005}new UP_4432: bitstring;
                                                {5006}out(c, (GetEndpointResponse,pkSess_4430,SignAndEncrypt,SP_4431,UP_4432))
                                )
                                else
                                    {5007}let pkCli_4433: bitstring = fail-any in
                                    {5008}let v_4434: bool = (Sess_3941 = A) in
                                    (
                                        {5009}if v_4434 then
                                        (
                                            {5010}let pkSess_4435: bitstring = pub(skA) in
                                            {5011}in(c, =GetEndpointRequest);
                                            {5012}new SP_4436: bitstring;
                                            {5013}new UP_4437: bitstring;
                                            {5014}out(c, (GetEndpointResponse,pkSess_4435,SignAndEncrypt,SP_4436,UP_4437))
                                        )
                                        else
                                            {5015}let v_4438: bool = (Sess_3941 = B) in
                                            (
                                                {5016}if v_4438 then
                                                (
                                                    {5017}let pkSess_4439: bitstring = pub(skB) in
                                                    {5018}in(c, =GetEndpointRequest);
                                                    {5019}new SP_4440: bitstring;
                                                    {5020}new UP_4441: bitstring;
                                                    {5021}out(c, (GetEndpointResponse,pkSess_4439,SignAndEncrypt,SP_4440,UP_4441))
                                                )
                                                else
                                                    {5022}let v_4442: bool = (Sess_3941 = C) in
                                                    (
                                                        {5023}if v_4442 then
                                                        (
                                                            {5024}let pkSess_4443: bitstring = pub(skC) in
                                                            {5025}in(c, =GetEndpointRequest);
                                                            {5026}new SP_4444: bitstring;
                                                            {5027}new UP_4445: bitstring;
                                                            {5028}out(c, (GetEndpointResponse,pkSess_4443,SignAndEncrypt,SP_4444,UP_4445))
                                                        )
                                                        else
                                                            {5029}let pkSess_4446: bitstring = pub(sk(Sess_3941)) in
                                                            {5030}in(c, =GetEndpointRequest);
                                                            {5031}new SP_4447: bitstring;
                                                            {5032}new UP_4448: bitstring;
                                                            {5033}out(c, (GetEndpointResponse,pkSess_4446,SignAndEncrypt,SP_4447,UP_4448))
                                                    )
                                                    else
                                                        {5034}let pkSess_4449: bitstring = fail-any in
                                                        {5035}in(c, =GetEndpointRequest);
                                                        {5036}new SP_4450: bitstring;
                                                        {5037}new UP_4451: bitstring;
                                                        {5038}out(c, (GetEndpointResponse,pkSess_4449,SignAndEncrypt,SP_4450,UP_4451))
                                            )
                                            else
                                                {5039}let pkSess_4452: bitstring = fail-any in
                                                {5040}in(c, =GetEndpointRequest);
                                                {5041}new SP_4453: bitstring;
                                                {5042}new UP_4454: bitstring;
                                                {5043}out(c, (GetEndpointResponse,pkSess_4452,SignAndEncrypt,SP_4453,UP_4454))
                                    )
                                    else
                                        {5044}let pkSess_4455: bitstring = fail-any in
                                        {5045}in(c, =GetEndpointRequest);
                                        {5046}new SP_4456: bitstring;
                                        {5047}new UP_4457: bitstring;
                                        {5048}out(c, (GetEndpointResponse,pkSess_4455,SignAndEncrypt,SP_4456,UP_4457))
                        )
                        else
                            {5049}let pkCli_4458: bitstring = fail-any in
                            {5050}let v_4459: bool = (Sess_3941 = A) in
                            (
                                {5051}if v_4459 then
                                (
                                    {5052}let pkSess_4460: bitstring = pub(skA) in
                                    {5053}in(c, =GetEndpointRequest);
                                    {5054}new SP_4461: bitstring;
                                    {5055}new UP_4462: bitstring;
                                    {5056}out(c, (GetEndpointResponse,pkSess_4460,SignAndEncrypt,SP_4461,UP_4462))
                                )
                                else
                                    {5057}let v_4463: bool = (Sess_3941 = B) in
                                    (
                                        {5058}if v_4463 then
                                        (
                                            {5059}let pkSess_4464: bitstring = pub(skB) in
                                            {5060}in(c, =GetEndpointRequest);
                                            {5061}new SP_4465: bitstring;
                                            {5062}new UP_4466: bitstring;
                                            {5063}out(c, (GetEndpointResponse,pkSess_4464,SignAndEncrypt,SP_4465,UP_4466))
                                        )
                                        else
                                            {5064}let v_4467: bool = (Sess_3941 = C) in
                                            (
                                                {5065}if v_4467 then
                                                (
                                                    {5066}let pkSess_4468: bitstring = pub(skC) in
                                                    {5067}in(c, =GetEndpointRequest);
                                                    {5068}new SP_4469: bitstring;
                                                    {5069}new UP_4470: bitstring;
                                                    {5070}out(c, (GetEndpointResponse,pkSess_4468,SignAndEncrypt,SP_4469,UP_4470))
                                                )
                                                else
                                                    {5071}let pkSess_4471: bitstring = pub(sk(Sess_3941)) in
                                                    {5072}in(c, =GetEndpointRequest);
                                                    {5073}new SP_4472: bitstring;
                                                    {5074}new UP_4473: bitstring;
                                                    {5075}out(c, (GetEndpointResponse,pkSess_4471,SignAndEncrypt,SP_4472,UP_4473))
                                            )
                                            else
                                                {5076}let pkSess_4474: bitstring = fail-any in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SP_4475: bitstring;
                                                {5079}new UP_4476: bitstring;
                                                {5080}out(c, (GetEndpointResponse,pkSess_4474,SignAndEncrypt,SP_4475,UP_4476))
                                    )
                                    else
                                        {5081}let pkSess_4477: bitstring = fail-any in
                                        {5082}in(c, =GetEndpointRequest);
                                        {5083}new SP_4478: bitstring;
                                        {5084}new UP_4479: bitstring;
                                        {5085}out(c, (GetEndpointResponse,pkSess_4477,SignAndEncrypt,SP_4478,UP_4479))
                            )
                            else
                                {5086}let pkSess_4480: bitstring = fail-any in
                                {5087}in(c, =GetEndpointRequest);
                                {5088}new SP_4481: bitstring;
                                {5089}new UP_4482: bitstring;
                                {5090}out(c, (GetEndpointResponse,pkSess_4480,SignAndEncrypt,SP_4481,UP_4482))
                    )
                    else
                        {5091}let skDisco_4483: bitstring = fail-any in
                        {5092}let pkDisco_4484: bitstring = pub(skDisco_4483) in
                        {5093}let v_4485: bool = (Cli_3939 = A) in
                        (
                            {5094}if v_4485 then
                            (
                                {5095}let pkCli_4486: bitstring = pub(skA) in
                                {5096}let v_4487: bool = (Sess_3941 = A) in
                                (
                                    {5097}if v_4487 then
                                    (
                                        {5098}let pkSess_4488: bitstring = pub(skA) in
                                        {5099}in(c, =GetEndpointRequest);
                                        {5100}new SP_4489: bitstring;
                                        {5101}new UP_4490: bitstring;
                                        {5102}out(c, (GetEndpointResponse,pkSess_4488,SignAndEncrypt,SP_4489,UP_4490))
                                    )
                                    else
                                        {5103}let v_4491: bool = (Sess_3941 = B) in
                                        (
                                            {5104}if v_4491 then
                                            (
                                                {5105}let pkSess_4492: bitstring = pub(skB) in
                                                {5106}in(c, =GetEndpointRequest);
                                                {5107}new SP_4493: bitstring;
                                                {5108}new UP_4494: bitstring;
                                                {5109}out(c, (GetEndpointResponse,pkSess_4492,SignAndEncrypt,SP_4493,UP_4494))
                                            )
                                            else
                                                {5110}let v_4495: bool = (Sess_3941 = C) in
                                                (
                                                    {5111}if v_4495 then
                                                    (
                                                        {5112}let pkSess_4496: bitstring = pub(skC) in
                                                        {5113}in(c, =GetEndpointRequest);
                                                        {5114}new SP_4497: bitstring;
                                                        {5115}new UP_4498: bitstring;
                                                        {5116}out(c, (GetEndpointResponse,pkSess_4496,SignAndEncrypt,SP_4497,UP_4498))
                                                    )
                                                    else
                                                        {5117}let pkSess_4499: bitstring = pub(sk(Sess_3941)) in
                                                        {5118}in(c, =GetEndpointRequest);
                                                        {5119}new SP_4500: bitstring;
                                                        {5120}new UP_4501: bitstring;
                                                        {5121}out(c, (GetEndpointResponse,pkSess_4499,SignAndEncrypt,SP_4500,UP_4501))
                                                )
                                                else
                                                    {5122}let pkSess_4502: bitstring = fail-any in
                                                    {5123}in(c, =GetEndpointRequest);
                                                    {5124}new SP_4503: bitstring;
                                                    {5125}new UP_4504: bitstring;
                                                    {5126}out(c, (GetEndpointResponse,pkSess_4502,SignAndEncrypt,SP_4503,UP_4504))
                                        )
                                        else
                                            {5127}let pkSess_4505: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SP_4506: bitstring;
                                            {5130}new UP_4507: bitstring;
                                            {5131}out(c, (GetEndpointResponse,pkSess_4505,SignAndEncrypt,SP_4506,UP_4507))
                                )
                                else
                                    {5132}let pkSess_4508: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SP_4509: bitstring;
                                    {5135}new UP_4510: bitstring;
                                    {5136}out(c, (GetEndpointResponse,pkSess_4508,SignAndEncrypt,SP_4509,UP_4510))
                            )
                            else
                                {5137}let v_4511: bool = (Cli_3939 = B) in
                                (
                                    {5138}if v_4511 then
                                    (
                                        {5139}let pkCli_4512: bitstring = pub(skB) in
                                        {5140}let v_4513: bool = (Sess_3941 = A) in
                                        (
                                            {5141}if v_4513 then
                                            (
                                                {5142}let pkSess_4514: bitstring = pub(skA) in
                                                {5143}in(c, =GetEndpointRequest);
                                                {5144}new SP_4515: bitstring;
                                                {5145}new UP_4516: bitstring;
                                                {5146}out(c, (GetEndpointResponse,pkSess_4514,SignAndEncrypt,SP_4515,UP_4516))
                                            )
                                            else
                                                {5147}let v_4517: bool = (Sess_3941 = B) in
                                                (
                                                    {5148}if v_4517 then
                                                    (
                                                        {5149}let pkSess_4518: bitstring = pub(skB) in
                                                        {5150}in(c, =GetEndpointRequest);
                                                        {5151}new SP_4519: bitstring;
                                                        {5152}new UP_4520: bitstring;
                                                        {5153}out(c, (GetEndpointResponse,pkSess_4518,SignAndEncrypt,SP_4519,UP_4520))
                                                    )
                                                    else
                                                        {5154}let v_4521: bool = (Sess_3941 = C) in
                                                        (
                                                            {5155}if v_4521 then
                                                            (
                                                                {5156}let pkSess_4522: bitstring = pub(skC) in
                                                                {5157}in(c, =GetEndpointRequest);
                                                                {5158}new SP_4523: bitstring;
                                                                {5159}new UP_4524: bitstring;
                                                                {5160}out(c, (GetEndpointResponse,pkSess_4522,SignAndEncrypt,SP_4523,UP_4524))
                                                            )
                                                            else
                                                                {5161}let pkSess_4525: bitstring = pub(sk(Sess_3941)) in
                                                                {5162}in(c, =GetEndpointRequest);
                                                                {5163}new SP_4526: bitstring;
                                                                {5164}new UP_4527: bitstring;
                                                                {5165}out(c, (GetEndpointResponse,pkSess_4525,SignAndEncrypt,SP_4526,UP_4527))
                                                        )
                                                        else
                                                            {5166}let pkSess_4528: bitstring = fail-any in
                                                            {5167}in(c, =GetEndpointRequest);
                                                            {5168}new SP_4529: bitstring;
                                                            {5169}new UP_4530: bitstring;
                                                            {5170}out(c, (GetEndpointResponse,pkSess_4528,SignAndEncrypt,SP_4529,UP_4530))
                                                )
                                                else
                                                    {5171}let pkSess_4531: bitstring = fail-any in
                                                    {5172}in(c, =GetEndpointRequest);
                                                    {5173}new SP_4532: bitstring;
                                                    {5174}new UP_4533: bitstring;
                                                    {5175}out(c, (GetEndpointResponse,pkSess_4531,SignAndEncrypt,SP_4532,UP_4533))
                                        )
                                        else
                                            {5176}let pkSess_4534: bitstring = fail-any in
                                            {5177}in(c, =GetEndpointRequest);
                                            {5178}new SP_4535: bitstring;
                                            {5179}new UP_4536: bitstring;
                                            {5180}out(c, (GetEndpointResponse,pkSess_4534,SignAndEncrypt,SP_4535,UP_4536))
                                    )
                                    else
                                        {5181}let v_4537: bool = (Cli_3939 = C) in
                                        (
                                            {5182}if v_4537 then
                                            (
                                                {5183}let pkCli_4538: bitstring = pub(skC) in
                                                {5184}let v_4539: bool = (Sess_3941 = A) in
                                                (
                                                    {5185}if v_4539 then
                                                    (
                                                        {5186}let pkSess_4540: bitstring = pub(skA) in
                                                        {5187}in(c, =GetEndpointRequest);
                                                        {5188}new SP_4541: bitstring;
                                                        {5189}new UP_4542: bitstring;
                                                        {5190}out(c, (GetEndpointResponse,pkSess_4540,SignAndEncrypt,SP_4541,UP_4542))
                                                    )
                                                    else
                                                        {5191}let v_4543: bool = (Sess_3941 = B) in
                                                        (
                                                            {5192}if v_4543 then
                                                            (
                                                                {5193}let pkSess_4544: bitstring = pub(skB) in
                                                                {5194}in(c, =GetEndpointRequest);
                                                                {5195}new SP_4545: bitstring;
                                                                {5196}new UP_4546: bitstring;
                                                                {5197}out(c, (GetEndpointResponse,pkSess_4544,SignAndEncrypt,SP_4545,UP_4546))
                                                            )
                                                            else
                                                                {5198}let v_4547: bool = (Sess_3941 = C) in
                                                                (
                                                                    {5199}if v_4547 then
                                                                    (
                                                                        {5200}let pkSess_4548: bitstring = pub(skC) in
                                                                        {5201}in(c, =GetEndpointRequest);
                                                                        {5202}new SP_4549: bitstring;
                                                                        {5203}new UP_4550: bitstring;
                                                                        {5204}out(c, (GetEndpointResponse,pkSess_4548,SignAndEncrypt,SP_4549,UP_4550))
                                                                    )
                                                                    else
                                                                        {5205}let pkSess_4551: bitstring = pub(sk(Sess_3941)) in
                                                                        {5206}in(c, =GetEndpointRequest);
                                                                        {5207}new SP_4552: bitstring;
                                                                        {5208}new UP_4553: bitstring;
                                                                        {5209}out(c, (GetEndpointResponse,pkSess_4551,SignAndEncrypt,SP_4552,UP_4553))
                                                                )
                                                                else
                                                                    {5210}let pkSess_4554: bitstring = fail-any in
                                                                    {5211}in(c, =GetEndpointRequest);
                                                                    {5212}new SP_4555: bitstring;
                                                                    {5213}new UP_4556: bitstring;
                                                                    {5214}out(c, (GetEndpointResponse,pkSess_4554,SignAndEncrypt,SP_4555,UP_4556))
                                                        )
                                                        else
                                                            {5215}let pkSess_4557: bitstring = fail-any in
                                                            {5216}in(c, =GetEndpointRequest);
                                                            {5217}new SP_4558: bitstring;
                                                            {5218}new UP_4559: bitstring;
                                                            {5219}out(c, (GetEndpointResponse,pkSess_4557,SignAndEncrypt,SP_4558,UP_4559))
                                                )
                                                else
                                                    {5220}let pkSess_4560: bitstring = fail-any in
                                                    {5221}in(c, =GetEndpointRequest);
                                                    {5222}new SP_4561: bitstring;
                                                    {5223}new UP_4562: bitstring;
                                                    {5224}out(c, (GetEndpointResponse,pkSess_4560,SignAndEncrypt,SP_4561,UP_4562))
                                            )
                                            else
                                                {5225}let pkCli_4563: bitstring = pub(sk(Cli_3939)) in
                                                {5226}let v_4564: bool = (Sess_3941 = A) in
                                                (
                                                    {5227}if v_4564 then
                                                    (
                                                        {5228}let pkSess_4565: bitstring = pub(skA) in
                                                        {5229}in(c, =GetEndpointRequest);
                                                        {5230}new SP_4566: bitstring;
                                                        {5231}new UP_4567: bitstring;
                                                        {5232}out(c, (GetEndpointResponse,pkSess_4565,SignAndEncrypt,SP_4566,UP_4567))
                                                    )
                                                    else
                                                        {5233}let v_4568: bool = (Sess_3941 = B) in
                                                        (
                                                            {5234}if v_4568 then
                                                            (
                                                                {5235}let pkSess_4569: bitstring = pub(skB) in
                                                                {5236}in(c, =GetEndpointRequest);
                                                                {5237}new SP_4570: bitstring;
                                                                {5238}new UP_4571: bitstring;
                                                                {5239}out(c, (GetEndpointResponse,pkSess_4569,SignAndEncrypt,SP_4570,UP_4571))
                                                            )
                                                            else
                                                                {5240}let v_4572: bool = (Sess_3941 = C) in
                                                                (
                                                                    {5241}if v_4572 then
                                                                    (
                                                                        {5242}let pkSess_4573: bitstring = pub(skC) in
                                                                        {5243}in(c, =GetEndpointRequest);
                                                                        {5244}new SP_4574: bitstring;
                                                                        {5245}new UP_4575: bitstring;
                                                                        {5246}out(c, (GetEndpointResponse,pkSess_4573,SignAndEncrypt,SP_4574,UP_4575))
                                                                    )
                                                                    else
                                                                        {5247}let pkSess_4576: bitstring = pub(sk(Sess_3941)) in
                                                                        {5248}in(c, =GetEndpointRequest);
                                                                        {5249}new SP_4577: bitstring;
                                                                        {5250}new UP_4578: bitstring;
                                                                        {5251}out(c, (GetEndpointResponse,pkSess_4576,SignAndEncrypt,SP_4577,UP_4578))
                                                                )
                                                                else
                                                                    {5252}let pkSess_4579: bitstring = fail-any in
                                                                    {5253}in(c, =GetEndpointRequest);
                                                                    {5254}new SP_4580: bitstring;
                                                                    {5255}new UP_4581: bitstring;
                                                                    {5256}out(c, (GetEndpointResponse,pkSess_4579,SignAndEncrypt,SP_4580,UP_4581))
                                                        )
                                                        else
                                                            {5257}let pkSess_4582: bitstring = fail-any in
                                                            {5258}in(c, =GetEndpointRequest);
                                                            {5259}new SP_4583: bitstring;
                                                            {5260}new UP_4584: bitstring;
                                                            {5261}out(c, (GetEndpointResponse,pkSess_4582,SignAndEncrypt,SP_4583,UP_4584))
                                                )
                                                else
                                                    {5262}let pkSess_4585: bitstring = fail-any in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_4586: bitstring;
                                                    {5265}new UP_4587: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_4585,SignAndEncrypt,SP_4586,UP_4587))
                                        )
                                        else
                                            {5267}let pkCli_4588: bitstring = fail-any in
                                            {5268}let v_4589: bool = (Sess_3941 = A) in
                                            (
                                                {5269}if v_4589 then
                                                (
                                                    {5270}let pkSess_4590: bitstring = pub(skA) in
                                                    {5271}in(c, =GetEndpointRequest);
                                                    {5272}new SP_4591: bitstring;
                                                    {5273}new UP_4592: bitstring;
                                                    {5274}out(c, (GetEndpointResponse,pkSess_4590,SignAndEncrypt,SP_4591,UP_4592))
                                                )
                                                else
                                                    {5275}let v_4593: bool = (Sess_3941 = B) in
                                                    (
                                                        {5276}if v_4593 then
                                                        (
                                                            {5277}let pkSess_4594: bitstring = pub(skB) in
                                                            {5278}in(c, =GetEndpointRequest);
                                                            {5279}new SP_4595: bitstring;
                                                            {5280}new UP_4596: bitstring;
                                                            {5281}out(c, (GetEndpointResponse,pkSess_4594,SignAndEncrypt,SP_4595,UP_4596))
                                                        )
                                                        else
                                                            {5282}let v_4597: bool = (Sess_3941 = C) in
                                                            (
                                                                {5283}if v_4597 then
                                                                (
                                                                    {5284}let pkSess_4598: bitstring = pub(skC) in
                                                                    {5285}in(c, =GetEndpointRequest);
                                                                    {5286}new SP_4599: bitstring;
                                                                    {5287}new UP_4600: bitstring;
                                                                    {5288}out(c, (GetEndpointResponse,pkSess_4598,SignAndEncrypt,SP_4599,UP_4600))
                                                                )
                                                                else
                                                                    {5289}let pkSess_4601: bitstring = pub(sk(Sess_3941)) in
                                                                    {5290}in(c, =GetEndpointRequest);
                                                                    {5291}new SP_4602: bitstring;
                                                                    {5292}new UP_4603: bitstring;
                                                                    {5293}out(c, (GetEndpointResponse,pkSess_4601,SignAndEncrypt,SP_4602,UP_4603))
                                                            )
                                                            else
                                                                {5294}let pkSess_4604: bitstring = fail-any in
                                                                {5295}in(c, =GetEndpointRequest);
                                                                {5296}new SP_4605: bitstring;
                                                                {5297}new UP_4606: bitstring;
                                                                {5298}out(c, (GetEndpointResponse,pkSess_4604,SignAndEncrypt,SP_4605,UP_4606))
                                                    )
                                                    else
                                                        {5299}let pkSess_4607: bitstring = fail-any in
                                                        {5300}in(c, =GetEndpointRequest);
                                                        {5301}new SP_4608: bitstring;
                                                        {5302}new UP_4609: bitstring;
                                                        {5303}out(c, (GetEndpointResponse,pkSess_4607,SignAndEncrypt,SP_4608,UP_4609))
                                            )
                                            else
                                                {5304}let pkSess_4610: bitstring = fail-any in
                                                {5305}in(c, =GetEndpointRequest);
                                                {5306}new SP_4611: bitstring;
                                                {5307}new UP_4612: bitstring;
                                                {5308}out(c, (GetEndpointResponse,pkSess_4610,SignAndEncrypt,SP_4611,UP_4612))
                                )
                                else
                                    {5309}let pkCli_4613: bitstring = fail-any in
                                    {5310}let v_4614: bool = (Sess_3941 = A) in
                                    (
                                        {5311}if v_4614 then
                                        (
                                            {5312}let pkSess_4615: bitstring = pub(skA) in
                                            {5313}in(c, =GetEndpointRequest);
                                            {5314}new SP_4616: bitstring;
                                            {5315}new UP_4617: bitstring;
                                            {5316}out(c, (GetEndpointResponse,pkSess_4615,SignAndEncrypt,SP_4616,UP_4617))
                                        )
                                        else
                                            {5317}let v_4618: bool = (Sess_3941 = B) in
                                            (
                                                {5318}if v_4618 then
                                                (
                                                    {5319}let pkSess_4619: bitstring = pub(skB) in
                                                    {5320}in(c, =GetEndpointRequest);
                                                    {5321}new SP_4620: bitstring;
                                                    {5322}new UP_4621: bitstring;
                                                    {5323}out(c, (GetEndpointResponse,pkSess_4619,SignAndEncrypt,SP_4620,UP_4621))
                                                )
                                                else
                                                    {5324}let v_4622: bool = (Sess_3941 = C) in
                                                    (
                                                        {5325}if v_4622 then
                                                        (
                                                            {5326}let pkSess_4623: bitstring = pub(skC) in
                                                            {5327}in(c, =GetEndpointRequest);
                                                            {5328}new SP_4624: bitstring;
                                                            {5329}new UP_4625: bitstring;
                                                            {5330}out(c, (GetEndpointResponse,pkSess_4623,SignAndEncrypt,SP_4624,UP_4625))
                                                        )
                                                        else
                                                            {5331}let pkSess_4626: bitstring = pub(sk(Sess_3941)) in
                                                            {5332}in(c, =GetEndpointRequest);
                                                            {5333}new SP_4627: bitstring;
                                                            {5334}new UP_4628: bitstring;
                                                            {5335}out(c, (GetEndpointResponse,pkSess_4626,SignAndEncrypt,SP_4627,UP_4628))
                                                    )
                                                    else
                                                        {5336}let pkSess_4629: bitstring = fail-any in
                                                        {5337}in(c, =GetEndpointRequest);
                                                        {5338}new SP_4630: bitstring;
                                                        {5339}new UP_4631: bitstring;
                                                        {5340}out(c, (GetEndpointResponse,pkSess_4629,SignAndEncrypt,SP_4630,UP_4631))
                                            )
                                            else
                                                {5341}let pkSess_4632: bitstring = fail-any in
                                                {5342}in(c, =GetEndpointRequest);
                                                {5343}new SP_4633: bitstring;
                                                {5344}new UP_4634: bitstring;
                                                {5345}out(c, (GetEndpointResponse,pkSess_4632,SignAndEncrypt,SP_4633,UP_4634))
                                    )
                                    else
                                        {5346}let pkSess_4635: bitstring = fail-any in
                                        {5347}in(c, =GetEndpointRequest);
                                        {5348}new SP_4636: bitstring;
                                        {5349}new UP_4637: bitstring;
                                        {5350}out(c, (GetEndpointResponse,pkSess_4635,SignAndEncrypt,SP_4636,UP_4637))
                        )
                        else
                            {5351}let pkCli_4638: bitstring = fail-any in
                            {5352}let v_4639: bool = (Sess_3941 = A) in
                            (
                                {5353}if v_4639 then
                                (
                                    {5354}let pkSess_4640: bitstring = pub(skA) in
                                    {5355}in(c, =GetEndpointRequest);
                                    {5356}new SP_4641: bitstring;
                                    {5357}new UP_4642: bitstring;
                                    {5358}out(c, (GetEndpointResponse,pkSess_4640,SignAndEncrypt,SP_4641,UP_4642))
                                )
                                else
                                    {5359}let v_4643: bool = (Sess_3941 = B) in
                                    (
                                        {5360}if v_4643 then
                                        (
                                            {5361}let pkSess_4644: bitstring = pub(skB) in
                                            {5362}in(c, =GetEndpointRequest);
                                            {5363}new SP_4645: bitstring;
                                            {5364}new UP_4646: bitstring;
                                            {5365}out(c, (GetEndpointResponse,pkSess_4644,SignAndEncrypt,SP_4645,UP_4646))
                                        )
                                        else
                                            {5366}let v_4647: bool = (Sess_3941 = C) in
                                            (
                                                {5367}if v_4647 then
                                                (
                                                    {5368}let pkSess_4648: bitstring = pub(skC) in
                                                    {5369}in(c, =GetEndpointRequest);
                                                    {5370}new SP_4649: bitstring;
                                                    {5371}new UP_4650: bitstring;
                                                    {5372}out(c, (GetEndpointResponse,pkSess_4648,SignAndEncrypt,SP_4649,UP_4650))
                                                )
                                                else
                                                    {5373}let pkSess_4651: bitstring = pub(sk(Sess_3941)) in
                                                    {5374}in(c, =GetEndpointRequest);
                                                    {5375}new SP_4652: bitstring;
                                                    {5376}new UP_4653: bitstring;
                                                    {5377}out(c, (GetEndpointResponse,pkSess_4651,SignAndEncrypt,SP_4652,UP_4653))
                                            )
                                            else
                                                {5378}let pkSess_4654: bitstring = fail-any in
                                                {5379}in(c, =GetEndpointRequest);
                                                {5380}new SP_4655: bitstring;
                                                {5381}new UP_4656: bitstring;
                                                {5382}out(c, (GetEndpointResponse,pkSess_4654,SignAndEncrypt,SP_4655,UP_4656))
                                    )
                                    else
                                        {5383}let pkSess_4657: bitstring = fail-any in
                                        {5384}in(c, =GetEndpointRequest);
                                        {5385}new SP_4658: bitstring;
                                        {5386}new UP_4659: bitstring;
                                        {5387}out(c, (GetEndpointResponse,pkSess_4657,SignAndEncrypt,SP_4658,UP_4659))
                            )
                            else
                                {5388}let pkSess_4660: bitstring = fail-any in
                                {5389}in(c, =GetEndpointRequest);
                                {5390}new SP_4661: bitstring;
                                {5391}new UP_4662: bitstring;
                                {5392}out(c, (GetEndpointResponse,pkSess_4660,SignAndEncrypt,SP_4661,UP_4662))
            )
            else
                {5393}let skDisco_4663: bitstring = fail-any in
                {5394}let pkDisco_4664: bitstring = pub(skDisco_4663) in
                {5395}let v_4665: bool = (Cli_3939 = A) in
                (
                    {5396}if v_4665 then
                    (
                        {5397}let pkCli_4666: bitstring = pub(skA) in
                        {5398}let v_4667: bool = (Sess_3941 = A) in
                        (
                            {5399}if v_4667 then
                            (
                                {5400}let pkSess_4668: bitstring = pub(skA) in
                                {5401}in(c, =GetEndpointRequest);
                                {5402}new SP_4669: bitstring;
                                {5403}new UP_4670: bitstring;
                                {5404}out(c, (GetEndpointResponse,pkSess_4668,SignAndEncrypt,SP_4669,UP_4670))
                            )
                            else
                                {5405}let v_4671: bool = (Sess_3941 = B) in
                                (
                                    {5406}if v_4671 then
                                    (
                                        {5407}let pkSess_4672: bitstring = pub(skB) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SP_4673: bitstring;
                                        {5410}new UP_4674: bitstring;
                                        {5411}out(c, (GetEndpointResponse,pkSess_4672,SignAndEncrypt,SP_4673,UP_4674))
                                    )
                                    else
                                        {5412}let v_4675: bool = (Sess_3941 = C) in
                                        (
                                            {5413}if v_4675 then
                                            (
                                                {5414}let pkSess_4676: bitstring = pub(skC) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SP_4677: bitstring;
                                                {5417}new UP_4678: bitstring;
                                                {5418}out(c, (GetEndpointResponse,pkSess_4676,SignAndEncrypt,SP_4677,UP_4678))
                                            )
                                            else
                                                {5419}let pkSess_4679: bitstring = pub(sk(Sess_3941)) in
                                                {5420}in(c, =GetEndpointRequest);
                                                {5421}new SP_4680: bitstring;
                                                {5422}new UP_4681: bitstring;
                                                {5423}out(c, (GetEndpointResponse,pkSess_4679,SignAndEncrypt,SP_4680,UP_4681))
                                        )
                                        else
                                            {5424}let pkSess_4682: bitstring = fail-any in
                                            {5425}in(c, =GetEndpointRequest);
                                            {5426}new SP_4683: bitstring;
                                            {5427}new UP_4684: bitstring;
                                            {5428}out(c, (GetEndpointResponse,pkSess_4682,SignAndEncrypt,SP_4683,UP_4684))
                                )
                                else
                                    {5429}let pkSess_4685: bitstring = fail-any in
                                    {5430}in(c, =GetEndpointRequest);
                                    {5431}new SP_4686: bitstring;
                                    {5432}new UP_4687: bitstring;
                                    {5433}out(c, (GetEndpointResponse,pkSess_4685,SignAndEncrypt,SP_4686,UP_4687))
                        )
                        else
                            {5434}let pkSess_4688: bitstring = fail-any in
                            {5435}in(c, =GetEndpointRequest);
                            {5436}new SP_4689: bitstring;
                            {5437}new UP_4690: bitstring;
                            {5438}out(c, (GetEndpointResponse,pkSess_4688,SignAndEncrypt,SP_4689,UP_4690))
                    )
                    else
                        {5439}let v_4691: bool = (Cli_3939 = B) in
                        (
                            {5440}if v_4691 then
                            (
                                {5441}let pkCli_4692: bitstring = pub(skB) in
                                {5442}let v_4693: bool = (Sess_3941 = A) in
                                (
                                    {5443}if v_4693 then
                                    (
                                        {5444}let pkSess_4694: bitstring = pub(skA) in
                                        {5445}in(c, =GetEndpointRequest);
                                        {5446}new SP_4695: bitstring;
                                        {5447}new UP_4696: bitstring;
                                        {5448}out(c, (GetEndpointResponse,pkSess_4694,SignAndEncrypt,SP_4695,UP_4696))
                                    )
                                    else
                                        {5449}let v_4697: bool = (Sess_3941 = B) in
                                        (
                                            {5450}if v_4697 then
                                            (
                                                {5451}let pkSess_4698: bitstring = pub(skB) in
                                                {5452}in(c, =GetEndpointRequest);
                                                {5453}new SP_4699: bitstring;
                                                {5454}new UP_4700: bitstring;
                                                {5455}out(c, (GetEndpointResponse,pkSess_4698,SignAndEncrypt,SP_4699,UP_4700))
                                            )
                                            else
                                                {5456}let v_4701: bool = (Sess_3941 = C) in
                                                (
                                                    {5457}if v_4701 then
                                                    (
                                                        {5458}let pkSess_4702: bitstring = pub(skC) in
                                                        {5459}in(c, =GetEndpointRequest);
                                                        {5460}new SP_4703: bitstring;
                                                        {5461}new UP_4704: bitstring;
                                                        {5462}out(c, (GetEndpointResponse,pkSess_4702,SignAndEncrypt,SP_4703,UP_4704))
                                                    )
                                                    else
                                                        {5463}let pkSess_4705: bitstring = pub(sk(Sess_3941)) in
                                                        {5464}in(c, =GetEndpointRequest);
                                                        {5465}new SP_4706: bitstring;
                                                        {5466}new UP_4707: bitstring;
                                                        {5467}out(c, (GetEndpointResponse,pkSess_4705,SignAndEncrypt,SP_4706,UP_4707))
                                                )
                                                else
                                                    {5468}let pkSess_4708: bitstring = fail-any in
                                                    {5469}in(c, =GetEndpointRequest);
                                                    {5470}new SP_4709: bitstring;
                                                    {5471}new UP_4710: bitstring;
                                                    {5472}out(c, (GetEndpointResponse,pkSess_4708,SignAndEncrypt,SP_4709,UP_4710))
                                        )
                                        else
                                            {5473}let pkSess_4711: bitstring = fail-any in
                                            {5474}in(c, =GetEndpointRequest);
                                            {5475}new SP_4712: bitstring;
                                            {5476}new UP_4713: bitstring;
                                            {5477}out(c, (GetEndpointResponse,pkSess_4711,SignAndEncrypt,SP_4712,UP_4713))
                                )
                                else
                                    {5478}let pkSess_4714: bitstring = fail-any in
                                    {5479}in(c, =GetEndpointRequest);
                                    {5480}new SP_4715: bitstring;
                                    {5481}new UP_4716: bitstring;
                                    {5482}out(c, (GetEndpointResponse,pkSess_4714,SignAndEncrypt,SP_4715,UP_4716))
                            )
                            else
                                {5483}let v_4717: bool = (Cli_3939 = C) in
                                (
                                    {5484}if v_4717 then
                                    (
                                        {5485}let pkCli_4718: bitstring = pub(skC) in
                                        {5486}let v_4719: bool = (Sess_3941 = A) in
                                        (
                                            {5487}if v_4719 then
                                            (
                                                {5488}let pkSess_4720: bitstring = pub(skA) in
                                                {5489}in(c, =GetEndpointRequest);
                                                {5490}new SP_4721: bitstring;
                                                {5491}new UP_4722: bitstring;
                                                {5492}out(c, (GetEndpointResponse,pkSess_4720,SignAndEncrypt,SP_4721,UP_4722))
                                            )
                                            else
                                                {5493}let v_4723: bool = (Sess_3941 = B) in
                                                (
                                                    {5494}if v_4723 then
                                                    (
                                                        {5495}let pkSess_4724: bitstring = pub(skB) in
                                                        {5496}in(c, =GetEndpointRequest);
                                                        {5497}new SP_4725: bitstring;
                                                        {5498}new UP_4726: bitstring;
                                                        {5499}out(c, (GetEndpointResponse,pkSess_4724,SignAndEncrypt,SP_4725,UP_4726))
                                                    )
                                                    else
                                                        {5500}let v_4727: bool = (Sess_3941 = C) in
                                                        (
                                                            {5501}if v_4727 then
                                                            (
                                                                {5502}let pkSess_4728: bitstring = pub(skC) in
                                                                {5503}in(c, =GetEndpointRequest);
                                                                {5504}new SP_4729: bitstring;
                                                                {5505}new UP_4730: bitstring;
                                                                {5506}out(c, (GetEndpointResponse,pkSess_4728,SignAndEncrypt,SP_4729,UP_4730))
                                                            )
                                                            else
                                                                {5507}let pkSess_4731: bitstring = pub(sk(Sess_3941)) in
                                                                {5508}in(c, =GetEndpointRequest);
                                                                {5509}new SP_4732: bitstring;
                                                                {5510}new UP_4733: bitstring;
                                                                {5511}out(c, (GetEndpointResponse,pkSess_4731,SignAndEncrypt,SP_4732,UP_4733))
                                                        )
                                                        else
                                                            {5512}let pkSess_4734: bitstring = fail-any in
                                                            {5513}in(c, =GetEndpointRequest);
                                                            {5514}new SP_4735: bitstring;
                                                            {5515}new UP_4736: bitstring;
                                                            {5516}out(c, (GetEndpointResponse,pkSess_4734,SignAndEncrypt,SP_4735,UP_4736))
                                                )
                                                else
                                                    {5517}let pkSess_4737: bitstring = fail-any in
                                                    {5518}in(c, =GetEndpointRequest);
                                                    {5519}new SP_4738: bitstring;
                                                    {5520}new UP_4739: bitstring;
                                                    {5521}out(c, (GetEndpointResponse,pkSess_4737,SignAndEncrypt,SP_4738,UP_4739))
                                        )
                                        else
                                            {5522}let pkSess_4740: bitstring = fail-any in
                                            {5523}in(c, =GetEndpointRequest);
                                            {5524}new SP_4741: bitstring;
                                            {5525}new UP_4742: bitstring;
                                            {5526}out(c, (GetEndpointResponse,pkSess_4740,SignAndEncrypt,SP_4741,UP_4742))
                                    )
                                    else
                                        {5527}let pkCli_4743: bitstring = pub(sk(Cli_3939)) in
                                        {5528}let v_4744: bool = (Sess_3941 = A) in
                                        (
                                            {5529}if v_4744 then
                                            (
                                                {5530}let pkSess_4745: bitstring = pub(skA) in
                                                {5531}in(c, =GetEndpointRequest);
                                                {5532}new SP_4746: bitstring;
                                                {5533}new UP_4747: bitstring;
                                                {5534}out(c, (GetEndpointResponse,pkSess_4745,SignAndEncrypt,SP_4746,UP_4747))
                                            )
                                            else
                                                {5535}let v_4748: bool = (Sess_3941 = B) in
                                                (
                                                    {5536}if v_4748 then
                                                    (
                                                        {5537}let pkSess_4749: bitstring = pub(skB) in
                                                        {5538}in(c, =GetEndpointRequest);
                                                        {5539}new SP_4750: bitstring;
                                                        {5540}new UP_4751: bitstring;
                                                        {5541}out(c, (GetEndpointResponse,pkSess_4749,SignAndEncrypt,SP_4750,UP_4751))
                                                    )
                                                    else
                                                        {5542}let v_4752: bool = (Sess_3941 = C) in
                                                        (
                                                            {5543}if v_4752 then
                                                            (
                                                                {5544}let pkSess_4753: bitstring = pub(skC) in
                                                                {5545}in(c, =GetEndpointRequest);
                                                                {5546}new SP_4754: bitstring;
                                                                {5547}new UP_4755: bitstring;
                                                                {5548}out(c, (GetEndpointResponse,pkSess_4753,SignAndEncrypt,SP_4754,UP_4755))
                                                            )
                                                            else
                                                                {5549}let pkSess_4756: bitstring = pub(sk(Sess_3941)) in
                                                                {5550}in(c, =GetEndpointRequest);
                                                                {5551}new SP_4757: bitstring;
                                                                {5552}new UP_4758: bitstring;
                                                                {5553}out(c, (GetEndpointResponse,pkSess_4756,SignAndEncrypt,SP_4757,UP_4758))
                                                        )
                                                        else
                                                            {5554}let pkSess_4759: bitstring = fail-any in
                                                            {5555}in(c, =GetEndpointRequest);
                                                            {5556}new SP_4760: bitstring;
                                                            {5557}new UP_4761: bitstring;
                                                            {5558}out(c, (GetEndpointResponse,pkSess_4759,SignAndEncrypt,SP_4760,UP_4761))
                                                )
                                                else
                                                    {5559}let pkSess_4762: bitstring = fail-any in
                                                    {5560}in(c, =GetEndpointRequest);
                                                    {5561}new SP_4763: bitstring;
                                                    {5562}new UP_4764: bitstring;
                                                    {5563}out(c, (GetEndpointResponse,pkSess_4762,SignAndEncrypt,SP_4763,UP_4764))
                                        )
                                        else
                                            {5564}let pkSess_4765: bitstring = fail-any in
                                            {5565}in(c, =GetEndpointRequest);
                                            {5566}new SP_4766: bitstring;
                                            {5567}new UP_4767: bitstring;
                                            {5568}out(c, (GetEndpointResponse,pkSess_4765,SignAndEncrypt,SP_4766,UP_4767))
                                )
                                else
                                    {5569}let pkCli_4768: bitstring = fail-any in
                                    {5570}let v_4769: bool = (Sess_3941 = A) in
                                    (
                                        {5571}if v_4769 then
                                        (
                                            {5572}let pkSess_4770: bitstring = pub(skA) in
                                            {5573}in(c, =GetEndpointRequest);
                                            {5574}new SP_4771: bitstring;
                                            {5575}new UP_4772: bitstring;
                                            {5576}out(c, (GetEndpointResponse,pkSess_4770,SignAndEncrypt,SP_4771,UP_4772))
                                        )
                                        else
                                            {5577}let v_4773: bool = (Sess_3941 = B) in
                                            (
                                                {5578}if v_4773 then
                                                (
                                                    {5579}let pkSess_4774: bitstring = pub(skB) in
                                                    {5580}in(c, =GetEndpointRequest);
                                                    {5581}new SP_4775: bitstring;
                                                    {5582}new UP_4776: bitstring;
                                                    {5583}out(c, (GetEndpointResponse,pkSess_4774,SignAndEncrypt,SP_4775,UP_4776))
                                                )
                                                else
                                                    {5584}let v_4777: bool = (Sess_3941 = C) in
                                                    (
                                                        {5585}if v_4777 then
                                                        (
                                                            {5586}let pkSess_4778: bitstring = pub(skC) in
                                                            {5587}in(c, =GetEndpointRequest);
                                                            {5588}new SP_4779: bitstring;
                                                            {5589}new UP_4780: bitstring;
                                                            {5590}out(c, (GetEndpointResponse,pkSess_4778,SignAndEncrypt,SP_4779,UP_4780))
                                                        )
                                                        else
                                                            {5591}let pkSess_4781: bitstring = pub(sk(Sess_3941)) in
                                                            {5592}in(c, =GetEndpointRequest);
                                                            {5593}new SP_4782: bitstring;
                                                            {5594}new UP_4783: bitstring;
                                                            {5595}out(c, (GetEndpointResponse,pkSess_4781,SignAndEncrypt,SP_4782,UP_4783))
                                                    )
                                                    else
                                                        {5596}let pkSess_4784: bitstring = fail-any in
                                                        {5597}in(c, =GetEndpointRequest);
                                                        {5598}new SP_4785: bitstring;
                                                        {5599}new UP_4786: bitstring;
                                                        {5600}out(c, (GetEndpointResponse,pkSess_4784,SignAndEncrypt,SP_4785,UP_4786))
                                            )
                                            else
                                                {5601}let pkSess_4787: bitstring = fail-any in
                                                {5602}in(c, =GetEndpointRequest);
                                                {5603}new SP_4788: bitstring;
                                                {5604}new UP_4789: bitstring;
                                                {5605}out(c, (GetEndpointResponse,pkSess_4787,SignAndEncrypt,SP_4788,UP_4789))
                                    )
                                    else
                                        {5606}let pkSess_4790: bitstring = fail-any in
                                        {5607}in(c, =GetEndpointRequest);
                                        {5608}new SP_4791: bitstring;
                                        {5609}new UP_4792: bitstring;
                                        {5610}out(c, (GetEndpointResponse,pkSess_4790,SignAndEncrypt,SP_4791,UP_4792))
                        )
                        else
                            {5611}let pkCli_4793: bitstring = fail-any in
                            {5612}let v_4794: bool = (Sess_3941 = A) in
                            (
                                {5613}if v_4794 then
                                (
                                    {5614}let pkSess_4795: bitstring = pub(skA) in
                                    {5615}in(c, =GetEndpointRequest);
                                    {5616}new SP_4796: bitstring;
                                    {5617}new UP_4797: bitstring;
                                    {5618}out(c, (GetEndpointResponse,pkSess_4795,SignAndEncrypt,SP_4796,UP_4797))
                                )
                                else
                                    {5619}let v_4798: bool = (Sess_3941 = B) in
                                    (
                                        {5620}if v_4798 then
                                        (
                                            {5621}let pkSess_4799: bitstring = pub(skB) in
                                            {5622}in(c, =GetEndpointRequest);
                                            {5623}new SP_4800: bitstring;
                                            {5624}new UP_4801: bitstring;
                                            {5625}out(c, (GetEndpointResponse,pkSess_4799,SignAndEncrypt,SP_4800,UP_4801))
                                        )
                                        else
                                            {5626}let v_4802: bool = (Sess_3941 = C) in
                                            (
                                                {5627}if v_4802 then
                                                (
                                                    {5628}let pkSess_4803: bitstring = pub(skC) in
                                                    {5629}in(c, =GetEndpointRequest);
                                                    {5630}new SP_4804: bitstring;
                                                    {5631}new UP_4805: bitstring;
                                                    {5632}out(c, (GetEndpointResponse,pkSess_4803,SignAndEncrypt,SP_4804,UP_4805))
                                                )
                                                else
                                                    {5633}let pkSess_4806: bitstring = pub(sk(Sess_3941)) in
                                                    {5634}in(c, =GetEndpointRequest);
                                                    {5635}new SP_4807: bitstring;
                                                    {5636}new UP_4808: bitstring;
                                                    {5637}out(c, (GetEndpointResponse,pkSess_4806,SignAndEncrypt,SP_4807,UP_4808))
                                            )
                                            else
                                                {5638}let pkSess_4809: bitstring = fail-any in
                                                {5639}in(c, =GetEndpointRequest);
                                                {5640}new SP_4810: bitstring;
                                                {5641}new UP_4811: bitstring;
                                                {5642}out(c, (GetEndpointResponse,pkSess_4809,SignAndEncrypt,SP_4810,UP_4811))
                                    )
                                    else
                                        {5643}let pkSess_4812: bitstring = fail-any in
                                        {5644}in(c, =GetEndpointRequest);
                                        {5645}new SP_4813: bitstring;
                                        {5646}new UP_4814: bitstring;
                                        {5647}out(c, (GetEndpointResponse,pkSess_4812,SignAndEncrypt,SP_4813,UP_4814))
                            )
                            else
                                {5648}let pkSess_4815: bitstring = fail-any in
                                {5649}in(c, =GetEndpointRequest);
                                {5650}new SP_4816: bitstring;
                                {5651}new UP_4817: bitstring;
                                {5652}out(c, (GetEndpointResponse,pkSess_4815,SignAndEncrypt,SP_4816,UP_4817))
                )
                else
                    {5653}let pkCli_4818: bitstring = fail-any in
                    {5654}let v_4819: bool = (Sess_3941 = A) in
                    (
                        {5655}if v_4819 then
                        (
                            {5656}let pkSess_4820: bitstring = pub(skA) in
                            {5657}in(c, =GetEndpointRequest);
                            {5658}new SP_4821: bitstring;
                            {5659}new UP_4822: bitstring;
                            {5660}out(c, (GetEndpointResponse,pkSess_4820,SignAndEncrypt,SP_4821,UP_4822))
                        )
                        else
                            {5661}let v_4823: bool = (Sess_3941 = B) in
                            (
                                {5662}if v_4823 then
                                (
                                    {5663}let pkSess_4824: bitstring = pub(skB) in
                                    {5664}in(c, =GetEndpointRequest);
                                    {5665}new SP_4825: bitstring;
                                    {5666}new UP_4826: bitstring;
                                    {5667}out(c, (GetEndpointResponse,pkSess_4824,SignAndEncrypt,SP_4825,UP_4826))
                                )
                                else
                                    {5668}let v_4827: bool = (Sess_3941 = C) in
                                    (
                                        {5669}if v_4827 then
                                        (
                                            {5670}let pkSess_4828: bitstring = pub(skC) in
                                            {5671}in(c, =GetEndpointRequest);
                                            {5672}new SP_4829: bitstring;
                                            {5673}new UP_4830: bitstring;
                                            {5674}out(c, (GetEndpointResponse,pkSess_4828,SignAndEncrypt,SP_4829,UP_4830))
                                        )
                                        else
                                            {5675}let pkSess_4831: bitstring = pub(sk(Sess_3941)) in
                                            {5676}in(c, =GetEndpointRequest);
                                            {5677}new SP_4832: bitstring;
                                            {5678}new UP_4833: bitstring;
                                            {5679}out(c, (GetEndpointResponse,pkSess_4831,SignAndEncrypt,SP_4832,UP_4833))
                                    )
                                    else
                                        {5680}let pkSess_4834: bitstring = fail-any in
                                        {5681}in(c, =GetEndpointRequest);
                                        {5682}new SP_4835: bitstring;
                                        {5683}new UP_4836: bitstring;
                                        {5684}out(c, (GetEndpointResponse,pkSess_4834,SignAndEncrypt,SP_4835,UP_4836))
                            )
                            else
                                {5685}let pkSess_4837: bitstring = fail-any in
                                {5686}in(c, =GetEndpointRequest);
                                {5687}new SP_4838: bitstring;
                                {5688}new UP_4839: bitstring;
                                {5689}out(c, (GetEndpointResponse,pkSess_4837,SignAndEncrypt,SP_4838,UP_4839))
                    )
                    else
                        {5690}let pkSess_4840: bitstring = fail-any in
                        {5691}in(c, =GetEndpointRequest);
                        {5692}new SP_4841: bitstring;
                        {5693}new UP_4842: bitstring;
                        {5694}out(c, (GetEndpointResponse,pkSess_4840,SignAndEncrypt,SP_4841,UP_4842))
    )
    else
        {5695}let skDisco_4843: bitstring = fail-any in
        {5696}let pkDisco_4844: bitstring = pub(skDisco_4843) in
        {5697}let v_4845: bool = (Cli_3939 = A) in
        (
            {5698}if v_4845 then
            (
                {5699}let pkCli_4846: bitstring = pub(skA) in
                {5700}let v_4847: bool = (Sess_3941 = A) in
                (
                    {5701}if v_4847 then
                    (
                        {5702}let pkSess_4848: bitstring = pub(skA) in
                        {5703}in(c, =GetEndpointRequest);
                        {5704}new SP_4849: bitstring;
                        {5705}new UP_4850: bitstring;
                        {5706}out(c, (GetEndpointResponse,pkSess_4848,SignAndEncrypt,SP_4849,UP_4850))
                    )
                    else
                        {5707}let v_4851: bool = (Sess_3941 = B) in
                        (
                            {5708}if v_4851 then
                            (
                                {5709}let pkSess_4852: bitstring = pub(skB) in
                                {5710}in(c, =GetEndpointRequest);
                                {5711}new SP_4853: bitstring;
                                {5712}new UP_4854: bitstring;
                                {5713}out(c, (GetEndpointResponse,pkSess_4852,SignAndEncrypt,SP_4853,UP_4854))
                            )
                            else
                                {5714}let v_4855: bool = (Sess_3941 = C) in
                                (
                                    {5715}if v_4855 then
                                    (
                                        {5716}let pkSess_4856: bitstring = pub(skC) in
                                        {5717}in(c, =GetEndpointRequest);
                                        {5718}new SP_4857: bitstring;
                                        {5719}new UP_4858: bitstring;
                                        {5720}out(c, (GetEndpointResponse,pkSess_4856,SignAndEncrypt,SP_4857,UP_4858))
                                    )
                                    else
                                        {5721}let pkSess_4859: bitstring = pub(sk(Sess_3941)) in
                                        {5722}in(c, =GetEndpointRequest);
                                        {5723}new SP_4860: bitstring;
                                        {5724}new UP_4861: bitstring;
                                        {5725}out(c, (GetEndpointResponse,pkSess_4859,SignAndEncrypt,SP_4860,UP_4861))
                                )
                                else
                                    {5726}let pkSess_4862: bitstring = fail-any in
                                    {5727}in(c, =GetEndpointRequest);
                                    {5728}new SP_4863: bitstring;
                                    {5729}new UP_4864: bitstring;
                                    {5730}out(c, (GetEndpointResponse,pkSess_4862,SignAndEncrypt,SP_4863,UP_4864))
                        )
                        else
                            {5731}let pkSess_4865: bitstring = fail-any in
                            {5732}in(c, =GetEndpointRequest);
                            {5733}new SP_4866: bitstring;
                            {5734}new UP_4867: bitstring;
                            {5735}out(c, (GetEndpointResponse,pkSess_4865,SignAndEncrypt,SP_4866,UP_4867))
                )
                else
                    {5736}let pkSess_4868: bitstring = fail-any in
                    {5737}in(c, =GetEndpointRequest);
                    {5738}new SP_4869: bitstring;
                    {5739}new UP_4870: bitstring;
                    {5740}out(c, (GetEndpointResponse,pkSess_4868,SignAndEncrypt,SP_4869,UP_4870))
            )
            else
                {5741}let v_4871: bool = (Cli_3939 = B) in
                (
                    {5742}if v_4871 then
                    (
                        {5743}let pkCli_4872: bitstring = pub(skB) in
                        {5744}let v_4873: bool = (Sess_3941 = A) in
                        (
                            {5745}if v_4873 then
                            (
                                {5746}let pkSess_4874: bitstring = pub(skA) in
                                {5747}in(c, =GetEndpointRequest);
                                {5748}new SP_4875: bitstring;
                                {5749}new UP_4876: bitstring;
                                {5750}out(c, (GetEndpointResponse,pkSess_4874,SignAndEncrypt,SP_4875,UP_4876))
                            )
                            else
                                {5751}let v_4877: bool = (Sess_3941 = B) in
                                (
                                    {5752}if v_4877 then
                                    (
                                        {5753}let pkSess_4878: bitstring = pub(skB) in
                                        {5754}in(c, =GetEndpointRequest);
                                        {5755}new SP_4879: bitstring;
                                        {5756}new UP_4880: bitstring;
                                        {5757}out(c, (GetEndpointResponse,pkSess_4878,SignAndEncrypt,SP_4879,UP_4880))
                                    )
                                    else
                                        {5758}let v_4881: bool = (Sess_3941 = C) in
                                        (
                                            {5759}if v_4881 then
                                            (
                                                {5760}let pkSess_4882: bitstring = pub(skC) in
                                                {5761}in(c, =GetEndpointRequest);
                                                {5762}new SP_4883: bitstring;
                                                {5763}new UP_4884: bitstring;
                                                {5764}out(c, (GetEndpointResponse,pkSess_4882,SignAndEncrypt,SP_4883,UP_4884))
                                            )
                                            else
                                                {5765}let pkSess_4885: bitstring = pub(sk(Sess_3941)) in
                                                {5766}in(c, =GetEndpointRequest);
                                                {5767}new SP_4886: bitstring;
                                                {5768}new UP_4887: bitstring;
                                                {5769}out(c, (GetEndpointResponse,pkSess_4885,SignAndEncrypt,SP_4886,UP_4887))
                                        )
                                        else
                                            {5770}let pkSess_4888: bitstring = fail-any in
                                            {5771}in(c, =GetEndpointRequest);
                                            {5772}new SP_4889: bitstring;
                                            {5773}new UP_4890: bitstring;
                                            {5774}out(c, (GetEndpointResponse,pkSess_4888,SignAndEncrypt,SP_4889,UP_4890))
                                )
                                else
                                    {5775}let pkSess_4891: bitstring = fail-any in
                                    {5776}in(c, =GetEndpointRequest);
                                    {5777}new SP_4892: bitstring;
                                    {5778}new UP_4893: bitstring;
                                    {5779}out(c, (GetEndpointResponse,pkSess_4891,SignAndEncrypt,SP_4892,UP_4893))
                        )
                        else
                            {5780}let pkSess_4894: bitstring = fail-any in
                            {5781}in(c, =GetEndpointRequest);
                            {5782}new SP_4895: bitstring;
                            {5783}new UP_4896: bitstring;
                            {5784}out(c, (GetEndpointResponse,pkSess_4894,SignAndEncrypt,SP_4895,UP_4896))
                    )
                    else
                        {5785}let v_4897: bool = (Cli_3939 = C) in
                        (
                            {5786}if v_4897 then
                            (
                                {5787}let pkCli_4898: bitstring = pub(skC) in
                                {5788}let v_4899: bool = (Sess_3941 = A) in
                                (
                                    {5789}if v_4899 then
                                    (
                                        {5790}let pkSess_4900: bitstring = pub(skA) in
                                        {5791}in(c, =GetEndpointRequest);
                                        {5792}new SP_4901: bitstring;
                                        {5793}new UP_4902: bitstring;
                                        {5794}out(c, (GetEndpointResponse,pkSess_4900,SignAndEncrypt,SP_4901,UP_4902))
                                    )
                                    else
                                        {5795}let v_4903: bool = (Sess_3941 = B) in
                                        (
                                            {5796}if v_4903 then
                                            (
                                                {5797}let pkSess_4904: bitstring = pub(skB) in
                                                {5798}in(c, =GetEndpointRequest);
                                                {5799}new SP_4905: bitstring;
                                                {5800}new UP_4906: bitstring;
                                                {5801}out(c, (GetEndpointResponse,pkSess_4904,SignAndEncrypt,SP_4905,UP_4906))
                                            )
                                            else
                                                {5802}let v_4907: bool = (Sess_3941 = C) in
                                                (
                                                    {5803}if v_4907 then
                                                    (
                                                        {5804}let pkSess_4908: bitstring = pub(skC) in
                                                        {5805}in(c, =GetEndpointRequest);
                                                        {5806}new SP_4909: bitstring;
                                                        {5807}new UP_4910: bitstring;
                                                        {5808}out(c, (GetEndpointResponse,pkSess_4908,SignAndEncrypt,SP_4909,UP_4910))
                                                    )
                                                    else
                                                        {5809}let pkSess_4911: bitstring = pub(sk(Sess_3941)) in
                                                        {5810}in(c, =GetEndpointRequest);
                                                        {5811}new SP_4912: bitstring;
                                                        {5812}new UP_4913: bitstring;
                                                        {5813}out(c, (GetEndpointResponse,pkSess_4911,SignAndEncrypt,SP_4912,UP_4913))
                                                )
                                                else
                                                    {5814}let pkSess_4914: bitstring = fail-any in
                                                    {5815}in(c, =GetEndpointRequest);
                                                    {5816}new SP_4915: bitstring;
                                                    {5817}new UP_4916: bitstring;
                                                    {5818}out(c, (GetEndpointResponse,pkSess_4914,SignAndEncrypt,SP_4915,UP_4916))
                                        )
                                        else
                                            {5819}let pkSess_4917: bitstring = fail-any in
                                            {5820}in(c, =GetEndpointRequest);
                                            {5821}new SP_4918: bitstring;
                                            {5822}new UP_4919: bitstring;
                                            {5823}out(c, (GetEndpointResponse,pkSess_4917,SignAndEncrypt,SP_4918,UP_4919))
                                )
                                else
                                    {5824}let pkSess_4920: bitstring = fail-any in
                                    {5825}in(c, =GetEndpointRequest);
                                    {5826}new SP_4921: bitstring;
                                    {5827}new UP_4922: bitstring;
                                    {5828}out(c, (GetEndpointResponse,pkSess_4920,SignAndEncrypt,SP_4921,UP_4922))
                            )
                            else
                                {5829}let pkCli_4923: bitstring = pub(sk(Cli_3939)) in
                                {5830}let v_4924: bool = (Sess_3941 = A) in
                                (
                                    {5831}if v_4924 then
                                    (
                                        {5832}let pkSess_4925: bitstring = pub(skA) in
                                        {5833}in(c, =GetEndpointRequest);
                                        {5834}new SP_4926: bitstring;
                                        {5835}new UP_4927: bitstring;
                                        {5836}out(c, (GetEndpointResponse,pkSess_4925,SignAndEncrypt,SP_4926,UP_4927))
                                    )
                                    else
                                        {5837}let v_4928: bool = (Sess_3941 = B) in
                                        (
                                            {5838}if v_4928 then
                                            (
                                                {5839}let pkSess_4929: bitstring = pub(skB) in
                                                {5840}in(c, =GetEndpointRequest);
                                                {5841}new SP_4930: bitstring;
                                                {5842}new UP_4931: bitstring;
                                                {5843}out(c, (GetEndpointResponse,pkSess_4929,SignAndEncrypt,SP_4930,UP_4931))
                                            )
                                            else
                                                {5844}let v_4932: bool = (Sess_3941 = C) in
                                                (
                                                    {5845}if v_4932 then
                                                    (
                                                        {5846}let pkSess_4933: bitstring = pub(skC) in
                                                        {5847}in(c, =GetEndpointRequest);
                                                        {5848}new SP_4934: bitstring;
                                                        {5849}new UP_4935: bitstring;
                                                        {5850}out(c, (GetEndpointResponse,pkSess_4933,SignAndEncrypt,SP_4934,UP_4935))
                                                    )
                                                    else
                                                        {5851}let pkSess_4936: bitstring = pub(sk(Sess_3941)) in
                                                        {5852}in(c, =GetEndpointRequest);
                                                        {5853}new SP_4937: bitstring;
                                                        {5854}new UP_4938: bitstring;
                                                        {5855}out(c, (GetEndpointResponse,pkSess_4936,SignAndEncrypt,SP_4937,UP_4938))
                                                )
                                                else
                                                    {5856}let pkSess_4939: bitstring = fail-any in
                                                    {5857}in(c, =GetEndpointRequest);
                                                    {5858}new SP_4940: bitstring;
                                                    {5859}new UP_4941: bitstring;
                                                    {5860}out(c, (GetEndpointResponse,pkSess_4939,SignAndEncrypt,SP_4940,UP_4941))
                                        )
                                        else
                                            {5861}let pkSess_4942: bitstring = fail-any in
                                            {5862}in(c, =GetEndpointRequest);
                                            {5863}new SP_4943: bitstring;
                                            {5864}new UP_4944: bitstring;
                                            {5865}out(c, (GetEndpointResponse,pkSess_4942,SignAndEncrypt,SP_4943,UP_4944))
                                )
                                else
                                    {5866}let pkSess_4945: bitstring = fail-any in
                                    {5867}in(c, =GetEndpointRequest);
                                    {5868}new SP_4946: bitstring;
                                    {5869}new UP_4947: bitstring;
                                    {5870}out(c, (GetEndpointResponse,pkSess_4945,SignAndEncrypt,SP_4946,UP_4947))
                        )
                        else
                            {5871}let pkCli_4948: bitstring = fail-any in
                            {5872}let v_4949: bool = (Sess_3941 = A) in
                            (
                                {5873}if v_4949 then
                                (
                                    {5874}let pkSess_4950: bitstring = pub(skA) in
                                    {5875}in(c, =GetEndpointRequest);
                                    {5876}new SP_4951: bitstring;
                                    {5877}new UP_4952: bitstring;
                                    {5878}out(c, (GetEndpointResponse,pkSess_4950,SignAndEncrypt,SP_4951,UP_4952))
                                )
                                else
                                    {5879}let v_4953: bool = (Sess_3941 = B) in
                                    (
                                        {5880}if v_4953 then
                                        (
                                            {5881}let pkSess_4954: bitstring = pub(skB) in
                                            {5882}in(c, =GetEndpointRequest);
                                            {5883}new SP_4955: bitstring;
                                            {5884}new UP_4956: bitstring;
                                            {5885}out(c, (GetEndpointResponse,pkSess_4954,SignAndEncrypt,SP_4955,UP_4956))
                                        )
                                        else
                                            {5886}let v_4957: bool = (Sess_3941 = C) in
                                            (
                                                {5887}if v_4957 then
                                                (
                                                    {5888}let pkSess_4958: bitstring = pub(skC) in
                                                    {5889}in(c, =GetEndpointRequest);
                                                    {5890}new SP_4959: bitstring;
                                                    {5891}new UP_4960: bitstring;
                                                    {5892}out(c, (GetEndpointResponse,pkSess_4958,SignAndEncrypt,SP_4959,UP_4960))
                                                )
                                                else
                                                    {5893}let pkSess_4961: bitstring = pub(sk(Sess_3941)) in
                                                    {5894}in(c, =GetEndpointRequest);
                                                    {5895}new SP_4962: bitstring;
                                                    {5896}new UP_4963: bitstring;
                                                    {5897}out(c, (GetEndpointResponse,pkSess_4961,SignAndEncrypt,SP_4962,UP_4963))
                                            )
                                            else
                                                {5898}let pkSess_4964: bitstring = fail-any in
                                                {5899}in(c, =GetEndpointRequest);
                                                {5900}new SP_4965: bitstring;
                                                {5901}new UP_4966: bitstring;
                                                {5902}out(c, (GetEndpointResponse,pkSess_4964,SignAndEncrypt,SP_4965,UP_4966))
                                    )
                                    else
                                        {5903}let pkSess_4967: bitstring = fail-any in
                                        {5904}in(c, =GetEndpointRequest);
                                        {5905}new SP_4968: bitstring;
                                        {5906}new UP_4969: bitstring;
                                        {5907}out(c, (GetEndpointResponse,pkSess_4967,SignAndEncrypt,SP_4968,UP_4969))
                            )
                            else
                                {5908}let pkSess_4970: bitstring = fail-any in
                                {5909}in(c, =GetEndpointRequest);
                                {5910}new SP_4971: bitstring;
                                {5911}new UP_4972: bitstring;
                                {5912}out(c, (GetEndpointResponse,pkSess_4970,SignAndEncrypt,SP_4971,UP_4972))
                )
                else
                    {5913}let pkCli_4973: bitstring = fail-any in
                    {5914}let v_4974: bool = (Sess_3941 = A) in
                    (
                        {5915}if v_4974 then
                        (
                            {5916}let pkSess_4975: bitstring = pub(skA) in
                            {5917}in(c, =GetEndpointRequest);
                            {5918}new SP_4976: bitstring;
                            {5919}new UP_4977: bitstring;
                            {5920}out(c, (GetEndpointResponse,pkSess_4975,SignAndEncrypt,SP_4976,UP_4977))
                        )
                        else
                            {5921}let v_4978: bool = (Sess_3941 = B) in
                            (
                                {5922}if v_4978 then
                                (
                                    {5923}let pkSess_4979: bitstring = pub(skB) in
                                    {5924}in(c, =GetEndpointRequest);
                                    {5925}new SP_4980: bitstring;
                                    {5926}new UP_4981: bitstring;
                                    {5927}out(c, (GetEndpointResponse,pkSess_4979,SignAndEncrypt,SP_4980,UP_4981))
                                )
                                else
                                    {5928}let v_4982: bool = (Sess_3941 = C) in
                                    (
                                        {5929}if v_4982 then
                                        (
                                            {5930}let pkSess_4983: bitstring = pub(skC) in
                                            {5931}in(c, =GetEndpointRequest);
                                            {5932}new SP_4984: bitstring;
                                            {5933}new UP_4985: bitstring;
                                            {5934}out(c, (GetEndpointResponse,pkSess_4983,SignAndEncrypt,SP_4984,UP_4985))
                                        )
                                        else
                                            {5935}let pkSess_4986: bitstring = pub(sk(Sess_3941)) in
                                            {5936}in(c, =GetEndpointRequest);
                                            {5937}new SP_4987: bitstring;
                                            {5938}new UP_4988: bitstring;
                                            {5939}out(c, (GetEndpointResponse,pkSess_4986,SignAndEncrypt,SP_4987,UP_4988))
                                    )
                                    else
                                        {5940}let pkSess_4989: bitstring = fail-any in
                                        {5941}in(c, =GetEndpointRequest);
                                        {5942}new SP_4990: bitstring;
                                        {5943}new UP_4991: bitstring;
                                        {5944}out(c, (GetEndpointResponse,pkSess_4989,SignAndEncrypt,SP_4990,UP_4991))
                            )
                            else
                                {5945}let pkSess_4992: bitstring = fail-any in
                                {5946}in(c, =GetEndpointRequest);
                                {5947}new SP_4993: bitstring;
                                {5948}new UP_4994: bitstring;
                                {5949}out(c, (GetEndpointResponse,pkSess_4992,SignAndEncrypt,SP_4993,UP_4994))
                    )
                    else
                        {5950}let pkSess_4995: bitstring = fail-any in
                        {5951}in(c, =GetEndpointRequest);
                        {5952}new SP_4996: bitstring;
                        {5953}new UP_4997: bitstring;
                        {5954}out(c, (GetEndpointResponse,pkSess_4995,SignAndEncrypt,SP_4996,UP_4997))
        )
        else
            {5955}let pkCli_4998: bitstring = fail-any in
            {5956}let v_4999: bool = (Sess_3941 = A) in
            (
                {5957}if v_4999 then
                (
                    {5958}let pkSess_5000: bitstring = pub(skA) in
                    {5959}in(c, =GetEndpointRequest);
                    {5960}new SP_5001: bitstring;
                    {5961}new UP_5002: bitstring;
                    {5962}out(c, (GetEndpointResponse,pkSess_5000,SignAndEncrypt,SP_5001,UP_5002))
                )
                else
                    {5963}let v_5003: bool = (Sess_3941 = B) in
                    (
                        {5964}if v_5003 then
                        (
                            {5965}let pkSess_5004: bitstring = pub(skB) in
                            {5966}in(c, =GetEndpointRequest);
                            {5967}new SP_5005: bitstring;
                            {5968}new UP_5006: bitstring;
                            {5969}out(c, (GetEndpointResponse,pkSess_5004,SignAndEncrypt,SP_5005,UP_5006))
                        )
                        else
                            {5970}let v_5007: bool = (Sess_3941 = C) in
                            (
                                {5971}if v_5007 then
                                (
                                    {5972}let pkSess_5008: bitstring = pub(skC) in
                                    {5973}in(c, =GetEndpointRequest);
                                    {5974}new SP_5009: bitstring;
                                    {5975}new UP_5010: bitstring;
                                    {5976}out(c, (GetEndpointResponse,pkSess_5008,SignAndEncrypt,SP_5009,UP_5010))
                                )
                                else
                                    {5977}let pkSess_5011: bitstring = pub(sk(Sess_3941)) in
                                    {5978}in(c, =GetEndpointRequest);
                                    {5979}new SP_5012: bitstring;
                                    {5980}new UP_5013: bitstring;
                                    {5981}out(c, (GetEndpointResponse,pkSess_5011,SignAndEncrypt,SP_5012,UP_5013))
                            )
                            else
                                {5982}let pkSess_5014: bitstring = fail-any in
                                {5983}in(c, =GetEndpointRequest);
                                {5984}new SP_5015: bitstring;
                                {5985}new UP_5016: bitstring;
                                {5986}out(c, (GetEndpointResponse,pkSess_5014,SignAndEncrypt,SP_5015,UP_5016))
                    )
                    else
                        {5987}let pkSess_5017: bitstring = fail-any in
                        {5988}in(c, =GetEndpointRequest);
                        {5989}new SP_5018: bitstring;
                        {5990}new UP_5019: bitstring;
                        {5991}out(c, (GetEndpointResponse,pkSess_5017,SignAndEncrypt,SP_5018,UP_5019))
            )
            else
                {5992}let pkSess_5020: bitstring = fail-any in
                {5993}in(c, =GetEndpointRequest);
                {5994}new SP_5021: bitstring;
                {5995}new UP_5022: bitstring;
                {5996}out(c, (GetEndpointResponse,pkSess_5020,SignAndEncrypt,SP_5021,UP_5022))
) | (
    {5997}!
    {5998}in(c, (Cli_5023: host,Disco_5024: host,Sess_5025: host));
    {5999}let v_5026: bool = (Sess_5025 = A) in
    (
        {6000}if v_5026 then
        (
            {6001}let skSess: bitstring = skA in
            {6002}let pkSess_5027: bitstring = pub(skSess) in
            {6003}let v_5028: bool = (Cli_5023 = A) in
            (
                {6004}if v_5028 then
                (
                    {6005}let pkCli_5029: bitstring = pub(skA) in
                    {6006}let v_5030: bool = (Disco_5024 = A) in
                    (
                        {6007}if v_5030 then
                        (
                            {6008}let pkDisco_5031: bitstring = pub(skA) in
                            {6009}in(c, (=pkCli_5029,em1: bitstring,sigM1: bitstring));
                            {6010}let m1_5032: bitstring = dec(em1,skSess) in
                            {6011}if (verify(h(m1_5032),sigM1,pkCli_5029) <> true) then
                                0
                            else
                                {6012}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC: bitstring) = m1_5032 in
                                {6013}new Ns: bitstring;
                                {6014}new ST_5033: bitstring;
                                {6015}new TTL_5034: bitstring;
                                {6016}let gNs: bitstring = exp(g,Ns) in
                                {6017}let m2_5035: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs,ST_5033,TTL_5034) in
                                {6018}event beginSrv(Sess_5025,Cli_5023,gNs);
                                {6019}out(c, (enc(m2_5035,pkCli_5029),sign(h(m2_5035),skSess)));
                                {6020}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {6021}event endSrv(Cli_5023,Sess_5025,PartC)
                        )
                        else
                            {6022}let v_5036: bool = (Disco_5024 = B) in
                            (
                                {6023}if v_5036 then
                                (
                                    {6024}let pkDisco_5037: bitstring = pub(skB) in
                                    {6025}in(c, (=pkCli_5029,em1_5038: bitstring,sigM1_5039: bitstring));
                                    {6026}let m1_5040: bitstring = dec(em1_5038,skSess) in
                                    {6027}if (verify(h(m1_5040),sigM1_5039,pkCli_5029) <> true) then
                                        0
                                    else
                                        {6028}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC_5041: bitstring) = m1_5040 in
                                        {6029}new Ns_5042: bitstring;
                                        {6030}new ST_5043: bitstring;
                                        {6031}new TTL_5044: bitstring;
                                        {6032}let gNs_5045: bitstring = exp(g,Ns_5042) in
                                        {6033}let m2_5046: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5045,ST_5043,TTL_5044) in
                                        {6034}event beginSrv(Sess_5025,Cli_5023,gNs_5045);
                                        {6035}out(c, (enc(m2_5046,pkCli_5029),sign(h(m2_5046),skSess)));
                                        {6036}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6037}event endSrv(Cli_5023,Sess_5025,PartC_5041)
                                )
                                else
                                    {6038}let v_5047: bool = (Disco_5024 = C) in
                                    (
                                        {6039}if v_5047 then
                                        (
                                            {6040}let pkDisco_5048: bitstring = pub(skC) in
                                            {6041}in(c, (=pkCli_5029,em1_5049: bitstring,sigM1_5050: bitstring));
                                            {6042}let m1_5051: bitstring = dec(em1_5049,skSess) in
                                            {6043}if (verify(h(m1_5051),sigM1_5050,pkCli_5029) <> true) then
                                                0
                                            else
                                                {6044}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC_5052: bitstring) = m1_5051 in
                                                {6045}new Ns_5053: bitstring;
                                                {6046}new ST_5054: bitstring;
                                                {6047}new TTL_5055: bitstring;
                                                {6048}let gNs_5056: bitstring = exp(g,Ns_5053) in
                                                {6049}let m2_5057: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5056,ST_5054,TTL_5055) in
                                                {6050}event beginSrv(Sess_5025,Cli_5023,gNs_5056);
                                                {6051}out(c, (enc(m2_5057,pkCli_5029),sign(h(m2_5057),skSess)));
                                                {6052}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6053}event endSrv(Cli_5023,Sess_5025,PartC_5052)
                                        )
                                        else
                                            {6054}let pkDisco_5058: bitstring = pub(sk(Disco_5024)) in
                                            {6055}in(c, (=pkCli_5029,em1_5059: bitstring,sigM1_5060: bitstring));
                                            {6056}let m1_5061: bitstring = dec(em1_5059,skSess) in
                                            {6057}if (verify(h(m1_5061),sigM1_5060,pkCli_5029) <> true) then
                                                0
                                            else
                                                {6058}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC_5062: bitstring) = m1_5061 in
                                                {6059}new Ns_5063: bitstring;
                                                {6060}new ST_5064: bitstring;
                                                {6061}new TTL_5065: bitstring;
                                                {6062}let gNs_5066: bitstring = exp(g,Ns_5063) in
                                                {6063}let m2_5067: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5066,ST_5064,TTL_5065) in
                                                {6064}event beginSrv(Sess_5025,Cli_5023,gNs_5066);
                                                {6065}out(c, (enc(m2_5067,pkCli_5029),sign(h(m2_5067),skSess)));
                                                {6066}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6067}event endSrv(Cli_5023,Sess_5025,PartC_5062)
                                    )
                                    else
                                        {6068}let pkDisco_5068: bitstring = fail-any in
                                        {6069}in(c, (=pkCli_5029,em1_5069: bitstring,sigM1_5070: bitstring));
                                        {6070}let m1_5071: bitstring = dec(em1_5069,skSess) in
                                        {6071}if (verify(h(m1_5071),sigM1_5070,pkCli_5029) <> true) then
                                            0
                                        else
                                            {6072}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC_5072: bitstring) = m1_5071 in
                                            {6073}new Ns_5073: bitstring;
                                            {6074}new ST_5074: bitstring;
                                            {6075}new TTL_5075: bitstring;
                                            {6076}let gNs_5076: bitstring = exp(g,Ns_5073) in
                                            {6077}let m2_5077: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5076,ST_5074,TTL_5075) in
                                            {6078}event beginSrv(Sess_5025,Cli_5023,gNs_5076);
                                            {6079}out(c, (enc(m2_5077,pkCli_5029),sign(h(m2_5077),skSess)));
                                            {6080}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6081}event endSrv(Cli_5023,Sess_5025,PartC_5072)
                            )
                            else
                                {6082}let pkDisco_5078: bitstring = fail-any in
                                {6083}in(c, (=pkCli_5029,em1_5079: bitstring,sigM1_5080: bitstring));
                                {6084}let m1_5081: bitstring = dec(em1_5079,skSess) in
                                {6085}if (verify(h(m1_5081),sigM1_5080,pkCli_5029) <> true) then
                                    0
                                else
                                    {6086}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC_5082: bitstring) = m1_5081 in
                                    {6087}new Ns_5083: bitstring;
                                    {6088}new ST_5084: bitstring;
                                    {6089}new TTL_5085: bitstring;
                                    {6090}let gNs_5086: bitstring = exp(g,Ns_5083) in
                                    {6091}let m2_5087: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5086,ST_5084,TTL_5085) in
                                    {6092}event beginSrv(Sess_5025,Cli_5023,gNs_5086);
                                    {6093}out(c, (enc(m2_5087,pkCli_5029),sign(h(m2_5087),skSess)));
                                    {6094}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6095}event endSrv(Cli_5023,Sess_5025,PartC_5082)
                    )
                    else
                        {6096}let pkDisco_5088: bitstring = fail-any in
                        {6097}in(c, (=pkCli_5029,em1_5089: bitstring,sigM1_5090: bitstring));
                        {6098}let m1_5091: bitstring = dec(em1_5089,skSess) in
                        {6099}if (verify(h(m1_5091),sigM1_5090,pkCli_5029) <> true) then
                            0
                        else
                            {6100}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5029,PartC_5092: bitstring) = m1_5091 in
                            {6101}new Ns_5093: bitstring;
                            {6102}new ST_5094: bitstring;
                            {6103}new TTL_5095: bitstring;
                            {6104}let gNs_5096: bitstring = exp(g,Ns_5093) in
                            {6105}let m2_5097: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5096,ST_5094,TTL_5095) in
                            {6106}event beginSrv(Sess_5025,Cli_5023,gNs_5096);
                            {6107}out(c, (enc(m2_5097,pkCli_5029),sign(h(m2_5097),skSess)));
                            {6108}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {6109}event endSrv(Cli_5023,Sess_5025,PartC_5092)
                )
                else
                    {6110}let v_5098: bool = (Cli_5023 = B) in
                    (
                        {6111}if v_5098 then
                        (
                            {6112}let pkCli_5099: bitstring = pub(skB) in
                            {6113}let v_5100: bool = (Disco_5024 = A) in
                            (
                                {6114}if v_5100 then
                                (
                                    {6115}let pkDisco_5101: bitstring = pub(skA) in
                                    {6116}in(c, (=pkCli_5099,em1_5102: bitstring,sigM1_5103: bitstring));
                                    {6117}let m1_5104: bitstring = dec(em1_5102,skSess) in
                                    {6118}if (verify(h(m1_5104),sigM1_5103,pkCli_5099) <> true) then
                                        0
                                    else
                                        {6119}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5105: bitstring) = m1_5104 in
                                        {6120}new Ns_5106: bitstring;
                                        {6121}new ST_5107: bitstring;
                                        {6122}new TTL_5108: bitstring;
                                        {6123}let gNs_5109: bitstring = exp(g,Ns_5106) in
                                        {6124}let m2_5110: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5109,ST_5107,TTL_5108) in
                                        {6125}event beginSrv(Sess_5025,Cli_5023,gNs_5109);
                                        {6126}out(c, (enc(m2_5110,pkCli_5099),sign(h(m2_5110),skSess)));
                                        {6127}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6128}event endSrv(Cli_5023,Sess_5025,PartC_5105)
                                )
                                else
                                    {6129}let v_5111: bool = (Disco_5024 = B) in
                                    (
                                        {6130}if v_5111 then
                                        (
                                            {6131}let pkDisco_5112: bitstring = pub(skB) in
                                            {6132}in(c, (=pkCli_5099,em1_5113: bitstring,sigM1_5114: bitstring));
                                            {6133}let m1_5115: bitstring = dec(em1_5113,skSess) in
                                            {6134}if (verify(h(m1_5115),sigM1_5114,pkCli_5099) <> true) then
                                                0
                                            else
                                                {6135}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5116: bitstring) = m1_5115 in
                                                {6136}new Ns_5117: bitstring;
                                                {6137}new ST_5118: bitstring;
                                                {6138}new TTL_5119: bitstring;
                                                {6139}let gNs_5120: bitstring = exp(g,Ns_5117) in
                                                {6140}let m2_5121: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5120,ST_5118,TTL_5119) in
                                                {6141}event beginSrv(Sess_5025,Cli_5023,gNs_5120);
                                                {6142}out(c, (enc(m2_5121,pkCli_5099),sign(h(m2_5121),skSess)));
                                                {6143}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6144}event endSrv(Cli_5023,Sess_5025,PartC_5116)
                                        )
                                        else
                                            {6145}let v_5122: bool = (Disco_5024 = C) in
                                            (
                                                {6146}if v_5122 then
                                                (
                                                    {6147}let pkDisco_5123: bitstring = pub(skC) in
                                                    {6148}in(c, (=pkCli_5099,em1_5124: bitstring,sigM1_5125: bitstring));
                                                    {6149}let m1_5126: bitstring = dec(em1_5124,skSess) in
                                                    {6150}if (verify(h(m1_5126),sigM1_5125,pkCli_5099) <> true) then
                                                        0
                                                    else
                                                        {6151}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5127: bitstring) = m1_5126 in
                                                        {6152}new Ns_5128: bitstring;
                                                        {6153}new ST_5129: bitstring;
                                                        {6154}new TTL_5130: bitstring;
                                                        {6155}let gNs_5131: bitstring = exp(g,Ns_5128) in
                                                        {6156}let m2_5132: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5131,ST_5129,TTL_5130) in
                                                        {6157}event beginSrv(Sess_5025,Cli_5023,gNs_5131);
                                                        {6158}out(c, (enc(m2_5132,pkCli_5099),sign(h(m2_5132),skSess)));
                                                        {6159}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6160}event endSrv(Cli_5023,Sess_5025,PartC_5127)
                                                )
                                                else
                                                    {6161}let pkDisco_5133: bitstring = pub(sk(Disco_5024)) in
                                                    {6162}in(c, (=pkCli_5099,em1_5134: bitstring,sigM1_5135: bitstring));
                                                    {6163}let m1_5136: bitstring = dec(em1_5134,skSess) in
                                                    {6164}if (verify(h(m1_5136),sigM1_5135,pkCli_5099) <> true) then
                                                        0
                                                    else
                                                        {6165}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5137: bitstring) = m1_5136 in
                                                        {6166}new Ns_5138: bitstring;
                                                        {6167}new ST_5139: bitstring;
                                                        {6168}new TTL_5140: bitstring;
                                                        {6169}let gNs_5141: bitstring = exp(g,Ns_5138) in
                                                        {6170}let m2_5142: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5141,ST_5139,TTL_5140) in
                                                        {6171}event beginSrv(Sess_5025,Cli_5023,gNs_5141);
                                                        {6172}out(c, (enc(m2_5142,pkCli_5099),sign(h(m2_5142),skSess)));
                                                        {6173}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6174}event endSrv(Cli_5023,Sess_5025,PartC_5137)
                                            )
                                            else
                                                {6175}let pkDisco_5143: bitstring = fail-any in
                                                {6176}in(c, (=pkCli_5099,em1_5144: bitstring,sigM1_5145: bitstring));
                                                {6177}let m1_5146: bitstring = dec(em1_5144,skSess) in
                                                {6178}if (verify(h(m1_5146),sigM1_5145,pkCli_5099) <> true) then
                                                    0
                                                else
                                                    {6179}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5147: bitstring) = m1_5146 in
                                                    {6180}new Ns_5148: bitstring;
                                                    {6181}new ST_5149: bitstring;
                                                    {6182}new TTL_5150: bitstring;
                                                    {6183}let gNs_5151: bitstring = exp(g,Ns_5148) in
                                                    {6184}let m2_5152: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5151,ST_5149,TTL_5150) in
                                                    {6185}event beginSrv(Sess_5025,Cli_5023,gNs_5151);
                                                    {6186}out(c, (enc(m2_5152,pkCli_5099),sign(h(m2_5152),skSess)));
                                                    {6187}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6188}event endSrv(Cli_5023,Sess_5025,PartC_5147)
                                    )
                                    else
                                        {6189}let pkDisco_5153: bitstring = fail-any in
                                        {6190}in(c, (=pkCli_5099,em1_5154: bitstring,sigM1_5155: bitstring));
                                        {6191}let m1_5156: bitstring = dec(em1_5154,skSess) in
                                        {6192}if (verify(h(m1_5156),sigM1_5155,pkCli_5099) <> true) then
                                            0
                                        else
                                            {6193}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5157: bitstring) = m1_5156 in
                                            {6194}new Ns_5158: bitstring;
                                            {6195}new ST_5159: bitstring;
                                            {6196}new TTL_5160: bitstring;
                                            {6197}let gNs_5161: bitstring = exp(g,Ns_5158) in
                                            {6198}let m2_5162: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5161,ST_5159,TTL_5160) in
                                            {6199}event beginSrv(Sess_5025,Cli_5023,gNs_5161);
                                            {6200}out(c, (enc(m2_5162,pkCli_5099),sign(h(m2_5162),skSess)));
                                            {6201}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6202}event endSrv(Cli_5023,Sess_5025,PartC_5157)
                            )
                            else
                                {6203}let pkDisco_5163: bitstring = fail-any in
                                {6204}in(c, (=pkCli_5099,em1_5164: bitstring,sigM1_5165: bitstring));
                                {6205}let m1_5166: bitstring = dec(em1_5164,skSess) in
                                {6206}if (verify(h(m1_5166),sigM1_5165,pkCli_5099) <> true) then
                                    0
                                else
                                    {6207}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5099,PartC_5167: bitstring) = m1_5166 in
                                    {6208}new Ns_5168: bitstring;
                                    {6209}new ST_5169: bitstring;
                                    {6210}new TTL_5170: bitstring;
                                    {6211}let gNs_5171: bitstring = exp(g,Ns_5168) in
                                    {6212}let m2_5172: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5171,ST_5169,TTL_5170) in
                                    {6213}event beginSrv(Sess_5025,Cli_5023,gNs_5171);
                                    {6214}out(c, (enc(m2_5172,pkCli_5099),sign(h(m2_5172),skSess)));
                                    {6215}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6216}event endSrv(Cli_5023,Sess_5025,PartC_5167)
                        )
                        else
                            {6217}let v_5173: bool = (Cli_5023 = C) in
                            (
                                {6218}if v_5173 then
                                (
                                    {6219}let pkCli_5174: bitstring = pub(skC) in
                                    {6220}let v_5175: bool = (Disco_5024 = A) in
                                    (
                                        {6221}if v_5175 then
                                        (
                                            {6222}let pkDisco_5176: bitstring = pub(skA) in
                                            {6223}in(c, (=pkCli_5174,em1_5177: bitstring,sigM1_5178: bitstring));
                                            {6224}let m1_5179: bitstring = dec(em1_5177,skSess) in
                                            {6225}if (verify(h(m1_5179),sigM1_5178,pkCli_5174) <> true) then
                                                0
                                            else
                                                {6226}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5180: bitstring) = m1_5179 in
                                                {6227}new Ns_5181: bitstring;
                                                {6228}new ST_5182: bitstring;
                                                {6229}new TTL_5183: bitstring;
                                                {6230}let gNs_5184: bitstring = exp(g,Ns_5181) in
                                                {6231}let m2_5185: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5184,ST_5182,TTL_5183) in
                                                {6232}event beginSrv(Sess_5025,Cli_5023,gNs_5184);
                                                {6233}out(c, (enc(m2_5185,pkCli_5174),sign(h(m2_5185),skSess)));
                                                {6234}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6235}event endSrv(Cli_5023,Sess_5025,PartC_5180)
                                        )
                                        else
                                            {6236}let v_5186: bool = (Disco_5024 = B) in
                                            (
                                                {6237}if v_5186 then
                                                (
                                                    {6238}let pkDisco_5187: bitstring = pub(skB) in
                                                    {6239}in(c, (=pkCli_5174,em1_5188: bitstring,sigM1_5189: bitstring));
                                                    {6240}let m1_5190: bitstring = dec(em1_5188,skSess) in
                                                    {6241}if (verify(h(m1_5190),sigM1_5189,pkCli_5174) <> true) then
                                                        0
                                                    else
                                                        {6242}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5191: bitstring) = m1_5190 in
                                                        {6243}new Ns_5192: bitstring;
                                                        {6244}new ST_5193: bitstring;
                                                        {6245}new TTL_5194: bitstring;
                                                        {6246}let gNs_5195: bitstring = exp(g,Ns_5192) in
                                                        {6247}let m2_5196: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5195,ST_5193,TTL_5194) in
                                                        {6248}event beginSrv(Sess_5025,Cli_5023,gNs_5195);
                                                        {6249}out(c, (enc(m2_5196,pkCli_5174),sign(h(m2_5196),skSess)));
                                                        {6250}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6251}event endSrv(Cli_5023,Sess_5025,PartC_5191)
                                                )
                                                else
                                                    {6252}let v_5197: bool = (Disco_5024 = C) in
                                                    (
                                                        {6253}if v_5197 then
                                                        (
                                                            {6254}let pkDisco_5198: bitstring = pub(skC) in
                                                            {6255}in(c, (=pkCli_5174,em1_5199: bitstring,sigM1_5200: bitstring));
                                                            {6256}let m1_5201: bitstring = dec(em1_5199,skSess) in
                                                            {6257}if (verify(h(m1_5201),sigM1_5200,pkCli_5174) <> true) then
                                                                0
                                                            else
                                                                {6258}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5202: bitstring) = m1_5201 in
                                                                {6259}new Ns_5203: bitstring;
                                                                {6260}new ST_5204: bitstring;
                                                                {6261}new TTL_5205: bitstring;
                                                                {6262}let gNs_5206: bitstring = exp(g,Ns_5203) in
                                                                {6263}let m2_5207: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5206,ST_5204,TTL_5205) in
                                                                {6264}event beginSrv(Sess_5025,Cli_5023,gNs_5206);
                                                                {6265}out(c, (enc(m2_5207,pkCli_5174),sign(h(m2_5207),skSess)));
                                                                {6266}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6267}event endSrv(Cli_5023,Sess_5025,PartC_5202)
                                                        )
                                                        else
                                                            {6268}let pkDisco_5208: bitstring = pub(sk(Disco_5024)) in
                                                            {6269}in(c, (=pkCli_5174,em1_5209: bitstring,sigM1_5210: bitstring));
                                                            {6270}let m1_5211: bitstring = dec(em1_5209,skSess) in
                                                            {6271}if (verify(h(m1_5211),sigM1_5210,pkCli_5174) <> true) then
                                                                0
                                                            else
                                                                {6272}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5212: bitstring) = m1_5211 in
                                                                {6273}new Ns_5213: bitstring;
                                                                {6274}new ST_5214: bitstring;
                                                                {6275}new TTL_5215: bitstring;
                                                                {6276}let gNs_5216: bitstring = exp(g,Ns_5213) in
                                                                {6277}let m2_5217: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5216,ST_5214,TTL_5215) in
                                                                {6278}event beginSrv(Sess_5025,Cli_5023,gNs_5216);
                                                                {6279}out(c, (enc(m2_5217,pkCli_5174),sign(h(m2_5217),skSess)));
                                                                {6280}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6281}event endSrv(Cli_5023,Sess_5025,PartC_5212)
                                                    )
                                                    else
                                                        {6282}let pkDisco_5218: bitstring = fail-any in
                                                        {6283}in(c, (=pkCli_5174,em1_5219: bitstring,sigM1_5220: bitstring));
                                                        {6284}let m1_5221: bitstring = dec(em1_5219,skSess) in
                                                        {6285}if (verify(h(m1_5221),sigM1_5220,pkCli_5174) <> true) then
                                                            0
                                                        else
                                                            {6286}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5222: bitstring) = m1_5221 in
                                                            {6287}new Ns_5223: bitstring;
                                                            {6288}new ST_5224: bitstring;
                                                            {6289}new TTL_5225: bitstring;
                                                            {6290}let gNs_5226: bitstring = exp(g,Ns_5223) in
                                                            {6291}let m2_5227: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5226,ST_5224,TTL_5225) in
                                                            {6292}event beginSrv(Sess_5025,Cli_5023,gNs_5226);
                                                            {6293}out(c, (enc(m2_5227,pkCli_5174),sign(h(m2_5227),skSess)));
                                                            {6294}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6295}event endSrv(Cli_5023,Sess_5025,PartC_5222)
                                            )
                                            else
                                                {6296}let pkDisco_5228: bitstring = fail-any in
                                                {6297}in(c, (=pkCli_5174,em1_5229: bitstring,sigM1_5230: bitstring));
                                                {6298}let m1_5231: bitstring = dec(em1_5229,skSess) in
                                                {6299}if (verify(h(m1_5231),sigM1_5230,pkCli_5174) <> true) then
                                                    0
                                                else
                                                    {6300}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5232: bitstring) = m1_5231 in
                                                    {6301}new Ns_5233: bitstring;
                                                    {6302}new ST_5234: bitstring;
                                                    {6303}new TTL_5235: bitstring;
                                                    {6304}let gNs_5236: bitstring = exp(g,Ns_5233) in
                                                    {6305}let m2_5237: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5236,ST_5234,TTL_5235) in
                                                    {6306}event beginSrv(Sess_5025,Cli_5023,gNs_5236);
                                                    {6307}out(c, (enc(m2_5237,pkCli_5174),sign(h(m2_5237),skSess)));
                                                    {6308}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6309}event endSrv(Cli_5023,Sess_5025,PartC_5232)
                                    )
                                    else
                                        {6310}let pkDisco_5238: bitstring = fail-any in
                                        {6311}in(c, (=pkCli_5174,em1_5239: bitstring,sigM1_5240: bitstring));
                                        {6312}let m1_5241: bitstring = dec(em1_5239,skSess) in
                                        {6313}if (verify(h(m1_5241),sigM1_5240,pkCli_5174) <> true) then
                                            0
                                        else
                                            {6314}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5174,PartC_5242: bitstring) = m1_5241 in
                                            {6315}new Ns_5243: bitstring;
                                            {6316}new ST_5244: bitstring;
                                            {6317}new TTL_5245: bitstring;
                                            {6318}let gNs_5246: bitstring = exp(g,Ns_5243) in
                                            {6319}let m2_5247: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5246,ST_5244,TTL_5245) in
                                            {6320}event beginSrv(Sess_5025,Cli_5023,gNs_5246);
                                            {6321}out(c, (enc(m2_5247,pkCli_5174),sign(h(m2_5247),skSess)));
                                            {6322}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6323}event endSrv(Cli_5023,Sess_5025,PartC_5242)
                                )
                                else
                                    {6324}let pkCli_5248: bitstring = pub(sk(Cli_5023)) in
                                    {6325}let v_5249: bool = (Disco_5024 = A) in
                                    (
                                        {6326}if v_5249 then
                                        (
                                            {6327}let pkDisco_5250: bitstring = pub(skA) in
                                            {6328}in(c, (=pkCli_5248,em1_5251: bitstring,sigM1_5252: bitstring));
                                            {6329}let m1_5253: bitstring = dec(em1_5251,skSess) in
                                            {6330}if (verify(h(m1_5253),sigM1_5252,pkCli_5248) <> true) then
                                                0
                                            else
                                                {6331}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5254: bitstring) = m1_5253 in
                                                {6332}new Ns_5255: bitstring;
                                                {6333}new ST_5256: bitstring;
                                                {6334}new TTL_5257: bitstring;
                                                {6335}let gNs_5258: bitstring = exp(g,Ns_5255) in
                                                {6336}let m2_5259: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5258,ST_5256,TTL_5257) in
                                                {6337}event beginSrv(Sess_5025,Cli_5023,gNs_5258);
                                                {6338}out(c, (enc(m2_5259,pkCli_5248),sign(h(m2_5259),skSess)));
                                                {6339}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6340}event endSrv(Cli_5023,Sess_5025,PartC_5254)
                                        )
                                        else
                                            {6341}let v_5260: bool = (Disco_5024 = B) in
                                            (
                                                {6342}if v_5260 then
                                                (
                                                    {6343}let pkDisco_5261: bitstring = pub(skB) in
                                                    {6344}in(c, (=pkCli_5248,em1_5262: bitstring,sigM1_5263: bitstring));
                                                    {6345}let m1_5264: bitstring = dec(em1_5262,skSess) in
                                                    {6346}if (verify(h(m1_5264),sigM1_5263,pkCli_5248) <> true) then
                                                        0
                                                    else
                                                        {6347}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5265: bitstring) = m1_5264 in
                                                        {6348}new Ns_5266: bitstring;
                                                        {6349}new ST_5267: bitstring;
                                                        {6350}new TTL_5268: bitstring;
                                                        {6351}let gNs_5269: bitstring = exp(g,Ns_5266) in
                                                        {6352}let m2_5270: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5269,ST_5267,TTL_5268) in
                                                        {6353}event beginSrv(Sess_5025,Cli_5023,gNs_5269);
                                                        {6354}out(c, (enc(m2_5270,pkCli_5248),sign(h(m2_5270),skSess)));
                                                        {6355}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6356}event endSrv(Cli_5023,Sess_5025,PartC_5265)
                                                )
                                                else
                                                    {6357}let v_5271: bool = (Disco_5024 = C) in
                                                    (
                                                        {6358}if v_5271 then
                                                        (
                                                            {6359}let pkDisco_5272: bitstring = pub(skC) in
                                                            {6360}in(c, (=pkCli_5248,em1_5273: bitstring,sigM1_5274: bitstring));
                                                            {6361}let m1_5275: bitstring = dec(em1_5273,skSess) in
                                                            {6362}if (verify(h(m1_5275),sigM1_5274,pkCli_5248) <> true) then
                                                                0
                                                            else
                                                                {6363}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5276: bitstring) = m1_5275 in
                                                                {6364}new Ns_5277: bitstring;
                                                                {6365}new ST_5278: bitstring;
                                                                {6366}new TTL_5279: bitstring;
                                                                {6367}let gNs_5280: bitstring = exp(g,Ns_5277) in
                                                                {6368}let m2_5281: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5280,ST_5278,TTL_5279) in
                                                                {6369}event beginSrv(Sess_5025,Cli_5023,gNs_5280);
                                                                {6370}out(c, (enc(m2_5281,pkCli_5248),sign(h(m2_5281),skSess)));
                                                                {6371}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6372}event endSrv(Cli_5023,Sess_5025,PartC_5276)
                                                        )
                                                        else
                                                            {6373}let pkDisco_5282: bitstring = pub(sk(Disco_5024)) in
                                                            {6374}in(c, (=pkCli_5248,em1_5283: bitstring,sigM1_5284: bitstring));
                                                            {6375}let m1_5285: bitstring = dec(em1_5283,skSess) in
                                                            {6376}if (verify(h(m1_5285),sigM1_5284,pkCli_5248) <> true) then
                                                                0
                                                            else
                                                                {6377}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5286: bitstring) = m1_5285 in
                                                                {6378}new Ns_5287: bitstring;
                                                                {6379}new ST_5288: bitstring;
                                                                {6380}new TTL_5289: bitstring;
                                                                {6381}let gNs_5290: bitstring = exp(g,Ns_5287) in
                                                                {6382}let m2_5291: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5290,ST_5288,TTL_5289) in
                                                                {6383}event beginSrv(Sess_5025,Cli_5023,gNs_5290);
                                                                {6384}out(c, (enc(m2_5291,pkCli_5248),sign(h(m2_5291),skSess)));
                                                                {6385}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6386}event endSrv(Cli_5023,Sess_5025,PartC_5286)
                                                    )
                                                    else
                                                        {6387}let pkDisco_5292: bitstring = fail-any in
                                                        {6388}in(c, (=pkCli_5248,em1_5293: bitstring,sigM1_5294: bitstring));
                                                        {6389}let m1_5295: bitstring = dec(em1_5293,skSess) in
                                                        {6390}if (verify(h(m1_5295),sigM1_5294,pkCli_5248) <> true) then
                                                            0
                                                        else
                                                            {6391}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5296: bitstring) = m1_5295 in
                                                            {6392}new Ns_5297: bitstring;
                                                            {6393}new ST_5298: bitstring;
                                                            {6394}new TTL_5299: bitstring;
                                                            {6395}let gNs_5300: bitstring = exp(g,Ns_5297) in
                                                            {6396}let m2_5301: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5300,ST_5298,TTL_5299) in
                                                            {6397}event beginSrv(Sess_5025,Cli_5023,gNs_5300);
                                                            {6398}out(c, (enc(m2_5301,pkCli_5248),sign(h(m2_5301),skSess)));
                                                            {6399}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6400}event endSrv(Cli_5023,Sess_5025,PartC_5296)
                                            )
                                            else
                                                {6401}let pkDisco_5302: bitstring = fail-any in
                                                {6402}in(c, (=pkCli_5248,em1_5303: bitstring,sigM1_5304: bitstring));
                                                {6403}let m1_5305: bitstring = dec(em1_5303,skSess) in
                                                {6404}if (verify(h(m1_5305),sigM1_5304,pkCli_5248) <> true) then
                                                    0
                                                else
                                                    {6405}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5306: bitstring) = m1_5305 in
                                                    {6406}new Ns_5307: bitstring;
                                                    {6407}new ST_5308: bitstring;
                                                    {6408}new TTL_5309: bitstring;
                                                    {6409}let gNs_5310: bitstring = exp(g,Ns_5307) in
                                                    {6410}let m2_5311: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5310,ST_5308,TTL_5309) in
                                                    {6411}event beginSrv(Sess_5025,Cli_5023,gNs_5310);
                                                    {6412}out(c, (enc(m2_5311,pkCli_5248),sign(h(m2_5311),skSess)));
                                                    {6413}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6414}event endSrv(Cli_5023,Sess_5025,PartC_5306)
                                    )
                                    else
                                        {6415}let pkDisco_5312: bitstring = fail-any in
                                        {6416}in(c, (=pkCli_5248,em1_5313: bitstring,sigM1_5314: bitstring));
                                        {6417}let m1_5315: bitstring = dec(em1_5313,skSess) in
                                        {6418}if (verify(h(m1_5315),sigM1_5314,pkCli_5248) <> true) then
                                            0
                                        else
                                            {6419}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5248,PartC_5316: bitstring) = m1_5315 in
                                            {6420}new Ns_5317: bitstring;
                                            {6421}new ST_5318: bitstring;
                                            {6422}new TTL_5319: bitstring;
                                            {6423}let gNs_5320: bitstring = exp(g,Ns_5317) in
                                            {6424}let m2_5321: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5320,ST_5318,TTL_5319) in
                                            {6425}event beginSrv(Sess_5025,Cli_5023,gNs_5320);
                                            {6426}out(c, (enc(m2_5321,pkCli_5248),sign(h(m2_5321),skSess)));
                                            {6427}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6428}event endSrv(Cli_5023,Sess_5025,PartC_5316)
                            )
                            else
                                {6429}let pkCli_5322: bitstring = fail-any in
                                {6430}let v_5323: bool = (Disco_5024 = A) in
                                (
                                    {6431}if v_5323 then
                                    (
                                        {6432}let pkDisco_5324: bitstring = pub(skA) in
                                        {6433}in(c, (=pkCli_5322,em1_5325: bitstring,sigM1_5326: bitstring));
                                        {6434}let m1_5327: bitstring = dec(em1_5325,skSess) in
                                        {6435}if (verify(h(m1_5327),sigM1_5326,pkCli_5322) <> true) then
                                            0
                                        else
                                            {6436}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5328: bitstring) = m1_5327 in
                                            {6437}new Ns_5329: bitstring;
                                            {6438}new ST_5330: bitstring;
                                            {6439}new TTL_5331: bitstring;
                                            {6440}let gNs_5332: bitstring = exp(g,Ns_5329) in
                                            {6441}let m2_5333: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5332,ST_5330,TTL_5331) in
                                            {6442}event beginSrv(Sess_5025,Cli_5023,gNs_5332);
                                            {6443}out(c, (enc(m2_5333,pkCli_5322),sign(h(m2_5333),skSess)));
                                            {6444}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6445}event endSrv(Cli_5023,Sess_5025,PartC_5328)
                                    )
                                    else
                                        {6446}let v_5334: bool = (Disco_5024 = B) in
                                        (
                                            {6447}if v_5334 then
                                            (
                                                {6448}let pkDisco_5335: bitstring = pub(skB) in
                                                {6449}in(c, (=pkCli_5322,em1_5336: bitstring,sigM1_5337: bitstring));
                                                {6450}let m1_5338: bitstring = dec(em1_5336,skSess) in
                                                {6451}if (verify(h(m1_5338),sigM1_5337,pkCli_5322) <> true) then
                                                    0
                                                else
                                                    {6452}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5339: bitstring) = m1_5338 in
                                                    {6453}new Ns_5340: bitstring;
                                                    {6454}new ST_5341: bitstring;
                                                    {6455}new TTL_5342: bitstring;
                                                    {6456}let gNs_5343: bitstring = exp(g,Ns_5340) in
                                                    {6457}let m2_5344: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5343,ST_5341,TTL_5342) in
                                                    {6458}event beginSrv(Sess_5025,Cli_5023,gNs_5343);
                                                    {6459}out(c, (enc(m2_5344,pkCli_5322),sign(h(m2_5344),skSess)));
                                                    {6460}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6461}event endSrv(Cli_5023,Sess_5025,PartC_5339)
                                            )
                                            else
                                                {6462}let v_5345: bool = (Disco_5024 = C) in
                                                (
                                                    {6463}if v_5345 then
                                                    (
                                                        {6464}let pkDisco_5346: bitstring = pub(skC) in
                                                        {6465}in(c, (=pkCli_5322,em1_5347: bitstring,sigM1_5348: bitstring));
                                                        {6466}let m1_5349: bitstring = dec(em1_5347,skSess) in
                                                        {6467}if (verify(h(m1_5349),sigM1_5348,pkCli_5322) <> true) then
                                                            0
                                                        else
                                                            {6468}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5350: bitstring) = m1_5349 in
                                                            {6469}new Ns_5351: bitstring;
                                                            {6470}new ST_5352: bitstring;
                                                            {6471}new TTL_5353: bitstring;
                                                            {6472}let gNs_5354: bitstring = exp(g,Ns_5351) in
                                                            {6473}let m2_5355: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5354,ST_5352,TTL_5353) in
                                                            {6474}event beginSrv(Sess_5025,Cli_5023,gNs_5354);
                                                            {6475}out(c, (enc(m2_5355,pkCli_5322),sign(h(m2_5355),skSess)));
                                                            {6476}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6477}event endSrv(Cli_5023,Sess_5025,PartC_5350)
                                                    )
                                                    else
                                                        {6478}let pkDisco_5356: bitstring = pub(sk(Disco_5024)) in
                                                        {6479}in(c, (=pkCli_5322,em1_5357: bitstring,sigM1_5358: bitstring));
                                                        {6480}let m1_5359: bitstring = dec(em1_5357,skSess) in
                                                        {6481}if (verify(h(m1_5359),sigM1_5358,pkCli_5322) <> true) then
                                                            0
                                                        else
                                                            {6482}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5360: bitstring) = m1_5359 in
                                                            {6483}new Ns_5361: bitstring;
                                                            {6484}new ST_5362: bitstring;
                                                            {6485}new TTL_5363: bitstring;
                                                            {6486}let gNs_5364: bitstring = exp(g,Ns_5361) in
                                                            {6487}let m2_5365: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5364,ST_5362,TTL_5363) in
                                                            {6488}event beginSrv(Sess_5025,Cli_5023,gNs_5364);
                                                            {6489}out(c, (enc(m2_5365,pkCli_5322),sign(h(m2_5365),skSess)));
                                                            {6490}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6491}event endSrv(Cli_5023,Sess_5025,PartC_5360)
                                                )
                                                else
                                                    {6492}let pkDisco_5366: bitstring = fail-any in
                                                    {6493}in(c, (=pkCli_5322,em1_5367: bitstring,sigM1_5368: bitstring));
                                                    {6494}let m1_5369: bitstring = dec(em1_5367,skSess) in
                                                    {6495}if (verify(h(m1_5369),sigM1_5368,pkCli_5322) <> true) then
                                                        0
                                                    else
                                                        {6496}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5370: bitstring) = m1_5369 in
                                                        {6497}new Ns_5371: bitstring;
                                                        {6498}new ST_5372: bitstring;
                                                        {6499}new TTL_5373: bitstring;
                                                        {6500}let gNs_5374: bitstring = exp(g,Ns_5371) in
                                                        {6501}let m2_5375: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5374,ST_5372,TTL_5373) in
                                                        {6502}event beginSrv(Sess_5025,Cli_5023,gNs_5374);
                                                        {6503}out(c, (enc(m2_5375,pkCli_5322),sign(h(m2_5375),skSess)));
                                                        {6504}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6505}event endSrv(Cli_5023,Sess_5025,PartC_5370)
                                        )
                                        else
                                            {6506}let pkDisco_5376: bitstring = fail-any in
                                            {6507}in(c, (=pkCli_5322,em1_5377: bitstring,sigM1_5378: bitstring));
                                            {6508}let m1_5379: bitstring = dec(em1_5377,skSess) in
                                            {6509}if (verify(h(m1_5379),sigM1_5378,pkCli_5322) <> true) then
                                                0
                                            else
                                                {6510}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5380: bitstring) = m1_5379 in
                                                {6511}new Ns_5381: bitstring;
                                                {6512}new ST_5382: bitstring;
                                                {6513}new TTL_5383: bitstring;
                                                {6514}let gNs_5384: bitstring = exp(g,Ns_5381) in
                                                {6515}let m2_5385: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5384,ST_5382,TTL_5383) in
                                                {6516}event beginSrv(Sess_5025,Cli_5023,gNs_5384);
                                                {6517}out(c, (enc(m2_5385,pkCli_5322),sign(h(m2_5385),skSess)));
                                                {6518}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6519}event endSrv(Cli_5023,Sess_5025,PartC_5380)
                                )
                                else
                                    {6520}let pkDisco_5386: bitstring = fail-any in
                                    {6521}in(c, (=pkCli_5322,em1_5387: bitstring,sigM1_5388: bitstring));
                                    {6522}let m1_5389: bitstring = dec(em1_5387,skSess) in
                                    {6523}if (verify(h(m1_5389),sigM1_5388,pkCli_5322) <> true) then
                                        0
                                    else
                                        {6524}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5322,PartC_5390: bitstring) = m1_5389 in
                                        {6525}new Ns_5391: bitstring;
                                        {6526}new ST_5392: bitstring;
                                        {6527}new TTL_5393: bitstring;
                                        {6528}let gNs_5394: bitstring = exp(g,Ns_5391) in
                                        {6529}let m2_5395: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5394,ST_5392,TTL_5393) in
                                        {6530}event beginSrv(Sess_5025,Cli_5023,gNs_5394);
                                        {6531}out(c, (enc(m2_5395,pkCli_5322),sign(h(m2_5395),skSess)));
                                        {6532}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6533}event endSrv(Cli_5023,Sess_5025,PartC_5390)
                    )
                    else
                        {6534}let pkCli_5396: bitstring = fail-any in
                        {6535}let v_5397: bool = (Disco_5024 = A) in
                        (
                            {6536}if v_5397 then
                            (
                                {6537}let pkDisco_5398: bitstring = pub(skA) in
                                {6538}in(c, (=pkCli_5396,em1_5399: bitstring,sigM1_5400: bitstring));
                                {6539}let m1_5401: bitstring = dec(em1_5399,skSess) in
                                {6540}if (verify(h(m1_5401),sigM1_5400,pkCli_5396) <> true) then
                                    0
                                else
                                    {6541}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5402: bitstring) = m1_5401 in
                                    {6542}new Ns_5403: bitstring;
                                    {6543}new ST_5404: bitstring;
                                    {6544}new TTL_5405: bitstring;
                                    {6545}let gNs_5406: bitstring = exp(g,Ns_5403) in
                                    {6546}let m2_5407: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5406,ST_5404,TTL_5405) in
                                    {6547}event beginSrv(Sess_5025,Cli_5023,gNs_5406);
                                    {6548}out(c, (enc(m2_5407,pkCli_5396),sign(h(m2_5407),skSess)));
                                    {6549}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6550}event endSrv(Cli_5023,Sess_5025,PartC_5402)
                            )
                            else
                                {6551}let v_5408: bool = (Disco_5024 = B) in
                                (
                                    {6552}if v_5408 then
                                    (
                                        {6553}let pkDisco_5409: bitstring = pub(skB) in
                                        {6554}in(c, (=pkCli_5396,em1_5410: bitstring,sigM1_5411: bitstring));
                                        {6555}let m1_5412: bitstring = dec(em1_5410,skSess) in
                                        {6556}if (verify(h(m1_5412),sigM1_5411,pkCli_5396) <> true) then
                                            0
                                        else
                                            {6557}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5413: bitstring) = m1_5412 in
                                            {6558}new Ns_5414: bitstring;
                                            {6559}new ST_5415: bitstring;
                                            {6560}new TTL_5416: bitstring;
                                            {6561}let gNs_5417: bitstring = exp(g,Ns_5414) in
                                            {6562}let m2_5418: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5417,ST_5415,TTL_5416) in
                                            {6563}event beginSrv(Sess_5025,Cli_5023,gNs_5417);
                                            {6564}out(c, (enc(m2_5418,pkCli_5396),sign(h(m2_5418),skSess)));
                                            {6565}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6566}event endSrv(Cli_5023,Sess_5025,PartC_5413)
                                    )
                                    else
                                        {6567}let v_5419: bool = (Disco_5024 = C) in
                                        (
                                            {6568}if v_5419 then
                                            (
                                                {6569}let pkDisco_5420: bitstring = pub(skC) in
                                                {6570}in(c, (=pkCli_5396,em1_5421: bitstring,sigM1_5422: bitstring));
                                                {6571}let m1_5423: bitstring = dec(em1_5421,skSess) in
                                                {6572}if (verify(h(m1_5423),sigM1_5422,pkCli_5396) <> true) then
                                                    0
                                                else
                                                    {6573}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5424: bitstring) = m1_5423 in
                                                    {6574}new Ns_5425: bitstring;
                                                    {6575}new ST_5426: bitstring;
                                                    {6576}new TTL_5427: bitstring;
                                                    {6577}let gNs_5428: bitstring = exp(g,Ns_5425) in
                                                    {6578}let m2_5429: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5428,ST_5426,TTL_5427) in
                                                    {6579}event beginSrv(Sess_5025,Cli_5023,gNs_5428);
                                                    {6580}out(c, (enc(m2_5429,pkCli_5396),sign(h(m2_5429),skSess)));
                                                    {6581}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6582}event endSrv(Cli_5023,Sess_5025,PartC_5424)
                                            )
                                            else
                                                {6583}let pkDisco_5430: bitstring = pub(sk(Disco_5024)) in
                                                {6584}in(c, (=pkCli_5396,em1_5431: bitstring,sigM1_5432: bitstring));
                                                {6585}let m1_5433: bitstring = dec(em1_5431,skSess) in
                                                {6586}if (verify(h(m1_5433),sigM1_5432,pkCli_5396) <> true) then
                                                    0
                                                else
                                                    {6587}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5434: bitstring) = m1_5433 in
                                                    {6588}new Ns_5435: bitstring;
                                                    {6589}new ST_5436: bitstring;
                                                    {6590}new TTL_5437: bitstring;
                                                    {6591}let gNs_5438: bitstring = exp(g,Ns_5435) in
                                                    {6592}let m2_5439: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5438,ST_5436,TTL_5437) in
                                                    {6593}event beginSrv(Sess_5025,Cli_5023,gNs_5438);
                                                    {6594}out(c, (enc(m2_5439,pkCli_5396),sign(h(m2_5439),skSess)));
                                                    {6595}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6596}event endSrv(Cli_5023,Sess_5025,PartC_5434)
                                        )
                                        else
                                            {6597}let pkDisco_5440: bitstring = fail-any in
                                            {6598}in(c, (=pkCli_5396,em1_5441: bitstring,sigM1_5442: bitstring));
                                            {6599}let m1_5443: bitstring = dec(em1_5441,skSess) in
                                            {6600}if (verify(h(m1_5443),sigM1_5442,pkCli_5396) <> true) then
                                                0
                                            else
                                                {6601}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5444: bitstring) = m1_5443 in
                                                {6602}new Ns_5445: bitstring;
                                                {6603}new ST_5446: bitstring;
                                                {6604}new TTL_5447: bitstring;
                                                {6605}let gNs_5448: bitstring = exp(g,Ns_5445) in
                                                {6606}let m2_5449: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5448,ST_5446,TTL_5447) in
                                                {6607}event beginSrv(Sess_5025,Cli_5023,gNs_5448);
                                                {6608}out(c, (enc(m2_5449,pkCli_5396),sign(h(m2_5449),skSess)));
                                                {6609}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6610}event endSrv(Cli_5023,Sess_5025,PartC_5444)
                                )
                                else
                                    {6611}let pkDisco_5450: bitstring = fail-any in
                                    {6612}in(c, (=pkCli_5396,em1_5451: bitstring,sigM1_5452: bitstring));
                                    {6613}let m1_5453: bitstring = dec(em1_5451,skSess) in
                                    {6614}if (verify(h(m1_5453),sigM1_5452,pkCli_5396) <> true) then
                                        0
                                    else
                                        {6615}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5454: bitstring) = m1_5453 in
                                        {6616}new Ns_5455: bitstring;
                                        {6617}new ST_5456: bitstring;
                                        {6618}new TTL_5457: bitstring;
                                        {6619}let gNs_5458: bitstring = exp(g,Ns_5455) in
                                        {6620}let m2_5459: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5458,ST_5456,TTL_5457) in
                                        {6621}event beginSrv(Sess_5025,Cli_5023,gNs_5458);
                                        {6622}out(c, (enc(m2_5459,pkCli_5396),sign(h(m2_5459),skSess)));
                                        {6623}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6624}event endSrv(Cli_5023,Sess_5025,PartC_5454)
                        )
                        else
                            {6625}let pkDisco_5460: bitstring = fail-any in
                            {6626}in(c, (=pkCli_5396,em1_5461: bitstring,sigM1_5462: bitstring));
                            {6627}let m1_5463: bitstring = dec(em1_5461,skSess) in
                            {6628}if (verify(h(m1_5463),sigM1_5462,pkCli_5396) <> true) then
                                0
                            else
                                {6629}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5396,PartC_5464: bitstring) = m1_5463 in
                                {6630}new Ns_5465: bitstring;
                                {6631}new ST_5466: bitstring;
                                {6632}new TTL_5467: bitstring;
                                {6633}let gNs_5468: bitstring = exp(g,Ns_5465) in
                                {6634}let m2_5469: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5468,ST_5466,TTL_5467) in
                                {6635}event beginSrv(Sess_5025,Cli_5023,gNs_5468);
                                {6636}out(c, (enc(m2_5469,pkCli_5396),sign(h(m2_5469),skSess)));
                                {6637}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {6638}event endSrv(Cli_5023,Sess_5025,PartC_5464)
            )
            else
                {6639}let pkCli_5470: bitstring = fail-any in
                {6640}let v_5471: bool = (Disco_5024 = A) in
                (
                    {6641}if v_5471 then
                    (
                        {6642}let pkDisco_5472: bitstring = pub(skA) in
                        {6643}in(c, (=pkCli_5470,em1_5473: bitstring,sigM1_5474: bitstring));
                        {6644}let m1_5475: bitstring = dec(em1_5473,skSess) in
                        {6645}if (verify(h(m1_5475),sigM1_5474,pkCli_5470) <> true) then
                            0
                        else
                            {6646}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5476: bitstring) = m1_5475 in
                            {6647}new Ns_5477: bitstring;
                            {6648}new ST_5478: bitstring;
                            {6649}new TTL_5479: bitstring;
                            {6650}let gNs_5480: bitstring = exp(g,Ns_5477) in
                            {6651}let m2_5481: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5480,ST_5478,TTL_5479) in
                            {6652}event beginSrv(Sess_5025,Cli_5023,gNs_5480);
                            {6653}out(c, (enc(m2_5481,pkCli_5470),sign(h(m2_5481),skSess)));
                            {6654}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {6655}event endSrv(Cli_5023,Sess_5025,PartC_5476)
                    )
                    else
                        {6656}let v_5482: bool = (Disco_5024 = B) in
                        (
                            {6657}if v_5482 then
                            (
                                {6658}let pkDisco_5483: bitstring = pub(skB) in
                                {6659}in(c, (=pkCli_5470,em1_5484: bitstring,sigM1_5485: bitstring));
                                {6660}let m1_5486: bitstring = dec(em1_5484,skSess) in
                                {6661}if (verify(h(m1_5486),sigM1_5485,pkCli_5470) <> true) then
                                    0
                                else
                                    {6662}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5487: bitstring) = m1_5486 in
                                    {6663}new Ns_5488: bitstring;
                                    {6664}new ST_5489: bitstring;
                                    {6665}new TTL_5490: bitstring;
                                    {6666}let gNs_5491: bitstring = exp(g,Ns_5488) in
                                    {6667}let m2_5492: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5491,ST_5489,TTL_5490) in
                                    {6668}event beginSrv(Sess_5025,Cli_5023,gNs_5491);
                                    {6669}out(c, (enc(m2_5492,pkCli_5470),sign(h(m2_5492),skSess)));
                                    {6670}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6671}event endSrv(Cli_5023,Sess_5025,PartC_5487)
                            )
                            else
                                {6672}let v_5493: bool = (Disco_5024 = C) in
                                (
                                    {6673}if v_5493 then
                                    (
                                        {6674}let pkDisco_5494: bitstring = pub(skC) in
                                        {6675}in(c, (=pkCli_5470,em1_5495: bitstring,sigM1_5496: bitstring));
                                        {6676}let m1_5497: bitstring = dec(em1_5495,skSess) in
                                        {6677}if (verify(h(m1_5497),sigM1_5496,pkCli_5470) <> true) then
                                            0
                                        else
                                            {6678}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5498: bitstring) = m1_5497 in
                                            {6679}new Ns_5499: bitstring;
                                            {6680}new ST_5500: bitstring;
                                            {6681}new TTL_5501: bitstring;
                                            {6682}let gNs_5502: bitstring = exp(g,Ns_5499) in
                                            {6683}let m2_5503: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5502,ST_5500,TTL_5501) in
                                            {6684}event beginSrv(Sess_5025,Cli_5023,gNs_5502);
                                            {6685}out(c, (enc(m2_5503,pkCli_5470),sign(h(m2_5503),skSess)));
                                            {6686}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6687}event endSrv(Cli_5023,Sess_5025,PartC_5498)
                                    )
                                    else
                                        {6688}let pkDisco_5504: bitstring = pub(sk(Disco_5024)) in
                                        {6689}in(c, (=pkCli_5470,em1_5505: bitstring,sigM1_5506: bitstring));
                                        {6690}let m1_5507: bitstring = dec(em1_5505,skSess) in
                                        {6691}if (verify(h(m1_5507),sigM1_5506,pkCli_5470) <> true) then
                                            0
                                        else
                                            {6692}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5508: bitstring) = m1_5507 in
                                            {6693}new Ns_5509: bitstring;
                                            {6694}new ST_5510: bitstring;
                                            {6695}new TTL_5511: bitstring;
                                            {6696}let gNs_5512: bitstring = exp(g,Ns_5509) in
                                            {6697}let m2_5513: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5512,ST_5510,TTL_5511) in
                                            {6698}event beginSrv(Sess_5025,Cli_5023,gNs_5512);
                                            {6699}out(c, (enc(m2_5513,pkCli_5470),sign(h(m2_5513),skSess)));
                                            {6700}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6701}event endSrv(Cli_5023,Sess_5025,PartC_5508)
                                )
                                else
                                    {6702}let pkDisco_5514: bitstring = fail-any in
                                    {6703}in(c, (=pkCli_5470,em1_5515: bitstring,sigM1_5516: bitstring));
                                    {6704}let m1_5517: bitstring = dec(em1_5515,skSess) in
                                    {6705}if (verify(h(m1_5517),sigM1_5516,pkCli_5470) <> true) then
                                        0
                                    else
                                        {6706}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5518: bitstring) = m1_5517 in
                                        {6707}new Ns_5519: bitstring;
                                        {6708}new ST_5520: bitstring;
                                        {6709}new TTL_5521: bitstring;
                                        {6710}let gNs_5522: bitstring = exp(g,Ns_5519) in
                                        {6711}let m2_5523: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5522,ST_5520,TTL_5521) in
                                        {6712}event beginSrv(Sess_5025,Cli_5023,gNs_5522);
                                        {6713}out(c, (enc(m2_5523,pkCli_5470),sign(h(m2_5523),skSess)));
                                        {6714}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6715}event endSrv(Cli_5023,Sess_5025,PartC_5518)
                        )
                        else
                            {6716}let pkDisco_5524: bitstring = fail-any in
                            {6717}in(c, (=pkCli_5470,em1_5525: bitstring,sigM1_5526: bitstring));
                            {6718}let m1_5527: bitstring = dec(em1_5525,skSess) in
                            {6719}if (verify(h(m1_5527),sigM1_5526,pkCli_5470) <> true) then
                                0
                            else
                                {6720}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5528: bitstring) = m1_5527 in
                                {6721}new Ns_5529: bitstring;
                                {6722}new ST_5530: bitstring;
                                {6723}new TTL_5531: bitstring;
                                {6724}let gNs_5532: bitstring = exp(g,Ns_5529) in
                                {6725}let m2_5533: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5532,ST_5530,TTL_5531) in
                                {6726}event beginSrv(Sess_5025,Cli_5023,gNs_5532);
                                {6727}out(c, (enc(m2_5533,pkCli_5470),sign(h(m2_5533),skSess)));
                                {6728}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {6729}event endSrv(Cli_5023,Sess_5025,PartC_5528)
                )
                else
                    {6730}let pkDisco_5534: bitstring = fail-any in
                    {6731}in(c, (=pkCli_5470,em1_5535: bitstring,sigM1_5536: bitstring));
                    {6732}let m1_5537: bitstring = dec(em1_5535,skSess) in
                    {6733}if (verify(h(m1_5537),sigM1_5536,pkCli_5470) <> true) then
                        0
                    else
                        {6734}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5470,PartC_5538: bitstring) = m1_5537 in
                        {6735}new Ns_5539: bitstring;
                        {6736}new ST_5540: bitstring;
                        {6737}new TTL_5541: bitstring;
                        {6738}let gNs_5542: bitstring = exp(g,Ns_5539) in
                        {6739}let m2_5543: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5542,ST_5540,TTL_5541) in
                        {6740}event beginSrv(Sess_5025,Cli_5023,gNs_5542);
                        {6741}out(c, (enc(m2_5543,pkCli_5470),sign(h(m2_5543),skSess)));
                        {6742}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                        {6743}event endSrv(Cli_5023,Sess_5025,PartC_5538)
        )
        else
            {6744}let v_5544: bool = (Sess_5025 = B) in
            (
                {6745}if v_5544 then
                (
                    {6746}let skSess_5545: bitstring = skB in
                    {6747}let pkSess_5546: bitstring = pub(skSess_5545) in
                    {6748}let v_5547: bool = (Cli_5023 = A) in
                    (
                        {6749}if v_5547 then
                        (
                            {6750}let pkCli_5548: bitstring = pub(skA) in
                            {6751}let v_5549: bool = (Disco_5024 = A) in
                            (
                                {6752}if v_5549 then
                                (
                                    {6753}let pkDisco_5550: bitstring = pub(skA) in
                                    {6754}in(c, (=pkCli_5548,em1_5551: bitstring,sigM1_5552: bitstring));
                                    {6755}let m1_5553: bitstring = dec(em1_5551,skSess_5545) in
                                    {6756}if (verify(h(m1_5553),sigM1_5552,pkCli_5548) <> true) then
                                        0
                                    else
                                        {6757}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5554: bitstring) = m1_5553 in
                                        {6758}new Ns_5555: bitstring;
                                        {6759}new ST_5556: bitstring;
                                        {6760}new TTL_5557: bitstring;
                                        {6761}let gNs_5558: bitstring = exp(g,Ns_5555) in
                                        {6762}let m2_5559: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5558,ST_5556,TTL_5557) in
                                        {6763}event beginSrv(Sess_5025,Cli_5023,gNs_5558);
                                        {6764}out(c, (enc(m2_5559,pkCli_5548),sign(h(m2_5559),skSess_5545)));
                                        {6765}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {6766}event endSrv(Cli_5023,Sess_5025,PartC_5554)
                                )
                                else
                                    {6767}let v_5560: bool = (Disco_5024 = B) in
                                    (
                                        {6768}if v_5560 then
                                        (
                                            {6769}let pkDisco_5561: bitstring = pub(skB) in
                                            {6770}in(c, (=pkCli_5548,em1_5562: bitstring,sigM1_5563: bitstring));
                                            {6771}let m1_5564: bitstring = dec(em1_5562,skSess_5545) in
                                            {6772}if (verify(h(m1_5564),sigM1_5563,pkCli_5548) <> true) then
                                                0
                                            else
                                                {6773}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5565: bitstring) = m1_5564 in
                                                {6774}new Ns_5566: bitstring;
                                                {6775}new ST_5567: bitstring;
                                                {6776}new TTL_5568: bitstring;
                                                {6777}let gNs_5569: bitstring = exp(g,Ns_5566) in
                                                {6778}let m2_5570: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5569,ST_5567,TTL_5568) in
                                                {6779}event beginSrv(Sess_5025,Cli_5023,gNs_5569);
                                                {6780}out(c, (enc(m2_5570,pkCli_5548),sign(h(m2_5570),skSess_5545)));
                                                {6781}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6782}event endSrv(Cli_5023,Sess_5025,PartC_5565)
                                        )
                                        else
                                            {6783}let v_5571: bool = (Disco_5024 = C) in
                                            (
                                                {6784}if v_5571 then
                                                (
                                                    {6785}let pkDisco_5572: bitstring = pub(skC) in
                                                    {6786}in(c, (=pkCli_5548,em1_5573: bitstring,sigM1_5574: bitstring));
                                                    {6787}let m1_5575: bitstring = dec(em1_5573,skSess_5545) in
                                                    {6788}if (verify(h(m1_5575),sigM1_5574,pkCli_5548) <> true) then
                                                        0
                                                    else
                                                        {6789}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5576: bitstring) = m1_5575 in
                                                        {6790}new Ns_5577: bitstring;
                                                        {6791}new ST_5578: bitstring;
                                                        {6792}new TTL_5579: bitstring;
                                                        {6793}let gNs_5580: bitstring = exp(g,Ns_5577) in
                                                        {6794}let m2_5581: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5580,ST_5578,TTL_5579) in
                                                        {6795}event beginSrv(Sess_5025,Cli_5023,gNs_5580);
                                                        {6796}out(c, (enc(m2_5581,pkCli_5548),sign(h(m2_5581),skSess_5545)));
                                                        {6797}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6798}event endSrv(Cli_5023,Sess_5025,PartC_5576)
                                                )
                                                else
                                                    {6799}let pkDisco_5582: bitstring = pub(sk(Disco_5024)) in
                                                    {6800}in(c, (=pkCli_5548,em1_5583: bitstring,sigM1_5584: bitstring));
                                                    {6801}let m1_5585: bitstring = dec(em1_5583,skSess_5545) in
                                                    {6802}if (verify(h(m1_5585),sigM1_5584,pkCli_5548) <> true) then
                                                        0
                                                    else
                                                        {6803}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5586: bitstring) = m1_5585 in
                                                        {6804}new Ns_5587: bitstring;
                                                        {6805}new ST_5588: bitstring;
                                                        {6806}new TTL_5589: bitstring;
                                                        {6807}let gNs_5590: bitstring = exp(g,Ns_5587) in
                                                        {6808}let m2_5591: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5590,ST_5588,TTL_5589) in
                                                        {6809}event beginSrv(Sess_5025,Cli_5023,gNs_5590);
                                                        {6810}out(c, (enc(m2_5591,pkCli_5548),sign(h(m2_5591),skSess_5545)));
                                                        {6811}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6812}event endSrv(Cli_5023,Sess_5025,PartC_5586)
                                            )
                                            else
                                                {6813}let pkDisco_5592: bitstring = fail-any in
                                                {6814}in(c, (=pkCli_5548,em1_5593: bitstring,sigM1_5594: bitstring));
                                                {6815}let m1_5595: bitstring = dec(em1_5593,skSess_5545) in
                                                {6816}if (verify(h(m1_5595),sigM1_5594,pkCli_5548) <> true) then
                                                    0
                                                else
                                                    {6817}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5596: bitstring) = m1_5595 in
                                                    {6818}new Ns_5597: bitstring;
                                                    {6819}new ST_5598: bitstring;
                                                    {6820}new TTL_5599: bitstring;
                                                    {6821}let gNs_5600: bitstring = exp(g,Ns_5597) in
                                                    {6822}let m2_5601: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5600,ST_5598,TTL_5599) in
                                                    {6823}event beginSrv(Sess_5025,Cli_5023,gNs_5600);
                                                    {6824}out(c, (enc(m2_5601,pkCli_5548),sign(h(m2_5601),skSess_5545)));
                                                    {6825}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6826}event endSrv(Cli_5023,Sess_5025,PartC_5596)
                                    )
                                    else
                                        {6827}let pkDisco_5602: bitstring = fail-any in
                                        {6828}in(c, (=pkCli_5548,em1_5603: bitstring,sigM1_5604: bitstring));
                                        {6829}let m1_5605: bitstring = dec(em1_5603,skSess_5545) in
                                        {6830}if (verify(h(m1_5605),sigM1_5604,pkCli_5548) <> true) then
                                            0
                                        else
                                            {6831}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5606: bitstring) = m1_5605 in
                                            {6832}new Ns_5607: bitstring;
                                            {6833}new ST_5608: bitstring;
                                            {6834}new TTL_5609: bitstring;
                                            {6835}let gNs_5610: bitstring = exp(g,Ns_5607) in
                                            {6836}let m2_5611: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5610,ST_5608,TTL_5609) in
                                            {6837}event beginSrv(Sess_5025,Cli_5023,gNs_5610);
                                            {6838}out(c, (enc(m2_5611,pkCli_5548),sign(h(m2_5611),skSess_5545)));
                                            {6839}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6840}event endSrv(Cli_5023,Sess_5025,PartC_5606)
                            )
                            else
                                {6841}let pkDisco_5612: bitstring = fail-any in
                                {6842}in(c, (=pkCli_5548,em1_5613: bitstring,sigM1_5614: bitstring));
                                {6843}let m1_5615: bitstring = dec(em1_5613,skSess_5545) in
                                {6844}if (verify(h(m1_5615),sigM1_5614,pkCli_5548) <> true) then
                                    0
                                else
                                    {6845}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5548,PartC_5616: bitstring) = m1_5615 in
                                    {6846}new Ns_5617: bitstring;
                                    {6847}new ST_5618: bitstring;
                                    {6848}new TTL_5619: bitstring;
                                    {6849}let gNs_5620: bitstring = exp(g,Ns_5617) in
                                    {6850}let m2_5621: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5620,ST_5618,TTL_5619) in
                                    {6851}event beginSrv(Sess_5025,Cli_5023,gNs_5620);
                                    {6852}out(c, (enc(m2_5621,pkCli_5548),sign(h(m2_5621),skSess_5545)));
                                    {6853}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {6854}event endSrv(Cli_5023,Sess_5025,PartC_5616)
                        )
                        else
                            {6855}let v_5622: bool = (Cli_5023 = B) in
                            (
                                {6856}if v_5622 then
                                (
                                    {6857}let pkCli_5623: bitstring = pub(skB) in
                                    {6858}let v_5624: bool = (Disco_5024 = A) in
                                    (
                                        {6859}if v_5624 then
                                        (
                                            {6860}let pkDisco_5625: bitstring = pub(skA) in
                                            {6861}in(c, (=pkCli_5623,em1_5626: bitstring,sigM1_5627: bitstring));
                                            {6862}let m1_5628: bitstring = dec(em1_5626,skSess_5545) in
                                            {6863}if (verify(h(m1_5628),sigM1_5627,pkCli_5623) <> true) then
                                                0
                                            else
                                                {6864}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5629: bitstring) = m1_5628 in
                                                {6865}new Ns_5630: bitstring;
                                                {6866}new ST_5631: bitstring;
                                                {6867}new TTL_5632: bitstring;
                                                {6868}let gNs_5633: bitstring = exp(g,Ns_5630) in
                                                {6869}let m2_5634: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5633,ST_5631,TTL_5632) in
                                                {6870}event beginSrv(Sess_5025,Cli_5023,gNs_5633);
                                                {6871}out(c, (enc(m2_5634,pkCli_5623),sign(h(m2_5634),skSess_5545)));
                                                {6872}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {6873}event endSrv(Cli_5023,Sess_5025,PartC_5629)
                                        )
                                        else
                                            {6874}let v_5635: bool = (Disco_5024 = B) in
                                            (
                                                {6875}if v_5635 then
                                                (
                                                    {6876}let pkDisco_5636: bitstring = pub(skB) in
                                                    {6877}in(c, (=pkCli_5623,em1_5637: bitstring,sigM1_5638: bitstring));
                                                    {6878}let m1_5639: bitstring = dec(em1_5637,skSess_5545) in
                                                    {6879}if (verify(h(m1_5639),sigM1_5638,pkCli_5623) <> true) then
                                                        0
                                                    else
                                                        {6880}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5640: bitstring) = m1_5639 in
                                                        {6881}new Ns_5641: bitstring;
                                                        {6882}new ST_5642: bitstring;
                                                        {6883}new TTL_5643: bitstring;
                                                        {6884}let gNs_5644: bitstring = exp(g,Ns_5641) in
                                                        {6885}let m2_5645: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5644,ST_5642,TTL_5643) in
                                                        {6886}event beginSrv(Sess_5025,Cli_5023,gNs_5644);
                                                        {6887}out(c, (enc(m2_5645,pkCli_5623),sign(h(m2_5645),skSess_5545)));
                                                        {6888}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6889}event endSrv(Cli_5023,Sess_5025,PartC_5640)
                                                )
                                                else
                                                    {6890}let v_5646: bool = (Disco_5024 = C) in
                                                    (
                                                        {6891}if v_5646 then
                                                        (
                                                            {6892}let pkDisco_5647: bitstring = pub(skC) in
                                                            {6893}in(c, (=pkCli_5623,em1_5648: bitstring,sigM1_5649: bitstring));
                                                            {6894}let m1_5650: bitstring = dec(em1_5648,skSess_5545) in
                                                            {6895}if (verify(h(m1_5650),sigM1_5649,pkCli_5623) <> true) then
                                                                0
                                                            else
                                                                {6896}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5651: bitstring) = m1_5650 in
                                                                {6897}new Ns_5652: bitstring;
                                                                {6898}new ST_5653: bitstring;
                                                                {6899}new TTL_5654: bitstring;
                                                                {6900}let gNs_5655: bitstring = exp(g,Ns_5652) in
                                                                {6901}let m2_5656: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5655,ST_5653,TTL_5654) in
                                                                {6902}event beginSrv(Sess_5025,Cli_5023,gNs_5655);
                                                                {6903}out(c, (enc(m2_5656,pkCli_5623),sign(h(m2_5656),skSess_5545)));
                                                                {6904}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6905}event endSrv(Cli_5023,Sess_5025,PartC_5651)
                                                        )
                                                        else
                                                            {6906}let pkDisco_5657: bitstring = pub(sk(Disco_5024)) in
                                                            {6907}in(c, (=pkCli_5623,em1_5658: bitstring,sigM1_5659: bitstring));
                                                            {6908}let m1_5660: bitstring = dec(em1_5658,skSess_5545) in
                                                            {6909}if (verify(h(m1_5660),sigM1_5659,pkCli_5623) <> true) then
                                                                0
                                                            else
                                                                {6910}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5661: bitstring) = m1_5660 in
                                                                {6911}new Ns_5662: bitstring;
                                                                {6912}new ST_5663: bitstring;
                                                                {6913}new TTL_5664: bitstring;
                                                                {6914}let gNs_5665: bitstring = exp(g,Ns_5662) in
                                                                {6915}let m2_5666: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5665,ST_5663,TTL_5664) in
                                                                {6916}event beginSrv(Sess_5025,Cli_5023,gNs_5665);
                                                                {6917}out(c, (enc(m2_5666,pkCli_5623),sign(h(m2_5666),skSess_5545)));
                                                                {6918}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6919}event endSrv(Cli_5023,Sess_5025,PartC_5661)
                                                    )
                                                    else
                                                        {6920}let pkDisco_5667: bitstring = fail-any in
                                                        {6921}in(c, (=pkCli_5623,em1_5668: bitstring,sigM1_5669: bitstring));
                                                        {6922}let m1_5670: bitstring = dec(em1_5668,skSess_5545) in
                                                        {6923}if (verify(h(m1_5670),sigM1_5669,pkCli_5623) <> true) then
                                                            0
                                                        else
                                                            {6924}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5671: bitstring) = m1_5670 in
                                                            {6925}new Ns_5672: bitstring;
                                                            {6926}new ST_5673: bitstring;
                                                            {6927}new TTL_5674: bitstring;
                                                            {6928}let gNs_5675: bitstring = exp(g,Ns_5672) in
                                                            {6929}let m2_5676: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5675,ST_5673,TTL_5674) in
                                                            {6930}event beginSrv(Sess_5025,Cli_5023,gNs_5675);
                                                            {6931}out(c, (enc(m2_5676,pkCli_5623),sign(h(m2_5676),skSess_5545)));
                                                            {6932}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {6933}event endSrv(Cli_5023,Sess_5025,PartC_5671)
                                            )
                                            else
                                                {6934}let pkDisco_5677: bitstring = fail-any in
                                                {6935}in(c, (=pkCli_5623,em1_5678: bitstring,sigM1_5679: bitstring));
                                                {6936}let m1_5680: bitstring = dec(em1_5678,skSess_5545) in
                                                {6937}if (verify(h(m1_5680),sigM1_5679,pkCli_5623) <> true) then
                                                    0
                                                else
                                                    {6938}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5681: bitstring) = m1_5680 in
                                                    {6939}new Ns_5682: bitstring;
                                                    {6940}new ST_5683: bitstring;
                                                    {6941}new TTL_5684: bitstring;
                                                    {6942}let gNs_5685: bitstring = exp(g,Ns_5682) in
                                                    {6943}let m2_5686: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5685,ST_5683,TTL_5684) in
                                                    {6944}event beginSrv(Sess_5025,Cli_5023,gNs_5685);
                                                    {6945}out(c, (enc(m2_5686,pkCli_5623),sign(h(m2_5686),skSess_5545)));
                                                    {6946}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {6947}event endSrv(Cli_5023,Sess_5025,PartC_5681)
                                    )
                                    else
                                        {6948}let pkDisco_5687: bitstring = fail-any in
                                        {6949}in(c, (=pkCli_5623,em1_5688: bitstring,sigM1_5689: bitstring));
                                        {6950}let m1_5690: bitstring = dec(em1_5688,skSess_5545) in
                                        {6951}if (verify(h(m1_5690),sigM1_5689,pkCli_5623) <> true) then
                                            0
                                        else
                                            {6952}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5623,PartC_5691: bitstring) = m1_5690 in
                                            {6953}new Ns_5692: bitstring;
                                            {6954}new ST_5693: bitstring;
                                            {6955}new TTL_5694: bitstring;
                                            {6956}let gNs_5695: bitstring = exp(g,Ns_5692) in
                                            {6957}let m2_5696: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5695,ST_5693,TTL_5694) in
                                            {6958}event beginSrv(Sess_5025,Cli_5023,gNs_5695);
                                            {6959}out(c, (enc(m2_5696,pkCli_5623),sign(h(m2_5696),skSess_5545)));
                                            {6960}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {6961}event endSrv(Cli_5023,Sess_5025,PartC_5691)
                                )
                                else
                                    {6962}let v_5697: bool = (Cli_5023 = C) in
                                    (
                                        {6963}if v_5697 then
                                        (
                                            {6964}let pkCli_5698: bitstring = pub(skC) in
                                            {6965}let v_5699: bool = (Disco_5024 = A) in
                                            (
                                                {6966}if v_5699 then
                                                (
                                                    {6967}let pkDisco_5700: bitstring = pub(skA) in
                                                    {6968}in(c, (=pkCli_5698,em1_5701: bitstring,sigM1_5702: bitstring));
                                                    {6969}let m1_5703: bitstring = dec(em1_5701,skSess_5545) in
                                                    {6970}if (verify(h(m1_5703),sigM1_5702,pkCli_5698) <> true) then
                                                        0
                                                    else
                                                        {6971}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5704: bitstring) = m1_5703 in
                                                        {6972}new Ns_5705: bitstring;
                                                        {6973}new ST_5706: bitstring;
                                                        {6974}new TTL_5707: bitstring;
                                                        {6975}let gNs_5708: bitstring = exp(g,Ns_5705) in
                                                        {6976}let m2_5709: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5708,ST_5706,TTL_5707) in
                                                        {6977}event beginSrv(Sess_5025,Cli_5023,gNs_5708);
                                                        {6978}out(c, (enc(m2_5709,pkCli_5698),sign(h(m2_5709),skSess_5545)));
                                                        {6979}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {6980}event endSrv(Cli_5023,Sess_5025,PartC_5704)
                                                )
                                                else
                                                    {6981}let v_5710: bool = (Disco_5024 = B) in
                                                    (
                                                        {6982}if v_5710 then
                                                        (
                                                            {6983}let pkDisco_5711: bitstring = pub(skB) in
                                                            {6984}in(c, (=pkCli_5698,em1_5712: bitstring,sigM1_5713: bitstring));
                                                            {6985}let m1_5714: bitstring = dec(em1_5712,skSess_5545) in
                                                            {6986}if (verify(h(m1_5714),sigM1_5713,pkCli_5698) <> true) then
                                                                0
                                                            else
                                                                {6987}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5715: bitstring) = m1_5714 in
                                                                {6988}new Ns_5716: bitstring;
                                                                {6989}new ST_5717: bitstring;
                                                                {6990}new TTL_5718: bitstring;
                                                                {6991}let gNs_5719: bitstring = exp(g,Ns_5716) in
                                                                {6992}let m2_5720: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5719,ST_5717,TTL_5718) in
                                                                {6993}event beginSrv(Sess_5025,Cli_5023,gNs_5719);
                                                                {6994}out(c, (enc(m2_5720,pkCli_5698),sign(h(m2_5720),skSess_5545)));
                                                                {6995}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {6996}event endSrv(Cli_5023,Sess_5025,PartC_5715)
                                                        )
                                                        else
                                                            {6997}let v_5721: bool = (Disco_5024 = C) in
                                                            (
                                                                {6998}if v_5721 then
                                                                (
                                                                    {6999}let pkDisco_5722: bitstring = pub(skC) in
                                                                    {7000}in(c, (=pkCli_5698,em1_5723: bitstring,sigM1_5724: bitstring));
                                                                    {7001}let m1_5725: bitstring = dec(em1_5723,skSess_5545) in
                                                                    {7002}if (verify(h(m1_5725),sigM1_5724,pkCli_5698) <> true) then
                                                                        0
                                                                    else
                                                                        {7003}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5726: bitstring) = m1_5725 in
                                                                        {7004}new Ns_5727: bitstring;
                                                                        {7005}new ST_5728: bitstring;
                                                                        {7006}new TTL_5729: bitstring;
                                                                        {7007}let gNs_5730: bitstring = exp(g,Ns_5727) in
                                                                        {7008}let m2_5731: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5730,ST_5728,TTL_5729) in
                                                                        {7009}event beginSrv(Sess_5025,Cli_5023,gNs_5730);
                                                                        {7010}out(c, (enc(m2_5731,pkCli_5698),sign(h(m2_5731),skSess_5545)));
                                                                        {7011}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7012}event endSrv(Cli_5023,Sess_5025,PartC_5726)
                                                                )
                                                                else
                                                                    {7013}let pkDisco_5732: bitstring = pub(sk(Disco_5024)) in
                                                                    {7014}in(c, (=pkCli_5698,em1_5733: bitstring,sigM1_5734: bitstring));
                                                                    {7015}let m1_5735: bitstring = dec(em1_5733,skSess_5545) in
                                                                    {7016}if (verify(h(m1_5735),sigM1_5734,pkCli_5698) <> true) then
                                                                        0
                                                                    else
                                                                        {7017}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5736: bitstring) = m1_5735 in
                                                                        {7018}new Ns_5737: bitstring;
                                                                        {7019}new ST_5738: bitstring;
                                                                        {7020}new TTL_5739: bitstring;
                                                                        {7021}let gNs_5740: bitstring = exp(g,Ns_5737) in
                                                                        {7022}let m2_5741: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5740,ST_5738,TTL_5739) in
                                                                        {7023}event beginSrv(Sess_5025,Cli_5023,gNs_5740);
                                                                        {7024}out(c, (enc(m2_5741,pkCli_5698),sign(h(m2_5741),skSess_5545)));
                                                                        {7025}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7026}event endSrv(Cli_5023,Sess_5025,PartC_5736)
                                                            )
                                                            else
                                                                {7027}let pkDisco_5742: bitstring = fail-any in
                                                                {7028}in(c, (=pkCli_5698,em1_5743: bitstring,sigM1_5744: bitstring));
                                                                {7029}let m1_5745: bitstring = dec(em1_5743,skSess_5545) in
                                                                {7030}if (verify(h(m1_5745),sigM1_5744,pkCli_5698) <> true) then
                                                                    0
                                                                else
                                                                    {7031}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5746: bitstring) = m1_5745 in
                                                                    {7032}new Ns_5747: bitstring;
                                                                    {7033}new ST_5748: bitstring;
                                                                    {7034}new TTL_5749: bitstring;
                                                                    {7035}let gNs_5750: bitstring = exp(g,Ns_5747) in
                                                                    {7036}let m2_5751: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5750,ST_5748,TTL_5749) in
                                                                    {7037}event beginSrv(Sess_5025,Cli_5023,gNs_5750);
                                                                    {7038}out(c, (enc(m2_5751,pkCli_5698),sign(h(m2_5751),skSess_5545)));
                                                                    {7039}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7040}event endSrv(Cli_5023,Sess_5025,PartC_5746)
                                                    )
                                                    else
                                                        {7041}let pkDisco_5752: bitstring = fail-any in
                                                        {7042}in(c, (=pkCli_5698,em1_5753: bitstring,sigM1_5754: bitstring));
                                                        {7043}let m1_5755: bitstring = dec(em1_5753,skSess_5545) in
                                                        {7044}if (verify(h(m1_5755),sigM1_5754,pkCli_5698) <> true) then
                                                            0
                                                        else
                                                            {7045}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5756: bitstring) = m1_5755 in
                                                            {7046}new Ns_5757: bitstring;
                                                            {7047}new ST_5758: bitstring;
                                                            {7048}new TTL_5759: bitstring;
                                                            {7049}let gNs_5760: bitstring = exp(g,Ns_5757) in
                                                            {7050}let m2_5761: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5760,ST_5758,TTL_5759) in
                                                            {7051}event beginSrv(Sess_5025,Cli_5023,gNs_5760);
                                                            {7052}out(c, (enc(m2_5761,pkCli_5698),sign(h(m2_5761),skSess_5545)));
                                                            {7053}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7054}event endSrv(Cli_5023,Sess_5025,PartC_5756)
                                            )
                                            else
                                                {7055}let pkDisco_5762: bitstring = fail-any in
                                                {7056}in(c, (=pkCli_5698,em1_5763: bitstring,sigM1_5764: bitstring));
                                                {7057}let m1_5765: bitstring = dec(em1_5763,skSess_5545) in
                                                {7058}if (verify(h(m1_5765),sigM1_5764,pkCli_5698) <> true) then
                                                    0
                                                else
                                                    {7059}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5698,PartC_5766: bitstring) = m1_5765 in
                                                    {7060}new Ns_5767: bitstring;
                                                    {7061}new ST_5768: bitstring;
                                                    {7062}new TTL_5769: bitstring;
                                                    {7063}let gNs_5770: bitstring = exp(g,Ns_5767) in
                                                    {7064}let m2_5771: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5770,ST_5768,TTL_5769) in
                                                    {7065}event beginSrv(Sess_5025,Cli_5023,gNs_5770);
                                                    {7066}out(c, (enc(m2_5771,pkCli_5698),sign(h(m2_5771),skSess_5545)));
                                                    {7067}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7068}event endSrv(Cli_5023,Sess_5025,PartC_5766)
                                        )
                                        else
                                            {7069}let pkCli_5772: bitstring = pub(sk(Cli_5023)) in
                                            {7070}let v_5773: bool = (Disco_5024 = A) in
                                            (
                                                {7071}if v_5773 then
                                                (
                                                    {7072}let pkDisco_5774: bitstring = pub(skA) in
                                                    {7073}in(c, (=pkCli_5772,em1_5775: bitstring,sigM1_5776: bitstring));
                                                    {7074}let m1_5777: bitstring = dec(em1_5775,skSess_5545) in
                                                    {7075}if (verify(h(m1_5777),sigM1_5776,pkCli_5772) <> true) then
                                                        0
                                                    else
                                                        {7076}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5778: bitstring) = m1_5777 in
                                                        {7077}new Ns_5779: bitstring;
                                                        {7078}new ST_5780: bitstring;
                                                        {7079}new TTL_5781: bitstring;
                                                        {7080}let gNs_5782: bitstring = exp(g,Ns_5779) in
                                                        {7081}let m2_5783: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5782,ST_5780,TTL_5781) in
                                                        {7082}event beginSrv(Sess_5025,Cli_5023,gNs_5782);
                                                        {7083}out(c, (enc(m2_5783,pkCli_5772),sign(h(m2_5783),skSess_5545)));
                                                        {7084}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7085}event endSrv(Cli_5023,Sess_5025,PartC_5778)
                                                )
                                                else
                                                    {7086}let v_5784: bool = (Disco_5024 = B) in
                                                    (
                                                        {7087}if v_5784 then
                                                        (
                                                            {7088}let pkDisco_5785: bitstring = pub(skB) in
                                                            {7089}in(c, (=pkCli_5772,em1_5786: bitstring,sigM1_5787: bitstring));
                                                            {7090}let m1_5788: bitstring = dec(em1_5786,skSess_5545) in
                                                            {7091}if (verify(h(m1_5788),sigM1_5787,pkCli_5772) <> true) then
                                                                0
                                                            else
                                                                {7092}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5789: bitstring) = m1_5788 in
                                                                {7093}new Ns_5790: bitstring;
                                                                {7094}new ST_5791: bitstring;
                                                                {7095}new TTL_5792: bitstring;
                                                                {7096}let gNs_5793: bitstring = exp(g,Ns_5790) in
                                                                {7097}let m2_5794: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5793,ST_5791,TTL_5792) in
                                                                {7098}event beginSrv(Sess_5025,Cli_5023,gNs_5793);
                                                                {7099}out(c, (enc(m2_5794,pkCli_5772),sign(h(m2_5794),skSess_5545)));
                                                                {7100}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7101}event endSrv(Cli_5023,Sess_5025,PartC_5789)
                                                        )
                                                        else
                                                            {7102}let v_5795: bool = (Disco_5024 = C) in
                                                            (
                                                                {7103}if v_5795 then
                                                                (
                                                                    {7104}let pkDisco_5796: bitstring = pub(skC) in
                                                                    {7105}in(c, (=pkCli_5772,em1_5797: bitstring,sigM1_5798: bitstring));
                                                                    {7106}let m1_5799: bitstring = dec(em1_5797,skSess_5545) in
                                                                    {7107}if (verify(h(m1_5799),sigM1_5798,pkCli_5772) <> true) then
                                                                        0
                                                                    else
                                                                        {7108}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5800: bitstring) = m1_5799 in
                                                                        {7109}new Ns_5801: bitstring;
                                                                        {7110}new ST_5802: bitstring;
                                                                        {7111}new TTL_5803: bitstring;
                                                                        {7112}let gNs_5804: bitstring = exp(g,Ns_5801) in
                                                                        {7113}let m2_5805: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5804,ST_5802,TTL_5803) in
                                                                        {7114}event beginSrv(Sess_5025,Cli_5023,gNs_5804);
                                                                        {7115}out(c, (enc(m2_5805,pkCli_5772),sign(h(m2_5805),skSess_5545)));
                                                                        {7116}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7117}event endSrv(Cli_5023,Sess_5025,PartC_5800)
                                                                )
                                                                else
                                                                    {7118}let pkDisco_5806: bitstring = pub(sk(Disco_5024)) in
                                                                    {7119}in(c, (=pkCli_5772,em1_5807: bitstring,sigM1_5808: bitstring));
                                                                    {7120}let m1_5809: bitstring = dec(em1_5807,skSess_5545) in
                                                                    {7121}if (verify(h(m1_5809),sigM1_5808,pkCli_5772) <> true) then
                                                                        0
                                                                    else
                                                                        {7122}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5810: bitstring) = m1_5809 in
                                                                        {7123}new Ns_5811: bitstring;
                                                                        {7124}new ST_5812: bitstring;
                                                                        {7125}new TTL_5813: bitstring;
                                                                        {7126}let gNs_5814: bitstring = exp(g,Ns_5811) in
                                                                        {7127}let m2_5815: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5814,ST_5812,TTL_5813) in
                                                                        {7128}event beginSrv(Sess_5025,Cli_5023,gNs_5814);
                                                                        {7129}out(c, (enc(m2_5815,pkCli_5772),sign(h(m2_5815),skSess_5545)));
                                                                        {7130}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7131}event endSrv(Cli_5023,Sess_5025,PartC_5810)
                                                            )
                                                            else
                                                                {7132}let pkDisco_5816: bitstring = fail-any in
                                                                {7133}in(c, (=pkCli_5772,em1_5817: bitstring,sigM1_5818: bitstring));
                                                                {7134}let m1_5819: bitstring = dec(em1_5817,skSess_5545) in
                                                                {7135}if (verify(h(m1_5819),sigM1_5818,pkCli_5772) <> true) then
                                                                    0
                                                                else
                                                                    {7136}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5820: bitstring) = m1_5819 in
                                                                    {7137}new Ns_5821: bitstring;
                                                                    {7138}new ST_5822: bitstring;
                                                                    {7139}new TTL_5823: bitstring;
                                                                    {7140}let gNs_5824: bitstring = exp(g,Ns_5821) in
                                                                    {7141}let m2_5825: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5824,ST_5822,TTL_5823) in
                                                                    {7142}event beginSrv(Sess_5025,Cli_5023,gNs_5824);
                                                                    {7143}out(c, (enc(m2_5825,pkCli_5772),sign(h(m2_5825),skSess_5545)));
                                                                    {7144}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7145}event endSrv(Cli_5023,Sess_5025,PartC_5820)
                                                    )
                                                    else
                                                        {7146}let pkDisco_5826: bitstring = fail-any in
                                                        {7147}in(c, (=pkCli_5772,em1_5827: bitstring,sigM1_5828: bitstring));
                                                        {7148}let m1_5829: bitstring = dec(em1_5827,skSess_5545) in
                                                        {7149}if (verify(h(m1_5829),sigM1_5828,pkCli_5772) <> true) then
                                                            0
                                                        else
                                                            {7150}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5830: bitstring) = m1_5829 in
                                                            {7151}new Ns_5831: bitstring;
                                                            {7152}new ST_5832: bitstring;
                                                            {7153}new TTL_5833: bitstring;
                                                            {7154}let gNs_5834: bitstring = exp(g,Ns_5831) in
                                                            {7155}let m2_5835: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5834,ST_5832,TTL_5833) in
                                                            {7156}event beginSrv(Sess_5025,Cli_5023,gNs_5834);
                                                            {7157}out(c, (enc(m2_5835,pkCli_5772),sign(h(m2_5835),skSess_5545)));
                                                            {7158}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7159}event endSrv(Cli_5023,Sess_5025,PartC_5830)
                                            )
                                            else
                                                {7160}let pkDisco_5836: bitstring = fail-any in
                                                {7161}in(c, (=pkCli_5772,em1_5837: bitstring,sigM1_5838: bitstring));
                                                {7162}let m1_5839: bitstring = dec(em1_5837,skSess_5545) in
                                                {7163}if (verify(h(m1_5839),sigM1_5838,pkCli_5772) <> true) then
                                                    0
                                                else
                                                    {7164}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5772,PartC_5840: bitstring) = m1_5839 in
                                                    {7165}new Ns_5841: bitstring;
                                                    {7166}new ST_5842: bitstring;
                                                    {7167}new TTL_5843: bitstring;
                                                    {7168}let gNs_5844: bitstring = exp(g,Ns_5841) in
                                                    {7169}let m2_5845: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5844,ST_5842,TTL_5843) in
                                                    {7170}event beginSrv(Sess_5025,Cli_5023,gNs_5844);
                                                    {7171}out(c, (enc(m2_5845,pkCli_5772),sign(h(m2_5845),skSess_5545)));
                                                    {7172}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7173}event endSrv(Cli_5023,Sess_5025,PartC_5840)
                                    )
                                    else
                                        {7174}let pkCli_5846: bitstring = fail-any in
                                        {7175}let v_5847: bool = (Disco_5024 = A) in
                                        (
                                            {7176}if v_5847 then
                                            (
                                                {7177}let pkDisco_5848: bitstring = pub(skA) in
                                                {7178}in(c, (=pkCli_5846,em1_5849: bitstring,sigM1_5850: bitstring));
                                                {7179}let m1_5851: bitstring = dec(em1_5849,skSess_5545) in
                                                {7180}if (verify(h(m1_5851),sigM1_5850,pkCli_5846) <> true) then
                                                    0
                                                else
                                                    {7181}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5852: bitstring) = m1_5851 in
                                                    {7182}new Ns_5853: bitstring;
                                                    {7183}new ST_5854: bitstring;
                                                    {7184}new TTL_5855: bitstring;
                                                    {7185}let gNs_5856: bitstring = exp(g,Ns_5853) in
                                                    {7186}let m2_5857: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5856,ST_5854,TTL_5855) in
                                                    {7187}event beginSrv(Sess_5025,Cli_5023,gNs_5856);
                                                    {7188}out(c, (enc(m2_5857,pkCli_5846),sign(h(m2_5857),skSess_5545)));
                                                    {7189}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7190}event endSrv(Cli_5023,Sess_5025,PartC_5852)
                                            )
                                            else
                                                {7191}let v_5858: bool = (Disco_5024 = B) in
                                                (
                                                    {7192}if v_5858 then
                                                    (
                                                        {7193}let pkDisco_5859: bitstring = pub(skB) in
                                                        {7194}in(c, (=pkCli_5846,em1_5860: bitstring,sigM1_5861: bitstring));
                                                        {7195}let m1_5862: bitstring = dec(em1_5860,skSess_5545) in
                                                        {7196}if (verify(h(m1_5862),sigM1_5861,pkCli_5846) <> true) then
                                                            0
                                                        else
                                                            {7197}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5863: bitstring) = m1_5862 in
                                                            {7198}new Ns_5864: bitstring;
                                                            {7199}new ST_5865: bitstring;
                                                            {7200}new TTL_5866: bitstring;
                                                            {7201}let gNs_5867: bitstring = exp(g,Ns_5864) in
                                                            {7202}let m2_5868: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5867,ST_5865,TTL_5866) in
                                                            {7203}event beginSrv(Sess_5025,Cli_5023,gNs_5867);
                                                            {7204}out(c, (enc(m2_5868,pkCli_5846),sign(h(m2_5868),skSess_5545)));
                                                            {7205}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7206}event endSrv(Cli_5023,Sess_5025,PartC_5863)
                                                    )
                                                    else
                                                        {7207}let v_5869: bool = (Disco_5024 = C) in
                                                        (
                                                            {7208}if v_5869 then
                                                            (
                                                                {7209}let pkDisco_5870: bitstring = pub(skC) in
                                                                {7210}in(c, (=pkCli_5846,em1_5871: bitstring,sigM1_5872: bitstring));
                                                                {7211}let m1_5873: bitstring = dec(em1_5871,skSess_5545) in
                                                                {7212}if (verify(h(m1_5873),sigM1_5872,pkCli_5846) <> true) then
                                                                    0
                                                                else
                                                                    {7213}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5874: bitstring) = m1_5873 in
                                                                    {7214}new Ns_5875: bitstring;
                                                                    {7215}new ST_5876: bitstring;
                                                                    {7216}new TTL_5877: bitstring;
                                                                    {7217}let gNs_5878: bitstring = exp(g,Ns_5875) in
                                                                    {7218}let m2_5879: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5878,ST_5876,TTL_5877) in
                                                                    {7219}event beginSrv(Sess_5025,Cli_5023,gNs_5878);
                                                                    {7220}out(c, (enc(m2_5879,pkCli_5846),sign(h(m2_5879),skSess_5545)));
                                                                    {7221}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7222}event endSrv(Cli_5023,Sess_5025,PartC_5874)
                                                            )
                                                            else
                                                                {7223}let pkDisco_5880: bitstring = pub(sk(Disco_5024)) in
                                                                {7224}in(c, (=pkCli_5846,em1_5881: bitstring,sigM1_5882: bitstring));
                                                                {7225}let m1_5883: bitstring = dec(em1_5881,skSess_5545) in
                                                                {7226}if (verify(h(m1_5883),sigM1_5882,pkCli_5846) <> true) then
                                                                    0
                                                                else
                                                                    {7227}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5884: bitstring) = m1_5883 in
                                                                    {7228}new Ns_5885: bitstring;
                                                                    {7229}new ST_5886: bitstring;
                                                                    {7230}new TTL_5887: bitstring;
                                                                    {7231}let gNs_5888: bitstring = exp(g,Ns_5885) in
                                                                    {7232}let m2_5889: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5888,ST_5886,TTL_5887) in
                                                                    {7233}event beginSrv(Sess_5025,Cli_5023,gNs_5888);
                                                                    {7234}out(c, (enc(m2_5889,pkCli_5846),sign(h(m2_5889),skSess_5545)));
                                                                    {7235}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7236}event endSrv(Cli_5023,Sess_5025,PartC_5884)
                                                        )
                                                        else
                                                            {7237}let pkDisco_5890: bitstring = fail-any in
                                                            {7238}in(c, (=pkCli_5846,em1_5891: bitstring,sigM1_5892: bitstring));
                                                            {7239}let m1_5893: bitstring = dec(em1_5891,skSess_5545) in
                                                            {7240}if (verify(h(m1_5893),sigM1_5892,pkCli_5846) <> true) then
                                                                0
                                                            else
                                                                {7241}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5894: bitstring) = m1_5893 in
                                                                {7242}new Ns_5895: bitstring;
                                                                {7243}new ST_5896: bitstring;
                                                                {7244}new TTL_5897: bitstring;
                                                                {7245}let gNs_5898: bitstring = exp(g,Ns_5895) in
                                                                {7246}let m2_5899: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5898,ST_5896,TTL_5897) in
                                                                {7247}event beginSrv(Sess_5025,Cli_5023,gNs_5898);
                                                                {7248}out(c, (enc(m2_5899,pkCli_5846),sign(h(m2_5899),skSess_5545)));
                                                                {7249}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7250}event endSrv(Cli_5023,Sess_5025,PartC_5894)
                                                )
                                                else
                                                    {7251}let pkDisco_5900: bitstring = fail-any in
                                                    {7252}in(c, (=pkCli_5846,em1_5901: bitstring,sigM1_5902: bitstring));
                                                    {7253}let m1_5903: bitstring = dec(em1_5901,skSess_5545) in
                                                    {7254}if (verify(h(m1_5903),sigM1_5902,pkCli_5846) <> true) then
                                                        0
                                                    else
                                                        {7255}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5904: bitstring) = m1_5903 in
                                                        {7256}new Ns_5905: bitstring;
                                                        {7257}new ST_5906: bitstring;
                                                        {7258}new TTL_5907: bitstring;
                                                        {7259}let gNs_5908: bitstring = exp(g,Ns_5905) in
                                                        {7260}let m2_5909: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5908,ST_5906,TTL_5907) in
                                                        {7261}event beginSrv(Sess_5025,Cli_5023,gNs_5908);
                                                        {7262}out(c, (enc(m2_5909,pkCli_5846),sign(h(m2_5909),skSess_5545)));
                                                        {7263}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7264}event endSrv(Cli_5023,Sess_5025,PartC_5904)
                                        )
                                        else
                                            {7265}let pkDisco_5910: bitstring = fail-any in
                                            {7266}in(c, (=pkCli_5846,em1_5911: bitstring,sigM1_5912: bitstring));
                                            {7267}let m1_5913: bitstring = dec(em1_5911,skSess_5545) in
                                            {7268}if (verify(h(m1_5913),sigM1_5912,pkCli_5846) <> true) then
                                                0
                                            else
                                                {7269}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5846,PartC_5914: bitstring) = m1_5913 in
                                                {7270}new Ns_5915: bitstring;
                                                {7271}new ST_5916: bitstring;
                                                {7272}new TTL_5917: bitstring;
                                                {7273}let gNs_5918: bitstring = exp(g,Ns_5915) in
                                                {7274}let m2_5919: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5918,ST_5916,TTL_5917) in
                                                {7275}event beginSrv(Sess_5025,Cli_5023,gNs_5918);
                                                {7276}out(c, (enc(m2_5919,pkCli_5846),sign(h(m2_5919),skSess_5545)));
                                                {7277}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7278}event endSrv(Cli_5023,Sess_5025,PartC_5914)
                            )
                            else
                                {7279}let pkCli_5920: bitstring = fail-any in
                                {7280}let v_5921: bool = (Disco_5024 = A) in
                                (
                                    {7281}if v_5921 then
                                    (
                                        {7282}let pkDisco_5922: bitstring = pub(skA) in
                                        {7283}in(c, (=pkCli_5920,em1_5923: bitstring,sigM1_5924: bitstring));
                                        {7284}let m1_5925: bitstring = dec(em1_5923,skSess_5545) in
                                        {7285}if (verify(h(m1_5925),sigM1_5924,pkCli_5920) <> true) then
                                            0
                                        else
                                            {7286}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5926: bitstring) = m1_5925 in
                                            {7287}new Ns_5927: bitstring;
                                            {7288}new ST_5928: bitstring;
                                            {7289}new TTL_5929: bitstring;
                                            {7290}let gNs_5930: bitstring = exp(g,Ns_5927) in
                                            {7291}let m2_5931: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5930,ST_5928,TTL_5929) in
                                            {7292}event beginSrv(Sess_5025,Cli_5023,gNs_5930);
                                            {7293}out(c, (enc(m2_5931,pkCli_5920),sign(h(m2_5931),skSess_5545)));
                                            {7294}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7295}event endSrv(Cli_5023,Sess_5025,PartC_5926)
                                    )
                                    else
                                        {7296}let v_5932: bool = (Disco_5024 = B) in
                                        (
                                            {7297}if v_5932 then
                                            (
                                                {7298}let pkDisco_5933: bitstring = pub(skB) in
                                                {7299}in(c, (=pkCli_5920,em1_5934: bitstring,sigM1_5935: bitstring));
                                                {7300}let m1_5936: bitstring = dec(em1_5934,skSess_5545) in
                                                {7301}if (verify(h(m1_5936),sigM1_5935,pkCli_5920) <> true) then
                                                    0
                                                else
                                                    {7302}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5937: bitstring) = m1_5936 in
                                                    {7303}new Ns_5938: bitstring;
                                                    {7304}new ST_5939: bitstring;
                                                    {7305}new TTL_5940: bitstring;
                                                    {7306}let gNs_5941: bitstring = exp(g,Ns_5938) in
                                                    {7307}let m2_5942: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5941,ST_5939,TTL_5940) in
                                                    {7308}event beginSrv(Sess_5025,Cli_5023,gNs_5941);
                                                    {7309}out(c, (enc(m2_5942,pkCli_5920),sign(h(m2_5942),skSess_5545)));
                                                    {7310}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7311}event endSrv(Cli_5023,Sess_5025,PartC_5937)
                                            )
                                            else
                                                {7312}let v_5943: bool = (Disco_5024 = C) in
                                                (
                                                    {7313}if v_5943 then
                                                    (
                                                        {7314}let pkDisco_5944: bitstring = pub(skC) in
                                                        {7315}in(c, (=pkCli_5920,em1_5945: bitstring,sigM1_5946: bitstring));
                                                        {7316}let m1_5947: bitstring = dec(em1_5945,skSess_5545) in
                                                        {7317}if (verify(h(m1_5947),sigM1_5946,pkCli_5920) <> true) then
                                                            0
                                                        else
                                                            {7318}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5948: bitstring) = m1_5947 in
                                                            {7319}new Ns_5949: bitstring;
                                                            {7320}new ST_5950: bitstring;
                                                            {7321}new TTL_5951: bitstring;
                                                            {7322}let gNs_5952: bitstring = exp(g,Ns_5949) in
                                                            {7323}let m2_5953: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5952,ST_5950,TTL_5951) in
                                                            {7324}event beginSrv(Sess_5025,Cli_5023,gNs_5952);
                                                            {7325}out(c, (enc(m2_5953,pkCli_5920),sign(h(m2_5953),skSess_5545)));
                                                            {7326}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7327}event endSrv(Cli_5023,Sess_5025,PartC_5948)
                                                    )
                                                    else
                                                        {7328}let pkDisco_5954: bitstring = pub(sk(Disco_5024)) in
                                                        {7329}in(c, (=pkCli_5920,em1_5955: bitstring,sigM1_5956: bitstring));
                                                        {7330}let m1_5957: bitstring = dec(em1_5955,skSess_5545) in
                                                        {7331}if (verify(h(m1_5957),sigM1_5956,pkCli_5920) <> true) then
                                                            0
                                                        else
                                                            {7332}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5958: bitstring) = m1_5957 in
                                                            {7333}new Ns_5959: bitstring;
                                                            {7334}new ST_5960: bitstring;
                                                            {7335}new TTL_5961: bitstring;
                                                            {7336}let gNs_5962: bitstring = exp(g,Ns_5959) in
                                                            {7337}let m2_5963: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5962,ST_5960,TTL_5961) in
                                                            {7338}event beginSrv(Sess_5025,Cli_5023,gNs_5962);
                                                            {7339}out(c, (enc(m2_5963,pkCli_5920),sign(h(m2_5963),skSess_5545)));
                                                            {7340}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7341}event endSrv(Cli_5023,Sess_5025,PartC_5958)
                                                )
                                                else
                                                    {7342}let pkDisco_5964: bitstring = fail-any in
                                                    {7343}in(c, (=pkCli_5920,em1_5965: bitstring,sigM1_5966: bitstring));
                                                    {7344}let m1_5967: bitstring = dec(em1_5965,skSess_5545) in
                                                    {7345}if (verify(h(m1_5967),sigM1_5966,pkCli_5920) <> true) then
                                                        0
                                                    else
                                                        {7346}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5968: bitstring) = m1_5967 in
                                                        {7347}new Ns_5969: bitstring;
                                                        {7348}new ST_5970: bitstring;
                                                        {7349}new TTL_5971: bitstring;
                                                        {7350}let gNs_5972: bitstring = exp(g,Ns_5969) in
                                                        {7351}let m2_5973: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5972,ST_5970,TTL_5971) in
                                                        {7352}event beginSrv(Sess_5025,Cli_5023,gNs_5972);
                                                        {7353}out(c, (enc(m2_5973,pkCli_5920),sign(h(m2_5973),skSess_5545)));
                                                        {7354}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7355}event endSrv(Cli_5023,Sess_5025,PartC_5968)
                                        )
                                        else
                                            {7356}let pkDisco_5974: bitstring = fail-any in
                                            {7357}in(c, (=pkCli_5920,em1_5975: bitstring,sigM1_5976: bitstring));
                                            {7358}let m1_5977: bitstring = dec(em1_5975,skSess_5545) in
                                            {7359}if (verify(h(m1_5977),sigM1_5976,pkCli_5920) <> true) then
                                                0
                                            else
                                                {7360}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5978: bitstring) = m1_5977 in
                                                {7361}new Ns_5979: bitstring;
                                                {7362}new ST_5980: bitstring;
                                                {7363}new TTL_5981: bitstring;
                                                {7364}let gNs_5982: bitstring = exp(g,Ns_5979) in
                                                {7365}let m2_5983: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5982,ST_5980,TTL_5981) in
                                                {7366}event beginSrv(Sess_5025,Cli_5023,gNs_5982);
                                                {7367}out(c, (enc(m2_5983,pkCli_5920),sign(h(m2_5983),skSess_5545)));
                                                {7368}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7369}event endSrv(Cli_5023,Sess_5025,PartC_5978)
                                )
                                else
                                    {7370}let pkDisco_5984: bitstring = fail-any in
                                    {7371}in(c, (=pkCli_5920,em1_5985: bitstring,sigM1_5986: bitstring));
                                    {7372}let m1_5987: bitstring = dec(em1_5985,skSess_5545) in
                                    {7373}if (verify(h(m1_5987),sigM1_5986,pkCli_5920) <> true) then
                                        0
                                    else
                                        {7374}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5920,PartC_5988: bitstring) = m1_5987 in
                                        {7375}new Ns_5989: bitstring;
                                        {7376}new ST_5990: bitstring;
                                        {7377}new TTL_5991: bitstring;
                                        {7378}let gNs_5992: bitstring = exp(g,Ns_5989) in
                                        {7379}let m2_5993: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_5992,ST_5990,TTL_5991) in
                                        {7380}event beginSrv(Sess_5025,Cli_5023,gNs_5992);
                                        {7381}out(c, (enc(m2_5993,pkCli_5920),sign(h(m2_5993),skSess_5545)));
                                        {7382}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {7383}event endSrv(Cli_5023,Sess_5025,PartC_5988)
                    )
                    else
                        {7384}let pkCli_5994: bitstring = fail-any in
                        {7385}let v_5995: bool = (Disco_5024 = A) in
                        (
                            {7386}if v_5995 then
                            (
                                {7387}let pkDisco_5996: bitstring = pub(skA) in
                                {7388}in(c, (=pkCli_5994,em1_5997: bitstring,sigM1_5998: bitstring));
                                {7389}let m1_5999: bitstring = dec(em1_5997,skSess_5545) in
                                {7390}if (verify(h(m1_5999),sigM1_5998,pkCli_5994) <> true) then
                                    0
                                else
                                    {7391}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6000: bitstring) = m1_5999 in
                                    {7392}new Ns_6001: bitstring;
                                    {7393}new ST_6002: bitstring;
                                    {7394}new TTL_6003: bitstring;
                                    {7395}let gNs_6004: bitstring = exp(g,Ns_6001) in
                                    {7396}let m2_6005: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6004,ST_6002,TTL_6003) in
                                    {7397}event beginSrv(Sess_5025,Cli_5023,gNs_6004);
                                    {7398}out(c, (enc(m2_6005,pkCli_5994),sign(h(m2_6005),skSess_5545)));
                                    {7399}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {7400}event endSrv(Cli_5023,Sess_5025,PartC_6000)
                            )
                            else
                                {7401}let v_6006: bool = (Disco_5024 = B) in
                                (
                                    {7402}if v_6006 then
                                    (
                                        {7403}let pkDisco_6007: bitstring = pub(skB) in
                                        {7404}in(c, (=pkCli_5994,em1_6008: bitstring,sigM1_6009: bitstring));
                                        {7405}let m1_6010: bitstring = dec(em1_6008,skSess_5545) in
                                        {7406}if (verify(h(m1_6010),sigM1_6009,pkCli_5994) <> true) then
                                            0
                                        else
                                            {7407}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6011: bitstring) = m1_6010 in
                                            {7408}new Ns_6012: bitstring;
                                            {7409}new ST_6013: bitstring;
                                            {7410}new TTL_6014: bitstring;
                                            {7411}let gNs_6015: bitstring = exp(g,Ns_6012) in
                                            {7412}let m2_6016: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6015,ST_6013,TTL_6014) in
                                            {7413}event beginSrv(Sess_5025,Cli_5023,gNs_6015);
                                            {7414}out(c, (enc(m2_6016,pkCli_5994),sign(h(m2_6016),skSess_5545)));
                                            {7415}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7416}event endSrv(Cli_5023,Sess_5025,PartC_6011)
                                    )
                                    else
                                        {7417}let v_6017: bool = (Disco_5024 = C) in
                                        (
                                            {7418}if v_6017 then
                                            (
                                                {7419}let pkDisco_6018: bitstring = pub(skC) in
                                                {7420}in(c, (=pkCli_5994,em1_6019: bitstring,sigM1_6020: bitstring));
                                                {7421}let m1_6021: bitstring = dec(em1_6019,skSess_5545) in
                                                {7422}if (verify(h(m1_6021),sigM1_6020,pkCli_5994) <> true) then
                                                    0
                                                else
                                                    {7423}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6022: bitstring) = m1_6021 in
                                                    {7424}new Ns_6023: bitstring;
                                                    {7425}new ST_6024: bitstring;
                                                    {7426}new TTL_6025: bitstring;
                                                    {7427}let gNs_6026: bitstring = exp(g,Ns_6023) in
                                                    {7428}let m2_6027: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6026,ST_6024,TTL_6025) in
                                                    {7429}event beginSrv(Sess_5025,Cli_5023,gNs_6026);
                                                    {7430}out(c, (enc(m2_6027,pkCli_5994),sign(h(m2_6027),skSess_5545)));
                                                    {7431}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7432}event endSrv(Cli_5023,Sess_5025,PartC_6022)
                                            )
                                            else
                                                {7433}let pkDisco_6028: bitstring = pub(sk(Disco_5024)) in
                                                {7434}in(c, (=pkCli_5994,em1_6029: bitstring,sigM1_6030: bitstring));
                                                {7435}let m1_6031: bitstring = dec(em1_6029,skSess_5545) in
                                                {7436}if (verify(h(m1_6031),sigM1_6030,pkCli_5994) <> true) then
                                                    0
                                                else
                                                    {7437}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6032: bitstring) = m1_6031 in
                                                    {7438}new Ns_6033: bitstring;
                                                    {7439}new ST_6034: bitstring;
                                                    {7440}new TTL_6035: bitstring;
                                                    {7441}let gNs_6036: bitstring = exp(g,Ns_6033) in
                                                    {7442}let m2_6037: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6036,ST_6034,TTL_6035) in
                                                    {7443}event beginSrv(Sess_5025,Cli_5023,gNs_6036);
                                                    {7444}out(c, (enc(m2_6037,pkCli_5994),sign(h(m2_6037),skSess_5545)));
                                                    {7445}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7446}event endSrv(Cli_5023,Sess_5025,PartC_6032)
                                        )
                                        else
                                            {7447}let pkDisco_6038: bitstring = fail-any in
                                            {7448}in(c, (=pkCli_5994,em1_6039: bitstring,sigM1_6040: bitstring));
                                            {7449}let m1_6041: bitstring = dec(em1_6039,skSess_5545) in
                                            {7450}if (verify(h(m1_6041),sigM1_6040,pkCli_5994) <> true) then
                                                0
                                            else
                                                {7451}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6042: bitstring) = m1_6041 in
                                                {7452}new Ns_6043: bitstring;
                                                {7453}new ST_6044: bitstring;
                                                {7454}new TTL_6045: bitstring;
                                                {7455}let gNs_6046: bitstring = exp(g,Ns_6043) in
                                                {7456}let m2_6047: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6046,ST_6044,TTL_6045) in
                                                {7457}event beginSrv(Sess_5025,Cli_5023,gNs_6046);
                                                {7458}out(c, (enc(m2_6047,pkCli_5994),sign(h(m2_6047),skSess_5545)));
                                                {7459}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7460}event endSrv(Cli_5023,Sess_5025,PartC_6042)
                                )
                                else
                                    {7461}let pkDisco_6048: bitstring = fail-any in
                                    {7462}in(c, (=pkCli_5994,em1_6049: bitstring,sigM1_6050: bitstring));
                                    {7463}let m1_6051: bitstring = dec(em1_6049,skSess_5545) in
                                    {7464}if (verify(h(m1_6051),sigM1_6050,pkCli_5994) <> true) then
                                        0
                                    else
                                        {7465}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6052: bitstring) = m1_6051 in
                                        {7466}new Ns_6053: bitstring;
                                        {7467}new ST_6054: bitstring;
                                        {7468}new TTL_6055: bitstring;
                                        {7469}let gNs_6056: bitstring = exp(g,Ns_6053) in
                                        {7470}let m2_6057: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6056,ST_6054,TTL_6055) in
                                        {7471}event beginSrv(Sess_5025,Cli_5023,gNs_6056);
                                        {7472}out(c, (enc(m2_6057,pkCli_5994),sign(h(m2_6057),skSess_5545)));
                                        {7473}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {7474}event endSrv(Cli_5023,Sess_5025,PartC_6052)
                        )
                        else
                            {7475}let pkDisco_6058: bitstring = fail-any in
                            {7476}in(c, (=pkCli_5994,em1_6059: bitstring,sigM1_6060: bitstring));
                            {7477}let m1_6061: bitstring = dec(em1_6059,skSess_5545) in
                            {7478}if (verify(h(m1_6061),sigM1_6060,pkCli_5994) <> true) then
                                0
                            else
                                {7479}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_5994,PartC_6062: bitstring) = m1_6061 in
                                {7480}new Ns_6063: bitstring;
                                {7481}new ST_6064: bitstring;
                                {7482}new TTL_6065: bitstring;
                                {7483}let gNs_6066: bitstring = exp(g,Ns_6063) in
                                {7484}let m2_6067: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6066,ST_6064,TTL_6065) in
                                {7485}event beginSrv(Sess_5025,Cli_5023,gNs_6066);
                                {7486}out(c, (enc(m2_6067,pkCli_5994),sign(h(m2_6067),skSess_5545)));
                                {7487}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {7488}event endSrv(Cli_5023,Sess_5025,PartC_6062)
                )
                else
                    {7489}let =true = (Sess_5025 = C) in
                    (
                        {7490}let skSess_6068: bitstring = skC in
                        {7491}let pkSess_6069: bitstring = pub(skSess_6068) in
                        {7492}let v_6070: bool = (Cli_5023 = A) in
                        (
                            {7493}if v_6070 then
                            (
                                {7494}let pkCli_6071: bitstring = pub(skA) in
                                {7495}let v_6072: bool = (Disco_5024 = A) in
                                (
                                    {7496}if v_6072 then
                                    (
                                        {7497}let pkDisco_6073: bitstring = pub(skA) in
                                        {7498}in(c, (=pkCli_6071,em1_6074: bitstring,sigM1_6075: bitstring));
                                        {7499}let m1_6076: bitstring = dec(em1_6074,skSess_6068) in
                                        {7500}if (verify(h(m1_6076),sigM1_6075,pkCli_6071) <> true) then
                                            0
                                        else
                                            {7501}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6077: bitstring) = m1_6076 in
                                            {7502}new Ns_6078: bitstring;
                                            {7503}new ST_6079: bitstring;
                                            {7504}new TTL_6080: bitstring;
                                            {7505}let gNs_6081: bitstring = exp(g,Ns_6078) in
                                            {7506}let m2_6082: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6081,ST_6079,TTL_6080) in
                                            {7507}event beginSrv(Sess_5025,Cli_5023,gNs_6081);
                                            {7508}out(c, (enc(m2_6082,pkCli_6071),sign(h(m2_6082),skSess_6068)));
                                            {7509}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {7510}event endSrv(Cli_5023,Sess_5025,PartC_6077)
                                    )
                                    else
                                        {7511}let v_6083: bool = (Disco_5024 = B) in
                                        (
                                            {7512}if v_6083 then
                                            (
                                                {7513}let pkDisco_6084: bitstring = pub(skB) in
                                                {7514}in(c, (=pkCli_6071,em1_6085: bitstring,sigM1_6086: bitstring));
                                                {7515}let m1_6087: bitstring = dec(em1_6085,skSess_6068) in
                                                {7516}if (verify(h(m1_6087),sigM1_6086,pkCli_6071) <> true) then
                                                    0
                                                else
                                                    {7517}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6088: bitstring) = m1_6087 in
                                                    {7518}new Ns_6089: bitstring;
                                                    {7519}new ST_6090: bitstring;
                                                    {7520}new TTL_6091: bitstring;
                                                    {7521}let gNs_6092: bitstring = exp(g,Ns_6089) in
                                                    {7522}let m2_6093: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6092,ST_6090,TTL_6091) in
                                                    {7523}event beginSrv(Sess_5025,Cli_5023,gNs_6092);
                                                    {7524}out(c, (enc(m2_6093,pkCli_6071),sign(h(m2_6093),skSess_6068)));
                                                    {7525}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7526}event endSrv(Cli_5023,Sess_5025,PartC_6088)
                                            )
                                            else
                                                {7527}let v_6094: bool = (Disco_5024 = C) in
                                                (
                                                    {7528}if v_6094 then
                                                    (
                                                        {7529}let pkDisco_6095: bitstring = pub(skC) in
                                                        {7530}in(c, (=pkCli_6071,em1_6096: bitstring,sigM1_6097: bitstring));
                                                        {7531}let m1_6098: bitstring = dec(em1_6096,skSess_6068) in
                                                        {7532}if (verify(h(m1_6098),sigM1_6097,pkCli_6071) <> true) then
                                                            0
                                                        else
                                                            {7533}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6099: bitstring) = m1_6098 in
                                                            {7534}new Ns_6100: bitstring;
                                                            {7535}new ST_6101: bitstring;
                                                            {7536}new TTL_6102: bitstring;
                                                            {7537}let gNs_6103: bitstring = exp(g,Ns_6100) in
                                                            {7538}let m2_6104: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6103,ST_6101,TTL_6102) in
                                                            {7539}event beginSrv(Sess_5025,Cli_5023,gNs_6103);
                                                            {7540}out(c, (enc(m2_6104,pkCli_6071),sign(h(m2_6104),skSess_6068)));
                                                            {7541}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7542}event endSrv(Cli_5023,Sess_5025,PartC_6099)
                                                    )
                                                    else
                                                        {7543}let pkDisco_6105: bitstring = pub(sk(Disco_5024)) in
                                                        {7544}in(c, (=pkCli_6071,em1_6106: bitstring,sigM1_6107: bitstring));
                                                        {7545}let m1_6108: bitstring = dec(em1_6106,skSess_6068) in
                                                        {7546}if (verify(h(m1_6108),sigM1_6107,pkCli_6071) <> true) then
                                                            0
                                                        else
                                                            {7547}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6109: bitstring) = m1_6108 in
                                                            {7548}new Ns_6110: bitstring;
                                                            {7549}new ST_6111: bitstring;
                                                            {7550}new TTL_6112: bitstring;
                                                            {7551}let gNs_6113: bitstring = exp(g,Ns_6110) in
                                                            {7552}let m2_6114: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6113,ST_6111,TTL_6112) in
                                                            {7553}event beginSrv(Sess_5025,Cli_5023,gNs_6113);
                                                            {7554}out(c, (enc(m2_6114,pkCli_6071),sign(h(m2_6114),skSess_6068)));
                                                            {7555}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7556}event endSrv(Cli_5023,Sess_5025,PartC_6109)
                                                )
                                                else
                                                    {7557}let pkDisco_6115: bitstring = fail-any in
                                                    {7558}in(c, (=pkCli_6071,em1_6116: bitstring,sigM1_6117: bitstring));
                                                    {7559}let m1_6118: bitstring = dec(em1_6116,skSess_6068) in
                                                    {7560}if (verify(h(m1_6118),sigM1_6117,pkCli_6071) <> true) then
                                                        0
                                                    else
                                                        {7561}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6119: bitstring) = m1_6118 in
                                                        {7562}new Ns_6120: bitstring;
                                                        {7563}new ST_6121: bitstring;
                                                        {7564}new TTL_6122: bitstring;
                                                        {7565}let gNs_6123: bitstring = exp(g,Ns_6120) in
                                                        {7566}let m2_6124: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6123,ST_6121,TTL_6122) in
                                                        {7567}event beginSrv(Sess_5025,Cli_5023,gNs_6123);
                                                        {7568}out(c, (enc(m2_6124,pkCli_6071),sign(h(m2_6124),skSess_6068)));
                                                        {7569}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7570}event endSrv(Cli_5023,Sess_5025,PartC_6119)
                                        )
                                        else
                                            {7571}let pkDisco_6125: bitstring = fail-any in
                                            {7572}in(c, (=pkCli_6071,em1_6126: bitstring,sigM1_6127: bitstring));
                                            {7573}let m1_6128: bitstring = dec(em1_6126,skSess_6068) in
                                            {7574}if (verify(h(m1_6128),sigM1_6127,pkCli_6071) <> true) then
                                                0
                                            else
                                                {7575}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6129: bitstring) = m1_6128 in
                                                {7576}new Ns_6130: bitstring;
                                                {7577}new ST_6131: bitstring;
                                                {7578}new TTL_6132: bitstring;
                                                {7579}let gNs_6133: bitstring = exp(g,Ns_6130) in
                                                {7580}let m2_6134: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6133,ST_6131,TTL_6132) in
                                                {7581}event beginSrv(Sess_5025,Cli_5023,gNs_6133);
                                                {7582}out(c, (enc(m2_6134,pkCli_6071),sign(h(m2_6134),skSess_6068)));
                                                {7583}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7584}event endSrv(Cli_5023,Sess_5025,PartC_6129)
                                )
                                else
                                    {7585}let pkDisco_6135: bitstring = fail-any in
                                    {7586}in(c, (=pkCli_6071,em1_6136: bitstring,sigM1_6137: bitstring));
                                    {7587}let m1_6138: bitstring = dec(em1_6136,skSess_6068) in
                                    {7588}if (verify(h(m1_6138),sigM1_6137,pkCli_6071) <> true) then
                                        0
                                    else
                                        {7589}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6071,PartC_6139: bitstring) = m1_6138 in
                                        {7590}new Ns_6140: bitstring;
                                        {7591}new ST_6141: bitstring;
                                        {7592}new TTL_6142: bitstring;
                                        {7593}let gNs_6143: bitstring = exp(g,Ns_6140) in
                                        {7594}let m2_6144: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6143,ST_6141,TTL_6142) in
                                        {7595}event beginSrv(Sess_5025,Cli_5023,gNs_6143);
                                        {7596}out(c, (enc(m2_6144,pkCli_6071),sign(h(m2_6144),skSess_6068)));
                                        {7597}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {7598}event endSrv(Cli_5023,Sess_5025,PartC_6139)
                            )
                            else
                                {7599}let v_6145: bool = (Cli_5023 = B) in
                                (
                                    {7600}if v_6145 then
                                    (
                                        {7601}let pkCli_6146: bitstring = pub(skB) in
                                        {7602}let v_6147: bool = (Disco_5024 = A) in
                                        (
                                            {7603}if v_6147 then
                                            (
                                                {7604}let pkDisco_6148: bitstring = pub(skA) in
                                                {7605}in(c, (=pkCli_6146,em1_6149: bitstring,sigM1_6150: bitstring));
                                                {7606}let m1_6151: bitstring = dec(em1_6149,skSess_6068) in
                                                {7607}if (verify(h(m1_6151),sigM1_6150,pkCli_6146) <> true) then
                                                    0
                                                else
                                                    {7608}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6152: bitstring) = m1_6151 in
                                                    {7609}new Ns_6153: bitstring;
                                                    {7610}new ST_6154: bitstring;
                                                    {7611}new TTL_6155: bitstring;
                                                    {7612}let gNs_6156: bitstring = exp(g,Ns_6153) in
                                                    {7613}let m2_6157: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6156,ST_6154,TTL_6155) in
                                                    {7614}event beginSrv(Sess_5025,Cli_5023,gNs_6156);
                                                    {7615}out(c, (enc(m2_6157,pkCli_6146),sign(h(m2_6157),skSess_6068)));
                                                    {7616}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {7617}event endSrv(Cli_5023,Sess_5025,PartC_6152)
                                            )
                                            else
                                                {7618}let v_6158: bool = (Disco_5024 = B) in
                                                (
                                                    {7619}if v_6158 then
                                                    (
                                                        {7620}let pkDisco_6159: bitstring = pub(skB) in
                                                        {7621}in(c, (=pkCli_6146,em1_6160: bitstring,sigM1_6161: bitstring));
                                                        {7622}let m1_6162: bitstring = dec(em1_6160,skSess_6068) in
                                                        {7623}if (verify(h(m1_6162),sigM1_6161,pkCli_6146) <> true) then
                                                            0
                                                        else
                                                            {7624}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6163: bitstring) = m1_6162 in
                                                            {7625}new Ns_6164: bitstring;
                                                            {7626}new ST_6165: bitstring;
                                                            {7627}new TTL_6166: bitstring;
                                                            {7628}let gNs_6167: bitstring = exp(g,Ns_6164) in
                                                            {7629}let m2_6168: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6167,ST_6165,TTL_6166) in
                                                            {7630}event beginSrv(Sess_5025,Cli_5023,gNs_6167);
                                                            {7631}out(c, (enc(m2_6168,pkCli_6146),sign(h(m2_6168),skSess_6068)));
                                                            {7632}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7633}event endSrv(Cli_5023,Sess_5025,PartC_6163)
                                                    )
                                                    else
                                                        {7634}let v_6169: bool = (Disco_5024 = C) in
                                                        (
                                                            {7635}if v_6169 then
                                                            (
                                                                {7636}let pkDisco_6170: bitstring = pub(skC) in
                                                                {7637}in(c, (=pkCli_6146,em1_6171: bitstring,sigM1_6172: bitstring));
                                                                {7638}let m1_6173: bitstring = dec(em1_6171,skSess_6068) in
                                                                {7639}if (verify(h(m1_6173),sigM1_6172,pkCli_6146) <> true) then
                                                                    0
                                                                else
                                                                    {7640}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6174: bitstring) = m1_6173 in
                                                                    {7641}new Ns_6175: bitstring;
                                                                    {7642}new ST_6176: bitstring;
                                                                    {7643}new TTL_6177: bitstring;
                                                                    {7644}let gNs_6178: bitstring = exp(g,Ns_6175) in
                                                                    {7645}let m2_6179: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6178,ST_6176,TTL_6177) in
                                                                    {7646}event beginSrv(Sess_5025,Cli_5023,gNs_6178);
                                                                    {7647}out(c, (enc(m2_6179,pkCli_6146),sign(h(m2_6179),skSess_6068)));
                                                                    {7648}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7649}event endSrv(Cli_5023,Sess_5025,PartC_6174)
                                                            )
                                                            else
                                                                {7650}let pkDisco_6180: bitstring = pub(sk(Disco_5024)) in
                                                                {7651}in(c, (=pkCli_6146,em1_6181: bitstring,sigM1_6182: bitstring));
                                                                {7652}let m1_6183: bitstring = dec(em1_6181,skSess_6068) in
                                                                {7653}if (verify(h(m1_6183),sigM1_6182,pkCli_6146) <> true) then
                                                                    0
                                                                else
                                                                    {7654}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6184: bitstring) = m1_6183 in
                                                                    {7655}new Ns_6185: bitstring;
                                                                    {7656}new ST_6186: bitstring;
                                                                    {7657}new TTL_6187: bitstring;
                                                                    {7658}let gNs_6188: bitstring = exp(g,Ns_6185) in
                                                                    {7659}let m2_6189: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6188,ST_6186,TTL_6187) in
                                                                    {7660}event beginSrv(Sess_5025,Cli_5023,gNs_6188);
                                                                    {7661}out(c, (enc(m2_6189,pkCli_6146),sign(h(m2_6189),skSess_6068)));
                                                                    {7662}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7663}event endSrv(Cli_5023,Sess_5025,PartC_6184)
                                                        )
                                                        else
                                                            {7664}let pkDisco_6190: bitstring = fail-any in
                                                            {7665}in(c, (=pkCli_6146,em1_6191: bitstring,sigM1_6192: bitstring));
                                                            {7666}let m1_6193: bitstring = dec(em1_6191,skSess_6068) in
                                                            {7667}if (verify(h(m1_6193),sigM1_6192,pkCli_6146) <> true) then
                                                                0
                                                            else
                                                                {7668}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6194: bitstring) = m1_6193 in
                                                                {7669}new Ns_6195: bitstring;
                                                                {7670}new ST_6196: bitstring;
                                                                {7671}new TTL_6197: bitstring;
                                                                {7672}let gNs_6198: bitstring = exp(g,Ns_6195) in
                                                                {7673}let m2_6199: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6198,ST_6196,TTL_6197) in
                                                                {7674}event beginSrv(Sess_5025,Cli_5023,gNs_6198);
                                                                {7675}out(c, (enc(m2_6199,pkCli_6146),sign(h(m2_6199),skSess_6068)));
                                                                {7676}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7677}event endSrv(Cli_5023,Sess_5025,PartC_6194)
                                                )
                                                else
                                                    {7678}let pkDisco_6200: bitstring = fail-any in
                                                    {7679}in(c, (=pkCli_6146,em1_6201: bitstring,sigM1_6202: bitstring));
                                                    {7680}let m1_6203: bitstring = dec(em1_6201,skSess_6068) in
                                                    {7681}if (verify(h(m1_6203),sigM1_6202,pkCli_6146) <> true) then
                                                        0
                                                    else
                                                        {7682}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6204: bitstring) = m1_6203 in
                                                        {7683}new Ns_6205: bitstring;
                                                        {7684}new ST_6206: bitstring;
                                                        {7685}new TTL_6207: bitstring;
                                                        {7686}let gNs_6208: bitstring = exp(g,Ns_6205) in
                                                        {7687}let m2_6209: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6208,ST_6206,TTL_6207) in
                                                        {7688}event beginSrv(Sess_5025,Cli_5023,gNs_6208);
                                                        {7689}out(c, (enc(m2_6209,pkCli_6146),sign(h(m2_6209),skSess_6068)));
                                                        {7690}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7691}event endSrv(Cli_5023,Sess_5025,PartC_6204)
                                        )
                                        else
                                            {7692}let pkDisco_6210: bitstring = fail-any in
                                            {7693}in(c, (=pkCli_6146,em1_6211: bitstring,sigM1_6212: bitstring));
                                            {7694}let m1_6213: bitstring = dec(em1_6211,skSess_6068) in
                                            {7695}if (verify(h(m1_6213),sigM1_6212,pkCli_6146) <> true) then
                                                0
                                            else
                                                {7696}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6146,PartC_6214: bitstring) = m1_6213 in
                                                {7697}new Ns_6215: bitstring;
                                                {7698}new ST_6216: bitstring;
                                                {7699}new TTL_6217: bitstring;
                                                {7700}let gNs_6218: bitstring = exp(g,Ns_6215) in
                                                {7701}let m2_6219: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6218,ST_6216,TTL_6217) in
                                                {7702}event beginSrv(Sess_5025,Cli_5023,gNs_6218);
                                                {7703}out(c, (enc(m2_6219,pkCli_6146),sign(h(m2_6219),skSess_6068)));
                                                {7704}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {7705}event endSrv(Cli_5023,Sess_5025,PartC_6214)
                                    )
                                    else
                                        {7706}let v_6220: bool = (Cli_5023 = C) in
                                        (
                                            {7707}if v_6220 then
                                            (
                                                {7708}let pkCli_6221: bitstring = pub(skC) in
                                                {7709}let v_6222: bool = (Disco_5024 = A) in
                                                (
                                                    {7710}if v_6222 then
                                                    (
                                                        {7711}let pkDisco_6223: bitstring = pub(skA) in
                                                        {7712}in(c, (=pkCli_6221,em1_6224: bitstring,sigM1_6225: bitstring));
                                                        {7713}let m1_6226: bitstring = dec(em1_6224,skSess_6068) in
                                                        {7714}if (verify(h(m1_6226),sigM1_6225,pkCli_6221) <> true) then
                                                            0
                                                        else
                                                            {7715}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6227: bitstring) = m1_6226 in
                                                            {7716}new Ns_6228: bitstring;
                                                            {7717}new ST_6229: bitstring;
                                                            {7718}new TTL_6230: bitstring;
                                                            {7719}let gNs_6231: bitstring = exp(g,Ns_6228) in
                                                            {7720}let m2_6232: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6231,ST_6229,TTL_6230) in
                                                            {7721}event beginSrv(Sess_5025,Cli_5023,gNs_6231);
                                                            {7722}out(c, (enc(m2_6232,pkCli_6221),sign(h(m2_6232),skSess_6068)));
                                                            {7723}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7724}event endSrv(Cli_5023,Sess_5025,PartC_6227)
                                                    )
                                                    else
                                                        {7725}let v_6233: bool = (Disco_5024 = B) in
                                                        (
                                                            {7726}if v_6233 then
                                                            (
                                                                {7727}let pkDisco_6234: bitstring = pub(skB) in
                                                                {7728}in(c, (=pkCli_6221,em1_6235: bitstring,sigM1_6236: bitstring));
                                                                {7729}let m1_6237: bitstring = dec(em1_6235,skSess_6068) in
                                                                {7730}if (verify(h(m1_6237),sigM1_6236,pkCli_6221) <> true) then
                                                                    0
                                                                else
                                                                    {7731}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6238: bitstring) = m1_6237 in
                                                                    {7732}new Ns_6239: bitstring;
                                                                    {7733}new ST_6240: bitstring;
                                                                    {7734}new TTL_6241: bitstring;
                                                                    {7735}let gNs_6242: bitstring = exp(g,Ns_6239) in
                                                                    {7736}let m2_6243: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6242,ST_6240,TTL_6241) in
                                                                    {7737}event beginSrv(Sess_5025,Cli_5023,gNs_6242);
                                                                    {7738}out(c, (enc(m2_6243,pkCli_6221),sign(h(m2_6243),skSess_6068)));
                                                                    {7739}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7740}event endSrv(Cli_5023,Sess_5025,PartC_6238)
                                                            )
                                                            else
                                                                {7741}let v_6244: bool = (Disco_5024 = C) in
                                                                (
                                                                    {7742}if v_6244 then
                                                                    (
                                                                        {7743}let pkDisco_6245: bitstring = pub(skC) in
                                                                        {7744}in(c, (=pkCli_6221,em1_6246: bitstring,sigM1_6247: bitstring));
                                                                        {7745}let m1_6248: bitstring = dec(em1_6246,skSess_6068) in
                                                                        {7746}if (verify(h(m1_6248),sigM1_6247,pkCli_6221) <> true) then
                                                                            0
                                                                        else
                                                                            {7747}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6249: bitstring) = m1_6248 in
                                                                            {7748}new Ns_6250: bitstring;
                                                                            {7749}new ST_6251: bitstring;
                                                                            {7750}new TTL_6252: bitstring;
                                                                            {7751}let gNs_6253: bitstring = exp(g,Ns_6250) in
                                                                            {7752}let m2_6254: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6253,ST_6251,TTL_6252) in
                                                                            {7753}event beginSrv(Sess_5025,Cli_5023,gNs_6253);
                                                                            {7754}out(c, (enc(m2_6254,pkCli_6221),sign(h(m2_6254),skSess_6068)));
                                                                            {7755}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7756}event endSrv(Cli_5023,Sess_5025,PartC_6249)
                                                                    )
                                                                    else
                                                                        {7757}let pkDisco_6255: bitstring = pub(sk(Disco_5024)) in
                                                                        {7758}in(c, (=pkCli_6221,em1_6256: bitstring,sigM1_6257: bitstring));
                                                                        {7759}let m1_6258: bitstring = dec(em1_6256,skSess_6068) in
                                                                        {7760}if (verify(h(m1_6258),sigM1_6257,pkCli_6221) <> true) then
                                                                            0
                                                                        else
                                                                            {7761}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6259: bitstring) = m1_6258 in
                                                                            {7762}new Ns_6260: bitstring;
                                                                            {7763}new ST_6261: bitstring;
                                                                            {7764}new TTL_6262: bitstring;
                                                                            {7765}let gNs_6263: bitstring = exp(g,Ns_6260) in
                                                                            {7766}let m2_6264: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6263,ST_6261,TTL_6262) in
                                                                            {7767}event beginSrv(Sess_5025,Cli_5023,gNs_6263);
                                                                            {7768}out(c, (enc(m2_6264,pkCli_6221),sign(h(m2_6264),skSess_6068)));
                                                                            {7769}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7770}event endSrv(Cli_5023,Sess_5025,PartC_6259)
                                                                )
                                                                else
                                                                    {7771}let pkDisco_6265: bitstring = fail-any in
                                                                    {7772}in(c, (=pkCli_6221,em1_6266: bitstring,sigM1_6267: bitstring));
                                                                    {7773}let m1_6268: bitstring = dec(em1_6266,skSess_6068) in
                                                                    {7774}if (verify(h(m1_6268),sigM1_6267,pkCli_6221) <> true) then
                                                                        0
                                                                    else
                                                                        {7775}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6269: bitstring) = m1_6268 in
                                                                        {7776}new Ns_6270: bitstring;
                                                                        {7777}new ST_6271: bitstring;
                                                                        {7778}new TTL_6272: bitstring;
                                                                        {7779}let gNs_6273: bitstring = exp(g,Ns_6270) in
                                                                        {7780}let m2_6274: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6273,ST_6271,TTL_6272) in
                                                                        {7781}event beginSrv(Sess_5025,Cli_5023,gNs_6273);
                                                                        {7782}out(c, (enc(m2_6274,pkCli_6221),sign(h(m2_6274),skSess_6068)));
                                                                        {7783}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7784}event endSrv(Cli_5023,Sess_5025,PartC_6269)
                                                        )
                                                        else
                                                            {7785}let pkDisco_6275: bitstring = fail-any in
                                                            {7786}in(c, (=pkCli_6221,em1_6276: bitstring,sigM1_6277: bitstring));
                                                            {7787}let m1_6278: bitstring = dec(em1_6276,skSess_6068) in
                                                            {7788}if (verify(h(m1_6278),sigM1_6277,pkCli_6221) <> true) then
                                                                0
                                                            else
                                                                {7789}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6279: bitstring) = m1_6278 in
                                                                {7790}new Ns_6280: bitstring;
                                                                {7791}new ST_6281: bitstring;
                                                                {7792}new TTL_6282: bitstring;
                                                                {7793}let gNs_6283: bitstring = exp(g,Ns_6280) in
                                                                {7794}let m2_6284: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6283,ST_6281,TTL_6282) in
                                                                {7795}event beginSrv(Sess_5025,Cli_5023,gNs_6283);
                                                                {7796}out(c, (enc(m2_6284,pkCli_6221),sign(h(m2_6284),skSess_6068)));
                                                                {7797}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7798}event endSrv(Cli_5023,Sess_5025,PartC_6279)
                                                )
                                                else
                                                    {7799}let pkDisco_6285: bitstring = fail-any in
                                                    {7800}in(c, (=pkCli_6221,em1_6286: bitstring,sigM1_6287: bitstring));
                                                    {7801}let m1_6288: bitstring = dec(em1_6286,skSess_6068) in
                                                    {7802}if (verify(h(m1_6288),sigM1_6287,pkCli_6221) <> true) then
                                                        0
                                                    else
                                                        {7803}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6221,PartC_6289: bitstring) = m1_6288 in
                                                        {7804}new Ns_6290: bitstring;
                                                        {7805}new ST_6291: bitstring;
                                                        {7806}new TTL_6292: bitstring;
                                                        {7807}let gNs_6293: bitstring = exp(g,Ns_6290) in
                                                        {7808}let m2_6294: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6293,ST_6291,TTL_6292) in
                                                        {7809}event beginSrv(Sess_5025,Cli_5023,gNs_6293);
                                                        {7810}out(c, (enc(m2_6294,pkCli_6221),sign(h(m2_6294),skSess_6068)));
                                                        {7811}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7812}event endSrv(Cli_5023,Sess_5025,PartC_6289)
                                            )
                                            else
                                                {7813}let pkCli_6295: bitstring = pub(sk(Cli_5023)) in
                                                {7814}let v_6296: bool = (Disco_5024 = A) in
                                                (
                                                    {7815}if v_6296 then
                                                    (
                                                        {7816}let pkDisco_6297: bitstring = pub(skA) in
                                                        {7817}in(c, (=pkCli_6295,em1_6298: bitstring,sigM1_6299: bitstring));
                                                        {7818}let m1_6300: bitstring = dec(em1_6298,skSess_6068) in
                                                        {7819}if (verify(h(m1_6300),sigM1_6299,pkCli_6295) <> true) then
                                                            0
                                                        else
                                                            {7820}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6301: bitstring) = m1_6300 in
                                                            {7821}new Ns_6302: bitstring;
                                                            {7822}new ST_6303: bitstring;
                                                            {7823}new TTL_6304: bitstring;
                                                            {7824}let gNs_6305: bitstring = exp(g,Ns_6302) in
                                                            {7825}let m2_6306: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6305,ST_6303,TTL_6304) in
                                                            {7826}event beginSrv(Sess_5025,Cli_5023,gNs_6305);
                                                            {7827}out(c, (enc(m2_6306,pkCli_6295),sign(h(m2_6306),skSess_6068)));
                                                            {7828}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {7829}event endSrv(Cli_5023,Sess_5025,PartC_6301)
                                                    )
                                                    else
                                                        {7830}let v_6307: bool = (Disco_5024 = B) in
                                                        (
                                                            {7831}if v_6307 then
                                                            (
                                                                {7832}let pkDisco_6308: bitstring = pub(skB) in
                                                                {7833}in(c, (=pkCli_6295,em1_6309: bitstring,sigM1_6310: bitstring));
                                                                {7834}let m1_6311: bitstring = dec(em1_6309,skSess_6068) in
                                                                {7835}if (verify(h(m1_6311),sigM1_6310,pkCli_6295) <> true) then
                                                                    0
                                                                else
                                                                    {7836}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6312: bitstring) = m1_6311 in
                                                                    {7837}new Ns_6313: bitstring;
                                                                    {7838}new ST_6314: bitstring;
                                                                    {7839}new TTL_6315: bitstring;
                                                                    {7840}let gNs_6316: bitstring = exp(g,Ns_6313) in
                                                                    {7841}let m2_6317: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6316,ST_6314,TTL_6315) in
                                                                    {7842}event beginSrv(Sess_5025,Cli_5023,gNs_6316);
                                                                    {7843}out(c, (enc(m2_6317,pkCli_6295),sign(h(m2_6317),skSess_6068)));
                                                                    {7844}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7845}event endSrv(Cli_5023,Sess_5025,PartC_6312)
                                                            )
                                                            else
                                                                {7846}let v_6318: bool = (Disco_5024 = C) in
                                                                (
                                                                    {7847}if v_6318 then
                                                                    (
                                                                        {7848}let pkDisco_6319: bitstring = pub(skC) in
                                                                        {7849}in(c, (=pkCli_6295,em1_6320: bitstring,sigM1_6321: bitstring));
                                                                        {7850}let m1_6322: bitstring = dec(em1_6320,skSess_6068) in
                                                                        {7851}if (verify(h(m1_6322),sigM1_6321,pkCli_6295) <> true) then
                                                                            0
                                                                        else
                                                                            {7852}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6323: bitstring) = m1_6322 in
                                                                            {7853}new Ns_6324: bitstring;
                                                                            {7854}new ST_6325: bitstring;
                                                                            {7855}new TTL_6326: bitstring;
                                                                            {7856}let gNs_6327: bitstring = exp(g,Ns_6324) in
                                                                            {7857}let m2_6328: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6327,ST_6325,TTL_6326) in
                                                                            {7858}event beginSrv(Sess_5025,Cli_5023,gNs_6327);
                                                                            {7859}out(c, (enc(m2_6328,pkCli_6295),sign(h(m2_6328),skSess_6068)));
                                                                            {7860}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7861}event endSrv(Cli_5023,Sess_5025,PartC_6323)
                                                                    )
                                                                    else
                                                                        {7862}let pkDisco_6329: bitstring = pub(sk(Disco_5024)) in
                                                                        {7863}in(c, (=pkCli_6295,em1_6330: bitstring,sigM1_6331: bitstring));
                                                                        {7864}let m1_6332: bitstring = dec(em1_6330,skSess_6068) in
                                                                        {7865}if (verify(h(m1_6332),sigM1_6331,pkCli_6295) <> true) then
                                                                            0
                                                                        else
                                                                            {7866}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6333: bitstring) = m1_6332 in
                                                                            {7867}new Ns_6334: bitstring;
                                                                            {7868}new ST_6335: bitstring;
                                                                            {7869}new TTL_6336: bitstring;
                                                                            {7870}let gNs_6337: bitstring = exp(g,Ns_6334) in
                                                                            {7871}let m2_6338: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6337,ST_6335,TTL_6336) in
                                                                            {7872}event beginSrv(Sess_5025,Cli_5023,gNs_6337);
                                                                            {7873}out(c, (enc(m2_6338,pkCli_6295),sign(h(m2_6338),skSess_6068)));
                                                                            {7874}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {7875}event endSrv(Cli_5023,Sess_5025,PartC_6333)
                                                                )
                                                                else
                                                                    {7876}let pkDisco_6339: bitstring = fail-any in
                                                                    {7877}in(c, (=pkCli_6295,em1_6340: bitstring,sigM1_6341: bitstring));
                                                                    {7878}let m1_6342: bitstring = dec(em1_6340,skSess_6068) in
                                                                    {7879}if (verify(h(m1_6342),sigM1_6341,pkCli_6295) <> true) then
                                                                        0
                                                                    else
                                                                        {7880}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6343: bitstring) = m1_6342 in
                                                                        {7881}new Ns_6344: bitstring;
                                                                        {7882}new ST_6345: bitstring;
                                                                        {7883}new TTL_6346: bitstring;
                                                                        {7884}let gNs_6347: bitstring = exp(g,Ns_6344) in
                                                                        {7885}let m2_6348: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6347,ST_6345,TTL_6346) in
                                                                        {7886}event beginSrv(Sess_5025,Cli_5023,gNs_6347);
                                                                        {7887}out(c, (enc(m2_6348,pkCli_6295),sign(h(m2_6348),skSess_6068)));
                                                                        {7888}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7889}event endSrv(Cli_5023,Sess_5025,PartC_6343)
                                                        )
                                                        else
                                                            {7890}let pkDisco_6349: bitstring = fail-any in
                                                            {7891}in(c, (=pkCli_6295,em1_6350: bitstring,sigM1_6351: bitstring));
                                                            {7892}let m1_6352: bitstring = dec(em1_6350,skSess_6068) in
                                                            {7893}if (verify(h(m1_6352),sigM1_6351,pkCli_6295) <> true) then
                                                                0
                                                            else
                                                                {7894}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6353: bitstring) = m1_6352 in
                                                                {7895}new Ns_6354: bitstring;
                                                                {7896}new ST_6355: bitstring;
                                                                {7897}new TTL_6356: bitstring;
                                                                {7898}let gNs_6357: bitstring = exp(g,Ns_6354) in
                                                                {7899}let m2_6358: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6357,ST_6355,TTL_6356) in
                                                                {7900}event beginSrv(Sess_5025,Cli_5023,gNs_6357);
                                                                {7901}out(c, (enc(m2_6358,pkCli_6295),sign(h(m2_6358),skSess_6068)));
                                                                {7902}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7903}event endSrv(Cli_5023,Sess_5025,PartC_6353)
                                                )
                                                else
                                                    {7904}let pkDisco_6359: bitstring = fail-any in
                                                    {7905}in(c, (=pkCli_6295,em1_6360: bitstring,sigM1_6361: bitstring));
                                                    {7906}let m1_6362: bitstring = dec(em1_6360,skSess_6068) in
                                                    {7907}if (verify(h(m1_6362),sigM1_6361,pkCli_6295) <> true) then
                                                        0
                                                    else
                                                        {7908}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6295,PartC_6363: bitstring) = m1_6362 in
                                                        {7909}new Ns_6364: bitstring;
                                                        {7910}new ST_6365: bitstring;
                                                        {7911}new TTL_6366: bitstring;
                                                        {7912}let gNs_6367: bitstring = exp(g,Ns_6364) in
                                                        {7913}let m2_6368: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6367,ST_6365,TTL_6366) in
                                                        {7914}event beginSrv(Sess_5025,Cli_5023,gNs_6367);
                                                        {7915}out(c, (enc(m2_6368,pkCli_6295),sign(h(m2_6368),skSess_6068)));
                                                        {7916}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7917}event endSrv(Cli_5023,Sess_5025,PartC_6363)
                                        )
                                        else
                                            {7918}let pkCli_6369: bitstring = fail-any in
                                            {7919}let v_6370: bool = (Disco_5024 = A) in
                                            (
                                                {7920}if v_6370 then
                                                (
                                                    {7921}let pkDisco_6371: bitstring = pub(skA) in
                                                    {7922}in(c, (=pkCli_6369,em1_6372: bitstring,sigM1_6373: bitstring));
                                                    {7923}let m1_6374: bitstring = dec(em1_6372,skSess_6068) in
                                                    {7924}if (verify(h(m1_6374),sigM1_6373,pkCli_6369) <> true) then
                                                        0
                                                    else
                                                        {7925}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6375: bitstring) = m1_6374 in
                                                        {7926}new Ns_6376: bitstring;
                                                        {7927}new ST_6377: bitstring;
                                                        {7928}new TTL_6378: bitstring;
                                                        {7929}let gNs_6379: bitstring = exp(g,Ns_6376) in
                                                        {7930}let m2_6380: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6379,ST_6377,TTL_6378) in
                                                        {7931}event beginSrv(Sess_5025,Cli_5023,gNs_6379);
                                                        {7932}out(c, (enc(m2_6380,pkCli_6369),sign(h(m2_6380),skSess_6068)));
                                                        {7933}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {7934}event endSrv(Cli_5023,Sess_5025,PartC_6375)
                                                )
                                                else
                                                    {7935}let v_6381: bool = (Disco_5024 = B) in
                                                    (
                                                        {7936}if v_6381 then
                                                        (
                                                            {7937}let pkDisco_6382: bitstring = pub(skB) in
                                                            {7938}in(c, (=pkCli_6369,em1_6383: bitstring,sigM1_6384: bitstring));
                                                            {7939}let m1_6385: bitstring = dec(em1_6383,skSess_6068) in
                                                            {7940}if (verify(h(m1_6385),sigM1_6384,pkCli_6369) <> true) then
                                                                0
                                                            else
                                                                {7941}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6386: bitstring) = m1_6385 in
                                                                {7942}new Ns_6387: bitstring;
                                                                {7943}new ST_6388: bitstring;
                                                                {7944}new TTL_6389: bitstring;
                                                                {7945}let gNs_6390: bitstring = exp(g,Ns_6387) in
                                                                {7946}let m2_6391: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6390,ST_6388,TTL_6389) in
                                                                {7947}event beginSrv(Sess_5025,Cli_5023,gNs_6390);
                                                                {7948}out(c, (enc(m2_6391,pkCli_6369),sign(h(m2_6391),skSess_6068)));
                                                                {7949}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {7950}event endSrv(Cli_5023,Sess_5025,PartC_6386)
                                                        )
                                                        else
                                                            {7951}let v_6392: bool = (Disco_5024 = C) in
                                                            (
                                                                {7952}if v_6392 then
                                                                (
                                                                    {7953}let pkDisco_6393: bitstring = pub(skC) in
                                                                    {7954}in(c, (=pkCli_6369,em1_6394: bitstring,sigM1_6395: bitstring));
                                                                    {7955}let m1_6396: bitstring = dec(em1_6394,skSess_6068) in
                                                                    {7956}if (verify(h(m1_6396),sigM1_6395,pkCli_6369) <> true) then
                                                                        0
                                                                    else
                                                                        {7957}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6397: bitstring) = m1_6396 in
                                                                        {7958}new Ns_6398: bitstring;
                                                                        {7959}new ST_6399: bitstring;
                                                                        {7960}new TTL_6400: bitstring;
                                                                        {7961}let gNs_6401: bitstring = exp(g,Ns_6398) in
                                                                        {7962}let m2_6402: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6401,ST_6399,TTL_6400) in
                                                                        {7963}event beginSrv(Sess_5025,Cli_5023,gNs_6401);
                                                                        {7964}out(c, (enc(m2_6402,pkCli_6369),sign(h(m2_6402),skSess_6068)));
                                                                        {7965}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7966}event endSrv(Cli_5023,Sess_5025,PartC_6397)
                                                                )
                                                                else
                                                                    {7967}let pkDisco_6403: bitstring = pub(sk(Disco_5024)) in
                                                                    {7968}in(c, (=pkCli_6369,em1_6404: bitstring,sigM1_6405: bitstring));
                                                                    {7969}let m1_6406: bitstring = dec(em1_6404,skSess_6068) in
                                                                    {7970}if (verify(h(m1_6406),sigM1_6405,pkCli_6369) <> true) then
                                                                        0
                                                                    else
                                                                        {7971}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6407: bitstring) = m1_6406 in
                                                                        {7972}new Ns_6408: bitstring;
                                                                        {7973}new ST_6409: bitstring;
                                                                        {7974}new TTL_6410: bitstring;
                                                                        {7975}let gNs_6411: bitstring = exp(g,Ns_6408) in
                                                                        {7976}let m2_6412: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6411,ST_6409,TTL_6410) in
                                                                        {7977}event beginSrv(Sess_5025,Cli_5023,gNs_6411);
                                                                        {7978}out(c, (enc(m2_6412,pkCli_6369),sign(h(m2_6412),skSess_6068)));
                                                                        {7979}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {7980}event endSrv(Cli_5023,Sess_5025,PartC_6407)
                                                            )
                                                            else
                                                                {7981}let pkDisco_6413: bitstring = fail-any in
                                                                {7982}in(c, (=pkCli_6369,em1_6414: bitstring,sigM1_6415: bitstring));
                                                                {7983}let m1_6416: bitstring = dec(em1_6414,skSess_6068) in
                                                                {7984}if (verify(h(m1_6416),sigM1_6415,pkCli_6369) <> true) then
                                                                    0
                                                                else
                                                                    {7985}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6417: bitstring) = m1_6416 in
                                                                    {7986}new Ns_6418: bitstring;
                                                                    {7987}new ST_6419: bitstring;
                                                                    {7988}new TTL_6420: bitstring;
                                                                    {7989}let gNs_6421: bitstring = exp(g,Ns_6418) in
                                                                    {7990}let m2_6422: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6421,ST_6419,TTL_6420) in
                                                                    {7991}event beginSrv(Sess_5025,Cli_5023,gNs_6421);
                                                                    {7992}out(c, (enc(m2_6422,pkCli_6369),sign(h(m2_6422),skSess_6068)));
                                                                    {7993}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {7994}event endSrv(Cli_5023,Sess_5025,PartC_6417)
                                                    )
                                                    else
                                                        {7995}let pkDisco_6423: bitstring = fail-any in
                                                        {7996}in(c, (=pkCli_6369,em1_6424: bitstring,sigM1_6425: bitstring));
                                                        {7997}let m1_6426: bitstring = dec(em1_6424,skSess_6068) in
                                                        {7998}if (verify(h(m1_6426),sigM1_6425,pkCli_6369) <> true) then
                                                            0
                                                        else
                                                            {7999}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6427: bitstring) = m1_6426 in
                                                            {8000}new Ns_6428: bitstring;
                                                            {8001}new ST_6429: bitstring;
                                                            {8002}new TTL_6430: bitstring;
                                                            {8003}let gNs_6431: bitstring = exp(g,Ns_6428) in
                                                            {8004}let m2_6432: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6431,ST_6429,TTL_6430) in
                                                            {8005}event beginSrv(Sess_5025,Cli_5023,gNs_6431);
                                                            {8006}out(c, (enc(m2_6432,pkCli_6369),sign(h(m2_6432),skSess_6068)));
                                                            {8007}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8008}event endSrv(Cli_5023,Sess_5025,PartC_6427)
                                            )
                                            else
                                                {8009}let pkDisco_6433: bitstring = fail-any in
                                                {8010}in(c, (=pkCli_6369,em1_6434: bitstring,sigM1_6435: bitstring));
                                                {8011}let m1_6436: bitstring = dec(em1_6434,skSess_6068) in
                                                {8012}if (verify(h(m1_6436),sigM1_6435,pkCli_6369) <> true) then
                                                    0
                                                else
                                                    {8013}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6369,PartC_6437: bitstring) = m1_6436 in
                                                    {8014}new Ns_6438: bitstring;
                                                    {8015}new ST_6439: bitstring;
                                                    {8016}new TTL_6440: bitstring;
                                                    {8017}let gNs_6441: bitstring = exp(g,Ns_6438) in
                                                    {8018}let m2_6442: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6441,ST_6439,TTL_6440) in
                                                    {8019}event beginSrv(Sess_5025,Cli_5023,gNs_6441);
                                                    {8020}out(c, (enc(m2_6442,pkCli_6369),sign(h(m2_6442),skSess_6068)));
                                                    {8021}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8022}event endSrv(Cli_5023,Sess_5025,PartC_6437)
                                )
                                else
                                    {8023}let pkCli_6443: bitstring = fail-any in
                                    {8024}let v_6444: bool = (Disco_5024 = A) in
                                    (
                                        {8025}if v_6444 then
                                        (
                                            {8026}let pkDisco_6445: bitstring = pub(skA) in
                                            {8027}in(c, (=pkCli_6443,em1_6446: bitstring,sigM1_6447: bitstring));
                                            {8028}let m1_6448: bitstring = dec(em1_6446,skSess_6068) in
                                            {8029}if (verify(h(m1_6448),sigM1_6447,pkCli_6443) <> true) then
                                                0
                                            else
                                                {8030}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6449: bitstring) = m1_6448 in
                                                {8031}new Ns_6450: bitstring;
                                                {8032}new ST_6451: bitstring;
                                                {8033}new TTL_6452: bitstring;
                                                {8034}let gNs_6453: bitstring = exp(g,Ns_6450) in
                                                {8035}let m2_6454: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6453,ST_6451,TTL_6452) in
                                                {8036}event beginSrv(Sess_5025,Cli_5023,gNs_6453);
                                                {8037}out(c, (enc(m2_6454,pkCli_6443),sign(h(m2_6454),skSess_6068)));
                                                {8038}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8039}event endSrv(Cli_5023,Sess_5025,PartC_6449)
                                        )
                                        else
                                            {8040}let v_6455: bool = (Disco_5024 = B) in
                                            (
                                                {8041}if v_6455 then
                                                (
                                                    {8042}let pkDisco_6456: bitstring = pub(skB) in
                                                    {8043}in(c, (=pkCli_6443,em1_6457: bitstring,sigM1_6458: bitstring));
                                                    {8044}let m1_6459: bitstring = dec(em1_6457,skSess_6068) in
                                                    {8045}if (verify(h(m1_6459),sigM1_6458,pkCli_6443) <> true) then
                                                        0
                                                    else
                                                        {8046}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6460: bitstring) = m1_6459 in
                                                        {8047}new Ns_6461: bitstring;
                                                        {8048}new ST_6462: bitstring;
                                                        {8049}new TTL_6463: bitstring;
                                                        {8050}let gNs_6464: bitstring = exp(g,Ns_6461) in
                                                        {8051}let m2_6465: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6464,ST_6462,TTL_6463) in
                                                        {8052}event beginSrv(Sess_5025,Cli_5023,gNs_6464);
                                                        {8053}out(c, (enc(m2_6465,pkCli_6443),sign(h(m2_6465),skSess_6068)));
                                                        {8054}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8055}event endSrv(Cli_5023,Sess_5025,PartC_6460)
                                                )
                                                else
                                                    {8056}let v_6466: bool = (Disco_5024 = C) in
                                                    (
                                                        {8057}if v_6466 then
                                                        (
                                                            {8058}let pkDisco_6467: bitstring = pub(skC) in
                                                            {8059}in(c, (=pkCli_6443,em1_6468: bitstring,sigM1_6469: bitstring));
                                                            {8060}let m1_6470: bitstring = dec(em1_6468,skSess_6068) in
                                                            {8061}if (verify(h(m1_6470),sigM1_6469,pkCli_6443) <> true) then
                                                                0
                                                            else
                                                                {8062}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6471: bitstring) = m1_6470 in
                                                                {8063}new Ns_6472: bitstring;
                                                                {8064}new ST_6473: bitstring;
                                                                {8065}new TTL_6474: bitstring;
                                                                {8066}let gNs_6475: bitstring = exp(g,Ns_6472) in
                                                                {8067}let m2_6476: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6475,ST_6473,TTL_6474) in
                                                                {8068}event beginSrv(Sess_5025,Cli_5023,gNs_6475);
                                                                {8069}out(c, (enc(m2_6476,pkCli_6443),sign(h(m2_6476),skSess_6068)));
                                                                {8070}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8071}event endSrv(Cli_5023,Sess_5025,PartC_6471)
                                                        )
                                                        else
                                                            {8072}let pkDisco_6477: bitstring = pub(sk(Disco_5024)) in
                                                            {8073}in(c, (=pkCli_6443,em1_6478: bitstring,sigM1_6479: bitstring));
                                                            {8074}let m1_6480: bitstring = dec(em1_6478,skSess_6068) in
                                                            {8075}if (verify(h(m1_6480),sigM1_6479,pkCli_6443) <> true) then
                                                                0
                                                            else
                                                                {8076}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6481: bitstring) = m1_6480 in
                                                                {8077}new Ns_6482: bitstring;
                                                                {8078}new ST_6483: bitstring;
                                                                {8079}new TTL_6484: bitstring;
                                                                {8080}let gNs_6485: bitstring = exp(g,Ns_6482) in
                                                                {8081}let m2_6486: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6485,ST_6483,TTL_6484) in
                                                                {8082}event beginSrv(Sess_5025,Cli_5023,gNs_6485);
                                                                {8083}out(c, (enc(m2_6486,pkCli_6443),sign(h(m2_6486),skSess_6068)));
                                                                {8084}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8085}event endSrv(Cli_5023,Sess_5025,PartC_6481)
                                                    )
                                                    else
                                                        {8086}let pkDisco_6487: bitstring = fail-any in
                                                        {8087}in(c, (=pkCli_6443,em1_6488: bitstring,sigM1_6489: bitstring));
                                                        {8088}let m1_6490: bitstring = dec(em1_6488,skSess_6068) in
                                                        {8089}if (verify(h(m1_6490),sigM1_6489,pkCli_6443) <> true) then
                                                            0
                                                        else
                                                            {8090}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6491: bitstring) = m1_6490 in
                                                            {8091}new Ns_6492: bitstring;
                                                            {8092}new ST_6493: bitstring;
                                                            {8093}new TTL_6494: bitstring;
                                                            {8094}let gNs_6495: bitstring = exp(g,Ns_6492) in
                                                            {8095}let m2_6496: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6495,ST_6493,TTL_6494) in
                                                            {8096}event beginSrv(Sess_5025,Cli_5023,gNs_6495);
                                                            {8097}out(c, (enc(m2_6496,pkCli_6443),sign(h(m2_6496),skSess_6068)));
                                                            {8098}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8099}event endSrv(Cli_5023,Sess_5025,PartC_6491)
                                            )
                                            else
                                                {8100}let pkDisco_6497: bitstring = fail-any in
                                                {8101}in(c, (=pkCli_6443,em1_6498: bitstring,sigM1_6499: bitstring));
                                                {8102}let m1_6500: bitstring = dec(em1_6498,skSess_6068) in
                                                {8103}if (verify(h(m1_6500),sigM1_6499,pkCli_6443) <> true) then
                                                    0
                                                else
                                                    {8104}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6501: bitstring) = m1_6500 in
                                                    {8105}new Ns_6502: bitstring;
                                                    {8106}new ST_6503: bitstring;
                                                    {8107}new TTL_6504: bitstring;
                                                    {8108}let gNs_6505: bitstring = exp(g,Ns_6502) in
                                                    {8109}let m2_6506: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6505,ST_6503,TTL_6504) in
                                                    {8110}event beginSrv(Sess_5025,Cli_5023,gNs_6505);
                                                    {8111}out(c, (enc(m2_6506,pkCli_6443),sign(h(m2_6506),skSess_6068)));
                                                    {8112}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8113}event endSrv(Cli_5023,Sess_5025,PartC_6501)
                                    )
                                    else
                                        {8114}let pkDisco_6507: bitstring = fail-any in
                                        {8115}in(c, (=pkCli_6443,em1_6508: bitstring,sigM1_6509: bitstring));
                                        {8116}let m1_6510: bitstring = dec(em1_6508,skSess_6068) in
                                        {8117}if (verify(h(m1_6510),sigM1_6509,pkCli_6443) <> true) then
                                            0
                                        else
                                            {8118}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6443,PartC_6511: bitstring) = m1_6510 in
                                            {8119}new Ns_6512: bitstring;
                                            {8120}new ST_6513: bitstring;
                                            {8121}new TTL_6514: bitstring;
                                            {8122}let gNs_6515: bitstring = exp(g,Ns_6512) in
                                            {8123}let m2_6516: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6515,ST_6513,TTL_6514) in
                                            {8124}event beginSrv(Sess_5025,Cli_5023,gNs_6515);
                                            {8125}out(c, (enc(m2_6516,pkCli_6443),sign(h(m2_6516),skSess_6068)));
                                            {8126}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8127}event endSrv(Cli_5023,Sess_5025,PartC_6511)
                        )
                        else
                            {8128}let pkCli_6517: bitstring = fail-any in
                            {8129}let v_6518: bool = (Disco_5024 = A) in
                            (
                                {8130}if v_6518 then
                                (
                                    {8131}let pkDisco_6519: bitstring = pub(skA) in
                                    {8132}in(c, (=pkCli_6517,em1_6520: bitstring,sigM1_6521: bitstring));
                                    {8133}let m1_6522: bitstring = dec(em1_6520,skSess_6068) in
                                    {8134}if (verify(h(m1_6522),sigM1_6521,pkCli_6517) <> true) then
                                        0
                                    else
                                        {8135}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6523: bitstring) = m1_6522 in
                                        {8136}new Ns_6524: bitstring;
                                        {8137}new ST_6525: bitstring;
                                        {8138}new TTL_6526: bitstring;
                                        {8139}let gNs_6527: bitstring = exp(g,Ns_6524) in
                                        {8140}let m2_6528: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6527,ST_6525,TTL_6526) in
                                        {8141}event beginSrv(Sess_5025,Cli_5023,gNs_6527);
                                        {8142}out(c, (enc(m2_6528,pkCli_6517),sign(h(m2_6528),skSess_6068)));
                                        {8143}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8144}event endSrv(Cli_5023,Sess_5025,PartC_6523)
                                )
                                else
                                    {8145}let v_6529: bool = (Disco_5024 = B) in
                                    (
                                        {8146}if v_6529 then
                                        (
                                            {8147}let pkDisco_6530: bitstring = pub(skB) in
                                            {8148}in(c, (=pkCli_6517,em1_6531: bitstring,sigM1_6532: bitstring));
                                            {8149}let m1_6533: bitstring = dec(em1_6531,skSess_6068) in
                                            {8150}if (verify(h(m1_6533),sigM1_6532,pkCli_6517) <> true) then
                                                0
                                            else
                                                {8151}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6534: bitstring) = m1_6533 in
                                                {8152}new Ns_6535: bitstring;
                                                {8153}new ST_6536: bitstring;
                                                {8154}new TTL_6537: bitstring;
                                                {8155}let gNs_6538: bitstring = exp(g,Ns_6535) in
                                                {8156}let m2_6539: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6538,ST_6536,TTL_6537) in
                                                {8157}event beginSrv(Sess_5025,Cli_5023,gNs_6538);
                                                {8158}out(c, (enc(m2_6539,pkCli_6517),sign(h(m2_6539),skSess_6068)));
                                                {8159}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8160}event endSrv(Cli_5023,Sess_5025,PartC_6534)
                                        )
                                        else
                                            {8161}let v_6540: bool = (Disco_5024 = C) in
                                            (
                                                {8162}if v_6540 then
                                                (
                                                    {8163}let pkDisco_6541: bitstring = pub(skC) in
                                                    {8164}in(c, (=pkCli_6517,em1_6542: bitstring,sigM1_6543: bitstring));
                                                    {8165}let m1_6544: bitstring = dec(em1_6542,skSess_6068) in
                                                    {8166}if (verify(h(m1_6544),sigM1_6543,pkCli_6517) <> true) then
                                                        0
                                                    else
                                                        {8167}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6545: bitstring) = m1_6544 in
                                                        {8168}new Ns_6546: bitstring;
                                                        {8169}new ST_6547: bitstring;
                                                        {8170}new TTL_6548: bitstring;
                                                        {8171}let gNs_6549: bitstring = exp(g,Ns_6546) in
                                                        {8172}let m2_6550: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6549,ST_6547,TTL_6548) in
                                                        {8173}event beginSrv(Sess_5025,Cli_5023,gNs_6549);
                                                        {8174}out(c, (enc(m2_6550,pkCli_6517),sign(h(m2_6550),skSess_6068)));
                                                        {8175}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8176}event endSrv(Cli_5023,Sess_5025,PartC_6545)
                                                )
                                                else
                                                    {8177}let pkDisco_6551: bitstring = pub(sk(Disco_5024)) in
                                                    {8178}in(c, (=pkCli_6517,em1_6552: bitstring,sigM1_6553: bitstring));
                                                    {8179}let m1_6554: bitstring = dec(em1_6552,skSess_6068) in
                                                    {8180}if (verify(h(m1_6554),sigM1_6553,pkCli_6517) <> true) then
                                                        0
                                                    else
                                                        {8181}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6555: bitstring) = m1_6554 in
                                                        {8182}new Ns_6556: bitstring;
                                                        {8183}new ST_6557: bitstring;
                                                        {8184}new TTL_6558: bitstring;
                                                        {8185}let gNs_6559: bitstring = exp(g,Ns_6556) in
                                                        {8186}let m2_6560: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6559,ST_6557,TTL_6558) in
                                                        {8187}event beginSrv(Sess_5025,Cli_5023,gNs_6559);
                                                        {8188}out(c, (enc(m2_6560,pkCli_6517),sign(h(m2_6560),skSess_6068)));
                                                        {8189}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8190}event endSrv(Cli_5023,Sess_5025,PartC_6555)
                                            )
                                            else
                                                {8191}let pkDisco_6561: bitstring = fail-any in
                                                {8192}in(c, (=pkCli_6517,em1_6562: bitstring,sigM1_6563: bitstring));
                                                {8193}let m1_6564: bitstring = dec(em1_6562,skSess_6068) in
                                                {8194}if (verify(h(m1_6564),sigM1_6563,pkCli_6517) <> true) then
                                                    0
                                                else
                                                    {8195}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6565: bitstring) = m1_6564 in
                                                    {8196}new Ns_6566: bitstring;
                                                    {8197}new ST_6567: bitstring;
                                                    {8198}new TTL_6568: bitstring;
                                                    {8199}let gNs_6569: bitstring = exp(g,Ns_6566) in
                                                    {8200}let m2_6570: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6569,ST_6567,TTL_6568) in
                                                    {8201}event beginSrv(Sess_5025,Cli_5023,gNs_6569);
                                                    {8202}out(c, (enc(m2_6570,pkCli_6517),sign(h(m2_6570),skSess_6068)));
                                                    {8203}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8204}event endSrv(Cli_5023,Sess_5025,PartC_6565)
                                    )
                                    else
                                        {8205}let pkDisco_6571: bitstring = fail-any in
                                        {8206}in(c, (=pkCli_6517,em1_6572: bitstring,sigM1_6573: bitstring));
                                        {8207}let m1_6574: bitstring = dec(em1_6572,skSess_6068) in
                                        {8208}if (verify(h(m1_6574),sigM1_6573,pkCli_6517) <> true) then
                                            0
                                        else
                                            {8209}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6575: bitstring) = m1_6574 in
                                            {8210}new Ns_6576: bitstring;
                                            {8211}new ST_6577: bitstring;
                                            {8212}new TTL_6578: bitstring;
                                            {8213}let gNs_6579: bitstring = exp(g,Ns_6576) in
                                            {8214}let m2_6580: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6579,ST_6577,TTL_6578) in
                                            {8215}event beginSrv(Sess_5025,Cli_5023,gNs_6579);
                                            {8216}out(c, (enc(m2_6580,pkCli_6517),sign(h(m2_6580),skSess_6068)));
                                            {8217}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8218}event endSrv(Cli_5023,Sess_5025,PartC_6575)
                            )
                            else
                                {8219}let pkDisco_6581: bitstring = fail-any in
                                {8220}in(c, (=pkCli_6517,em1_6582: bitstring,sigM1_6583: bitstring));
                                {8221}let m1_6584: bitstring = dec(em1_6582,skSess_6068) in
                                {8222}if (verify(h(m1_6584),sigM1_6583,pkCli_6517) <> true) then
                                    0
                                else
                                    {8223}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6517,PartC_6585: bitstring) = m1_6584 in
                                    {8224}new Ns_6586: bitstring;
                                    {8225}new ST_6587: bitstring;
                                    {8226}new TTL_6588: bitstring;
                                    {8227}let gNs_6589: bitstring = exp(g,Ns_6586) in
                                    {8228}let m2_6590: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6589,ST_6587,TTL_6588) in
                                    {8229}event beginSrv(Sess_5025,Cli_5023,gNs_6589);
                                    {8230}out(c, (enc(m2_6590,pkCli_6517),sign(h(m2_6590),skSess_6068)));
                                    {8231}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {8232}event endSrv(Cli_5023,Sess_5025,PartC_6585)
                    )
                    else
                        {8233}let skSess_6591: bitstring = fail-any in
                        {8234}let pkSess_6592: bitstring = pub(skSess_6591) in
                        {8235}let v_6593: bool = (Cli_5023 = A) in
                        (
                            {8236}if v_6593 then
                            (
                                {8237}let pkCli_6594: bitstring = pub(skA) in
                                {8238}let v_6595: bool = (Disco_5024 = A) in
                                (
                                    {8239}if v_6595 then
                                    (
                                        {8240}let pkDisco_6596: bitstring = pub(skA) in
                                        {8241}in(c, (=pkCli_6594,em1_6597: bitstring,sigM1_6598: bitstring));
                                        {8242}let m1_6599: bitstring = dec(em1_6597,skSess_6591) in
                                        {8243}if (verify(h(m1_6599),sigM1_6598,pkCli_6594) <> true) then
                                            0
                                        else
                                            {8244}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6600: bitstring) = m1_6599 in
                                            {8245}new Ns_6601: bitstring;
                                            {8246}new ST_6602: bitstring;
                                            {8247}new TTL_6603: bitstring;
                                            {8248}let gNs_6604: bitstring = exp(g,Ns_6601) in
                                            {8249}let m2_6605: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6604,ST_6602,TTL_6603) in
                                            {8250}event beginSrv(Sess_5025,Cli_5023,gNs_6604);
                                            {8251}out(c, (enc(m2_6605,pkCli_6594),sign(h(m2_6605),skSess_6591)));
                                            {8252}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8253}event endSrv(Cli_5023,Sess_5025,PartC_6600)
                                    )
                                    else
                                        {8254}let v_6606: bool = (Disco_5024 = B) in
                                        (
                                            {8255}if v_6606 then
                                            (
                                                {8256}let pkDisco_6607: bitstring = pub(skB) in
                                                {8257}in(c, (=pkCli_6594,em1_6608: bitstring,sigM1_6609: bitstring));
                                                {8258}let m1_6610: bitstring = dec(em1_6608,skSess_6591) in
                                                {8259}if (verify(h(m1_6610),sigM1_6609,pkCli_6594) <> true) then
                                                    0
                                                else
                                                    {8260}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6611: bitstring) = m1_6610 in
                                                    {8261}new Ns_6612: bitstring;
                                                    {8262}new ST_6613: bitstring;
                                                    {8263}new TTL_6614: bitstring;
                                                    {8264}let gNs_6615: bitstring = exp(g,Ns_6612) in
                                                    {8265}let m2_6616: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6615,ST_6613,TTL_6614) in
                                                    {8266}event beginSrv(Sess_5025,Cli_5023,gNs_6615);
                                                    {8267}out(c, (enc(m2_6616,pkCli_6594),sign(h(m2_6616),skSess_6591)));
                                                    {8268}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8269}event endSrv(Cli_5023,Sess_5025,PartC_6611)
                                            )
                                            else
                                                {8270}let v_6617: bool = (Disco_5024 = C) in
                                                (
                                                    {8271}if v_6617 then
                                                    (
                                                        {8272}let pkDisco_6618: bitstring = pub(skC) in
                                                        {8273}in(c, (=pkCli_6594,em1_6619: bitstring,sigM1_6620: bitstring));
                                                        {8274}let m1_6621: bitstring = dec(em1_6619,skSess_6591) in
                                                        {8275}if (verify(h(m1_6621),sigM1_6620,pkCli_6594) <> true) then
                                                            0
                                                        else
                                                            {8276}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6622: bitstring) = m1_6621 in
                                                            {8277}new Ns_6623: bitstring;
                                                            {8278}new ST_6624: bitstring;
                                                            {8279}new TTL_6625: bitstring;
                                                            {8280}let gNs_6626: bitstring = exp(g,Ns_6623) in
                                                            {8281}let m2_6627: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6626,ST_6624,TTL_6625) in
                                                            {8282}event beginSrv(Sess_5025,Cli_5023,gNs_6626);
                                                            {8283}out(c, (enc(m2_6627,pkCli_6594),sign(h(m2_6627),skSess_6591)));
                                                            {8284}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8285}event endSrv(Cli_5023,Sess_5025,PartC_6622)
                                                    )
                                                    else
                                                        {8286}let pkDisco_6628: bitstring = pub(sk(Disco_5024)) in
                                                        {8287}in(c, (=pkCli_6594,em1_6629: bitstring,sigM1_6630: bitstring));
                                                        {8288}let m1_6631: bitstring = dec(em1_6629,skSess_6591) in
                                                        {8289}if (verify(h(m1_6631),sigM1_6630,pkCli_6594) <> true) then
                                                            0
                                                        else
                                                            {8290}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6632: bitstring) = m1_6631 in
                                                            {8291}new Ns_6633: bitstring;
                                                            {8292}new ST_6634: bitstring;
                                                            {8293}new TTL_6635: bitstring;
                                                            {8294}let gNs_6636: bitstring = exp(g,Ns_6633) in
                                                            {8295}let m2_6637: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6636,ST_6634,TTL_6635) in
                                                            {8296}event beginSrv(Sess_5025,Cli_5023,gNs_6636);
                                                            {8297}out(c, (enc(m2_6637,pkCli_6594),sign(h(m2_6637),skSess_6591)));
                                                            {8298}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8299}event endSrv(Cli_5023,Sess_5025,PartC_6632)
                                                )
                                                else
                                                    {8300}let pkDisco_6638: bitstring = fail-any in
                                                    {8301}in(c, (=pkCli_6594,em1_6639: bitstring,sigM1_6640: bitstring));
                                                    {8302}let m1_6641: bitstring = dec(em1_6639,skSess_6591) in
                                                    {8303}if (verify(h(m1_6641),sigM1_6640,pkCli_6594) <> true) then
                                                        0
                                                    else
                                                        {8304}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6642: bitstring) = m1_6641 in
                                                        {8305}new Ns_6643: bitstring;
                                                        {8306}new ST_6644: bitstring;
                                                        {8307}new TTL_6645: bitstring;
                                                        {8308}let gNs_6646: bitstring = exp(g,Ns_6643) in
                                                        {8309}let m2_6647: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6646,ST_6644,TTL_6645) in
                                                        {8310}event beginSrv(Sess_5025,Cli_5023,gNs_6646);
                                                        {8311}out(c, (enc(m2_6647,pkCli_6594),sign(h(m2_6647),skSess_6591)));
                                                        {8312}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8313}event endSrv(Cli_5023,Sess_5025,PartC_6642)
                                        )
                                        else
                                            {8314}let pkDisco_6648: bitstring = fail-any in
                                            {8315}in(c, (=pkCli_6594,em1_6649: bitstring,sigM1_6650: bitstring));
                                            {8316}let m1_6651: bitstring = dec(em1_6649,skSess_6591) in
                                            {8317}if (verify(h(m1_6651),sigM1_6650,pkCli_6594) <> true) then
                                                0
                                            else
                                                {8318}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6652: bitstring) = m1_6651 in
                                                {8319}new Ns_6653: bitstring;
                                                {8320}new ST_6654: bitstring;
                                                {8321}new TTL_6655: bitstring;
                                                {8322}let gNs_6656: bitstring = exp(g,Ns_6653) in
                                                {8323}let m2_6657: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6656,ST_6654,TTL_6655) in
                                                {8324}event beginSrv(Sess_5025,Cli_5023,gNs_6656);
                                                {8325}out(c, (enc(m2_6657,pkCli_6594),sign(h(m2_6657),skSess_6591)));
                                                {8326}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8327}event endSrv(Cli_5023,Sess_5025,PartC_6652)
                                )
                                else
                                    {8328}let pkDisco_6658: bitstring = fail-any in
                                    {8329}in(c, (=pkCli_6594,em1_6659: bitstring,sigM1_6660: bitstring));
                                    {8330}let m1_6661: bitstring = dec(em1_6659,skSess_6591) in
                                    {8331}if (verify(h(m1_6661),sigM1_6660,pkCli_6594) <> true) then
                                        0
                                    else
                                        {8332}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6594,PartC_6662: bitstring) = m1_6661 in
                                        {8333}new Ns_6663: bitstring;
                                        {8334}new ST_6664: bitstring;
                                        {8335}new TTL_6665: bitstring;
                                        {8336}let gNs_6666: bitstring = exp(g,Ns_6663) in
                                        {8337}let m2_6667: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6666,ST_6664,TTL_6665) in
                                        {8338}event beginSrv(Sess_5025,Cli_5023,gNs_6666);
                                        {8339}out(c, (enc(m2_6667,pkCli_6594),sign(h(m2_6667),skSess_6591)));
                                        {8340}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8341}event endSrv(Cli_5023,Sess_5025,PartC_6662)
                            )
                            else
                                {8342}let v_6668: bool = (Cli_5023 = B) in
                                (
                                    {8343}if v_6668 then
                                    (
                                        {8344}let pkCli_6669: bitstring = pub(skB) in
                                        {8345}let v_6670: bool = (Disco_5024 = A) in
                                        (
                                            {8346}if v_6670 then
                                            (
                                                {8347}let pkDisco_6671: bitstring = pub(skA) in
                                                {8348}in(c, (=pkCli_6669,em1_6672: bitstring,sigM1_6673: bitstring));
                                                {8349}let m1_6674: bitstring = dec(em1_6672,skSess_6591) in
                                                {8350}if (verify(h(m1_6674),sigM1_6673,pkCli_6669) <> true) then
                                                    0
                                                else
                                                    {8351}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6675: bitstring) = m1_6674 in
                                                    {8352}new Ns_6676: bitstring;
                                                    {8353}new ST_6677: bitstring;
                                                    {8354}new TTL_6678: bitstring;
                                                    {8355}let gNs_6679: bitstring = exp(g,Ns_6676) in
                                                    {8356}let m2_6680: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6679,ST_6677,TTL_6678) in
                                                    {8357}event beginSrv(Sess_5025,Cli_5023,gNs_6679);
                                                    {8358}out(c, (enc(m2_6680,pkCli_6669),sign(h(m2_6680),skSess_6591)));
                                                    {8359}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8360}event endSrv(Cli_5023,Sess_5025,PartC_6675)
                                            )
                                            else
                                                {8361}let v_6681: bool = (Disco_5024 = B) in
                                                (
                                                    {8362}if v_6681 then
                                                    (
                                                        {8363}let pkDisco_6682: bitstring = pub(skB) in
                                                        {8364}in(c, (=pkCli_6669,em1_6683: bitstring,sigM1_6684: bitstring));
                                                        {8365}let m1_6685: bitstring = dec(em1_6683,skSess_6591) in
                                                        {8366}if (verify(h(m1_6685),sigM1_6684,pkCli_6669) <> true) then
                                                            0
                                                        else
                                                            {8367}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6686: bitstring) = m1_6685 in
                                                            {8368}new Ns_6687: bitstring;
                                                            {8369}new ST_6688: bitstring;
                                                            {8370}new TTL_6689: bitstring;
                                                            {8371}let gNs_6690: bitstring = exp(g,Ns_6687) in
                                                            {8372}let m2_6691: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6690,ST_6688,TTL_6689) in
                                                            {8373}event beginSrv(Sess_5025,Cli_5023,gNs_6690);
                                                            {8374}out(c, (enc(m2_6691,pkCli_6669),sign(h(m2_6691),skSess_6591)));
                                                            {8375}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8376}event endSrv(Cli_5023,Sess_5025,PartC_6686)
                                                    )
                                                    else
                                                        {8377}let v_6692: bool = (Disco_5024 = C) in
                                                        (
                                                            {8378}if v_6692 then
                                                            (
                                                                {8379}let pkDisco_6693: bitstring = pub(skC) in
                                                                {8380}in(c, (=pkCli_6669,em1_6694: bitstring,sigM1_6695: bitstring));
                                                                {8381}let m1_6696: bitstring = dec(em1_6694,skSess_6591) in
                                                                {8382}if (verify(h(m1_6696),sigM1_6695,pkCli_6669) <> true) then
                                                                    0
                                                                else
                                                                    {8383}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6697: bitstring) = m1_6696 in
                                                                    {8384}new Ns_6698: bitstring;
                                                                    {8385}new ST_6699: bitstring;
                                                                    {8386}new TTL_6700: bitstring;
                                                                    {8387}let gNs_6701: bitstring = exp(g,Ns_6698) in
                                                                    {8388}let m2_6702: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6701,ST_6699,TTL_6700) in
                                                                    {8389}event beginSrv(Sess_5025,Cli_5023,gNs_6701);
                                                                    {8390}out(c, (enc(m2_6702,pkCli_6669),sign(h(m2_6702),skSess_6591)));
                                                                    {8391}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8392}event endSrv(Cli_5023,Sess_5025,PartC_6697)
                                                            )
                                                            else
                                                                {8393}let pkDisco_6703: bitstring = pub(sk(Disco_5024)) in
                                                                {8394}in(c, (=pkCli_6669,em1_6704: bitstring,sigM1_6705: bitstring));
                                                                {8395}let m1_6706: bitstring = dec(em1_6704,skSess_6591) in
                                                                {8396}if (verify(h(m1_6706),sigM1_6705,pkCli_6669) <> true) then
                                                                    0
                                                                else
                                                                    {8397}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6707: bitstring) = m1_6706 in
                                                                    {8398}new Ns_6708: bitstring;
                                                                    {8399}new ST_6709: bitstring;
                                                                    {8400}new TTL_6710: bitstring;
                                                                    {8401}let gNs_6711: bitstring = exp(g,Ns_6708) in
                                                                    {8402}let m2_6712: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6711,ST_6709,TTL_6710) in
                                                                    {8403}event beginSrv(Sess_5025,Cli_5023,gNs_6711);
                                                                    {8404}out(c, (enc(m2_6712,pkCli_6669),sign(h(m2_6712),skSess_6591)));
                                                                    {8405}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8406}event endSrv(Cli_5023,Sess_5025,PartC_6707)
                                                        )
                                                        else
                                                            {8407}let pkDisco_6713: bitstring = fail-any in
                                                            {8408}in(c, (=pkCli_6669,em1_6714: bitstring,sigM1_6715: bitstring));
                                                            {8409}let m1_6716: bitstring = dec(em1_6714,skSess_6591) in
                                                            {8410}if (verify(h(m1_6716),sigM1_6715,pkCli_6669) <> true) then
                                                                0
                                                            else
                                                                {8411}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6717: bitstring) = m1_6716 in
                                                                {8412}new Ns_6718: bitstring;
                                                                {8413}new ST_6719: bitstring;
                                                                {8414}new TTL_6720: bitstring;
                                                                {8415}let gNs_6721: bitstring = exp(g,Ns_6718) in
                                                                {8416}let m2_6722: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6721,ST_6719,TTL_6720) in
                                                                {8417}event beginSrv(Sess_5025,Cli_5023,gNs_6721);
                                                                {8418}out(c, (enc(m2_6722,pkCli_6669),sign(h(m2_6722),skSess_6591)));
                                                                {8419}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8420}event endSrv(Cli_5023,Sess_5025,PartC_6717)
                                                )
                                                else
                                                    {8421}let pkDisco_6723: bitstring = fail-any in
                                                    {8422}in(c, (=pkCli_6669,em1_6724: bitstring,sigM1_6725: bitstring));
                                                    {8423}let m1_6726: bitstring = dec(em1_6724,skSess_6591) in
                                                    {8424}if (verify(h(m1_6726),sigM1_6725,pkCli_6669) <> true) then
                                                        0
                                                    else
                                                        {8425}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6727: bitstring) = m1_6726 in
                                                        {8426}new Ns_6728: bitstring;
                                                        {8427}new ST_6729: bitstring;
                                                        {8428}new TTL_6730: bitstring;
                                                        {8429}let gNs_6731: bitstring = exp(g,Ns_6728) in
                                                        {8430}let m2_6732: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6731,ST_6729,TTL_6730) in
                                                        {8431}event beginSrv(Sess_5025,Cli_5023,gNs_6731);
                                                        {8432}out(c, (enc(m2_6732,pkCli_6669),sign(h(m2_6732),skSess_6591)));
                                                        {8433}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8434}event endSrv(Cli_5023,Sess_5025,PartC_6727)
                                        )
                                        else
                                            {8435}let pkDisco_6733: bitstring = fail-any in
                                            {8436}in(c, (=pkCli_6669,em1_6734: bitstring,sigM1_6735: bitstring));
                                            {8437}let m1_6736: bitstring = dec(em1_6734,skSess_6591) in
                                            {8438}if (verify(h(m1_6736),sigM1_6735,pkCli_6669) <> true) then
                                                0
                                            else
                                                {8439}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6669,PartC_6737: bitstring) = m1_6736 in
                                                {8440}new Ns_6738: bitstring;
                                                {8441}new ST_6739: bitstring;
                                                {8442}new TTL_6740: bitstring;
                                                {8443}let gNs_6741: bitstring = exp(g,Ns_6738) in
                                                {8444}let m2_6742: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6741,ST_6739,TTL_6740) in
                                                {8445}event beginSrv(Sess_5025,Cli_5023,gNs_6741);
                                                {8446}out(c, (enc(m2_6742,pkCli_6669),sign(h(m2_6742),skSess_6591)));
                                                {8447}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8448}event endSrv(Cli_5023,Sess_5025,PartC_6737)
                                    )
                                    else
                                        {8449}let v_6743: bool = (Cli_5023 = C) in
                                        (
                                            {8450}if v_6743 then
                                            (
                                                {8451}let pkCli_6744: bitstring = pub(skC) in
                                                {8452}let v_6745: bool = (Disco_5024 = A) in
                                                (
                                                    {8453}if v_6745 then
                                                    (
                                                        {8454}let pkDisco_6746: bitstring = pub(skA) in
                                                        {8455}in(c, (=pkCli_6744,em1_6747: bitstring,sigM1_6748: bitstring));
                                                        {8456}let m1_6749: bitstring = dec(em1_6747,skSess_6591) in
                                                        {8457}if (verify(h(m1_6749),sigM1_6748,pkCli_6744) <> true) then
                                                            0
                                                        else
                                                            {8458}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6750: bitstring) = m1_6749 in
                                                            {8459}new Ns_6751: bitstring;
                                                            {8460}new ST_6752: bitstring;
                                                            {8461}new TTL_6753: bitstring;
                                                            {8462}let gNs_6754: bitstring = exp(g,Ns_6751) in
                                                            {8463}let m2_6755: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6754,ST_6752,TTL_6753) in
                                                            {8464}event beginSrv(Sess_5025,Cli_5023,gNs_6754);
                                                            {8465}out(c, (enc(m2_6755,pkCli_6744),sign(h(m2_6755),skSess_6591)));
                                                            {8466}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8467}event endSrv(Cli_5023,Sess_5025,PartC_6750)
                                                    )
                                                    else
                                                        {8468}let v_6756: bool = (Disco_5024 = B) in
                                                        (
                                                            {8469}if v_6756 then
                                                            (
                                                                {8470}let pkDisco_6757: bitstring = pub(skB) in
                                                                {8471}in(c, (=pkCli_6744,em1_6758: bitstring,sigM1_6759: bitstring));
                                                                {8472}let m1_6760: bitstring = dec(em1_6758,skSess_6591) in
                                                                {8473}if (verify(h(m1_6760),sigM1_6759,pkCli_6744) <> true) then
                                                                    0
                                                                else
                                                                    {8474}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6761: bitstring) = m1_6760 in
                                                                    {8475}new Ns_6762: bitstring;
                                                                    {8476}new ST_6763: bitstring;
                                                                    {8477}new TTL_6764: bitstring;
                                                                    {8478}let gNs_6765: bitstring = exp(g,Ns_6762) in
                                                                    {8479}let m2_6766: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6765,ST_6763,TTL_6764) in
                                                                    {8480}event beginSrv(Sess_5025,Cli_5023,gNs_6765);
                                                                    {8481}out(c, (enc(m2_6766,pkCli_6744),sign(h(m2_6766),skSess_6591)));
                                                                    {8482}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8483}event endSrv(Cli_5023,Sess_5025,PartC_6761)
                                                            )
                                                            else
                                                                {8484}let v_6767: bool = (Disco_5024 = C) in
                                                                (
                                                                    {8485}if v_6767 then
                                                                    (
                                                                        {8486}let pkDisco_6768: bitstring = pub(skC) in
                                                                        {8487}in(c, (=pkCli_6744,em1_6769: bitstring,sigM1_6770: bitstring));
                                                                        {8488}let m1_6771: bitstring = dec(em1_6769,skSess_6591) in
                                                                        {8489}if (verify(h(m1_6771),sigM1_6770,pkCli_6744) <> true) then
                                                                            0
                                                                        else
                                                                            {8490}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6772: bitstring) = m1_6771 in
                                                                            {8491}new Ns_6773: bitstring;
                                                                            {8492}new ST_6774: bitstring;
                                                                            {8493}new TTL_6775: bitstring;
                                                                            {8494}let gNs_6776: bitstring = exp(g,Ns_6773) in
                                                                            {8495}let m2_6777: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6776,ST_6774,TTL_6775) in
                                                                            {8496}event beginSrv(Sess_5025,Cli_5023,gNs_6776);
                                                                            {8497}out(c, (enc(m2_6777,pkCli_6744),sign(h(m2_6777),skSess_6591)));
                                                                            {8498}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8499}event endSrv(Cli_5023,Sess_5025,PartC_6772)
                                                                    )
                                                                    else
                                                                        {8500}let pkDisco_6778: bitstring = pub(sk(Disco_5024)) in
                                                                        {8501}in(c, (=pkCli_6744,em1_6779: bitstring,sigM1_6780: bitstring));
                                                                        {8502}let m1_6781: bitstring = dec(em1_6779,skSess_6591) in
                                                                        {8503}if (verify(h(m1_6781),sigM1_6780,pkCli_6744) <> true) then
                                                                            0
                                                                        else
                                                                            {8504}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6782: bitstring) = m1_6781 in
                                                                            {8505}new Ns_6783: bitstring;
                                                                            {8506}new ST_6784: bitstring;
                                                                            {8507}new TTL_6785: bitstring;
                                                                            {8508}let gNs_6786: bitstring = exp(g,Ns_6783) in
                                                                            {8509}let m2_6787: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6786,ST_6784,TTL_6785) in
                                                                            {8510}event beginSrv(Sess_5025,Cli_5023,gNs_6786);
                                                                            {8511}out(c, (enc(m2_6787,pkCli_6744),sign(h(m2_6787),skSess_6591)));
                                                                            {8512}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8513}event endSrv(Cli_5023,Sess_5025,PartC_6782)
                                                                )
                                                                else
                                                                    {8514}let pkDisco_6788: bitstring = fail-any in
                                                                    {8515}in(c, (=pkCli_6744,em1_6789: bitstring,sigM1_6790: bitstring));
                                                                    {8516}let m1_6791: bitstring = dec(em1_6789,skSess_6591) in
                                                                    {8517}if (verify(h(m1_6791),sigM1_6790,pkCli_6744) <> true) then
                                                                        0
                                                                    else
                                                                        {8518}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6792: bitstring) = m1_6791 in
                                                                        {8519}new Ns_6793: bitstring;
                                                                        {8520}new ST_6794: bitstring;
                                                                        {8521}new TTL_6795: bitstring;
                                                                        {8522}let gNs_6796: bitstring = exp(g,Ns_6793) in
                                                                        {8523}let m2_6797: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6796,ST_6794,TTL_6795) in
                                                                        {8524}event beginSrv(Sess_5025,Cli_5023,gNs_6796);
                                                                        {8525}out(c, (enc(m2_6797,pkCli_6744),sign(h(m2_6797),skSess_6591)));
                                                                        {8526}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8527}event endSrv(Cli_5023,Sess_5025,PartC_6792)
                                                        )
                                                        else
                                                            {8528}let pkDisco_6798: bitstring = fail-any in
                                                            {8529}in(c, (=pkCli_6744,em1_6799: bitstring,sigM1_6800: bitstring));
                                                            {8530}let m1_6801: bitstring = dec(em1_6799,skSess_6591) in
                                                            {8531}if (verify(h(m1_6801),sigM1_6800,pkCli_6744) <> true) then
                                                                0
                                                            else
                                                                {8532}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6802: bitstring) = m1_6801 in
                                                                {8533}new Ns_6803: bitstring;
                                                                {8534}new ST_6804: bitstring;
                                                                {8535}new TTL_6805: bitstring;
                                                                {8536}let gNs_6806: bitstring = exp(g,Ns_6803) in
                                                                {8537}let m2_6807: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6806,ST_6804,TTL_6805) in
                                                                {8538}event beginSrv(Sess_5025,Cli_5023,gNs_6806);
                                                                {8539}out(c, (enc(m2_6807,pkCli_6744),sign(h(m2_6807),skSess_6591)));
                                                                {8540}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8541}event endSrv(Cli_5023,Sess_5025,PartC_6802)
                                                )
                                                else
                                                    {8542}let pkDisco_6808: bitstring = fail-any in
                                                    {8543}in(c, (=pkCli_6744,em1_6809: bitstring,sigM1_6810: bitstring));
                                                    {8544}let m1_6811: bitstring = dec(em1_6809,skSess_6591) in
                                                    {8545}if (verify(h(m1_6811),sigM1_6810,pkCli_6744) <> true) then
                                                        0
                                                    else
                                                        {8546}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6744,PartC_6812: bitstring) = m1_6811 in
                                                        {8547}new Ns_6813: bitstring;
                                                        {8548}new ST_6814: bitstring;
                                                        {8549}new TTL_6815: bitstring;
                                                        {8550}let gNs_6816: bitstring = exp(g,Ns_6813) in
                                                        {8551}let m2_6817: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6816,ST_6814,TTL_6815) in
                                                        {8552}event beginSrv(Sess_5025,Cli_5023,gNs_6816);
                                                        {8553}out(c, (enc(m2_6817,pkCli_6744),sign(h(m2_6817),skSess_6591)));
                                                        {8554}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8555}event endSrv(Cli_5023,Sess_5025,PartC_6812)
                                            )
                                            else
                                                {8556}let pkCli_6818: bitstring = pub(sk(Cli_5023)) in
                                                {8557}let v_6819: bool = (Disco_5024 = A) in
                                                (
                                                    {8558}if v_6819 then
                                                    (
                                                        {8559}let pkDisco_6820: bitstring = pub(skA) in
                                                        {8560}in(c, (=pkCli_6818,em1_6821: bitstring,sigM1_6822: bitstring));
                                                        {8561}let m1_6823: bitstring = dec(em1_6821,skSess_6591) in
                                                        {8562}if (verify(h(m1_6823),sigM1_6822,pkCli_6818) <> true) then
                                                            0
                                                        else
                                                            {8563}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6824: bitstring) = m1_6823 in
                                                            {8564}new Ns_6825: bitstring;
                                                            {8565}new ST_6826: bitstring;
                                                            {8566}new TTL_6827: bitstring;
                                                            {8567}let gNs_6828: bitstring = exp(g,Ns_6825) in
                                                            {8568}let m2_6829: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6828,ST_6826,TTL_6827) in
                                                            {8569}event beginSrv(Sess_5025,Cli_5023,gNs_6828);
                                                            {8570}out(c, (enc(m2_6829,pkCli_6818),sign(h(m2_6829),skSess_6591)));
                                                            {8571}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8572}event endSrv(Cli_5023,Sess_5025,PartC_6824)
                                                    )
                                                    else
                                                        {8573}let v_6830: bool = (Disco_5024 = B) in
                                                        (
                                                            {8574}if v_6830 then
                                                            (
                                                                {8575}let pkDisco_6831: bitstring = pub(skB) in
                                                                {8576}in(c, (=pkCli_6818,em1_6832: bitstring,sigM1_6833: bitstring));
                                                                {8577}let m1_6834: bitstring = dec(em1_6832,skSess_6591) in
                                                                {8578}if (verify(h(m1_6834),sigM1_6833,pkCli_6818) <> true) then
                                                                    0
                                                                else
                                                                    {8579}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6835: bitstring) = m1_6834 in
                                                                    {8580}new Ns_6836: bitstring;
                                                                    {8581}new ST_6837: bitstring;
                                                                    {8582}new TTL_6838: bitstring;
                                                                    {8583}let gNs_6839: bitstring = exp(g,Ns_6836) in
                                                                    {8584}let m2_6840: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6839,ST_6837,TTL_6838) in
                                                                    {8585}event beginSrv(Sess_5025,Cli_5023,gNs_6839);
                                                                    {8586}out(c, (enc(m2_6840,pkCli_6818),sign(h(m2_6840),skSess_6591)));
                                                                    {8587}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8588}event endSrv(Cli_5023,Sess_5025,PartC_6835)
                                                            )
                                                            else
                                                                {8589}let v_6841: bool = (Disco_5024 = C) in
                                                                (
                                                                    {8590}if v_6841 then
                                                                    (
                                                                        {8591}let pkDisco_6842: bitstring = pub(skC) in
                                                                        {8592}in(c, (=pkCli_6818,em1_6843: bitstring,sigM1_6844: bitstring));
                                                                        {8593}let m1_6845: bitstring = dec(em1_6843,skSess_6591) in
                                                                        {8594}if (verify(h(m1_6845),sigM1_6844,pkCli_6818) <> true) then
                                                                            0
                                                                        else
                                                                            {8595}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6846: bitstring) = m1_6845 in
                                                                            {8596}new Ns_6847: bitstring;
                                                                            {8597}new ST_6848: bitstring;
                                                                            {8598}new TTL_6849: bitstring;
                                                                            {8599}let gNs_6850: bitstring = exp(g,Ns_6847) in
                                                                            {8600}let m2_6851: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6850,ST_6848,TTL_6849) in
                                                                            {8601}event beginSrv(Sess_5025,Cli_5023,gNs_6850);
                                                                            {8602}out(c, (enc(m2_6851,pkCli_6818),sign(h(m2_6851),skSess_6591)));
                                                                            {8603}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8604}event endSrv(Cli_5023,Sess_5025,PartC_6846)
                                                                    )
                                                                    else
                                                                        {8605}let pkDisco_6852: bitstring = pub(sk(Disco_5024)) in
                                                                        {8606}in(c, (=pkCli_6818,em1_6853: bitstring,sigM1_6854: bitstring));
                                                                        {8607}let m1_6855: bitstring = dec(em1_6853,skSess_6591) in
                                                                        {8608}if (verify(h(m1_6855),sigM1_6854,pkCli_6818) <> true) then
                                                                            0
                                                                        else
                                                                            {8609}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6856: bitstring) = m1_6855 in
                                                                            {8610}new Ns_6857: bitstring;
                                                                            {8611}new ST_6858: bitstring;
                                                                            {8612}new TTL_6859: bitstring;
                                                                            {8613}let gNs_6860: bitstring = exp(g,Ns_6857) in
                                                                            {8614}let m2_6861: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6860,ST_6858,TTL_6859) in
                                                                            {8615}event beginSrv(Sess_5025,Cli_5023,gNs_6860);
                                                                            {8616}out(c, (enc(m2_6861,pkCli_6818),sign(h(m2_6861),skSess_6591)));
                                                                            {8617}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                            {8618}event endSrv(Cli_5023,Sess_5025,PartC_6856)
                                                                )
                                                                else
                                                                    {8619}let pkDisco_6862: bitstring = fail-any in
                                                                    {8620}in(c, (=pkCli_6818,em1_6863: bitstring,sigM1_6864: bitstring));
                                                                    {8621}let m1_6865: bitstring = dec(em1_6863,skSess_6591) in
                                                                    {8622}if (verify(h(m1_6865),sigM1_6864,pkCli_6818) <> true) then
                                                                        0
                                                                    else
                                                                        {8623}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6866: bitstring) = m1_6865 in
                                                                        {8624}new Ns_6867: bitstring;
                                                                        {8625}new ST_6868: bitstring;
                                                                        {8626}new TTL_6869: bitstring;
                                                                        {8627}let gNs_6870: bitstring = exp(g,Ns_6867) in
                                                                        {8628}let m2_6871: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6870,ST_6868,TTL_6869) in
                                                                        {8629}event beginSrv(Sess_5025,Cli_5023,gNs_6870);
                                                                        {8630}out(c, (enc(m2_6871,pkCli_6818),sign(h(m2_6871),skSess_6591)));
                                                                        {8631}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8632}event endSrv(Cli_5023,Sess_5025,PartC_6866)
                                                        )
                                                        else
                                                            {8633}let pkDisco_6872: bitstring = fail-any in
                                                            {8634}in(c, (=pkCli_6818,em1_6873: bitstring,sigM1_6874: bitstring));
                                                            {8635}let m1_6875: bitstring = dec(em1_6873,skSess_6591) in
                                                            {8636}if (verify(h(m1_6875),sigM1_6874,pkCli_6818) <> true) then
                                                                0
                                                            else
                                                                {8637}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6876: bitstring) = m1_6875 in
                                                                {8638}new Ns_6877: bitstring;
                                                                {8639}new ST_6878: bitstring;
                                                                {8640}new TTL_6879: bitstring;
                                                                {8641}let gNs_6880: bitstring = exp(g,Ns_6877) in
                                                                {8642}let m2_6881: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6880,ST_6878,TTL_6879) in
                                                                {8643}event beginSrv(Sess_5025,Cli_5023,gNs_6880);
                                                                {8644}out(c, (enc(m2_6881,pkCli_6818),sign(h(m2_6881),skSess_6591)));
                                                                {8645}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8646}event endSrv(Cli_5023,Sess_5025,PartC_6876)
                                                )
                                                else
                                                    {8647}let pkDisco_6882: bitstring = fail-any in
                                                    {8648}in(c, (=pkCli_6818,em1_6883: bitstring,sigM1_6884: bitstring));
                                                    {8649}let m1_6885: bitstring = dec(em1_6883,skSess_6591) in
                                                    {8650}if (verify(h(m1_6885),sigM1_6884,pkCli_6818) <> true) then
                                                        0
                                                    else
                                                        {8651}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6818,PartC_6886: bitstring) = m1_6885 in
                                                        {8652}new Ns_6887: bitstring;
                                                        {8653}new ST_6888: bitstring;
                                                        {8654}new TTL_6889: bitstring;
                                                        {8655}let gNs_6890: bitstring = exp(g,Ns_6887) in
                                                        {8656}let m2_6891: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6890,ST_6888,TTL_6889) in
                                                        {8657}event beginSrv(Sess_5025,Cli_5023,gNs_6890);
                                                        {8658}out(c, (enc(m2_6891,pkCli_6818),sign(h(m2_6891),skSess_6591)));
                                                        {8659}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8660}event endSrv(Cli_5023,Sess_5025,PartC_6886)
                                        )
                                        else
                                            {8661}let pkCli_6892: bitstring = fail-any in
                                            {8662}let v_6893: bool = (Disco_5024 = A) in
                                            (
                                                {8663}if v_6893 then
                                                (
                                                    {8664}let pkDisco_6894: bitstring = pub(skA) in
                                                    {8665}in(c, (=pkCli_6892,em1_6895: bitstring,sigM1_6896: bitstring));
                                                    {8666}let m1_6897: bitstring = dec(em1_6895,skSess_6591) in
                                                    {8667}if (verify(h(m1_6897),sigM1_6896,pkCli_6892) <> true) then
                                                        0
                                                    else
                                                        {8668}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6898: bitstring) = m1_6897 in
                                                        {8669}new Ns_6899: bitstring;
                                                        {8670}new ST_6900: bitstring;
                                                        {8671}new TTL_6901: bitstring;
                                                        {8672}let gNs_6902: bitstring = exp(g,Ns_6899) in
                                                        {8673}let m2_6903: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6902,ST_6900,TTL_6901) in
                                                        {8674}event beginSrv(Sess_5025,Cli_5023,gNs_6902);
                                                        {8675}out(c, (enc(m2_6903,pkCli_6892),sign(h(m2_6903),skSess_6591)));
                                                        {8676}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8677}event endSrv(Cli_5023,Sess_5025,PartC_6898)
                                                )
                                                else
                                                    {8678}let v_6904: bool = (Disco_5024 = B) in
                                                    (
                                                        {8679}if v_6904 then
                                                        (
                                                            {8680}let pkDisco_6905: bitstring = pub(skB) in
                                                            {8681}in(c, (=pkCli_6892,em1_6906: bitstring,sigM1_6907: bitstring));
                                                            {8682}let m1_6908: bitstring = dec(em1_6906,skSess_6591) in
                                                            {8683}if (verify(h(m1_6908),sigM1_6907,pkCli_6892) <> true) then
                                                                0
                                                            else
                                                                {8684}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6909: bitstring) = m1_6908 in
                                                                {8685}new Ns_6910: bitstring;
                                                                {8686}new ST_6911: bitstring;
                                                                {8687}new TTL_6912: bitstring;
                                                                {8688}let gNs_6913: bitstring = exp(g,Ns_6910) in
                                                                {8689}let m2_6914: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6913,ST_6911,TTL_6912) in
                                                                {8690}event beginSrv(Sess_5025,Cli_5023,gNs_6913);
                                                                {8691}out(c, (enc(m2_6914,pkCli_6892),sign(h(m2_6914),skSess_6591)));
                                                                {8692}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8693}event endSrv(Cli_5023,Sess_5025,PartC_6909)
                                                        )
                                                        else
                                                            {8694}let v_6915: bool = (Disco_5024 = C) in
                                                            (
                                                                {8695}if v_6915 then
                                                                (
                                                                    {8696}let pkDisco_6916: bitstring = pub(skC) in
                                                                    {8697}in(c, (=pkCli_6892,em1_6917: bitstring,sigM1_6918: bitstring));
                                                                    {8698}let m1_6919: bitstring = dec(em1_6917,skSess_6591) in
                                                                    {8699}if (verify(h(m1_6919),sigM1_6918,pkCli_6892) <> true) then
                                                                        0
                                                                    else
                                                                        {8700}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6920: bitstring) = m1_6919 in
                                                                        {8701}new Ns_6921: bitstring;
                                                                        {8702}new ST_6922: bitstring;
                                                                        {8703}new TTL_6923: bitstring;
                                                                        {8704}let gNs_6924: bitstring = exp(g,Ns_6921) in
                                                                        {8705}let m2_6925: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6924,ST_6922,TTL_6923) in
                                                                        {8706}event beginSrv(Sess_5025,Cli_5023,gNs_6924);
                                                                        {8707}out(c, (enc(m2_6925,pkCli_6892),sign(h(m2_6925),skSess_6591)));
                                                                        {8708}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8709}event endSrv(Cli_5023,Sess_5025,PartC_6920)
                                                                )
                                                                else
                                                                    {8710}let pkDisco_6926: bitstring = pub(sk(Disco_5024)) in
                                                                    {8711}in(c, (=pkCli_6892,em1_6927: bitstring,sigM1_6928: bitstring));
                                                                    {8712}let m1_6929: bitstring = dec(em1_6927,skSess_6591) in
                                                                    {8713}if (verify(h(m1_6929),sigM1_6928,pkCli_6892) <> true) then
                                                                        0
                                                                    else
                                                                        {8714}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6930: bitstring) = m1_6929 in
                                                                        {8715}new Ns_6931: bitstring;
                                                                        {8716}new ST_6932: bitstring;
                                                                        {8717}new TTL_6933: bitstring;
                                                                        {8718}let gNs_6934: bitstring = exp(g,Ns_6931) in
                                                                        {8719}let m2_6935: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6934,ST_6932,TTL_6933) in
                                                                        {8720}event beginSrv(Sess_5025,Cli_5023,gNs_6934);
                                                                        {8721}out(c, (enc(m2_6935,pkCli_6892),sign(h(m2_6935),skSess_6591)));
                                                                        {8722}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                        {8723}event endSrv(Cli_5023,Sess_5025,PartC_6930)
                                                            )
                                                            else
                                                                {8724}let pkDisco_6936: bitstring = fail-any in
                                                                {8725}in(c, (=pkCli_6892,em1_6937: bitstring,sigM1_6938: bitstring));
                                                                {8726}let m1_6939: bitstring = dec(em1_6937,skSess_6591) in
                                                                {8727}if (verify(h(m1_6939),sigM1_6938,pkCli_6892) <> true) then
                                                                    0
                                                                else
                                                                    {8728}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6940: bitstring) = m1_6939 in
                                                                    {8729}new Ns_6941: bitstring;
                                                                    {8730}new ST_6942: bitstring;
                                                                    {8731}new TTL_6943: bitstring;
                                                                    {8732}let gNs_6944: bitstring = exp(g,Ns_6941) in
                                                                    {8733}let m2_6945: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6944,ST_6942,TTL_6943) in
                                                                    {8734}event beginSrv(Sess_5025,Cli_5023,gNs_6944);
                                                                    {8735}out(c, (enc(m2_6945,pkCli_6892),sign(h(m2_6945),skSess_6591)));
                                                                    {8736}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {8737}event endSrv(Cli_5023,Sess_5025,PartC_6940)
                                                    )
                                                    else
                                                        {8738}let pkDisco_6946: bitstring = fail-any in
                                                        {8739}in(c, (=pkCli_6892,em1_6947: bitstring,sigM1_6948: bitstring));
                                                        {8740}let m1_6949: bitstring = dec(em1_6947,skSess_6591) in
                                                        {8741}if (verify(h(m1_6949),sigM1_6948,pkCli_6892) <> true) then
                                                            0
                                                        else
                                                            {8742}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6950: bitstring) = m1_6949 in
                                                            {8743}new Ns_6951: bitstring;
                                                            {8744}new ST_6952: bitstring;
                                                            {8745}new TTL_6953: bitstring;
                                                            {8746}let gNs_6954: bitstring = exp(g,Ns_6951) in
                                                            {8747}let m2_6955: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6954,ST_6952,TTL_6953) in
                                                            {8748}event beginSrv(Sess_5025,Cli_5023,gNs_6954);
                                                            {8749}out(c, (enc(m2_6955,pkCli_6892),sign(h(m2_6955),skSess_6591)));
                                                            {8750}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8751}event endSrv(Cli_5023,Sess_5025,PartC_6950)
                                            )
                                            else
                                                {8752}let pkDisco_6956: bitstring = fail-any in
                                                {8753}in(c, (=pkCli_6892,em1_6957: bitstring,sigM1_6958: bitstring));
                                                {8754}let m1_6959: bitstring = dec(em1_6957,skSess_6591) in
                                                {8755}if (verify(h(m1_6959),sigM1_6958,pkCli_6892) <> true) then
                                                    0
                                                else
                                                    {8756}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6892,PartC_6960: bitstring) = m1_6959 in
                                                    {8757}new Ns_6961: bitstring;
                                                    {8758}new ST_6962: bitstring;
                                                    {8759}new TTL_6963: bitstring;
                                                    {8760}let gNs_6964: bitstring = exp(g,Ns_6961) in
                                                    {8761}let m2_6965: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6964,ST_6962,TTL_6963) in
                                                    {8762}event beginSrv(Sess_5025,Cli_5023,gNs_6964);
                                                    {8763}out(c, (enc(m2_6965,pkCli_6892),sign(h(m2_6965),skSess_6591)));
                                                    {8764}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8765}event endSrv(Cli_5023,Sess_5025,PartC_6960)
                                )
                                else
                                    {8766}let pkCli_6966: bitstring = fail-any in
                                    {8767}let v_6967: bool = (Disco_5024 = A) in
                                    (
                                        {8768}if v_6967 then
                                        (
                                            {8769}let pkDisco_6968: bitstring = pub(skA) in
                                            {8770}in(c, (=pkCli_6966,em1_6969: bitstring,sigM1_6970: bitstring));
                                            {8771}let m1_6971: bitstring = dec(em1_6969,skSess_6591) in
                                            {8772}if (verify(h(m1_6971),sigM1_6970,pkCli_6966) <> true) then
                                                0
                                            else
                                                {8773}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_6972: bitstring) = m1_6971 in
                                                {8774}new Ns_6973: bitstring;
                                                {8775}new ST_6974: bitstring;
                                                {8776}new TTL_6975: bitstring;
                                                {8777}let gNs_6976: bitstring = exp(g,Ns_6973) in
                                                {8778}let m2_6977: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6976,ST_6974,TTL_6975) in
                                                {8779}event beginSrv(Sess_5025,Cli_5023,gNs_6976);
                                                {8780}out(c, (enc(m2_6977,pkCli_6966),sign(h(m2_6977),skSess_6591)));
                                                {8781}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8782}event endSrv(Cli_5023,Sess_5025,PartC_6972)
                                        )
                                        else
                                            {8783}let v_6978: bool = (Disco_5024 = B) in
                                            (
                                                {8784}if v_6978 then
                                                (
                                                    {8785}let pkDisco_6979: bitstring = pub(skB) in
                                                    {8786}in(c, (=pkCli_6966,em1_6980: bitstring,sigM1_6981: bitstring));
                                                    {8787}let m1_6982: bitstring = dec(em1_6980,skSess_6591) in
                                                    {8788}if (verify(h(m1_6982),sigM1_6981,pkCli_6966) <> true) then
                                                        0
                                                    else
                                                        {8789}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_6983: bitstring) = m1_6982 in
                                                        {8790}new Ns_6984: bitstring;
                                                        {8791}new ST_6985: bitstring;
                                                        {8792}new TTL_6986: bitstring;
                                                        {8793}let gNs_6987: bitstring = exp(g,Ns_6984) in
                                                        {8794}let m2_6988: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6987,ST_6985,TTL_6986) in
                                                        {8795}event beginSrv(Sess_5025,Cli_5023,gNs_6987);
                                                        {8796}out(c, (enc(m2_6988,pkCli_6966),sign(h(m2_6988),skSess_6591)));
                                                        {8797}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8798}event endSrv(Cli_5023,Sess_5025,PartC_6983)
                                                )
                                                else
                                                    {8799}let v_6989: bool = (Disco_5024 = C) in
                                                    (
                                                        {8800}if v_6989 then
                                                        (
                                                            {8801}let pkDisco_6990: bitstring = pub(skC) in
                                                            {8802}in(c, (=pkCli_6966,em1_6991: bitstring,sigM1_6992: bitstring));
                                                            {8803}let m1_6993: bitstring = dec(em1_6991,skSess_6591) in
                                                            {8804}if (verify(h(m1_6993),sigM1_6992,pkCli_6966) <> true) then
                                                                0
                                                            else
                                                                {8805}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_6994: bitstring) = m1_6993 in
                                                                {8806}new Ns_6995: bitstring;
                                                                {8807}new ST_6996: bitstring;
                                                                {8808}new TTL_6997: bitstring;
                                                                {8809}let gNs_6998: bitstring = exp(g,Ns_6995) in
                                                                {8810}let m2_6999: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_6998,ST_6996,TTL_6997) in
                                                                {8811}event beginSrv(Sess_5025,Cli_5023,gNs_6998);
                                                                {8812}out(c, (enc(m2_6999,pkCli_6966),sign(h(m2_6999),skSess_6591)));
                                                                {8813}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8814}event endSrv(Cli_5023,Sess_5025,PartC_6994)
                                                        )
                                                        else
                                                            {8815}let pkDisco_7000: bitstring = pub(sk(Disco_5024)) in
                                                            {8816}in(c, (=pkCli_6966,em1_7001: bitstring,sigM1_7002: bitstring));
                                                            {8817}let m1_7003: bitstring = dec(em1_7001,skSess_6591) in
                                                            {8818}if (verify(h(m1_7003),sigM1_7002,pkCli_6966) <> true) then
                                                                0
                                                            else
                                                                {8819}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_7004: bitstring) = m1_7003 in
                                                                {8820}new Ns_7005: bitstring;
                                                                {8821}new ST_7006: bitstring;
                                                                {8822}new TTL_7007: bitstring;
                                                                {8823}let gNs_7008: bitstring = exp(g,Ns_7005) in
                                                                {8824}let m2_7009: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7008,ST_7006,TTL_7007) in
                                                                {8825}event beginSrv(Sess_5025,Cli_5023,gNs_7008);
                                                                {8826}out(c, (enc(m2_7009,pkCli_6966),sign(h(m2_7009),skSess_6591)));
                                                                {8827}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {8828}event endSrv(Cli_5023,Sess_5025,PartC_7004)
                                                    )
                                                    else
                                                        {8829}let pkDisco_7010: bitstring = fail-any in
                                                        {8830}in(c, (=pkCli_6966,em1_7011: bitstring,sigM1_7012: bitstring));
                                                        {8831}let m1_7013: bitstring = dec(em1_7011,skSess_6591) in
                                                        {8832}if (verify(h(m1_7013),sigM1_7012,pkCli_6966) <> true) then
                                                            0
                                                        else
                                                            {8833}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_7014: bitstring) = m1_7013 in
                                                            {8834}new Ns_7015: bitstring;
                                                            {8835}new ST_7016: bitstring;
                                                            {8836}new TTL_7017: bitstring;
                                                            {8837}let gNs_7018: bitstring = exp(g,Ns_7015) in
                                                            {8838}let m2_7019: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7018,ST_7016,TTL_7017) in
                                                            {8839}event beginSrv(Sess_5025,Cli_5023,gNs_7018);
                                                            {8840}out(c, (enc(m2_7019,pkCli_6966),sign(h(m2_7019),skSess_6591)));
                                                            {8841}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {8842}event endSrv(Cli_5023,Sess_5025,PartC_7014)
                                            )
                                            else
                                                {8843}let pkDisco_7020: bitstring = fail-any in
                                                {8844}in(c, (=pkCli_6966,em1_7021: bitstring,sigM1_7022: bitstring));
                                                {8845}let m1_7023: bitstring = dec(em1_7021,skSess_6591) in
                                                {8846}if (verify(h(m1_7023),sigM1_7022,pkCli_6966) <> true) then
                                                    0
                                                else
                                                    {8847}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_7024: bitstring) = m1_7023 in
                                                    {8848}new Ns_7025: bitstring;
                                                    {8849}new ST_7026: bitstring;
                                                    {8850}new TTL_7027: bitstring;
                                                    {8851}let gNs_7028: bitstring = exp(g,Ns_7025) in
                                                    {8852}let m2_7029: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7028,ST_7026,TTL_7027) in
                                                    {8853}event beginSrv(Sess_5025,Cli_5023,gNs_7028);
                                                    {8854}out(c, (enc(m2_7029,pkCli_6966),sign(h(m2_7029),skSess_6591)));
                                                    {8855}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8856}event endSrv(Cli_5023,Sess_5025,PartC_7024)
                                    )
                                    else
                                        {8857}let pkDisco_7030: bitstring = fail-any in
                                        {8858}in(c, (=pkCli_6966,em1_7031: bitstring,sigM1_7032: bitstring));
                                        {8859}let m1_7033: bitstring = dec(em1_7031,skSess_6591) in
                                        {8860}if (verify(h(m1_7033),sigM1_7032,pkCli_6966) <> true) then
                                            0
                                        else
                                            {8861}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_6966,PartC_7034: bitstring) = m1_7033 in
                                            {8862}new Ns_7035: bitstring;
                                            {8863}new ST_7036: bitstring;
                                            {8864}new TTL_7037: bitstring;
                                            {8865}let gNs_7038: bitstring = exp(g,Ns_7035) in
                                            {8866}let m2_7039: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7038,ST_7036,TTL_7037) in
                                            {8867}event beginSrv(Sess_5025,Cli_5023,gNs_7038);
                                            {8868}out(c, (enc(m2_7039,pkCli_6966),sign(h(m2_7039),skSess_6591)));
                                            {8869}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8870}event endSrv(Cli_5023,Sess_5025,PartC_7034)
                        )
                        else
                            {8871}let pkCli_7040: bitstring = fail-any in
                            {8872}let v_7041: bool = (Disco_5024 = A) in
                            (
                                {8873}if v_7041 then
                                (
                                    {8874}let pkDisco_7042: bitstring = pub(skA) in
                                    {8875}in(c, (=pkCli_7040,em1_7043: bitstring,sigM1_7044: bitstring));
                                    {8876}let m1_7045: bitstring = dec(em1_7043,skSess_6591) in
                                    {8877}if (verify(h(m1_7045),sigM1_7044,pkCli_7040) <> true) then
                                        0
                                    else
                                        {8878}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7046: bitstring) = m1_7045 in
                                        {8879}new Ns_7047: bitstring;
                                        {8880}new ST_7048: bitstring;
                                        {8881}new TTL_7049: bitstring;
                                        {8882}let gNs_7050: bitstring = exp(g,Ns_7047) in
                                        {8883}let m2_7051: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7050,ST_7048,TTL_7049) in
                                        {8884}event beginSrv(Sess_5025,Cli_5023,gNs_7050);
                                        {8885}out(c, (enc(m2_7051,pkCli_7040),sign(h(m2_7051),skSess_6591)));
                                        {8886}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {8887}event endSrv(Cli_5023,Sess_5025,PartC_7046)
                                )
                                else
                                    {8888}let v_7052: bool = (Disco_5024 = B) in
                                    (
                                        {8889}if v_7052 then
                                        (
                                            {8890}let pkDisco_7053: bitstring = pub(skB) in
                                            {8891}in(c, (=pkCli_7040,em1_7054: bitstring,sigM1_7055: bitstring));
                                            {8892}let m1_7056: bitstring = dec(em1_7054,skSess_6591) in
                                            {8893}if (verify(h(m1_7056),sigM1_7055,pkCli_7040) <> true) then
                                                0
                                            else
                                                {8894}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7057: bitstring) = m1_7056 in
                                                {8895}new Ns_7058: bitstring;
                                                {8896}new ST_7059: bitstring;
                                                {8897}new TTL_7060: bitstring;
                                                {8898}let gNs_7061: bitstring = exp(g,Ns_7058) in
                                                {8899}let m2_7062: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7061,ST_7059,TTL_7060) in
                                                {8900}event beginSrv(Sess_5025,Cli_5023,gNs_7061);
                                                {8901}out(c, (enc(m2_7062,pkCli_7040),sign(h(m2_7062),skSess_6591)));
                                                {8902}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {8903}event endSrv(Cli_5023,Sess_5025,PartC_7057)
                                        )
                                        else
                                            {8904}let v_7063: bool = (Disco_5024 = C) in
                                            (
                                                {8905}if v_7063 then
                                                (
                                                    {8906}let pkDisco_7064: bitstring = pub(skC) in
                                                    {8907}in(c, (=pkCli_7040,em1_7065: bitstring,sigM1_7066: bitstring));
                                                    {8908}let m1_7067: bitstring = dec(em1_7065,skSess_6591) in
                                                    {8909}if (verify(h(m1_7067),sigM1_7066,pkCli_7040) <> true) then
                                                        0
                                                    else
                                                        {8910}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7068: bitstring) = m1_7067 in
                                                        {8911}new Ns_7069: bitstring;
                                                        {8912}new ST_7070: bitstring;
                                                        {8913}new TTL_7071: bitstring;
                                                        {8914}let gNs_7072: bitstring = exp(g,Ns_7069) in
                                                        {8915}let m2_7073: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7072,ST_7070,TTL_7071) in
                                                        {8916}event beginSrv(Sess_5025,Cli_5023,gNs_7072);
                                                        {8917}out(c, (enc(m2_7073,pkCli_7040),sign(h(m2_7073),skSess_6591)));
                                                        {8918}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8919}event endSrv(Cli_5023,Sess_5025,PartC_7068)
                                                )
                                                else
                                                    {8920}let pkDisco_7074: bitstring = pub(sk(Disco_5024)) in
                                                    {8921}in(c, (=pkCli_7040,em1_7075: bitstring,sigM1_7076: bitstring));
                                                    {8922}let m1_7077: bitstring = dec(em1_7075,skSess_6591) in
                                                    {8923}if (verify(h(m1_7077),sigM1_7076,pkCli_7040) <> true) then
                                                        0
                                                    else
                                                        {8924}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7078: bitstring) = m1_7077 in
                                                        {8925}new Ns_7079: bitstring;
                                                        {8926}new ST_7080: bitstring;
                                                        {8927}new TTL_7081: bitstring;
                                                        {8928}let gNs_7082: bitstring = exp(g,Ns_7079) in
                                                        {8929}let m2_7083: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7082,ST_7080,TTL_7081) in
                                                        {8930}event beginSrv(Sess_5025,Cli_5023,gNs_7082);
                                                        {8931}out(c, (enc(m2_7083,pkCli_7040),sign(h(m2_7083),skSess_6591)));
                                                        {8932}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {8933}event endSrv(Cli_5023,Sess_5025,PartC_7078)
                                            )
                                            else
                                                {8934}let pkDisco_7084: bitstring = fail-any in
                                                {8935}in(c, (=pkCli_7040,em1_7085: bitstring,sigM1_7086: bitstring));
                                                {8936}let m1_7087: bitstring = dec(em1_7085,skSess_6591) in
                                                {8937}if (verify(h(m1_7087),sigM1_7086,pkCli_7040) <> true) then
                                                    0
                                                else
                                                    {8938}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7088: bitstring) = m1_7087 in
                                                    {8939}new Ns_7089: bitstring;
                                                    {8940}new ST_7090: bitstring;
                                                    {8941}new TTL_7091: bitstring;
                                                    {8942}let gNs_7092: bitstring = exp(g,Ns_7089) in
                                                    {8943}let m2_7093: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7092,ST_7090,TTL_7091) in
                                                    {8944}event beginSrv(Sess_5025,Cli_5023,gNs_7092);
                                                    {8945}out(c, (enc(m2_7093,pkCli_7040),sign(h(m2_7093),skSess_6591)));
                                                    {8946}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {8947}event endSrv(Cli_5023,Sess_5025,PartC_7088)
                                    )
                                    else
                                        {8948}let pkDisco_7094: bitstring = fail-any in
                                        {8949}in(c, (=pkCli_7040,em1_7095: bitstring,sigM1_7096: bitstring));
                                        {8950}let m1_7097: bitstring = dec(em1_7095,skSess_6591) in
                                        {8951}if (verify(h(m1_7097),sigM1_7096,pkCli_7040) <> true) then
                                            0
                                        else
                                            {8952}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7098: bitstring) = m1_7097 in
                                            {8953}new Ns_7099: bitstring;
                                            {8954}new ST_7100: bitstring;
                                            {8955}new TTL_7101: bitstring;
                                            {8956}let gNs_7102: bitstring = exp(g,Ns_7099) in
                                            {8957}let m2_7103: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7102,ST_7100,TTL_7101) in
                                            {8958}event beginSrv(Sess_5025,Cli_5023,gNs_7102);
                                            {8959}out(c, (enc(m2_7103,pkCli_7040),sign(h(m2_7103),skSess_6591)));
                                            {8960}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {8961}event endSrv(Cli_5023,Sess_5025,PartC_7098)
                            )
                            else
                                {8962}let pkDisco_7104: bitstring = fail-any in
                                {8963}in(c, (=pkCli_7040,em1_7105: bitstring,sigM1_7106: bitstring));
                                {8964}let m1_7107: bitstring = dec(em1_7105,skSess_6591) in
                                {8965}if (verify(h(m1_7107),sigM1_7106,pkCli_7040) <> true) then
                                    0
                                else
                                    {8966}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7040,PartC_7108: bitstring) = m1_7107 in
                                    {8967}new Ns_7109: bitstring;
                                    {8968}new ST_7110: bitstring;
                                    {8969}new TTL_7111: bitstring;
                                    {8970}let gNs_7112: bitstring = exp(g,Ns_7109) in
                                    {8971}let m2_7113: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7112,ST_7110,TTL_7111) in
                                    {8972}event beginSrv(Sess_5025,Cli_5023,gNs_7112);
                                    {8973}out(c, (enc(m2_7113,pkCli_7040),sign(h(m2_7113),skSess_6591)));
                                    {8974}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {8975}event endSrv(Cli_5023,Sess_5025,PartC_7108)
            )
            else
                {8976}let skSess_7114: bitstring = fail-any in
                {8977}let pkSess_7115: bitstring = pub(skSess_7114) in
                {8978}let v_7116: bool = (Cli_5023 = A) in
                (
                    {8979}if v_7116 then
                    (
                        {8980}let pkCli_7117: bitstring = pub(skA) in
                        {8981}let v_7118: bool = (Disco_5024 = A) in
                        (
                            {8982}if v_7118 then
                            (
                                {8983}let pkDisco_7119: bitstring = pub(skA) in
                                {8984}in(c, (=pkCli_7117,em1_7120: bitstring,sigM1_7121: bitstring));
                                {8985}let m1_7122: bitstring = dec(em1_7120,skSess_7114) in
                                {8986}if (verify(h(m1_7122),sigM1_7121,pkCli_7117) <> true) then
                                    0
                                else
                                    {8987}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7123: bitstring) = m1_7122 in
                                    {8988}new Ns_7124: bitstring;
                                    {8989}new ST_7125: bitstring;
                                    {8990}new TTL_7126: bitstring;
                                    {8991}let gNs_7127: bitstring = exp(g,Ns_7124) in
                                    {8992}let m2_7128: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7127,ST_7125,TTL_7126) in
                                    {8993}event beginSrv(Sess_5025,Cli_5023,gNs_7127);
                                    {8994}out(c, (enc(m2_7128,pkCli_7117),sign(h(m2_7128),skSess_7114)));
                                    {8995}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {8996}event endSrv(Cli_5023,Sess_5025,PartC_7123)
                            )
                            else
                                {8997}let v_7129: bool = (Disco_5024 = B) in
                                (
                                    {8998}if v_7129 then
                                    (
                                        {8999}let pkDisco_7130: bitstring = pub(skB) in
                                        {9000}in(c, (=pkCli_7117,em1_7131: bitstring,sigM1_7132: bitstring));
                                        {9001}let m1_7133: bitstring = dec(em1_7131,skSess_7114) in
                                        {9002}if (verify(h(m1_7133),sigM1_7132,pkCli_7117) <> true) then
                                            0
                                        else
                                            {9003}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7134: bitstring) = m1_7133 in
                                            {9004}new Ns_7135: bitstring;
                                            {9005}new ST_7136: bitstring;
                                            {9006}new TTL_7137: bitstring;
                                            {9007}let gNs_7138: bitstring = exp(g,Ns_7135) in
                                            {9008}let m2_7139: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7138,ST_7136,TTL_7137) in
                                            {9009}event beginSrv(Sess_5025,Cli_5023,gNs_7138);
                                            {9010}out(c, (enc(m2_7139,pkCli_7117),sign(h(m2_7139),skSess_7114)));
                                            {9011}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9012}event endSrv(Cli_5023,Sess_5025,PartC_7134)
                                    )
                                    else
                                        {9013}let v_7140: bool = (Disco_5024 = C) in
                                        (
                                            {9014}if v_7140 then
                                            (
                                                {9015}let pkDisco_7141: bitstring = pub(skC) in
                                                {9016}in(c, (=pkCli_7117,em1_7142: bitstring,sigM1_7143: bitstring));
                                                {9017}let m1_7144: bitstring = dec(em1_7142,skSess_7114) in
                                                {9018}if (verify(h(m1_7144),sigM1_7143,pkCli_7117) <> true) then
                                                    0
                                                else
                                                    {9019}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7145: bitstring) = m1_7144 in
                                                    {9020}new Ns_7146: bitstring;
                                                    {9021}new ST_7147: bitstring;
                                                    {9022}new TTL_7148: bitstring;
                                                    {9023}let gNs_7149: bitstring = exp(g,Ns_7146) in
                                                    {9024}let m2_7150: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7149,ST_7147,TTL_7148) in
                                                    {9025}event beginSrv(Sess_5025,Cli_5023,gNs_7149);
                                                    {9026}out(c, (enc(m2_7150,pkCli_7117),sign(h(m2_7150),skSess_7114)));
                                                    {9027}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9028}event endSrv(Cli_5023,Sess_5025,PartC_7145)
                                            )
                                            else
                                                {9029}let pkDisco_7151: bitstring = pub(sk(Disco_5024)) in
                                                {9030}in(c, (=pkCli_7117,em1_7152: bitstring,sigM1_7153: bitstring));
                                                {9031}let m1_7154: bitstring = dec(em1_7152,skSess_7114) in
                                                {9032}if (verify(h(m1_7154),sigM1_7153,pkCli_7117) <> true) then
                                                    0
                                                else
                                                    {9033}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7155: bitstring) = m1_7154 in
                                                    {9034}new Ns_7156: bitstring;
                                                    {9035}new ST_7157: bitstring;
                                                    {9036}new TTL_7158: bitstring;
                                                    {9037}let gNs_7159: bitstring = exp(g,Ns_7156) in
                                                    {9038}let m2_7160: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7159,ST_7157,TTL_7158) in
                                                    {9039}event beginSrv(Sess_5025,Cli_5023,gNs_7159);
                                                    {9040}out(c, (enc(m2_7160,pkCli_7117),sign(h(m2_7160),skSess_7114)));
                                                    {9041}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9042}event endSrv(Cli_5023,Sess_5025,PartC_7155)
                                        )
                                        else
                                            {9043}let pkDisco_7161: bitstring = fail-any in
                                            {9044}in(c, (=pkCli_7117,em1_7162: bitstring,sigM1_7163: bitstring));
                                            {9045}let m1_7164: bitstring = dec(em1_7162,skSess_7114) in
                                            {9046}if (verify(h(m1_7164),sigM1_7163,pkCli_7117) <> true) then
                                                0
                                            else
                                                {9047}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7165: bitstring) = m1_7164 in
                                                {9048}new Ns_7166: bitstring;
                                                {9049}new ST_7167: bitstring;
                                                {9050}new TTL_7168: bitstring;
                                                {9051}let gNs_7169: bitstring = exp(g,Ns_7166) in
                                                {9052}let m2_7170: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7169,ST_7167,TTL_7168) in
                                                {9053}event beginSrv(Sess_5025,Cli_5023,gNs_7169);
                                                {9054}out(c, (enc(m2_7170,pkCli_7117),sign(h(m2_7170),skSess_7114)));
                                                {9055}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9056}event endSrv(Cli_5023,Sess_5025,PartC_7165)
                                )
                                else
                                    {9057}let pkDisco_7171: bitstring = fail-any in
                                    {9058}in(c, (=pkCli_7117,em1_7172: bitstring,sigM1_7173: bitstring));
                                    {9059}let m1_7174: bitstring = dec(em1_7172,skSess_7114) in
                                    {9060}if (verify(h(m1_7174),sigM1_7173,pkCli_7117) <> true) then
                                        0
                                    else
                                        {9061}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7175: bitstring) = m1_7174 in
                                        {9062}new Ns_7176: bitstring;
                                        {9063}new ST_7177: bitstring;
                                        {9064}new TTL_7178: bitstring;
                                        {9065}let gNs_7179: bitstring = exp(g,Ns_7176) in
                                        {9066}let m2_7180: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7179,ST_7177,TTL_7178) in
                                        {9067}event beginSrv(Sess_5025,Cli_5023,gNs_7179);
                                        {9068}out(c, (enc(m2_7180,pkCli_7117),sign(h(m2_7180),skSess_7114)));
                                        {9069}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9070}event endSrv(Cli_5023,Sess_5025,PartC_7175)
                        )
                        else
                            {9071}let pkDisco_7181: bitstring = fail-any in
                            {9072}in(c, (=pkCli_7117,em1_7182: bitstring,sigM1_7183: bitstring));
                            {9073}let m1_7184: bitstring = dec(em1_7182,skSess_7114) in
                            {9074}if (verify(h(m1_7184),sigM1_7183,pkCli_7117) <> true) then
                                0
                            else
                                {9075}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7117,PartC_7185: bitstring) = m1_7184 in
                                {9076}new Ns_7186: bitstring;
                                {9077}new ST_7187: bitstring;
                                {9078}new TTL_7188: bitstring;
                                {9079}let gNs_7189: bitstring = exp(g,Ns_7186) in
                                {9080}let m2_7190: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7189,ST_7187,TTL_7188) in
                                {9081}event beginSrv(Sess_5025,Cli_5023,gNs_7189);
                                {9082}out(c, (enc(m2_7190,pkCli_7117),sign(h(m2_7190),skSess_7114)));
                                {9083}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9084}event endSrv(Cli_5023,Sess_5025,PartC_7185)
                    )
                    else
                        {9085}let v_7191: bool = (Cli_5023 = B) in
                        (
                            {9086}if v_7191 then
                            (
                                {9087}let pkCli_7192: bitstring = pub(skB) in
                                {9088}let v_7193: bool = (Disco_5024 = A) in
                                (
                                    {9089}if v_7193 then
                                    (
                                        {9090}let pkDisco_7194: bitstring = pub(skA) in
                                        {9091}in(c, (=pkCli_7192,em1_7195: bitstring,sigM1_7196: bitstring));
                                        {9092}let m1_7197: bitstring = dec(em1_7195,skSess_7114) in
                                        {9093}if (verify(h(m1_7197),sigM1_7196,pkCli_7192) <> true) then
                                            0
                                        else
                                            {9094}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7198: bitstring) = m1_7197 in
                                            {9095}new Ns_7199: bitstring;
                                            {9096}new ST_7200: bitstring;
                                            {9097}new TTL_7201: bitstring;
                                            {9098}let gNs_7202: bitstring = exp(g,Ns_7199) in
                                            {9099}let m2_7203: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7202,ST_7200,TTL_7201) in
                                            {9100}event beginSrv(Sess_5025,Cli_5023,gNs_7202);
                                            {9101}out(c, (enc(m2_7203,pkCli_7192),sign(h(m2_7203),skSess_7114)));
                                            {9102}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9103}event endSrv(Cli_5023,Sess_5025,PartC_7198)
                                    )
                                    else
                                        {9104}let v_7204: bool = (Disco_5024 = B) in
                                        (
                                            {9105}if v_7204 then
                                            (
                                                {9106}let pkDisco_7205: bitstring = pub(skB) in
                                                {9107}in(c, (=pkCli_7192,em1_7206: bitstring,sigM1_7207: bitstring));
                                                {9108}let m1_7208: bitstring = dec(em1_7206,skSess_7114) in
                                                {9109}if (verify(h(m1_7208),sigM1_7207,pkCli_7192) <> true) then
                                                    0
                                                else
                                                    {9110}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7209: bitstring) = m1_7208 in
                                                    {9111}new Ns_7210: bitstring;
                                                    {9112}new ST_7211: bitstring;
                                                    {9113}new TTL_7212: bitstring;
                                                    {9114}let gNs_7213: bitstring = exp(g,Ns_7210) in
                                                    {9115}let m2_7214: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7213,ST_7211,TTL_7212) in
                                                    {9116}event beginSrv(Sess_5025,Cli_5023,gNs_7213);
                                                    {9117}out(c, (enc(m2_7214,pkCli_7192),sign(h(m2_7214),skSess_7114)));
                                                    {9118}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9119}event endSrv(Cli_5023,Sess_5025,PartC_7209)
                                            )
                                            else
                                                {9120}let v_7215: bool = (Disco_5024 = C) in
                                                (
                                                    {9121}if v_7215 then
                                                    (
                                                        {9122}let pkDisco_7216: bitstring = pub(skC) in
                                                        {9123}in(c, (=pkCli_7192,em1_7217: bitstring,sigM1_7218: bitstring));
                                                        {9124}let m1_7219: bitstring = dec(em1_7217,skSess_7114) in
                                                        {9125}if (verify(h(m1_7219),sigM1_7218,pkCli_7192) <> true) then
                                                            0
                                                        else
                                                            {9126}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7220: bitstring) = m1_7219 in
                                                            {9127}new Ns_7221: bitstring;
                                                            {9128}new ST_7222: bitstring;
                                                            {9129}new TTL_7223: bitstring;
                                                            {9130}let gNs_7224: bitstring = exp(g,Ns_7221) in
                                                            {9131}let m2_7225: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7224,ST_7222,TTL_7223) in
                                                            {9132}event beginSrv(Sess_5025,Cli_5023,gNs_7224);
                                                            {9133}out(c, (enc(m2_7225,pkCli_7192),sign(h(m2_7225),skSess_7114)));
                                                            {9134}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9135}event endSrv(Cli_5023,Sess_5025,PartC_7220)
                                                    )
                                                    else
                                                        {9136}let pkDisco_7226: bitstring = pub(sk(Disco_5024)) in
                                                        {9137}in(c, (=pkCli_7192,em1_7227: bitstring,sigM1_7228: bitstring));
                                                        {9138}let m1_7229: bitstring = dec(em1_7227,skSess_7114) in
                                                        {9139}if (verify(h(m1_7229),sigM1_7228,pkCli_7192) <> true) then
                                                            0
                                                        else
                                                            {9140}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7230: bitstring) = m1_7229 in
                                                            {9141}new Ns_7231: bitstring;
                                                            {9142}new ST_7232: bitstring;
                                                            {9143}new TTL_7233: bitstring;
                                                            {9144}let gNs_7234: bitstring = exp(g,Ns_7231) in
                                                            {9145}let m2_7235: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7234,ST_7232,TTL_7233) in
                                                            {9146}event beginSrv(Sess_5025,Cli_5023,gNs_7234);
                                                            {9147}out(c, (enc(m2_7235,pkCli_7192),sign(h(m2_7235),skSess_7114)));
                                                            {9148}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9149}event endSrv(Cli_5023,Sess_5025,PartC_7230)
                                                )
                                                else
                                                    {9150}let pkDisco_7236: bitstring = fail-any in
                                                    {9151}in(c, (=pkCli_7192,em1_7237: bitstring,sigM1_7238: bitstring));
                                                    {9152}let m1_7239: bitstring = dec(em1_7237,skSess_7114) in
                                                    {9153}if (verify(h(m1_7239),sigM1_7238,pkCli_7192) <> true) then
                                                        0
                                                    else
                                                        {9154}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7240: bitstring) = m1_7239 in
                                                        {9155}new Ns_7241: bitstring;
                                                        {9156}new ST_7242: bitstring;
                                                        {9157}new TTL_7243: bitstring;
                                                        {9158}let gNs_7244: bitstring = exp(g,Ns_7241) in
                                                        {9159}let m2_7245: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7244,ST_7242,TTL_7243) in
                                                        {9160}event beginSrv(Sess_5025,Cli_5023,gNs_7244);
                                                        {9161}out(c, (enc(m2_7245,pkCli_7192),sign(h(m2_7245),skSess_7114)));
                                                        {9162}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9163}event endSrv(Cli_5023,Sess_5025,PartC_7240)
                                        )
                                        else
                                            {9164}let pkDisco_7246: bitstring = fail-any in
                                            {9165}in(c, (=pkCli_7192,em1_7247: bitstring,sigM1_7248: bitstring));
                                            {9166}let m1_7249: bitstring = dec(em1_7247,skSess_7114) in
                                            {9167}if (verify(h(m1_7249),sigM1_7248,pkCli_7192) <> true) then
                                                0
                                            else
                                                {9168}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7250: bitstring) = m1_7249 in
                                                {9169}new Ns_7251: bitstring;
                                                {9170}new ST_7252: bitstring;
                                                {9171}new TTL_7253: bitstring;
                                                {9172}let gNs_7254: bitstring = exp(g,Ns_7251) in
                                                {9173}let m2_7255: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7254,ST_7252,TTL_7253) in
                                                {9174}event beginSrv(Sess_5025,Cli_5023,gNs_7254);
                                                {9175}out(c, (enc(m2_7255,pkCli_7192),sign(h(m2_7255),skSess_7114)));
                                                {9176}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9177}event endSrv(Cli_5023,Sess_5025,PartC_7250)
                                )
                                else
                                    {9178}let pkDisco_7256: bitstring = fail-any in
                                    {9179}in(c, (=pkCli_7192,em1_7257: bitstring,sigM1_7258: bitstring));
                                    {9180}let m1_7259: bitstring = dec(em1_7257,skSess_7114) in
                                    {9181}if (verify(h(m1_7259),sigM1_7258,pkCli_7192) <> true) then
                                        0
                                    else
                                        {9182}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7192,PartC_7260: bitstring) = m1_7259 in
                                        {9183}new Ns_7261: bitstring;
                                        {9184}new ST_7262: bitstring;
                                        {9185}new TTL_7263: bitstring;
                                        {9186}let gNs_7264: bitstring = exp(g,Ns_7261) in
                                        {9187}let m2_7265: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7264,ST_7262,TTL_7263) in
                                        {9188}event beginSrv(Sess_5025,Cli_5023,gNs_7264);
                                        {9189}out(c, (enc(m2_7265,pkCli_7192),sign(h(m2_7265),skSess_7114)));
                                        {9190}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9191}event endSrv(Cli_5023,Sess_5025,PartC_7260)
                            )
                            else
                                {9192}let v_7266: bool = (Cli_5023 = C) in
                                (
                                    {9193}if v_7266 then
                                    (
                                        {9194}let pkCli_7267: bitstring = pub(skC) in
                                        {9195}let v_7268: bool = (Disco_5024 = A) in
                                        (
                                            {9196}if v_7268 then
                                            (
                                                {9197}let pkDisco_7269: bitstring = pub(skA) in
                                                {9198}in(c, (=pkCli_7267,em1_7270: bitstring,sigM1_7271: bitstring));
                                                {9199}let m1_7272: bitstring = dec(em1_7270,skSess_7114) in
                                                {9200}if (verify(h(m1_7272),sigM1_7271,pkCli_7267) <> true) then
                                                    0
                                                else
                                                    {9201}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7273: bitstring) = m1_7272 in
                                                    {9202}new Ns_7274: bitstring;
                                                    {9203}new ST_7275: bitstring;
                                                    {9204}new TTL_7276: bitstring;
                                                    {9205}let gNs_7277: bitstring = exp(g,Ns_7274) in
                                                    {9206}let m2_7278: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7277,ST_7275,TTL_7276) in
                                                    {9207}event beginSrv(Sess_5025,Cli_5023,gNs_7277);
                                                    {9208}out(c, (enc(m2_7278,pkCli_7267),sign(h(m2_7278),skSess_7114)));
                                                    {9209}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9210}event endSrv(Cli_5023,Sess_5025,PartC_7273)
                                            )
                                            else
                                                {9211}let v_7279: bool = (Disco_5024 = B) in
                                                (
                                                    {9212}if v_7279 then
                                                    (
                                                        {9213}let pkDisco_7280: bitstring = pub(skB) in
                                                        {9214}in(c, (=pkCli_7267,em1_7281: bitstring,sigM1_7282: bitstring));
                                                        {9215}let m1_7283: bitstring = dec(em1_7281,skSess_7114) in
                                                        {9216}if (verify(h(m1_7283),sigM1_7282,pkCli_7267) <> true) then
                                                            0
                                                        else
                                                            {9217}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7284: bitstring) = m1_7283 in
                                                            {9218}new Ns_7285: bitstring;
                                                            {9219}new ST_7286: bitstring;
                                                            {9220}new TTL_7287: bitstring;
                                                            {9221}let gNs_7288: bitstring = exp(g,Ns_7285) in
                                                            {9222}let m2_7289: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7288,ST_7286,TTL_7287) in
                                                            {9223}event beginSrv(Sess_5025,Cli_5023,gNs_7288);
                                                            {9224}out(c, (enc(m2_7289,pkCli_7267),sign(h(m2_7289),skSess_7114)));
                                                            {9225}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9226}event endSrv(Cli_5023,Sess_5025,PartC_7284)
                                                    )
                                                    else
                                                        {9227}let v_7290: bool = (Disco_5024 = C) in
                                                        (
                                                            {9228}if v_7290 then
                                                            (
                                                                {9229}let pkDisco_7291: bitstring = pub(skC) in
                                                                {9230}in(c, (=pkCli_7267,em1_7292: bitstring,sigM1_7293: bitstring));
                                                                {9231}let m1_7294: bitstring = dec(em1_7292,skSess_7114) in
                                                                {9232}if (verify(h(m1_7294),sigM1_7293,pkCli_7267) <> true) then
                                                                    0
                                                                else
                                                                    {9233}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7295: bitstring) = m1_7294 in
                                                                    {9234}new Ns_7296: bitstring;
                                                                    {9235}new ST_7297: bitstring;
                                                                    {9236}new TTL_7298: bitstring;
                                                                    {9237}let gNs_7299: bitstring = exp(g,Ns_7296) in
                                                                    {9238}let m2_7300: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7299,ST_7297,TTL_7298) in
                                                                    {9239}event beginSrv(Sess_5025,Cli_5023,gNs_7299);
                                                                    {9240}out(c, (enc(m2_7300,pkCli_7267),sign(h(m2_7300),skSess_7114)));
                                                                    {9241}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9242}event endSrv(Cli_5023,Sess_5025,PartC_7295)
                                                            )
                                                            else
                                                                {9243}let pkDisco_7301: bitstring = pub(sk(Disco_5024)) in
                                                                {9244}in(c, (=pkCli_7267,em1_7302: bitstring,sigM1_7303: bitstring));
                                                                {9245}let m1_7304: bitstring = dec(em1_7302,skSess_7114) in
                                                                {9246}if (verify(h(m1_7304),sigM1_7303,pkCli_7267) <> true) then
                                                                    0
                                                                else
                                                                    {9247}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7305: bitstring) = m1_7304 in
                                                                    {9248}new Ns_7306: bitstring;
                                                                    {9249}new ST_7307: bitstring;
                                                                    {9250}new TTL_7308: bitstring;
                                                                    {9251}let gNs_7309: bitstring = exp(g,Ns_7306) in
                                                                    {9252}let m2_7310: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7309,ST_7307,TTL_7308) in
                                                                    {9253}event beginSrv(Sess_5025,Cli_5023,gNs_7309);
                                                                    {9254}out(c, (enc(m2_7310,pkCli_7267),sign(h(m2_7310),skSess_7114)));
                                                                    {9255}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9256}event endSrv(Cli_5023,Sess_5025,PartC_7305)
                                                        )
                                                        else
                                                            {9257}let pkDisco_7311: bitstring = fail-any in
                                                            {9258}in(c, (=pkCli_7267,em1_7312: bitstring,sigM1_7313: bitstring));
                                                            {9259}let m1_7314: bitstring = dec(em1_7312,skSess_7114) in
                                                            {9260}if (verify(h(m1_7314),sigM1_7313,pkCli_7267) <> true) then
                                                                0
                                                            else
                                                                {9261}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7315: bitstring) = m1_7314 in
                                                                {9262}new Ns_7316: bitstring;
                                                                {9263}new ST_7317: bitstring;
                                                                {9264}new TTL_7318: bitstring;
                                                                {9265}let gNs_7319: bitstring = exp(g,Ns_7316) in
                                                                {9266}let m2_7320: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7319,ST_7317,TTL_7318) in
                                                                {9267}event beginSrv(Sess_5025,Cli_5023,gNs_7319);
                                                                {9268}out(c, (enc(m2_7320,pkCli_7267),sign(h(m2_7320),skSess_7114)));
                                                                {9269}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9270}event endSrv(Cli_5023,Sess_5025,PartC_7315)
                                                )
                                                else
                                                    {9271}let pkDisco_7321: bitstring = fail-any in
                                                    {9272}in(c, (=pkCli_7267,em1_7322: bitstring,sigM1_7323: bitstring));
                                                    {9273}let m1_7324: bitstring = dec(em1_7322,skSess_7114) in
                                                    {9274}if (verify(h(m1_7324),sigM1_7323,pkCli_7267) <> true) then
                                                        0
                                                    else
                                                        {9275}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7325: bitstring) = m1_7324 in
                                                        {9276}new Ns_7326: bitstring;
                                                        {9277}new ST_7327: bitstring;
                                                        {9278}new TTL_7328: bitstring;
                                                        {9279}let gNs_7329: bitstring = exp(g,Ns_7326) in
                                                        {9280}let m2_7330: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7329,ST_7327,TTL_7328) in
                                                        {9281}event beginSrv(Sess_5025,Cli_5023,gNs_7329);
                                                        {9282}out(c, (enc(m2_7330,pkCli_7267),sign(h(m2_7330),skSess_7114)));
                                                        {9283}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9284}event endSrv(Cli_5023,Sess_5025,PartC_7325)
                                        )
                                        else
                                            {9285}let pkDisco_7331: bitstring = fail-any in
                                            {9286}in(c, (=pkCli_7267,em1_7332: bitstring,sigM1_7333: bitstring));
                                            {9287}let m1_7334: bitstring = dec(em1_7332,skSess_7114) in
                                            {9288}if (verify(h(m1_7334),sigM1_7333,pkCli_7267) <> true) then
                                                0
                                            else
                                                {9289}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7267,PartC_7335: bitstring) = m1_7334 in
                                                {9290}new Ns_7336: bitstring;
                                                {9291}new ST_7337: bitstring;
                                                {9292}new TTL_7338: bitstring;
                                                {9293}let gNs_7339: bitstring = exp(g,Ns_7336) in
                                                {9294}let m2_7340: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7339,ST_7337,TTL_7338) in
                                                {9295}event beginSrv(Sess_5025,Cli_5023,gNs_7339);
                                                {9296}out(c, (enc(m2_7340,pkCli_7267),sign(h(m2_7340),skSess_7114)));
                                                {9297}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9298}event endSrv(Cli_5023,Sess_5025,PartC_7335)
                                    )
                                    else
                                        {9299}let pkCli_7341: bitstring = pub(sk(Cli_5023)) in
                                        {9300}let v_7342: bool = (Disco_5024 = A) in
                                        (
                                            {9301}if v_7342 then
                                            (
                                                {9302}let pkDisco_7343: bitstring = pub(skA) in
                                                {9303}in(c, (=pkCli_7341,em1_7344: bitstring,sigM1_7345: bitstring));
                                                {9304}let m1_7346: bitstring = dec(em1_7344,skSess_7114) in
                                                {9305}if (verify(h(m1_7346),sigM1_7345,pkCli_7341) <> true) then
                                                    0
                                                else
                                                    {9306}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7347: bitstring) = m1_7346 in
                                                    {9307}new Ns_7348: bitstring;
                                                    {9308}new ST_7349: bitstring;
                                                    {9309}new TTL_7350: bitstring;
                                                    {9310}let gNs_7351: bitstring = exp(g,Ns_7348) in
                                                    {9311}let m2_7352: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7351,ST_7349,TTL_7350) in
                                                    {9312}event beginSrv(Sess_5025,Cli_5023,gNs_7351);
                                                    {9313}out(c, (enc(m2_7352,pkCli_7341),sign(h(m2_7352),skSess_7114)));
                                                    {9314}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9315}event endSrv(Cli_5023,Sess_5025,PartC_7347)
                                            )
                                            else
                                                {9316}let v_7353: bool = (Disco_5024 = B) in
                                                (
                                                    {9317}if v_7353 then
                                                    (
                                                        {9318}let pkDisco_7354: bitstring = pub(skB) in
                                                        {9319}in(c, (=pkCli_7341,em1_7355: bitstring,sigM1_7356: bitstring));
                                                        {9320}let m1_7357: bitstring = dec(em1_7355,skSess_7114) in
                                                        {9321}if (verify(h(m1_7357),sigM1_7356,pkCli_7341) <> true) then
                                                            0
                                                        else
                                                            {9322}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7358: bitstring) = m1_7357 in
                                                            {9323}new Ns_7359: bitstring;
                                                            {9324}new ST_7360: bitstring;
                                                            {9325}new TTL_7361: bitstring;
                                                            {9326}let gNs_7362: bitstring = exp(g,Ns_7359) in
                                                            {9327}let m2_7363: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7362,ST_7360,TTL_7361) in
                                                            {9328}event beginSrv(Sess_5025,Cli_5023,gNs_7362);
                                                            {9329}out(c, (enc(m2_7363,pkCli_7341),sign(h(m2_7363),skSess_7114)));
                                                            {9330}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9331}event endSrv(Cli_5023,Sess_5025,PartC_7358)
                                                    )
                                                    else
                                                        {9332}let v_7364: bool = (Disco_5024 = C) in
                                                        (
                                                            {9333}if v_7364 then
                                                            (
                                                                {9334}let pkDisco_7365: bitstring = pub(skC) in
                                                                {9335}in(c, (=pkCli_7341,em1_7366: bitstring,sigM1_7367: bitstring));
                                                                {9336}let m1_7368: bitstring = dec(em1_7366,skSess_7114) in
                                                                {9337}if (verify(h(m1_7368),sigM1_7367,pkCli_7341) <> true) then
                                                                    0
                                                                else
                                                                    {9338}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7369: bitstring) = m1_7368 in
                                                                    {9339}new Ns_7370: bitstring;
                                                                    {9340}new ST_7371: bitstring;
                                                                    {9341}new TTL_7372: bitstring;
                                                                    {9342}let gNs_7373: bitstring = exp(g,Ns_7370) in
                                                                    {9343}let m2_7374: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7373,ST_7371,TTL_7372) in
                                                                    {9344}event beginSrv(Sess_5025,Cli_5023,gNs_7373);
                                                                    {9345}out(c, (enc(m2_7374,pkCli_7341),sign(h(m2_7374),skSess_7114)));
                                                                    {9346}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9347}event endSrv(Cli_5023,Sess_5025,PartC_7369)
                                                            )
                                                            else
                                                                {9348}let pkDisco_7375: bitstring = pub(sk(Disco_5024)) in
                                                                {9349}in(c, (=pkCli_7341,em1_7376: bitstring,sigM1_7377: bitstring));
                                                                {9350}let m1_7378: bitstring = dec(em1_7376,skSess_7114) in
                                                                {9351}if (verify(h(m1_7378),sigM1_7377,pkCli_7341) <> true) then
                                                                    0
                                                                else
                                                                    {9352}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7379: bitstring) = m1_7378 in
                                                                    {9353}new Ns_7380: bitstring;
                                                                    {9354}new ST_7381: bitstring;
                                                                    {9355}new TTL_7382: bitstring;
                                                                    {9356}let gNs_7383: bitstring = exp(g,Ns_7380) in
                                                                    {9357}let m2_7384: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7383,ST_7381,TTL_7382) in
                                                                    {9358}event beginSrv(Sess_5025,Cli_5023,gNs_7383);
                                                                    {9359}out(c, (enc(m2_7384,pkCli_7341),sign(h(m2_7384),skSess_7114)));
                                                                    {9360}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                    {9361}event endSrv(Cli_5023,Sess_5025,PartC_7379)
                                                        )
                                                        else
                                                            {9362}let pkDisco_7385: bitstring = fail-any in
                                                            {9363}in(c, (=pkCli_7341,em1_7386: bitstring,sigM1_7387: bitstring));
                                                            {9364}let m1_7388: bitstring = dec(em1_7386,skSess_7114) in
                                                            {9365}if (verify(h(m1_7388),sigM1_7387,pkCli_7341) <> true) then
                                                                0
                                                            else
                                                                {9366}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7389: bitstring) = m1_7388 in
                                                                {9367}new Ns_7390: bitstring;
                                                                {9368}new ST_7391: bitstring;
                                                                {9369}new TTL_7392: bitstring;
                                                                {9370}let gNs_7393: bitstring = exp(g,Ns_7390) in
                                                                {9371}let m2_7394: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7393,ST_7391,TTL_7392) in
                                                                {9372}event beginSrv(Sess_5025,Cli_5023,gNs_7393);
                                                                {9373}out(c, (enc(m2_7394,pkCli_7341),sign(h(m2_7394),skSess_7114)));
                                                                {9374}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9375}event endSrv(Cli_5023,Sess_5025,PartC_7389)
                                                )
                                                else
                                                    {9376}let pkDisco_7395: bitstring = fail-any in
                                                    {9377}in(c, (=pkCli_7341,em1_7396: bitstring,sigM1_7397: bitstring));
                                                    {9378}let m1_7398: bitstring = dec(em1_7396,skSess_7114) in
                                                    {9379}if (verify(h(m1_7398),sigM1_7397,pkCli_7341) <> true) then
                                                        0
                                                    else
                                                        {9380}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7399: bitstring) = m1_7398 in
                                                        {9381}new Ns_7400: bitstring;
                                                        {9382}new ST_7401: bitstring;
                                                        {9383}new TTL_7402: bitstring;
                                                        {9384}let gNs_7403: bitstring = exp(g,Ns_7400) in
                                                        {9385}let m2_7404: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7403,ST_7401,TTL_7402) in
                                                        {9386}event beginSrv(Sess_5025,Cli_5023,gNs_7403);
                                                        {9387}out(c, (enc(m2_7404,pkCli_7341),sign(h(m2_7404),skSess_7114)));
                                                        {9388}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9389}event endSrv(Cli_5023,Sess_5025,PartC_7399)
                                        )
                                        else
                                            {9390}let pkDisco_7405: bitstring = fail-any in
                                            {9391}in(c, (=pkCli_7341,em1_7406: bitstring,sigM1_7407: bitstring));
                                            {9392}let m1_7408: bitstring = dec(em1_7406,skSess_7114) in
                                            {9393}if (verify(h(m1_7408),sigM1_7407,pkCli_7341) <> true) then
                                                0
                                            else
                                                {9394}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7341,PartC_7409: bitstring) = m1_7408 in
                                                {9395}new Ns_7410: bitstring;
                                                {9396}new ST_7411: bitstring;
                                                {9397}new TTL_7412: bitstring;
                                                {9398}let gNs_7413: bitstring = exp(g,Ns_7410) in
                                                {9399}let m2_7414: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7413,ST_7411,TTL_7412) in
                                                {9400}event beginSrv(Sess_5025,Cli_5023,gNs_7413);
                                                {9401}out(c, (enc(m2_7414,pkCli_7341),sign(h(m2_7414),skSess_7114)));
                                                {9402}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9403}event endSrv(Cli_5023,Sess_5025,PartC_7409)
                                )
                                else
                                    {9404}let pkCli_7415: bitstring = fail-any in
                                    {9405}let v_7416: bool = (Disco_5024 = A) in
                                    (
                                        {9406}if v_7416 then
                                        (
                                            {9407}let pkDisco_7417: bitstring = pub(skA) in
                                            {9408}in(c, (=pkCli_7415,em1_7418: bitstring,sigM1_7419: bitstring));
                                            {9409}let m1_7420: bitstring = dec(em1_7418,skSess_7114) in
                                            {9410}if (verify(h(m1_7420),sigM1_7419,pkCli_7415) <> true) then
                                                0
                                            else
                                                {9411}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7421: bitstring) = m1_7420 in
                                                {9412}new Ns_7422: bitstring;
                                                {9413}new ST_7423: bitstring;
                                                {9414}new TTL_7424: bitstring;
                                                {9415}let gNs_7425: bitstring = exp(g,Ns_7422) in
                                                {9416}let m2_7426: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7425,ST_7423,TTL_7424) in
                                                {9417}event beginSrv(Sess_5025,Cli_5023,gNs_7425);
                                                {9418}out(c, (enc(m2_7426,pkCli_7415),sign(h(m2_7426),skSess_7114)));
                                                {9419}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9420}event endSrv(Cli_5023,Sess_5025,PartC_7421)
                                        )
                                        else
                                            {9421}let v_7427: bool = (Disco_5024 = B) in
                                            (
                                                {9422}if v_7427 then
                                                (
                                                    {9423}let pkDisco_7428: bitstring = pub(skB) in
                                                    {9424}in(c, (=pkCli_7415,em1_7429: bitstring,sigM1_7430: bitstring));
                                                    {9425}let m1_7431: bitstring = dec(em1_7429,skSess_7114) in
                                                    {9426}if (verify(h(m1_7431),sigM1_7430,pkCli_7415) <> true) then
                                                        0
                                                    else
                                                        {9427}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7432: bitstring) = m1_7431 in
                                                        {9428}new Ns_7433: bitstring;
                                                        {9429}new ST_7434: bitstring;
                                                        {9430}new TTL_7435: bitstring;
                                                        {9431}let gNs_7436: bitstring = exp(g,Ns_7433) in
                                                        {9432}let m2_7437: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7436,ST_7434,TTL_7435) in
                                                        {9433}event beginSrv(Sess_5025,Cli_5023,gNs_7436);
                                                        {9434}out(c, (enc(m2_7437,pkCli_7415),sign(h(m2_7437),skSess_7114)));
                                                        {9435}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9436}event endSrv(Cli_5023,Sess_5025,PartC_7432)
                                                )
                                                else
                                                    {9437}let v_7438: bool = (Disco_5024 = C) in
                                                    (
                                                        {9438}if v_7438 then
                                                        (
                                                            {9439}let pkDisco_7439: bitstring = pub(skC) in
                                                            {9440}in(c, (=pkCli_7415,em1_7440: bitstring,sigM1_7441: bitstring));
                                                            {9441}let m1_7442: bitstring = dec(em1_7440,skSess_7114) in
                                                            {9442}if (verify(h(m1_7442),sigM1_7441,pkCli_7415) <> true) then
                                                                0
                                                            else
                                                                {9443}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7443: bitstring) = m1_7442 in
                                                                {9444}new Ns_7444: bitstring;
                                                                {9445}new ST_7445: bitstring;
                                                                {9446}new TTL_7446: bitstring;
                                                                {9447}let gNs_7447: bitstring = exp(g,Ns_7444) in
                                                                {9448}let m2_7448: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7447,ST_7445,TTL_7446) in
                                                                {9449}event beginSrv(Sess_5025,Cli_5023,gNs_7447);
                                                                {9450}out(c, (enc(m2_7448,pkCli_7415),sign(h(m2_7448),skSess_7114)));
                                                                {9451}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9452}event endSrv(Cli_5023,Sess_5025,PartC_7443)
                                                        )
                                                        else
                                                            {9453}let pkDisco_7449: bitstring = pub(sk(Disco_5024)) in
                                                            {9454}in(c, (=pkCli_7415,em1_7450: bitstring,sigM1_7451: bitstring));
                                                            {9455}let m1_7452: bitstring = dec(em1_7450,skSess_7114) in
                                                            {9456}if (verify(h(m1_7452),sigM1_7451,pkCli_7415) <> true) then
                                                                0
                                                            else
                                                                {9457}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7453: bitstring) = m1_7452 in
                                                                {9458}new Ns_7454: bitstring;
                                                                {9459}new ST_7455: bitstring;
                                                                {9460}new TTL_7456: bitstring;
                                                                {9461}let gNs_7457: bitstring = exp(g,Ns_7454) in
                                                                {9462}let m2_7458: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7457,ST_7455,TTL_7456) in
                                                                {9463}event beginSrv(Sess_5025,Cli_5023,gNs_7457);
                                                                {9464}out(c, (enc(m2_7458,pkCli_7415),sign(h(m2_7458),skSess_7114)));
                                                                {9465}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                                {9466}event endSrv(Cli_5023,Sess_5025,PartC_7453)
                                                    )
                                                    else
                                                        {9467}let pkDisco_7459: bitstring = fail-any in
                                                        {9468}in(c, (=pkCli_7415,em1_7460: bitstring,sigM1_7461: bitstring));
                                                        {9469}let m1_7462: bitstring = dec(em1_7460,skSess_7114) in
                                                        {9470}if (verify(h(m1_7462),sigM1_7461,pkCli_7415) <> true) then
                                                            0
                                                        else
                                                            {9471}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7463: bitstring) = m1_7462 in
                                                            {9472}new Ns_7464: bitstring;
                                                            {9473}new ST_7465: bitstring;
                                                            {9474}new TTL_7466: bitstring;
                                                            {9475}let gNs_7467: bitstring = exp(g,Ns_7464) in
                                                            {9476}let m2_7468: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7467,ST_7465,TTL_7466) in
                                                            {9477}event beginSrv(Sess_5025,Cli_5023,gNs_7467);
                                                            {9478}out(c, (enc(m2_7468,pkCli_7415),sign(h(m2_7468),skSess_7114)));
                                                            {9479}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9480}event endSrv(Cli_5023,Sess_5025,PartC_7463)
                                            )
                                            else
                                                {9481}let pkDisco_7469: bitstring = fail-any in
                                                {9482}in(c, (=pkCli_7415,em1_7470: bitstring,sigM1_7471: bitstring));
                                                {9483}let m1_7472: bitstring = dec(em1_7470,skSess_7114) in
                                                {9484}if (verify(h(m1_7472),sigM1_7471,pkCli_7415) <> true) then
                                                    0
                                                else
                                                    {9485}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7473: bitstring) = m1_7472 in
                                                    {9486}new Ns_7474: bitstring;
                                                    {9487}new ST_7475: bitstring;
                                                    {9488}new TTL_7476: bitstring;
                                                    {9489}let gNs_7477: bitstring = exp(g,Ns_7474) in
                                                    {9490}let m2_7478: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7477,ST_7475,TTL_7476) in
                                                    {9491}event beginSrv(Sess_5025,Cli_5023,gNs_7477);
                                                    {9492}out(c, (enc(m2_7478,pkCli_7415),sign(h(m2_7478),skSess_7114)));
                                                    {9493}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9494}event endSrv(Cli_5023,Sess_5025,PartC_7473)
                                    )
                                    else
                                        {9495}let pkDisco_7479: bitstring = fail-any in
                                        {9496}in(c, (=pkCli_7415,em1_7480: bitstring,sigM1_7481: bitstring));
                                        {9497}let m1_7482: bitstring = dec(em1_7480,skSess_7114) in
                                        {9498}if (verify(h(m1_7482),sigM1_7481,pkCli_7415) <> true) then
                                            0
                                        else
                                            {9499}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7415,PartC_7483: bitstring) = m1_7482 in
                                            {9500}new Ns_7484: bitstring;
                                            {9501}new ST_7485: bitstring;
                                            {9502}new TTL_7486: bitstring;
                                            {9503}let gNs_7487: bitstring = exp(g,Ns_7484) in
                                            {9504}let m2_7488: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7487,ST_7485,TTL_7486) in
                                            {9505}event beginSrv(Sess_5025,Cli_5023,gNs_7487);
                                            {9506}out(c, (enc(m2_7488,pkCli_7415),sign(h(m2_7488),skSess_7114)));
                                            {9507}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9508}event endSrv(Cli_5023,Sess_5025,PartC_7483)
                        )
                        else
                            {9509}let pkCli_7489: bitstring = fail-any in
                            {9510}let v_7490: bool = (Disco_5024 = A) in
                            (
                                {9511}if v_7490 then
                                (
                                    {9512}let pkDisco_7491: bitstring = pub(skA) in
                                    {9513}in(c, (=pkCli_7489,em1_7492: bitstring,sigM1_7493: bitstring));
                                    {9514}let m1_7494: bitstring = dec(em1_7492,skSess_7114) in
                                    {9515}if (verify(h(m1_7494),sigM1_7493,pkCli_7489) <> true) then
                                        0
                                    else
                                        {9516}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7495: bitstring) = m1_7494 in
                                        {9517}new Ns_7496: bitstring;
                                        {9518}new ST_7497: bitstring;
                                        {9519}new TTL_7498: bitstring;
                                        {9520}let gNs_7499: bitstring = exp(g,Ns_7496) in
                                        {9521}let m2_7500: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7499,ST_7497,TTL_7498) in
                                        {9522}event beginSrv(Sess_5025,Cli_5023,gNs_7499);
                                        {9523}out(c, (enc(m2_7500,pkCli_7489),sign(h(m2_7500),skSess_7114)));
                                        {9524}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9525}event endSrv(Cli_5023,Sess_5025,PartC_7495)
                                )
                                else
                                    {9526}let v_7501: bool = (Disco_5024 = B) in
                                    (
                                        {9527}if v_7501 then
                                        (
                                            {9528}let pkDisco_7502: bitstring = pub(skB) in
                                            {9529}in(c, (=pkCli_7489,em1_7503: bitstring,sigM1_7504: bitstring));
                                            {9530}let m1_7505: bitstring = dec(em1_7503,skSess_7114) in
                                            {9531}if (verify(h(m1_7505),sigM1_7504,pkCli_7489) <> true) then
                                                0
                                            else
                                                {9532}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7506: bitstring) = m1_7505 in
                                                {9533}new Ns_7507: bitstring;
                                                {9534}new ST_7508: bitstring;
                                                {9535}new TTL_7509: bitstring;
                                                {9536}let gNs_7510: bitstring = exp(g,Ns_7507) in
                                                {9537}let m2_7511: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7510,ST_7508,TTL_7509) in
                                                {9538}event beginSrv(Sess_5025,Cli_5023,gNs_7510);
                                                {9539}out(c, (enc(m2_7511,pkCli_7489),sign(h(m2_7511),skSess_7114)));
                                                {9540}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9541}event endSrv(Cli_5023,Sess_5025,PartC_7506)
                                        )
                                        else
                                            {9542}let v_7512: bool = (Disco_5024 = C) in
                                            (
                                                {9543}if v_7512 then
                                                (
                                                    {9544}let pkDisco_7513: bitstring = pub(skC) in
                                                    {9545}in(c, (=pkCli_7489,em1_7514: bitstring,sigM1_7515: bitstring));
                                                    {9546}let m1_7516: bitstring = dec(em1_7514,skSess_7114) in
                                                    {9547}if (verify(h(m1_7516),sigM1_7515,pkCli_7489) <> true) then
                                                        0
                                                    else
                                                        {9548}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7517: bitstring) = m1_7516 in
                                                        {9549}new Ns_7518: bitstring;
                                                        {9550}new ST_7519: bitstring;
                                                        {9551}new TTL_7520: bitstring;
                                                        {9552}let gNs_7521: bitstring = exp(g,Ns_7518) in
                                                        {9553}let m2_7522: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7521,ST_7519,TTL_7520) in
                                                        {9554}event beginSrv(Sess_5025,Cli_5023,gNs_7521);
                                                        {9555}out(c, (enc(m2_7522,pkCli_7489),sign(h(m2_7522),skSess_7114)));
                                                        {9556}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9557}event endSrv(Cli_5023,Sess_5025,PartC_7517)
                                                )
                                                else
                                                    {9558}let pkDisco_7523: bitstring = pub(sk(Disco_5024)) in
                                                    {9559}in(c, (=pkCli_7489,em1_7524: bitstring,sigM1_7525: bitstring));
                                                    {9560}let m1_7526: bitstring = dec(em1_7524,skSess_7114) in
                                                    {9561}if (verify(h(m1_7526),sigM1_7525,pkCli_7489) <> true) then
                                                        0
                                                    else
                                                        {9562}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7527: bitstring) = m1_7526 in
                                                        {9563}new Ns_7528: bitstring;
                                                        {9564}new ST_7529: bitstring;
                                                        {9565}new TTL_7530: bitstring;
                                                        {9566}let gNs_7531: bitstring = exp(g,Ns_7528) in
                                                        {9567}let m2_7532: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7531,ST_7529,TTL_7530) in
                                                        {9568}event beginSrv(Sess_5025,Cli_5023,gNs_7531);
                                                        {9569}out(c, (enc(m2_7532,pkCli_7489),sign(h(m2_7532),skSess_7114)));
                                                        {9570}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {9571}event endSrv(Cli_5023,Sess_5025,PartC_7527)
                                            )
                                            else
                                                {9572}let pkDisco_7533: bitstring = fail-any in
                                                {9573}in(c, (=pkCli_7489,em1_7534: bitstring,sigM1_7535: bitstring));
                                                {9574}let m1_7536: bitstring = dec(em1_7534,skSess_7114) in
                                                {9575}if (verify(h(m1_7536),sigM1_7535,pkCli_7489) <> true) then
                                                    0
                                                else
                                                    {9576}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7537: bitstring) = m1_7536 in
                                                    {9577}new Ns_7538: bitstring;
                                                    {9578}new ST_7539: bitstring;
                                                    {9579}new TTL_7540: bitstring;
                                                    {9580}let gNs_7541: bitstring = exp(g,Ns_7538) in
                                                    {9581}let m2_7542: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7541,ST_7539,TTL_7540) in
                                                    {9582}event beginSrv(Sess_5025,Cli_5023,gNs_7541);
                                                    {9583}out(c, (enc(m2_7542,pkCli_7489),sign(h(m2_7542),skSess_7114)));
                                                    {9584}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9585}event endSrv(Cli_5023,Sess_5025,PartC_7537)
                                    )
                                    else
                                        {9586}let pkDisco_7543: bitstring = fail-any in
                                        {9587}in(c, (=pkCli_7489,em1_7544: bitstring,sigM1_7545: bitstring));
                                        {9588}let m1_7546: bitstring = dec(em1_7544,skSess_7114) in
                                        {9589}if (verify(h(m1_7546),sigM1_7545,pkCli_7489) <> true) then
                                            0
                                        else
                                            {9590}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7547: bitstring) = m1_7546 in
                                            {9591}new Ns_7548: bitstring;
                                            {9592}new ST_7549: bitstring;
                                            {9593}new TTL_7550: bitstring;
                                            {9594}let gNs_7551: bitstring = exp(g,Ns_7548) in
                                            {9595}let m2_7552: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7551,ST_7549,TTL_7550) in
                                            {9596}event beginSrv(Sess_5025,Cli_5023,gNs_7551);
                                            {9597}out(c, (enc(m2_7552,pkCli_7489),sign(h(m2_7552),skSess_7114)));
                                            {9598}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9599}event endSrv(Cli_5023,Sess_5025,PartC_7547)
                            )
                            else
                                {9600}let pkDisco_7553: bitstring = fail-any in
                                {9601}in(c, (=pkCli_7489,em1_7554: bitstring,sigM1_7555: bitstring));
                                {9602}let m1_7556: bitstring = dec(em1_7554,skSess_7114) in
                                {9603}if (verify(h(m1_7556),sigM1_7555,pkCli_7489) <> true) then
                                    0
                                else
                                    {9604}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7489,PartC_7557: bitstring) = m1_7556 in
                                    {9605}new Ns_7558: bitstring;
                                    {9606}new ST_7559: bitstring;
                                    {9607}new TTL_7560: bitstring;
                                    {9608}let gNs_7561: bitstring = exp(g,Ns_7558) in
                                    {9609}let m2_7562: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7561,ST_7559,TTL_7560) in
                                    {9610}event beginSrv(Sess_5025,Cli_5023,gNs_7561);
                                    {9611}out(c, (enc(m2_7562,pkCli_7489),sign(h(m2_7562),skSess_7114)));
                                    {9612}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9613}event endSrv(Cli_5023,Sess_5025,PartC_7557)
                )
                else
                    {9614}let pkCli_7563: bitstring = fail-any in
                    {9615}let v_7564: bool = (Disco_5024 = A) in
                    (
                        {9616}if v_7564 then
                        (
                            {9617}let pkDisco_7565: bitstring = pub(skA) in
                            {9618}in(c, (=pkCli_7563,em1_7566: bitstring,sigM1_7567: bitstring));
                            {9619}let m1_7568: bitstring = dec(em1_7566,skSess_7114) in
                            {9620}if (verify(h(m1_7568),sigM1_7567,pkCli_7563) <> true) then
                                0
                            else
                                {9621}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7569: bitstring) = m1_7568 in
                                {9622}new Ns_7570: bitstring;
                                {9623}new ST_7571: bitstring;
                                {9624}new TTL_7572: bitstring;
                                {9625}let gNs_7573: bitstring = exp(g,Ns_7570) in
                                {9626}let m2_7574: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7573,ST_7571,TTL_7572) in
                                {9627}event beginSrv(Sess_5025,Cli_5023,gNs_7573);
                                {9628}out(c, (enc(m2_7574,pkCli_7563),sign(h(m2_7574),skSess_7114)));
                                {9629}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9630}event endSrv(Cli_5023,Sess_5025,PartC_7569)
                        )
                        else
                            {9631}let v_7575: bool = (Disco_5024 = B) in
                            (
                                {9632}if v_7575 then
                                (
                                    {9633}let pkDisco_7576: bitstring = pub(skB) in
                                    {9634}in(c, (=pkCli_7563,em1_7577: bitstring,sigM1_7578: bitstring));
                                    {9635}let m1_7579: bitstring = dec(em1_7577,skSess_7114) in
                                    {9636}if (verify(h(m1_7579),sigM1_7578,pkCli_7563) <> true) then
                                        0
                                    else
                                        {9637}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7580: bitstring) = m1_7579 in
                                        {9638}new Ns_7581: bitstring;
                                        {9639}new ST_7582: bitstring;
                                        {9640}new TTL_7583: bitstring;
                                        {9641}let gNs_7584: bitstring = exp(g,Ns_7581) in
                                        {9642}let m2_7585: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7584,ST_7582,TTL_7583) in
                                        {9643}event beginSrv(Sess_5025,Cli_5023,gNs_7584);
                                        {9644}out(c, (enc(m2_7585,pkCli_7563),sign(h(m2_7585),skSess_7114)));
                                        {9645}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9646}event endSrv(Cli_5023,Sess_5025,PartC_7580)
                                )
                                else
                                    {9647}let v_7586: bool = (Disco_5024 = C) in
                                    (
                                        {9648}if v_7586 then
                                        (
                                            {9649}let pkDisco_7587: bitstring = pub(skC) in
                                            {9650}in(c, (=pkCli_7563,em1_7588: bitstring,sigM1_7589: bitstring));
                                            {9651}let m1_7590: bitstring = dec(em1_7588,skSess_7114) in
                                            {9652}if (verify(h(m1_7590),sigM1_7589,pkCli_7563) <> true) then
                                                0
                                            else
                                                {9653}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7591: bitstring) = m1_7590 in
                                                {9654}new Ns_7592: bitstring;
                                                {9655}new ST_7593: bitstring;
                                                {9656}new TTL_7594: bitstring;
                                                {9657}let gNs_7595: bitstring = exp(g,Ns_7592) in
                                                {9658}let m2_7596: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7595,ST_7593,TTL_7594) in
                                                {9659}event beginSrv(Sess_5025,Cli_5023,gNs_7595);
                                                {9660}out(c, (enc(m2_7596,pkCli_7563),sign(h(m2_7596),skSess_7114)));
                                                {9661}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9662}event endSrv(Cli_5023,Sess_5025,PartC_7591)
                                        )
                                        else
                                            {9663}let pkDisco_7597: bitstring = pub(sk(Disco_5024)) in
                                            {9664}in(c, (=pkCli_7563,em1_7598: bitstring,sigM1_7599: bitstring));
                                            {9665}let m1_7600: bitstring = dec(em1_7598,skSess_7114) in
                                            {9666}if (verify(h(m1_7600),sigM1_7599,pkCli_7563) <> true) then
                                                0
                                            else
                                                {9667}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7601: bitstring) = m1_7600 in
                                                {9668}new Ns_7602: bitstring;
                                                {9669}new ST_7603: bitstring;
                                                {9670}new TTL_7604: bitstring;
                                                {9671}let gNs_7605: bitstring = exp(g,Ns_7602) in
                                                {9672}let m2_7606: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7605,ST_7603,TTL_7604) in
                                                {9673}event beginSrv(Sess_5025,Cli_5023,gNs_7605);
                                                {9674}out(c, (enc(m2_7606,pkCli_7563),sign(h(m2_7606),skSess_7114)));
                                                {9675}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9676}event endSrv(Cli_5023,Sess_5025,PartC_7601)
                                    )
                                    else
                                        {9677}let pkDisco_7607: bitstring = fail-any in
                                        {9678}in(c, (=pkCli_7563,em1_7608: bitstring,sigM1_7609: bitstring));
                                        {9679}let m1_7610: bitstring = dec(em1_7608,skSess_7114) in
                                        {9680}if (verify(h(m1_7610),sigM1_7609,pkCli_7563) <> true) then
                                            0
                                        else
                                            {9681}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7611: bitstring) = m1_7610 in
                                            {9682}new Ns_7612: bitstring;
                                            {9683}new ST_7613: bitstring;
                                            {9684}new TTL_7614: bitstring;
                                            {9685}let gNs_7615: bitstring = exp(g,Ns_7612) in
                                            {9686}let m2_7616: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7615,ST_7613,TTL_7614) in
                                            {9687}event beginSrv(Sess_5025,Cli_5023,gNs_7615);
                                            {9688}out(c, (enc(m2_7616,pkCli_7563),sign(h(m2_7616),skSess_7114)));
                                            {9689}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9690}event endSrv(Cli_5023,Sess_5025,PartC_7611)
                            )
                            else
                                {9691}let pkDisco_7617: bitstring = fail-any in
                                {9692}in(c, (=pkCli_7563,em1_7618: bitstring,sigM1_7619: bitstring));
                                {9693}let m1_7620: bitstring = dec(em1_7618,skSess_7114) in
                                {9694}if (verify(h(m1_7620),sigM1_7619,pkCli_7563) <> true) then
                                    0
                                else
                                    {9695}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7621: bitstring) = m1_7620 in
                                    {9696}new Ns_7622: bitstring;
                                    {9697}new ST_7623: bitstring;
                                    {9698}new TTL_7624: bitstring;
                                    {9699}let gNs_7625: bitstring = exp(g,Ns_7622) in
                                    {9700}let m2_7626: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7625,ST_7623,TTL_7624) in
                                    {9701}event beginSrv(Sess_5025,Cli_5023,gNs_7625);
                                    {9702}out(c, (enc(m2_7626,pkCli_7563),sign(h(m2_7626),skSess_7114)));
                                    {9703}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9704}event endSrv(Cli_5023,Sess_5025,PartC_7621)
                    )
                    else
                        {9705}let pkDisco_7627: bitstring = fail-any in
                        {9706}in(c, (=pkCli_7563,em1_7628: bitstring,sigM1_7629: bitstring));
                        {9707}let m1_7630: bitstring = dec(em1_7628,skSess_7114) in
                        {9708}if (verify(h(m1_7630),sigM1_7629,pkCli_7563) <> true) then
                            0
                        else
                            {9709}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7563,PartC_7631: bitstring) = m1_7630 in
                            {9710}new Ns_7632: bitstring;
                            {9711}new ST_7633: bitstring;
                            {9712}new TTL_7634: bitstring;
                            {9713}let gNs_7635: bitstring = exp(g,Ns_7632) in
                            {9714}let m2_7636: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7635,ST_7633,TTL_7634) in
                            {9715}event beginSrv(Sess_5025,Cli_5023,gNs_7635);
                            {9716}out(c, (enc(m2_7636,pkCli_7563),sign(h(m2_7636),skSess_7114)));
                            {9717}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {9718}event endSrv(Cli_5023,Sess_5025,PartC_7631)
    )
    else
        {9719}let skSess_7637: bitstring = fail-any in
        {9720}let pkSess_7638: bitstring = pub(skSess_7637) in
        {9721}let v_7639: bool = (Cli_5023 = A) in
        (
            {9722}if v_7639 then
            (
                {9723}let pkCli_7640: bitstring = pub(skA) in
                {9724}let v_7641: bool = (Disco_5024 = A) in
                (
                    {9725}if v_7641 then
                    (
                        {9726}let pkDisco_7642: bitstring = pub(skA) in
                        {9727}in(c, (=pkCli_7640,em1_7643: bitstring,sigM1_7644: bitstring));
                        {9728}let m1_7645: bitstring = dec(em1_7643,skSess_7637) in
                        {9729}if (verify(h(m1_7645),sigM1_7644,pkCli_7640) <> true) then
                            0
                        else
                            {9730}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7646: bitstring) = m1_7645 in
                            {9731}new Ns_7647: bitstring;
                            {9732}new ST_7648: bitstring;
                            {9733}new TTL_7649: bitstring;
                            {9734}let gNs_7650: bitstring = exp(g,Ns_7647) in
                            {9735}let m2_7651: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7650,ST_7648,TTL_7649) in
                            {9736}event beginSrv(Sess_5025,Cli_5023,gNs_7650);
                            {9737}out(c, (enc(m2_7651,pkCli_7640),sign(h(m2_7651),skSess_7637)));
                            {9738}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {9739}event endSrv(Cli_5023,Sess_5025,PartC_7646)
                    )
                    else
                        {9740}let v_7652: bool = (Disco_5024 = B) in
                        (
                            {9741}if v_7652 then
                            (
                                {9742}let pkDisco_7653: bitstring = pub(skB) in
                                {9743}in(c, (=pkCli_7640,em1_7654: bitstring,sigM1_7655: bitstring));
                                {9744}let m1_7656: bitstring = dec(em1_7654,skSess_7637) in
                                {9745}if (verify(h(m1_7656),sigM1_7655,pkCli_7640) <> true) then
                                    0
                                else
                                    {9746}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7657: bitstring) = m1_7656 in
                                    {9747}new Ns_7658: bitstring;
                                    {9748}new ST_7659: bitstring;
                                    {9749}new TTL_7660: bitstring;
                                    {9750}let gNs_7661: bitstring = exp(g,Ns_7658) in
                                    {9751}let m2_7662: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7661,ST_7659,TTL_7660) in
                                    {9752}event beginSrv(Sess_5025,Cli_5023,gNs_7661);
                                    {9753}out(c, (enc(m2_7662,pkCli_7640),sign(h(m2_7662),skSess_7637)));
                                    {9754}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9755}event endSrv(Cli_5023,Sess_5025,PartC_7657)
                            )
                            else
                                {9756}let v_7663: bool = (Disco_5024 = C) in
                                (
                                    {9757}if v_7663 then
                                    (
                                        {9758}let pkDisco_7664: bitstring = pub(skC) in
                                        {9759}in(c, (=pkCli_7640,em1_7665: bitstring,sigM1_7666: bitstring));
                                        {9760}let m1_7667: bitstring = dec(em1_7665,skSess_7637) in
                                        {9761}if (verify(h(m1_7667),sigM1_7666,pkCli_7640) <> true) then
                                            0
                                        else
                                            {9762}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7668: bitstring) = m1_7667 in
                                            {9763}new Ns_7669: bitstring;
                                            {9764}new ST_7670: bitstring;
                                            {9765}new TTL_7671: bitstring;
                                            {9766}let gNs_7672: bitstring = exp(g,Ns_7669) in
                                            {9767}let m2_7673: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7672,ST_7670,TTL_7671) in
                                            {9768}event beginSrv(Sess_5025,Cli_5023,gNs_7672);
                                            {9769}out(c, (enc(m2_7673,pkCli_7640),sign(h(m2_7673),skSess_7637)));
                                            {9770}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9771}event endSrv(Cli_5023,Sess_5025,PartC_7668)
                                    )
                                    else
                                        {9772}let pkDisco_7674: bitstring = pub(sk(Disco_5024)) in
                                        {9773}in(c, (=pkCli_7640,em1_7675: bitstring,sigM1_7676: bitstring));
                                        {9774}let m1_7677: bitstring = dec(em1_7675,skSess_7637) in
                                        {9775}if (verify(h(m1_7677),sigM1_7676,pkCli_7640) <> true) then
                                            0
                                        else
                                            {9776}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7678: bitstring) = m1_7677 in
                                            {9777}new Ns_7679: bitstring;
                                            {9778}new ST_7680: bitstring;
                                            {9779}new TTL_7681: bitstring;
                                            {9780}let gNs_7682: bitstring = exp(g,Ns_7679) in
                                            {9781}let m2_7683: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7682,ST_7680,TTL_7681) in
                                            {9782}event beginSrv(Sess_5025,Cli_5023,gNs_7682);
                                            {9783}out(c, (enc(m2_7683,pkCli_7640),sign(h(m2_7683),skSess_7637)));
                                            {9784}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9785}event endSrv(Cli_5023,Sess_5025,PartC_7678)
                                )
                                else
                                    {9786}let pkDisco_7684: bitstring = fail-any in
                                    {9787}in(c, (=pkCli_7640,em1_7685: bitstring,sigM1_7686: bitstring));
                                    {9788}let m1_7687: bitstring = dec(em1_7685,skSess_7637) in
                                    {9789}if (verify(h(m1_7687),sigM1_7686,pkCli_7640) <> true) then
                                        0
                                    else
                                        {9790}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7688: bitstring) = m1_7687 in
                                        {9791}new Ns_7689: bitstring;
                                        {9792}new ST_7690: bitstring;
                                        {9793}new TTL_7691: bitstring;
                                        {9794}let gNs_7692: bitstring = exp(g,Ns_7689) in
                                        {9795}let m2_7693: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7692,ST_7690,TTL_7691) in
                                        {9796}event beginSrv(Sess_5025,Cli_5023,gNs_7692);
                                        {9797}out(c, (enc(m2_7693,pkCli_7640),sign(h(m2_7693),skSess_7637)));
                                        {9798}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9799}event endSrv(Cli_5023,Sess_5025,PartC_7688)
                        )
                        else
                            {9800}let pkDisco_7694: bitstring = fail-any in
                            {9801}in(c, (=pkCli_7640,em1_7695: bitstring,sigM1_7696: bitstring));
                            {9802}let m1_7697: bitstring = dec(em1_7695,skSess_7637) in
                            {9803}if (verify(h(m1_7697),sigM1_7696,pkCli_7640) <> true) then
                                0
                            else
                                {9804}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7698: bitstring) = m1_7697 in
                                {9805}new Ns_7699: bitstring;
                                {9806}new ST_7700: bitstring;
                                {9807}new TTL_7701: bitstring;
                                {9808}let gNs_7702: bitstring = exp(g,Ns_7699) in
                                {9809}let m2_7703: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7702,ST_7700,TTL_7701) in
                                {9810}event beginSrv(Sess_5025,Cli_5023,gNs_7702);
                                {9811}out(c, (enc(m2_7703,pkCli_7640),sign(h(m2_7703),skSess_7637)));
                                {9812}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9813}event endSrv(Cli_5023,Sess_5025,PartC_7698)
                )
                else
                    {9814}let pkDisco_7704: bitstring = fail-any in
                    {9815}in(c, (=pkCli_7640,em1_7705: bitstring,sigM1_7706: bitstring));
                    {9816}let m1_7707: bitstring = dec(em1_7705,skSess_7637) in
                    {9817}if (verify(h(m1_7707),sigM1_7706,pkCli_7640) <> true) then
                        0
                    else
                        {9818}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7640,PartC_7708: bitstring) = m1_7707 in
                        {9819}new Ns_7709: bitstring;
                        {9820}new ST_7710: bitstring;
                        {9821}new TTL_7711: bitstring;
                        {9822}let gNs_7712: bitstring = exp(g,Ns_7709) in
                        {9823}let m2_7713: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7712,ST_7710,TTL_7711) in
                        {9824}event beginSrv(Sess_5025,Cli_5023,gNs_7712);
                        {9825}out(c, (enc(m2_7713,pkCli_7640),sign(h(m2_7713),skSess_7637)));
                        {9826}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                        {9827}event endSrv(Cli_5023,Sess_5025,PartC_7708)
            )
            else
                {9828}let v_7714: bool = (Cli_5023 = B) in
                (
                    {9829}if v_7714 then
                    (
                        {9830}let pkCli_7715: bitstring = pub(skB) in
                        {9831}let v_7716: bool = (Disco_5024 = A) in
                        (
                            {9832}if v_7716 then
                            (
                                {9833}let pkDisco_7717: bitstring = pub(skA) in
                                {9834}in(c, (=pkCli_7715,em1_7718: bitstring,sigM1_7719: bitstring));
                                {9835}let m1_7720: bitstring = dec(em1_7718,skSess_7637) in
                                {9836}if (verify(h(m1_7720),sigM1_7719,pkCli_7715) <> true) then
                                    0
                                else
                                    {9837}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7721: bitstring) = m1_7720 in
                                    {9838}new Ns_7722: bitstring;
                                    {9839}new ST_7723: bitstring;
                                    {9840}new TTL_7724: bitstring;
                                    {9841}let gNs_7725: bitstring = exp(g,Ns_7722) in
                                    {9842}let m2_7726: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7725,ST_7723,TTL_7724) in
                                    {9843}event beginSrv(Sess_5025,Cli_5023,gNs_7725);
                                    {9844}out(c, (enc(m2_7726,pkCli_7715),sign(h(m2_7726),skSess_7637)));
                                    {9845}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {9846}event endSrv(Cli_5023,Sess_5025,PartC_7721)
                            )
                            else
                                {9847}let v_7727: bool = (Disco_5024 = B) in
                                (
                                    {9848}if v_7727 then
                                    (
                                        {9849}let pkDisco_7728: bitstring = pub(skB) in
                                        {9850}in(c, (=pkCli_7715,em1_7729: bitstring,sigM1_7730: bitstring));
                                        {9851}let m1_7731: bitstring = dec(em1_7729,skSess_7637) in
                                        {9852}if (verify(h(m1_7731),sigM1_7730,pkCli_7715) <> true) then
                                            0
                                        else
                                            {9853}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7732: bitstring) = m1_7731 in
                                            {9854}new Ns_7733: bitstring;
                                            {9855}new ST_7734: bitstring;
                                            {9856}new TTL_7735: bitstring;
                                            {9857}let gNs_7736: bitstring = exp(g,Ns_7733) in
                                            {9858}let m2_7737: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7736,ST_7734,TTL_7735) in
                                            {9859}event beginSrv(Sess_5025,Cli_5023,gNs_7736);
                                            {9860}out(c, (enc(m2_7737,pkCli_7715),sign(h(m2_7737),skSess_7637)));
                                            {9861}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9862}event endSrv(Cli_5023,Sess_5025,PartC_7732)
                                    )
                                    else
                                        {9863}let v_7738: bool = (Disco_5024 = C) in
                                        (
                                            {9864}if v_7738 then
                                            (
                                                {9865}let pkDisco_7739: bitstring = pub(skC) in
                                                {9866}in(c, (=pkCli_7715,em1_7740: bitstring,sigM1_7741: bitstring));
                                                {9867}let m1_7742: bitstring = dec(em1_7740,skSess_7637) in
                                                {9868}if (verify(h(m1_7742),sigM1_7741,pkCli_7715) <> true) then
                                                    0
                                                else
                                                    {9869}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7743: bitstring) = m1_7742 in
                                                    {9870}new Ns_7744: bitstring;
                                                    {9871}new ST_7745: bitstring;
                                                    {9872}new TTL_7746: bitstring;
                                                    {9873}let gNs_7747: bitstring = exp(g,Ns_7744) in
                                                    {9874}let m2_7748: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7747,ST_7745,TTL_7746) in
                                                    {9875}event beginSrv(Sess_5025,Cli_5023,gNs_7747);
                                                    {9876}out(c, (enc(m2_7748,pkCli_7715),sign(h(m2_7748),skSess_7637)));
                                                    {9877}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9878}event endSrv(Cli_5023,Sess_5025,PartC_7743)
                                            )
                                            else
                                                {9879}let pkDisco_7749: bitstring = pub(sk(Disco_5024)) in
                                                {9880}in(c, (=pkCli_7715,em1_7750: bitstring,sigM1_7751: bitstring));
                                                {9881}let m1_7752: bitstring = dec(em1_7750,skSess_7637) in
                                                {9882}if (verify(h(m1_7752),sigM1_7751,pkCli_7715) <> true) then
                                                    0
                                                else
                                                    {9883}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7753: bitstring) = m1_7752 in
                                                    {9884}new Ns_7754: bitstring;
                                                    {9885}new ST_7755: bitstring;
                                                    {9886}new TTL_7756: bitstring;
                                                    {9887}let gNs_7757: bitstring = exp(g,Ns_7754) in
                                                    {9888}let m2_7758: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7757,ST_7755,TTL_7756) in
                                                    {9889}event beginSrv(Sess_5025,Cli_5023,gNs_7757);
                                                    {9890}out(c, (enc(m2_7758,pkCli_7715),sign(h(m2_7758),skSess_7637)));
                                                    {9891}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9892}event endSrv(Cli_5023,Sess_5025,PartC_7753)
                                        )
                                        else
                                            {9893}let pkDisco_7759: bitstring = fail-any in
                                            {9894}in(c, (=pkCli_7715,em1_7760: bitstring,sigM1_7761: bitstring));
                                            {9895}let m1_7762: bitstring = dec(em1_7760,skSess_7637) in
                                            {9896}if (verify(h(m1_7762),sigM1_7761,pkCli_7715) <> true) then
                                                0
                                            else
                                                {9897}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7763: bitstring) = m1_7762 in
                                                {9898}new Ns_7764: bitstring;
                                                {9899}new ST_7765: bitstring;
                                                {9900}new TTL_7766: bitstring;
                                                {9901}let gNs_7767: bitstring = exp(g,Ns_7764) in
                                                {9902}let m2_7768: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7767,ST_7765,TTL_7766) in
                                                {9903}event beginSrv(Sess_5025,Cli_5023,gNs_7767);
                                                {9904}out(c, (enc(m2_7768,pkCli_7715),sign(h(m2_7768),skSess_7637)));
                                                {9905}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {9906}event endSrv(Cli_5023,Sess_5025,PartC_7763)
                                )
                                else
                                    {9907}let pkDisco_7769: bitstring = fail-any in
                                    {9908}in(c, (=pkCli_7715,em1_7770: bitstring,sigM1_7771: bitstring));
                                    {9909}let m1_7772: bitstring = dec(em1_7770,skSess_7637) in
                                    {9910}if (verify(h(m1_7772),sigM1_7771,pkCli_7715) <> true) then
                                        0
                                    else
                                        {9911}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7773: bitstring) = m1_7772 in
                                        {9912}new Ns_7774: bitstring;
                                        {9913}new ST_7775: bitstring;
                                        {9914}new TTL_7776: bitstring;
                                        {9915}let gNs_7777: bitstring = exp(g,Ns_7774) in
                                        {9916}let m2_7778: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7777,ST_7775,TTL_7776) in
                                        {9917}event beginSrv(Sess_5025,Cli_5023,gNs_7777);
                                        {9918}out(c, (enc(m2_7778,pkCli_7715),sign(h(m2_7778),skSess_7637)));
                                        {9919}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {9920}event endSrv(Cli_5023,Sess_5025,PartC_7773)
                        )
                        else
                            {9921}let pkDisco_7779: bitstring = fail-any in
                            {9922}in(c, (=pkCli_7715,em1_7780: bitstring,sigM1_7781: bitstring));
                            {9923}let m1_7782: bitstring = dec(em1_7780,skSess_7637) in
                            {9924}if (verify(h(m1_7782),sigM1_7781,pkCli_7715) <> true) then
                                0
                            else
                                {9925}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7715,PartC_7783: bitstring) = m1_7782 in
                                {9926}new Ns_7784: bitstring;
                                {9927}new ST_7785: bitstring;
                                {9928}new TTL_7786: bitstring;
                                {9929}let gNs_7787: bitstring = exp(g,Ns_7784) in
                                {9930}let m2_7788: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7787,ST_7785,TTL_7786) in
                                {9931}event beginSrv(Sess_5025,Cli_5023,gNs_7787);
                                {9932}out(c, (enc(m2_7788,pkCli_7715),sign(h(m2_7788),skSess_7637)));
                                {9933}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {9934}event endSrv(Cli_5023,Sess_5025,PartC_7783)
                    )
                    else
                        {9935}let v_7789: bool = (Cli_5023 = C) in
                        (
                            {9936}if v_7789 then
                            (
                                {9937}let pkCli_7790: bitstring = pub(skC) in
                                {9938}let v_7791: bool = (Disco_5024 = A) in
                                (
                                    {9939}if v_7791 then
                                    (
                                        {9940}let pkDisco_7792: bitstring = pub(skA) in
                                        {9941}in(c, (=pkCli_7790,em1_7793: bitstring,sigM1_7794: bitstring));
                                        {9942}let m1_7795: bitstring = dec(em1_7793,skSess_7637) in
                                        {9943}if (verify(h(m1_7795),sigM1_7794,pkCli_7790) <> true) then
                                            0
                                        else
                                            {9944}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7796: bitstring) = m1_7795 in
                                            {9945}new Ns_7797: bitstring;
                                            {9946}new ST_7798: bitstring;
                                            {9947}new TTL_7799: bitstring;
                                            {9948}let gNs_7800: bitstring = exp(g,Ns_7797) in
                                            {9949}let m2_7801: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7800,ST_7798,TTL_7799) in
                                            {9950}event beginSrv(Sess_5025,Cli_5023,gNs_7800);
                                            {9951}out(c, (enc(m2_7801,pkCli_7790),sign(h(m2_7801),skSess_7637)));
                                            {9952}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {9953}event endSrv(Cli_5023,Sess_5025,PartC_7796)
                                    )
                                    else
                                        {9954}let v_7802: bool = (Disco_5024 = B) in
                                        (
                                            {9955}if v_7802 then
                                            (
                                                {9956}let pkDisco_7803: bitstring = pub(skB) in
                                                {9957}in(c, (=pkCli_7790,em1_7804: bitstring,sigM1_7805: bitstring));
                                                {9958}let m1_7806: bitstring = dec(em1_7804,skSess_7637) in
                                                {9959}if (verify(h(m1_7806),sigM1_7805,pkCli_7790) <> true) then
                                                    0
                                                else
                                                    {9960}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7807: bitstring) = m1_7806 in
                                                    {9961}new Ns_7808: bitstring;
                                                    {9962}new ST_7809: bitstring;
                                                    {9963}new TTL_7810: bitstring;
                                                    {9964}let gNs_7811: bitstring = exp(g,Ns_7808) in
                                                    {9965}let m2_7812: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7811,ST_7809,TTL_7810) in
                                                    {9966}event beginSrv(Sess_5025,Cli_5023,gNs_7811);
                                                    {9967}out(c, (enc(m2_7812,pkCli_7790),sign(h(m2_7812),skSess_7637)));
                                                    {9968}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {9969}event endSrv(Cli_5023,Sess_5025,PartC_7807)
                                            )
                                            else
                                                {9970}let v_7813: bool = (Disco_5024 = C) in
                                                (
                                                    {9971}if v_7813 then
                                                    (
                                                        {9972}let pkDisco_7814: bitstring = pub(skC) in
                                                        {9973}in(c, (=pkCli_7790,em1_7815: bitstring,sigM1_7816: bitstring));
                                                        {9974}let m1_7817: bitstring = dec(em1_7815,skSess_7637) in
                                                        {9975}if (verify(h(m1_7817),sigM1_7816,pkCli_7790) <> true) then
                                                            0
                                                        else
                                                            {9976}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7818: bitstring) = m1_7817 in
                                                            {9977}new Ns_7819: bitstring;
                                                            {9978}new ST_7820: bitstring;
                                                            {9979}new TTL_7821: bitstring;
                                                            {9980}let gNs_7822: bitstring = exp(g,Ns_7819) in
                                                            {9981}let m2_7823: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7822,ST_7820,TTL_7821) in
                                                            {9982}event beginSrv(Sess_5025,Cli_5023,gNs_7822);
                                                            {9983}out(c, (enc(m2_7823,pkCli_7790),sign(h(m2_7823),skSess_7637)));
                                                            {9984}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9985}event endSrv(Cli_5023,Sess_5025,PartC_7818)
                                                    )
                                                    else
                                                        {9986}let pkDisco_7824: bitstring = pub(sk(Disco_5024)) in
                                                        {9987}in(c, (=pkCli_7790,em1_7825: bitstring,sigM1_7826: bitstring));
                                                        {9988}let m1_7827: bitstring = dec(em1_7825,skSess_7637) in
                                                        {9989}if (verify(h(m1_7827),sigM1_7826,pkCli_7790) <> true) then
                                                            0
                                                        else
                                                            {9990}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7828: bitstring) = m1_7827 in
                                                            {9991}new Ns_7829: bitstring;
                                                            {9992}new ST_7830: bitstring;
                                                            {9993}new TTL_7831: bitstring;
                                                            {9994}let gNs_7832: bitstring = exp(g,Ns_7829) in
                                                            {9995}let m2_7833: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7832,ST_7830,TTL_7831) in
                                                            {9996}event beginSrv(Sess_5025,Cli_5023,gNs_7832);
                                                            {9997}out(c, (enc(m2_7833,pkCli_7790),sign(h(m2_7833),skSess_7637)));
                                                            {9998}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {9999}event endSrv(Cli_5023,Sess_5025,PartC_7828)
                                                )
                                                else
                                                    {10000}let pkDisco_7834: bitstring = fail-any in
                                                    {10001}in(c, (=pkCli_7790,em1_7835: bitstring,sigM1_7836: bitstring));
                                                    {10002}let m1_7837: bitstring = dec(em1_7835,skSess_7637) in
                                                    {10003}if (verify(h(m1_7837),sigM1_7836,pkCli_7790) <> true) then
                                                        0
                                                    else
                                                        {10004}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7838: bitstring) = m1_7837 in
                                                        {10005}new Ns_7839: bitstring;
                                                        {10006}new ST_7840: bitstring;
                                                        {10007}new TTL_7841: bitstring;
                                                        {10008}let gNs_7842: bitstring = exp(g,Ns_7839) in
                                                        {10009}let m2_7843: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7842,ST_7840,TTL_7841) in
                                                        {10010}event beginSrv(Sess_5025,Cli_5023,gNs_7842);
                                                        {10011}out(c, (enc(m2_7843,pkCli_7790),sign(h(m2_7843),skSess_7637)));
                                                        {10012}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {10013}event endSrv(Cli_5023,Sess_5025,PartC_7838)
                                        )
                                        else
                                            {10014}let pkDisco_7844: bitstring = fail-any in
                                            {10015}in(c, (=pkCli_7790,em1_7845: bitstring,sigM1_7846: bitstring));
                                            {10016}let m1_7847: bitstring = dec(em1_7845,skSess_7637) in
                                            {10017}if (verify(h(m1_7847),sigM1_7846,pkCli_7790) <> true) then
                                                0
                                            else
                                                {10018}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7848: bitstring) = m1_7847 in
                                                {10019}new Ns_7849: bitstring;
                                                {10020}new ST_7850: bitstring;
                                                {10021}new TTL_7851: bitstring;
                                                {10022}let gNs_7852: bitstring = exp(g,Ns_7849) in
                                                {10023}let m2_7853: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7852,ST_7850,TTL_7851) in
                                                {10024}event beginSrv(Sess_5025,Cli_5023,gNs_7852);
                                                {10025}out(c, (enc(m2_7853,pkCli_7790),sign(h(m2_7853),skSess_7637)));
                                                {10026}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10027}event endSrv(Cli_5023,Sess_5025,PartC_7848)
                                )
                                else
                                    {10028}let pkDisco_7854: bitstring = fail-any in
                                    {10029}in(c, (=pkCli_7790,em1_7855: bitstring,sigM1_7856: bitstring));
                                    {10030}let m1_7857: bitstring = dec(em1_7855,skSess_7637) in
                                    {10031}if (verify(h(m1_7857),sigM1_7856,pkCli_7790) <> true) then
                                        0
                                    else
                                        {10032}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7790,PartC_7858: bitstring) = m1_7857 in
                                        {10033}new Ns_7859: bitstring;
                                        {10034}new ST_7860: bitstring;
                                        {10035}new TTL_7861: bitstring;
                                        {10036}let gNs_7862: bitstring = exp(g,Ns_7859) in
                                        {10037}let m2_7863: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7862,ST_7860,TTL_7861) in
                                        {10038}event beginSrv(Sess_5025,Cli_5023,gNs_7862);
                                        {10039}out(c, (enc(m2_7863,pkCli_7790),sign(h(m2_7863),skSess_7637)));
                                        {10040}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10041}event endSrv(Cli_5023,Sess_5025,PartC_7858)
                            )
                            else
                                {10042}let pkCli_7864: bitstring = pub(sk(Cli_5023)) in
                                {10043}let v_7865: bool = (Disco_5024 = A) in
                                (
                                    {10044}if v_7865 then
                                    (
                                        {10045}let pkDisco_7866: bitstring = pub(skA) in
                                        {10046}in(c, (=pkCli_7864,em1_7867: bitstring,sigM1_7868: bitstring));
                                        {10047}let m1_7869: bitstring = dec(em1_7867,skSess_7637) in
                                        {10048}if (verify(h(m1_7869),sigM1_7868,pkCli_7864) <> true) then
                                            0
                                        else
                                            {10049}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7870: bitstring) = m1_7869 in
                                            {10050}new Ns_7871: bitstring;
                                            {10051}new ST_7872: bitstring;
                                            {10052}new TTL_7873: bitstring;
                                            {10053}let gNs_7874: bitstring = exp(g,Ns_7871) in
                                            {10054}let m2_7875: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7874,ST_7872,TTL_7873) in
                                            {10055}event beginSrv(Sess_5025,Cli_5023,gNs_7874);
                                            {10056}out(c, (enc(m2_7875,pkCli_7864),sign(h(m2_7875),skSess_7637)));
                                            {10057}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {10058}event endSrv(Cli_5023,Sess_5025,PartC_7870)
                                    )
                                    else
                                        {10059}let v_7876: bool = (Disco_5024 = B) in
                                        (
                                            {10060}if v_7876 then
                                            (
                                                {10061}let pkDisco_7877: bitstring = pub(skB) in
                                                {10062}in(c, (=pkCli_7864,em1_7878: bitstring,sigM1_7879: bitstring));
                                                {10063}let m1_7880: bitstring = dec(em1_7878,skSess_7637) in
                                                {10064}if (verify(h(m1_7880),sigM1_7879,pkCli_7864) <> true) then
                                                    0
                                                else
                                                    {10065}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7881: bitstring) = m1_7880 in
                                                    {10066}new Ns_7882: bitstring;
                                                    {10067}new ST_7883: bitstring;
                                                    {10068}new TTL_7884: bitstring;
                                                    {10069}let gNs_7885: bitstring = exp(g,Ns_7882) in
                                                    {10070}let m2_7886: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7885,ST_7883,TTL_7884) in
                                                    {10071}event beginSrv(Sess_5025,Cli_5023,gNs_7885);
                                                    {10072}out(c, (enc(m2_7886,pkCli_7864),sign(h(m2_7886),skSess_7637)));
                                                    {10073}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {10074}event endSrv(Cli_5023,Sess_5025,PartC_7881)
                                            )
                                            else
                                                {10075}let v_7887: bool = (Disco_5024 = C) in
                                                (
                                                    {10076}if v_7887 then
                                                    (
                                                        {10077}let pkDisco_7888: bitstring = pub(skC) in
                                                        {10078}in(c, (=pkCli_7864,em1_7889: bitstring,sigM1_7890: bitstring));
                                                        {10079}let m1_7891: bitstring = dec(em1_7889,skSess_7637) in
                                                        {10080}if (verify(h(m1_7891),sigM1_7890,pkCli_7864) <> true) then
                                                            0
                                                        else
                                                            {10081}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7892: bitstring) = m1_7891 in
                                                            {10082}new Ns_7893: bitstring;
                                                            {10083}new ST_7894: bitstring;
                                                            {10084}new TTL_7895: bitstring;
                                                            {10085}let gNs_7896: bitstring = exp(g,Ns_7893) in
                                                            {10086}let m2_7897: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7896,ST_7894,TTL_7895) in
                                                            {10087}event beginSrv(Sess_5025,Cli_5023,gNs_7896);
                                                            {10088}out(c, (enc(m2_7897,pkCli_7864),sign(h(m2_7897),skSess_7637)));
                                                            {10089}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {10090}event endSrv(Cli_5023,Sess_5025,PartC_7892)
                                                    )
                                                    else
                                                        {10091}let pkDisco_7898: bitstring = pub(sk(Disco_5024)) in
                                                        {10092}in(c, (=pkCli_7864,em1_7899: bitstring,sigM1_7900: bitstring));
                                                        {10093}let m1_7901: bitstring = dec(em1_7899,skSess_7637) in
                                                        {10094}if (verify(h(m1_7901),sigM1_7900,pkCli_7864) <> true) then
                                                            0
                                                        else
                                                            {10095}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7902: bitstring) = m1_7901 in
                                                            {10096}new Ns_7903: bitstring;
                                                            {10097}new ST_7904: bitstring;
                                                            {10098}new TTL_7905: bitstring;
                                                            {10099}let gNs_7906: bitstring = exp(g,Ns_7903) in
                                                            {10100}let m2_7907: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7906,ST_7904,TTL_7905) in
                                                            {10101}event beginSrv(Sess_5025,Cli_5023,gNs_7906);
                                                            {10102}out(c, (enc(m2_7907,pkCli_7864),sign(h(m2_7907),skSess_7637)));
                                                            {10103}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                            {10104}event endSrv(Cli_5023,Sess_5025,PartC_7902)
                                                )
                                                else
                                                    {10105}let pkDisco_7908: bitstring = fail-any in
                                                    {10106}in(c, (=pkCli_7864,em1_7909: bitstring,sigM1_7910: bitstring));
                                                    {10107}let m1_7911: bitstring = dec(em1_7909,skSess_7637) in
                                                    {10108}if (verify(h(m1_7911),sigM1_7910,pkCli_7864) <> true) then
                                                        0
                                                    else
                                                        {10109}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7912: bitstring) = m1_7911 in
                                                        {10110}new Ns_7913: bitstring;
                                                        {10111}new ST_7914: bitstring;
                                                        {10112}new TTL_7915: bitstring;
                                                        {10113}let gNs_7916: bitstring = exp(g,Ns_7913) in
                                                        {10114}let m2_7917: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7916,ST_7914,TTL_7915) in
                                                        {10115}event beginSrv(Sess_5025,Cli_5023,gNs_7916);
                                                        {10116}out(c, (enc(m2_7917,pkCli_7864),sign(h(m2_7917),skSess_7637)));
                                                        {10117}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {10118}event endSrv(Cli_5023,Sess_5025,PartC_7912)
                                        )
                                        else
                                            {10119}let pkDisco_7918: bitstring = fail-any in
                                            {10120}in(c, (=pkCli_7864,em1_7919: bitstring,sigM1_7920: bitstring));
                                            {10121}let m1_7921: bitstring = dec(em1_7919,skSess_7637) in
                                            {10122}if (verify(h(m1_7921),sigM1_7920,pkCli_7864) <> true) then
                                                0
                                            else
                                                {10123}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7922: bitstring) = m1_7921 in
                                                {10124}new Ns_7923: bitstring;
                                                {10125}new ST_7924: bitstring;
                                                {10126}new TTL_7925: bitstring;
                                                {10127}let gNs_7926: bitstring = exp(g,Ns_7923) in
                                                {10128}let m2_7927: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7926,ST_7924,TTL_7925) in
                                                {10129}event beginSrv(Sess_5025,Cli_5023,gNs_7926);
                                                {10130}out(c, (enc(m2_7927,pkCli_7864),sign(h(m2_7927),skSess_7637)));
                                                {10131}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10132}event endSrv(Cli_5023,Sess_5025,PartC_7922)
                                )
                                else
                                    {10133}let pkDisco_7928: bitstring = fail-any in
                                    {10134}in(c, (=pkCli_7864,em1_7929: bitstring,sigM1_7930: bitstring));
                                    {10135}let m1_7931: bitstring = dec(em1_7929,skSess_7637) in
                                    {10136}if (verify(h(m1_7931),sigM1_7930,pkCli_7864) <> true) then
                                        0
                                    else
                                        {10137}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7864,PartC_7932: bitstring) = m1_7931 in
                                        {10138}new Ns_7933: bitstring;
                                        {10139}new ST_7934: bitstring;
                                        {10140}new TTL_7935: bitstring;
                                        {10141}let gNs_7936: bitstring = exp(g,Ns_7933) in
                                        {10142}let m2_7937: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7936,ST_7934,TTL_7935) in
                                        {10143}event beginSrv(Sess_5025,Cli_5023,gNs_7936);
                                        {10144}out(c, (enc(m2_7937,pkCli_7864),sign(h(m2_7937),skSess_7637)));
                                        {10145}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10146}event endSrv(Cli_5023,Sess_5025,PartC_7932)
                        )
                        else
                            {10147}let pkCli_7938: bitstring = fail-any in
                            {10148}let v_7939: bool = (Disco_5024 = A) in
                            (
                                {10149}if v_7939 then
                                (
                                    {10150}let pkDisco_7940: bitstring = pub(skA) in
                                    {10151}in(c, (=pkCli_7938,em1_7941: bitstring,sigM1_7942: bitstring));
                                    {10152}let m1_7943: bitstring = dec(em1_7941,skSess_7637) in
                                    {10153}if (verify(h(m1_7943),sigM1_7942,pkCli_7938) <> true) then
                                        0
                                    else
                                        {10154}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_7944: bitstring) = m1_7943 in
                                        {10155}new Ns_7945: bitstring;
                                        {10156}new ST_7946: bitstring;
                                        {10157}new TTL_7947: bitstring;
                                        {10158}let gNs_7948: bitstring = exp(g,Ns_7945) in
                                        {10159}let m2_7949: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7948,ST_7946,TTL_7947) in
                                        {10160}event beginSrv(Sess_5025,Cli_5023,gNs_7948);
                                        {10161}out(c, (enc(m2_7949,pkCli_7938),sign(h(m2_7949),skSess_7637)));
                                        {10162}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10163}event endSrv(Cli_5023,Sess_5025,PartC_7944)
                                )
                                else
                                    {10164}let v_7950: bool = (Disco_5024 = B) in
                                    (
                                        {10165}if v_7950 then
                                        (
                                            {10166}let pkDisco_7951: bitstring = pub(skB) in
                                            {10167}in(c, (=pkCli_7938,em1_7952: bitstring,sigM1_7953: bitstring));
                                            {10168}let m1_7954: bitstring = dec(em1_7952,skSess_7637) in
                                            {10169}if (verify(h(m1_7954),sigM1_7953,pkCli_7938) <> true) then
                                                0
                                            else
                                                {10170}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_7955: bitstring) = m1_7954 in
                                                {10171}new Ns_7956: bitstring;
                                                {10172}new ST_7957: bitstring;
                                                {10173}new TTL_7958: bitstring;
                                                {10174}let gNs_7959: bitstring = exp(g,Ns_7956) in
                                                {10175}let m2_7960: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7959,ST_7957,TTL_7958) in
                                                {10176}event beginSrv(Sess_5025,Cli_5023,gNs_7959);
                                                {10177}out(c, (enc(m2_7960,pkCli_7938),sign(h(m2_7960),skSess_7637)));
                                                {10178}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10179}event endSrv(Cli_5023,Sess_5025,PartC_7955)
                                        )
                                        else
                                            {10180}let v_7961: bool = (Disco_5024 = C) in
                                            (
                                                {10181}if v_7961 then
                                                (
                                                    {10182}let pkDisco_7962: bitstring = pub(skC) in
                                                    {10183}in(c, (=pkCli_7938,em1_7963: bitstring,sigM1_7964: bitstring));
                                                    {10184}let m1_7965: bitstring = dec(em1_7963,skSess_7637) in
                                                    {10185}if (verify(h(m1_7965),sigM1_7964,pkCli_7938) <> true) then
                                                        0
                                                    else
                                                        {10186}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_7966: bitstring) = m1_7965 in
                                                        {10187}new Ns_7967: bitstring;
                                                        {10188}new ST_7968: bitstring;
                                                        {10189}new TTL_7969: bitstring;
                                                        {10190}let gNs_7970: bitstring = exp(g,Ns_7967) in
                                                        {10191}let m2_7971: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7970,ST_7968,TTL_7969) in
                                                        {10192}event beginSrv(Sess_5025,Cli_5023,gNs_7970);
                                                        {10193}out(c, (enc(m2_7971,pkCli_7938),sign(h(m2_7971),skSess_7637)));
                                                        {10194}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {10195}event endSrv(Cli_5023,Sess_5025,PartC_7966)
                                                )
                                                else
                                                    {10196}let pkDisco_7972: bitstring = pub(sk(Disco_5024)) in
                                                    {10197}in(c, (=pkCli_7938,em1_7973: bitstring,sigM1_7974: bitstring));
                                                    {10198}let m1_7975: bitstring = dec(em1_7973,skSess_7637) in
                                                    {10199}if (verify(h(m1_7975),sigM1_7974,pkCli_7938) <> true) then
                                                        0
                                                    else
                                                        {10200}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_7976: bitstring) = m1_7975 in
                                                        {10201}new Ns_7977: bitstring;
                                                        {10202}new ST_7978: bitstring;
                                                        {10203}new TTL_7979: bitstring;
                                                        {10204}let gNs_7980: bitstring = exp(g,Ns_7977) in
                                                        {10205}let m2_7981: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7980,ST_7978,TTL_7979) in
                                                        {10206}event beginSrv(Sess_5025,Cli_5023,gNs_7980);
                                                        {10207}out(c, (enc(m2_7981,pkCli_7938),sign(h(m2_7981),skSess_7637)));
                                                        {10208}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                        {10209}event endSrv(Cli_5023,Sess_5025,PartC_7976)
                                            )
                                            else
                                                {10210}let pkDisco_7982: bitstring = fail-any in
                                                {10211}in(c, (=pkCli_7938,em1_7983: bitstring,sigM1_7984: bitstring));
                                                {10212}let m1_7985: bitstring = dec(em1_7983,skSess_7637) in
                                                {10213}if (verify(h(m1_7985),sigM1_7984,pkCli_7938) <> true) then
                                                    0
                                                else
                                                    {10214}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_7986: bitstring) = m1_7985 in
                                                    {10215}new Ns_7987: bitstring;
                                                    {10216}new ST_7988: bitstring;
                                                    {10217}new TTL_7989: bitstring;
                                                    {10218}let gNs_7990: bitstring = exp(g,Ns_7987) in
                                                    {10219}let m2_7991: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_7990,ST_7988,TTL_7989) in
                                                    {10220}event beginSrv(Sess_5025,Cli_5023,gNs_7990);
                                                    {10221}out(c, (enc(m2_7991,pkCli_7938),sign(h(m2_7991),skSess_7637)));
                                                    {10222}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                    {10223}event endSrv(Cli_5023,Sess_5025,PartC_7986)
                                    )
                                    else
                                        {10224}let pkDisco_7992: bitstring = fail-any in
                                        {10225}in(c, (=pkCli_7938,em1_7993: bitstring,sigM1_7994: bitstring));
                                        {10226}let m1_7995: bitstring = dec(em1_7993,skSess_7637) in
                                        {10227}if (verify(h(m1_7995),sigM1_7994,pkCli_7938) <> true) then
                                            0
                                        else
                                            {10228}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_7996: bitstring) = m1_7995 in
                                            {10229}new Ns_7997: bitstring;
                                            {10230}new ST_7998: bitstring;
                                            {10231}new TTL_7999: bitstring;
                                            {10232}let gNs_8000: bitstring = exp(g,Ns_7997) in
                                            {10233}let m2_8001: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8000,ST_7998,TTL_7999) in
                                            {10234}event beginSrv(Sess_5025,Cli_5023,gNs_8000);
                                            {10235}out(c, (enc(m2_8001,pkCli_7938),sign(h(m2_8001),skSess_7637)));
                                            {10236}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {10237}event endSrv(Cli_5023,Sess_5025,PartC_7996)
                            )
                            else
                                {10238}let pkDisco_8002: bitstring = fail-any in
                                {10239}in(c, (=pkCli_7938,em1_8003: bitstring,sigM1_8004: bitstring));
                                {10240}let m1_8005: bitstring = dec(em1_8003,skSess_7637) in
                                {10241}if (verify(h(m1_8005),sigM1_8004,pkCli_7938) <> true) then
                                    0
                                else
                                    {10242}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_7938,PartC_8006: bitstring) = m1_8005 in
                                    {10243}new Ns_8007: bitstring;
                                    {10244}new ST_8008: bitstring;
                                    {10245}new TTL_8009: bitstring;
                                    {10246}let gNs_8010: bitstring = exp(g,Ns_8007) in
                                    {10247}let m2_8011: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8010,ST_8008,TTL_8009) in
                                    {10248}event beginSrv(Sess_5025,Cli_5023,gNs_8010);
                                    {10249}out(c, (enc(m2_8011,pkCli_7938),sign(h(m2_8011),skSess_7637)));
                                    {10250}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {10251}event endSrv(Cli_5023,Sess_5025,PartC_8006)
                )
                else
                    {10252}let pkCli_8012: bitstring = fail-any in
                    {10253}let v_8013: bool = (Disco_5024 = A) in
                    (
                        {10254}if v_8013 then
                        (
                            {10255}let pkDisco_8014: bitstring = pub(skA) in
                            {10256}in(c, (=pkCli_8012,em1_8015: bitstring,sigM1_8016: bitstring));
                            {10257}let m1_8017: bitstring = dec(em1_8015,skSess_7637) in
                            {10258}if (verify(h(m1_8017),sigM1_8016,pkCli_8012) <> true) then
                                0
                            else
                                {10259}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8018: bitstring) = m1_8017 in
                                {10260}new Ns_8019: bitstring;
                                {10261}new ST_8020: bitstring;
                                {10262}new TTL_8021: bitstring;
                                {10263}let gNs_8022: bitstring = exp(g,Ns_8019) in
                                {10264}let m2_8023: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8022,ST_8020,TTL_8021) in
                                {10265}event beginSrv(Sess_5025,Cli_5023,gNs_8022);
                                {10266}out(c, (enc(m2_8023,pkCli_8012),sign(h(m2_8023),skSess_7637)));
                                {10267}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {10268}event endSrv(Cli_5023,Sess_5025,PartC_8018)
                        )
                        else
                            {10269}let v_8024: bool = (Disco_5024 = B) in
                            (
                                {10270}if v_8024 then
                                (
                                    {10271}let pkDisco_8025: bitstring = pub(skB) in
                                    {10272}in(c, (=pkCli_8012,em1_8026: bitstring,sigM1_8027: bitstring));
                                    {10273}let m1_8028: bitstring = dec(em1_8026,skSess_7637) in
                                    {10274}if (verify(h(m1_8028),sigM1_8027,pkCli_8012) <> true) then
                                        0
                                    else
                                        {10275}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8029: bitstring) = m1_8028 in
                                        {10276}new Ns_8030: bitstring;
                                        {10277}new ST_8031: bitstring;
                                        {10278}new TTL_8032: bitstring;
                                        {10279}let gNs_8033: bitstring = exp(g,Ns_8030) in
                                        {10280}let m2_8034: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8033,ST_8031,TTL_8032) in
                                        {10281}event beginSrv(Sess_5025,Cli_5023,gNs_8033);
                                        {10282}out(c, (enc(m2_8034,pkCli_8012),sign(h(m2_8034),skSess_7637)));
                                        {10283}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10284}event endSrv(Cli_5023,Sess_5025,PartC_8029)
                                )
                                else
                                    {10285}let v_8035: bool = (Disco_5024 = C) in
                                    (
                                        {10286}if v_8035 then
                                        (
                                            {10287}let pkDisco_8036: bitstring = pub(skC) in
                                            {10288}in(c, (=pkCli_8012,em1_8037: bitstring,sigM1_8038: bitstring));
                                            {10289}let m1_8039: bitstring = dec(em1_8037,skSess_7637) in
                                            {10290}if (verify(h(m1_8039),sigM1_8038,pkCli_8012) <> true) then
                                                0
                                            else
                                                {10291}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8040: bitstring) = m1_8039 in
                                                {10292}new Ns_8041: bitstring;
                                                {10293}new ST_8042: bitstring;
                                                {10294}new TTL_8043: bitstring;
                                                {10295}let gNs_8044: bitstring = exp(g,Ns_8041) in
                                                {10296}let m2_8045: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8044,ST_8042,TTL_8043) in
                                                {10297}event beginSrv(Sess_5025,Cli_5023,gNs_8044);
                                                {10298}out(c, (enc(m2_8045,pkCli_8012),sign(h(m2_8045),skSess_7637)));
                                                {10299}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10300}event endSrv(Cli_5023,Sess_5025,PartC_8040)
                                        )
                                        else
                                            {10301}let pkDisco_8046: bitstring = pub(sk(Disco_5024)) in
                                            {10302}in(c, (=pkCli_8012,em1_8047: bitstring,sigM1_8048: bitstring));
                                            {10303}let m1_8049: bitstring = dec(em1_8047,skSess_7637) in
                                            {10304}if (verify(h(m1_8049),sigM1_8048,pkCli_8012) <> true) then
                                                0
                                            else
                                                {10305}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8050: bitstring) = m1_8049 in
                                                {10306}new Ns_8051: bitstring;
                                                {10307}new ST_8052: bitstring;
                                                {10308}new TTL_8053: bitstring;
                                                {10309}let gNs_8054: bitstring = exp(g,Ns_8051) in
                                                {10310}let m2_8055: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8054,ST_8052,TTL_8053) in
                                                {10311}event beginSrv(Sess_5025,Cli_5023,gNs_8054);
                                                {10312}out(c, (enc(m2_8055,pkCli_8012),sign(h(m2_8055),skSess_7637)));
                                                {10313}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                                {10314}event endSrv(Cli_5023,Sess_5025,PartC_8050)
                                    )
                                    else
                                        {10315}let pkDisco_8056: bitstring = fail-any in
                                        {10316}in(c, (=pkCli_8012,em1_8057: bitstring,sigM1_8058: bitstring));
                                        {10317}let m1_8059: bitstring = dec(em1_8057,skSess_7637) in
                                        {10318}if (verify(h(m1_8059),sigM1_8058,pkCli_8012) <> true) then
                                            0
                                        else
                                            {10319}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8060: bitstring) = m1_8059 in
                                            {10320}new Ns_8061: bitstring;
                                            {10321}new ST_8062: bitstring;
                                            {10322}new TTL_8063: bitstring;
                                            {10323}let gNs_8064: bitstring = exp(g,Ns_8061) in
                                            {10324}let m2_8065: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8064,ST_8062,TTL_8063) in
                                            {10325}event beginSrv(Sess_5025,Cli_5023,gNs_8064);
                                            {10326}out(c, (enc(m2_8065,pkCli_8012),sign(h(m2_8065),skSess_7637)));
                                            {10327}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                            {10328}event endSrv(Cli_5023,Sess_5025,PartC_8060)
                            )
                            else
                                {10329}let pkDisco_8066: bitstring = fail-any in
                                {10330}in(c, (=pkCli_8012,em1_8067: bitstring,sigM1_8068: bitstring));
                                {10331}let m1_8069: bitstring = dec(em1_8067,skSess_7637) in
                                {10332}if (verify(h(m1_8069),sigM1_8068,pkCli_8012) <> true) then
                                    0
                                else
                                    {10333}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8070: bitstring) = m1_8069 in
                                    {10334}new Ns_8071: bitstring;
                                    {10335}new ST_8072: bitstring;
                                    {10336}new TTL_8073: bitstring;
                                    {10337}let gNs_8074: bitstring = exp(g,Ns_8071) in
                                    {10338}let m2_8075: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8074,ST_8072,TTL_8073) in
                                    {10339}event beginSrv(Sess_5025,Cli_5023,gNs_8074);
                                    {10340}out(c, (enc(m2_8075,pkCli_8012),sign(h(m2_8075),skSess_7637)));
                                    {10341}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {10342}event endSrv(Cli_5023,Sess_5025,PartC_8070)
                    )
                    else
                        {10343}let pkDisco_8076: bitstring = fail-any in
                        {10344}in(c, (=pkCli_8012,em1_8077: bitstring,sigM1_8078: bitstring));
                        {10345}let m1_8079: bitstring = dec(em1_8077,skSess_7637) in
                        {10346}if (verify(h(m1_8079),sigM1_8078,pkCli_8012) <> true) then
                            0
                        else
                            {10347}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8012,PartC_8080: bitstring) = m1_8079 in
                            {10348}new Ns_8081: bitstring;
                            {10349}new ST_8082: bitstring;
                            {10350}new TTL_8083: bitstring;
                            {10351}let gNs_8084: bitstring = exp(g,Ns_8081) in
                            {10352}let m2_8085: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8084,ST_8082,TTL_8083) in
                            {10353}event beginSrv(Sess_5025,Cli_5023,gNs_8084);
                            {10354}out(c, (enc(m2_8085,pkCli_8012),sign(h(m2_8085),skSess_7637)));
                            {10355}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {10356}event endSrv(Cli_5023,Sess_5025,PartC_8080)
        )
        else
            {10357}let pkCli_8086: bitstring = fail-any in
            {10358}let v_8087: bool = (Disco_5024 = A) in
            (
                {10359}if v_8087 then
                (
                    {10360}let pkDisco_8088: bitstring = pub(skA) in
                    {10361}in(c, (=pkCli_8086,em1_8089: bitstring,sigM1_8090: bitstring));
                    {10362}let m1_8091: bitstring = dec(em1_8089,skSess_7637) in
                    {10363}if (verify(h(m1_8091),sigM1_8090,pkCli_8086) <> true) then
                        0
                    else
                        {10364}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8092: bitstring) = m1_8091 in
                        {10365}new Ns_8093: bitstring;
                        {10366}new ST_8094: bitstring;
                        {10367}new TTL_8095: bitstring;
                        {10368}let gNs_8096: bitstring = exp(g,Ns_8093) in
                        {10369}let m2_8097: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8096,ST_8094,TTL_8095) in
                        {10370}event beginSrv(Sess_5025,Cli_5023,gNs_8096);
                        {10371}out(c, (enc(m2_8097,pkCli_8086),sign(h(m2_8097),skSess_7637)));
                        {10372}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                        {10373}event endSrv(Cli_5023,Sess_5025,PartC_8092)
                )
                else
                    {10374}let v_8098: bool = (Disco_5024 = B) in
                    (
                        {10375}if v_8098 then
                        (
                            {10376}let pkDisco_8099: bitstring = pub(skB) in
                            {10377}in(c, (=pkCli_8086,em1_8100: bitstring,sigM1_8101: bitstring));
                            {10378}let m1_8102: bitstring = dec(em1_8100,skSess_7637) in
                            {10379}if (verify(h(m1_8102),sigM1_8101,pkCli_8086) <> true) then
                                0
                            else
                                {10380}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8103: bitstring) = m1_8102 in
                                {10381}new Ns_8104: bitstring;
                                {10382}new ST_8105: bitstring;
                                {10383}new TTL_8106: bitstring;
                                {10384}let gNs_8107: bitstring = exp(g,Ns_8104) in
                                {10385}let m2_8108: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8107,ST_8105,TTL_8106) in
                                {10386}event beginSrv(Sess_5025,Cli_5023,gNs_8107);
                                {10387}out(c, (enc(m2_8108,pkCli_8086),sign(h(m2_8108),skSess_7637)));
                                {10388}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                {10389}event endSrv(Cli_5023,Sess_5025,PartC_8103)
                        )
                        else
                            {10390}let v_8109: bool = (Disco_5024 = C) in
                            (
                                {10391}if v_8109 then
                                (
                                    {10392}let pkDisco_8110: bitstring = pub(skC) in
                                    {10393}in(c, (=pkCli_8086,em1_8111: bitstring,sigM1_8112: bitstring));
                                    {10394}let m1_8113: bitstring = dec(em1_8111,skSess_7637) in
                                    {10395}if (verify(h(m1_8113),sigM1_8112,pkCli_8086) <> true) then
                                        0
                                    else
                                        {10396}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8114: bitstring) = m1_8113 in
                                        {10397}new Ns_8115: bitstring;
                                        {10398}new ST_8116: bitstring;
                                        {10399}new TTL_8117: bitstring;
                                        {10400}let gNs_8118: bitstring = exp(g,Ns_8115) in
                                        {10401}let m2_8119: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8118,ST_8116,TTL_8117) in
                                        {10402}event beginSrv(Sess_5025,Cli_5023,gNs_8118);
                                        {10403}out(c, (enc(m2_8119,pkCli_8086),sign(h(m2_8119),skSess_7637)));
                                        {10404}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10405}event endSrv(Cli_5023,Sess_5025,PartC_8114)
                                )
                                else
                                    {10406}let pkDisco_8120: bitstring = pub(sk(Disco_5024)) in
                                    {10407}in(c, (=pkCli_8086,em1_8121: bitstring,sigM1_8122: bitstring));
                                    {10408}let m1_8123: bitstring = dec(em1_8121,skSess_7637) in
                                    {10409}if (verify(h(m1_8123),sigM1_8122,pkCli_8086) <> true) then
                                        0
                                    else
                                        {10410}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8124: bitstring) = m1_8123 in
                                        {10411}new Ns_8125: bitstring;
                                        {10412}new ST_8126: bitstring;
                                        {10413}new TTL_8127: bitstring;
                                        {10414}let gNs_8128: bitstring = exp(g,Ns_8125) in
                                        {10415}let m2_8129: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8128,ST_8126,TTL_8127) in
                                        {10416}event beginSrv(Sess_5025,Cli_5023,gNs_8128);
                                        {10417}out(c, (enc(m2_8129,pkCli_8086),sign(h(m2_8129),skSess_7637)));
                                        {10418}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                        {10419}event endSrv(Cli_5023,Sess_5025,PartC_8124)
                            )
                            else
                                {10420}let pkDisco_8130: bitstring = fail-any in
                                {10421}in(c, (=pkCli_8086,em1_8131: bitstring,sigM1_8132: bitstring));
                                {10422}let m1_8133: bitstring = dec(em1_8131,skSess_7637) in
                                {10423}if (verify(h(m1_8133),sigM1_8132,pkCli_8086) <> true) then
                                    0
                                else
                                    {10424}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8134: bitstring) = m1_8133 in
                                    {10425}new Ns_8135: bitstring;
                                    {10426}new ST_8136: bitstring;
                                    {10427}new TTL_8137: bitstring;
                                    {10428}let gNs_8138: bitstring = exp(g,Ns_8135) in
                                    {10429}let m2_8139: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8138,ST_8136,TTL_8137) in
                                    {10430}event beginSrv(Sess_5025,Cli_5023,gNs_8138);
                                    {10431}out(c, (enc(m2_8139,pkCli_8086),sign(h(m2_8139),skSess_7637)));
                                    {10432}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                                    {10433}event endSrv(Cli_5023,Sess_5025,PartC_8134)
                    )
                    else
                        {10434}let pkDisco_8140: bitstring = fail-any in
                        {10435}in(c, (=pkCli_8086,em1_8141: bitstring,sigM1_8142: bitstring));
                        {10436}let m1_8143: bitstring = dec(em1_8141,skSess_7637) in
                        {10437}if (verify(h(m1_8143),sigM1_8142,pkCli_8086) <> true) then
                            0
                        else
                            {10438}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8144: bitstring) = m1_8143 in
                            {10439}new Ns_8145: bitstring;
                            {10440}new ST_8146: bitstring;
                            {10441}new TTL_8147: bitstring;
                            {10442}let gNs_8148: bitstring = exp(g,Ns_8145) in
                            {10443}let m2_8149: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8148,ST_8146,TTL_8147) in
                            {10444}event beginSrv(Sess_5025,Cli_5023,gNs_8148);
                            {10445}out(c, (enc(m2_8149,pkCli_8086),sign(h(m2_8149),skSess_7637)));
                            {10446}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                            {10447}event endSrv(Cli_5023,Sess_5025,PartC_8144)
            )
            else
                {10448}let pkDisco_8150: bitstring = fail-any in
                {10449}in(c, (=pkCli_8086,em1_8151: bitstring,sigM1_8152: bitstring));
                {10450}let m1_8153: bitstring = dec(em1_8151,skSess_7637) in
                {10451}if (verify(h(m1_8153),sigM1_8152,pkCli_8086) <> true) then
                    0
                else
                    {10452}let (=OpenSecureChannelRequest,=Sess_5025,=pkCli_8086,PartC_8154: bitstring) = m1_8153 in
                    {10453}new Ns_8155: bitstring;
                    {10454}new ST_8156: bitstring;
                    {10455}new TTL_8157: bitstring;
                    {10456}let gNs_8158: bitstring = exp(g,Ns_8155) in
                    {10457}let m2_8159: bitstring = (OpenSecureChannelResponse,Cli_5023,gNs_8158,ST_8156,TTL_8157) in
                    {10458}event beginSrv(Sess_5025,Cli_5023,gNs_8158);
                    {10459}out(c, (enc(m2_8159,pkCli_8086),sign(h(m2_8159),skSess_7637)));
                    {10460}if ((Cli_5023 = A) || ((Cli_5023 = B) || (Cli_5023 = C))) then
                    {10461}event endSrv(Cli_5023,Sess_5025,PartC_8154)
)

-- Query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
Completing...
200 rules inserted. The rule base contains 63 rules. 253 rules in the queue.
400 rules inserted. The rule base contains 159 rules. 251 rules in the queue.
600 rules inserted. The rule base contains 246 rules. 250 rules in the queue.
800 rules inserted. The rule base contains 267 rules. 225 rules in the queue.
1000 rules inserted. The rule base contains 327 rules. 165 rules in the queue.
1200 rules inserted. The rule base contains 349 rules. 151 rules in the queue.
1400 rules inserted. The rule base contains 460 rules. 80 rules in the queue.
1600 rules inserted. The rule base contains 540 rules. 19 rules in the queue.
Starting query event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N))
goal reachable: attacker(N_44822) -> end(endCli(B[],C[],N_44822))

1. The attacker initially knows B[].
attacker(B[]).

2. The attacker initially knows C[].
attacker(C[]).

3. By 2, the attacker may know C[].
By 1, the attacker may know B[].
By 1, the attacker may know B[].
Using the function 3-tuple the attacker may obtain (C[],B[],B[]).
attacker((C[],B[],B[])).

4. The attacker has some term UP_44851.
attacker(UP_44851).

5. The attacker has some term SP_44850.
attacker(SP_44850).

6. Using the function None the attacker may obtain None.
attacker(None).

7. The message pub(skB[]) may be sent to the attacker at output {4}.
attacker(pub(skB[])).

8. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

9. By 8, the attacker may know GetEndpointResponse.
By 7, the attacker may know pub(skB[]).
By 6, the attacker may know None.
By 5, the attacker may know SP_44850.
By 4, the attacker may know UP_44851.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skB[]),None,SP_44850,UP_44851).
attacker((GetEndpointResponse,pub(skB[]),None,SP_44850,UP_44851)).

10. The attacker has some term TTL_44849.
attacker(TTL_44849).

11. The attacker has some term ST_44848.
attacker(ST_44848).

12. We assume as hypothesis that
attacker(N_44855).

13. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

14. By 13, the attacker may know OpenSecureChannelResponse.
By 2, the attacker may know C[].
By 12, the attacker may know N_44855.
By 11, the attacker may know ST_44848.
By 10, the attacker may know TTL_44849.
Using the function 5-tuple the attacker may obtain (OpenSecureChannelResponse,C[],N_44855,ST_44848,TTL_44849).
attacker((OpenSecureChannelResponse,C[],N_44855,ST_44848,TTL_44849)).

15. The message (C[],B[],B[]) that the attacker may have by 3 may be received at input {8}.
The message (GetEndpointResponse,pub(skB[]),None,SP_44850,UP_44851) that the attacker may have by 9 may be received at input {1526}.
The message (OpenSecureChannelResponse,C[],N_44855,ST_44848,TTL_44849) that the attacker may have by 14 may be received at input {1532}.
So event endCli(B[],C[],N_44855) may be executed at {1536}.
end(endCli(B[],C[],N_44855)).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (C,B,B)) at {8} in copy a_44860

out(c, GetEndpointRequest) at {1525} in copy a_44860

in(c, (GetEndpointResponse,pub(skB),None,a_44858,a_44859)) at {1526} in copy a_44860

new Nc_1753 creating Nc_75563 at {1527} in copy a_44860

event(beginCli(C,B,exp(g,Nc_75563))) at {1530} in copy a_44860

out(c, (pub(skC),(OpenSecureChannelRequest,B,pub(skC),exp(g,Nc_75563)))) at {1531} in copy a_44860

in(c, (OpenSecureChannelResponse,C,a,a_44856,a_44857)) at {1532} in copy a_44860

event(endCli(B,C,a)) at {1536} in copy a_44860

The event endCli(B,C,a) is executed.
A trace has been found.
RESULT event(endCli(X,Y,N)) ==> event(beginSrv(X,Y,N)) is false.
-- Query event(endSrv(X_75599,Y_75600,N_75601)) ==> event(beginCli(X_75599,Y_75600,N_75601))
Completing...
200 rules inserted. The rule base contains 65 rules. 253 rules in the queue.
400 rules inserted. The rule base contains 168 rules. 251 rules in the queue.
600 rules inserted. The rule base contains 262 rules. 250 rules in the queue.
800 rules inserted. The rule base contains 285 rules. 225 rules in the queue.
1000 rules inserted. The rule base contains 345 rules. 165 rules in the queue.
1200 rules inserted. The rule base contains 368 rules. 152 rules in the queue.
1400 rules inserted. The rule base contains 478 rules. 80 rules in the queue.
1600 rules inserted. The rule base contains 558 rules. 19 rules in the queue.
Starting query event(endSrv(X_75599,Y_75600,N_75601)) ==> event(beginCli(X_75599,Y_75600,N_75601))
RESULT event(endSrv(X_75599,Y_75600,N_75601)) ==> event(beginCli(X_75599,Y_75600,N_75601)) is true.
