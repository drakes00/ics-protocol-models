Linear part:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Completing equations...
Completed equations:
exp(exp(g,x_32),y) = exp(exp(g,y),x_32)
Convergent part:
Completing equations...
Completed equations:
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_519: bool = (Cli = A) in
    (
        {10}if v_519 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_520: bool = (Disco = A) in
            (
                {14}if v_520 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_521: bool = (Sess = A) in
                    (
                        {17}if v_521 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=Sign,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let gNc: bitstring = exp(g,Nc) in
                            {23}let m1: bitstring = (OpenSecureChannelRequest,pkCli,gNc) in
                            {24}out(c, (pkCli,m1,sign(h(m1),skCli)));
                            {25}in(c, (em2: bitstring,sigM2: bitstring));
                            {26}let m2: bitstring = em2 in
                            {27}if (verify(h(m2),sigM2,pkSess) <> true) then
                                0
                            else
                                {28}let (=OpenSecureChannelResponse,PartS: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                                {29}let Kcli: bitstring = exp(PartS,Nc) in
                                {30}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {31}let v_522: bool = (Sess = B) in
                            (
                                {32}if v_522 then
                                (
                                    {33}let pkSess_523: bitstring = pub(skB) in
                                    {34}out(c, GetEndpointRequest);
                                    {35}in(c, (=GetEndpointResponse,=pkSess_523,=Sign,SP_524: bitstring,UP_525: bitstring));
                                    {36}new Nc_526: bitstring;
                                    {37}let gNc_527: bitstring = exp(g,Nc_526) in
                                    {38}let m1_528: bitstring = (OpenSecureChannelRequest,pkCli,gNc_527) in
                                    {39}out(c, (pkCli,m1_528,sign(h(m1_528),skCli)));
                                    {40}in(c, (em2_529: bitstring,sigM2_530: bitstring));
                                    {41}let m2_531: bitstring = em2_529 in
                                    {42}if (verify(h(m2_531),sigM2_530,pkSess_523) <> true) then
                                        0
                                    else
                                        {43}let (=OpenSecureChannelResponse,PartS_532: bitstring,ST_533: bitstring,TTL_534: bitstring) = m2_531 in
                                        {44}let Kcli_535: bitstring = exp(PartS_532,Nc_526) in
                                        {45}out(c, senc(mCli(pkCli,pkSess_523),Kcli_535))
                                )
                                else
                                    {46}let v_536: bool = (Sess = C) in
                                    (
                                        {47}if v_536 then
                                        (
                                            {48}let pkSess_537: bitstring = pub(skC) in
                                            {49}out(c, GetEndpointRequest);
                                            {50}in(c, (=GetEndpointResponse,=pkSess_537,=Sign,SP_538: bitstring,UP_539: bitstring));
                                            {51}new Nc_540: bitstring;
                                            {52}let gNc_541: bitstring = exp(g,Nc_540) in
                                            {53}let m1_542: bitstring = (OpenSecureChannelRequest,pkCli,gNc_541) in
                                            {54}out(c, (pkCli,m1_542,sign(h(m1_542),skCli)));
                                            {55}in(c, (em2_543: bitstring,sigM2_544: bitstring));
                                            {56}let m2_545: bitstring = em2_543 in
                                            {57}if (verify(h(m2_545),sigM2_544,pkSess_537) <> true) then
                                                0
                                            else
                                                {58}let (=OpenSecureChannelResponse,PartS_546: bitstring,ST_547: bitstring,TTL_548: bitstring) = m2_545 in
                                                {59}let Kcli_549: bitstring = exp(PartS_546,Nc_540) in
                                                {60}out(c, senc(mCli(pkCli,pkSess_537),Kcli_549))
                                        )
                                        else
                                            {61}let pkSess_550: bitstring = pub(sk(Sess)) in
                                            {62}out(c, GetEndpointRequest);
                                            {63}in(c, (=GetEndpointResponse,=pkSess_550,=Sign,SP_551: bitstring,UP_552: bitstring));
                                            {64}new Nc_553: bitstring;
                                            {65}let gNc_554: bitstring = exp(g,Nc_553) in
                                            {66}let m1_555: bitstring = (OpenSecureChannelRequest,pkCli,gNc_554) in
                                            {67}out(c, (pkCli,m1_555,sign(h(m1_555),skCli)));
                                            {68}in(c, (em2_556: bitstring,sigM2_557: bitstring));
                                            {69}let m2_558: bitstring = em2_556 in
                                            {70}if (verify(h(m2_558),sigM2_557,pkSess_550) <> true) then
                                                0
                                            else
                                                {71}let (=OpenSecureChannelResponse,PartS_559: bitstring,ST_560: bitstring,TTL_561: bitstring) = m2_558 in
                                                {72}let Kcli_562: bitstring = exp(PartS_559,Nc_553) in
                                                {73}out(c, senc(mCli(pkCli,pkSess_550),Kcli_562))
                                    )
                                    else
                                        {74}let pkSess_563: bitstring = fail-any in
                                        {75}out(c, GetEndpointRequest);
                                        {76}in(c, (=GetEndpointResponse,=pkSess_563,=Sign,SP_564: bitstring,UP_565: bitstring));
                                        {77}new Nc_566: bitstring;
                                        {78}let gNc_567: bitstring = exp(g,Nc_566) in
                                        {79}let m1_568: bitstring = (OpenSecureChannelRequest,pkCli,gNc_567) in
                                        {80}out(c, (pkCli,m1_568,sign(h(m1_568),skCli)));
                                        {81}in(c, (em2_569: bitstring,sigM2_570: bitstring));
                                        {82}let m2_571: bitstring = em2_569 in
                                        {83}if (verify(h(m2_571),sigM2_570,pkSess_563) <> true) then
                                            0
                                        else
                                            {84}let (=OpenSecureChannelResponse,PartS_572: bitstring,ST_573: bitstring,TTL_574: bitstring) = m2_571 in
                                            {85}let Kcli_575: bitstring = exp(PartS_572,Nc_566) in
                                            {86}out(c, senc(mCli(pkCli,pkSess_563),Kcli_575))
                            )
                            else
                                {87}let pkSess_576: bitstring = fail-any in
                                {88}out(c, GetEndpointRequest);
                                {89}in(c, (=GetEndpointResponse,=pkSess_576,=Sign,SP_577: bitstring,UP_578: bitstring));
                                {90}new Nc_579: bitstring;
                                {91}let gNc_580: bitstring = exp(g,Nc_579) in
                                {92}let m1_581: bitstring = (OpenSecureChannelRequest,pkCli,gNc_580) in
                                {93}out(c, (pkCli,m1_581,sign(h(m1_581),skCli)));
                                {94}in(c, (em2_582: bitstring,sigM2_583: bitstring));
                                {95}let m2_584: bitstring = em2_582 in
                                {96}if (verify(h(m2_584),sigM2_583,pkSess_576) <> true) then
                                    0
                                else
                                    {97}let (=OpenSecureChannelResponse,PartS_585: bitstring,ST_586: bitstring,TTL_587: bitstring) = m2_584 in
                                    {98}let Kcli_588: bitstring = exp(PartS_585,Nc_579) in
                                    {99}out(c, senc(mCli(pkCli,pkSess_576),Kcli_588))
                    )
                    else
                        {100}let pkSess_589: bitstring = fail-any in
                        {101}out(c, GetEndpointRequest);
                        {102}in(c, (=GetEndpointResponse,=pkSess_589,=Sign,SP_590: bitstring,UP_591: bitstring));
                        {103}new Nc_592: bitstring;
                        {104}let gNc_593: bitstring = exp(g,Nc_592) in
                        {105}let m1_594: bitstring = (OpenSecureChannelRequest,pkCli,gNc_593) in
                        {106}out(c, (pkCli,m1_594,sign(h(m1_594),skCli)));
                        {107}in(c, (em2_595: bitstring,sigM2_596: bitstring));
                        {108}let m2_597: bitstring = em2_595 in
                        {109}if (verify(h(m2_597),sigM2_596,pkSess_589) <> true) then
                            0
                        else
                            {110}let (=OpenSecureChannelResponse,PartS_598: bitstring,ST_599: bitstring,TTL_600: bitstring) = m2_597 in
                            {111}let Kcli_601: bitstring = exp(PartS_598,Nc_592) in
                            {112}out(c, senc(mCli(pkCli,pkSess_589),Kcli_601))
                )
                else
                    {113}let v_602: bool = (Disco = B) in
                    (
                        {114}if v_602 then
                        (
                            {115}let pkDisco_603: bitstring = pub(skB) in
                            {116}let v_604: bool = (Sess = A) in
                            (
                                {117}if v_604 then
                                (
                                    {118}let pkSess_605: bitstring = pub(skA) in
                                    {119}out(c, GetEndpointRequest);
                                    {120}in(c, (=GetEndpointResponse,=pkSess_605,=Sign,SP_606: bitstring,UP_607: bitstring));
                                    {121}new Nc_608: bitstring;
                                    {122}let gNc_609: bitstring = exp(g,Nc_608) in
                                    {123}let m1_610: bitstring = (OpenSecureChannelRequest,pkCli,gNc_609) in
                                    {124}out(c, (pkCli,m1_610,sign(h(m1_610),skCli)));
                                    {125}in(c, (em2_611: bitstring,sigM2_612: bitstring));
                                    {126}let m2_613: bitstring = em2_611 in
                                    {127}if (verify(h(m2_613),sigM2_612,pkSess_605) <> true) then
                                        0
                                    else
                                        {128}let (=OpenSecureChannelResponse,PartS_614: bitstring,ST_615: bitstring,TTL_616: bitstring) = m2_613 in
                                        {129}let Kcli_617: bitstring = exp(PartS_614,Nc_608) in
                                        {130}out(c, senc(mCli(pkCli,pkSess_605),Kcli_617))
                                )
                                else
                                    {131}let v_618: bool = (Sess = B) in
                                    (
                                        {132}if v_618 then
                                        (
                                            {133}let pkSess_619: bitstring = pub(skB) in
                                            {134}out(c, GetEndpointRequest);
                                            {135}in(c, (=GetEndpointResponse,=pkSess_619,=Sign,SP_620: bitstring,UP_621: bitstring));
                                            {136}new Nc_622: bitstring;
                                            {137}let gNc_623: bitstring = exp(g,Nc_622) in
                                            {138}let m1_624: bitstring = (OpenSecureChannelRequest,pkCli,gNc_623) in
                                            {139}out(c, (pkCli,m1_624,sign(h(m1_624),skCli)));
                                            {140}in(c, (em2_625: bitstring,sigM2_626: bitstring));
                                            {141}let m2_627: bitstring = em2_625 in
                                            {142}if (verify(h(m2_627),sigM2_626,pkSess_619) <> true) then
                                                0
                                            else
                                                {143}let (=OpenSecureChannelResponse,PartS_628: bitstring,ST_629: bitstring,TTL_630: bitstring) = m2_627 in
                                                {144}let Kcli_631: bitstring = exp(PartS_628,Nc_622) in
                                                {145}out(c, senc(mCli(pkCli,pkSess_619),Kcli_631))
                                        )
                                        else
                                            {146}let v_632: bool = (Sess = C) in
                                            (
                                                {147}if v_632 then
                                                (
                                                    {148}let pkSess_633: bitstring = pub(skC) in
                                                    {149}out(c, GetEndpointRequest);
                                                    {150}in(c, (=GetEndpointResponse,=pkSess_633,=Sign,SP_634: bitstring,UP_635: bitstring));
                                                    {151}new Nc_636: bitstring;
                                                    {152}let gNc_637: bitstring = exp(g,Nc_636) in
                                                    {153}let m1_638: bitstring = (OpenSecureChannelRequest,pkCli,gNc_637) in
                                                    {154}out(c, (pkCli,m1_638,sign(h(m1_638),skCli)));
                                                    {155}in(c, (em2_639: bitstring,sigM2_640: bitstring));
                                                    {156}let m2_641: bitstring = em2_639 in
                                                    {157}if (verify(h(m2_641),sigM2_640,pkSess_633) <> true) then
                                                        0
                                                    else
                                                        {158}let (=OpenSecureChannelResponse,PartS_642: bitstring,ST_643: bitstring,TTL_644: bitstring) = m2_641 in
                                                        {159}let Kcli_645: bitstring = exp(PartS_642,Nc_636) in
                                                        {160}out(c, senc(mCli(pkCli,pkSess_633),Kcli_645))
                                                )
                                                else
                                                    {161}let pkSess_646: bitstring = pub(sk(Sess)) in
                                                    {162}out(c, GetEndpointRequest);
                                                    {163}in(c, (=GetEndpointResponse,=pkSess_646,=Sign,SP_647: bitstring,UP_648: bitstring));
                                                    {164}new Nc_649: bitstring;
                                                    {165}let gNc_650: bitstring = exp(g,Nc_649) in
                                                    {166}let m1_651: bitstring = (OpenSecureChannelRequest,pkCli,gNc_650) in
                                                    {167}out(c, (pkCli,m1_651,sign(h(m1_651),skCli)));
                                                    {168}in(c, (em2_652: bitstring,sigM2_653: bitstring));
                                                    {169}let m2_654: bitstring = em2_652 in
                                                    {170}if (verify(h(m2_654),sigM2_653,pkSess_646) <> true) then
                                                        0
                                                    else
                                                        {171}let (=OpenSecureChannelResponse,PartS_655: bitstring,ST_656: bitstring,TTL_657: bitstring) = m2_654 in
                                                        {172}let Kcli_658: bitstring = exp(PartS_655,Nc_649) in
                                                        {173}out(c, senc(mCli(pkCli,pkSess_646),Kcli_658))
                                            )
                                            else
                                                {174}let pkSess_659: bitstring = fail-any in
                                                {175}out(c, GetEndpointRequest);
                                                {176}in(c, (=GetEndpointResponse,=pkSess_659,=Sign,SP_660: bitstring,UP_661: bitstring));
                                                {177}new Nc_662: bitstring;
                                                {178}let gNc_663: bitstring = exp(g,Nc_662) in
                                                {179}let m1_664: bitstring = (OpenSecureChannelRequest,pkCli,gNc_663) in
                                                {180}out(c, (pkCli,m1_664,sign(h(m1_664),skCli)));
                                                {181}in(c, (em2_665: bitstring,sigM2_666: bitstring));
                                                {182}let m2_667: bitstring = em2_665 in
                                                {183}if (verify(h(m2_667),sigM2_666,pkSess_659) <> true) then
                                                    0
                                                else
                                                    {184}let (=OpenSecureChannelResponse,PartS_668: bitstring,ST_669: bitstring,TTL_670: bitstring) = m2_667 in
                                                    {185}let Kcli_671: bitstring = exp(PartS_668,Nc_662) in
                                                    {186}out(c, senc(mCli(pkCli,pkSess_659),Kcli_671))
                                    )
                                    else
                                        {187}let pkSess_672: bitstring = fail-any in
                                        {188}out(c, GetEndpointRequest);
                                        {189}in(c, (=GetEndpointResponse,=pkSess_672,=Sign,SP_673: bitstring,UP_674: bitstring));
                                        {190}new Nc_675: bitstring;
                                        {191}let gNc_676: bitstring = exp(g,Nc_675) in
                                        {192}let m1_677: bitstring = (OpenSecureChannelRequest,pkCli,gNc_676) in
                                        {193}out(c, (pkCli,m1_677,sign(h(m1_677),skCli)));
                                        {194}in(c, (em2_678: bitstring,sigM2_679: bitstring));
                                        {195}let m2_680: bitstring = em2_678 in
                                        {196}if (verify(h(m2_680),sigM2_679,pkSess_672) <> true) then
                                            0
                                        else
                                            {197}let (=OpenSecureChannelResponse,PartS_681: bitstring,ST_682: bitstring,TTL_683: bitstring) = m2_680 in
                                            {198}let Kcli_684: bitstring = exp(PartS_681,Nc_675) in
                                            {199}out(c, senc(mCli(pkCli,pkSess_672),Kcli_684))
                            )
                            else
                                {200}let pkSess_685: bitstring = fail-any in
                                {201}out(c, GetEndpointRequest);
                                {202}in(c, (=GetEndpointResponse,=pkSess_685,=Sign,SP_686: bitstring,UP_687: bitstring));
                                {203}new Nc_688: bitstring;
                                {204}let gNc_689: bitstring = exp(g,Nc_688) in
                                {205}let m1_690: bitstring = (OpenSecureChannelRequest,pkCli,gNc_689) in
                                {206}out(c, (pkCli,m1_690,sign(h(m1_690),skCli)));
                                {207}in(c, (em2_691: bitstring,sigM2_692: bitstring));
                                {208}let m2_693: bitstring = em2_691 in
                                {209}if (verify(h(m2_693),sigM2_692,pkSess_685) <> true) then
                                    0
                                else
                                    {210}let (=OpenSecureChannelResponse,PartS_694: bitstring,ST_695: bitstring,TTL_696: bitstring) = m2_693 in
                                    {211}let Kcli_697: bitstring = exp(PartS_694,Nc_688) in
                                    {212}out(c, senc(mCli(pkCli,pkSess_685),Kcli_697))
                        )
                        else
                            {213}let v_698: bool = (Disco = C) in
                            (
                                {214}if v_698 then
                                (
                                    {215}let pkDisco_699: bitstring = pub(skC) in
                                    {216}let v_700: bool = (Sess = A) in
                                    (
                                        {217}if v_700 then
                                        (
                                            {218}let pkSess_701: bitstring = pub(skA) in
                                            {219}out(c, GetEndpointRequest);
                                            {220}in(c, (=GetEndpointResponse,=pkSess_701,=Sign,SP_702: bitstring,UP_703: bitstring));
                                            {221}new Nc_704: bitstring;
                                            {222}let gNc_705: bitstring = exp(g,Nc_704) in
                                            {223}let m1_706: bitstring = (OpenSecureChannelRequest,pkCli,gNc_705) in
                                            {224}out(c, (pkCli,m1_706,sign(h(m1_706),skCli)));
                                            {225}in(c, (em2_707: bitstring,sigM2_708: bitstring));
                                            {226}let m2_709: bitstring = em2_707 in
                                            {227}if (verify(h(m2_709),sigM2_708,pkSess_701) <> true) then
                                                0
                                            else
                                                {228}let (=OpenSecureChannelResponse,PartS_710: bitstring,ST_711: bitstring,TTL_712: bitstring) = m2_709 in
                                                {229}let Kcli_713: bitstring = exp(PartS_710,Nc_704) in
                                                {230}out(c, senc(mCli(pkCli,pkSess_701),Kcli_713))
                                        )
                                        else
                                            {231}let v_714: bool = (Sess = B) in
                                            (
                                                {232}if v_714 then
                                                (
                                                    {233}let pkSess_715: bitstring = pub(skB) in
                                                    {234}out(c, GetEndpointRequest);
                                                    {235}in(c, (=GetEndpointResponse,=pkSess_715,=Sign,SP_716: bitstring,UP_717: bitstring));
                                                    {236}new Nc_718: bitstring;
                                                    {237}let gNc_719: bitstring = exp(g,Nc_718) in
                                                    {238}let m1_720: bitstring = (OpenSecureChannelRequest,pkCli,gNc_719) in
                                                    {239}out(c, (pkCli,m1_720,sign(h(m1_720),skCli)));
                                                    {240}in(c, (em2_721: bitstring,sigM2_722: bitstring));
                                                    {241}let m2_723: bitstring = em2_721 in
                                                    {242}if (verify(h(m2_723),sigM2_722,pkSess_715) <> true) then
                                                        0
                                                    else
                                                        {243}let (=OpenSecureChannelResponse,PartS_724: bitstring,ST_725: bitstring,TTL_726: bitstring) = m2_723 in
                                                        {244}let Kcli_727: bitstring = exp(PartS_724,Nc_718) in
                                                        {245}out(c, senc(mCli(pkCli,pkSess_715),Kcli_727))
                                                )
                                                else
                                                    {246}let v_728: bool = (Sess = C) in
                                                    (
                                                        {247}if v_728 then
                                                        (
                                                            {248}let pkSess_729: bitstring = pub(skC) in
                                                            {249}out(c, GetEndpointRequest);
                                                            {250}in(c, (=GetEndpointResponse,=pkSess_729,=Sign,SP_730: bitstring,UP_731: bitstring));
                                                            {251}new Nc_732: bitstring;
                                                            {252}let gNc_733: bitstring = exp(g,Nc_732) in
                                                            {253}let m1_734: bitstring = (OpenSecureChannelRequest,pkCli,gNc_733) in
                                                            {254}out(c, (pkCli,m1_734,sign(h(m1_734),skCli)));
                                                            {255}in(c, (em2_735: bitstring,sigM2_736: bitstring));
                                                            {256}let m2_737: bitstring = em2_735 in
                                                            {257}if (verify(h(m2_737),sigM2_736,pkSess_729) <> true) then
                                                                0
                                                            else
                                                                {258}let (=OpenSecureChannelResponse,PartS_738: bitstring,ST_739: bitstring,TTL_740: bitstring) = m2_737 in
                                                                {259}let Kcli_741: bitstring = exp(PartS_738,Nc_732) in
                                                                {260}out(c, senc(mCli(pkCli,pkSess_729),Kcli_741))
                                                        )
                                                        else
                                                            {261}let pkSess_742: bitstring = pub(sk(Sess)) in
                                                            {262}out(c, GetEndpointRequest);
                                                            {263}in(c, (=GetEndpointResponse,=pkSess_742,=Sign,SP_743: bitstring,UP_744: bitstring));
                                                            {264}new Nc_745: bitstring;
                                                            {265}let gNc_746: bitstring = exp(g,Nc_745) in
                                                            {266}let m1_747: bitstring = (OpenSecureChannelRequest,pkCli,gNc_746) in
                                                            {267}out(c, (pkCli,m1_747,sign(h(m1_747),skCli)));
                                                            {268}in(c, (em2_748: bitstring,sigM2_749: bitstring));
                                                            {269}let m2_750: bitstring = em2_748 in
                                                            {270}if (verify(h(m2_750),sigM2_749,pkSess_742) <> true) then
                                                                0
                                                            else
                                                                {271}let (=OpenSecureChannelResponse,PartS_751: bitstring,ST_752: bitstring,TTL_753: bitstring) = m2_750 in
                                                                {272}let Kcli_754: bitstring = exp(PartS_751,Nc_745) in
                                                                {273}out(c, senc(mCli(pkCli,pkSess_742),Kcli_754))
                                                    )
                                                    else
                                                        {274}let pkSess_755: bitstring = fail-any in
                                                        {275}out(c, GetEndpointRequest);
                                                        {276}in(c, (=GetEndpointResponse,=pkSess_755,=Sign,SP_756: bitstring,UP_757: bitstring));
                                                        {277}new Nc_758: bitstring;
                                                        {278}let gNc_759: bitstring = exp(g,Nc_758) in
                                                        {279}let m1_760: bitstring = (OpenSecureChannelRequest,pkCli,gNc_759) in
                                                        {280}out(c, (pkCli,m1_760,sign(h(m1_760),skCli)));
                                                        {281}in(c, (em2_761: bitstring,sigM2_762: bitstring));
                                                        {282}let m2_763: bitstring = em2_761 in
                                                        {283}if (verify(h(m2_763),sigM2_762,pkSess_755) <> true) then
                                                            0
                                                        else
                                                            {284}let (=OpenSecureChannelResponse,PartS_764: bitstring,ST_765: bitstring,TTL_766: bitstring) = m2_763 in
                                                            {285}let Kcli_767: bitstring = exp(PartS_764,Nc_758) in
                                                            {286}out(c, senc(mCli(pkCli,pkSess_755),Kcli_767))
                                            )
                                            else
                                                {287}let pkSess_768: bitstring = fail-any in
                                                {288}out(c, GetEndpointRequest);
                                                {289}in(c, (=GetEndpointResponse,=pkSess_768,=Sign,SP_769: bitstring,UP_770: bitstring));
                                                {290}new Nc_771: bitstring;
                                                {291}let gNc_772: bitstring = exp(g,Nc_771) in
                                                {292}let m1_773: bitstring = (OpenSecureChannelRequest,pkCli,gNc_772) in
                                                {293}out(c, (pkCli,m1_773,sign(h(m1_773),skCli)));
                                                {294}in(c, (em2_774: bitstring,sigM2_775: bitstring));
                                                {295}let m2_776: bitstring = em2_774 in
                                                {296}if (verify(h(m2_776),sigM2_775,pkSess_768) <> true) then
                                                    0
                                                else
                                                    {297}let (=OpenSecureChannelResponse,PartS_777: bitstring,ST_778: bitstring,TTL_779: bitstring) = m2_776 in
                                                    {298}let Kcli_780: bitstring = exp(PartS_777,Nc_771) in
                                                    {299}out(c, senc(mCli(pkCli,pkSess_768),Kcli_780))
                                    )
                                    else
                                        {300}let pkSess_781: bitstring = fail-any in
                                        {301}out(c, GetEndpointRequest);
                                        {302}in(c, (=GetEndpointResponse,=pkSess_781,=Sign,SP_782: bitstring,UP_783: bitstring));
                                        {303}new Nc_784: bitstring;
                                        {304}let gNc_785: bitstring = exp(g,Nc_784) in
                                        {305}let m1_786: bitstring = (OpenSecureChannelRequest,pkCli,gNc_785) in
                                        {306}out(c, (pkCli,m1_786,sign(h(m1_786),skCli)));
                                        {307}in(c, (em2_787: bitstring,sigM2_788: bitstring));
                                        {308}let m2_789: bitstring = em2_787 in
                                        {309}if (verify(h(m2_789),sigM2_788,pkSess_781) <> true) then
                                            0
                                        else
                                            {310}let (=OpenSecureChannelResponse,PartS_790: bitstring,ST_791: bitstring,TTL_792: bitstring) = m2_789 in
                                            {311}let Kcli_793: bitstring = exp(PartS_790,Nc_784) in
                                            {312}out(c, senc(mCli(pkCli,pkSess_781),Kcli_793))
                                )
                                else
                                    {313}let pkDisco_794: bitstring = pub(sk(Disco)) in
                                    {314}let v_795: bool = (Sess = A) in
                                    (
                                        {315}if v_795 then
                                        (
                                            {316}let pkSess_796: bitstring = pub(skA) in
                                            {317}out(c, GetEndpointRequest);
                                            {318}in(c, (=GetEndpointResponse,=pkSess_796,=Sign,SP_797: bitstring,UP_798: bitstring));
                                            {319}new Nc_799: bitstring;
                                            {320}let gNc_800: bitstring = exp(g,Nc_799) in
                                            {321}let m1_801: bitstring = (OpenSecureChannelRequest,pkCli,gNc_800) in
                                            {322}out(c, (pkCli,m1_801,sign(h(m1_801),skCli)));
                                            {323}in(c, (em2_802: bitstring,sigM2_803: bitstring));
                                            {324}let m2_804: bitstring = em2_802 in
                                            {325}if (verify(h(m2_804),sigM2_803,pkSess_796) <> true) then
                                                0
                                            else
                                                {326}let (=OpenSecureChannelResponse,PartS_805: bitstring,ST_806: bitstring,TTL_807: bitstring) = m2_804 in
                                                {327}let Kcli_808: bitstring = exp(PartS_805,Nc_799) in
                                                {328}out(c, senc(mCli(pkCli,pkSess_796),Kcli_808))
                                        )
                                        else
                                            {329}let v_809: bool = (Sess = B) in
                                            (
                                                {330}if v_809 then
                                                (
                                                    {331}let pkSess_810: bitstring = pub(skB) in
                                                    {332}out(c, GetEndpointRequest);
                                                    {333}in(c, (=GetEndpointResponse,=pkSess_810,=Sign,SP_811: bitstring,UP_812: bitstring));
                                                    {334}new Nc_813: bitstring;
                                                    {335}let gNc_814: bitstring = exp(g,Nc_813) in
                                                    {336}let m1_815: bitstring = (OpenSecureChannelRequest,pkCli,gNc_814) in
                                                    {337}out(c, (pkCli,m1_815,sign(h(m1_815),skCli)));
                                                    {338}in(c, (em2_816: bitstring,sigM2_817: bitstring));
                                                    {339}let m2_818: bitstring = em2_816 in
                                                    {340}if (verify(h(m2_818),sigM2_817,pkSess_810) <> true) then
                                                        0
                                                    else
                                                        {341}let (=OpenSecureChannelResponse,PartS_819: bitstring,ST_820: bitstring,TTL_821: bitstring) = m2_818 in
                                                        {342}let Kcli_822: bitstring = exp(PartS_819,Nc_813) in
                                                        {343}out(c, senc(mCli(pkCli,pkSess_810),Kcli_822))
                                                )
                                                else
                                                    {344}let v_823: bool = (Sess = C) in
                                                    (
                                                        {345}if v_823 then
                                                        (
                                                            {346}let pkSess_824: bitstring = pub(skC) in
                                                            {347}out(c, GetEndpointRequest);
                                                            {348}in(c, (=GetEndpointResponse,=pkSess_824,=Sign,SP_825: bitstring,UP_826: bitstring));
                                                            {349}new Nc_827: bitstring;
                                                            {350}let gNc_828: bitstring = exp(g,Nc_827) in
                                                            {351}let m1_829: bitstring = (OpenSecureChannelRequest,pkCli,gNc_828) in
                                                            {352}out(c, (pkCli,m1_829,sign(h(m1_829),skCli)));
                                                            {353}in(c, (em2_830: bitstring,sigM2_831: bitstring));
                                                            {354}let m2_832: bitstring = em2_830 in
                                                            {355}if (verify(h(m2_832),sigM2_831,pkSess_824) <> true) then
                                                                0
                                                            else
                                                                {356}let (=OpenSecureChannelResponse,PartS_833: bitstring,ST_834: bitstring,TTL_835: bitstring) = m2_832 in
                                                                {357}let Kcli_836: bitstring = exp(PartS_833,Nc_827) in
                                                                {358}out(c, senc(mCli(pkCli,pkSess_824),Kcli_836))
                                                        )
                                                        else
                                                            {359}let pkSess_837: bitstring = pub(sk(Sess)) in
                                                            {360}out(c, GetEndpointRequest);
                                                            {361}in(c, (=GetEndpointResponse,=pkSess_837,=Sign,SP_838: bitstring,UP_839: bitstring));
                                                            {362}new Nc_840: bitstring;
                                                            {363}let gNc_841: bitstring = exp(g,Nc_840) in
                                                            {364}let m1_842: bitstring = (OpenSecureChannelRequest,pkCli,gNc_841) in
                                                            {365}out(c, (pkCli,m1_842,sign(h(m1_842),skCli)));
                                                            {366}in(c, (em2_843: bitstring,sigM2_844: bitstring));
                                                            {367}let m2_845: bitstring = em2_843 in
                                                            {368}if (verify(h(m2_845),sigM2_844,pkSess_837) <> true) then
                                                                0
                                                            else
                                                                {369}let (=OpenSecureChannelResponse,PartS_846: bitstring,ST_847: bitstring,TTL_848: bitstring) = m2_845 in
                                                                {370}let Kcli_849: bitstring = exp(PartS_846,Nc_840) in
                                                                {371}out(c, senc(mCli(pkCli,pkSess_837),Kcli_849))
                                                    )
                                                    else
                                                        {372}let pkSess_850: bitstring = fail-any in
                                                        {373}out(c, GetEndpointRequest);
                                                        {374}in(c, (=GetEndpointResponse,=pkSess_850,=Sign,SP_851: bitstring,UP_852: bitstring));
                                                        {375}new Nc_853: bitstring;
                                                        {376}let gNc_854: bitstring = exp(g,Nc_853) in
                                                        {377}let m1_855: bitstring = (OpenSecureChannelRequest,pkCli,gNc_854) in
                                                        {378}out(c, (pkCli,m1_855,sign(h(m1_855),skCli)));
                                                        {379}in(c, (em2_856: bitstring,sigM2_857: bitstring));
                                                        {380}let m2_858: bitstring = em2_856 in
                                                        {381}if (verify(h(m2_858),sigM2_857,pkSess_850) <> true) then
                                                            0
                                                        else
                                                            {382}let (=OpenSecureChannelResponse,PartS_859: bitstring,ST_860: bitstring,TTL_861: bitstring) = m2_858 in
                                                            {383}let Kcli_862: bitstring = exp(PartS_859,Nc_853) in
                                                            {384}out(c, senc(mCli(pkCli,pkSess_850),Kcli_862))
                                            )
                                            else
                                                {385}let pkSess_863: bitstring = fail-any in
                                                {386}out(c, GetEndpointRequest);
                                                {387}in(c, (=GetEndpointResponse,=pkSess_863,=Sign,SP_864: bitstring,UP_865: bitstring));
                                                {388}new Nc_866: bitstring;
                                                {389}let gNc_867: bitstring = exp(g,Nc_866) in
                                                {390}let m1_868: bitstring = (OpenSecureChannelRequest,pkCli,gNc_867) in
                                                {391}out(c, (pkCli,m1_868,sign(h(m1_868),skCli)));
                                                {392}in(c, (em2_869: bitstring,sigM2_870: bitstring));
                                                {393}let m2_871: bitstring = em2_869 in
                                                {394}if (verify(h(m2_871),sigM2_870,pkSess_863) <> true) then
                                                    0
                                                else
                                                    {395}let (=OpenSecureChannelResponse,PartS_872: bitstring,ST_873: bitstring,TTL_874: bitstring) = m2_871 in
                                                    {396}let Kcli_875: bitstring = exp(PartS_872,Nc_866) in
                                                    {397}out(c, senc(mCli(pkCli,pkSess_863),Kcli_875))
                                    )
                                    else
                                        {398}let pkSess_876: bitstring = fail-any in
                                        {399}out(c, GetEndpointRequest);
                                        {400}in(c, (=GetEndpointResponse,=pkSess_876,=Sign,SP_877: bitstring,UP_878: bitstring));
                                        {401}new Nc_879: bitstring;
                                        {402}let gNc_880: bitstring = exp(g,Nc_879) in
                                        {403}let m1_881: bitstring = (OpenSecureChannelRequest,pkCli,gNc_880) in
                                        {404}out(c, (pkCli,m1_881,sign(h(m1_881),skCli)));
                                        {405}in(c, (em2_882: bitstring,sigM2_883: bitstring));
                                        {406}let m2_884: bitstring = em2_882 in
                                        {407}if (verify(h(m2_884),sigM2_883,pkSess_876) <> true) then
                                            0
                                        else
                                            {408}let (=OpenSecureChannelResponse,PartS_885: bitstring,ST_886: bitstring,TTL_887: bitstring) = m2_884 in
                                            {409}let Kcli_888: bitstring = exp(PartS_885,Nc_879) in
                                            {410}out(c, senc(mCli(pkCli,pkSess_876),Kcli_888))
                            )
                            else
                                {411}let pkDisco_889: bitstring = fail-any in
                                {412}let v_890: bool = (Sess = A) in
                                (
                                    {413}if v_890 then
                                    (
                                        {414}let pkSess_891: bitstring = pub(skA) in
                                        {415}out(c, GetEndpointRequest);
                                        {416}in(c, (=GetEndpointResponse,=pkSess_891,=Sign,SP_892: bitstring,UP_893: bitstring));
                                        {417}new Nc_894: bitstring;
                                        {418}let gNc_895: bitstring = exp(g,Nc_894) in
                                        {419}let m1_896: bitstring = (OpenSecureChannelRequest,pkCli,gNc_895) in
                                        {420}out(c, (pkCli,m1_896,sign(h(m1_896),skCli)));
                                        {421}in(c, (em2_897: bitstring,sigM2_898: bitstring));
                                        {422}let m2_899: bitstring = em2_897 in
                                        {423}if (verify(h(m2_899),sigM2_898,pkSess_891) <> true) then
                                            0
                                        else
                                            {424}let (=OpenSecureChannelResponse,PartS_900: bitstring,ST_901: bitstring,TTL_902: bitstring) = m2_899 in
                                            {425}let Kcli_903: bitstring = exp(PartS_900,Nc_894) in
                                            {426}out(c, senc(mCli(pkCli,pkSess_891),Kcli_903))
                                    )
                                    else
                                        {427}let v_904: bool = (Sess = B) in
                                        (
                                            {428}if v_904 then
                                            (
                                                {429}let pkSess_905: bitstring = pub(skB) in
                                                {430}out(c, GetEndpointRequest);
                                                {431}in(c, (=GetEndpointResponse,=pkSess_905,=Sign,SP_906: bitstring,UP_907: bitstring));
                                                {432}new Nc_908: bitstring;
                                                {433}let gNc_909: bitstring = exp(g,Nc_908) in
                                                {434}let m1_910: bitstring = (OpenSecureChannelRequest,pkCli,gNc_909) in
                                                {435}out(c, (pkCli,m1_910,sign(h(m1_910),skCli)));
                                                {436}in(c, (em2_911: bitstring,sigM2_912: bitstring));
                                                {437}let m2_913: bitstring = em2_911 in
                                                {438}if (verify(h(m2_913),sigM2_912,pkSess_905) <> true) then
                                                    0
                                                else
                                                    {439}let (=OpenSecureChannelResponse,PartS_914: bitstring,ST_915: bitstring,TTL_916: bitstring) = m2_913 in
                                                    {440}let Kcli_917: bitstring = exp(PartS_914,Nc_908) in
                                                    {441}out(c, senc(mCli(pkCli,pkSess_905),Kcli_917))
                                            )
                                            else
                                                {442}let v_918: bool = (Sess = C) in
                                                (
                                                    {443}if v_918 then
                                                    (
                                                        {444}let pkSess_919: bitstring = pub(skC) in
                                                        {445}out(c, GetEndpointRequest);
                                                        {446}in(c, (=GetEndpointResponse,=pkSess_919,=Sign,SP_920: bitstring,UP_921: bitstring));
                                                        {447}new Nc_922: bitstring;
                                                        {448}let gNc_923: bitstring = exp(g,Nc_922) in
                                                        {449}let m1_924: bitstring = (OpenSecureChannelRequest,pkCli,gNc_923) in
                                                        {450}out(c, (pkCli,m1_924,sign(h(m1_924),skCli)));
                                                        {451}in(c, (em2_925: bitstring,sigM2_926: bitstring));
                                                        {452}let m2_927: bitstring = em2_925 in
                                                        {453}if (verify(h(m2_927),sigM2_926,pkSess_919) <> true) then
                                                            0
                                                        else
                                                            {454}let (=OpenSecureChannelResponse,PartS_928: bitstring,ST_929: bitstring,TTL_930: bitstring) = m2_927 in
                                                            {455}let Kcli_931: bitstring = exp(PartS_928,Nc_922) in
                                                            {456}out(c, senc(mCli(pkCli,pkSess_919),Kcli_931))
                                                    )
                                                    else
                                                        {457}let pkSess_932: bitstring = pub(sk(Sess)) in
                                                        {458}out(c, GetEndpointRequest);
                                                        {459}in(c, (=GetEndpointResponse,=pkSess_932,=Sign,SP_933: bitstring,UP_934: bitstring));
                                                        {460}new Nc_935: bitstring;
                                                        {461}let gNc_936: bitstring = exp(g,Nc_935) in
                                                        {462}let m1_937: bitstring = (OpenSecureChannelRequest,pkCli,gNc_936) in
                                                        {463}out(c, (pkCli,m1_937,sign(h(m1_937),skCli)));
                                                        {464}in(c, (em2_938: bitstring,sigM2_939: bitstring));
                                                        {465}let m2_940: bitstring = em2_938 in
                                                        {466}if (verify(h(m2_940),sigM2_939,pkSess_932) <> true) then
                                                            0
                                                        else
                                                            {467}let (=OpenSecureChannelResponse,PartS_941: bitstring,ST_942: bitstring,TTL_943: bitstring) = m2_940 in
                                                            {468}let Kcli_944: bitstring = exp(PartS_941,Nc_935) in
                                                            {469}out(c, senc(mCli(pkCli,pkSess_932),Kcli_944))
                                                )
                                                else
                                                    {470}let pkSess_945: bitstring = fail-any in
                                                    {471}out(c, GetEndpointRequest);
                                                    {472}in(c, (=GetEndpointResponse,=pkSess_945,=Sign,SP_946: bitstring,UP_947: bitstring));
                                                    {473}new Nc_948: bitstring;
                                                    {474}let gNc_949: bitstring = exp(g,Nc_948) in
                                                    {475}let m1_950: bitstring = (OpenSecureChannelRequest,pkCli,gNc_949) in
                                                    {476}out(c, (pkCli,m1_950,sign(h(m1_950),skCli)));
                                                    {477}in(c, (em2_951: bitstring,sigM2_952: bitstring));
                                                    {478}let m2_953: bitstring = em2_951 in
                                                    {479}if (verify(h(m2_953),sigM2_952,pkSess_945) <> true) then
                                                        0
                                                    else
                                                        {480}let (=OpenSecureChannelResponse,PartS_954: bitstring,ST_955: bitstring,TTL_956: bitstring) = m2_953 in
                                                        {481}let Kcli_957: bitstring = exp(PartS_954,Nc_948) in
                                                        {482}out(c, senc(mCli(pkCli,pkSess_945),Kcli_957))
                                        )
                                        else
                                            {483}let pkSess_958: bitstring = fail-any in
                                            {484}out(c, GetEndpointRequest);
                                            {485}in(c, (=GetEndpointResponse,=pkSess_958,=Sign,SP_959: bitstring,UP_960: bitstring));
                                            {486}new Nc_961: bitstring;
                                            {487}let gNc_962: bitstring = exp(g,Nc_961) in
                                            {488}let m1_963: bitstring = (OpenSecureChannelRequest,pkCli,gNc_962) in
                                            {489}out(c, (pkCli,m1_963,sign(h(m1_963),skCli)));
                                            {490}in(c, (em2_964: bitstring,sigM2_965: bitstring));
                                            {491}let m2_966: bitstring = em2_964 in
                                            {492}if (verify(h(m2_966),sigM2_965,pkSess_958) <> true) then
                                                0
                                            else
                                                {493}let (=OpenSecureChannelResponse,PartS_967: bitstring,ST_968: bitstring,TTL_969: bitstring) = m2_966 in
                                                {494}let Kcli_970: bitstring = exp(PartS_967,Nc_961) in
                                                {495}out(c, senc(mCli(pkCli,pkSess_958),Kcli_970))
                                )
                                else
                                    {496}let pkSess_971: bitstring = fail-any in
                                    {497}out(c, GetEndpointRequest);
                                    {498}in(c, (=GetEndpointResponse,=pkSess_971,=Sign,SP_972: bitstring,UP_973: bitstring));
                                    {499}new Nc_974: bitstring;
                                    {500}let gNc_975: bitstring = exp(g,Nc_974) in
                                    {501}let m1_976: bitstring = (OpenSecureChannelRequest,pkCli,gNc_975) in
                                    {502}out(c, (pkCli,m1_976,sign(h(m1_976),skCli)));
                                    {503}in(c, (em2_977: bitstring,sigM2_978: bitstring));
                                    {504}let m2_979: bitstring = em2_977 in
                                    {505}if (verify(h(m2_979),sigM2_978,pkSess_971) <> true) then
                                        0
                                    else
                                        {506}let (=OpenSecureChannelResponse,PartS_980: bitstring,ST_981: bitstring,TTL_982: bitstring) = m2_979 in
                                        {507}let Kcli_983: bitstring = exp(PartS_980,Nc_974) in
                                        {508}out(c, senc(mCli(pkCli,pkSess_971),Kcli_983))
                    )
                    else
                        {509}let pkDisco_984: bitstring = fail-any in
                        {510}let v_985: bool = (Sess = A) in
                        (
                            {511}if v_985 then
                            (
                                {512}let pkSess_986: bitstring = pub(skA) in
                                {513}out(c, GetEndpointRequest);
                                {514}in(c, (=GetEndpointResponse,=pkSess_986,=Sign,SP_987: bitstring,UP_988: bitstring));
                                {515}new Nc_989: bitstring;
                                {516}let gNc_990: bitstring = exp(g,Nc_989) in
                                {517}let m1_991: bitstring = (OpenSecureChannelRequest,pkCli,gNc_990) in
                                {518}out(c, (pkCli,m1_991,sign(h(m1_991),skCli)));
                                {519}in(c, (em2_992: bitstring,sigM2_993: bitstring));
                                {520}let m2_994: bitstring = em2_992 in
                                {521}if (verify(h(m2_994),sigM2_993,pkSess_986) <> true) then
                                    0
                                else
                                    {522}let (=OpenSecureChannelResponse,PartS_995: bitstring,ST_996: bitstring,TTL_997: bitstring) = m2_994 in
                                    {523}let Kcli_998: bitstring = exp(PartS_995,Nc_989) in
                                    {524}out(c, senc(mCli(pkCli,pkSess_986),Kcli_998))
                            )
                            else
                                {525}let v_999: bool = (Sess = B) in
                                (
                                    {526}if v_999 then
                                    (
                                        {527}let pkSess_1000: bitstring = pub(skB) in
                                        {528}out(c, GetEndpointRequest);
                                        {529}in(c, (=GetEndpointResponse,=pkSess_1000,=Sign,SP_1001: bitstring,UP_1002: bitstring));
                                        {530}new Nc_1003: bitstring;
                                        {531}let gNc_1004: bitstring = exp(g,Nc_1003) in
                                        {532}let m1_1005: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1004) in
                                        {533}out(c, (pkCli,m1_1005,sign(h(m1_1005),skCli)));
                                        {534}in(c, (em2_1006: bitstring,sigM2_1007: bitstring));
                                        {535}let m2_1008: bitstring = em2_1006 in
                                        {536}if (verify(h(m2_1008),sigM2_1007,pkSess_1000) <> true) then
                                            0
                                        else
                                            {537}let (=OpenSecureChannelResponse,PartS_1009: bitstring,ST_1010: bitstring,TTL_1011: bitstring) = m2_1008 in
                                            {538}let Kcli_1012: bitstring = exp(PartS_1009,Nc_1003) in
                                            {539}out(c, senc(mCli(pkCli,pkSess_1000),Kcli_1012))
                                    )
                                    else
                                        {540}let v_1013: bool = (Sess = C) in
                                        (
                                            {541}if v_1013 then
                                            (
                                                {542}let pkSess_1014: bitstring = pub(skC) in
                                                {543}out(c, GetEndpointRequest);
                                                {544}in(c, (=GetEndpointResponse,=pkSess_1014,=Sign,SP_1015: bitstring,UP_1016: bitstring));
                                                {545}new Nc_1017: bitstring;
                                                {546}let gNc_1018: bitstring = exp(g,Nc_1017) in
                                                {547}let m1_1019: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1018) in
                                                {548}out(c, (pkCli,m1_1019,sign(h(m1_1019),skCli)));
                                                {549}in(c, (em2_1020: bitstring,sigM2_1021: bitstring));
                                                {550}let m2_1022: bitstring = em2_1020 in
                                                {551}if (verify(h(m2_1022),sigM2_1021,pkSess_1014) <> true) then
                                                    0
                                                else
                                                    {552}let (=OpenSecureChannelResponse,PartS_1023: bitstring,ST_1024: bitstring,TTL_1025: bitstring) = m2_1022 in
                                                    {553}let Kcli_1026: bitstring = exp(PartS_1023,Nc_1017) in
                                                    {554}out(c, senc(mCli(pkCli,pkSess_1014),Kcli_1026))
                                            )
                                            else
                                                {555}let pkSess_1027: bitstring = pub(sk(Sess)) in
                                                {556}out(c, GetEndpointRequest);
                                                {557}in(c, (=GetEndpointResponse,=pkSess_1027,=Sign,SP_1028: bitstring,UP_1029: bitstring));
                                                {558}new Nc_1030: bitstring;
                                                {559}let gNc_1031: bitstring = exp(g,Nc_1030) in
                                                {560}let m1_1032: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1031) in
                                                {561}out(c, (pkCli,m1_1032,sign(h(m1_1032),skCli)));
                                                {562}in(c, (em2_1033: bitstring,sigM2_1034: bitstring));
                                                {563}let m2_1035: bitstring = em2_1033 in
                                                {564}if (verify(h(m2_1035),sigM2_1034,pkSess_1027) <> true) then
                                                    0
                                                else
                                                    {565}let (=OpenSecureChannelResponse,PartS_1036: bitstring,ST_1037: bitstring,TTL_1038: bitstring) = m2_1035 in
                                                    {566}let Kcli_1039: bitstring = exp(PartS_1036,Nc_1030) in
                                                    {567}out(c, senc(mCli(pkCli,pkSess_1027),Kcli_1039))
                                        )
                                        else
                                            {568}let pkSess_1040: bitstring = fail-any in
                                            {569}out(c, GetEndpointRequest);
                                            {570}in(c, (=GetEndpointResponse,=pkSess_1040,=Sign,SP_1041: bitstring,UP_1042: bitstring));
                                            {571}new Nc_1043: bitstring;
                                            {572}let gNc_1044: bitstring = exp(g,Nc_1043) in
                                            {573}let m1_1045: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1044) in
                                            {574}out(c, (pkCli,m1_1045,sign(h(m1_1045),skCli)));
                                            {575}in(c, (em2_1046: bitstring,sigM2_1047: bitstring));
                                            {576}let m2_1048: bitstring = em2_1046 in
                                            {577}if (verify(h(m2_1048),sigM2_1047,pkSess_1040) <> true) then
                                                0
                                            else
                                                {578}let (=OpenSecureChannelResponse,PartS_1049: bitstring,ST_1050: bitstring,TTL_1051: bitstring) = m2_1048 in
                                                {579}let Kcli_1052: bitstring = exp(PartS_1049,Nc_1043) in
                                                {580}out(c, senc(mCli(pkCli,pkSess_1040),Kcli_1052))
                                )
                                else
                                    {581}let pkSess_1053: bitstring = fail-any in
                                    {582}out(c, GetEndpointRequest);
                                    {583}in(c, (=GetEndpointResponse,=pkSess_1053,=Sign,SP_1054: bitstring,UP_1055: bitstring));
                                    {584}new Nc_1056: bitstring;
                                    {585}let gNc_1057: bitstring = exp(g,Nc_1056) in
                                    {586}let m1_1058: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1057) in
                                    {587}out(c, (pkCli,m1_1058,sign(h(m1_1058),skCli)));
                                    {588}in(c, (em2_1059: bitstring,sigM2_1060: bitstring));
                                    {589}let m2_1061: bitstring = em2_1059 in
                                    {590}if (verify(h(m2_1061),sigM2_1060,pkSess_1053) <> true) then
                                        0
                                    else
                                        {591}let (=OpenSecureChannelResponse,PartS_1062: bitstring,ST_1063: bitstring,TTL_1064: bitstring) = m2_1061 in
                                        {592}let Kcli_1065: bitstring = exp(PartS_1062,Nc_1056) in
                                        {593}out(c, senc(mCli(pkCli,pkSess_1053),Kcli_1065))
                        )
                        else
                            {594}let pkSess_1066: bitstring = fail-any in
                            {595}out(c, GetEndpointRequest);
                            {596}in(c, (=GetEndpointResponse,=pkSess_1066,=Sign,SP_1067: bitstring,UP_1068: bitstring));
                            {597}new Nc_1069: bitstring;
                            {598}let gNc_1070: bitstring = exp(g,Nc_1069) in
                            {599}let m1_1071: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1070) in
                            {600}out(c, (pkCli,m1_1071,sign(h(m1_1071),skCli)));
                            {601}in(c, (em2_1072: bitstring,sigM2_1073: bitstring));
                            {602}let m2_1074: bitstring = em2_1072 in
                            {603}if (verify(h(m2_1074),sigM2_1073,pkSess_1066) <> true) then
                                0
                            else
                                {604}let (=OpenSecureChannelResponse,PartS_1075: bitstring,ST_1076: bitstring,TTL_1077: bitstring) = m2_1074 in
                                {605}let Kcli_1078: bitstring = exp(PartS_1075,Nc_1069) in
                                {606}out(c, senc(mCli(pkCli,pkSess_1066),Kcli_1078))
            )
            else
                {607}let pkDisco_1079: bitstring = fail-any in
                {608}let v_1080: bool = (Sess = A) in
                (
                    {609}if v_1080 then
                    (
                        {610}let pkSess_1081: bitstring = pub(skA) in
                        {611}out(c, GetEndpointRequest);
                        {612}in(c, (=GetEndpointResponse,=pkSess_1081,=Sign,SP_1082: bitstring,UP_1083: bitstring));
                        {613}new Nc_1084: bitstring;
                        {614}let gNc_1085: bitstring = exp(g,Nc_1084) in
                        {615}let m1_1086: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1085) in
                        {616}out(c, (pkCli,m1_1086,sign(h(m1_1086),skCli)));
                        {617}in(c, (em2_1087: bitstring,sigM2_1088: bitstring));
                        {618}let m2_1089: bitstring = em2_1087 in
                        {619}if (verify(h(m2_1089),sigM2_1088,pkSess_1081) <> true) then
                            0
                        else
                            {620}let (=OpenSecureChannelResponse,PartS_1090: bitstring,ST_1091: bitstring,TTL_1092: bitstring) = m2_1089 in
                            {621}let Kcli_1093: bitstring = exp(PartS_1090,Nc_1084) in
                            {622}out(c, senc(mCli(pkCli,pkSess_1081),Kcli_1093))
                    )
                    else
                        {623}let v_1094: bool = (Sess = B) in
                        (
                            {624}if v_1094 then
                            (
                                {625}let pkSess_1095: bitstring = pub(skB) in
                                {626}out(c, GetEndpointRequest);
                                {627}in(c, (=GetEndpointResponse,=pkSess_1095,=Sign,SP_1096: bitstring,UP_1097: bitstring));
                                {628}new Nc_1098: bitstring;
                                {629}let gNc_1099: bitstring = exp(g,Nc_1098) in
                                {630}let m1_1100: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1099) in
                                {631}out(c, (pkCli,m1_1100,sign(h(m1_1100),skCli)));
                                {632}in(c, (em2_1101: bitstring,sigM2_1102: bitstring));
                                {633}let m2_1103: bitstring = em2_1101 in
                                {634}if (verify(h(m2_1103),sigM2_1102,pkSess_1095) <> true) then
                                    0
                                else
                                    {635}let (=OpenSecureChannelResponse,PartS_1104: bitstring,ST_1105: bitstring,TTL_1106: bitstring) = m2_1103 in
                                    {636}let Kcli_1107: bitstring = exp(PartS_1104,Nc_1098) in
                                    {637}out(c, senc(mCli(pkCli,pkSess_1095),Kcli_1107))
                            )
                            else
                                {638}let v_1108: bool = (Sess = C) in
                                (
                                    {639}if v_1108 then
                                    (
                                        {640}let pkSess_1109: bitstring = pub(skC) in
                                        {641}out(c, GetEndpointRequest);
                                        {642}in(c, (=GetEndpointResponse,=pkSess_1109,=Sign,SP_1110: bitstring,UP_1111: bitstring));
                                        {643}new Nc_1112: bitstring;
                                        {644}let gNc_1113: bitstring = exp(g,Nc_1112) in
                                        {645}let m1_1114: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1113) in
                                        {646}out(c, (pkCli,m1_1114,sign(h(m1_1114),skCli)));
                                        {647}in(c, (em2_1115: bitstring,sigM2_1116: bitstring));
                                        {648}let m2_1117: bitstring = em2_1115 in
                                        {649}if (verify(h(m2_1117),sigM2_1116,pkSess_1109) <> true) then
                                            0
                                        else
                                            {650}let (=OpenSecureChannelResponse,PartS_1118: bitstring,ST_1119: bitstring,TTL_1120: bitstring) = m2_1117 in
                                            {651}let Kcli_1121: bitstring = exp(PartS_1118,Nc_1112) in
                                            {652}out(c, senc(mCli(pkCli,pkSess_1109),Kcli_1121))
                                    )
                                    else
                                        {653}let pkSess_1122: bitstring = pub(sk(Sess)) in
                                        {654}out(c, GetEndpointRequest);
                                        {655}in(c, (=GetEndpointResponse,=pkSess_1122,=Sign,SP_1123: bitstring,UP_1124: bitstring));
                                        {656}new Nc_1125: bitstring;
                                        {657}let gNc_1126: bitstring = exp(g,Nc_1125) in
                                        {658}let m1_1127: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1126) in
                                        {659}out(c, (pkCli,m1_1127,sign(h(m1_1127),skCli)));
                                        {660}in(c, (em2_1128: bitstring,sigM2_1129: bitstring));
                                        {661}let m2_1130: bitstring = em2_1128 in
                                        {662}if (verify(h(m2_1130),sigM2_1129,pkSess_1122) <> true) then
                                            0
                                        else
                                            {663}let (=OpenSecureChannelResponse,PartS_1131: bitstring,ST_1132: bitstring,TTL_1133: bitstring) = m2_1130 in
                                            {664}let Kcli_1134: bitstring = exp(PartS_1131,Nc_1125) in
                                            {665}out(c, senc(mCli(pkCli,pkSess_1122),Kcli_1134))
                                )
                                else
                                    {666}let pkSess_1135: bitstring = fail-any in
                                    {667}out(c, GetEndpointRequest);
                                    {668}in(c, (=GetEndpointResponse,=pkSess_1135,=Sign,SP_1136: bitstring,UP_1137: bitstring));
                                    {669}new Nc_1138: bitstring;
                                    {670}let gNc_1139: bitstring = exp(g,Nc_1138) in
                                    {671}let m1_1140: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1139) in
                                    {672}out(c, (pkCli,m1_1140,sign(h(m1_1140),skCli)));
                                    {673}in(c, (em2_1141: bitstring,sigM2_1142: bitstring));
                                    {674}let m2_1143: bitstring = em2_1141 in
                                    {675}if (verify(h(m2_1143),sigM2_1142,pkSess_1135) <> true) then
                                        0
                                    else
                                        {676}let (=OpenSecureChannelResponse,PartS_1144: bitstring,ST_1145: bitstring,TTL_1146: bitstring) = m2_1143 in
                                        {677}let Kcli_1147: bitstring = exp(PartS_1144,Nc_1138) in
                                        {678}out(c, senc(mCli(pkCli,pkSess_1135),Kcli_1147))
                        )
                        else
                            {679}let pkSess_1148: bitstring = fail-any in
                            {680}out(c, GetEndpointRequest);
                            {681}in(c, (=GetEndpointResponse,=pkSess_1148,=Sign,SP_1149: bitstring,UP_1150: bitstring));
                            {682}new Nc_1151: bitstring;
                            {683}let gNc_1152: bitstring = exp(g,Nc_1151) in
                            {684}let m1_1153: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1152) in
                            {685}out(c, (pkCli,m1_1153,sign(h(m1_1153),skCli)));
                            {686}in(c, (em2_1154: bitstring,sigM2_1155: bitstring));
                            {687}let m2_1156: bitstring = em2_1154 in
                            {688}if (verify(h(m2_1156),sigM2_1155,pkSess_1148) <> true) then
                                0
                            else
                                {689}let (=OpenSecureChannelResponse,PartS_1157: bitstring,ST_1158: bitstring,TTL_1159: bitstring) = m2_1156 in
                                {690}let Kcli_1160: bitstring = exp(PartS_1157,Nc_1151) in
                                {691}out(c, senc(mCli(pkCli,pkSess_1148),Kcli_1160))
                )
                else
                    {692}let pkSess_1161: bitstring = fail-any in
                    {693}out(c, GetEndpointRequest);
                    {694}in(c, (=GetEndpointResponse,=pkSess_1161,=Sign,SP_1162: bitstring,UP_1163: bitstring));
                    {695}new Nc_1164: bitstring;
                    {696}let gNc_1165: bitstring = exp(g,Nc_1164) in
                    {697}let m1_1166: bitstring = (OpenSecureChannelRequest,pkCli,gNc_1165) in
                    {698}out(c, (pkCli,m1_1166,sign(h(m1_1166),skCli)));
                    {699}in(c, (em2_1167: bitstring,sigM2_1168: bitstring));
                    {700}let m2_1169: bitstring = em2_1167 in
                    {701}if (verify(h(m2_1169),sigM2_1168,pkSess_1161) <> true) then
                        0
                    else
                        {702}let (=OpenSecureChannelResponse,PartS_1170: bitstring,ST_1171: bitstring,TTL_1172: bitstring) = m2_1169 in
                        {703}let Kcli_1173: bitstring = exp(PartS_1170,Nc_1164) in
                        {704}out(c, senc(mCli(pkCli,pkSess_1161),Kcli_1173))
        )
        else
            {705}let v_1174: bool = (Cli = B) in
            (
                {706}if v_1174 then
                (
                    {707}let skCli_1175: bitstring = skB in
                    {708}let pkCli_1176: bitstring = pub(skCli_1175) in
                    {709}let v_1177: bool = (Disco = A) in
                    (
                        {710}if v_1177 then
                        (
                            {711}let pkDisco_1178: bitstring = pub(skA) in
                            {712}let v_1179: bool = (Sess = A) in
                            (
                                {713}if v_1179 then
                                (
                                    {714}let pkSess_1180: bitstring = pub(skA) in
                                    {715}out(c, GetEndpointRequest);
                                    {716}in(c, (=GetEndpointResponse,=pkSess_1180,=Sign,SP_1181: bitstring,UP_1182: bitstring));
                                    {717}new Nc_1183: bitstring;
                                    {718}let gNc_1184: bitstring = exp(g,Nc_1183) in
                                    {719}let m1_1185: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1184) in
                                    {720}out(c, (pkCli_1176,m1_1185,sign(h(m1_1185),skCli_1175)));
                                    {721}in(c, (em2_1186: bitstring,sigM2_1187: bitstring));
                                    {722}let m2_1188: bitstring = em2_1186 in
                                    {723}if (verify(h(m2_1188),sigM2_1187,pkSess_1180) <> true) then
                                        0
                                    else
                                        {724}let (=OpenSecureChannelResponse,PartS_1189: bitstring,ST_1190: bitstring,TTL_1191: bitstring) = m2_1188 in
                                        {725}let Kcli_1192: bitstring = exp(PartS_1189,Nc_1183) in
                                        {726}out(c, senc(mCli(pkCli_1176,pkSess_1180),Kcli_1192))
                                )
                                else
                                    {727}let v_1193: bool = (Sess = B) in
                                    (
                                        {728}if v_1193 then
                                        (
                                            {729}let pkSess_1194: bitstring = pub(skB) in
                                            {730}out(c, GetEndpointRequest);
                                            {731}in(c, (=GetEndpointResponse,=pkSess_1194,=Sign,SP_1195: bitstring,UP_1196: bitstring));
                                            {732}new Nc_1197: bitstring;
                                            {733}let gNc_1198: bitstring = exp(g,Nc_1197) in
                                            {734}let m1_1199: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1198) in
                                            {735}out(c, (pkCli_1176,m1_1199,sign(h(m1_1199),skCli_1175)));
                                            {736}in(c, (em2_1200: bitstring,sigM2_1201: bitstring));
                                            {737}let m2_1202: bitstring = em2_1200 in
                                            {738}if (verify(h(m2_1202),sigM2_1201,pkSess_1194) <> true) then
                                                0
                                            else
                                                {739}let (=OpenSecureChannelResponse,PartS_1203: bitstring,ST_1204: bitstring,TTL_1205: bitstring) = m2_1202 in
                                                {740}let Kcli_1206: bitstring = exp(PartS_1203,Nc_1197) in
                                                {741}out(c, senc(mCli(pkCli_1176,pkSess_1194),Kcli_1206))
                                        )
                                        else
                                            {742}let v_1207: bool = (Sess = C) in
                                            (
                                                {743}if v_1207 then
                                                (
                                                    {744}let pkSess_1208: bitstring = pub(skC) in
                                                    {745}out(c, GetEndpointRequest);
                                                    {746}in(c, (=GetEndpointResponse,=pkSess_1208,=Sign,SP_1209: bitstring,UP_1210: bitstring));
                                                    {747}new Nc_1211: bitstring;
                                                    {748}let gNc_1212: bitstring = exp(g,Nc_1211) in
                                                    {749}let m1_1213: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1212) in
                                                    {750}out(c, (pkCli_1176,m1_1213,sign(h(m1_1213),skCli_1175)));
                                                    {751}in(c, (em2_1214: bitstring,sigM2_1215: bitstring));
                                                    {752}let m2_1216: bitstring = em2_1214 in
                                                    {753}if (verify(h(m2_1216),sigM2_1215,pkSess_1208) <> true) then
                                                        0
                                                    else
                                                        {754}let (=OpenSecureChannelResponse,PartS_1217: bitstring,ST_1218: bitstring,TTL_1219: bitstring) = m2_1216 in
                                                        {755}let Kcli_1220: bitstring = exp(PartS_1217,Nc_1211) in
                                                        {756}out(c, senc(mCli(pkCli_1176,pkSess_1208),Kcli_1220))
                                                )
                                                else
                                                    {757}let pkSess_1221: bitstring = pub(sk(Sess)) in
                                                    {758}out(c, GetEndpointRequest);
                                                    {759}in(c, (=GetEndpointResponse,=pkSess_1221,=Sign,SP_1222: bitstring,UP_1223: bitstring));
                                                    {760}new Nc_1224: bitstring;
                                                    {761}let gNc_1225: bitstring = exp(g,Nc_1224) in
                                                    {762}let m1_1226: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1225) in
                                                    {763}out(c, (pkCli_1176,m1_1226,sign(h(m1_1226),skCli_1175)));
                                                    {764}in(c, (em2_1227: bitstring,sigM2_1228: bitstring));
                                                    {765}let m2_1229: bitstring = em2_1227 in
                                                    {766}if (verify(h(m2_1229),sigM2_1228,pkSess_1221) <> true) then
                                                        0
                                                    else
                                                        {767}let (=OpenSecureChannelResponse,PartS_1230: bitstring,ST_1231: bitstring,TTL_1232: bitstring) = m2_1229 in
                                                        {768}let Kcli_1233: bitstring = exp(PartS_1230,Nc_1224) in
                                                        {769}out(c, senc(mCli(pkCli_1176,pkSess_1221),Kcli_1233))
                                            )
                                            else
                                                {770}let pkSess_1234: bitstring = fail-any in
                                                {771}out(c, GetEndpointRequest);
                                                {772}in(c, (=GetEndpointResponse,=pkSess_1234,=Sign,SP_1235: bitstring,UP_1236: bitstring));
                                                {773}new Nc_1237: bitstring;
                                                {774}let gNc_1238: bitstring = exp(g,Nc_1237) in
                                                {775}let m1_1239: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1238) in
                                                {776}out(c, (pkCli_1176,m1_1239,sign(h(m1_1239),skCli_1175)));
                                                {777}in(c, (em2_1240: bitstring,sigM2_1241: bitstring));
                                                {778}let m2_1242: bitstring = em2_1240 in
                                                {779}if (verify(h(m2_1242),sigM2_1241,pkSess_1234) <> true) then
                                                    0
                                                else
                                                    {780}let (=OpenSecureChannelResponse,PartS_1243: bitstring,ST_1244: bitstring,TTL_1245: bitstring) = m2_1242 in
                                                    {781}let Kcli_1246: bitstring = exp(PartS_1243,Nc_1237) in
                                                    {782}out(c, senc(mCli(pkCli_1176,pkSess_1234),Kcli_1246))
                                    )
                                    else
                                        {783}let pkSess_1247: bitstring = fail-any in
                                        {784}out(c, GetEndpointRequest);
                                        {785}in(c, (=GetEndpointResponse,=pkSess_1247,=Sign,SP_1248: bitstring,UP_1249: bitstring));
                                        {786}new Nc_1250: bitstring;
                                        {787}let gNc_1251: bitstring = exp(g,Nc_1250) in
                                        {788}let m1_1252: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1251) in
                                        {789}out(c, (pkCli_1176,m1_1252,sign(h(m1_1252),skCli_1175)));
                                        {790}in(c, (em2_1253: bitstring,sigM2_1254: bitstring));
                                        {791}let m2_1255: bitstring = em2_1253 in
                                        {792}if (verify(h(m2_1255),sigM2_1254,pkSess_1247) <> true) then
                                            0
                                        else
                                            {793}let (=OpenSecureChannelResponse,PartS_1256: bitstring,ST_1257: bitstring,TTL_1258: bitstring) = m2_1255 in
                                            {794}let Kcli_1259: bitstring = exp(PartS_1256,Nc_1250) in
                                            {795}out(c, senc(mCli(pkCli_1176,pkSess_1247),Kcli_1259))
                            )
                            else
                                {796}let pkSess_1260: bitstring = fail-any in
                                {797}out(c, GetEndpointRequest);
                                {798}in(c, (=GetEndpointResponse,=pkSess_1260,=Sign,SP_1261: bitstring,UP_1262: bitstring));
                                {799}new Nc_1263: bitstring;
                                {800}let gNc_1264: bitstring = exp(g,Nc_1263) in
                                {801}let m1_1265: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1264) in
                                {802}out(c, (pkCli_1176,m1_1265,sign(h(m1_1265),skCli_1175)));
                                {803}in(c, (em2_1266: bitstring,sigM2_1267: bitstring));
                                {804}let m2_1268: bitstring = em2_1266 in
                                {805}if (verify(h(m2_1268),sigM2_1267,pkSess_1260) <> true) then
                                    0
                                else
                                    {806}let (=OpenSecureChannelResponse,PartS_1269: bitstring,ST_1270: bitstring,TTL_1271: bitstring) = m2_1268 in
                                    {807}let Kcli_1272: bitstring = exp(PartS_1269,Nc_1263) in
                                    {808}out(c, senc(mCli(pkCli_1176,pkSess_1260),Kcli_1272))
                        )
                        else
                            {809}let v_1273: bool = (Disco = B) in
                            (
                                {810}if v_1273 then
                                (
                                    {811}let pkDisco_1274: bitstring = pub(skB) in
                                    {812}let v_1275: bool = (Sess = A) in
                                    (
                                        {813}if v_1275 then
                                        (
                                            {814}let pkSess_1276: bitstring = pub(skA) in
                                            {815}out(c, GetEndpointRequest);
                                            {816}in(c, (=GetEndpointResponse,=pkSess_1276,=Sign,SP_1277: bitstring,UP_1278: bitstring));
                                            {817}new Nc_1279: bitstring;
                                            {818}let gNc_1280: bitstring = exp(g,Nc_1279) in
                                            {819}let m1_1281: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1280) in
                                            {820}out(c, (pkCli_1176,m1_1281,sign(h(m1_1281),skCli_1175)));
                                            {821}in(c, (em2_1282: bitstring,sigM2_1283: bitstring));
                                            {822}let m2_1284: bitstring = em2_1282 in
                                            {823}if (verify(h(m2_1284),sigM2_1283,pkSess_1276) <> true) then
                                                0
                                            else
                                                {824}let (=OpenSecureChannelResponse,PartS_1285: bitstring,ST_1286: bitstring,TTL_1287: bitstring) = m2_1284 in
                                                {825}let Kcli_1288: bitstring = exp(PartS_1285,Nc_1279) in
                                                {826}out(c, senc(mCli(pkCli_1176,pkSess_1276),Kcli_1288))
                                        )
                                        else
                                            {827}let v_1289: bool = (Sess = B) in
                                            (
                                                {828}if v_1289 then
                                                (
                                                    {829}let pkSess_1290: bitstring = pub(skB) in
                                                    {830}out(c, GetEndpointRequest);
                                                    {831}in(c, (=GetEndpointResponse,=pkSess_1290,=Sign,SP_1291: bitstring,UP_1292: bitstring));
                                                    {832}new Nc_1293: bitstring;
                                                    {833}let gNc_1294: bitstring = exp(g,Nc_1293) in
                                                    {834}let m1_1295: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1294) in
                                                    {835}out(c, (pkCli_1176,m1_1295,sign(h(m1_1295),skCli_1175)));
                                                    {836}in(c, (em2_1296: bitstring,sigM2_1297: bitstring));
                                                    {837}let m2_1298: bitstring = em2_1296 in
                                                    {838}if (verify(h(m2_1298),sigM2_1297,pkSess_1290) <> true) then
                                                        0
                                                    else
                                                        {839}let (=OpenSecureChannelResponse,PartS_1299: bitstring,ST_1300: bitstring,TTL_1301: bitstring) = m2_1298 in
                                                        {840}let Kcli_1302: bitstring = exp(PartS_1299,Nc_1293) in
                                                        {841}out(c, senc(mCli(pkCli_1176,pkSess_1290),Kcli_1302))
                                                )
                                                else
                                                    {842}let v_1303: bool = (Sess = C) in
                                                    (
                                                        {843}if v_1303 then
                                                        (
                                                            {844}let pkSess_1304: bitstring = pub(skC) in
                                                            {845}out(c, GetEndpointRequest);
                                                            {846}in(c, (=GetEndpointResponse,=pkSess_1304,=Sign,SP_1305: bitstring,UP_1306: bitstring));
                                                            {847}new Nc_1307: bitstring;
                                                            {848}let gNc_1308: bitstring = exp(g,Nc_1307) in
                                                            {849}let m1_1309: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1308) in
                                                            {850}out(c, (pkCli_1176,m1_1309,sign(h(m1_1309),skCli_1175)));
                                                            {851}in(c, (em2_1310: bitstring,sigM2_1311: bitstring));
                                                            {852}let m2_1312: bitstring = em2_1310 in
                                                            {853}if (verify(h(m2_1312),sigM2_1311,pkSess_1304) <> true) then
                                                                0
                                                            else
                                                                {854}let (=OpenSecureChannelResponse,PartS_1313: bitstring,ST_1314: bitstring,TTL_1315: bitstring) = m2_1312 in
                                                                {855}let Kcli_1316: bitstring = exp(PartS_1313,Nc_1307) in
                                                                {856}out(c, senc(mCli(pkCli_1176,pkSess_1304),Kcli_1316))
                                                        )
                                                        else
                                                            {857}let pkSess_1317: bitstring = pub(sk(Sess)) in
                                                            {858}out(c, GetEndpointRequest);
                                                            {859}in(c, (=GetEndpointResponse,=pkSess_1317,=Sign,SP_1318: bitstring,UP_1319: bitstring));
                                                            {860}new Nc_1320: bitstring;
                                                            {861}let gNc_1321: bitstring = exp(g,Nc_1320) in
                                                            {862}let m1_1322: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1321) in
                                                            {863}out(c, (pkCli_1176,m1_1322,sign(h(m1_1322),skCli_1175)));
                                                            {864}in(c, (em2_1323: bitstring,sigM2_1324: bitstring));
                                                            {865}let m2_1325: bitstring = em2_1323 in
                                                            {866}if (verify(h(m2_1325),sigM2_1324,pkSess_1317) <> true) then
                                                                0
                                                            else
                                                                {867}let (=OpenSecureChannelResponse,PartS_1326: bitstring,ST_1327: bitstring,TTL_1328: bitstring) = m2_1325 in
                                                                {868}let Kcli_1329: bitstring = exp(PartS_1326,Nc_1320) in
                                                                {869}out(c, senc(mCli(pkCli_1176,pkSess_1317),Kcli_1329))
                                                    )
                                                    else
                                                        {870}let pkSess_1330: bitstring = fail-any in
                                                        {871}out(c, GetEndpointRequest);
                                                        {872}in(c, (=GetEndpointResponse,=pkSess_1330,=Sign,SP_1331: bitstring,UP_1332: bitstring));
                                                        {873}new Nc_1333: bitstring;
                                                        {874}let gNc_1334: bitstring = exp(g,Nc_1333) in
                                                        {875}let m1_1335: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1334) in
                                                        {876}out(c, (pkCli_1176,m1_1335,sign(h(m1_1335),skCli_1175)));
                                                        {877}in(c, (em2_1336: bitstring,sigM2_1337: bitstring));
                                                        {878}let m2_1338: bitstring = em2_1336 in
                                                        {879}if (verify(h(m2_1338),sigM2_1337,pkSess_1330) <> true) then
                                                            0
                                                        else
                                                            {880}let (=OpenSecureChannelResponse,PartS_1339: bitstring,ST_1340: bitstring,TTL_1341: bitstring) = m2_1338 in
                                                            {881}let Kcli_1342: bitstring = exp(PartS_1339,Nc_1333) in
                                                            {882}out(c, senc(mCli(pkCli_1176,pkSess_1330),Kcli_1342))
                                            )
                                            else
                                                {883}let pkSess_1343: bitstring = fail-any in
                                                {884}out(c, GetEndpointRequest);
                                                {885}in(c, (=GetEndpointResponse,=pkSess_1343,=Sign,SP_1344: bitstring,UP_1345: bitstring));
                                                {886}new Nc_1346: bitstring;
                                                {887}let gNc_1347: bitstring = exp(g,Nc_1346) in
                                                {888}let m1_1348: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1347) in
                                                {889}out(c, (pkCli_1176,m1_1348,sign(h(m1_1348),skCli_1175)));
                                                {890}in(c, (em2_1349: bitstring,sigM2_1350: bitstring));
                                                {891}let m2_1351: bitstring = em2_1349 in
                                                {892}if (verify(h(m2_1351),sigM2_1350,pkSess_1343) <> true) then
                                                    0
                                                else
                                                    {893}let (=OpenSecureChannelResponse,PartS_1352: bitstring,ST_1353: bitstring,TTL_1354: bitstring) = m2_1351 in
                                                    {894}let Kcli_1355: bitstring = exp(PartS_1352,Nc_1346) in
                                                    {895}out(c, senc(mCli(pkCli_1176,pkSess_1343),Kcli_1355))
                                    )
                                    else
                                        {896}let pkSess_1356: bitstring = fail-any in
                                        {897}out(c, GetEndpointRequest);
                                        {898}in(c, (=GetEndpointResponse,=pkSess_1356,=Sign,SP_1357: bitstring,UP_1358: bitstring));
                                        {899}new Nc_1359: bitstring;
                                        {900}let gNc_1360: bitstring = exp(g,Nc_1359) in
                                        {901}let m1_1361: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1360) in
                                        {902}out(c, (pkCli_1176,m1_1361,sign(h(m1_1361),skCli_1175)));
                                        {903}in(c, (em2_1362: bitstring,sigM2_1363: bitstring));
                                        {904}let m2_1364: bitstring = em2_1362 in
                                        {905}if (verify(h(m2_1364),sigM2_1363,pkSess_1356) <> true) then
                                            0
                                        else
                                            {906}let (=OpenSecureChannelResponse,PartS_1365: bitstring,ST_1366: bitstring,TTL_1367: bitstring) = m2_1364 in
                                            {907}let Kcli_1368: bitstring = exp(PartS_1365,Nc_1359) in
                                            {908}out(c, senc(mCli(pkCli_1176,pkSess_1356),Kcli_1368))
                                )
                                else
                                    {909}let v_1369: bool = (Disco = C) in
                                    (
                                        {910}if v_1369 then
                                        (
                                            {911}let pkDisco_1370: bitstring = pub(skC) in
                                            {912}let v_1371: bool = (Sess = A) in
                                            (
                                                {913}if v_1371 then
                                                (
                                                    {914}let pkSess_1372: bitstring = pub(skA) in
                                                    {915}out(c, GetEndpointRequest);
                                                    {916}in(c, (=GetEndpointResponse,=pkSess_1372,=Sign,SP_1373: bitstring,UP_1374: bitstring));
                                                    {917}new Nc_1375: bitstring;
                                                    {918}let gNc_1376: bitstring = exp(g,Nc_1375) in
                                                    {919}let m1_1377: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1376) in
                                                    {920}out(c, (pkCli_1176,m1_1377,sign(h(m1_1377),skCli_1175)));
                                                    {921}in(c, (em2_1378: bitstring,sigM2_1379: bitstring));
                                                    {922}let m2_1380: bitstring = em2_1378 in
                                                    {923}if (verify(h(m2_1380),sigM2_1379,pkSess_1372) <> true) then
                                                        0
                                                    else
                                                        {924}let (=OpenSecureChannelResponse,PartS_1381: bitstring,ST_1382: bitstring,TTL_1383: bitstring) = m2_1380 in
                                                        {925}let Kcli_1384: bitstring = exp(PartS_1381,Nc_1375) in
                                                        {926}out(c, senc(mCli(pkCli_1176,pkSess_1372),Kcli_1384))
                                                )
                                                else
                                                    {927}let v_1385: bool = (Sess = B) in
                                                    (
                                                        {928}if v_1385 then
                                                        (
                                                            {929}let pkSess_1386: bitstring = pub(skB) in
                                                            {930}out(c, GetEndpointRequest);
                                                            {931}in(c, (=GetEndpointResponse,=pkSess_1386,=Sign,SP_1387: bitstring,UP_1388: bitstring));
                                                            {932}new Nc_1389: bitstring;
                                                            {933}let gNc_1390: bitstring = exp(g,Nc_1389) in
                                                            {934}let m1_1391: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1390) in
                                                            {935}out(c, (pkCli_1176,m1_1391,sign(h(m1_1391),skCli_1175)));
                                                            {936}in(c, (em2_1392: bitstring,sigM2_1393: bitstring));
                                                            {937}let m2_1394: bitstring = em2_1392 in
                                                            {938}if (verify(h(m2_1394),sigM2_1393,pkSess_1386) <> true) then
                                                                0
                                                            else
                                                                {939}let (=OpenSecureChannelResponse,PartS_1395: bitstring,ST_1396: bitstring,TTL_1397: bitstring) = m2_1394 in
                                                                {940}let Kcli_1398: bitstring = exp(PartS_1395,Nc_1389) in
                                                                {941}out(c, senc(mCli(pkCli_1176,pkSess_1386),Kcli_1398))
                                                        )
                                                        else
                                                            {942}let v_1399: bool = (Sess = C) in
                                                            (
                                                                {943}if v_1399 then
                                                                (
                                                                    {944}let pkSess_1400: bitstring = pub(skC) in
                                                                    {945}out(c, GetEndpointRequest);
                                                                    {946}in(c, (=GetEndpointResponse,=pkSess_1400,=Sign,SP_1401: bitstring,UP_1402: bitstring));
                                                                    {947}new Nc_1403: bitstring;
                                                                    {948}let gNc_1404: bitstring = exp(g,Nc_1403) in
                                                                    {949}let m1_1405: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1404) in
                                                                    {950}out(c, (pkCli_1176,m1_1405,sign(h(m1_1405),skCli_1175)));
                                                                    {951}in(c, (em2_1406: bitstring,sigM2_1407: bitstring));
                                                                    {952}let m2_1408: bitstring = em2_1406 in
                                                                    {953}if (verify(h(m2_1408),sigM2_1407,pkSess_1400) <> true) then
                                                                        0
                                                                    else
                                                                        {954}let (=OpenSecureChannelResponse,PartS_1409: bitstring,ST_1410: bitstring,TTL_1411: bitstring) = m2_1408 in
                                                                        {955}let Kcli_1412: bitstring = exp(PartS_1409,Nc_1403) in
                                                                        {956}out(c, senc(mCli(pkCli_1176,pkSess_1400),Kcli_1412))
                                                                )
                                                                else
                                                                    {957}let pkSess_1413: bitstring = pub(sk(Sess)) in
                                                                    {958}out(c, GetEndpointRequest);
                                                                    {959}in(c, (=GetEndpointResponse,=pkSess_1413,=Sign,SP_1414: bitstring,UP_1415: bitstring));
                                                                    {960}new Nc_1416: bitstring;
                                                                    {961}let gNc_1417: bitstring = exp(g,Nc_1416) in
                                                                    {962}let m1_1418: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1417) in
                                                                    {963}out(c, (pkCli_1176,m1_1418,sign(h(m1_1418),skCli_1175)));
                                                                    {964}in(c, (em2_1419: bitstring,sigM2_1420: bitstring));
                                                                    {965}let m2_1421: bitstring = em2_1419 in
                                                                    {966}if (verify(h(m2_1421),sigM2_1420,pkSess_1413) <> true) then
                                                                        0
                                                                    else
                                                                        {967}let (=OpenSecureChannelResponse,PartS_1422: bitstring,ST_1423: bitstring,TTL_1424: bitstring) = m2_1421 in
                                                                        {968}let Kcli_1425: bitstring = exp(PartS_1422,Nc_1416) in
                                                                        {969}out(c, senc(mCli(pkCli_1176,pkSess_1413),Kcli_1425))
                                                            )
                                                            else
                                                                {970}let pkSess_1426: bitstring = fail-any in
                                                                {971}out(c, GetEndpointRequest);
                                                                {972}in(c, (=GetEndpointResponse,=pkSess_1426,=Sign,SP_1427: bitstring,UP_1428: bitstring));
                                                                {973}new Nc_1429: bitstring;
                                                                {974}let gNc_1430: bitstring = exp(g,Nc_1429) in
                                                                {975}let m1_1431: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1430) in
                                                                {976}out(c, (pkCli_1176,m1_1431,sign(h(m1_1431),skCli_1175)));
                                                                {977}in(c, (em2_1432: bitstring,sigM2_1433: bitstring));
                                                                {978}let m2_1434: bitstring = em2_1432 in
                                                                {979}if (verify(h(m2_1434),sigM2_1433,pkSess_1426) <> true) then
                                                                    0
                                                                else
                                                                    {980}let (=OpenSecureChannelResponse,PartS_1435: bitstring,ST_1436: bitstring,TTL_1437: bitstring) = m2_1434 in
                                                                    {981}let Kcli_1438: bitstring = exp(PartS_1435,Nc_1429) in
                                                                    {982}out(c, senc(mCli(pkCli_1176,pkSess_1426),Kcli_1438))
                                                    )
                                                    else
                                                        {983}let pkSess_1439: bitstring = fail-any in
                                                        {984}out(c, GetEndpointRequest);
                                                        {985}in(c, (=GetEndpointResponse,=pkSess_1439,=Sign,SP_1440: bitstring,UP_1441: bitstring));
                                                        {986}new Nc_1442: bitstring;
                                                        {987}let gNc_1443: bitstring = exp(g,Nc_1442) in
                                                        {988}let m1_1444: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1443) in
                                                        {989}out(c, (pkCli_1176,m1_1444,sign(h(m1_1444),skCli_1175)));
                                                        {990}in(c, (em2_1445: bitstring,sigM2_1446: bitstring));
                                                        {991}let m2_1447: bitstring = em2_1445 in
                                                        {992}if (verify(h(m2_1447),sigM2_1446,pkSess_1439) <> true) then
                                                            0
                                                        else
                                                            {993}let (=OpenSecureChannelResponse,PartS_1448: bitstring,ST_1449: bitstring,TTL_1450: bitstring) = m2_1447 in
                                                            {994}let Kcli_1451: bitstring = exp(PartS_1448,Nc_1442) in
                                                            {995}out(c, senc(mCli(pkCli_1176,pkSess_1439),Kcli_1451))
                                            )
                                            else
                                                {996}let pkSess_1452: bitstring = fail-any in
                                                {997}out(c, GetEndpointRequest);
                                                {998}in(c, (=GetEndpointResponse,=pkSess_1452,=Sign,SP_1453: bitstring,UP_1454: bitstring));
                                                {999}new Nc_1455: bitstring;
                                                {1000}let gNc_1456: bitstring = exp(g,Nc_1455) in
                                                {1001}let m1_1457: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1456) in
                                                {1002}out(c, (pkCli_1176,m1_1457,sign(h(m1_1457),skCli_1175)));
                                                {1003}in(c, (em2_1458: bitstring,sigM2_1459: bitstring));
                                                {1004}let m2_1460: bitstring = em2_1458 in
                                                {1005}if (verify(h(m2_1460),sigM2_1459,pkSess_1452) <> true) then
                                                    0
                                                else
                                                    {1006}let (=OpenSecureChannelResponse,PartS_1461: bitstring,ST_1462: bitstring,TTL_1463: bitstring) = m2_1460 in
                                                    {1007}let Kcli_1464: bitstring = exp(PartS_1461,Nc_1455) in
                                                    {1008}out(c, senc(mCli(pkCli_1176,pkSess_1452),Kcli_1464))
                                        )
                                        else
                                            {1009}let pkDisco_1465: bitstring = pub(sk(Disco)) in
                                            {1010}let v_1466: bool = (Sess = A) in
                                            (
                                                {1011}if v_1466 then
                                                (
                                                    {1012}let pkSess_1467: bitstring = pub(skA) in
                                                    {1013}out(c, GetEndpointRequest);
                                                    {1014}in(c, (=GetEndpointResponse,=pkSess_1467,=Sign,SP_1468: bitstring,UP_1469: bitstring));
                                                    {1015}new Nc_1470: bitstring;
                                                    {1016}let gNc_1471: bitstring = exp(g,Nc_1470) in
                                                    {1017}let m1_1472: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1471) in
                                                    {1018}out(c, (pkCli_1176,m1_1472,sign(h(m1_1472),skCli_1175)));
                                                    {1019}in(c, (em2_1473: bitstring,sigM2_1474: bitstring));
                                                    {1020}let m2_1475: bitstring = em2_1473 in
                                                    {1021}if (verify(h(m2_1475),sigM2_1474,pkSess_1467) <> true) then
                                                        0
                                                    else
                                                        {1022}let (=OpenSecureChannelResponse,PartS_1476: bitstring,ST_1477: bitstring,TTL_1478: bitstring) = m2_1475 in
                                                        {1023}let Kcli_1479: bitstring = exp(PartS_1476,Nc_1470) in
                                                        {1024}out(c, senc(mCli(pkCli_1176,pkSess_1467),Kcli_1479))
                                                )
                                                else
                                                    {1025}let v_1480: bool = (Sess = B) in
                                                    (
                                                        {1026}if v_1480 then
                                                        (
                                                            {1027}let pkSess_1481: bitstring = pub(skB) in
                                                            {1028}out(c, GetEndpointRequest);
                                                            {1029}in(c, (=GetEndpointResponse,=pkSess_1481,=Sign,SP_1482: bitstring,UP_1483: bitstring));
                                                            {1030}new Nc_1484: bitstring;
                                                            {1031}let gNc_1485: bitstring = exp(g,Nc_1484) in
                                                            {1032}let m1_1486: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1485) in
                                                            {1033}out(c, (pkCli_1176,m1_1486,sign(h(m1_1486),skCli_1175)));
                                                            {1034}in(c, (em2_1487: bitstring,sigM2_1488: bitstring));
                                                            {1035}let m2_1489: bitstring = em2_1487 in
                                                            {1036}if (verify(h(m2_1489),sigM2_1488,pkSess_1481) <> true) then
                                                                0
                                                            else
                                                                {1037}let (=OpenSecureChannelResponse,PartS_1490: bitstring,ST_1491: bitstring,TTL_1492: bitstring) = m2_1489 in
                                                                {1038}let Kcli_1493: bitstring = exp(PartS_1490,Nc_1484) in
                                                                {1039}out(c, senc(mCli(pkCli_1176,pkSess_1481),Kcli_1493))
                                                        )
                                                        else
                                                            {1040}let v_1494: bool = (Sess = C) in
                                                            (
                                                                {1041}if v_1494 then
                                                                (
                                                                    {1042}let pkSess_1495: bitstring = pub(skC) in
                                                                    {1043}out(c, GetEndpointRequest);
                                                                    {1044}in(c, (=GetEndpointResponse,=pkSess_1495,=Sign,SP_1496: bitstring,UP_1497: bitstring));
                                                                    {1045}new Nc_1498: bitstring;
                                                                    {1046}let gNc_1499: bitstring = exp(g,Nc_1498) in
                                                                    {1047}let m1_1500: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1499) in
                                                                    {1048}out(c, (pkCli_1176,m1_1500,sign(h(m1_1500),skCli_1175)));
                                                                    {1049}in(c, (em2_1501: bitstring,sigM2_1502: bitstring));
                                                                    {1050}let m2_1503: bitstring = em2_1501 in
                                                                    {1051}if (verify(h(m2_1503),sigM2_1502,pkSess_1495) <> true) then
                                                                        0
                                                                    else
                                                                        {1052}let (=OpenSecureChannelResponse,PartS_1504: bitstring,ST_1505: bitstring,TTL_1506: bitstring) = m2_1503 in
                                                                        {1053}let Kcli_1507: bitstring = exp(PartS_1504,Nc_1498) in
                                                                        {1054}out(c, senc(mCli(pkCli_1176,pkSess_1495),Kcli_1507))
                                                                )
                                                                else
                                                                    {1055}let pkSess_1508: bitstring = pub(sk(Sess)) in
                                                                    {1056}out(c, GetEndpointRequest);
                                                                    {1057}in(c, (=GetEndpointResponse,=pkSess_1508,=Sign,SP_1509: bitstring,UP_1510: bitstring));
                                                                    {1058}new Nc_1511: bitstring;
                                                                    {1059}let gNc_1512: bitstring = exp(g,Nc_1511) in
                                                                    {1060}let m1_1513: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1512) in
                                                                    {1061}out(c, (pkCli_1176,m1_1513,sign(h(m1_1513),skCli_1175)));
                                                                    {1062}in(c, (em2_1514: bitstring,sigM2_1515: bitstring));
                                                                    {1063}let m2_1516: bitstring = em2_1514 in
                                                                    {1064}if (verify(h(m2_1516),sigM2_1515,pkSess_1508) <> true) then
                                                                        0
                                                                    else
                                                                        {1065}let (=OpenSecureChannelResponse,PartS_1517: bitstring,ST_1518: bitstring,TTL_1519: bitstring) = m2_1516 in
                                                                        {1066}let Kcli_1520: bitstring = exp(PartS_1517,Nc_1511) in
                                                                        {1067}out(c, senc(mCli(pkCli_1176,pkSess_1508),Kcli_1520))
                                                            )
                                                            else
                                                                {1068}let pkSess_1521: bitstring = fail-any in
                                                                {1069}out(c, GetEndpointRequest);
                                                                {1070}in(c, (=GetEndpointResponse,=pkSess_1521,=Sign,SP_1522: bitstring,UP_1523: bitstring));
                                                                {1071}new Nc_1524: bitstring;
                                                                {1072}let gNc_1525: bitstring = exp(g,Nc_1524) in
                                                                {1073}let m1_1526: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1525) in
                                                                {1074}out(c, (pkCli_1176,m1_1526,sign(h(m1_1526),skCli_1175)));
                                                                {1075}in(c, (em2_1527: bitstring,sigM2_1528: bitstring));
                                                                {1076}let m2_1529: bitstring = em2_1527 in
                                                                {1077}if (verify(h(m2_1529),sigM2_1528,pkSess_1521) <> true) then
                                                                    0
                                                                else
                                                                    {1078}let (=OpenSecureChannelResponse,PartS_1530: bitstring,ST_1531: bitstring,TTL_1532: bitstring) = m2_1529 in
                                                                    {1079}let Kcli_1533: bitstring = exp(PartS_1530,Nc_1524) in
                                                                    {1080}out(c, senc(mCli(pkCli_1176,pkSess_1521),Kcli_1533))
                                                    )
                                                    else
                                                        {1081}let pkSess_1534: bitstring = fail-any in
                                                        {1082}out(c, GetEndpointRequest);
                                                        {1083}in(c, (=GetEndpointResponse,=pkSess_1534,=Sign,SP_1535: bitstring,UP_1536: bitstring));
                                                        {1084}new Nc_1537: bitstring;
                                                        {1085}let gNc_1538: bitstring = exp(g,Nc_1537) in
                                                        {1086}let m1_1539: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1538) in
                                                        {1087}out(c, (pkCli_1176,m1_1539,sign(h(m1_1539),skCli_1175)));
                                                        {1088}in(c, (em2_1540: bitstring,sigM2_1541: bitstring));
                                                        {1089}let m2_1542: bitstring = em2_1540 in
                                                        {1090}if (verify(h(m2_1542),sigM2_1541,pkSess_1534) <> true) then
                                                            0
                                                        else
                                                            {1091}let (=OpenSecureChannelResponse,PartS_1543: bitstring,ST_1544: bitstring,TTL_1545: bitstring) = m2_1542 in
                                                            {1092}let Kcli_1546: bitstring = exp(PartS_1543,Nc_1537) in
                                                            {1093}out(c, senc(mCli(pkCli_1176,pkSess_1534),Kcli_1546))
                                            )
                                            else
                                                {1094}let pkSess_1547: bitstring = fail-any in
                                                {1095}out(c, GetEndpointRequest);
                                                {1096}in(c, (=GetEndpointResponse,=pkSess_1547,=Sign,SP_1548: bitstring,UP_1549: bitstring));
                                                {1097}new Nc_1550: bitstring;
                                                {1098}let gNc_1551: bitstring = exp(g,Nc_1550) in
                                                {1099}let m1_1552: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1551) in
                                                {1100}out(c, (pkCli_1176,m1_1552,sign(h(m1_1552),skCli_1175)));
                                                {1101}in(c, (em2_1553: bitstring,sigM2_1554: bitstring));
                                                {1102}let m2_1555: bitstring = em2_1553 in
                                                {1103}if (verify(h(m2_1555),sigM2_1554,pkSess_1547) <> true) then
                                                    0
                                                else
                                                    {1104}let (=OpenSecureChannelResponse,PartS_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                                    {1105}let Kcli_1559: bitstring = exp(PartS_1556,Nc_1550) in
                                                    {1106}out(c, senc(mCli(pkCli_1176,pkSess_1547),Kcli_1559))
                                    )
                                    else
                                        {1107}let pkDisco_1560: bitstring = fail-any in
                                        {1108}let v_1561: bool = (Sess = A) in
                                        (
                                            {1109}if v_1561 then
                                            (
                                                {1110}let pkSess_1562: bitstring = pub(skA) in
                                                {1111}out(c, GetEndpointRequest);
                                                {1112}in(c, (=GetEndpointResponse,=pkSess_1562,=Sign,SP_1563: bitstring,UP_1564: bitstring));
                                                {1113}new Nc_1565: bitstring;
                                                {1114}let gNc_1566: bitstring = exp(g,Nc_1565) in
                                                {1115}let m1_1567: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1566) in
                                                {1116}out(c, (pkCli_1176,m1_1567,sign(h(m1_1567),skCli_1175)));
                                                {1117}in(c, (em2_1568: bitstring,sigM2_1569: bitstring));
                                                {1118}let m2_1570: bitstring = em2_1568 in
                                                {1119}if (verify(h(m2_1570),sigM2_1569,pkSess_1562) <> true) then
                                                    0
                                                else
                                                    {1120}let (=OpenSecureChannelResponse,PartS_1571: bitstring,ST_1572: bitstring,TTL_1573: bitstring) = m2_1570 in
                                                    {1121}let Kcli_1574: bitstring = exp(PartS_1571,Nc_1565) in
                                                    {1122}out(c, senc(mCli(pkCli_1176,pkSess_1562),Kcli_1574))
                                            )
                                            else
                                                {1123}let v_1575: bool = (Sess = B) in
                                                (
                                                    {1124}if v_1575 then
                                                    (
                                                        {1125}let pkSess_1576: bitstring = pub(skB) in
                                                        {1126}out(c, GetEndpointRequest);
                                                        {1127}in(c, (=GetEndpointResponse,=pkSess_1576,=Sign,SP_1577: bitstring,UP_1578: bitstring));
                                                        {1128}new Nc_1579: bitstring;
                                                        {1129}let gNc_1580: bitstring = exp(g,Nc_1579) in
                                                        {1130}let m1_1581: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1580) in
                                                        {1131}out(c, (pkCli_1176,m1_1581,sign(h(m1_1581),skCli_1175)));
                                                        {1132}in(c, (em2_1582: bitstring,sigM2_1583: bitstring));
                                                        {1133}let m2_1584: bitstring = em2_1582 in
                                                        {1134}if (verify(h(m2_1584),sigM2_1583,pkSess_1576) <> true) then
                                                            0
                                                        else
                                                            {1135}let (=OpenSecureChannelResponse,PartS_1585: bitstring,ST_1586: bitstring,TTL_1587: bitstring) = m2_1584 in
                                                            {1136}let Kcli_1588: bitstring = exp(PartS_1585,Nc_1579) in
                                                            {1137}out(c, senc(mCli(pkCli_1176,pkSess_1576),Kcli_1588))
                                                    )
                                                    else
                                                        {1138}let v_1589: bool = (Sess = C) in
                                                        (
                                                            {1139}if v_1589 then
                                                            (
                                                                {1140}let pkSess_1590: bitstring = pub(skC) in
                                                                {1141}out(c, GetEndpointRequest);
                                                                {1142}in(c, (=GetEndpointResponse,=pkSess_1590,=Sign,SP_1591: bitstring,UP_1592: bitstring));
                                                                {1143}new Nc_1593: bitstring;
                                                                {1144}let gNc_1594: bitstring = exp(g,Nc_1593) in
                                                                {1145}let m1_1595: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1594) in
                                                                {1146}out(c, (pkCli_1176,m1_1595,sign(h(m1_1595),skCli_1175)));
                                                                {1147}in(c, (em2_1596: bitstring,sigM2_1597: bitstring));
                                                                {1148}let m2_1598: bitstring = em2_1596 in
                                                                {1149}if (verify(h(m2_1598),sigM2_1597,pkSess_1590) <> true) then
                                                                    0
                                                                else
                                                                    {1150}let (=OpenSecureChannelResponse,PartS_1599: bitstring,ST_1600: bitstring,TTL_1601: bitstring) = m2_1598 in
                                                                    {1151}let Kcli_1602: bitstring = exp(PartS_1599,Nc_1593) in
                                                                    {1152}out(c, senc(mCli(pkCli_1176,pkSess_1590),Kcli_1602))
                                                            )
                                                            else
                                                                {1153}let pkSess_1603: bitstring = pub(sk(Sess)) in
                                                                {1154}out(c, GetEndpointRequest);
                                                                {1155}in(c, (=GetEndpointResponse,=pkSess_1603,=Sign,SP_1604: bitstring,UP_1605: bitstring));
                                                                {1156}new Nc_1606: bitstring;
                                                                {1157}let gNc_1607: bitstring = exp(g,Nc_1606) in
                                                                {1158}let m1_1608: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1607) in
                                                                {1159}out(c, (pkCli_1176,m1_1608,sign(h(m1_1608),skCli_1175)));
                                                                {1160}in(c, (em2_1609: bitstring,sigM2_1610: bitstring));
                                                                {1161}let m2_1611: bitstring = em2_1609 in
                                                                {1162}if (verify(h(m2_1611),sigM2_1610,pkSess_1603) <> true) then
                                                                    0
                                                                else
                                                                    {1163}let (=OpenSecureChannelResponse,PartS_1612: bitstring,ST_1613: bitstring,TTL_1614: bitstring) = m2_1611 in
                                                                    {1164}let Kcli_1615: bitstring = exp(PartS_1612,Nc_1606) in
                                                                    {1165}out(c, senc(mCli(pkCli_1176,pkSess_1603),Kcli_1615))
                                                        )
                                                        else
                                                            {1166}let pkSess_1616: bitstring = fail-any in
                                                            {1167}out(c, GetEndpointRequest);
                                                            {1168}in(c, (=GetEndpointResponse,=pkSess_1616,=Sign,SP_1617: bitstring,UP_1618: bitstring));
                                                            {1169}new Nc_1619: bitstring;
                                                            {1170}let gNc_1620: bitstring = exp(g,Nc_1619) in
                                                            {1171}let m1_1621: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1620) in
                                                            {1172}out(c, (pkCli_1176,m1_1621,sign(h(m1_1621),skCli_1175)));
                                                            {1173}in(c, (em2_1622: bitstring,sigM2_1623: bitstring));
                                                            {1174}let m2_1624: bitstring = em2_1622 in
                                                            {1175}if (verify(h(m2_1624),sigM2_1623,pkSess_1616) <> true) then
                                                                0
                                                            else
                                                                {1176}let (=OpenSecureChannelResponse,PartS_1625: bitstring,ST_1626: bitstring,TTL_1627: bitstring) = m2_1624 in
                                                                {1177}let Kcli_1628: bitstring = exp(PartS_1625,Nc_1619) in
                                                                {1178}out(c, senc(mCli(pkCli_1176,pkSess_1616),Kcli_1628))
                                                )
                                                else
                                                    {1179}let pkSess_1629: bitstring = fail-any in
                                                    {1180}out(c, GetEndpointRequest);
                                                    {1181}in(c, (=GetEndpointResponse,=pkSess_1629,=Sign,SP_1630: bitstring,UP_1631: bitstring));
                                                    {1182}new Nc_1632: bitstring;
                                                    {1183}let gNc_1633: bitstring = exp(g,Nc_1632) in
                                                    {1184}let m1_1634: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1633) in
                                                    {1185}out(c, (pkCli_1176,m1_1634,sign(h(m1_1634),skCli_1175)));
                                                    {1186}in(c, (em2_1635: bitstring,sigM2_1636: bitstring));
                                                    {1187}let m2_1637: bitstring = em2_1635 in
                                                    {1188}if (verify(h(m2_1637),sigM2_1636,pkSess_1629) <> true) then
                                                        0
                                                    else
                                                        {1189}let (=OpenSecureChannelResponse,PartS_1638: bitstring,ST_1639: bitstring,TTL_1640: bitstring) = m2_1637 in
                                                        {1190}let Kcli_1641: bitstring = exp(PartS_1638,Nc_1632) in
                                                        {1191}out(c, senc(mCli(pkCli_1176,pkSess_1629),Kcli_1641))
                                        )
                                        else
                                            {1192}let pkSess_1642: bitstring = fail-any in
                                            {1193}out(c, GetEndpointRequest);
                                            {1194}in(c, (=GetEndpointResponse,=pkSess_1642,=Sign,SP_1643: bitstring,UP_1644: bitstring));
                                            {1195}new Nc_1645: bitstring;
                                            {1196}let gNc_1646: bitstring = exp(g,Nc_1645) in
                                            {1197}let m1_1647: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1646) in
                                            {1198}out(c, (pkCli_1176,m1_1647,sign(h(m1_1647),skCli_1175)));
                                            {1199}in(c, (em2_1648: bitstring,sigM2_1649: bitstring));
                                            {1200}let m2_1650: bitstring = em2_1648 in
                                            {1201}if (verify(h(m2_1650),sigM2_1649,pkSess_1642) <> true) then
                                                0
                                            else
                                                {1202}let (=OpenSecureChannelResponse,PartS_1651: bitstring,ST_1652: bitstring,TTL_1653: bitstring) = m2_1650 in
                                                {1203}let Kcli_1654: bitstring = exp(PartS_1651,Nc_1645) in
                                                {1204}out(c, senc(mCli(pkCli_1176,pkSess_1642),Kcli_1654))
                            )
                            else
                                {1205}let pkDisco_1655: bitstring = fail-any in
                                {1206}let v_1656: bool = (Sess = A) in
                                (
                                    {1207}if v_1656 then
                                    (
                                        {1208}let pkSess_1657: bitstring = pub(skA) in
                                        {1209}out(c, GetEndpointRequest);
                                        {1210}in(c, (=GetEndpointResponse,=pkSess_1657,=Sign,SP_1658: bitstring,UP_1659: bitstring));
                                        {1211}new Nc_1660: bitstring;
                                        {1212}let gNc_1661: bitstring = exp(g,Nc_1660) in
                                        {1213}let m1_1662: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1661) in
                                        {1214}out(c, (pkCli_1176,m1_1662,sign(h(m1_1662),skCli_1175)));
                                        {1215}in(c, (em2_1663: bitstring,sigM2_1664: bitstring));
                                        {1216}let m2_1665: bitstring = em2_1663 in
                                        {1217}if (verify(h(m2_1665),sigM2_1664,pkSess_1657) <> true) then
                                            0
                                        else
                                            {1218}let (=OpenSecureChannelResponse,PartS_1666: bitstring,ST_1667: bitstring,TTL_1668: bitstring) = m2_1665 in
                                            {1219}let Kcli_1669: bitstring = exp(PartS_1666,Nc_1660) in
                                            {1220}out(c, senc(mCli(pkCli_1176,pkSess_1657),Kcli_1669))
                                    )
                                    else
                                        {1221}let v_1670: bool = (Sess = B) in
                                        (
                                            {1222}if v_1670 then
                                            (
                                                {1223}let pkSess_1671: bitstring = pub(skB) in
                                                {1224}out(c, GetEndpointRequest);
                                                {1225}in(c, (=GetEndpointResponse,=pkSess_1671,=Sign,SP_1672: bitstring,UP_1673: bitstring));
                                                {1226}new Nc_1674: bitstring;
                                                {1227}let gNc_1675: bitstring = exp(g,Nc_1674) in
                                                {1228}let m1_1676: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1675) in
                                                {1229}out(c, (pkCli_1176,m1_1676,sign(h(m1_1676),skCli_1175)));
                                                {1230}in(c, (em2_1677: bitstring,sigM2_1678: bitstring));
                                                {1231}let m2_1679: bitstring = em2_1677 in
                                                {1232}if (verify(h(m2_1679),sigM2_1678,pkSess_1671) <> true) then
                                                    0
                                                else
                                                    {1233}let (=OpenSecureChannelResponse,PartS_1680: bitstring,ST_1681: bitstring,TTL_1682: bitstring) = m2_1679 in
                                                    {1234}let Kcli_1683: bitstring = exp(PartS_1680,Nc_1674) in
                                                    {1235}out(c, senc(mCli(pkCli_1176,pkSess_1671),Kcli_1683))
                                            )
                                            else
                                                {1236}let v_1684: bool = (Sess = C) in
                                                (
                                                    {1237}if v_1684 then
                                                    (
                                                        {1238}let pkSess_1685: bitstring = pub(skC) in
                                                        {1239}out(c, GetEndpointRequest);
                                                        {1240}in(c, (=GetEndpointResponse,=pkSess_1685,=Sign,SP_1686: bitstring,UP_1687: bitstring));
                                                        {1241}new Nc_1688: bitstring;
                                                        {1242}let gNc_1689: bitstring = exp(g,Nc_1688) in
                                                        {1243}let m1_1690: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1689) in
                                                        {1244}out(c, (pkCli_1176,m1_1690,sign(h(m1_1690),skCli_1175)));
                                                        {1245}in(c, (em2_1691: bitstring,sigM2_1692: bitstring));
                                                        {1246}let m2_1693: bitstring = em2_1691 in
                                                        {1247}if (verify(h(m2_1693),sigM2_1692,pkSess_1685) <> true) then
                                                            0
                                                        else
                                                            {1248}let (=OpenSecureChannelResponse,PartS_1694: bitstring,ST_1695: bitstring,TTL_1696: bitstring) = m2_1693 in
                                                            {1249}let Kcli_1697: bitstring = exp(PartS_1694,Nc_1688) in
                                                            {1250}out(c, senc(mCli(pkCli_1176,pkSess_1685),Kcli_1697))
                                                    )
                                                    else
                                                        {1251}let pkSess_1698: bitstring = pub(sk(Sess)) in
                                                        {1252}out(c, GetEndpointRequest);
                                                        {1253}in(c, (=GetEndpointResponse,=pkSess_1698,=Sign,SP_1699: bitstring,UP_1700: bitstring));
                                                        {1254}new Nc_1701: bitstring;
                                                        {1255}let gNc_1702: bitstring = exp(g,Nc_1701) in
                                                        {1256}let m1_1703: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1702) in
                                                        {1257}out(c, (pkCli_1176,m1_1703,sign(h(m1_1703),skCli_1175)));
                                                        {1258}in(c, (em2_1704: bitstring,sigM2_1705: bitstring));
                                                        {1259}let m2_1706: bitstring = em2_1704 in
                                                        {1260}if (verify(h(m2_1706),sigM2_1705,pkSess_1698) <> true) then
                                                            0
                                                        else
                                                            {1261}let (=OpenSecureChannelResponse,PartS_1707: bitstring,ST_1708: bitstring,TTL_1709: bitstring) = m2_1706 in
                                                            {1262}let Kcli_1710: bitstring = exp(PartS_1707,Nc_1701) in
                                                            {1263}out(c, senc(mCli(pkCli_1176,pkSess_1698),Kcli_1710))
                                                )
                                                else
                                                    {1264}let pkSess_1711: bitstring = fail-any in
                                                    {1265}out(c, GetEndpointRequest);
                                                    {1266}in(c, (=GetEndpointResponse,=pkSess_1711,=Sign,SP_1712: bitstring,UP_1713: bitstring));
                                                    {1267}new Nc_1714: bitstring;
                                                    {1268}let gNc_1715: bitstring = exp(g,Nc_1714) in
                                                    {1269}let m1_1716: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1715) in
                                                    {1270}out(c, (pkCli_1176,m1_1716,sign(h(m1_1716),skCli_1175)));
                                                    {1271}in(c, (em2_1717: bitstring,sigM2_1718: bitstring));
                                                    {1272}let m2_1719: bitstring = em2_1717 in
                                                    {1273}if (verify(h(m2_1719),sigM2_1718,pkSess_1711) <> true) then
                                                        0
                                                    else
                                                        {1274}let (=OpenSecureChannelResponse,PartS_1720: bitstring,ST_1721: bitstring,TTL_1722: bitstring) = m2_1719 in
                                                        {1275}let Kcli_1723: bitstring = exp(PartS_1720,Nc_1714) in
                                                        {1276}out(c, senc(mCli(pkCli_1176,pkSess_1711),Kcli_1723))
                                        )
                                        else
                                            {1277}let pkSess_1724: bitstring = fail-any in
                                            {1278}out(c, GetEndpointRequest);
                                            {1279}in(c, (=GetEndpointResponse,=pkSess_1724,=Sign,SP_1725: bitstring,UP_1726: bitstring));
                                            {1280}new Nc_1727: bitstring;
                                            {1281}let gNc_1728: bitstring = exp(g,Nc_1727) in
                                            {1282}let m1_1729: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1728) in
                                            {1283}out(c, (pkCli_1176,m1_1729,sign(h(m1_1729),skCli_1175)));
                                            {1284}in(c, (em2_1730: bitstring,sigM2_1731: bitstring));
                                            {1285}let m2_1732: bitstring = em2_1730 in
                                            {1286}if (verify(h(m2_1732),sigM2_1731,pkSess_1724) <> true) then
                                                0
                                            else
                                                {1287}let (=OpenSecureChannelResponse,PartS_1733: bitstring,ST_1734: bitstring,TTL_1735: bitstring) = m2_1732 in
                                                {1288}let Kcli_1736: bitstring = exp(PartS_1733,Nc_1727) in
                                                {1289}out(c, senc(mCli(pkCli_1176,pkSess_1724),Kcli_1736))
                                )
                                else
                                    {1290}let pkSess_1737: bitstring = fail-any in
                                    {1291}out(c, GetEndpointRequest);
                                    {1292}in(c, (=GetEndpointResponse,=pkSess_1737,=Sign,SP_1738: bitstring,UP_1739: bitstring));
                                    {1293}new Nc_1740: bitstring;
                                    {1294}let gNc_1741: bitstring = exp(g,Nc_1740) in
                                    {1295}let m1_1742: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1741) in
                                    {1296}out(c, (pkCli_1176,m1_1742,sign(h(m1_1742),skCli_1175)));
                                    {1297}in(c, (em2_1743: bitstring,sigM2_1744: bitstring));
                                    {1298}let m2_1745: bitstring = em2_1743 in
                                    {1299}if (verify(h(m2_1745),sigM2_1744,pkSess_1737) <> true) then
                                        0
                                    else
                                        {1300}let (=OpenSecureChannelResponse,PartS_1746: bitstring,ST_1747: bitstring,TTL_1748: bitstring) = m2_1745 in
                                        {1301}let Kcli_1749: bitstring = exp(PartS_1746,Nc_1740) in
                                        {1302}out(c, senc(mCli(pkCli_1176,pkSess_1737),Kcli_1749))
                    )
                    else
                        {1303}let pkDisco_1750: bitstring = fail-any in
                        {1304}let v_1751: bool = (Sess = A) in
                        (
                            {1305}if v_1751 then
                            (
                                {1306}let pkSess_1752: bitstring = pub(skA) in
                                {1307}out(c, GetEndpointRequest);
                                {1308}in(c, (=GetEndpointResponse,=pkSess_1752,=Sign,SP_1753: bitstring,UP_1754: bitstring));
                                {1309}new Nc_1755: bitstring;
                                {1310}let gNc_1756: bitstring = exp(g,Nc_1755) in
                                {1311}let m1_1757: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1756) in
                                {1312}out(c, (pkCli_1176,m1_1757,sign(h(m1_1757),skCli_1175)));
                                {1313}in(c, (em2_1758: bitstring,sigM2_1759: bitstring));
                                {1314}let m2_1760: bitstring = em2_1758 in
                                {1315}if (verify(h(m2_1760),sigM2_1759,pkSess_1752) <> true) then
                                    0
                                else
                                    {1316}let (=OpenSecureChannelResponse,PartS_1761: bitstring,ST_1762: bitstring,TTL_1763: bitstring) = m2_1760 in
                                    {1317}let Kcli_1764: bitstring = exp(PartS_1761,Nc_1755) in
                                    {1318}out(c, senc(mCli(pkCli_1176,pkSess_1752),Kcli_1764))
                            )
                            else
                                {1319}let v_1765: bool = (Sess = B) in
                                (
                                    {1320}if v_1765 then
                                    (
                                        {1321}let pkSess_1766: bitstring = pub(skB) in
                                        {1322}out(c, GetEndpointRequest);
                                        {1323}in(c, (=GetEndpointResponse,=pkSess_1766,=Sign,SP_1767: bitstring,UP_1768: bitstring));
                                        {1324}new Nc_1769: bitstring;
                                        {1325}let gNc_1770: bitstring = exp(g,Nc_1769) in
                                        {1326}let m1_1771: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1770) in
                                        {1327}out(c, (pkCli_1176,m1_1771,sign(h(m1_1771),skCli_1175)));
                                        {1328}in(c, (em2_1772: bitstring,sigM2_1773: bitstring));
                                        {1329}let m2_1774: bitstring = em2_1772 in
                                        {1330}if (verify(h(m2_1774),sigM2_1773,pkSess_1766) <> true) then
                                            0
                                        else
                                            {1331}let (=OpenSecureChannelResponse,PartS_1775: bitstring,ST_1776: bitstring,TTL_1777: bitstring) = m2_1774 in
                                            {1332}let Kcli_1778: bitstring = exp(PartS_1775,Nc_1769) in
                                            {1333}out(c, senc(mCli(pkCli_1176,pkSess_1766),Kcli_1778))
                                    )
                                    else
                                        {1334}let v_1779: bool = (Sess = C) in
                                        (
                                            {1335}if v_1779 then
                                            (
                                                {1336}let pkSess_1780: bitstring = pub(skC) in
                                                {1337}out(c, GetEndpointRequest);
                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1780,=Sign,SP_1781: bitstring,UP_1782: bitstring));
                                                {1339}new Nc_1783: bitstring;
                                                {1340}let gNc_1784: bitstring = exp(g,Nc_1783) in
                                                {1341}let m1_1785: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1784) in
                                                {1342}out(c, (pkCli_1176,m1_1785,sign(h(m1_1785),skCli_1175)));
                                                {1343}in(c, (em2_1786: bitstring,sigM2_1787: bitstring));
                                                {1344}let m2_1788: bitstring = em2_1786 in
                                                {1345}if (verify(h(m2_1788),sigM2_1787,pkSess_1780) <> true) then
                                                    0
                                                else
                                                    {1346}let (=OpenSecureChannelResponse,PartS_1789: bitstring,ST_1790: bitstring,TTL_1791: bitstring) = m2_1788 in
                                                    {1347}let Kcli_1792: bitstring = exp(PartS_1789,Nc_1783) in
                                                    {1348}out(c, senc(mCli(pkCli_1176,pkSess_1780),Kcli_1792))
                                            )
                                            else
                                                {1349}let pkSess_1793: bitstring = pub(sk(Sess)) in
                                                {1350}out(c, GetEndpointRequest);
                                                {1351}in(c, (=GetEndpointResponse,=pkSess_1793,=Sign,SP_1794: bitstring,UP_1795: bitstring));
                                                {1352}new Nc_1796: bitstring;
                                                {1353}let gNc_1797: bitstring = exp(g,Nc_1796) in
                                                {1354}let m1_1798: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1797) in
                                                {1355}out(c, (pkCli_1176,m1_1798,sign(h(m1_1798),skCli_1175)));
                                                {1356}in(c, (em2_1799: bitstring,sigM2_1800: bitstring));
                                                {1357}let m2_1801: bitstring = em2_1799 in
                                                {1358}if (verify(h(m2_1801),sigM2_1800,pkSess_1793) <> true) then
                                                    0
                                                else
                                                    {1359}let (=OpenSecureChannelResponse,PartS_1802: bitstring,ST_1803: bitstring,TTL_1804: bitstring) = m2_1801 in
                                                    {1360}let Kcli_1805: bitstring = exp(PartS_1802,Nc_1796) in
                                                    {1361}out(c, senc(mCli(pkCli_1176,pkSess_1793),Kcli_1805))
                                        )
                                        else
                                            {1362}let pkSess_1806: bitstring = fail-any in
                                            {1363}out(c, GetEndpointRequest);
                                            {1364}in(c, (=GetEndpointResponse,=pkSess_1806,=Sign,SP_1807: bitstring,UP_1808: bitstring));
                                            {1365}new Nc_1809: bitstring;
                                            {1366}let gNc_1810: bitstring = exp(g,Nc_1809) in
                                            {1367}let m1_1811: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1810) in
                                            {1368}out(c, (pkCli_1176,m1_1811,sign(h(m1_1811),skCli_1175)));
                                            {1369}in(c, (em2_1812: bitstring,sigM2_1813: bitstring));
                                            {1370}let m2_1814: bitstring = em2_1812 in
                                            {1371}if (verify(h(m2_1814),sigM2_1813,pkSess_1806) <> true) then
                                                0
                                            else
                                                {1372}let (=OpenSecureChannelResponse,PartS_1815: bitstring,ST_1816: bitstring,TTL_1817: bitstring) = m2_1814 in
                                                {1373}let Kcli_1818: bitstring = exp(PartS_1815,Nc_1809) in
                                                {1374}out(c, senc(mCli(pkCli_1176,pkSess_1806),Kcli_1818))
                                )
                                else
                                    {1375}let pkSess_1819: bitstring = fail-any in
                                    {1376}out(c, GetEndpointRequest);
                                    {1377}in(c, (=GetEndpointResponse,=pkSess_1819,=Sign,SP_1820: bitstring,UP_1821: bitstring));
                                    {1378}new Nc_1822: bitstring;
                                    {1379}let gNc_1823: bitstring = exp(g,Nc_1822) in
                                    {1380}let m1_1824: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1823) in
                                    {1381}out(c, (pkCli_1176,m1_1824,sign(h(m1_1824),skCli_1175)));
                                    {1382}in(c, (em2_1825: bitstring,sigM2_1826: bitstring));
                                    {1383}let m2_1827: bitstring = em2_1825 in
                                    {1384}if (verify(h(m2_1827),sigM2_1826,pkSess_1819) <> true) then
                                        0
                                    else
                                        {1385}let (=OpenSecureChannelResponse,PartS_1828: bitstring,ST_1829: bitstring,TTL_1830: bitstring) = m2_1827 in
                                        {1386}let Kcli_1831: bitstring = exp(PartS_1828,Nc_1822) in
                                        {1387}out(c, senc(mCli(pkCli_1176,pkSess_1819),Kcli_1831))
                        )
                        else
                            {1388}let pkSess_1832: bitstring = fail-any in
                            {1389}out(c, GetEndpointRequest);
                            {1390}in(c, (=GetEndpointResponse,=pkSess_1832,=Sign,SP_1833: bitstring,UP_1834: bitstring));
                            {1391}new Nc_1835: bitstring;
                            {1392}let gNc_1836: bitstring = exp(g,Nc_1835) in
                            {1393}let m1_1837: bitstring = (OpenSecureChannelRequest,pkCli_1176,gNc_1836) in
                            {1394}out(c, (pkCli_1176,m1_1837,sign(h(m1_1837),skCli_1175)));
                            {1395}in(c, (em2_1838: bitstring,sigM2_1839: bitstring));
                            {1396}let m2_1840: bitstring = em2_1838 in
                            {1397}if (verify(h(m2_1840),sigM2_1839,pkSess_1832) <> true) then
                                0
                            else
                                {1398}let (=OpenSecureChannelResponse,PartS_1841: bitstring,ST_1842: bitstring,TTL_1843: bitstring) = m2_1840 in
                                {1399}let Kcli_1844: bitstring = exp(PartS_1841,Nc_1835) in
                                {1400}out(c, senc(mCli(pkCli_1176,pkSess_1832),Kcli_1844))
                )
                else
                    {1401}let =true = (Cli = C) in
                    (
                        {1402}let skCli_1845: bitstring = skC in
                        {1403}let pkCli_1846: bitstring = pub(skCli_1845) in
                        {1404}let v_1847: bool = (Disco = A) in
                        (
                            {1405}if v_1847 then
                            (
                                {1406}let pkDisco_1848: bitstring = pub(skA) in
                                {1407}let v_1849: bool = (Sess = A) in
                                (
                                    {1408}if v_1849 then
                                    (
                                        {1409}let pkSess_1850: bitstring = pub(skA) in
                                        {1410}out(c, GetEndpointRequest);
                                        {1411}in(c, (=GetEndpointResponse,=pkSess_1850,=Sign,SP_1851: bitstring,UP_1852: bitstring));
                                        {1412}new Nc_1853: bitstring;
                                        {1413}let gNc_1854: bitstring = exp(g,Nc_1853) in
                                        {1414}let m1_1855: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1854) in
                                        {1415}out(c, (pkCli_1846,m1_1855,sign(h(m1_1855),skCli_1845)));
                                        {1416}in(c, (em2_1856: bitstring,sigM2_1857: bitstring));
                                        {1417}let m2_1858: bitstring = em2_1856 in
                                        {1418}if (verify(h(m2_1858),sigM2_1857,pkSess_1850) <> true) then
                                            0
                                        else
                                            {1419}let (=OpenSecureChannelResponse,PartS_1859: bitstring,ST_1860: bitstring,TTL_1861: bitstring) = m2_1858 in
                                            {1420}let Kcli_1862: bitstring = exp(PartS_1859,Nc_1853) in
                                            {1421}out(c, senc(mCli(pkCli_1846,pkSess_1850),Kcli_1862))
                                    )
                                    else
                                        {1422}let v_1863: bool = (Sess = B) in
                                        (
                                            {1423}if v_1863 then
                                            (
                                                {1424}let pkSess_1864: bitstring = pub(skB) in
                                                {1425}out(c, GetEndpointRequest);
                                                {1426}in(c, (=GetEndpointResponse,=pkSess_1864,=Sign,SP_1865: bitstring,UP_1866: bitstring));
                                                {1427}new Nc_1867: bitstring;
                                                {1428}let gNc_1868: bitstring = exp(g,Nc_1867) in
                                                {1429}let m1_1869: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1868) in
                                                {1430}out(c, (pkCli_1846,m1_1869,sign(h(m1_1869),skCli_1845)));
                                                {1431}in(c, (em2_1870: bitstring,sigM2_1871: bitstring));
                                                {1432}let m2_1872: bitstring = em2_1870 in
                                                {1433}if (verify(h(m2_1872),sigM2_1871,pkSess_1864) <> true) then
                                                    0
                                                else
                                                    {1434}let (=OpenSecureChannelResponse,PartS_1873: bitstring,ST_1874: bitstring,TTL_1875: bitstring) = m2_1872 in
                                                    {1435}let Kcli_1876: bitstring = exp(PartS_1873,Nc_1867) in
                                                    {1436}out(c, senc(mCli(pkCli_1846,pkSess_1864),Kcli_1876))
                                            )
                                            else
                                                {1437}let v_1877: bool = (Sess = C) in
                                                (
                                                    {1438}if v_1877 then
                                                    (
                                                        {1439}let pkSess_1878: bitstring = pub(skC) in
                                                        {1440}out(c, GetEndpointRequest);
                                                        {1441}in(c, (=GetEndpointResponse,=pkSess_1878,=Sign,SP_1879: bitstring,UP_1880: bitstring));
                                                        {1442}new Nc_1881: bitstring;
                                                        {1443}let gNc_1882: bitstring = exp(g,Nc_1881) in
                                                        {1444}let m1_1883: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1882) in
                                                        {1445}out(c, (pkCli_1846,m1_1883,sign(h(m1_1883),skCli_1845)));
                                                        {1446}in(c, (em2_1884: bitstring,sigM2_1885: bitstring));
                                                        {1447}let m2_1886: bitstring = em2_1884 in
                                                        {1448}if (verify(h(m2_1886),sigM2_1885,pkSess_1878) <> true) then
                                                            0
                                                        else
                                                            {1449}let (=OpenSecureChannelResponse,PartS_1887: bitstring,ST_1888: bitstring,TTL_1889: bitstring) = m2_1886 in
                                                            {1450}let Kcli_1890: bitstring = exp(PartS_1887,Nc_1881) in
                                                            {1451}out(c, senc(mCli(pkCli_1846,pkSess_1878),Kcli_1890))
                                                    )
                                                    else
                                                        {1452}let pkSess_1891: bitstring = pub(sk(Sess)) in
                                                        {1453}out(c, GetEndpointRequest);
                                                        {1454}in(c, (=GetEndpointResponse,=pkSess_1891,=Sign,SP_1892: bitstring,UP_1893: bitstring));
                                                        {1455}new Nc_1894: bitstring;
                                                        {1456}let gNc_1895: bitstring = exp(g,Nc_1894) in
                                                        {1457}let m1_1896: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1895) in
                                                        {1458}out(c, (pkCli_1846,m1_1896,sign(h(m1_1896),skCli_1845)));
                                                        {1459}in(c, (em2_1897: bitstring,sigM2_1898: bitstring));
                                                        {1460}let m2_1899: bitstring = em2_1897 in
                                                        {1461}if (verify(h(m2_1899),sigM2_1898,pkSess_1891) <> true) then
                                                            0
                                                        else
                                                            {1462}let (=OpenSecureChannelResponse,PartS_1900: bitstring,ST_1901: bitstring,TTL_1902: bitstring) = m2_1899 in
                                                            {1463}let Kcli_1903: bitstring = exp(PartS_1900,Nc_1894) in
                                                            {1464}out(c, senc(mCli(pkCli_1846,pkSess_1891),Kcli_1903))
                                                )
                                                else
                                                    {1465}let pkSess_1904: bitstring = fail-any in
                                                    {1466}out(c, GetEndpointRequest);
                                                    {1467}in(c, (=GetEndpointResponse,=pkSess_1904,=Sign,SP_1905: bitstring,UP_1906: bitstring));
                                                    {1468}new Nc_1907: bitstring;
                                                    {1469}let gNc_1908: bitstring = exp(g,Nc_1907) in
                                                    {1470}let m1_1909: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1908) in
                                                    {1471}out(c, (pkCli_1846,m1_1909,sign(h(m1_1909),skCli_1845)));
                                                    {1472}in(c, (em2_1910: bitstring,sigM2_1911: bitstring));
                                                    {1473}let m2_1912: bitstring = em2_1910 in
                                                    {1474}if (verify(h(m2_1912),sigM2_1911,pkSess_1904) <> true) then
                                                        0
                                                    else
                                                        {1475}let (=OpenSecureChannelResponse,PartS_1913: bitstring,ST_1914: bitstring,TTL_1915: bitstring) = m2_1912 in
                                                        {1476}let Kcli_1916: bitstring = exp(PartS_1913,Nc_1907) in
                                                        {1477}out(c, senc(mCli(pkCli_1846,pkSess_1904),Kcli_1916))
                                        )
                                        else
                                            {1478}let pkSess_1917: bitstring = fail-any in
                                            {1479}out(c, GetEndpointRequest);
                                            {1480}in(c, (=GetEndpointResponse,=pkSess_1917,=Sign,SP_1918: bitstring,UP_1919: bitstring));
                                            {1481}new Nc_1920: bitstring;
                                            {1482}let gNc_1921: bitstring = exp(g,Nc_1920) in
                                            {1483}let m1_1922: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1921) in
                                            {1484}out(c, (pkCli_1846,m1_1922,sign(h(m1_1922),skCli_1845)));
                                            {1485}in(c, (em2_1923: bitstring,sigM2_1924: bitstring));
                                            {1486}let m2_1925: bitstring = em2_1923 in
                                            {1487}if (verify(h(m2_1925),sigM2_1924,pkSess_1917) <> true) then
                                                0
                                            else
                                                {1488}let (=OpenSecureChannelResponse,PartS_1926: bitstring,ST_1927: bitstring,TTL_1928: bitstring) = m2_1925 in
                                                {1489}let Kcli_1929: bitstring = exp(PartS_1926,Nc_1920) in
                                                {1490}out(c, senc(mCli(pkCli_1846,pkSess_1917),Kcli_1929))
                                )
                                else
                                    {1491}let pkSess_1930: bitstring = fail-any in
                                    {1492}out(c, GetEndpointRequest);
                                    {1493}in(c, (=GetEndpointResponse,=pkSess_1930,=Sign,SP_1931: bitstring,UP_1932: bitstring));
                                    {1494}new Nc_1933: bitstring;
                                    {1495}let gNc_1934: bitstring = exp(g,Nc_1933) in
                                    {1496}let m1_1935: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1934) in
                                    {1497}out(c, (pkCli_1846,m1_1935,sign(h(m1_1935),skCli_1845)));
                                    {1498}in(c, (em2_1936: bitstring,sigM2_1937: bitstring));
                                    {1499}let m2_1938: bitstring = em2_1936 in
                                    {1500}if (verify(h(m2_1938),sigM2_1937,pkSess_1930) <> true) then
                                        0
                                    else
                                        {1501}let (=OpenSecureChannelResponse,PartS_1939: bitstring,ST_1940: bitstring,TTL_1941: bitstring) = m2_1938 in
                                        {1502}let Kcli_1942: bitstring = exp(PartS_1939,Nc_1933) in
                                        {1503}out(c, senc(mCli(pkCli_1846,pkSess_1930),Kcli_1942))
                            )
                            else
                                {1504}let v_1943: bool = (Disco = B) in
                                (
                                    {1505}if v_1943 then
                                    (
                                        {1506}let pkDisco_1944: bitstring = pub(skB) in
                                        {1507}let v_1945: bool = (Sess = A) in
                                        (
                                            {1508}if v_1945 then
                                            (
                                                {1509}let pkSess_1946: bitstring = pub(skA) in
                                                {1510}out(c, GetEndpointRequest);
                                                {1511}in(c, (=GetEndpointResponse,=pkSess_1946,=Sign,SP_1947: bitstring,UP_1948: bitstring));
                                                {1512}new Nc_1949: bitstring;
                                                {1513}let gNc_1950: bitstring = exp(g,Nc_1949) in
                                                {1514}let m1_1951: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1950) in
                                                {1515}out(c, (pkCli_1846,m1_1951,sign(h(m1_1951),skCli_1845)));
                                                {1516}in(c, (em2_1952: bitstring,sigM2_1953: bitstring));
                                                {1517}let m2_1954: bitstring = em2_1952 in
                                                {1518}if (verify(h(m2_1954),sigM2_1953,pkSess_1946) <> true) then
                                                    0
                                                else
                                                    {1519}let (=OpenSecureChannelResponse,PartS_1955: bitstring,ST_1956: bitstring,TTL_1957: bitstring) = m2_1954 in
                                                    {1520}let Kcli_1958: bitstring = exp(PartS_1955,Nc_1949) in
                                                    {1521}out(c, senc(mCli(pkCli_1846,pkSess_1946),Kcli_1958))
                                            )
                                            else
                                                {1522}let v_1959: bool = (Sess = B) in
                                                (
                                                    {1523}if v_1959 then
                                                    (
                                                        {1524}let pkSess_1960: bitstring = pub(skB) in
                                                        {1525}out(c, GetEndpointRequest);
                                                        {1526}in(c, (=GetEndpointResponse,=pkSess_1960,=Sign,SP_1961: bitstring,UP_1962: bitstring));
                                                        {1527}new Nc_1963: bitstring;
                                                        {1528}let gNc_1964: bitstring = exp(g,Nc_1963) in
                                                        {1529}let m1_1965: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1964) in
                                                        {1530}out(c, (pkCli_1846,m1_1965,sign(h(m1_1965),skCli_1845)));
                                                        {1531}in(c, (em2_1966: bitstring,sigM2_1967: bitstring));
                                                        {1532}let m2_1968: bitstring = em2_1966 in
                                                        {1533}if (verify(h(m2_1968),sigM2_1967,pkSess_1960) <> true) then
                                                            0
                                                        else
                                                            {1534}let (=OpenSecureChannelResponse,PartS_1969: bitstring,ST_1970: bitstring,TTL_1971: bitstring) = m2_1968 in
                                                            {1535}let Kcli_1972: bitstring = exp(PartS_1969,Nc_1963) in
                                                            {1536}out(c, senc(mCli(pkCli_1846,pkSess_1960),Kcli_1972))
                                                    )
                                                    else
                                                        {1537}let v_1973: bool = (Sess = C) in
                                                        (
                                                            {1538}if v_1973 then
                                                            (
                                                                {1539}let pkSess_1974: bitstring = pub(skC) in
                                                                {1540}out(c, GetEndpointRequest);
                                                                {1541}in(c, (=GetEndpointResponse,=pkSess_1974,=Sign,SP_1975: bitstring,UP_1976: bitstring));
                                                                {1542}new Nc_1977: bitstring;
                                                                {1543}let gNc_1978: bitstring = exp(g,Nc_1977) in
                                                                {1544}let m1_1979: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1978) in
                                                                {1545}out(c, (pkCli_1846,m1_1979,sign(h(m1_1979),skCli_1845)));
                                                                {1546}in(c, (em2_1980: bitstring,sigM2_1981: bitstring));
                                                                {1547}let m2_1982: bitstring = em2_1980 in
                                                                {1548}if (verify(h(m2_1982),sigM2_1981,pkSess_1974) <> true) then
                                                                    0
                                                                else
                                                                    {1549}let (=OpenSecureChannelResponse,PartS_1983: bitstring,ST_1984: bitstring,TTL_1985: bitstring) = m2_1982 in
                                                                    {1550}let Kcli_1986: bitstring = exp(PartS_1983,Nc_1977) in
                                                                    {1551}out(c, senc(mCli(pkCli_1846,pkSess_1974),Kcli_1986))
                                                            )
                                                            else
                                                                {1552}let pkSess_1987: bitstring = pub(sk(Sess)) in
                                                                {1553}out(c, GetEndpointRequest);
                                                                {1554}in(c, (=GetEndpointResponse,=pkSess_1987,=Sign,SP_1988: bitstring,UP_1989: bitstring));
                                                                {1555}new Nc_1990: bitstring;
                                                                {1556}let gNc_1991: bitstring = exp(g,Nc_1990) in
                                                                {1557}let m1_1992: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_1991) in
                                                                {1558}out(c, (pkCli_1846,m1_1992,sign(h(m1_1992),skCli_1845)));
                                                                {1559}in(c, (em2_1993: bitstring,sigM2_1994: bitstring));
                                                                {1560}let m2_1995: bitstring = em2_1993 in
                                                                {1561}if (verify(h(m2_1995),sigM2_1994,pkSess_1987) <> true) then
                                                                    0
                                                                else
                                                                    {1562}let (=OpenSecureChannelResponse,PartS_1996: bitstring,ST_1997: bitstring,TTL_1998: bitstring) = m2_1995 in
                                                                    {1563}let Kcli_1999: bitstring = exp(PartS_1996,Nc_1990) in
                                                                    {1564}out(c, senc(mCli(pkCli_1846,pkSess_1987),Kcli_1999))
                                                        )
                                                        else
                                                            {1565}let pkSess_2000: bitstring = fail-any in
                                                            {1566}out(c, GetEndpointRequest);
                                                            {1567}in(c, (=GetEndpointResponse,=pkSess_2000,=Sign,SP_2001: bitstring,UP_2002: bitstring));
                                                            {1568}new Nc_2003: bitstring;
                                                            {1569}let gNc_2004: bitstring = exp(g,Nc_2003) in
                                                            {1570}let m1_2005: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2004) in
                                                            {1571}out(c, (pkCli_1846,m1_2005,sign(h(m1_2005),skCli_1845)));
                                                            {1572}in(c, (em2_2006: bitstring,sigM2_2007: bitstring));
                                                            {1573}let m2_2008: bitstring = em2_2006 in
                                                            {1574}if (verify(h(m2_2008),sigM2_2007,pkSess_2000) <> true) then
                                                                0
                                                            else
                                                                {1575}let (=OpenSecureChannelResponse,PartS_2009: bitstring,ST_2010: bitstring,TTL_2011: bitstring) = m2_2008 in
                                                                {1576}let Kcli_2012: bitstring = exp(PartS_2009,Nc_2003) in
                                                                {1577}out(c, senc(mCli(pkCli_1846,pkSess_2000),Kcli_2012))
                                                )
                                                else
                                                    {1578}let pkSess_2013: bitstring = fail-any in
                                                    {1579}out(c, GetEndpointRequest);
                                                    {1580}in(c, (=GetEndpointResponse,=pkSess_2013,=Sign,SP_2014: bitstring,UP_2015: bitstring));
                                                    {1581}new Nc_2016: bitstring;
                                                    {1582}let gNc_2017: bitstring = exp(g,Nc_2016) in
                                                    {1583}let m1_2018: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2017) in
                                                    {1584}out(c, (pkCli_1846,m1_2018,sign(h(m1_2018),skCli_1845)));
                                                    {1585}in(c, (em2_2019: bitstring,sigM2_2020: bitstring));
                                                    {1586}let m2_2021: bitstring = em2_2019 in
                                                    {1587}if (verify(h(m2_2021),sigM2_2020,pkSess_2013) <> true) then
                                                        0
                                                    else
                                                        {1588}let (=OpenSecureChannelResponse,PartS_2022: bitstring,ST_2023: bitstring,TTL_2024: bitstring) = m2_2021 in
                                                        {1589}let Kcli_2025: bitstring = exp(PartS_2022,Nc_2016) in
                                                        {1590}out(c, senc(mCli(pkCli_1846,pkSess_2013),Kcli_2025))
                                        )
                                        else
                                            {1591}let pkSess_2026: bitstring = fail-any in
                                            {1592}out(c, GetEndpointRequest);
                                            {1593}in(c, (=GetEndpointResponse,=pkSess_2026,=Sign,SP_2027: bitstring,UP_2028: bitstring));
                                            {1594}new Nc_2029: bitstring;
                                            {1595}let gNc_2030: bitstring = exp(g,Nc_2029) in
                                            {1596}let m1_2031: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2030) in
                                            {1597}out(c, (pkCli_1846,m1_2031,sign(h(m1_2031),skCli_1845)));
                                            {1598}in(c, (em2_2032: bitstring,sigM2_2033: bitstring));
                                            {1599}let m2_2034: bitstring = em2_2032 in
                                            {1600}if (verify(h(m2_2034),sigM2_2033,pkSess_2026) <> true) then
                                                0
                                            else
                                                {1601}let (=OpenSecureChannelResponse,PartS_2035: bitstring,ST_2036: bitstring,TTL_2037: bitstring) = m2_2034 in
                                                {1602}let Kcli_2038: bitstring = exp(PartS_2035,Nc_2029) in
                                                {1603}out(c, senc(mCli(pkCli_1846,pkSess_2026),Kcli_2038))
                                    )
                                    else
                                        {1604}let v_2039: bool = (Disco = C) in
                                        (
                                            {1605}if v_2039 then
                                            (
                                                {1606}let pkDisco_2040: bitstring = pub(skC) in
                                                {1607}let v_2041: bool = (Sess = A) in
                                                (
                                                    {1608}if v_2041 then
                                                    (
                                                        {1609}let pkSess_2042: bitstring = pub(skA) in
                                                        {1610}out(c, GetEndpointRequest);
                                                        {1611}in(c, (=GetEndpointResponse,=pkSess_2042,=Sign,SP_2043: bitstring,UP_2044: bitstring));
                                                        {1612}new Nc_2045: bitstring;
                                                        {1613}let gNc_2046: bitstring = exp(g,Nc_2045) in
                                                        {1614}let m1_2047: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2046) in
                                                        {1615}out(c, (pkCli_1846,m1_2047,sign(h(m1_2047),skCli_1845)));
                                                        {1616}in(c, (em2_2048: bitstring,sigM2_2049: bitstring));
                                                        {1617}let m2_2050: bitstring = em2_2048 in
                                                        {1618}if (verify(h(m2_2050),sigM2_2049,pkSess_2042) <> true) then
                                                            0
                                                        else
                                                            {1619}let (=OpenSecureChannelResponse,PartS_2051: bitstring,ST_2052: bitstring,TTL_2053: bitstring) = m2_2050 in
                                                            {1620}let Kcli_2054: bitstring = exp(PartS_2051,Nc_2045) in
                                                            {1621}out(c, senc(mCli(pkCli_1846,pkSess_2042),Kcli_2054))
                                                    )
                                                    else
                                                        {1622}let v_2055: bool = (Sess = B) in
                                                        (
                                                            {1623}if v_2055 then
                                                            (
                                                                {1624}let pkSess_2056: bitstring = pub(skB) in
                                                                {1625}out(c, GetEndpointRequest);
                                                                {1626}in(c, (=GetEndpointResponse,=pkSess_2056,=Sign,SP_2057: bitstring,UP_2058: bitstring));
                                                                {1627}new Nc_2059: bitstring;
                                                                {1628}let gNc_2060: bitstring = exp(g,Nc_2059) in
                                                                {1629}let m1_2061: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2060) in
                                                                {1630}out(c, (pkCli_1846,m1_2061,sign(h(m1_2061),skCli_1845)));
                                                                {1631}in(c, (em2_2062: bitstring,sigM2_2063: bitstring));
                                                                {1632}let m2_2064: bitstring = em2_2062 in
                                                                {1633}if (verify(h(m2_2064),sigM2_2063,pkSess_2056) <> true) then
                                                                    0
                                                                else
                                                                    {1634}let (=OpenSecureChannelResponse,PartS_2065: bitstring,ST_2066: bitstring,TTL_2067: bitstring) = m2_2064 in
                                                                    {1635}let Kcli_2068: bitstring = exp(PartS_2065,Nc_2059) in
                                                                    {1636}out(c, senc(mCli(pkCli_1846,pkSess_2056),Kcli_2068))
                                                            )
                                                            else
                                                                {1637}let v_2069: bool = (Sess = C) in
                                                                (
                                                                    {1638}if v_2069 then
                                                                    (
                                                                        {1639}let pkSess_2070: bitstring = pub(skC) in
                                                                        {1640}out(c, GetEndpointRequest);
                                                                        {1641}in(c, (=GetEndpointResponse,=pkSess_2070,=Sign,SP_2071: bitstring,UP_2072: bitstring));
                                                                        {1642}new Nc_2073: bitstring;
                                                                        {1643}let gNc_2074: bitstring = exp(g,Nc_2073) in
                                                                        {1644}let m1_2075: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2074) in
                                                                        {1645}out(c, (pkCli_1846,m1_2075,sign(h(m1_2075),skCli_1845)));
                                                                        {1646}in(c, (em2_2076: bitstring,sigM2_2077: bitstring));
                                                                        {1647}let m2_2078: bitstring = em2_2076 in
                                                                        {1648}if (verify(h(m2_2078),sigM2_2077,pkSess_2070) <> true) then
                                                                            0
                                                                        else
                                                                            {1649}let (=OpenSecureChannelResponse,PartS_2079: bitstring,ST_2080: bitstring,TTL_2081: bitstring) = m2_2078 in
                                                                            {1650}let Kcli_2082: bitstring = exp(PartS_2079,Nc_2073) in
                                                                            {1651}out(c, senc(mCli(pkCli_1846,pkSess_2070),Kcli_2082))
                                                                    )
                                                                    else
                                                                        {1652}let pkSess_2083: bitstring = pub(sk(Sess)) in
                                                                        {1653}out(c, GetEndpointRequest);
                                                                        {1654}in(c, (=GetEndpointResponse,=pkSess_2083,=Sign,SP_2084: bitstring,UP_2085: bitstring));
                                                                        {1655}new Nc_2086: bitstring;
                                                                        {1656}let gNc_2087: bitstring = exp(g,Nc_2086) in
                                                                        {1657}let m1_2088: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2087) in
                                                                        {1658}out(c, (pkCli_1846,m1_2088,sign(h(m1_2088),skCli_1845)));
                                                                        {1659}in(c, (em2_2089: bitstring,sigM2_2090: bitstring));
                                                                        {1660}let m2_2091: bitstring = em2_2089 in
                                                                        {1661}if (verify(h(m2_2091),sigM2_2090,pkSess_2083) <> true) then
                                                                            0
                                                                        else
                                                                            {1662}let (=OpenSecureChannelResponse,PartS_2092: bitstring,ST_2093: bitstring,TTL_2094: bitstring) = m2_2091 in
                                                                            {1663}let Kcli_2095: bitstring = exp(PartS_2092,Nc_2086) in
                                                                            {1664}out(c, senc(mCli(pkCli_1846,pkSess_2083),Kcli_2095))
                                                                )
                                                                else
                                                                    {1665}let pkSess_2096: bitstring = fail-any in
                                                                    {1666}out(c, GetEndpointRequest);
                                                                    {1667}in(c, (=GetEndpointResponse,=pkSess_2096,=Sign,SP_2097: bitstring,UP_2098: bitstring));
                                                                    {1668}new Nc_2099: bitstring;
                                                                    {1669}let gNc_2100: bitstring = exp(g,Nc_2099) in
                                                                    {1670}let m1_2101: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2100) in
                                                                    {1671}out(c, (pkCli_1846,m1_2101,sign(h(m1_2101),skCli_1845)));
                                                                    {1672}in(c, (em2_2102: bitstring,sigM2_2103: bitstring));
                                                                    {1673}let m2_2104: bitstring = em2_2102 in
                                                                    {1674}if (verify(h(m2_2104),sigM2_2103,pkSess_2096) <> true) then
                                                                        0
                                                                    else
                                                                        {1675}let (=OpenSecureChannelResponse,PartS_2105: bitstring,ST_2106: bitstring,TTL_2107: bitstring) = m2_2104 in
                                                                        {1676}let Kcli_2108: bitstring = exp(PartS_2105,Nc_2099) in
                                                                        {1677}out(c, senc(mCli(pkCli_1846,pkSess_2096),Kcli_2108))
                                                        )
                                                        else
                                                            {1678}let pkSess_2109: bitstring = fail-any in
                                                            {1679}out(c, GetEndpointRequest);
                                                            {1680}in(c, (=GetEndpointResponse,=pkSess_2109,=Sign,SP_2110: bitstring,UP_2111: bitstring));
                                                            {1681}new Nc_2112: bitstring;
                                                            {1682}let gNc_2113: bitstring = exp(g,Nc_2112) in
                                                            {1683}let m1_2114: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2113) in
                                                            {1684}out(c, (pkCli_1846,m1_2114,sign(h(m1_2114),skCli_1845)));
                                                            {1685}in(c, (em2_2115: bitstring,sigM2_2116: bitstring));
                                                            {1686}let m2_2117: bitstring = em2_2115 in
                                                            {1687}if (verify(h(m2_2117),sigM2_2116,pkSess_2109) <> true) then
                                                                0
                                                            else
                                                                {1688}let (=OpenSecureChannelResponse,PartS_2118: bitstring,ST_2119: bitstring,TTL_2120: bitstring) = m2_2117 in
                                                                {1689}let Kcli_2121: bitstring = exp(PartS_2118,Nc_2112) in
                                                                {1690}out(c, senc(mCli(pkCli_1846,pkSess_2109),Kcli_2121))
                                                )
                                                else
                                                    {1691}let pkSess_2122: bitstring = fail-any in
                                                    {1692}out(c, GetEndpointRequest);
                                                    {1693}in(c, (=GetEndpointResponse,=pkSess_2122,=Sign,SP_2123: bitstring,UP_2124: bitstring));
                                                    {1694}new Nc_2125: bitstring;
                                                    {1695}let gNc_2126: bitstring = exp(g,Nc_2125) in
                                                    {1696}let m1_2127: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2126) in
                                                    {1697}out(c, (pkCli_1846,m1_2127,sign(h(m1_2127),skCli_1845)));
                                                    {1698}in(c, (em2_2128: bitstring,sigM2_2129: bitstring));
                                                    {1699}let m2_2130: bitstring = em2_2128 in
                                                    {1700}if (verify(h(m2_2130),sigM2_2129,pkSess_2122) <> true) then
                                                        0
                                                    else
                                                        {1701}let (=OpenSecureChannelResponse,PartS_2131: bitstring,ST_2132: bitstring,TTL_2133: bitstring) = m2_2130 in
                                                        {1702}let Kcli_2134: bitstring = exp(PartS_2131,Nc_2125) in
                                                        {1703}out(c, senc(mCli(pkCli_1846,pkSess_2122),Kcli_2134))
                                            )
                                            else
                                                {1704}let pkDisco_2135: bitstring = pub(sk(Disco)) in
                                                {1705}let v_2136: bool = (Sess = A) in
                                                (
                                                    {1706}if v_2136 then
                                                    (
                                                        {1707}let pkSess_2137: bitstring = pub(skA) in
                                                        {1708}out(c, GetEndpointRequest);
                                                        {1709}in(c, (=GetEndpointResponse,=pkSess_2137,=Sign,SP_2138: bitstring,UP_2139: bitstring));
                                                        {1710}new Nc_2140: bitstring;
                                                        {1711}let gNc_2141: bitstring = exp(g,Nc_2140) in
                                                        {1712}let m1_2142: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2141) in
                                                        {1713}out(c, (pkCli_1846,m1_2142,sign(h(m1_2142),skCli_1845)));
                                                        {1714}in(c, (em2_2143: bitstring,sigM2_2144: bitstring));
                                                        {1715}let m2_2145: bitstring = em2_2143 in
                                                        {1716}if (verify(h(m2_2145),sigM2_2144,pkSess_2137) <> true) then
                                                            0
                                                        else
                                                            {1717}let (=OpenSecureChannelResponse,PartS_2146: bitstring,ST_2147: bitstring,TTL_2148: bitstring) = m2_2145 in
                                                            {1718}let Kcli_2149: bitstring = exp(PartS_2146,Nc_2140) in
                                                            {1719}out(c, senc(mCli(pkCli_1846,pkSess_2137),Kcli_2149))
                                                    )
                                                    else
                                                        {1720}let v_2150: bool = (Sess = B) in
                                                        (
                                                            {1721}if v_2150 then
                                                            (
                                                                {1722}let pkSess_2151: bitstring = pub(skB) in
                                                                {1723}out(c, GetEndpointRequest);
                                                                {1724}in(c, (=GetEndpointResponse,=pkSess_2151,=Sign,SP_2152: bitstring,UP_2153: bitstring));
                                                                {1725}new Nc_2154: bitstring;
                                                                {1726}let gNc_2155: bitstring = exp(g,Nc_2154) in
                                                                {1727}let m1_2156: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2155) in
                                                                {1728}out(c, (pkCli_1846,m1_2156,sign(h(m1_2156),skCli_1845)));
                                                                {1729}in(c, (em2_2157: bitstring,sigM2_2158: bitstring));
                                                                {1730}let m2_2159: bitstring = em2_2157 in
                                                                {1731}if (verify(h(m2_2159),sigM2_2158,pkSess_2151) <> true) then
                                                                    0
                                                                else
                                                                    {1732}let (=OpenSecureChannelResponse,PartS_2160: bitstring,ST_2161: bitstring,TTL_2162: bitstring) = m2_2159 in
                                                                    {1733}let Kcli_2163: bitstring = exp(PartS_2160,Nc_2154) in
                                                                    {1734}out(c, senc(mCli(pkCli_1846,pkSess_2151),Kcli_2163))
                                                            )
                                                            else
                                                                {1735}let v_2164: bool = (Sess = C) in
                                                                (
                                                                    {1736}if v_2164 then
                                                                    (
                                                                        {1737}let pkSess_2165: bitstring = pub(skC) in
                                                                        {1738}out(c, GetEndpointRequest);
                                                                        {1739}in(c, (=GetEndpointResponse,=pkSess_2165,=Sign,SP_2166: bitstring,UP_2167: bitstring));
                                                                        {1740}new Nc_2168: bitstring;
                                                                        {1741}let gNc_2169: bitstring = exp(g,Nc_2168) in
                                                                        {1742}let m1_2170: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2169) in
                                                                        {1743}out(c, (pkCli_1846,m1_2170,sign(h(m1_2170),skCli_1845)));
                                                                        {1744}in(c, (em2_2171: bitstring,sigM2_2172: bitstring));
                                                                        {1745}let m2_2173: bitstring = em2_2171 in
                                                                        {1746}if (verify(h(m2_2173),sigM2_2172,pkSess_2165) <> true) then
                                                                            0
                                                                        else
                                                                            {1747}let (=OpenSecureChannelResponse,PartS_2174: bitstring,ST_2175: bitstring,TTL_2176: bitstring) = m2_2173 in
                                                                            {1748}let Kcli_2177: bitstring = exp(PartS_2174,Nc_2168) in
                                                                            {1749}out(c, senc(mCli(pkCli_1846,pkSess_2165),Kcli_2177))
                                                                    )
                                                                    else
                                                                        {1750}let pkSess_2178: bitstring = pub(sk(Sess)) in
                                                                        {1751}out(c, GetEndpointRequest);
                                                                        {1752}in(c, (=GetEndpointResponse,=pkSess_2178,=Sign,SP_2179: bitstring,UP_2180: bitstring));
                                                                        {1753}new Nc_2181: bitstring;
                                                                        {1754}let gNc_2182: bitstring = exp(g,Nc_2181) in
                                                                        {1755}let m1_2183: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2182) in
                                                                        {1756}out(c, (pkCli_1846,m1_2183,sign(h(m1_2183),skCli_1845)));
                                                                        {1757}in(c, (em2_2184: bitstring,sigM2_2185: bitstring));
                                                                        {1758}let m2_2186: bitstring = em2_2184 in
                                                                        {1759}if (verify(h(m2_2186),sigM2_2185,pkSess_2178) <> true) then
                                                                            0
                                                                        else
                                                                            {1760}let (=OpenSecureChannelResponse,PartS_2187: bitstring,ST_2188: bitstring,TTL_2189: bitstring) = m2_2186 in
                                                                            {1761}let Kcli_2190: bitstring = exp(PartS_2187,Nc_2181) in
                                                                            {1762}out(c, senc(mCli(pkCli_1846,pkSess_2178),Kcli_2190))
                                                                )
                                                                else
                                                                    {1763}let pkSess_2191: bitstring = fail-any in
                                                                    {1764}out(c, GetEndpointRequest);
                                                                    {1765}in(c, (=GetEndpointResponse,=pkSess_2191,=Sign,SP_2192: bitstring,UP_2193: bitstring));
                                                                    {1766}new Nc_2194: bitstring;
                                                                    {1767}let gNc_2195: bitstring = exp(g,Nc_2194) in
                                                                    {1768}let m1_2196: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2195) in
                                                                    {1769}out(c, (pkCli_1846,m1_2196,sign(h(m1_2196),skCli_1845)));
                                                                    {1770}in(c, (em2_2197: bitstring,sigM2_2198: bitstring));
                                                                    {1771}let m2_2199: bitstring = em2_2197 in
                                                                    {1772}if (verify(h(m2_2199),sigM2_2198,pkSess_2191) <> true) then
                                                                        0
                                                                    else
                                                                        {1773}let (=OpenSecureChannelResponse,PartS_2200: bitstring,ST_2201: bitstring,TTL_2202: bitstring) = m2_2199 in
                                                                        {1774}let Kcli_2203: bitstring = exp(PartS_2200,Nc_2194) in
                                                                        {1775}out(c, senc(mCli(pkCli_1846,pkSess_2191),Kcli_2203))
                                                        )
                                                        else
                                                            {1776}let pkSess_2204: bitstring = fail-any in
                                                            {1777}out(c, GetEndpointRequest);
                                                            {1778}in(c, (=GetEndpointResponse,=pkSess_2204,=Sign,SP_2205: bitstring,UP_2206: bitstring));
                                                            {1779}new Nc_2207: bitstring;
                                                            {1780}let gNc_2208: bitstring = exp(g,Nc_2207) in
                                                            {1781}let m1_2209: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2208) in
                                                            {1782}out(c, (pkCli_1846,m1_2209,sign(h(m1_2209),skCli_1845)));
                                                            {1783}in(c, (em2_2210: bitstring,sigM2_2211: bitstring));
                                                            {1784}let m2_2212: bitstring = em2_2210 in
                                                            {1785}if (verify(h(m2_2212),sigM2_2211,pkSess_2204) <> true) then
                                                                0
                                                            else
                                                                {1786}let (=OpenSecureChannelResponse,PartS_2213: bitstring,ST_2214: bitstring,TTL_2215: bitstring) = m2_2212 in
                                                                {1787}let Kcli_2216: bitstring = exp(PartS_2213,Nc_2207) in
                                                                {1788}out(c, senc(mCli(pkCli_1846,pkSess_2204),Kcli_2216))
                                                )
                                                else
                                                    {1789}let pkSess_2217: bitstring = fail-any in
                                                    {1790}out(c, GetEndpointRequest);
                                                    {1791}in(c, (=GetEndpointResponse,=pkSess_2217,=Sign,SP_2218: bitstring,UP_2219: bitstring));
                                                    {1792}new Nc_2220: bitstring;
                                                    {1793}let gNc_2221: bitstring = exp(g,Nc_2220) in
                                                    {1794}let m1_2222: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2221) in
                                                    {1795}out(c, (pkCli_1846,m1_2222,sign(h(m1_2222),skCli_1845)));
                                                    {1796}in(c, (em2_2223: bitstring,sigM2_2224: bitstring));
                                                    {1797}let m2_2225: bitstring = em2_2223 in
                                                    {1798}if (verify(h(m2_2225),sigM2_2224,pkSess_2217) <> true) then
                                                        0
                                                    else
                                                        {1799}let (=OpenSecureChannelResponse,PartS_2226: bitstring,ST_2227: bitstring,TTL_2228: bitstring) = m2_2225 in
                                                        {1800}let Kcli_2229: bitstring = exp(PartS_2226,Nc_2220) in
                                                        {1801}out(c, senc(mCli(pkCli_1846,pkSess_2217),Kcli_2229))
                                        )
                                        else
                                            {1802}let pkDisco_2230: bitstring = fail-any in
                                            {1803}let v_2231: bool = (Sess = A) in
                                            (
                                                {1804}if v_2231 then
                                                (
                                                    {1805}let pkSess_2232: bitstring = pub(skA) in
                                                    {1806}out(c, GetEndpointRequest);
                                                    {1807}in(c, (=GetEndpointResponse,=pkSess_2232,=Sign,SP_2233: bitstring,UP_2234: bitstring));
                                                    {1808}new Nc_2235: bitstring;
                                                    {1809}let gNc_2236: bitstring = exp(g,Nc_2235) in
                                                    {1810}let m1_2237: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2236) in
                                                    {1811}out(c, (pkCli_1846,m1_2237,sign(h(m1_2237),skCli_1845)));
                                                    {1812}in(c, (em2_2238: bitstring,sigM2_2239: bitstring));
                                                    {1813}let m2_2240: bitstring = em2_2238 in
                                                    {1814}if (verify(h(m2_2240),sigM2_2239,pkSess_2232) <> true) then
                                                        0
                                                    else
                                                        {1815}let (=OpenSecureChannelResponse,PartS_2241: bitstring,ST_2242: bitstring,TTL_2243: bitstring) = m2_2240 in
                                                        {1816}let Kcli_2244: bitstring = exp(PartS_2241,Nc_2235) in
                                                        {1817}out(c, senc(mCli(pkCli_1846,pkSess_2232),Kcli_2244))
                                                )
                                                else
                                                    {1818}let v_2245: bool = (Sess = B) in
                                                    (
                                                        {1819}if v_2245 then
                                                        (
                                                            {1820}let pkSess_2246: bitstring = pub(skB) in
                                                            {1821}out(c, GetEndpointRequest);
                                                            {1822}in(c, (=GetEndpointResponse,=pkSess_2246,=Sign,SP_2247: bitstring,UP_2248: bitstring));
                                                            {1823}new Nc_2249: bitstring;
                                                            {1824}let gNc_2250: bitstring = exp(g,Nc_2249) in
                                                            {1825}let m1_2251: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2250) in
                                                            {1826}out(c, (pkCli_1846,m1_2251,sign(h(m1_2251),skCli_1845)));
                                                            {1827}in(c, (em2_2252: bitstring,sigM2_2253: bitstring));
                                                            {1828}let m2_2254: bitstring = em2_2252 in
                                                            {1829}if (verify(h(m2_2254),sigM2_2253,pkSess_2246) <> true) then
                                                                0
                                                            else
                                                                {1830}let (=OpenSecureChannelResponse,PartS_2255: bitstring,ST_2256: bitstring,TTL_2257: bitstring) = m2_2254 in
                                                                {1831}let Kcli_2258: bitstring = exp(PartS_2255,Nc_2249) in
                                                                {1832}out(c, senc(mCli(pkCli_1846,pkSess_2246),Kcli_2258))
                                                        )
                                                        else
                                                            {1833}let v_2259: bool = (Sess = C) in
                                                            (
                                                                {1834}if v_2259 then
                                                                (
                                                                    {1835}let pkSess_2260: bitstring = pub(skC) in
                                                                    {1836}out(c, GetEndpointRequest);
                                                                    {1837}in(c, (=GetEndpointResponse,=pkSess_2260,=Sign,SP_2261: bitstring,UP_2262: bitstring));
                                                                    {1838}new Nc_2263: bitstring;
                                                                    {1839}let gNc_2264: bitstring = exp(g,Nc_2263) in
                                                                    {1840}let m1_2265: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2264) in
                                                                    {1841}out(c, (pkCli_1846,m1_2265,sign(h(m1_2265),skCli_1845)));
                                                                    {1842}in(c, (em2_2266: bitstring,sigM2_2267: bitstring));
                                                                    {1843}let m2_2268: bitstring = em2_2266 in
                                                                    {1844}if (verify(h(m2_2268),sigM2_2267,pkSess_2260) <> true) then
                                                                        0
                                                                    else
                                                                        {1845}let (=OpenSecureChannelResponse,PartS_2269: bitstring,ST_2270: bitstring,TTL_2271: bitstring) = m2_2268 in
                                                                        {1846}let Kcli_2272: bitstring = exp(PartS_2269,Nc_2263) in
                                                                        {1847}out(c, senc(mCli(pkCli_1846,pkSess_2260),Kcli_2272))
                                                                )
                                                                else
                                                                    {1848}let pkSess_2273: bitstring = pub(sk(Sess)) in
                                                                    {1849}out(c, GetEndpointRequest);
                                                                    {1850}in(c, (=GetEndpointResponse,=pkSess_2273,=Sign,SP_2274: bitstring,UP_2275: bitstring));
                                                                    {1851}new Nc_2276: bitstring;
                                                                    {1852}let gNc_2277: bitstring = exp(g,Nc_2276) in
                                                                    {1853}let m1_2278: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2277) in
                                                                    {1854}out(c, (pkCli_1846,m1_2278,sign(h(m1_2278),skCli_1845)));
                                                                    {1855}in(c, (em2_2279: bitstring,sigM2_2280: bitstring));
                                                                    {1856}let m2_2281: bitstring = em2_2279 in
                                                                    {1857}if (verify(h(m2_2281),sigM2_2280,pkSess_2273) <> true) then
                                                                        0
                                                                    else
                                                                        {1858}let (=OpenSecureChannelResponse,PartS_2282: bitstring,ST_2283: bitstring,TTL_2284: bitstring) = m2_2281 in
                                                                        {1859}let Kcli_2285: bitstring = exp(PartS_2282,Nc_2276) in
                                                                        {1860}out(c, senc(mCli(pkCli_1846,pkSess_2273),Kcli_2285))
                                                            )
                                                            else
                                                                {1861}let pkSess_2286: bitstring = fail-any in
                                                                {1862}out(c, GetEndpointRequest);
                                                                {1863}in(c, (=GetEndpointResponse,=pkSess_2286,=Sign,SP_2287: bitstring,UP_2288: bitstring));
                                                                {1864}new Nc_2289: bitstring;
                                                                {1865}let gNc_2290: bitstring = exp(g,Nc_2289) in
                                                                {1866}let m1_2291: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2290) in
                                                                {1867}out(c, (pkCli_1846,m1_2291,sign(h(m1_2291),skCli_1845)));
                                                                {1868}in(c, (em2_2292: bitstring,sigM2_2293: bitstring));
                                                                {1869}let m2_2294: bitstring = em2_2292 in
                                                                {1870}if (verify(h(m2_2294),sigM2_2293,pkSess_2286) <> true) then
                                                                    0
                                                                else
                                                                    {1871}let (=OpenSecureChannelResponse,PartS_2295: bitstring,ST_2296: bitstring,TTL_2297: bitstring) = m2_2294 in
                                                                    {1872}let Kcli_2298: bitstring = exp(PartS_2295,Nc_2289) in
                                                                    {1873}out(c, senc(mCli(pkCli_1846,pkSess_2286),Kcli_2298))
                                                    )
                                                    else
                                                        {1874}let pkSess_2299: bitstring = fail-any in
                                                        {1875}out(c, GetEndpointRequest);
                                                        {1876}in(c, (=GetEndpointResponse,=pkSess_2299,=Sign,SP_2300: bitstring,UP_2301: bitstring));
                                                        {1877}new Nc_2302: bitstring;
                                                        {1878}let gNc_2303: bitstring = exp(g,Nc_2302) in
                                                        {1879}let m1_2304: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2303) in
                                                        {1880}out(c, (pkCli_1846,m1_2304,sign(h(m1_2304),skCli_1845)));
                                                        {1881}in(c, (em2_2305: bitstring,sigM2_2306: bitstring));
                                                        {1882}let m2_2307: bitstring = em2_2305 in
                                                        {1883}if (verify(h(m2_2307),sigM2_2306,pkSess_2299) <> true) then
                                                            0
                                                        else
                                                            {1884}let (=OpenSecureChannelResponse,PartS_2308: bitstring,ST_2309: bitstring,TTL_2310: bitstring) = m2_2307 in
                                                            {1885}let Kcli_2311: bitstring = exp(PartS_2308,Nc_2302) in
                                                            {1886}out(c, senc(mCli(pkCli_1846,pkSess_2299),Kcli_2311))
                                            )
                                            else
                                                {1887}let pkSess_2312: bitstring = fail-any in
                                                {1888}out(c, GetEndpointRequest);
                                                {1889}in(c, (=GetEndpointResponse,=pkSess_2312,=Sign,SP_2313: bitstring,UP_2314: bitstring));
                                                {1890}new Nc_2315: bitstring;
                                                {1891}let gNc_2316: bitstring = exp(g,Nc_2315) in
                                                {1892}let m1_2317: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2316) in
                                                {1893}out(c, (pkCli_1846,m1_2317,sign(h(m1_2317),skCli_1845)));
                                                {1894}in(c, (em2_2318: bitstring,sigM2_2319: bitstring));
                                                {1895}let m2_2320: bitstring = em2_2318 in
                                                {1896}if (verify(h(m2_2320),sigM2_2319,pkSess_2312) <> true) then
                                                    0
                                                else
                                                    {1897}let (=OpenSecureChannelResponse,PartS_2321: bitstring,ST_2322: bitstring,TTL_2323: bitstring) = m2_2320 in
                                                    {1898}let Kcli_2324: bitstring = exp(PartS_2321,Nc_2315) in
                                                    {1899}out(c, senc(mCli(pkCli_1846,pkSess_2312),Kcli_2324))
                                )
                                else
                                    {1900}let pkDisco_2325: bitstring = fail-any in
                                    {1901}let v_2326: bool = (Sess = A) in
                                    (
                                        {1902}if v_2326 then
                                        (
                                            {1903}let pkSess_2327: bitstring = pub(skA) in
                                            {1904}out(c, GetEndpointRequest);
                                            {1905}in(c, (=GetEndpointResponse,=pkSess_2327,=Sign,SP_2328: bitstring,UP_2329: bitstring));
                                            {1906}new Nc_2330: bitstring;
                                            {1907}let gNc_2331: bitstring = exp(g,Nc_2330) in
                                            {1908}let m1_2332: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2331) in
                                            {1909}out(c, (pkCli_1846,m1_2332,sign(h(m1_2332),skCli_1845)));
                                            {1910}in(c, (em2_2333: bitstring,sigM2_2334: bitstring));
                                            {1911}let m2_2335: bitstring = em2_2333 in
                                            {1912}if (verify(h(m2_2335),sigM2_2334,pkSess_2327) <> true) then
                                                0
                                            else
                                                {1913}let (=OpenSecureChannelResponse,PartS_2336: bitstring,ST_2337: bitstring,TTL_2338: bitstring) = m2_2335 in
                                                {1914}let Kcli_2339: bitstring = exp(PartS_2336,Nc_2330) in
                                                {1915}out(c, senc(mCli(pkCli_1846,pkSess_2327),Kcli_2339))
                                        )
                                        else
                                            {1916}let v_2340: bool = (Sess = B) in
                                            (
                                                {1917}if v_2340 then
                                                (
                                                    {1918}let pkSess_2341: bitstring = pub(skB) in
                                                    {1919}out(c, GetEndpointRequest);
                                                    {1920}in(c, (=GetEndpointResponse,=pkSess_2341,=Sign,SP_2342: bitstring,UP_2343: bitstring));
                                                    {1921}new Nc_2344: bitstring;
                                                    {1922}let gNc_2345: bitstring = exp(g,Nc_2344) in
                                                    {1923}let m1_2346: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2345) in
                                                    {1924}out(c, (pkCli_1846,m1_2346,sign(h(m1_2346),skCli_1845)));
                                                    {1925}in(c, (em2_2347: bitstring,sigM2_2348: bitstring));
                                                    {1926}let m2_2349: bitstring = em2_2347 in
                                                    {1927}if (verify(h(m2_2349),sigM2_2348,pkSess_2341) <> true) then
                                                        0
                                                    else
                                                        {1928}let (=OpenSecureChannelResponse,PartS_2350: bitstring,ST_2351: bitstring,TTL_2352: bitstring) = m2_2349 in
                                                        {1929}let Kcli_2353: bitstring = exp(PartS_2350,Nc_2344) in
                                                        {1930}out(c, senc(mCli(pkCli_1846,pkSess_2341),Kcli_2353))
                                                )
                                                else
                                                    {1931}let v_2354: bool = (Sess = C) in
                                                    (
                                                        {1932}if v_2354 then
                                                        (
                                                            {1933}let pkSess_2355: bitstring = pub(skC) in
                                                            {1934}out(c, GetEndpointRequest);
                                                            {1935}in(c, (=GetEndpointResponse,=pkSess_2355,=Sign,SP_2356: bitstring,UP_2357: bitstring));
                                                            {1936}new Nc_2358: bitstring;
                                                            {1937}let gNc_2359: bitstring = exp(g,Nc_2358) in
                                                            {1938}let m1_2360: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2359) in
                                                            {1939}out(c, (pkCli_1846,m1_2360,sign(h(m1_2360),skCli_1845)));
                                                            {1940}in(c, (em2_2361: bitstring,sigM2_2362: bitstring));
                                                            {1941}let m2_2363: bitstring = em2_2361 in
                                                            {1942}if (verify(h(m2_2363),sigM2_2362,pkSess_2355) <> true) then
                                                                0
                                                            else
                                                                {1943}let (=OpenSecureChannelResponse,PartS_2364: bitstring,ST_2365: bitstring,TTL_2366: bitstring) = m2_2363 in
                                                                {1944}let Kcli_2367: bitstring = exp(PartS_2364,Nc_2358) in
                                                                {1945}out(c, senc(mCli(pkCli_1846,pkSess_2355),Kcli_2367))
                                                        )
                                                        else
                                                            {1946}let pkSess_2368: bitstring = pub(sk(Sess)) in
                                                            {1947}out(c, GetEndpointRequest);
                                                            {1948}in(c, (=GetEndpointResponse,=pkSess_2368,=Sign,SP_2369: bitstring,UP_2370: bitstring));
                                                            {1949}new Nc_2371: bitstring;
                                                            {1950}let gNc_2372: bitstring = exp(g,Nc_2371) in
                                                            {1951}let m1_2373: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2372) in
                                                            {1952}out(c, (pkCli_1846,m1_2373,sign(h(m1_2373),skCli_1845)));
                                                            {1953}in(c, (em2_2374: bitstring,sigM2_2375: bitstring));
                                                            {1954}let m2_2376: bitstring = em2_2374 in
                                                            {1955}if (verify(h(m2_2376),sigM2_2375,pkSess_2368) <> true) then
                                                                0
                                                            else
                                                                {1956}let (=OpenSecureChannelResponse,PartS_2377: bitstring,ST_2378: bitstring,TTL_2379: bitstring) = m2_2376 in
                                                                {1957}let Kcli_2380: bitstring = exp(PartS_2377,Nc_2371) in
                                                                {1958}out(c, senc(mCli(pkCli_1846,pkSess_2368),Kcli_2380))
                                                    )
                                                    else
                                                        {1959}let pkSess_2381: bitstring = fail-any in
                                                        {1960}out(c, GetEndpointRequest);
                                                        {1961}in(c, (=GetEndpointResponse,=pkSess_2381,=Sign,SP_2382: bitstring,UP_2383: bitstring));
                                                        {1962}new Nc_2384: bitstring;
                                                        {1963}let gNc_2385: bitstring = exp(g,Nc_2384) in
                                                        {1964}let m1_2386: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2385) in
                                                        {1965}out(c, (pkCli_1846,m1_2386,sign(h(m1_2386),skCli_1845)));
                                                        {1966}in(c, (em2_2387: bitstring,sigM2_2388: bitstring));
                                                        {1967}let m2_2389: bitstring = em2_2387 in
                                                        {1968}if (verify(h(m2_2389),sigM2_2388,pkSess_2381) <> true) then
                                                            0
                                                        else
                                                            {1969}let (=OpenSecureChannelResponse,PartS_2390: bitstring,ST_2391: bitstring,TTL_2392: bitstring) = m2_2389 in
                                                            {1970}let Kcli_2393: bitstring = exp(PartS_2390,Nc_2384) in
                                                            {1971}out(c, senc(mCli(pkCli_1846,pkSess_2381),Kcli_2393))
                                            )
                                            else
                                                {1972}let pkSess_2394: bitstring = fail-any in
                                                {1973}out(c, GetEndpointRequest);
                                                {1974}in(c, (=GetEndpointResponse,=pkSess_2394,=Sign,SP_2395: bitstring,UP_2396: bitstring));
                                                {1975}new Nc_2397: bitstring;
                                                {1976}let gNc_2398: bitstring = exp(g,Nc_2397) in
                                                {1977}let m1_2399: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2398) in
                                                {1978}out(c, (pkCli_1846,m1_2399,sign(h(m1_2399),skCli_1845)));
                                                {1979}in(c, (em2_2400: bitstring,sigM2_2401: bitstring));
                                                {1980}let m2_2402: bitstring = em2_2400 in
                                                {1981}if (verify(h(m2_2402),sigM2_2401,pkSess_2394) <> true) then
                                                    0
                                                else
                                                    {1982}let (=OpenSecureChannelResponse,PartS_2403: bitstring,ST_2404: bitstring,TTL_2405: bitstring) = m2_2402 in
                                                    {1983}let Kcli_2406: bitstring = exp(PartS_2403,Nc_2397) in
                                                    {1984}out(c, senc(mCli(pkCli_1846,pkSess_2394),Kcli_2406))
                                    )
                                    else
                                        {1985}let pkSess_2407: bitstring = fail-any in
                                        {1986}out(c, GetEndpointRequest);
                                        {1987}in(c, (=GetEndpointResponse,=pkSess_2407,=Sign,SP_2408: bitstring,UP_2409: bitstring));
                                        {1988}new Nc_2410: bitstring;
                                        {1989}let gNc_2411: bitstring = exp(g,Nc_2410) in
                                        {1990}let m1_2412: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2411) in
                                        {1991}out(c, (pkCli_1846,m1_2412,sign(h(m1_2412),skCli_1845)));
                                        {1992}in(c, (em2_2413: bitstring,sigM2_2414: bitstring));
                                        {1993}let m2_2415: bitstring = em2_2413 in
                                        {1994}if (verify(h(m2_2415),sigM2_2414,pkSess_2407) <> true) then
                                            0
                                        else
                                            {1995}let (=OpenSecureChannelResponse,PartS_2416: bitstring,ST_2417: bitstring,TTL_2418: bitstring) = m2_2415 in
                                            {1996}let Kcli_2419: bitstring = exp(PartS_2416,Nc_2410) in
                                            {1997}out(c, senc(mCli(pkCli_1846,pkSess_2407),Kcli_2419))
                        )
                        else
                            {1998}let pkDisco_2420: bitstring = fail-any in
                            {1999}let v_2421: bool = (Sess = A) in
                            (
                                {2000}if v_2421 then
                                (
                                    {2001}let pkSess_2422: bitstring = pub(skA) in
                                    {2002}out(c, GetEndpointRequest);
                                    {2003}in(c, (=GetEndpointResponse,=pkSess_2422,=Sign,SP_2423: bitstring,UP_2424: bitstring));
                                    {2004}new Nc_2425: bitstring;
                                    {2005}let gNc_2426: bitstring = exp(g,Nc_2425) in
                                    {2006}let m1_2427: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2426) in
                                    {2007}out(c, (pkCli_1846,m1_2427,sign(h(m1_2427),skCli_1845)));
                                    {2008}in(c, (em2_2428: bitstring,sigM2_2429: bitstring));
                                    {2009}let m2_2430: bitstring = em2_2428 in
                                    {2010}if (verify(h(m2_2430),sigM2_2429,pkSess_2422) <> true) then
                                        0
                                    else
                                        {2011}let (=OpenSecureChannelResponse,PartS_2431: bitstring,ST_2432: bitstring,TTL_2433: bitstring) = m2_2430 in
                                        {2012}let Kcli_2434: bitstring = exp(PartS_2431,Nc_2425) in
                                        {2013}out(c, senc(mCli(pkCli_1846,pkSess_2422),Kcli_2434))
                                )
                                else
                                    {2014}let v_2435: bool = (Sess = B) in
                                    (
                                        {2015}if v_2435 then
                                        (
                                            {2016}let pkSess_2436: bitstring = pub(skB) in
                                            {2017}out(c, GetEndpointRequest);
                                            {2018}in(c, (=GetEndpointResponse,=pkSess_2436,=Sign,SP_2437: bitstring,UP_2438: bitstring));
                                            {2019}new Nc_2439: bitstring;
                                            {2020}let gNc_2440: bitstring = exp(g,Nc_2439) in
                                            {2021}let m1_2441: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2440) in
                                            {2022}out(c, (pkCli_1846,m1_2441,sign(h(m1_2441),skCli_1845)));
                                            {2023}in(c, (em2_2442: bitstring,sigM2_2443: bitstring));
                                            {2024}let m2_2444: bitstring = em2_2442 in
                                            {2025}if (verify(h(m2_2444),sigM2_2443,pkSess_2436) <> true) then
                                                0
                                            else
                                                {2026}let (=OpenSecureChannelResponse,PartS_2445: bitstring,ST_2446: bitstring,TTL_2447: bitstring) = m2_2444 in
                                                {2027}let Kcli_2448: bitstring = exp(PartS_2445,Nc_2439) in
                                                {2028}out(c, senc(mCli(pkCli_1846,pkSess_2436),Kcli_2448))
                                        )
                                        else
                                            {2029}let v_2449: bool = (Sess = C) in
                                            (
                                                {2030}if v_2449 then
                                                (
                                                    {2031}let pkSess_2450: bitstring = pub(skC) in
                                                    {2032}out(c, GetEndpointRequest);
                                                    {2033}in(c, (=GetEndpointResponse,=pkSess_2450,=Sign,SP_2451: bitstring,UP_2452: bitstring));
                                                    {2034}new Nc_2453: bitstring;
                                                    {2035}let gNc_2454: bitstring = exp(g,Nc_2453) in
                                                    {2036}let m1_2455: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2454) in
                                                    {2037}out(c, (pkCli_1846,m1_2455,sign(h(m1_2455),skCli_1845)));
                                                    {2038}in(c, (em2_2456: bitstring,sigM2_2457: bitstring));
                                                    {2039}let m2_2458: bitstring = em2_2456 in
                                                    {2040}if (verify(h(m2_2458),sigM2_2457,pkSess_2450) <> true) then
                                                        0
                                                    else
                                                        {2041}let (=OpenSecureChannelResponse,PartS_2459: bitstring,ST_2460: bitstring,TTL_2461: bitstring) = m2_2458 in
                                                        {2042}let Kcli_2462: bitstring = exp(PartS_2459,Nc_2453) in
                                                        {2043}out(c, senc(mCli(pkCli_1846,pkSess_2450),Kcli_2462))
                                                )
                                                else
                                                    {2044}let pkSess_2463: bitstring = pub(sk(Sess)) in
                                                    {2045}out(c, GetEndpointRequest);
                                                    {2046}in(c, (=GetEndpointResponse,=pkSess_2463,=Sign,SP_2464: bitstring,UP_2465: bitstring));
                                                    {2047}new Nc_2466: bitstring;
                                                    {2048}let gNc_2467: bitstring = exp(g,Nc_2466) in
                                                    {2049}let m1_2468: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2467) in
                                                    {2050}out(c, (pkCli_1846,m1_2468,sign(h(m1_2468),skCli_1845)));
                                                    {2051}in(c, (em2_2469: bitstring,sigM2_2470: bitstring));
                                                    {2052}let m2_2471: bitstring = em2_2469 in
                                                    {2053}if (verify(h(m2_2471),sigM2_2470,pkSess_2463) <> true) then
                                                        0
                                                    else
                                                        {2054}let (=OpenSecureChannelResponse,PartS_2472: bitstring,ST_2473: bitstring,TTL_2474: bitstring) = m2_2471 in
                                                        {2055}let Kcli_2475: bitstring = exp(PartS_2472,Nc_2466) in
                                                        {2056}out(c, senc(mCli(pkCli_1846,pkSess_2463),Kcli_2475))
                                            )
                                            else
                                                {2057}let pkSess_2476: bitstring = fail-any in
                                                {2058}out(c, GetEndpointRequest);
                                                {2059}in(c, (=GetEndpointResponse,=pkSess_2476,=Sign,SP_2477: bitstring,UP_2478: bitstring));
                                                {2060}new Nc_2479: bitstring;
                                                {2061}let gNc_2480: bitstring = exp(g,Nc_2479) in
                                                {2062}let m1_2481: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2480) in
                                                {2063}out(c, (pkCli_1846,m1_2481,sign(h(m1_2481),skCli_1845)));
                                                {2064}in(c, (em2_2482: bitstring,sigM2_2483: bitstring));
                                                {2065}let m2_2484: bitstring = em2_2482 in
                                                {2066}if (verify(h(m2_2484),sigM2_2483,pkSess_2476) <> true) then
                                                    0
                                                else
                                                    {2067}let (=OpenSecureChannelResponse,PartS_2485: bitstring,ST_2486: bitstring,TTL_2487: bitstring) = m2_2484 in
                                                    {2068}let Kcli_2488: bitstring = exp(PartS_2485,Nc_2479) in
                                                    {2069}out(c, senc(mCli(pkCli_1846,pkSess_2476),Kcli_2488))
                                    )
                                    else
                                        {2070}let pkSess_2489: bitstring = fail-any in
                                        {2071}out(c, GetEndpointRequest);
                                        {2072}in(c, (=GetEndpointResponse,=pkSess_2489,=Sign,SP_2490: bitstring,UP_2491: bitstring));
                                        {2073}new Nc_2492: bitstring;
                                        {2074}let gNc_2493: bitstring = exp(g,Nc_2492) in
                                        {2075}let m1_2494: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2493) in
                                        {2076}out(c, (pkCli_1846,m1_2494,sign(h(m1_2494),skCli_1845)));
                                        {2077}in(c, (em2_2495: bitstring,sigM2_2496: bitstring));
                                        {2078}let m2_2497: bitstring = em2_2495 in
                                        {2079}if (verify(h(m2_2497),sigM2_2496,pkSess_2489) <> true) then
                                            0
                                        else
                                            {2080}let (=OpenSecureChannelResponse,PartS_2498: bitstring,ST_2499: bitstring,TTL_2500: bitstring) = m2_2497 in
                                            {2081}let Kcli_2501: bitstring = exp(PartS_2498,Nc_2492) in
                                            {2082}out(c, senc(mCli(pkCli_1846,pkSess_2489),Kcli_2501))
                            )
                            else
                                {2083}let pkSess_2502: bitstring = fail-any in
                                {2084}out(c, GetEndpointRequest);
                                {2085}in(c, (=GetEndpointResponse,=pkSess_2502,=Sign,SP_2503: bitstring,UP_2504: bitstring));
                                {2086}new Nc_2505: bitstring;
                                {2087}let gNc_2506: bitstring = exp(g,Nc_2505) in
                                {2088}let m1_2507: bitstring = (OpenSecureChannelRequest,pkCli_1846,gNc_2506) in
                                {2089}out(c, (pkCli_1846,m1_2507,sign(h(m1_2507),skCli_1845)));
                                {2090}in(c, (em2_2508: bitstring,sigM2_2509: bitstring));
                                {2091}let m2_2510: bitstring = em2_2508 in
                                {2092}if (verify(h(m2_2510),sigM2_2509,pkSess_2502) <> true) then
                                    0
                                else
                                    {2093}let (=OpenSecureChannelResponse,PartS_2511: bitstring,ST_2512: bitstring,TTL_2513: bitstring) = m2_2510 in
                                    {2094}let Kcli_2514: bitstring = exp(PartS_2511,Nc_2505) in
                                    {2095}out(c, senc(mCli(pkCli_1846,pkSess_2502),Kcli_2514))
                    )
                    else
                        {2096}let skCli_2515: bitstring = fail-any in
                        {2097}let pkCli_2516: bitstring = pub(skCli_2515) in
                        {2098}let v_2517: bool = (Disco = A) in
                        (
                            {2099}if v_2517 then
                            (
                                {2100}let pkDisco_2518: bitstring = pub(skA) in
                                {2101}let v_2519: bool = (Sess = A) in
                                (
                                    {2102}if v_2519 then
                                    (
                                        {2103}let pkSess_2520: bitstring = pub(skA) in
                                        {2104}out(c, GetEndpointRequest);
                                        {2105}in(c, (=GetEndpointResponse,=pkSess_2520,=Sign,SP_2521: bitstring,UP_2522: bitstring));
                                        {2106}new Nc_2523: bitstring;
                                        {2107}let gNc_2524: bitstring = exp(g,Nc_2523) in
                                        {2108}let m1_2525: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2524) in
                                        {2109}out(c, (pkCli_2516,m1_2525,sign(h(m1_2525),skCli_2515)));
                                        {2110}in(c, (em2_2526: bitstring,sigM2_2527: bitstring));
                                        {2111}let m2_2528: bitstring = em2_2526 in
                                        {2112}if (verify(h(m2_2528),sigM2_2527,pkSess_2520) <> true) then
                                            0
                                        else
                                            {2113}let (=OpenSecureChannelResponse,PartS_2529: bitstring,ST_2530: bitstring,TTL_2531: bitstring) = m2_2528 in
                                            {2114}let Kcli_2532: bitstring = exp(PartS_2529,Nc_2523) in
                                            {2115}out(c, senc(mCli(pkCli_2516,pkSess_2520),Kcli_2532))
                                    )
                                    else
                                        {2116}let v_2533: bool = (Sess = B) in
                                        (
                                            {2117}if v_2533 then
                                            (
                                                {2118}let pkSess_2534: bitstring = pub(skB) in
                                                {2119}out(c, GetEndpointRequest);
                                                {2120}in(c, (=GetEndpointResponse,=pkSess_2534,=Sign,SP_2535: bitstring,UP_2536: bitstring));
                                                {2121}new Nc_2537: bitstring;
                                                {2122}let gNc_2538: bitstring = exp(g,Nc_2537) in
                                                {2123}let m1_2539: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2538) in
                                                {2124}out(c, (pkCli_2516,m1_2539,sign(h(m1_2539),skCli_2515)));
                                                {2125}in(c, (em2_2540: bitstring,sigM2_2541: bitstring));
                                                {2126}let m2_2542: bitstring = em2_2540 in
                                                {2127}if (verify(h(m2_2542),sigM2_2541,pkSess_2534) <> true) then
                                                    0
                                                else
                                                    {2128}let (=OpenSecureChannelResponse,PartS_2543: bitstring,ST_2544: bitstring,TTL_2545: bitstring) = m2_2542 in
                                                    {2129}let Kcli_2546: bitstring = exp(PartS_2543,Nc_2537) in
                                                    {2130}out(c, senc(mCli(pkCli_2516,pkSess_2534),Kcli_2546))
                                            )
                                            else
                                                {2131}let v_2547: bool = (Sess = C) in
                                                (
                                                    {2132}if v_2547 then
                                                    (
                                                        {2133}let pkSess_2548: bitstring = pub(skC) in
                                                        {2134}out(c, GetEndpointRequest);
                                                        {2135}in(c, (=GetEndpointResponse,=pkSess_2548,=Sign,SP_2549: bitstring,UP_2550: bitstring));
                                                        {2136}new Nc_2551: bitstring;
                                                        {2137}let gNc_2552: bitstring = exp(g,Nc_2551) in
                                                        {2138}let m1_2553: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2552) in
                                                        {2139}out(c, (pkCli_2516,m1_2553,sign(h(m1_2553),skCli_2515)));
                                                        {2140}in(c, (em2_2554: bitstring,sigM2_2555: bitstring));
                                                        {2141}let m2_2556: bitstring = em2_2554 in
                                                        {2142}if (verify(h(m2_2556),sigM2_2555,pkSess_2548) <> true) then
                                                            0
                                                        else
                                                            {2143}let (=OpenSecureChannelResponse,PartS_2557: bitstring,ST_2558: bitstring,TTL_2559: bitstring) = m2_2556 in
                                                            {2144}let Kcli_2560: bitstring = exp(PartS_2557,Nc_2551) in
                                                            {2145}out(c, senc(mCli(pkCli_2516,pkSess_2548),Kcli_2560))
                                                    )
                                                    else
                                                        {2146}let pkSess_2561: bitstring = pub(sk(Sess)) in
                                                        {2147}out(c, GetEndpointRequest);
                                                        {2148}in(c, (=GetEndpointResponse,=pkSess_2561,=Sign,SP_2562: bitstring,UP_2563: bitstring));
                                                        {2149}new Nc_2564: bitstring;
                                                        {2150}let gNc_2565: bitstring = exp(g,Nc_2564) in
                                                        {2151}let m1_2566: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2565) in
                                                        {2152}out(c, (pkCli_2516,m1_2566,sign(h(m1_2566),skCli_2515)));
                                                        {2153}in(c, (em2_2567: bitstring,sigM2_2568: bitstring));
                                                        {2154}let m2_2569: bitstring = em2_2567 in
                                                        {2155}if (verify(h(m2_2569),sigM2_2568,pkSess_2561) <> true) then
                                                            0
                                                        else
                                                            {2156}let (=OpenSecureChannelResponse,PartS_2570: bitstring,ST_2571: bitstring,TTL_2572: bitstring) = m2_2569 in
                                                            {2157}let Kcli_2573: bitstring = exp(PartS_2570,Nc_2564) in
                                                            {2158}out(c, senc(mCli(pkCli_2516,pkSess_2561),Kcli_2573))
                                                )
                                                else
                                                    {2159}let pkSess_2574: bitstring = fail-any in
                                                    {2160}out(c, GetEndpointRequest);
                                                    {2161}in(c, (=GetEndpointResponse,=pkSess_2574,=Sign,SP_2575: bitstring,UP_2576: bitstring));
                                                    {2162}new Nc_2577: bitstring;
                                                    {2163}let gNc_2578: bitstring = exp(g,Nc_2577) in
                                                    {2164}let m1_2579: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2578) in
                                                    {2165}out(c, (pkCli_2516,m1_2579,sign(h(m1_2579),skCli_2515)));
                                                    {2166}in(c, (em2_2580: bitstring,sigM2_2581: bitstring));
                                                    {2167}let m2_2582: bitstring = em2_2580 in
                                                    {2168}if (verify(h(m2_2582),sigM2_2581,pkSess_2574) <> true) then
                                                        0
                                                    else
                                                        {2169}let (=OpenSecureChannelResponse,PartS_2583: bitstring,ST_2584: bitstring,TTL_2585: bitstring) = m2_2582 in
                                                        {2170}let Kcli_2586: bitstring = exp(PartS_2583,Nc_2577) in
                                                        {2171}out(c, senc(mCli(pkCli_2516,pkSess_2574),Kcli_2586))
                                        )
                                        else
                                            {2172}let pkSess_2587: bitstring = fail-any in
                                            {2173}out(c, GetEndpointRequest);
                                            {2174}in(c, (=GetEndpointResponse,=pkSess_2587,=Sign,SP_2588: bitstring,UP_2589: bitstring));
                                            {2175}new Nc_2590: bitstring;
                                            {2176}let gNc_2591: bitstring = exp(g,Nc_2590) in
                                            {2177}let m1_2592: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2591) in
                                            {2178}out(c, (pkCli_2516,m1_2592,sign(h(m1_2592),skCli_2515)));
                                            {2179}in(c, (em2_2593: bitstring,sigM2_2594: bitstring));
                                            {2180}let m2_2595: bitstring = em2_2593 in
                                            {2181}if (verify(h(m2_2595),sigM2_2594,pkSess_2587) <> true) then
                                                0
                                            else
                                                {2182}let (=OpenSecureChannelResponse,PartS_2596: bitstring,ST_2597: bitstring,TTL_2598: bitstring) = m2_2595 in
                                                {2183}let Kcli_2599: bitstring = exp(PartS_2596,Nc_2590) in
                                                {2184}out(c, senc(mCli(pkCli_2516,pkSess_2587),Kcli_2599))
                                )
                                else
                                    {2185}let pkSess_2600: bitstring = fail-any in
                                    {2186}out(c, GetEndpointRequest);
                                    {2187}in(c, (=GetEndpointResponse,=pkSess_2600,=Sign,SP_2601: bitstring,UP_2602: bitstring));
                                    {2188}new Nc_2603: bitstring;
                                    {2189}let gNc_2604: bitstring = exp(g,Nc_2603) in
                                    {2190}let m1_2605: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2604) in
                                    {2191}out(c, (pkCli_2516,m1_2605,sign(h(m1_2605),skCli_2515)));
                                    {2192}in(c, (em2_2606: bitstring,sigM2_2607: bitstring));
                                    {2193}let m2_2608: bitstring = em2_2606 in
                                    {2194}if (verify(h(m2_2608),sigM2_2607,pkSess_2600) <> true) then
                                        0
                                    else
                                        {2195}let (=OpenSecureChannelResponse,PartS_2609: bitstring,ST_2610: bitstring,TTL_2611: bitstring) = m2_2608 in
                                        {2196}let Kcli_2612: bitstring = exp(PartS_2609,Nc_2603) in
                                        {2197}out(c, senc(mCli(pkCli_2516,pkSess_2600),Kcli_2612))
                            )
                            else
                                {2198}let v_2613: bool = (Disco = B) in
                                (
                                    {2199}if v_2613 then
                                    (
                                        {2200}let pkDisco_2614: bitstring = pub(skB) in
                                        {2201}let v_2615: bool = (Sess = A) in
                                        (
                                            {2202}if v_2615 then
                                            (
                                                {2203}let pkSess_2616: bitstring = pub(skA) in
                                                {2204}out(c, GetEndpointRequest);
                                                {2205}in(c, (=GetEndpointResponse,=pkSess_2616,=Sign,SP_2617: bitstring,UP_2618: bitstring));
                                                {2206}new Nc_2619: bitstring;
                                                {2207}let gNc_2620: bitstring = exp(g,Nc_2619) in
                                                {2208}let m1_2621: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2620) in
                                                {2209}out(c, (pkCli_2516,m1_2621,sign(h(m1_2621),skCli_2515)));
                                                {2210}in(c, (em2_2622: bitstring,sigM2_2623: bitstring));
                                                {2211}let m2_2624: bitstring = em2_2622 in
                                                {2212}if (verify(h(m2_2624),sigM2_2623,pkSess_2616) <> true) then
                                                    0
                                                else
                                                    {2213}let (=OpenSecureChannelResponse,PartS_2625: bitstring,ST_2626: bitstring,TTL_2627: bitstring) = m2_2624 in
                                                    {2214}let Kcli_2628: bitstring = exp(PartS_2625,Nc_2619) in
                                                    {2215}out(c, senc(mCli(pkCli_2516,pkSess_2616),Kcli_2628))
                                            )
                                            else
                                                {2216}let v_2629: bool = (Sess = B) in
                                                (
                                                    {2217}if v_2629 then
                                                    (
                                                        {2218}let pkSess_2630: bitstring = pub(skB) in
                                                        {2219}out(c, GetEndpointRequest);
                                                        {2220}in(c, (=GetEndpointResponse,=pkSess_2630,=Sign,SP_2631: bitstring,UP_2632: bitstring));
                                                        {2221}new Nc_2633: bitstring;
                                                        {2222}let gNc_2634: bitstring = exp(g,Nc_2633) in
                                                        {2223}let m1_2635: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2634) in
                                                        {2224}out(c, (pkCli_2516,m1_2635,sign(h(m1_2635),skCli_2515)));
                                                        {2225}in(c, (em2_2636: bitstring,sigM2_2637: bitstring));
                                                        {2226}let m2_2638: bitstring = em2_2636 in
                                                        {2227}if (verify(h(m2_2638),sigM2_2637,pkSess_2630) <> true) then
                                                            0
                                                        else
                                                            {2228}let (=OpenSecureChannelResponse,PartS_2639: bitstring,ST_2640: bitstring,TTL_2641: bitstring) = m2_2638 in
                                                            {2229}let Kcli_2642: bitstring = exp(PartS_2639,Nc_2633) in
                                                            {2230}out(c, senc(mCli(pkCli_2516,pkSess_2630),Kcli_2642))
                                                    )
                                                    else
                                                        {2231}let v_2643: bool = (Sess = C) in
                                                        (
                                                            {2232}if v_2643 then
                                                            (
                                                                {2233}let pkSess_2644: bitstring = pub(skC) in
                                                                {2234}out(c, GetEndpointRequest);
                                                                {2235}in(c, (=GetEndpointResponse,=pkSess_2644,=Sign,SP_2645: bitstring,UP_2646: bitstring));
                                                                {2236}new Nc_2647: bitstring;
                                                                {2237}let gNc_2648: bitstring = exp(g,Nc_2647) in
                                                                {2238}let m1_2649: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2648) in
                                                                {2239}out(c, (pkCli_2516,m1_2649,sign(h(m1_2649),skCli_2515)));
                                                                {2240}in(c, (em2_2650: bitstring,sigM2_2651: bitstring));
                                                                {2241}let m2_2652: bitstring = em2_2650 in
                                                                {2242}if (verify(h(m2_2652),sigM2_2651,pkSess_2644) <> true) then
                                                                    0
                                                                else
                                                                    {2243}let (=OpenSecureChannelResponse,PartS_2653: bitstring,ST_2654: bitstring,TTL_2655: bitstring) = m2_2652 in
                                                                    {2244}let Kcli_2656: bitstring = exp(PartS_2653,Nc_2647) in
                                                                    {2245}out(c, senc(mCli(pkCli_2516,pkSess_2644),Kcli_2656))
                                                            )
                                                            else
                                                                {2246}let pkSess_2657: bitstring = pub(sk(Sess)) in
                                                                {2247}out(c, GetEndpointRequest);
                                                                {2248}in(c, (=GetEndpointResponse,=pkSess_2657,=Sign,SP_2658: bitstring,UP_2659: bitstring));
                                                                {2249}new Nc_2660: bitstring;
                                                                {2250}let gNc_2661: bitstring = exp(g,Nc_2660) in
                                                                {2251}let m1_2662: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2661) in
                                                                {2252}out(c, (pkCli_2516,m1_2662,sign(h(m1_2662),skCli_2515)));
                                                                {2253}in(c, (em2_2663: bitstring,sigM2_2664: bitstring));
                                                                {2254}let m2_2665: bitstring = em2_2663 in
                                                                {2255}if (verify(h(m2_2665),sigM2_2664,pkSess_2657) <> true) then
                                                                    0
                                                                else
                                                                    {2256}let (=OpenSecureChannelResponse,PartS_2666: bitstring,ST_2667: bitstring,TTL_2668: bitstring) = m2_2665 in
                                                                    {2257}let Kcli_2669: bitstring = exp(PartS_2666,Nc_2660) in
                                                                    {2258}out(c, senc(mCli(pkCli_2516,pkSess_2657),Kcli_2669))
                                                        )
                                                        else
                                                            {2259}let pkSess_2670: bitstring = fail-any in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2670,=Sign,SP_2671: bitstring,UP_2672: bitstring));
                                                            {2262}new Nc_2673: bitstring;
                                                            {2263}let gNc_2674: bitstring = exp(g,Nc_2673) in
                                                            {2264}let m1_2675: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2674) in
                                                            {2265}out(c, (pkCli_2516,m1_2675,sign(h(m1_2675),skCli_2515)));
                                                            {2266}in(c, (em2_2676: bitstring,sigM2_2677: bitstring));
                                                            {2267}let m2_2678: bitstring = em2_2676 in
                                                            {2268}if (verify(h(m2_2678),sigM2_2677,pkSess_2670) <> true) then
                                                                0
                                                            else
                                                                {2269}let (=OpenSecureChannelResponse,PartS_2679: bitstring,ST_2680: bitstring,TTL_2681: bitstring) = m2_2678 in
                                                                {2270}let Kcli_2682: bitstring = exp(PartS_2679,Nc_2673) in
                                                                {2271}out(c, senc(mCli(pkCli_2516,pkSess_2670),Kcli_2682))
                                                )
                                                else
                                                    {2272}let pkSess_2683: bitstring = fail-any in
                                                    {2273}out(c, GetEndpointRequest);
                                                    {2274}in(c, (=GetEndpointResponse,=pkSess_2683,=Sign,SP_2684: bitstring,UP_2685: bitstring));
                                                    {2275}new Nc_2686: bitstring;
                                                    {2276}let gNc_2687: bitstring = exp(g,Nc_2686) in
                                                    {2277}let m1_2688: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2687) in
                                                    {2278}out(c, (pkCli_2516,m1_2688,sign(h(m1_2688),skCli_2515)));
                                                    {2279}in(c, (em2_2689: bitstring,sigM2_2690: bitstring));
                                                    {2280}let m2_2691: bitstring = em2_2689 in
                                                    {2281}if (verify(h(m2_2691),sigM2_2690,pkSess_2683) <> true) then
                                                        0
                                                    else
                                                        {2282}let (=OpenSecureChannelResponse,PartS_2692: bitstring,ST_2693: bitstring,TTL_2694: bitstring) = m2_2691 in
                                                        {2283}let Kcli_2695: bitstring = exp(PartS_2692,Nc_2686) in
                                                        {2284}out(c, senc(mCli(pkCli_2516,pkSess_2683),Kcli_2695))
                                        )
                                        else
                                            {2285}let pkSess_2696: bitstring = fail-any in
                                            {2286}out(c, GetEndpointRequest);
                                            {2287}in(c, (=GetEndpointResponse,=pkSess_2696,=Sign,SP_2697: bitstring,UP_2698: bitstring));
                                            {2288}new Nc_2699: bitstring;
                                            {2289}let gNc_2700: bitstring = exp(g,Nc_2699) in
                                            {2290}let m1_2701: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2700) in
                                            {2291}out(c, (pkCli_2516,m1_2701,sign(h(m1_2701),skCli_2515)));
                                            {2292}in(c, (em2_2702: bitstring,sigM2_2703: bitstring));
                                            {2293}let m2_2704: bitstring = em2_2702 in
                                            {2294}if (verify(h(m2_2704),sigM2_2703,pkSess_2696) <> true) then
                                                0
                                            else
                                                {2295}let (=OpenSecureChannelResponse,PartS_2705: bitstring,ST_2706: bitstring,TTL_2707: bitstring) = m2_2704 in
                                                {2296}let Kcli_2708: bitstring = exp(PartS_2705,Nc_2699) in
                                                {2297}out(c, senc(mCli(pkCli_2516,pkSess_2696),Kcli_2708))
                                    )
                                    else
                                        {2298}let v_2709: bool = (Disco = C) in
                                        (
                                            {2299}if v_2709 then
                                            (
                                                {2300}let pkDisco_2710: bitstring = pub(skC) in
                                                {2301}let v_2711: bool = (Sess = A) in
                                                (
                                                    {2302}if v_2711 then
                                                    (
                                                        {2303}let pkSess_2712: bitstring = pub(skA) in
                                                        {2304}out(c, GetEndpointRequest);
                                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2712,=Sign,SP_2713: bitstring,UP_2714: bitstring));
                                                        {2306}new Nc_2715: bitstring;
                                                        {2307}let gNc_2716: bitstring = exp(g,Nc_2715) in
                                                        {2308}let m1_2717: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2716) in
                                                        {2309}out(c, (pkCli_2516,m1_2717,sign(h(m1_2717),skCli_2515)));
                                                        {2310}in(c, (em2_2718: bitstring,sigM2_2719: bitstring));
                                                        {2311}let m2_2720: bitstring = em2_2718 in
                                                        {2312}if (verify(h(m2_2720),sigM2_2719,pkSess_2712) <> true) then
                                                            0
                                                        else
                                                            {2313}let (=OpenSecureChannelResponse,PartS_2721: bitstring,ST_2722: bitstring,TTL_2723: bitstring) = m2_2720 in
                                                            {2314}let Kcli_2724: bitstring = exp(PartS_2721,Nc_2715) in
                                                            {2315}out(c, senc(mCli(pkCli_2516,pkSess_2712),Kcli_2724))
                                                    )
                                                    else
                                                        {2316}let v_2725: bool = (Sess = B) in
                                                        (
                                                            {2317}if v_2725 then
                                                            (
                                                                {2318}let pkSess_2726: bitstring = pub(skB) in
                                                                {2319}out(c, GetEndpointRequest);
                                                                {2320}in(c, (=GetEndpointResponse,=pkSess_2726,=Sign,SP_2727: bitstring,UP_2728: bitstring));
                                                                {2321}new Nc_2729: bitstring;
                                                                {2322}let gNc_2730: bitstring = exp(g,Nc_2729) in
                                                                {2323}let m1_2731: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2730) in
                                                                {2324}out(c, (pkCli_2516,m1_2731,sign(h(m1_2731),skCli_2515)));
                                                                {2325}in(c, (em2_2732: bitstring,sigM2_2733: bitstring));
                                                                {2326}let m2_2734: bitstring = em2_2732 in
                                                                {2327}if (verify(h(m2_2734),sigM2_2733,pkSess_2726) <> true) then
                                                                    0
                                                                else
                                                                    {2328}let (=OpenSecureChannelResponse,PartS_2735: bitstring,ST_2736: bitstring,TTL_2737: bitstring) = m2_2734 in
                                                                    {2329}let Kcli_2738: bitstring = exp(PartS_2735,Nc_2729) in
                                                                    {2330}out(c, senc(mCli(pkCli_2516,pkSess_2726),Kcli_2738))
                                                            )
                                                            else
                                                                {2331}let v_2739: bool = (Sess = C) in
                                                                (
                                                                    {2332}if v_2739 then
                                                                    (
                                                                        {2333}let pkSess_2740: bitstring = pub(skC) in
                                                                        {2334}out(c, GetEndpointRequest);
                                                                        {2335}in(c, (=GetEndpointResponse,=pkSess_2740,=Sign,SP_2741: bitstring,UP_2742: bitstring));
                                                                        {2336}new Nc_2743: bitstring;
                                                                        {2337}let gNc_2744: bitstring = exp(g,Nc_2743) in
                                                                        {2338}let m1_2745: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2744) in
                                                                        {2339}out(c, (pkCli_2516,m1_2745,sign(h(m1_2745),skCli_2515)));
                                                                        {2340}in(c, (em2_2746: bitstring,sigM2_2747: bitstring));
                                                                        {2341}let m2_2748: bitstring = em2_2746 in
                                                                        {2342}if (verify(h(m2_2748),sigM2_2747,pkSess_2740) <> true) then
                                                                            0
                                                                        else
                                                                            {2343}let (=OpenSecureChannelResponse,PartS_2749: bitstring,ST_2750: bitstring,TTL_2751: bitstring) = m2_2748 in
                                                                            {2344}let Kcli_2752: bitstring = exp(PartS_2749,Nc_2743) in
                                                                            {2345}out(c, senc(mCli(pkCli_2516,pkSess_2740),Kcli_2752))
                                                                    )
                                                                    else
                                                                        {2346}let pkSess_2753: bitstring = pub(sk(Sess)) in
                                                                        {2347}out(c, GetEndpointRequest);
                                                                        {2348}in(c, (=GetEndpointResponse,=pkSess_2753,=Sign,SP_2754: bitstring,UP_2755: bitstring));
                                                                        {2349}new Nc_2756: bitstring;
                                                                        {2350}let gNc_2757: bitstring = exp(g,Nc_2756) in
                                                                        {2351}let m1_2758: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2757) in
                                                                        {2352}out(c, (pkCli_2516,m1_2758,sign(h(m1_2758),skCli_2515)));
                                                                        {2353}in(c, (em2_2759: bitstring,sigM2_2760: bitstring));
                                                                        {2354}let m2_2761: bitstring = em2_2759 in
                                                                        {2355}if (verify(h(m2_2761),sigM2_2760,pkSess_2753) <> true) then
                                                                            0
                                                                        else
                                                                            {2356}let (=OpenSecureChannelResponse,PartS_2762: bitstring,ST_2763: bitstring,TTL_2764: bitstring) = m2_2761 in
                                                                            {2357}let Kcli_2765: bitstring = exp(PartS_2762,Nc_2756) in
                                                                            {2358}out(c, senc(mCli(pkCli_2516,pkSess_2753),Kcli_2765))
                                                                )
                                                                else
                                                                    {2359}let pkSess_2766: bitstring = fail-any in
                                                                    {2360}out(c, GetEndpointRequest);
                                                                    {2361}in(c, (=GetEndpointResponse,=pkSess_2766,=Sign,SP_2767: bitstring,UP_2768: bitstring));
                                                                    {2362}new Nc_2769: bitstring;
                                                                    {2363}let gNc_2770: bitstring = exp(g,Nc_2769) in
                                                                    {2364}let m1_2771: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2770) in
                                                                    {2365}out(c, (pkCli_2516,m1_2771,sign(h(m1_2771),skCli_2515)));
                                                                    {2366}in(c, (em2_2772: bitstring,sigM2_2773: bitstring));
                                                                    {2367}let m2_2774: bitstring = em2_2772 in
                                                                    {2368}if (verify(h(m2_2774),sigM2_2773,pkSess_2766) <> true) then
                                                                        0
                                                                    else
                                                                        {2369}let (=OpenSecureChannelResponse,PartS_2775: bitstring,ST_2776: bitstring,TTL_2777: bitstring) = m2_2774 in
                                                                        {2370}let Kcli_2778: bitstring = exp(PartS_2775,Nc_2769) in
                                                                        {2371}out(c, senc(mCli(pkCli_2516,pkSess_2766),Kcli_2778))
                                                        )
                                                        else
                                                            {2372}let pkSess_2779: bitstring = fail-any in
                                                            {2373}out(c, GetEndpointRequest);
                                                            {2374}in(c, (=GetEndpointResponse,=pkSess_2779,=Sign,SP_2780: bitstring,UP_2781: bitstring));
                                                            {2375}new Nc_2782: bitstring;
                                                            {2376}let gNc_2783: bitstring = exp(g,Nc_2782) in
                                                            {2377}let m1_2784: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2783) in
                                                            {2378}out(c, (pkCli_2516,m1_2784,sign(h(m1_2784),skCli_2515)));
                                                            {2379}in(c, (em2_2785: bitstring,sigM2_2786: bitstring));
                                                            {2380}let m2_2787: bitstring = em2_2785 in
                                                            {2381}if (verify(h(m2_2787),sigM2_2786,pkSess_2779) <> true) then
                                                                0
                                                            else
                                                                {2382}let (=OpenSecureChannelResponse,PartS_2788: bitstring,ST_2789: bitstring,TTL_2790: bitstring) = m2_2787 in
                                                                {2383}let Kcli_2791: bitstring = exp(PartS_2788,Nc_2782) in
                                                                {2384}out(c, senc(mCli(pkCli_2516,pkSess_2779),Kcli_2791))
                                                )
                                                else
                                                    {2385}let pkSess_2792: bitstring = fail-any in
                                                    {2386}out(c, GetEndpointRequest);
                                                    {2387}in(c, (=GetEndpointResponse,=pkSess_2792,=Sign,SP_2793: bitstring,UP_2794: bitstring));
                                                    {2388}new Nc_2795: bitstring;
                                                    {2389}let gNc_2796: bitstring = exp(g,Nc_2795) in
                                                    {2390}let m1_2797: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2796) in
                                                    {2391}out(c, (pkCli_2516,m1_2797,sign(h(m1_2797),skCli_2515)));
                                                    {2392}in(c, (em2_2798: bitstring,sigM2_2799: bitstring));
                                                    {2393}let m2_2800: bitstring = em2_2798 in
                                                    {2394}if (verify(h(m2_2800),sigM2_2799,pkSess_2792) <> true) then
                                                        0
                                                    else
                                                        {2395}let (=OpenSecureChannelResponse,PartS_2801: bitstring,ST_2802: bitstring,TTL_2803: bitstring) = m2_2800 in
                                                        {2396}let Kcli_2804: bitstring = exp(PartS_2801,Nc_2795) in
                                                        {2397}out(c, senc(mCli(pkCli_2516,pkSess_2792),Kcli_2804))
                                            )
                                            else
                                                {2398}let pkDisco_2805: bitstring = pub(sk(Disco)) in
                                                {2399}let v_2806: bool = (Sess = A) in
                                                (
                                                    {2400}if v_2806 then
                                                    (
                                                        {2401}let pkSess_2807: bitstring = pub(skA) in
                                                        {2402}out(c, GetEndpointRequest);
                                                        {2403}in(c, (=GetEndpointResponse,=pkSess_2807,=Sign,SP_2808: bitstring,UP_2809: bitstring));
                                                        {2404}new Nc_2810: bitstring;
                                                        {2405}let gNc_2811: bitstring = exp(g,Nc_2810) in
                                                        {2406}let m1_2812: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2811) in
                                                        {2407}out(c, (pkCli_2516,m1_2812,sign(h(m1_2812),skCli_2515)));
                                                        {2408}in(c, (em2_2813: bitstring,sigM2_2814: bitstring));
                                                        {2409}let m2_2815: bitstring = em2_2813 in
                                                        {2410}if (verify(h(m2_2815),sigM2_2814,pkSess_2807) <> true) then
                                                            0
                                                        else
                                                            {2411}let (=OpenSecureChannelResponse,PartS_2816: bitstring,ST_2817: bitstring,TTL_2818: bitstring) = m2_2815 in
                                                            {2412}let Kcli_2819: bitstring = exp(PartS_2816,Nc_2810) in
                                                            {2413}out(c, senc(mCli(pkCli_2516,pkSess_2807),Kcli_2819))
                                                    )
                                                    else
                                                        {2414}let v_2820: bool = (Sess = B) in
                                                        (
                                                            {2415}if v_2820 then
                                                            (
                                                                {2416}let pkSess_2821: bitstring = pub(skB) in
                                                                {2417}out(c, GetEndpointRequest);
                                                                {2418}in(c, (=GetEndpointResponse,=pkSess_2821,=Sign,SP_2822: bitstring,UP_2823: bitstring));
                                                                {2419}new Nc_2824: bitstring;
                                                                {2420}let gNc_2825: bitstring = exp(g,Nc_2824) in
                                                                {2421}let m1_2826: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2825) in
                                                                {2422}out(c, (pkCli_2516,m1_2826,sign(h(m1_2826),skCli_2515)));
                                                                {2423}in(c, (em2_2827: bitstring,sigM2_2828: bitstring));
                                                                {2424}let m2_2829: bitstring = em2_2827 in
                                                                {2425}if (verify(h(m2_2829),sigM2_2828,pkSess_2821) <> true) then
                                                                    0
                                                                else
                                                                    {2426}let (=OpenSecureChannelResponse,PartS_2830: bitstring,ST_2831: bitstring,TTL_2832: bitstring) = m2_2829 in
                                                                    {2427}let Kcli_2833: bitstring = exp(PartS_2830,Nc_2824) in
                                                                    {2428}out(c, senc(mCli(pkCli_2516,pkSess_2821),Kcli_2833))
                                                            )
                                                            else
                                                                {2429}let v_2834: bool = (Sess = C) in
                                                                (
                                                                    {2430}if v_2834 then
                                                                    (
                                                                        {2431}let pkSess_2835: bitstring = pub(skC) in
                                                                        {2432}out(c, GetEndpointRequest);
                                                                        {2433}in(c, (=GetEndpointResponse,=pkSess_2835,=Sign,SP_2836: bitstring,UP_2837: bitstring));
                                                                        {2434}new Nc_2838: bitstring;
                                                                        {2435}let gNc_2839: bitstring = exp(g,Nc_2838) in
                                                                        {2436}let m1_2840: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2839) in
                                                                        {2437}out(c, (pkCli_2516,m1_2840,sign(h(m1_2840),skCli_2515)));
                                                                        {2438}in(c, (em2_2841: bitstring,sigM2_2842: bitstring));
                                                                        {2439}let m2_2843: bitstring = em2_2841 in
                                                                        {2440}if (verify(h(m2_2843),sigM2_2842,pkSess_2835) <> true) then
                                                                            0
                                                                        else
                                                                            {2441}let (=OpenSecureChannelResponse,PartS_2844: bitstring,ST_2845: bitstring,TTL_2846: bitstring) = m2_2843 in
                                                                            {2442}let Kcli_2847: bitstring = exp(PartS_2844,Nc_2838) in
                                                                            {2443}out(c, senc(mCli(pkCli_2516,pkSess_2835),Kcli_2847))
                                                                    )
                                                                    else
                                                                        {2444}let pkSess_2848: bitstring = pub(sk(Sess)) in
                                                                        {2445}out(c, GetEndpointRequest);
                                                                        {2446}in(c, (=GetEndpointResponse,=pkSess_2848,=Sign,SP_2849: bitstring,UP_2850: bitstring));
                                                                        {2447}new Nc_2851: bitstring;
                                                                        {2448}let gNc_2852: bitstring = exp(g,Nc_2851) in
                                                                        {2449}let m1_2853: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2852) in
                                                                        {2450}out(c, (pkCli_2516,m1_2853,sign(h(m1_2853),skCli_2515)));
                                                                        {2451}in(c, (em2_2854: bitstring,sigM2_2855: bitstring));
                                                                        {2452}let m2_2856: bitstring = em2_2854 in
                                                                        {2453}if (verify(h(m2_2856),sigM2_2855,pkSess_2848) <> true) then
                                                                            0
                                                                        else
                                                                            {2454}let (=OpenSecureChannelResponse,PartS_2857: bitstring,ST_2858: bitstring,TTL_2859: bitstring) = m2_2856 in
                                                                            {2455}let Kcli_2860: bitstring = exp(PartS_2857,Nc_2851) in
                                                                            {2456}out(c, senc(mCli(pkCli_2516,pkSess_2848),Kcli_2860))
                                                                )
                                                                else
                                                                    {2457}let pkSess_2861: bitstring = fail-any in
                                                                    {2458}out(c, GetEndpointRequest);
                                                                    {2459}in(c, (=GetEndpointResponse,=pkSess_2861,=Sign,SP_2862: bitstring,UP_2863: bitstring));
                                                                    {2460}new Nc_2864: bitstring;
                                                                    {2461}let gNc_2865: bitstring = exp(g,Nc_2864) in
                                                                    {2462}let m1_2866: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2865) in
                                                                    {2463}out(c, (pkCli_2516,m1_2866,sign(h(m1_2866),skCli_2515)));
                                                                    {2464}in(c, (em2_2867: bitstring,sigM2_2868: bitstring));
                                                                    {2465}let m2_2869: bitstring = em2_2867 in
                                                                    {2466}if (verify(h(m2_2869),sigM2_2868,pkSess_2861) <> true) then
                                                                        0
                                                                    else
                                                                        {2467}let (=OpenSecureChannelResponse,PartS_2870: bitstring,ST_2871: bitstring,TTL_2872: bitstring) = m2_2869 in
                                                                        {2468}let Kcli_2873: bitstring = exp(PartS_2870,Nc_2864) in
                                                                        {2469}out(c, senc(mCli(pkCli_2516,pkSess_2861),Kcli_2873))
                                                        )
                                                        else
                                                            {2470}let pkSess_2874: bitstring = fail-any in
                                                            {2471}out(c, GetEndpointRequest);
                                                            {2472}in(c, (=GetEndpointResponse,=pkSess_2874,=Sign,SP_2875: bitstring,UP_2876: bitstring));
                                                            {2473}new Nc_2877: bitstring;
                                                            {2474}let gNc_2878: bitstring = exp(g,Nc_2877) in
                                                            {2475}let m1_2879: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2878) in
                                                            {2476}out(c, (pkCli_2516,m1_2879,sign(h(m1_2879),skCli_2515)));
                                                            {2477}in(c, (em2_2880: bitstring,sigM2_2881: bitstring));
                                                            {2478}let m2_2882: bitstring = em2_2880 in
                                                            {2479}if (verify(h(m2_2882),sigM2_2881,pkSess_2874) <> true) then
                                                                0
                                                            else
                                                                {2480}let (=OpenSecureChannelResponse,PartS_2883: bitstring,ST_2884: bitstring,TTL_2885: bitstring) = m2_2882 in
                                                                {2481}let Kcli_2886: bitstring = exp(PartS_2883,Nc_2877) in
                                                                {2482}out(c, senc(mCli(pkCli_2516,pkSess_2874),Kcli_2886))
                                                )
                                                else
                                                    {2483}let pkSess_2887: bitstring = fail-any in
                                                    {2484}out(c, GetEndpointRequest);
                                                    {2485}in(c, (=GetEndpointResponse,=pkSess_2887,=Sign,SP_2888: bitstring,UP_2889: bitstring));
                                                    {2486}new Nc_2890: bitstring;
                                                    {2487}let gNc_2891: bitstring = exp(g,Nc_2890) in
                                                    {2488}let m1_2892: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2891) in
                                                    {2489}out(c, (pkCli_2516,m1_2892,sign(h(m1_2892),skCli_2515)));
                                                    {2490}in(c, (em2_2893: bitstring,sigM2_2894: bitstring));
                                                    {2491}let m2_2895: bitstring = em2_2893 in
                                                    {2492}if (verify(h(m2_2895),sigM2_2894,pkSess_2887) <> true) then
                                                        0
                                                    else
                                                        {2493}let (=OpenSecureChannelResponse,PartS_2896: bitstring,ST_2897: bitstring,TTL_2898: bitstring) = m2_2895 in
                                                        {2494}let Kcli_2899: bitstring = exp(PartS_2896,Nc_2890) in
                                                        {2495}out(c, senc(mCli(pkCli_2516,pkSess_2887),Kcli_2899))
                                        )
                                        else
                                            {2496}let pkDisco_2900: bitstring = fail-any in
                                            {2497}let v_2901: bool = (Sess = A) in
                                            (
                                                {2498}if v_2901 then
                                                (
                                                    {2499}let pkSess_2902: bitstring = pub(skA) in
                                                    {2500}out(c, GetEndpointRequest);
                                                    {2501}in(c, (=GetEndpointResponse,=pkSess_2902,=Sign,SP_2903: bitstring,UP_2904: bitstring));
                                                    {2502}new Nc_2905: bitstring;
                                                    {2503}let gNc_2906: bitstring = exp(g,Nc_2905) in
                                                    {2504}let m1_2907: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2906) in
                                                    {2505}out(c, (pkCli_2516,m1_2907,sign(h(m1_2907),skCli_2515)));
                                                    {2506}in(c, (em2_2908: bitstring,sigM2_2909: bitstring));
                                                    {2507}let m2_2910: bitstring = em2_2908 in
                                                    {2508}if (verify(h(m2_2910),sigM2_2909,pkSess_2902) <> true) then
                                                        0
                                                    else
                                                        {2509}let (=OpenSecureChannelResponse,PartS_2911: bitstring,ST_2912: bitstring,TTL_2913: bitstring) = m2_2910 in
                                                        {2510}let Kcli_2914: bitstring = exp(PartS_2911,Nc_2905) in
                                                        {2511}out(c, senc(mCli(pkCli_2516,pkSess_2902),Kcli_2914))
                                                )
                                                else
                                                    {2512}let v_2915: bool = (Sess = B) in
                                                    (
                                                        {2513}if v_2915 then
                                                        (
                                                            {2514}let pkSess_2916: bitstring = pub(skB) in
                                                            {2515}out(c, GetEndpointRequest);
                                                            {2516}in(c, (=GetEndpointResponse,=pkSess_2916,=Sign,SP_2917: bitstring,UP_2918: bitstring));
                                                            {2517}new Nc_2919: bitstring;
                                                            {2518}let gNc_2920: bitstring = exp(g,Nc_2919) in
                                                            {2519}let m1_2921: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2920) in
                                                            {2520}out(c, (pkCli_2516,m1_2921,sign(h(m1_2921),skCli_2515)));
                                                            {2521}in(c, (em2_2922: bitstring,sigM2_2923: bitstring));
                                                            {2522}let m2_2924: bitstring = em2_2922 in
                                                            {2523}if (verify(h(m2_2924),sigM2_2923,pkSess_2916) <> true) then
                                                                0
                                                            else
                                                                {2524}let (=OpenSecureChannelResponse,PartS_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                                                {2525}let Kcli_2928: bitstring = exp(PartS_2925,Nc_2919) in
                                                                {2526}out(c, senc(mCli(pkCli_2516,pkSess_2916),Kcli_2928))
                                                        )
                                                        else
                                                            {2527}let v_2929: bool = (Sess = C) in
                                                            (
                                                                {2528}if v_2929 then
                                                                (
                                                                    {2529}let pkSess_2930: bitstring = pub(skC) in
                                                                    {2530}out(c, GetEndpointRequest);
                                                                    {2531}in(c, (=GetEndpointResponse,=pkSess_2930,=Sign,SP_2931: bitstring,UP_2932: bitstring));
                                                                    {2532}new Nc_2933: bitstring;
                                                                    {2533}let gNc_2934: bitstring = exp(g,Nc_2933) in
                                                                    {2534}let m1_2935: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2934) in
                                                                    {2535}out(c, (pkCli_2516,m1_2935,sign(h(m1_2935),skCli_2515)));
                                                                    {2536}in(c, (em2_2936: bitstring,sigM2_2937: bitstring));
                                                                    {2537}let m2_2938: bitstring = em2_2936 in
                                                                    {2538}if (verify(h(m2_2938),sigM2_2937,pkSess_2930) <> true) then
                                                                        0
                                                                    else
                                                                        {2539}let (=OpenSecureChannelResponse,PartS_2939: bitstring,ST_2940: bitstring,TTL_2941: bitstring) = m2_2938 in
                                                                        {2540}let Kcli_2942: bitstring = exp(PartS_2939,Nc_2933) in
                                                                        {2541}out(c, senc(mCli(pkCli_2516,pkSess_2930),Kcli_2942))
                                                                )
                                                                else
                                                                    {2542}let pkSess_2943: bitstring = pub(sk(Sess)) in
                                                                    {2543}out(c, GetEndpointRequest);
                                                                    {2544}in(c, (=GetEndpointResponse,=pkSess_2943,=Sign,SP_2944: bitstring,UP_2945: bitstring));
                                                                    {2545}new Nc_2946: bitstring;
                                                                    {2546}let gNc_2947: bitstring = exp(g,Nc_2946) in
                                                                    {2547}let m1_2948: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2947) in
                                                                    {2548}out(c, (pkCli_2516,m1_2948,sign(h(m1_2948),skCli_2515)));
                                                                    {2549}in(c, (em2_2949: bitstring,sigM2_2950: bitstring));
                                                                    {2550}let m2_2951: bitstring = em2_2949 in
                                                                    {2551}if (verify(h(m2_2951),sigM2_2950,pkSess_2943) <> true) then
                                                                        0
                                                                    else
                                                                        {2552}let (=OpenSecureChannelResponse,PartS_2952: bitstring,ST_2953: bitstring,TTL_2954: bitstring) = m2_2951 in
                                                                        {2553}let Kcli_2955: bitstring = exp(PartS_2952,Nc_2946) in
                                                                        {2554}out(c, senc(mCli(pkCli_2516,pkSess_2943),Kcli_2955))
                                                            )
                                                            else
                                                                {2555}let pkSess_2956: bitstring = fail-any in
                                                                {2556}out(c, GetEndpointRequest);
                                                                {2557}in(c, (=GetEndpointResponse,=pkSess_2956,=Sign,SP_2957: bitstring,UP_2958: bitstring));
                                                                {2558}new Nc_2959: bitstring;
                                                                {2559}let gNc_2960: bitstring = exp(g,Nc_2959) in
                                                                {2560}let m1_2961: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2960) in
                                                                {2561}out(c, (pkCli_2516,m1_2961,sign(h(m1_2961),skCli_2515)));
                                                                {2562}in(c, (em2_2962: bitstring,sigM2_2963: bitstring));
                                                                {2563}let m2_2964: bitstring = em2_2962 in
                                                                {2564}if (verify(h(m2_2964),sigM2_2963,pkSess_2956) <> true) then
                                                                    0
                                                                else
                                                                    {2565}let (=OpenSecureChannelResponse,PartS_2965: bitstring,ST_2966: bitstring,TTL_2967: bitstring) = m2_2964 in
                                                                    {2566}let Kcli_2968: bitstring = exp(PartS_2965,Nc_2959) in
                                                                    {2567}out(c, senc(mCli(pkCli_2516,pkSess_2956),Kcli_2968))
                                                    )
                                                    else
                                                        {2568}let pkSess_2969: bitstring = fail-any in
                                                        {2569}out(c, GetEndpointRequest);
                                                        {2570}in(c, (=GetEndpointResponse,=pkSess_2969,=Sign,SP_2970: bitstring,UP_2971: bitstring));
                                                        {2571}new Nc_2972: bitstring;
                                                        {2572}let gNc_2973: bitstring = exp(g,Nc_2972) in
                                                        {2573}let m1_2974: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2973) in
                                                        {2574}out(c, (pkCli_2516,m1_2974,sign(h(m1_2974),skCli_2515)));
                                                        {2575}in(c, (em2_2975: bitstring,sigM2_2976: bitstring));
                                                        {2576}let m2_2977: bitstring = em2_2975 in
                                                        {2577}if (verify(h(m2_2977),sigM2_2976,pkSess_2969) <> true) then
                                                            0
                                                        else
                                                            {2578}let (=OpenSecureChannelResponse,PartS_2978: bitstring,ST_2979: bitstring,TTL_2980: bitstring) = m2_2977 in
                                                            {2579}let Kcli_2981: bitstring = exp(PartS_2978,Nc_2972) in
                                                            {2580}out(c, senc(mCli(pkCli_2516,pkSess_2969),Kcli_2981))
                                            )
                                            else
                                                {2581}let pkSess_2982: bitstring = fail-any in
                                                {2582}out(c, GetEndpointRequest);
                                                {2583}in(c, (=GetEndpointResponse,=pkSess_2982,=Sign,SP_2983: bitstring,UP_2984: bitstring));
                                                {2584}new Nc_2985: bitstring;
                                                {2585}let gNc_2986: bitstring = exp(g,Nc_2985) in
                                                {2586}let m1_2987: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_2986) in
                                                {2587}out(c, (pkCli_2516,m1_2987,sign(h(m1_2987),skCli_2515)));
                                                {2588}in(c, (em2_2988: bitstring,sigM2_2989: bitstring));
                                                {2589}let m2_2990: bitstring = em2_2988 in
                                                {2590}if (verify(h(m2_2990),sigM2_2989,pkSess_2982) <> true) then
                                                    0
                                                else
                                                    {2591}let (=OpenSecureChannelResponse,PartS_2991: bitstring,ST_2992: bitstring,TTL_2993: bitstring) = m2_2990 in
                                                    {2592}let Kcli_2994: bitstring = exp(PartS_2991,Nc_2985) in
                                                    {2593}out(c, senc(mCli(pkCli_2516,pkSess_2982),Kcli_2994))
                                )
                                else
                                    {2594}let pkDisco_2995: bitstring = fail-any in
                                    {2595}let v_2996: bool = (Sess = A) in
                                    (
                                        {2596}if v_2996 then
                                        (
                                            {2597}let pkSess_2997: bitstring = pub(skA) in
                                            {2598}out(c, GetEndpointRequest);
                                            {2599}in(c, (=GetEndpointResponse,=pkSess_2997,=Sign,SP_2998: bitstring,UP_2999: bitstring));
                                            {2600}new Nc_3000: bitstring;
                                            {2601}let gNc_3001: bitstring = exp(g,Nc_3000) in
                                            {2602}let m1_3002: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3001) in
                                            {2603}out(c, (pkCli_2516,m1_3002,sign(h(m1_3002),skCli_2515)));
                                            {2604}in(c, (em2_3003: bitstring,sigM2_3004: bitstring));
                                            {2605}let m2_3005: bitstring = em2_3003 in
                                            {2606}if (verify(h(m2_3005),sigM2_3004,pkSess_2997) <> true) then
                                                0
                                            else
                                                {2607}let (=OpenSecureChannelResponse,PartS_3006: bitstring,ST_3007: bitstring,TTL_3008: bitstring) = m2_3005 in
                                                {2608}let Kcli_3009: bitstring = exp(PartS_3006,Nc_3000) in
                                                {2609}out(c, senc(mCli(pkCli_2516,pkSess_2997),Kcli_3009))
                                        )
                                        else
                                            {2610}let v_3010: bool = (Sess = B) in
                                            (
                                                {2611}if v_3010 then
                                                (
                                                    {2612}let pkSess_3011: bitstring = pub(skB) in
                                                    {2613}out(c, GetEndpointRequest);
                                                    {2614}in(c, (=GetEndpointResponse,=pkSess_3011,=Sign,SP_3012: bitstring,UP_3013: bitstring));
                                                    {2615}new Nc_3014: bitstring;
                                                    {2616}let gNc_3015: bitstring = exp(g,Nc_3014) in
                                                    {2617}let m1_3016: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3015) in
                                                    {2618}out(c, (pkCli_2516,m1_3016,sign(h(m1_3016),skCli_2515)));
                                                    {2619}in(c, (em2_3017: bitstring,sigM2_3018: bitstring));
                                                    {2620}let m2_3019: bitstring = em2_3017 in
                                                    {2621}if (verify(h(m2_3019),sigM2_3018,pkSess_3011) <> true) then
                                                        0
                                                    else
                                                        {2622}let (=OpenSecureChannelResponse,PartS_3020: bitstring,ST_3021: bitstring,TTL_3022: bitstring) = m2_3019 in
                                                        {2623}let Kcli_3023: bitstring = exp(PartS_3020,Nc_3014) in
                                                        {2624}out(c, senc(mCli(pkCli_2516,pkSess_3011),Kcli_3023))
                                                )
                                                else
                                                    {2625}let v_3024: bool = (Sess = C) in
                                                    (
                                                        {2626}if v_3024 then
                                                        (
                                                            {2627}let pkSess_3025: bitstring = pub(skC) in
                                                            {2628}out(c, GetEndpointRequest);
                                                            {2629}in(c, (=GetEndpointResponse,=pkSess_3025,=Sign,SP_3026: bitstring,UP_3027: bitstring));
                                                            {2630}new Nc_3028: bitstring;
                                                            {2631}let gNc_3029: bitstring = exp(g,Nc_3028) in
                                                            {2632}let m1_3030: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3029) in
                                                            {2633}out(c, (pkCli_2516,m1_3030,sign(h(m1_3030),skCli_2515)));
                                                            {2634}in(c, (em2_3031: bitstring,sigM2_3032: bitstring));
                                                            {2635}let m2_3033: bitstring = em2_3031 in
                                                            {2636}if (verify(h(m2_3033),sigM2_3032,pkSess_3025) <> true) then
                                                                0
                                                            else
                                                                {2637}let (=OpenSecureChannelResponse,PartS_3034: bitstring,ST_3035: bitstring,TTL_3036: bitstring) = m2_3033 in
                                                                {2638}let Kcli_3037: bitstring = exp(PartS_3034,Nc_3028) in
                                                                {2639}out(c, senc(mCli(pkCli_2516,pkSess_3025),Kcli_3037))
                                                        )
                                                        else
                                                            {2640}let pkSess_3038: bitstring = pub(sk(Sess)) in
                                                            {2641}out(c, GetEndpointRequest);
                                                            {2642}in(c, (=GetEndpointResponse,=pkSess_3038,=Sign,SP_3039: bitstring,UP_3040: bitstring));
                                                            {2643}new Nc_3041: bitstring;
                                                            {2644}let gNc_3042: bitstring = exp(g,Nc_3041) in
                                                            {2645}let m1_3043: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3042) in
                                                            {2646}out(c, (pkCli_2516,m1_3043,sign(h(m1_3043),skCli_2515)));
                                                            {2647}in(c, (em2_3044: bitstring,sigM2_3045: bitstring));
                                                            {2648}let m2_3046: bitstring = em2_3044 in
                                                            {2649}if (verify(h(m2_3046),sigM2_3045,pkSess_3038) <> true) then
                                                                0
                                                            else
                                                                {2650}let (=OpenSecureChannelResponse,PartS_3047: bitstring,ST_3048: bitstring,TTL_3049: bitstring) = m2_3046 in
                                                                {2651}let Kcli_3050: bitstring = exp(PartS_3047,Nc_3041) in
                                                                {2652}out(c, senc(mCli(pkCli_2516,pkSess_3038),Kcli_3050))
                                                    )
                                                    else
                                                        {2653}let pkSess_3051: bitstring = fail-any in
                                                        {2654}out(c, GetEndpointRequest);
                                                        {2655}in(c, (=GetEndpointResponse,=pkSess_3051,=Sign,SP_3052: bitstring,UP_3053: bitstring));
                                                        {2656}new Nc_3054: bitstring;
                                                        {2657}let gNc_3055: bitstring = exp(g,Nc_3054) in
                                                        {2658}let m1_3056: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3055) in
                                                        {2659}out(c, (pkCli_2516,m1_3056,sign(h(m1_3056),skCli_2515)));
                                                        {2660}in(c, (em2_3057: bitstring,sigM2_3058: bitstring));
                                                        {2661}let m2_3059: bitstring = em2_3057 in
                                                        {2662}if (verify(h(m2_3059),sigM2_3058,pkSess_3051) <> true) then
                                                            0
                                                        else
                                                            {2663}let (=OpenSecureChannelResponse,PartS_3060: bitstring,ST_3061: bitstring,TTL_3062: bitstring) = m2_3059 in
                                                            {2664}let Kcli_3063: bitstring = exp(PartS_3060,Nc_3054) in
                                                            {2665}out(c, senc(mCli(pkCli_2516,pkSess_3051),Kcli_3063))
                                            )
                                            else
                                                {2666}let pkSess_3064: bitstring = fail-any in
                                                {2667}out(c, GetEndpointRequest);
                                                {2668}in(c, (=GetEndpointResponse,=pkSess_3064,=Sign,SP_3065: bitstring,UP_3066: bitstring));
                                                {2669}new Nc_3067: bitstring;
                                                {2670}let gNc_3068: bitstring = exp(g,Nc_3067) in
                                                {2671}let m1_3069: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3068) in
                                                {2672}out(c, (pkCli_2516,m1_3069,sign(h(m1_3069),skCli_2515)));
                                                {2673}in(c, (em2_3070: bitstring,sigM2_3071: bitstring));
                                                {2674}let m2_3072: bitstring = em2_3070 in
                                                {2675}if (verify(h(m2_3072),sigM2_3071,pkSess_3064) <> true) then
                                                    0
                                                else
                                                    {2676}let (=OpenSecureChannelResponse,PartS_3073: bitstring,ST_3074: bitstring,TTL_3075: bitstring) = m2_3072 in
                                                    {2677}let Kcli_3076: bitstring = exp(PartS_3073,Nc_3067) in
                                                    {2678}out(c, senc(mCli(pkCli_2516,pkSess_3064),Kcli_3076))
                                    )
                                    else
                                        {2679}let pkSess_3077: bitstring = fail-any in
                                        {2680}out(c, GetEndpointRequest);
                                        {2681}in(c, (=GetEndpointResponse,=pkSess_3077,=Sign,SP_3078: bitstring,UP_3079: bitstring));
                                        {2682}new Nc_3080: bitstring;
                                        {2683}let gNc_3081: bitstring = exp(g,Nc_3080) in
                                        {2684}let m1_3082: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3081) in
                                        {2685}out(c, (pkCli_2516,m1_3082,sign(h(m1_3082),skCli_2515)));
                                        {2686}in(c, (em2_3083: bitstring,sigM2_3084: bitstring));
                                        {2687}let m2_3085: bitstring = em2_3083 in
                                        {2688}if (verify(h(m2_3085),sigM2_3084,pkSess_3077) <> true) then
                                            0
                                        else
                                            {2689}let (=OpenSecureChannelResponse,PartS_3086: bitstring,ST_3087: bitstring,TTL_3088: bitstring) = m2_3085 in
                                            {2690}let Kcli_3089: bitstring = exp(PartS_3086,Nc_3080) in
                                            {2691}out(c, senc(mCli(pkCli_2516,pkSess_3077),Kcli_3089))
                        )
                        else
                            {2692}let pkDisco_3090: bitstring = fail-any in
                            {2693}let v_3091: bool = (Sess = A) in
                            (
                                {2694}if v_3091 then
                                (
                                    {2695}let pkSess_3092: bitstring = pub(skA) in
                                    {2696}out(c, GetEndpointRequest);
                                    {2697}in(c, (=GetEndpointResponse,=pkSess_3092,=Sign,SP_3093: bitstring,UP_3094: bitstring));
                                    {2698}new Nc_3095: bitstring;
                                    {2699}let gNc_3096: bitstring = exp(g,Nc_3095) in
                                    {2700}let m1_3097: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3096) in
                                    {2701}out(c, (pkCli_2516,m1_3097,sign(h(m1_3097),skCli_2515)));
                                    {2702}in(c, (em2_3098: bitstring,sigM2_3099: bitstring));
                                    {2703}let m2_3100: bitstring = em2_3098 in
                                    {2704}if (verify(h(m2_3100),sigM2_3099,pkSess_3092) <> true) then
                                        0
                                    else
                                        {2705}let (=OpenSecureChannelResponse,PartS_3101: bitstring,ST_3102: bitstring,TTL_3103: bitstring) = m2_3100 in
                                        {2706}let Kcli_3104: bitstring = exp(PartS_3101,Nc_3095) in
                                        {2707}out(c, senc(mCli(pkCli_2516,pkSess_3092),Kcli_3104))
                                )
                                else
                                    {2708}let v_3105: bool = (Sess = B) in
                                    (
                                        {2709}if v_3105 then
                                        (
                                            {2710}let pkSess_3106: bitstring = pub(skB) in
                                            {2711}out(c, GetEndpointRequest);
                                            {2712}in(c, (=GetEndpointResponse,=pkSess_3106,=Sign,SP_3107: bitstring,UP_3108: bitstring));
                                            {2713}new Nc_3109: bitstring;
                                            {2714}let gNc_3110: bitstring = exp(g,Nc_3109) in
                                            {2715}let m1_3111: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3110) in
                                            {2716}out(c, (pkCli_2516,m1_3111,sign(h(m1_3111),skCli_2515)));
                                            {2717}in(c, (em2_3112: bitstring,sigM2_3113: bitstring));
                                            {2718}let m2_3114: bitstring = em2_3112 in
                                            {2719}if (verify(h(m2_3114),sigM2_3113,pkSess_3106) <> true) then
                                                0
                                            else
                                                {2720}let (=OpenSecureChannelResponse,PartS_3115: bitstring,ST_3116: bitstring,TTL_3117: bitstring) = m2_3114 in
                                                {2721}let Kcli_3118: bitstring = exp(PartS_3115,Nc_3109) in
                                                {2722}out(c, senc(mCli(pkCli_2516,pkSess_3106),Kcli_3118))
                                        )
                                        else
                                            {2723}let v_3119: bool = (Sess = C) in
                                            (
                                                {2724}if v_3119 then
                                                (
                                                    {2725}let pkSess_3120: bitstring = pub(skC) in
                                                    {2726}out(c, GetEndpointRequest);
                                                    {2727}in(c, (=GetEndpointResponse,=pkSess_3120,=Sign,SP_3121: bitstring,UP_3122: bitstring));
                                                    {2728}new Nc_3123: bitstring;
                                                    {2729}let gNc_3124: bitstring = exp(g,Nc_3123) in
                                                    {2730}let m1_3125: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3124) in
                                                    {2731}out(c, (pkCli_2516,m1_3125,sign(h(m1_3125),skCli_2515)));
                                                    {2732}in(c, (em2_3126: bitstring,sigM2_3127: bitstring));
                                                    {2733}let m2_3128: bitstring = em2_3126 in
                                                    {2734}if (verify(h(m2_3128),sigM2_3127,pkSess_3120) <> true) then
                                                        0
                                                    else
                                                        {2735}let (=OpenSecureChannelResponse,PartS_3129: bitstring,ST_3130: bitstring,TTL_3131: bitstring) = m2_3128 in
                                                        {2736}let Kcli_3132: bitstring = exp(PartS_3129,Nc_3123) in
                                                        {2737}out(c, senc(mCli(pkCli_2516,pkSess_3120),Kcli_3132))
                                                )
                                                else
                                                    {2738}let pkSess_3133: bitstring = pub(sk(Sess)) in
                                                    {2739}out(c, GetEndpointRequest);
                                                    {2740}in(c, (=GetEndpointResponse,=pkSess_3133,=Sign,SP_3134: bitstring,UP_3135: bitstring));
                                                    {2741}new Nc_3136: bitstring;
                                                    {2742}let gNc_3137: bitstring = exp(g,Nc_3136) in
                                                    {2743}let m1_3138: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3137) in
                                                    {2744}out(c, (pkCli_2516,m1_3138,sign(h(m1_3138),skCli_2515)));
                                                    {2745}in(c, (em2_3139: bitstring,sigM2_3140: bitstring));
                                                    {2746}let m2_3141: bitstring = em2_3139 in
                                                    {2747}if (verify(h(m2_3141),sigM2_3140,pkSess_3133) <> true) then
                                                        0
                                                    else
                                                        {2748}let (=OpenSecureChannelResponse,PartS_3142: bitstring,ST_3143: bitstring,TTL_3144: bitstring) = m2_3141 in
                                                        {2749}let Kcli_3145: bitstring = exp(PartS_3142,Nc_3136) in
                                                        {2750}out(c, senc(mCli(pkCli_2516,pkSess_3133),Kcli_3145))
                                            )
                                            else
                                                {2751}let pkSess_3146: bitstring = fail-any in
                                                {2752}out(c, GetEndpointRequest);
                                                {2753}in(c, (=GetEndpointResponse,=pkSess_3146,=Sign,SP_3147: bitstring,UP_3148: bitstring));
                                                {2754}new Nc_3149: bitstring;
                                                {2755}let gNc_3150: bitstring = exp(g,Nc_3149) in
                                                {2756}let m1_3151: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3150) in
                                                {2757}out(c, (pkCli_2516,m1_3151,sign(h(m1_3151),skCli_2515)));
                                                {2758}in(c, (em2_3152: bitstring,sigM2_3153: bitstring));
                                                {2759}let m2_3154: bitstring = em2_3152 in
                                                {2760}if (verify(h(m2_3154),sigM2_3153,pkSess_3146) <> true) then
                                                    0
                                                else
                                                    {2761}let (=OpenSecureChannelResponse,PartS_3155: bitstring,ST_3156: bitstring,TTL_3157: bitstring) = m2_3154 in
                                                    {2762}let Kcli_3158: bitstring = exp(PartS_3155,Nc_3149) in
                                                    {2763}out(c, senc(mCli(pkCli_2516,pkSess_3146),Kcli_3158))
                                    )
                                    else
                                        {2764}let pkSess_3159: bitstring = fail-any in
                                        {2765}out(c, GetEndpointRequest);
                                        {2766}in(c, (=GetEndpointResponse,=pkSess_3159,=Sign,SP_3160: bitstring,UP_3161: bitstring));
                                        {2767}new Nc_3162: bitstring;
                                        {2768}let gNc_3163: bitstring = exp(g,Nc_3162) in
                                        {2769}let m1_3164: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3163) in
                                        {2770}out(c, (pkCli_2516,m1_3164,sign(h(m1_3164),skCli_2515)));
                                        {2771}in(c, (em2_3165: bitstring,sigM2_3166: bitstring));
                                        {2772}let m2_3167: bitstring = em2_3165 in
                                        {2773}if (verify(h(m2_3167),sigM2_3166,pkSess_3159) <> true) then
                                            0
                                        else
                                            {2774}let (=OpenSecureChannelResponse,PartS_3168: bitstring,ST_3169: bitstring,TTL_3170: bitstring) = m2_3167 in
                                            {2775}let Kcli_3171: bitstring = exp(PartS_3168,Nc_3162) in
                                            {2776}out(c, senc(mCli(pkCli_2516,pkSess_3159),Kcli_3171))
                            )
                            else
                                {2777}let pkSess_3172: bitstring = fail-any in
                                {2778}out(c, GetEndpointRequest);
                                {2779}in(c, (=GetEndpointResponse,=pkSess_3172,=Sign,SP_3173: bitstring,UP_3174: bitstring));
                                {2780}new Nc_3175: bitstring;
                                {2781}let gNc_3176: bitstring = exp(g,Nc_3175) in
                                {2782}let m1_3177: bitstring = (OpenSecureChannelRequest,pkCli_2516,gNc_3176) in
                                {2783}out(c, (pkCli_2516,m1_3177,sign(h(m1_3177),skCli_2515)));
                                {2784}in(c, (em2_3178: bitstring,sigM2_3179: bitstring));
                                {2785}let m2_3180: bitstring = em2_3178 in
                                {2786}if (verify(h(m2_3180),sigM2_3179,pkSess_3172) <> true) then
                                    0
                                else
                                    {2787}let (=OpenSecureChannelResponse,PartS_3181: bitstring,ST_3182: bitstring,TTL_3183: bitstring) = m2_3180 in
                                    {2788}let Kcli_3184: bitstring = exp(PartS_3181,Nc_3175) in
                                    {2789}out(c, senc(mCli(pkCli_2516,pkSess_3172),Kcli_3184))
            )
            else
                {2790}let skCli_3185: bitstring = fail-any in
                {2791}let pkCli_3186: bitstring = pub(skCli_3185) in
                {2792}let v_3187: bool = (Disco = A) in
                (
                    {2793}if v_3187 then
                    (
                        {2794}let pkDisco_3188: bitstring = pub(skA) in
                        {2795}let v_3189: bool = (Sess = A) in
                        (
                            {2796}if v_3189 then
                            (
                                {2797}let pkSess_3190: bitstring = pub(skA) in
                                {2798}out(c, GetEndpointRequest);
                                {2799}in(c, (=GetEndpointResponse,=pkSess_3190,=Sign,SP_3191: bitstring,UP_3192: bitstring));
                                {2800}new Nc_3193: bitstring;
                                {2801}let gNc_3194: bitstring = exp(g,Nc_3193) in
                                {2802}let m1_3195: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3194) in
                                {2803}out(c, (pkCli_3186,m1_3195,sign(h(m1_3195),skCli_3185)));
                                {2804}in(c, (em2_3196: bitstring,sigM2_3197: bitstring));
                                {2805}let m2_3198: bitstring = em2_3196 in
                                {2806}if (verify(h(m2_3198),sigM2_3197,pkSess_3190) <> true) then
                                    0
                                else
                                    {2807}let (=OpenSecureChannelResponse,PartS_3199: bitstring,ST_3200: bitstring,TTL_3201: bitstring) = m2_3198 in
                                    {2808}let Kcli_3202: bitstring = exp(PartS_3199,Nc_3193) in
                                    {2809}out(c, senc(mCli(pkCli_3186,pkSess_3190),Kcli_3202))
                            )
                            else
                                {2810}let v_3203: bool = (Sess = B) in
                                (
                                    {2811}if v_3203 then
                                    (
                                        {2812}let pkSess_3204: bitstring = pub(skB) in
                                        {2813}out(c, GetEndpointRequest);
                                        {2814}in(c, (=GetEndpointResponse,=pkSess_3204,=Sign,SP_3205: bitstring,UP_3206: bitstring));
                                        {2815}new Nc_3207: bitstring;
                                        {2816}let gNc_3208: bitstring = exp(g,Nc_3207) in
                                        {2817}let m1_3209: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3208) in
                                        {2818}out(c, (pkCli_3186,m1_3209,sign(h(m1_3209),skCli_3185)));
                                        {2819}in(c, (em2_3210: bitstring,sigM2_3211: bitstring));
                                        {2820}let m2_3212: bitstring = em2_3210 in
                                        {2821}if (verify(h(m2_3212),sigM2_3211,pkSess_3204) <> true) then
                                            0
                                        else
                                            {2822}let (=OpenSecureChannelResponse,PartS_3213: bitstring,ST_3214: bitstring,TTL_3215: bitstring) = m2_3212 in
                                            {2823}let Kcli_3216: bitstring = exp(PartS_3213,Nc_3207) in
                                            {2824}out(c, senc(mCli(pkCli_3186,pkSess_3204),Kcli_3216))
                                    )
                                    else
                                        {2825}let v_3217: bool = (Sess = C) in
                                        (
                                            {2826}if v_3217 then
                                            (
                                                {2827}let pkSess_3218: bitstring = pub(skC) in
                                                {2828}out(c, GetEndpointRequest);
                                                {2829}in(c, (=GetEndpointResponse,=pkSess_3218,=Sign,SP_3219: bitstring,UP_3220: bitstring));
                                                {2830}new Nc_3221: bitstring;
                                                {2831}let gNc_3222: bitstring = exp(g,Nc_3221) in
                                                {2832}let m1_3223: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3222) in
                                                {2833}out(c, (pkCli_3186,m1_3223,sign(h(m1_3223),skCli_3185)));
                                                {2834}in(c, (em2_3224: bitstring,sigM2_3225: bitstring));
                                                {2835}let m2_3226: bitstring = em2_3224 in
                                                {2836}if (verify(h(m2_3226),sigM2_3225,pkSess_3218) <> true) then
                                                    0
                                                else
                                                    {2837}let (=OpenSecureChannelResponse,PartS_3227: bitstring,ST_3228: bitstring,TTL_3229: bitstring) = m2_3226 in
                                                    {2838}let Kcli_3230: bitstring = exp(PartS_3227,Nc_3221) in
                                                    {2839}out(c, senc(mCli(pkCli_3186,pkSess_3218),Kcli_3230))
                                            )
                                            else
                                                {2840}let pkSess_3231: bitstring = pub(sk(Sess)) in
                                                {2841}out(c, GetEndpointRequest);
                                                {2842}in(c, (=GetEndpointResponse,=pkSess_3231,=Sign,SP_3232: bitstring,UP_3233: bitstring));
                                                {2843}new Nc_3234: bitstring;
                                                {2844}let gNc_3235: bitstring = exp(g,Nc_3234) in
                                                {2845}let m1_3236: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3235) in
                                                {2846}out(c, (pkCli_3186,m1_3236,sign(h(m1_3236),skCli_3185)));
                                                {2847}in(c, (em2_3237: bitstring,sigM2_3238: bitstring));
                                                {2848}let m2_3239: bitstring = em2_3237 in
                                                {2849}if (verify(h(m2_3239),sigM2_3238,pkSess_3231) <> true) then
                                                    0
                                                else
                                                    {2850}let (=OpenSecureChannelResponse,PartS_3240: bitstring,ST_3241: bitstring,TTL_3242: bitstring) = m2_3239 in
                                                    {2851}let Kcli_3243: bitstring = exp(PartS_3240,Nc_3234) in
                                                    {2852}out(c, senc(mCli(pkCli_3186,pkSess_3231),Kcli_3243))
                                        )
                                        else
                                            {2853}let pkSess_3244: bitstring = fail-any in
                                            {2854}out(c, GetEndpointRequest);
                                            {2855}in(c, (=GetEndpointResponse,=pkSess_3244,=Sign,SP_3245: bitstring,UP_3246: bitstring));
                                            {2856}new Nc_3247: bitstring;
                                            {2857}let gNc_3248: bitstring = exp(g,Nc_3247) in
                                            {2858}let m1_3249: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3248) in
                                            {2859}out(c, (pkCli_3186,m1_3249,sign(h(m1_3249),skCli_3185)));
                                            {2860}in(c, (em2_3250: bitstring,sigM2_3251: bitstring));
                                            {2861}let m2_3252: bitstring = em2_3250 in
                                            {2862}if (verify(h(m2_3252),sigM2_3251,pkSess_3244) <> true) then
                                                0
                                            else
                                                {2863}let (=OpenSecureChannelResponse,PartS_3253: bitstring,ST_3254: bitstring,TTL_3255: bitstring) = m2_3252 in
                                                {2864}let Kcli_3256: bitstring = exp(PartS_3253,Nc_3247) in
                                                {2865}out(c, senc(mCli(pkCli_3186,pkSess_3244),Kcli_3256))
                                )
                                else
                                    {2866}let pkSess_3257: bitstring = fail-any in
                                    {2867}out(c, GetEndpointRequest);
                                    {2868}in(c, (=GetEndpointResponse,=pkSess_3257,=Sign,SP_3258: bitstring,UP_3259: bitstring));
                                    {2869}new Nc_3260: bitstring;
                                    {2870}let gNc_3261: bitstring = exp(g,Nc_3260) in
                                    {2871}let m1_3262: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3261) in
                                    {2872}out(c, (pkCli_3186,m1_3262,sign(h(m1_3262),skCli_3185)));
                                    {2873}in(c, (em2_3263: bitstring,sigM2_3264: bitstring));
                                    {2874}let m2_3265: bitstring = em2_3263 in
                                    {2875}if (verify(h(m2_3265),sigM2_3264,pkSess_3257) <> true) then
                                        0
                                    else
                                        {2876}let (=OpenSecureChannelResponse,PartS_3266: bitstring,ST_3267: bitstring,TTL_3268: bitstring) = m2_3265 in
                                        {2877}let Kcli_3269: bitstring = exp(PartS_3266,Nc_3260) in
                                        {2878}out(c, senc(mCli(pkCli_3186,pkSess_3257),Kcli_3269))
                        )
                        else
                            {2879}let pkSess_3270: bitstring = fail-any in
                            {2880}out(c, GetEndpointRequest);
                            {2881}in(c, (=GetEndpointResponse,=pkSess_3270,=Sign,SP_3271: bitstring,UP_3272: bitstring));
                            {2882}new Nc_3273: bitstring;
                            {2883}let gNc_3274: bitstring = exp(g,Nc_3273) in
                            {2884}let m1_3275: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3274) in
                            {2885}out(c, (pkCli_3186,m1_3275,sign(h(m1_3275),skCli_3185)));
                            {2886}in(c, (em2_3276: bitstring,sigM2_3277: bitstring));
                            {2887}let m2_3278: bitstring = em2_3276 in
                            {2888}if (verify(h(m2_3278),sigM2_3277,pkSess_3270) <> true) then
                                0
                            else
                                {2889}let (=OpenSecureChannelResponse,PartS_3279: bitstring,ST_3280: bitstring,TTL_3281: bitstring) = m2_3278 in
                                {2890}let Kcli_3282: bitstring = exp(PartS_3279,Nc_3273) in
                                {2891}out(c, senc(mCli(pkCli_3186,pkSess_3270),Kcli_3282))
                    )
                    else
                        {2892}let v_3283: bool = (Disco = B) in
                        (
                            {2893}if v_3283 then
                            (
                                {2894}let pkDisco_3284: bitstring = pub(skB) in
                                {2895}let v_3285: bool = (Sess = A) in
                                (
                                    {2896}if v_3285 then
                                    (
                                        {2897}let pkSess_3286: bitstring = pub(skA) in
                                        {2898}out(c, GetEndpointRequest);
                                        {2899}in(c, (=GetEndpointResponse,=pkSess_3286,=Sign,SP_3287: bitstring,UP_3288: bitstring));
                                        {2900}new Nc_3289: bitstring;
                                        {2901}let gNc_3290: bitstring = exp(g,Nc_3289) in
                                        {2902}let m1_3291: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3290) in
                                        {2903}out(c, (pkCli_3186,m1_3291,sign(h(m1_3291),skCli_3185)));
                                        {2904}in(c, (em2_3292: bitstring,sigM2_3293: bitstring));
                                        {2905}let m2_3294: bitstring = em2_3292 in
                                        {2906}if (verify(h(m2_3294),sigM2_3293,pkSess_3286) <> true) then
                                            0
                                        else
                                            {2907}let (=OpenSecureChannelResponse,PartS_3295: bitstring,ST_3296: bitstring,TTL_3297: bitstring) = m2_3294 in
                                            {2908}let Kcli_3298: bitstring = exp(PartS_3295,Nc_3289) in
                                            {2909}out(c, senc(mCli(pkCli_3186,pkSess_3286),Kcli_3298))
                                    )
                                    else
                                        {2910}let v_3299: bool = (Sess = B) in
                                        (
                                            {2911}if v_3299 then
                                            (
                                                {2912}let pkSess_3300: bitstring = pub(skB) in
                                                {2913}out(c, GetEndpointRequest);
                                                {2914}in(c, (=GetEndpointResponse,=pkSess_3300,=Sign,SP_3301: bitstring,UP_3302: bitstring));
                                                {2915}new Nc_3303: bitstring;
                                                {2916}let gNc_3304: bitstring = exp(g,Nc_3303) in
                                                {2917}let m1_3305: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3304) in
                                                {2918}out(c, (pkCli_3186,m1_3305,sign(h(m1_3305),skCli_3185)));
                                                {2919}in(c, (em2_3306: bitstring,sigM2_3307: bitstring));
                                                {2920}let m2_3308: bitstring = em2_3306 in
                                                {2921}if (verify(h(m2_3308),sigM2_3307,pkSess_3300) <> true) then
                                                    0
                                                else
                                                    {2922}let (=OpenSecureChannelResponse,PartS_3309: bitstring,ST_3310: bitstring,TTL_3311: bitstring) = m2_3308 in
                                                    {2923}let Kcli_3312: bitstring = exp(PartS_3309,Nc_3303) in
                                                    {2924}out(c, senc(mCli(pkCli_3186,pkSess_3300),Kcli_3312))
                                            )
                                            else
                                                {2925}let v_3313: bool = (Sess = C) in
                                                (
                                                    {2926}if v_3313 then
                                                    (
                                                        {2927}let pkSess_3314: bitstring = pub(skC) in
                                                        {2928}out(c, GetEndpointRequest);
                                                        {2929}in(c, (=GetEndpointResponse,=pkSess_3314,=Sign,SP_3315: bitstring,UP_3316: bitstring));
                                                        {2930}new Nc_3317: bitstring;
                                                        {2931}let gNc_3318: bitstring = exp(g,Nc_3317) in
                                                        {2932}let m1_3319: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3318) in
                                                        {2933}out(c, (pkCli_3186,m1_3319,sign(h(m1_3319),skCli_3185)));
                                                        {2934}in(c, (em2_3320: bitstring,sigM2_3321: bitstring));
                                                        {2935}let m2_3322: bitstring = em2_3320 in
                                                        {2936}if (verify(h(m2_3322),sigM2_3321,pkSess_3314) <> true) then
                                                            0
                                                        else
                                                            {2937}let (=OpenSecureChannelResponse,PartS_3323: bitstring,ST_3324: bitstring,TTL_3325: bitstring) = m2_3322 in
                                                            {2938}let Kcli_3326: bitstring = exp(PartS_3323,Nc_3317) in
                                                            {2939}out(c, senc(mCli(pkCli_3186,pkSess_3314),Kcli_3326))
                                                    )
                                                    else
                                                        {2940}let pkSess_3327: bitstring = pub(sk(Sess)) in
                                                        {2941}out(c, GetEndpointRequest);
                                                        {2942}in(c, (=GetEndpointResponse,=pkSess_3327,=Sign,SP_3328: bitstring,UP_3329: bitstring));
                                                        {2943}new Nc_3330: bitstring;
                                                        {2944}let gNc_3331: bitstring = exp(g,Nc_3330) in
                                                        {2945}let m1_3332: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3331) in
                                                        {2946}out(c, (pkCli_3186,m1_3332,sign(h(m1_3332),skCli_3185)));
                                                        {2947}in(c, (em2_3333: bitstring,sigM2_3334: bitstring));
                                                        {2948}let m2_3335: bitstring = em2_3333 in
                                                        {2949}if (verify(h(m2_3335),sigM2_3334,pkSess_3327) <> true) then
                                                            0
                                                        else
                                                            {2950}let (=OpenSecureChannelResponse,PartS_3336: bitstring,ST_3337: bitstring,TTL_3338: bitstring) = m2_3335 in
                                                            {2951}let Kcli_3339: bitstring = exp(PartS_3336,Nc_3330) in
                                                            {2952}out(c, senc(mCli(pkCli_3186,pkSess_3327),Kcli_3339))
                                                )
                                                else
                                                    {2953}let pkSess_3340: bitstring = fail-any in
                                                    {2954}out(c, GetEndpointRequest);
                                                    {2955}in(c, (=GetEndpointResponse,=pkSess_3340,=Sign,SP_3341: bitstring,UP_3342: bitstring));
                                                    {2956}new Nc_3343: bitstring;
                                                    {2957}let gNc_3344: bitstring = exp(g,Nc_3343) in
                                                    {2958}let m1_3345: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3344) in
                                                    {2959}out(c, (pkCli_3186,m1_3345,sign(h(m1_3345),skCli_3185)));
                                                    {2960}in(c, (em2_3346: bitstring,sigM2_3347: bitstring));
                                                    {2961}let m2_3348: bitstring = em2_3346 in
                                                    {2962}if (verify(h(m2_3348),sigM2_3347,pkSess_3340) <> true) then
                                                        0
                                                    else
                                                        {2963}let (=OpenSecureChannelResponse,PartS_3349: bitstring,ST_3350: bitstring,TTL_3351: bitstring) = m2_3348 in
                                                        {2964}let Kcli_3352: bitstring = exp(PartS_3349,Nc_3343) in
                                                        {2965}out(c, senc(mCli(pkCli_3186,pkSess_3340),Kcli_3352))
                                        )
                                        else
                                            {2966}let pkSess_3353: bitstring = fail-any in
                                            {2967}out(c, GetEndpointRequest);
                                            {2968}in(c, (=GetEndpointResponse,=pkSess_3353,=Sign,SP_3354: bitstring,UP_3355: bitstring));
                                            {2969}new Nc_3356: bitstring;
                                            {2970}let gNc_3357: bitstring = exp(g,Nc_3356) in
                                            {2971}let m1_3358: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3357) in
                                            {2972}out(c, (pkCli_3186,m1_3358,sign(h(m1_3358),skCli_3185)));
                                            {2973}in(c, (em2_3359: bitstring,sigM2_3360: bitstring));
                                            {2974}let m2_3361: bitstring = em2_3359 in
                                            {2975}if (verify(h(m2_3361),sigM2_3360,pkSess_3353) <> true) then
                                                0
                                            else
                                                {2976}let (=OpenSecureChannelResponse,PartS_3362: bitstring,ST_3363: bitstring,TTL_3364: bitstring) = m2_3361 in
                                                {2977}let Kcli_3365: bitstring = exp(PartS_3362,Nc_3356) in
                                                {2978}out(c, senc(mCli(pkCli_3186,pkSess_3353),Kcli_3365))
                                )
                                else
                                    {2979}let pkSess_3366: bitstring = fail-any in
                                    {2980}out(c, GetEndpointRequest);
                                    {2981}in(c, (=GetEndpointResponse,=pkSess_3366,=Sign,SP_3367: bitstring,UP_3368: bitstring));
                                    {2982}new Nc_3369: bitstring;
                                    {2983}let gNc_3370: bitstring = exp(g,Nc_3369) in
                                    {2984}let m1_3371: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3370) in
                                    {2985}out(c, (pkCli_3186,m1_3371,sign(h(m1_3371),skCli_3185)));
                                    {2986}in(c, (em2_3372: bitstring,sigM2_3373: bitstring));
                                    {2987}let m2_3374: bitstring = em2_3372 in
                                    {2988}if (verify(h(m2_3374),sigM2_3373,pkSess_3366) <> true) then
                                        0
                                    else
                                        {2989}let (=OpenSecureChannelResponse,PartS_3375: bitstring,ST_3376: bitstring,TTL_3377: bitstring) = m2_3374 in
                                        {2990}let Kcli_3378: bitstring = exp(PartS_3375,Nc_3369) in
                                        {2991}out(c, senc(mCli(pkCli_3186,pkSess_3366),Kcli_3378))
                            )
                            else
                                {2992}let v_3379: bool = (Disco = C) in
                                (
                                    {2993}if v_3379 then
                                    (
                                        {2994}let pkDisco_3380: bitstring = pub(skC) in
                                        {2995}let v_3381: bool = (Sess = A) in
                                        (
                                            {2996}if v_3381 then
                                            (
                                                {2997}let pkSess_3382: bitstring = pub(skA) in
                                                {2998}out(c, GetEndpointRequest);
                                                {2999}in(c, (=GetEndpointResponse,=pkSess_3382,=Sign,SP_3383: bitstring,UP_3384: bitstring));
                                                {3000}new Nc_3385: bitstring;
                                                {3001}let gNc_3386: bitstring = exp(g,Nc_3385) in
                                                {3002}let m1_3387: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3386) in
                                                {3003}out(c, (pkCli_3186,m1_3387,sign(h(m1_3387),skCli_3185)));
                                                {3004}in(c, (em2_3388: bitstring,sigM2_3389: bitstring));
                                                {3005}let m2_3390: bitstring = em2_3388 in
                                                {3006}if (verify(h(m2_3390),sigM2_3389,pkSess_3382) <> true) then
                                                    0
                                                else
                                                    {3007}let (=OpenSecureChannelResponse,PartS_3391: bitstring,ST_3392: bitstring,TTL_3393: bitstring) = m2_3390 in
                                                    {3008}let Kcli_3394: bitstring = exp(PartS_3391,Nc_3385) in
                                                    {3009}out(c, senc(mCli(pkCli_3186,pkSess_3382),Kcli_3394))
                                            )
                                            else
                                                {3010}let v_3395: bool = (Sess = B) in
                                                (
                                                    {3011}if v_3395 then
                                                    (
                                                        {3012}let pkSess_3396: bitstring = pub(skB) in
                                                        {3013}out(c, GetEndpointRequest);
                                                        {3014}in(c, (=GetEndpointResponse,=pkSess_3396,=Sign,SP_3397: bitstring,UP_3398: bitstring));
                                                        {3015}new Nc_3399: bitstring;
                                                        {3016}let gNc_3400: bitstring = exp(g,Nc_3399) in
                                                        {3017}let m1_3401: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3400) in
                                                        {3018}out(c, (pkCli_3186,m1_3401,sign(h(m1_3401),skCli_3185)));
                                                        {3019}in(c, (em2_3402: bitstring,sigM2_3403: bitstring));
                                                        {3020}let m2_3404: bitstring = em2_3402 in
                                                        {3021}if (verify(h(m2_3404),sigM2_3403,pkSess_3396) <> true) then
                                                            0
                                                        else
                                                            {3022}let (=OpenSecureChannelResponse,PartS_3405: bitstring,ST_3406: bitstring,TTL_3407: bitstring) = m2_3404 in
                                                            {3023}let Kcli_3408: bitstring = exp(PartS_3405,Nc_3399) in
                                                            {3024}out(c, senc(mCli(pkCli_3186,pkSess_3396),Kcli_3408))
                                                    )
                                                    else
                                                        {3025}let v_3409: bool = (Sess = C) in
                                                        (
                                                            {3026}if v_3409 then
                                                            (
                                                                {3027}let pkSess_3410: bitstring = pub(skC) in
                                                                {3028}out(c, GetEndpointRequest);
                                                                {3029}in(c, (=GetEndpointResponse,=pkSess_3410,=Sign,SP_3411: bitstring,UP_3412: bitstring));
                                                                {3030}new Nc_3413: bitstring;
                                                                {3031}let gNc_3414: bitstring = exp(g,Nc_3413) in
                                                                {3032}let m1_3415: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3414) in
                                                                {3033}out(c, (pkCli_3186,m1_3415,sign(h(m1_3415),skCli_3185)));
                                                                {3034}in(c, (em2_3416: bitstring,sigM2_3417: bitstring));
                                                                {3035}let m2_3418: bitstring = em2_3416 in
                                                                {3036}if (verify(h(m2_3418),sigM2_3417,pkSess_3410) <> true) then
                                                                    0
                                                                else
                                                                    {3037}let (=OpenSecureChannelResponse,PartS_3419: bitstring,ST_3420: bitstring,TTL_3421: bitstring) = m2_3418 in
                                                                    {3038}let Kcli_3422: bitstring = exp(PartS_3419,Nc_3413) in
                                                                    {3039}out(c, senc(mCli(pkCli_3186,pkSess_3410),Kcli_3422))
                                                            )
                                                            else
                                                                {3040}let pkSess_3423: bitstring = pub(sk(Sess)) in
                                                                {3041}out(c, GetEndpointRequest);
                                                                {3042}in(c, (=GetEndpointResponse,=pkSess_3423,=Sign,SP_3424: bitstring,UP_3425: bitstring));
                                                                {3043}new Nc_3426: bitstring;
                                                                {3044}let gNc_3427: bitstring = exp(g,Nc_3426) in
                                                                {3045}let m1_3428: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3427) in
                                                                {3046}out(c, (pkCli_3186,m1_3428,sign(h(m1_3428),skCli_3185)));
                                                                {3047}in(c, (em2_3429: bitstring,sigM2_3430: bitstring));
                                                                {3048}let m2_3431: bitstring = em2_3429 in
                                                                {3049}if (verify(h(m2_3431),sigM2_3430,pkSess_3423) <> true) then
                                                                    0
                                                                else
                                                                    {3050}let (=OpenSecureChannelResponse,PartS_3432: bitstring,ST_3433: bitstring,TTL_3434: bitstring) = m2_3431 in
                                                                    {3051}let Kcli_3435: bitstring = exp(PartS_3432,Nc_3426) in
                                                                    {3052}out(c, senc(mCli(pkCli_3186,pkSess_3423),Kcli_3435))
                                                        )
                                                        else
                                                            {3053}let pkSess_3436: bitstring = fail-any in
                                                            {3054}out(c, GetEndpointRequest);
                                                            {3055}in(c, (=GetEndpointResponse,=pkSess_3436,=Sign,SP_3437: bitstring,UP_3438: bitstring));
                                                            {3056}new Nc_3439: bitstring;
                                                            {3057}let gNc_3440: bitstring = exp(g,Nc_3439) in
                                                            {3058}let m1_3441: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3440) in
                                                            {3059}out(c, (pkCli_3186,m1_3441,sign(h(m1_3441),skCli_3185)));
                                                            {3060}in(c, (em2_3442: bitstring,sigM2_3443: bitstring));
                                                            {3061}let m2_3444: bitstring = em2_3442 in
                                                            {3062}if (verify(h(m2_3444),sigM2_3443,pkSess_3436) <> true) then
                                                                0
                                                            else
                                                                {3063}let (=OpenSecureChannelResponse,PartS_3445: bitstring,ST_3446: bitstring,TTL_3447: bitstring) = m2_3444 in
                                                                {3064}let Kcli_3448: bitstring = exp(PartS_3445,Nc_3439) in
                                                                {3065}out(c, senc(mCli(pkCli_3186,pkSess_3436),Kcli_3448))
                                                )
                                                else
                                                    {3066}let pkSess_3449: bitstring = fail-any in
                                                    {3067}out(c, GetEndpointRequest);
                                                    {3068}in(c, (=GetEndpointResponse,=pkSess_3449,=Sign,SP_3450: bitstring,UP_3451: bitstring));
                                                    {3069}new Nc_3452: bitstring;
                                                    {3070}let gNc_3453: bitstring = exp(g,Nc_3452) in
                                                    {3071}let m1_3454: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3453) in
                                                    {3072}out(c, (pkCli_3186,m1_3454,sign(h(m1_3454),skCli_3185)));
                                                    {3073}in(c, (em2_3455: bitstring,sigM2_3456: bitstring));
                                                    {3074}let m2_3457: bitstring = em2_3455 in
                                                    {3075}if (verify(h(m2_3457),sigM2_3456,pkSess_3449) <> true) then
                                                        0
                                                    else
                                                        {3076}let (=OpenSecureChannelResponse,PartS_3458: bitstring,ST_3459: bitstring,TTL_3460: bitstring) = m2_3457 in
                                                        {3077}let Kcli_3461: bitstring = exp(PartS_3458,Nc_3452) in
                                                        {3078}out(c, senc(mCli(pkCli_3186,pkSess_3449),Kcli_3461))
                                        )
                                        else
                                            {3079}let pkSess_3462: bitstring = fail-any in
                                            {3080}out(c, GetEndpointRequest);
                                            {3081}in(c, (=GetEndpointResponse,=pkSess_3462,=Sign,SP_3463: bitstring,UP_3464: bitstring));
                                            {3082}new Nc_3465: bitstring;
                                            {3083}let gNc_3466: bitstring = exp(g,Nc_3465) in
                                            {3084}let m1_3467: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3466) in
                                            {3085}out(c, (pkCli_3186,m1_3467,sign(h(m1_3467),skCli_3185)));
                                            {3086}in(c, (em2_3468: bitstring,sigM2_3469: bitstring));
                                            {3087}let m2_3470: bitstring = em2_3468 in
                                            {3088}if (verify(h(m2_3470),sigM2_3469,pkSess_3462) <> true) then
                                                0
                                            else
                                                {3089}let (=OpenSecureChannelResponse,PartS_3471: bitstring,ST_3472: bitstring,TTL_3473: bitstring) = m2_3470 in
                                                {3090}let Kcli_3474: bitstring = exp(PartS_3471,Nc_3465) in
                                                {3091}out(c, senc(mCli(pkCli_3186,pkSess_3462),Kcli_3474))
                                    )
                                    else
                                        {3092}let pkDisco_3475: bitstring = pub(sk(Disco)) in
                                        {3093}let v_3476: bool = (Sess = A) in
                                        (
                                            {3094}if v_3476 then
                                            (
                                                {3095}let pkSess_3477: bitstring = pub(skA) in
                                                {3096}out(c, GetEndpointRequest);
                                                {3097}in(c, (=GetEndpointResponse,=pkSess_3477,=Sign,SP_3478: bitstring,UP_3479: bitstring));
                                                {3098}new Nc_3480: bitstring;
                                                {3099}let gNc_3481: bitstring = exp(g,Nc_3480) in
                                                {3100}let m1_3482: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3481) in
                                                {3101}out(c, (pkCli_3186,m1_3482,sign(h(m1_3482),skCli_3185)));
                                                {3102}in(c, (em2_3483: bitstring,sigM2_3484: bitstring));
                                                {3103}let m2_3485: bitstring = em2_3483 in
                                                {3104}if (verify(h(m2_3485),sigM2_3484,pkSess_3477) <> true) then
                                                    0
                                                else
                                                    {3105}let (=OpenSecureChannelResponse,PartS_3486: bitstring,ST_3487: bitstring,TTL_3488: bitstring) = m2_3485 in
                                                    {3106}let Kcli_3489: bitstring = exp(PartS_3486,Nc_3480) in
                                                    {3107}out(c, senc(mCli(pkCli_3186,pkSess_3477),Kcli_3489))
                                            )
                                            else
                                                {3108}let v_3490: bool = (Sess = B) in
                                                (
                                                    {3109}if v_3490 then
                                                    (
                                                        {3110}let pkSess_3491: bitstring = pub(skB) in
                                                        {3111}out(c, GetEndpointRequest);
                                                        {3112}in(c, (=GetEndpointResponse,=pkSess_3491,=Sign,SP_3492: bitstring,UP_3493: bitstring));
                                                        {3113}new Nc_3494: bitstring;
                                                        {3114}let gNc_3495: bitstring = exp(g,Nc_3494) in
                                                        {3115}let m1_3496: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3495) in
                                                        {3116}out(c, (pkCli_3186,m1_3496,sign(h(m1_3496),skCli_3185)));
                                                        {3117}in(c, (em2_3497: bitstring,sigM2_3498: bitstring));
                                                        {3118}let m2_3499: bitstring = em2_3497 in
                                                        {3119}if (verify(h(m2_3499),sigM2_3498,pkSess_3491) <> true) then
                                                            0
                                                        else
                                                            {3120}let (=OpenSecureChannelResponse,PartS_3500: bitstring,ST_3501: bitstring,TTL_3502: bitstring) = m2_3499 in
                                                            {3121}let Kcli_3503: bitstring = exp(PartS_3500,Nc_3494) in
                                                            {3122}out(c, senc(mCli(pkCli_3186,pkSess_3491),Kcli_3503))
                                                    )
                                                    else
                                                        {3123}let v_3504: bool = (Sess = C) in
                                                        (
                                                            {3124}if v_3504 then
                                                            (
                                                                {3125}let pkSess_3505: bitstring = pub(skC) in
                                                                {3126}out(c, GetEndpointRequest);
                                                                {3127}in(c, (=GetEndpointResponse,=pkSess_3505,=Sign,SP_3506: bitstring,UP_3507: bitstring));
                                                                {3128}new Nc_3508: bitstring;
                                                                {3129}let gNc_3509: bitstring = exp(g,Nc_3508) in
                                                                {3130}let m1_3510: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3509) in
                                                                {3131}out(c, (pkCli_3186,m1_3510,sign(h(m1_3510),skCli_3185)));
                                                                {3132}in(c, (em2_3511: bitstring,sigM2_3512: bitstring));
                                                                {3133}let m2_3513: bitstring = em2_3511 in
                                                                {3134}if (verify(h(m2_3513),sigM2_3512,pkSess_3505) <> true) then
                                                                    0
                                                                else
                                                                    {3135}let (=OpenSecureChannelResponse,PartS_3514: bitstring,ST_3515: bitstring,TTL_3516: bitstring) = m2_3513 in
                                                                    {3136}let Kcli_3517: bitstring = exp(PartS_3514,Nc_3508) in
                                                                    {3137}out(c, senc(mCli(pkCli_3186,pkSess_3505),Kcli_3517))
                                                            )
                                                            else
                                                                {3138}let pkSess_3518: bitstring = pub(sk(Sess)) in
                                                                {3139}out(c, GetEndpointRequest);
                                                                {3140}in(c, (=GetEndpointResponse,=pkSess_3518,=Sign,SP_3519: bitstring,UP_3520: bitstring));
                                                                {3141}new Nc_3521: bitstring;
                                                                {3142}let gNc_3522: bitstring = exp(g,Nc_3521) in
                                                                {3143}let m1_3523: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3522) in
                                                                {3144}out(c, (pkCli_3186,m1_3523,sign(h(m1_3523),skCli_3185)));
                                                                {3145}in(c, (em2_3524: bitstring,sigM2_3525: bitstring));
                                                                {3146}let m2_3526: bitstring = em2_3524 in
                                                                {3147}if (verify(h(m2_3526),sigM2_3525,pkSess_3518) <> true) then
                                                                    0
                                                                else
                                                                    {3148}let (=OpenSecureChannelResponse,PartS_3527: bitstring,ST_3528: bitstring,TTL_3529: bitstring) = m2_3526 in
                                                                    {3149}let Kcli_3530: bitstring = exp(PartS_3527,Nc_3521) in
                                                                    {3150}out(c, senc(mCli(pkCli_3186,pkSess_3518),Kcli_3530))
                                                        )
                                                        else
                                                            {3151}let pkSess_3531: bitstring = fail-any in
                                                            {3152}out(c, GetEndpointRequest);
                                                            {3153}in(c, (=GetEndpointResponse,=pkSess_3531,=Sign,SP_3532: bitstring,UP_3533: bitstring));
                                                            {3154}new Nc_3534: bitstring;
                                                            {3155}let gNc_3535: bitstring = exp(g,Nc_3534) in
                                                            {3156}let m1_3536: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3535) in
                                                            {3157}out(c, (pkCli_3186,m1_3536,sign(h(m1_3536),skCli_3185)));
                                                            {3158}in(c, (em2_3537: bitstring,sigM2_3538: bitstring));
                                                            {3159}let m2_3539: bitstring = em2_3537 in
                                                            {3160}if (verify(h(m2_3539),sigM2_3538,pkSess_3531) <> true) then
                                                                0
                                                            else
                                                                {3161}let (=OpenSecureChannelResponse,PartS_3540: bitstring,ST_3541: bitstring,TTL_3542: bitstring) = m2_3539 in
                                                                {3162}let Kcli_3543: bitstring = exp(PartS_3540,Nc_3534) in
                                                                {3163}out(c, senc(mCli(pkCli_3186,pkSess_3531),Kcli_3543))
                                                )
                                                else
                                                    {3164}let pkSess_3544: bitstring = fail-any in
                                                    {3165}out(c, GetEndpointRequest);
                                                    {3166}in(c, (=GetEndpointResponse,=pkSess_3544,=Sign,SP_3545: bitstring,UP_3546: bitstring));
                                                    {3167}new Nc_3547: bitstring;
                                                    {3168}let gNc_3548: bitstring = exp(g,Nc_3547) in
                                                    {3169}let m1_3549: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3548) in
                                                    {3170}out(c, (pkCli_3186,m1_3549,sign(h(m1_3549),skCli_3185)));
                                                    {3171}in(c, (em2_3550: bitstring,sigM2_3551: bitstring));
                                                    {3172}let m2_3552: bitstring = em2_3550 in
                                                    {3173}if (verify(h(m2_3552),sigM2_3551,pkSess_3544) <> true) then
                                                        0
                                                    else
                                                        {3174}let (=OpenSecureChannelResponse,PartS_3553: bitstring,ST_3554: bitstring,TTL_3555: bitstring) = m2_3552 in
                                                        {3175}let Kcli_3556: bitstring = exp(PartS_3553,Nc_3547) in
                                                        {3176}out(c, senc(mCli(pkCli_3186,pkSess_3544),Kcli_3556))
                                        )
                                        else
                                            {3177}let pkSess_3557: bitstring = fail-any in
                                            {3178}out(c, GetEndpointRequest);
                                            {3179}in(c, (=GetEndpointResponse,=pkSess_3557,=Sign,SP_3558: bitstring,UP_3559: bitstring));
                                            {3180}new Nc_3560: bitstring;
                                            {3181}let gNc_3561: bitstring = exp(g,Nc_3560) in
                                            {3182}let m1_3562: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3561) in
                                            {3183}out(c, (pkCli_3186,m1_3562,sign(h(m1_3562),skCli_3185)));
                                            {3184}in(c, (em2_3563: bitstring,sigM2_3564: bitstring));
                                            {3185}let m2_3565: bitstring = em2_3563 in
                                            {3186}if (verify(h(m2_3565),sigM2_3564,pkSess_3557) <> true) then
                                                0
                                            else
                                                {3187}let (=OpenSecureChannelResponse,PartS_3566: bitstring,ST_3567: bitstring,TTL_3568: bitstring) = m2_3565 in
                                                {3188}let Kcli_3569: bitstring = exp(PartS_3566,Nc_3560) in
                                                {3189}out(c, senc(mCli(pkCli_3186,pkSess_3557),Kcli_3569))
                                )
                                else
                                    {3190}let pkDisco_3570: bitstring = fail-any in
                                    {3191}let v_3571: bool = (Sess = A) in
                                    (
                                        {3192}if v_3571 then
                                        (
                                            {3193}let pkSess_3572: bitstring = pub(skA) in
                                            {3194}out(c, GetEndpointRequest);
                                            {3195}in(c, (=GetEndpointResponse,=pkSess_3572,=Sign,SP_3573: bitstring,UP_3574: bitstring));
                                            {3196}new Nc_3575: bitstring;
                                            {3197}let gNc_3576: bitstring = exp(g,Nc_3575) in
                                            {3198}let m1_3577: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3576) in
                                            {3199}out(c, (pkCli_3186,m1_3577,sign(h(m1_3577),skCli_3185)));
                                            {3200}in(c, (em2_3578: bitstring,sigM2_3579: bitstring));
                                            {3201}let m2_3580: bitstring = em2_3578 in
                                            {3202}if (verify(h(m2_3580),sigM2_3579,pkSess_3572) <> true) then
                                                0
                                            else
                                                {3203}let (=OpenSecureChannelResponse,PartS_3581: bitstring,ST_3582: bitstring,TTL_3583: bitstring) = m2_3580 in
                                                {3204}let Kcli_3584: bitstring = exp(PartS_3581,Nc_3575) in
                                                {3205}out(c, senc(mCli(pkCli_3186,pkSess_3572),Kcli_3584))
                                        )
                                        else
                                            {3206}let v_3585: bool = (Sess = B) in
                                            (
                                                {3207}if v_3585 then
                                                (
                                                    {3208}let pkSess_3586: bitstring = pub(skB) in
                                                    {3209}out(c, GetEndpointRequest);
                                                    {3210}in(c, (=GetEndpointResponse,=pkSess_3586,=Sign,SP_3587: bitstring,UP_3588: bitstring));
                                                    {3211}new Nc_3589: bitstring;
                                                    {3212}let gNc_3590: bitstring = exp(g,Nc_3589) in
                                                    {3213}let m1_3591: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3590) in
                                                    {3214}out(c, (pkCli_3186,m1_3591,sign(h(m1_3591),skCli_3185)));
                                                    {3215}in(c, (em2_3592: bitstring,sigM2_3593: bitstring));
                                                    {3216}let m2_3594: bitstring = em2_3592 in
                                                    {3217}if (verify(h(m2_3594),sigM2_3593,pkSess_3586) <> true) then
                                                        0
                                                    else
                                                        {3218}let (=OpenSecureChannelResponse,PartS_3595: bitstring,ST_3596: bitstring,TTL_3597: bitstring) = m2_3594 in
                                                        {3219}let Kcli_3598: bitstring = exp(PartS_3595,Nc_3589) in
                                                        {3220}out(c, senc(mCli(pkCli_3186,pkSess_3586),Kcli_3598))
                                                )
                                                else
                                                    {3221}let v_3599: bool = (Sess = C) in
                                                    (
                                                        {3222}if v_3599 then
                                                        (
                                                            {3223}let pkSess_3600: bitstring = pub(skC) in
                                                            {3224}out(c, GetEndpointRequest);
                                                            {3225}in(c, (=GetEndpointResponse,=pkSess_3600,=Sign,SP_3601: bitstring,UP_3602: bitstring));
                                                            {3226}new Nc_3603: bitstring;
                                                            {3227}let gNc_3604: bitstring = exp(g,Nc_3603) in
                                                            {3228}let m1_3605: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3604) in
                                                            {3229}out(c, (pkCli_3186,m1_3605,sign(h(m1_3605),skCli_3185)));
                                                            {3230}in(c, (em2_3606: bitstring,sigM2_3607: bitstring));
                                                            {3231}let m2_3608: bitstring = em2_3606 in
                                                            {3232}if (verify(h(m2_3608),sigM2_3607,pkSess_3600) <> true) then
                                                                0
                                                            else
                                                                {3233}let (=OpenSecureChannelResponse,PartS_3609: bitstring,ST_3610: bitstring,TTL_3611: bitstring) = m2_3608 in
                                                                {3234}let Kcli_3612: bitstring = exp(PartS_3609,Nc_3603) in
                                                                {3235}out(c, senc(mCli(pkCli_3186,pkSess_3600),Kcli_3612))
                                                        )
                                                        else
                                                            {3236}let pkSess_3613: bitstring = pub(sk(Sess)) in
                                                            {3237}out(c, GetEndpointRequest);
                                                            {3238}in(c, (=GetEndpointResponse,=pkSess_3613,=Sign,SP_3614: bitstring,UP_3615: bitstring));
                                                            {3239}new Nc_3616: bitstring;
                                                            {3240}let gNc_3617: bitstring = exp(g,Nc_3616) in
                                                            {3241}let m1_3618: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3617) in
                                                            {3242}out(c, (pkCli_3186,m1_3618,sign(h(m1_3618),skCli_3185)));
                                                            {3243}in(c, (em2_3619: bitstring,sigM2_3620: bitstring));
                                                            {3244}let m2_3621: bitstring = em2_3619 in
                                                            {3245}if (verify(h(m2_3621),sigM2_3620,pkSess_3613) <> true) then
                                                                0
                                                            else
                                                                {3246}let (=OpenSecureChannelResponse,PartS_3622: bitstring,ST_3623: bitstring,TTL_3624: bitstring) = m2_3621 in
                                                                {3247}let Kcli_3625: bitstring = exp(PartS_3622,Nc_3616) in
                                                                {3248}out(c, senc(mCli(pkCli_3186,pkSess_3613),Kcli_3625))
                                                    )
                                                    else
                                                        {3249}let pkSess_3626: bitstring = fail-any in
                                                        {3250}out(c, GetEndpointRequest);
                                                        {3251}in(c, (=GetEndpointResponse,=pkSess_3626,=Sign,SP_3627: bitstring,UP_3628: bitstring));
                                                        {3252}new Nc_3629: bitstring;
                                                        {3253}let gNc_3630: bitstring = exp(g,Nc_3629) in
                                                        {3254}let m1_3631: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3630) in
                                                        {3255}out(c, (pkCli_3186,m1_3631,sign(h(m1_3631),skCli_3185)));
                                                        {3256}in(c, (em2_3632: bitstring,sigM2_3633: bitstring));
                                                        {3257}let m2_3634: bitstring = em2_3632 in
                                                        {3258}if (verify(h(m2_3634),sigM2_3633,pkSess_3626) <> true) then
                                                            0
                                                        else
                                                            {3259}let (=OpenSecureChannelResponse,PartS_3635: bitstring,ST_3636: bitstring,TTL_3637: bitstring) = m2_3634 in
                                                            {3260}let Kcli_3638: bitstring = exp(PartS_3635,Nc_3629) in
                                                            {3261}out(c, senc(mCli(pkCli_3186,pkSess_3626),Kcli_3638))
                                            )
                                            else
                                                {3262}let pkSess_3639: bitstring = fail-any in
                                                {3263}out(c, GetEndpointRequest);
                                                {3264}in(c, (=GetEndpointResponse,=pkSess_3639,=Sign,SP_3640: bitstring,UP_3641: bitstring));
                                                {3265}new Nc_3642: bitstring;
                                                {3266}let gNc_3643: bitstring = exp(g,Nc_3642) in
                                                {3267}let m1_3644: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3643) in
                                                {3268}out(c, (pkCli_3186,m1_3644,sign(h(m1_3644),skCli_3185)));
                                                {3269}in(c, (em2_3645: bitstring,sigM2_3646: bitstring));
                                                {3270}let m2_3647: bitstring = em2_3645 in
                                                {3271}if (verify(h(m2_3647),sigM2_3646,pkSess_3639) <> true) then
                                                    0
                                                else
                                                    {3272}let (=OpenSecureChannelResponse,PartS_3648: bitstring,ST_3649: bitstring,TTL_3650: bitstring) = m2_3647 in
                                                    {3273}let Kcli_3651: bitstring = exp(PartS_3648,Nc_3642) in
                                                    {3274}out(c, senc(mCli(pkCli_3186,pkSess_3639),Kcli_3651))
                                    )
                                    else
                                        {3275}let pkSess_3652: bitstring = fail-any in
                                        {3276}out(c, GetEndpointRequest);
                                        {3277}in(c, (=GetEndpointResponse,=pkSess_3652,=Sign,SP_3653: bitstring,UP_3654: bitstring));
                                        {3278}new Nc_3655: bitstring;
                                        {3279}let gNc_3656: bitstring = exp(g,Nc_3655) in
                                        {3280}let m1_3657: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3656) in
                                        {3281}out(c, (pkCli_3186,m1_3657,sign(h(m1_3657),skCli_3185)));
                                        {3282}in(c, (em2_3658: bitstring,sigM2_3659: bitstring));
                                        {3283}let m2_3660: bitstring = em2_3658 in
                                        {3284}if (verify(h(m2_3660),sigM2_3659,pkSess_3652) <> true) then
                                            0
                                        else
                                            {3285}let (=OpenSecureChannelResponse,PartS_3661: bitstring,ST_3662: bitstring,TTL_3663: bitstring) = m2_3660 in
                                            {3286}let Kcli_3664: bitstring = exp(PartS_3661,Nc_3655) in
                                            {3287}out(c, senc(mCli(pkCli_3186,pkSess_3652),Kcli_3664))
                        )
                        else
                            {3288}let pkDisco_3665: bitstring = fail-any in
                            {3289}let v_3666: bool = (Sess = A) in
                            (
                                {3290}if v_3666 then
                                (
                                    {3291}let pkSess_3667: bitstring = pub(skA) in
                                    {3292}out(c, GetEndpointRequest);
                                    {3293}in(c, (=GetEndpointResponse,=pkSess_3667,=Sign,SP_3668: bitstring,UP_3669: bitstring));
                                    {3294}new Nc_3670: bitstring;
                                    {3295}let gNc_3671: bitstring = exp(g,Nc_3670) in
                                    {3296}let m1_3672: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3671) in
                                    {3297}out(c, (pkCli_3186,m1_3672,sign(h(m1_3672),skCli_3185)));
                                    {3298}in(c, (em2_3673: bitstring,sigM2_3674: bitstring));
                                    {3299}let m2_3675: bitstring = em2_3673 in
                                    {3300}if (verify(h(m2_3675),sigM2_3674,pkSess_3667) <> true) then
                                        0
                                    else
                                        {3301}let (=OpenSecureChannelResponse,PartS_3676: bitstring,ST_3677: bitstring,TTL_3678: bitstring) = m2_3675 in
                                        {3302}let Kcli_3679: bitstring = exp(PartS_3676,Nc_3670) in
                                        {3303}out(c, senc(mCli(pkCli_3186,pkSess_3667),Kcli_3679))
                                )
                                else
                                    {3304}let v_3680: bool = (Sess = B) in
                                    (
                                        {3305}if v_3680 then
                                        (
                                            {3306}let pkSess_3681: bitstring = pub(skB) in
                                            {3307}out(c, GetEndpointRequest);
                                            {3308}in(c, (=GetEndpointResponse,=pkSess_3681,=Sign,SP_3682: bitstring,UP_3683: bitstring));
                                            {3309}new Nc_3684: bitstring;
                                            {3310}let gNc_3685: bitstring = exp(g,Nc_3684) in
                                            {3311}let m1_3686: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3685) in
                                            {3312}out(c, (pkCli_3186,m1_3686,sign(h(m1_3686),skCli_3185)));
                                            {3313}in(c, (em2_3687: bitstring,sigM2_3688: bitstring));
                                            {3314}let m2_3689: bitstring = em2_3687 in
                                            {3315}if (verify(h(m2_3689),sigM2_3688,pkSess_3681) <> true) then
                                                0
                                            else
                                                {3316}let (=OpenSecureChannelResponse,PartS_3690: bitstring,ST_3691: bitstring,TTL_3692: bitstring) = m2_3689 in
                                                {3317}let Kcli_3693: bitstring = exp(PartS_3690,Nc_3684) in
                                                {3318}out(c, senc(mCli(pkCli_3186,pkSess_3681),Kcli_3693))
                                        )
                                        else
                                            {3319}let v_3694: bool = (Sess = C) in
                                            (
                                                {3320}if v_3694 then
                                                (
                                                    {3321}let pkSess_3695: bitstring = pub(skC) in
                                                    {3322}out(c, GetEndpointRequest);
                                                    {3323}in(c, (=GetEndpointResponse,=pkSess_3695,=Sign,SP_3696: bitstring,UP_3697: bitstring));
                                                    {3324}new Nc_3698: bitstring;
                                                    {3325}let gNc_3699: bitstring = exp(g,Nc_3698) in
                                                    {3326}let m1_3700: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3699) in
                                                    {3327}out(c, (pkCli_3186,m1_3700,sign(h(m1_3700),skCli_3185)));
                                                    {3328}in(c, (em2_3701: bitstring,sigM2_3702: bitstring));
                                                    {3329}let m2_3703: bitstring = em2_3701 in
                                                    {3330}if (verify(h(m2_3703),sigM2_3702,pkSess_3695) <> true) then
                                                        0
                                                    else
                                                        {3331}let (=OpenSecureChannelResponse,PartS_3704: bitstring,ST_3705: bitstring,TTL_3706: bitstring) = m2_3703 in
                                                        {3332}let Kcli_3707: bitstring = exp(PartS_3704,Nc_3698) in
                                                        {3333}out(c, senc(mCli(pkCli_3186,pkSess_3695),Kcli_3707))
                                                )
                                                else
                                                    {3334}let pkSess_3708: bitstring = pub(sk(Sess)) in
                                                    {3335}out(c, GetEndpointRequest);
                                                    {3336}in(c, (=GetEndpointResponse,=pkSess_3708,=Sign,SP_3709: bitstring,UP_3710: bitstring));
                                                    {3337}new Nc_3711: bitstring;
                                                    {3338}let gNc_3712: bitstring = exp(g,Nc_3711) in
                                                    {3339}let m1_3713: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3712) in
                                                    {3340}out(c, (pkCli_3186,m1_3713,sign(h(m1_3713),skCli_3185)));
                                                    {3341}in(c, (em2_3714: bitstring,sigM2_3715: bitstring));
                                                    {3342}let m2_3716: bitstring = em2_3714 in
                                                    {3343}if (verify(h(m2_3716),sigM2_3715,pkSess_3708) <> true) then
                                                        0
                                                    else
                                                        {3344}let (=OpenSecureChannelResponse,PartS_3717: bitstring,ST_3718: bitstring,TTL_3719: bitstring) = m2_3716 in
                                                        {3345}let Kcli_3720: bitstring = exp(PartS_3717,Nc_3711) in
                                                        {3346}out(c, senc(mCli(pkCli_3186,pkSess_3708),Kcli_3720))
                                            )
                                            else
                                                {3347}let pkSess_3721: bitstring = fail-any in
                                                {3348}out(c, GetEndpointRequest);
                                                {3349}in(c, (=GetEndpointResponse,=pkSess_3721,=Sign,SP_3722: bitstring,UP_3723: bitstring));
                                                {3350}new Nc_3724: bitstring;
                                                {3351}let gNc_3725: bitstring = exp(g,Nc_3724) in
                                                {3352}let m1_3726: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3725) in
                                                {3353}out(c, (pkCli_3186,m1_3726,sign(h(m1_3726),skCli_3185)));
                                                {3354}in(c, (em2_3727: bitstring,sigM2_3728: bitstring));
                                                {3355}let m2_3729: bitstring = em2_3727 in
                                                {3356}if (verify(h(m2_3729),sigM2_3728,pkSess_3721) <> true) then
                                                    0
                                                else
                                                    {3357}let (=OpenSecureChannelResponse,PartS_3730: bitstring,ST_3731: bitstring,TTL_3732: bitstring) = m2_3729 in
                                                    {3358}let Kcli_3733: bitstring = exp(PartS_3730,Nc_3724) in
                                                    {3359}out(c, senc(mCli(pkCli_3186,pkSess_3721),Kcli_3733))
                                    )
                                    else
                                        {3360}let pkSess_3734: bitstring = fail-any in
                                        {3361}out(c, GetEndpointRequest);
                                        {3362}in(c, (=GetEndpointResponse,=pkSess_3734,=Sign,SP_3735: bitstring,UP_3736: bitstring));
                                        {3363}new Nc_3737: bitstring;
                                        {3364}let gNc_3738: bitstring = exp(g,Nc_3737) in
                                        {3365}let m1_3739: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3738) in
                                        {3366}out(c, (pkCli_3186,m1_3739,sign(h(m1_3739),skCli_3185)));
                                        {3367}in(c, (em2_3740: bitstring,sigM2_3741: bitstring));
                                        {3368}let m2_3742: bitstring = em2_3740 in
                                        {3369}if (verify(h(m2_3742),sigM2_3741,pkSess_3734) <> true) then
                                            0
                                        else
                                            {3370}let (=OpenSecureChannelResponse,PartS_3743: bitstring,ST_3744: bitstring,TTL_3745: bitstring) = m2_3742 in
                                            {3371}let Kcli_3746: bitstring = exp(PartS_3743,Nc_3737) in
                                            {3372}out(c, senc(mCli(pkCli_3186,pkSess_3734),Kcli_3746))
                            )
                            else
                                {3373}let pkSess_3747: bitstring = fail-any in
                                {3374}out(c, GetEndpointRequest);
                                {3375}in(c, (=GetEndpointResponse,=pkSess_3747,=Sign,SP_3748: bitstring,UP_3749: bitstring));
                                {3376}new Nc_3750: bitstring;
                                {3377}let gNc_3751: bitstring = exp(g,Nc_3750) in
                                {3378}let m1_3752: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3751) in
                                {3379}out(c, (pkCli_3186,m1_3752,sign(h(m1_3752),skCli_3185)));
                                {3380}in(c, (em2_3753: bitstring,sigM2_3754: bitstring));
                                {3381}let m2_3755: bitstring = em2_3753 in
                                {3382}if (verify(h(m2_3755),sigM2_3754,pkSess_3747) <> true) then
                                    0
                                else
                                    {3383}let (=OpenSecureChannelResponse,PartS_3756: bitstring,ST_3757: bitstring,TTL_3758: bitstring) = m2_3755 in
                                    {3384}let Kcli_3759: bitstring = exp(PartS_3756,Nc_3750) in
                                    {3385}out(c, senc(mCli(pkCli_3186,pkSess_3747),Kcli_3759))
                )
                else
                    {3386}let pkDisco_3760: bitstring = fail-any in
                    {3387}let v_3761: bool = (Sess = A) in
                    (
                        {3388}if v_3761 then
                        (
                            {3389}let pkSess_3762: bitstring = pub(skA) in
                            {3390}out(c, GetEndpointRequest);
                            {3391}in(c, (=GetEndpointResponse,=pkSess_3762,=Sign,SP_3763: bitstring,UP_3764: bitstring));
                            {3392}new Nc_3765: bitstring;
                            {3393}let gNc_3766: bitstring = exp(g,Nc_3765) in
                            {3394}let m1_3767: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3766) in
                            {3395}out(c, (pkCli_3186,m1_3767,sign(h(m1_3767),skCli_3185)));
                            {3396}in(c, (em2_3768: bitstring,sigM2_3769: bitstring));
                            {3397}let m2_3770: bitstring = em2_3768 in
                            {3398}if (verify(h(m2_3770),sigM2_3769,pkSess_3762) <> true) then
                                0
                            else
                                {3399}let (=OpenSecureChannelResponse,PartS_3771: bitstring,ST_3772: bitstring,TTL_3773: bitstring) = m2_3770 in
                                {3400}let Kcli_3774: bitstring = exp(PartS_3771,Nc_3765) in
                                {3401}out(c, senc(mCli(pkCli_3186,pkSess_3762),Kcli_3774))
                        )
                        else
                            {3402}let v_3775: bool = (Sess = B) in
                            (
                                {3403}if v_3775 then
                                (
                                    {3404}let pkSess_3776: bitstring = pub(skB) in
                                    {3405}out(c, GetEndpointRequest);
                                    {3406}in(c, (=GetEndpointResponse,=pkSess_3776,=Sign,SP_3777: bitstring,UP_3778: bitstring));
                                    {3407}new Nc_3779: bitstring;
                                    {3408}let gNc_3780: bitstring = exp(g,Nc_3779) in
                                    {3409}let m1_3781: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3780) in
                                    {3410}out(c, (pkCli_3186,m1_3781,sign(h(m1_3781),skCli_3185)));
                                    {3411}in(c, (em2_3782: bitstring,sigM2_3783: bitstring));
                                    {3412}let m2_3784: bitstring = em2_3782 in
                                    {3413}if (verify(h(m2_3784),sigM2_3783,pkSess_3776) <> true) then
                                        0
                                    else
                                        {3414}let (=OpenSecureChannelResponse,PartS_3785: bitstring,ST_3786: bitstring,TTL_3787: bitstring) = m2_3784 in
                                        {3415}let Kcli_3788: bitstring = exp(PartS_3785,Nc_3779) in
                                        {3416}out(c, senc(mCli(pkCli_3186,pkSess_3776),Kcli_3788))
                                )
                                else
                                    {3417}let v_3789: bool = (Sess = C) in
                                    (
                                        {3418}if v_3789 then
                                        (
                                            {3419}let pkSess_3790: bitstring = pub(skC) in
                                            {3420}out(c, GetEndpointRequest);
                                            {3421}in(c, (=GetEndpointResponse,=pkSess_3790,=Sign,SP_3791: bitstring,UP_3792: bitstring));
                                            {3422}new Nc_3793: bitstring;
                                            {3423}let gNc_3794: bitstring = exp(g,Nc_3793) in
                                            {3424}let m1_3795: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3794) in
                                            {3425}out(c, (pkCli_3186,m1_3795,sign(h(m1_3795),skCli_3185)));
                                            {3426}in(c, (em2_3796: bitstring,sigM2_3797: bitstring));
                                            {3427}let m2_3798: bitstring = em2_3796 in
                                            {3428}if (verify(h(m2_3798),sigM2_3797,pkSess_3790) <> true) then
                                                0
                                            else
                                                {3429}let (=OpenSecureChannelResponse,PartS_3799: bitstring,ST_3800: bitstring,TTL_3801: bitstring) = m2_3798 in
                                                {3430}let Kcli_3802: bitstring = exp(PartS_3799,Nc_3793) in
                                                {3431}out(c, senc(mCli(pkCli_3186,pkSess_3790),Kcli_3802))
                                        )
                                        else
                                            {3432}let pkSess_3803: bitstring = pub(sk(Sess)) in
                                            {3433}out(c, GetEndpointRequest);
                                            {3434}in(c, (=GetEndpointResponse,=pkSess_3803,=Sign,SP_3804: bitstring,UP_3805: bitstring));
                                            {3435}new Nc_3806: bitstring;
                                            {3436}let gNc_3807: bitstring = exp(g,Nc_3806) in
                                            {3437}let m1_3808: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3807) in
                                            {3438}out(c, (pkCli_3186,m1_3808,sign(h(m1_3808),skCli_3185)));
                                            {3439}in(c, (em2_3809: bitstring,sigM2_3810: bitstring));
                                            {3440}let m2_3811: bitstring = em2_3809 in
                                            {3441}if (verify(h(m2_3811),sigM2_3810,pkSess_3803) <> true) then
                                                0
                                            else
                                                {3442}let (=OpenSecureChannelResponse,PartS_3812: bitstring,ST_3813: bitstring,TTL_3814: bitstring) = m2_3811 in
                                                {3443}let Kcli_3815: bitstring = exp(PartS_3812,Nc_3806) in
                                                {3444}out(c, senc(mCli(pkCli_3186,pkSess_3803),Kcli_3815))
                                    )
                                    else
                                        {3445}let pkSess_3816: bitstring = fail-any in
                                        {3446}out(c, GetEndpointRequest);
                                        {3447}in(c, (=GetEndpointResponse,=pkSess_3816,=Sign,SP_3817: bitstring,UP_3818: bitstring));
                                        {3448}new Nc_3819: bitstring;
                                        {3449}let gNc_3820: bitstring = exp(g,Nc_3819) in
                                        {3450}let m1_3821: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3820) in
                                        {3451}out(c, (pkCli_3186,m1_3821,sign(h(m1_3821),skCli_3185)));
                                        {3452}in(c, (em2_3822: bitstring,sigM2_3823: bitstring));
                                        {3453}let m2_3824: bitstring = em2_3822 in
                                        {3454}if (verify(h(m2_3824),sigM2_3823,pkSess_3816) <> true) then
                                            0
                                        else
                                            {3455}let (=OpenSecureChannelResponse,PartS_3825: bitstring,ST_3826: bitstring,TTL_3827: bitstring) = m2_3824 in
                                            {3456}let Kcli_3828: bitstring = exp(PartS_3825,Nc_3819) in
                                            {3457}out(c, senc(mCli(pkCli_3186,pkSess_3816),Kcli_3828))
                            )
                            else
                                {3458}let pkSess_3829: bitstring = fail-any in
                                {3459}out(c, GetEndpointRequest);
                                {3460}in(c, (=GetEndpointResponse,=pkSess_3829,=Sign,SP_3830: bitstring,UP_3831: bitstring));
                                {3461}new Nc_3832: bitstring;
                                {3462}let gNc_3833: bitstring = exp(g,Nc_3832) in
                                {3463}let m1_3834: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3833) in
                                {3464}out(c, (pkCli_3186,m1_3834,sign(h(m1_3834),skCli_3185)));
                                {3465}in(c, (em2_3835: bitstring,sigM2_3836: bitstring));
                                {3466}let m2_3837: bitstring = em2_3835 in
                                {3467}if (verify(h(m2_3837),sigM2_3836,pkSess_3829) <> true) then
                                    0
                                else
                                    {3468}let (=OpenSecureChannelResponse,PartS_3838: bitstring,ST_3839: bitstring,TTL_3840: bitstring) = m2_3837 in
                                    {3469}let Kcli_3841: bitstring = exp(PartS_3838,Nc_3832) in
                                    {3470}out(c, senc(mCli(pkCli_3186,pkSess_3829),Kcli_3841))
                    )
                    else
                        {3471}let pkSess_3842: bitstring = fail-any in
                        {3472}out(c, GetEndpointRequest);
                        {3473}in(c, (=GetEndpointResponse,=pkSess_3842,=Sign,SP_3843: bitstring,UP_3844: bitstring));
                        {3474}new Nc_3845: bitstring;
                        {3475}let gNc_3846: bitstring = exp(g,Nc_3845) in
                        {3476}let m1_3847: bitstring = (OpenSecureChannelRequest,pkCli_3186,gNc_3846) in
                        {3477}out(c, (pkCli_3186,m1_3847,sign(h(m1_3847),skCli_3185)));
                        {3478}in(c, (em2_3848: bitstring,sigM2_3849: bitstring));
                        {3479}let m2_3850: bitstring = em2_3848 in
                        {3480}if (verify(h(m2_3850),sigM2_3849,pkSess_3842) <> true) then
                            0
                        else
                            {3481}let (=OpenSecureChannelResponse,PartS_3851: bitstring,ST_3852: bitstring,TTL_3853: bitstring) = m2_3850 in
                            {3482}let Kcli_3854: bitstring = exp(PartS_3851,Nc_3845) in
                            {3483}out(c, senc(mCli(pkCli_3186,pkSess_3842),Kcli_3854))
    )
    else
        {3484}let skCli_3855: bitstring = fail-any in
        {3485}let pkCli_3856: bitstring = pub(skCli_3855) in
        {3486}let v_3857: bool = (Disco = A) in
        (
            {3487}if v_3857 then
            (
                {3488}let pkDisco_3858: bitstring = pub(skA) in
                {3489}let v_3859: bool = (Sess = A) in
                (
                    {3490}if v_3859 then
                    (
                        {3491}let pkSess_3860: bitstring = pub(skA) in
                        {3492}out(c, GetEndpointRequest);
                        {3493}in(c, (=GetEndpointResponse,=pkSess_3860,=Sign,SP_3861: bitstring,UP_3862: bitstring));
                        {3494}new Nc_3863: bitstring;
                        {3495}let gNc_3864: bitstring = exp(g,Nc_3863) in
                        {3496}let m1_3865: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3864) in
                        {3497}out(c, (pkCli_3856,m1_3865,sign(h(m1_3865),skCli_3855)));
                        {3498}in(c, (em2_3866: bitstring,sigM2_3867: bitstring));
                        {3499}let m2_3868: bitstring = em2_3866 in
                        {3500}if (verify(h(m2_3868),sigM2_3867,pkSess_3860) <> true) then
                            0
                        else
                            {3501}let (=OpenSecureChannelResponse,PartS_3869: bitstring,ST_3870: bitstring,TTL_3871: bitstring) = m2_3868 in
                            {3502}let Kcli_3872: bitstring = exp(PartS_3869,Nc_3863) in
                            {3503}out(c, senc(mCli(pkCli_3856,pkSess_3860),Kcli_3872))
                    )
                    else
                        {3504}let v_3873: bool = (Sess = B) in
                        (
                            {3505}if v_3873 then
                            (
                                {3506}let pkSess_3874: bitstring = pub(skB) in
                                {3507}out(c, GetEndpointRequest);
                                {3508}in(c, (=GetEndpointResponse,=pkSess_3874,=Sign,SP_3875: bitstring,UP_3876: bitstring));
                                {3509}new Nc_3877: bitstring;
                                {3510}let gNc_3878: bitstring = exp(g,Nc_3877) in
                                {3511}let m1_3879: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3878) in
                                {3512}out(c, (pkCli_3856,m1_3879,sign(h(m1_3879),skCli_3855)));
                                {3513}in(c, (em2_3880: bitstring,sigM2_3881: bitstring));
                                {3514}let m2_3882: bitstring = em2_3880 in
                                {3515}if (verify(h(m2_3882),sigM2_3881,pkSess_3874) <> true) then
                                    0
                                else
                                    {3516}let (=OpenSecureChannelResponse,PartS_3883: bitstring,ST_3884: bitstring,TTL_3885: bitstring) = m2_3882 in
                                    {3517}let Kcli_3886: bitstring = exp(PartS_3883,Nc_3877) in
                                    {3518}out(c, senc(mCli(pkCli_3856,pkSess_3874),Kcli_3886))
                            )
                            else
                                {3519}let v_3887: bool = (Sess = C) in
                                (
                                    {3520}if v_3887 then
                                    (
                                        {3521}let pkSess_3888: bitstring = pub(skC) in
                                        {3522}out(c, GetEndpointRequest);
                                        {3523}in(c, (=GetEndpointResponse,=pkSess_3888,=Sign,SP_3889: bitstring,UP_3890: bitstring));
                                        {3524}new Nc_3891: bitstring;
                                        {3525}let gNc_3892: bitstring = exp(g,Nc_3891) in
                                        {3526}let m1_3893: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3892) in
                                        {3527}out(c, (pkCli_3856,m1_3893,sign(h(m1_3893),skCli_3855)));
                                        {3528}in(c, (em2_3894: bitstring,sigM2_3895: bitstring));
                                        {3529}let m2_3896: bitstring = em2_3894 in
                                        {3530}if (verify(h(m2_3896),sigM2_3895,pkSess_3888) <> true) then
                                            0
                                        else
                                            {3531}let (=OpenSecureChannelResponse,PartS_3897: bitstring,ST_3898: bitstring,TTL_3899: bitstring) = m2_3896 in
                                            {3532}let Kcli_3900: bitstring = exp(PartS_3897,Nc_3891) in
                                            {3533}out(c, senc(mCli(pkCli_3856,pkSess_3888),Kcli_3900))
                                    )
                                    else
                                        {3534}let pkSess_3901: bitstring = pub(sk(Sess)) in
                                        {3535}out(c, GetEndpointRequest);
                                        {3536}in(c, (=GetEndpointResponse,=pkSess_3901,=Sign,SP_3902: bitstring,UP_3903: bitstring));
                                        {3537}new Nc_3904: bitstring;
                                        {3538}let gNc_3905: bitstring = exp(g,Nc_3904) in
                                        {3539}let m1_3906: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3905) in
                                        {3540}out(c, (pkCli_3856,m1_3906,sign(h(m1_3906),skCli_3855)));
                                        {3541}in(c, (em2_3907: bitstring,sigM2_3908: bitstring));
                                        {3542}let m2_3909: bitstring = em2_3907 in
                                        {3543}if (verify(h(m2_3909),sigM2_3908,pkSess_3901) <> true) then
                                            0
                                        else
                                            {3544}let (=OpenSecureChannelResponse,PartS_3910: bitstring,ST_3911: bitstring,TTL_3912: bitstring) = m2_3909 in
                                            {3545}let Kcli_3913: bitstring = exp(PartS_3910,Nc_3904) in
                                            {3546}out(c, senc(mCli(pkCli_3856,pkSess_3901),Kcli_3913))
                                )
                                else
                                    {3547}let pkSess_3914: bitstring = fail-any in
                                    {3548}out(c, GetEndpointRequest);
                                    {3549}in(c, (=GetEndpointResponse,=pkSess_3914,=Sign,SP_3915: bitstring,UP_3916: bitstring));
                                    {3550}new Nc_3917: bitstring;
                                    {3551}let gNc_3918: bitstring = exp(g,Nc_3917) in
                                    {3552}let m1_3919: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3918) in
                                    {3553}out(c, (pkCli_3856,m1_3919,sign(h(m1_3919),skCli_3855)));
                                    {3554}in(c, (em2_3920: bitstring,sigM2_3921: bitstring));
                                    {3555}let m2_3922: bitstring = em2_3920 in
                                    {3556}if (verify(h(m2_3922),sigM2_3921,pkSess_3914) <> true) then
                                        0
                                    else
                                        {3557}let (=OpenSecureChannelResponse,PartS_3923: bitstring,ST_3924: bitstring,TTL_3925: bitstring) = m2_3922 in
                                        {3558}let Kcli_3926: bitstring = exp(PartS_3923,Nc_3917) in
                                        {3559}out(c, senc(mCli(pkCli_3856,pkSess_3914),Kcli_3926))
                        )
                        else
                            {3560}let pkSess_3927: bitstring = fail-any in
                            {3561}out(c, GetEndpointRequest);
                            {3562}in(c, (=GetEndpointResponse,=pkSess_3927,=Sign,SP_3928: bitstring,UP_3929: bitstring));
                            {3563}new Nc_3930: bitstring;
                            {3564}let gNc_3931: bitstring = exp(g,Nc_3930) in
                            {3565}let m1_3932: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3931) in
                            {3566}out(c, (pkCli_3856,m1_3932,sign(h(m1_3932),skCli_3855)));
                            {3567}in(c, (em2_3933: bitstring,sigM2_3934: bitstring));
                            {3568}let m2_3935: bitstring = em2_3933 in
                            {3569}if (verify(h(m2_3935),sigM2_3934,pkSess_3927) <> true) then
                                0
                            else
                                {3570}let (=OpenSecureChannelResponse,PartS_3936: bitstring,ST_3937: bitstring,TTL_3938: bitstring) = m2_3935 in
                                {3571}let Kcli_3939: bitstring = exp(PartS_3936,Nc_3930) in
                                {3572}out(c, senc(mCli(pkCli_3856,pkSess_3927),Kcli_3939))
                )
                else
                    {3573}let pkSess_3940: bitstring = fail-any in
                    {3574}out(c, GetEndpointRequest);
                    {3575}in(c, (=GetEndpointResponse,=pkSess_3940,=Sign,SP_3941: bitstring,UP_3942: bitstring));
                    {3576}new Nc_3943: bitstring;
                    {3577}let gNc_3944: bitstring = exp(g,Nc_3943) in
                    {3578}let m1_3945: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3944) in
                    {3579}out(c, (pkCli_3856,m1_3945,sign(h(m1_3945),skCli_3855)));
                    {3580}in(c, (em2_3946: bitstring,sigM2_3947: bitstring));
                    {3581}let m2_3948: bitstring = em2_3946 in
                    {3582}if (verify(h(m2_3948),sigM2_3947,pkSess_3940) <> true) then
                        0
                    else
                        {3583}let (=OpenSecureChannelResponse,PartS_3949: bitstring,ST_3950: bitstring,TTL_3951: bitstring) = m2_3948 in
                        {3584}let Kcli_3952: bitstring = exp(PartS_3949,Nc_3943) in
                        {3585}out(c, senc(mCli(pkCli_3856,pkSess_3940),Kcli_3952))
            )
            else
                {3586}let v_3953: bool = (Disco = B) in
                (
                    {3587}if v_3953 then
                    (
                        {3588}let pkDisco_3954: bitstring = pub(skB) in
                        {3589}let v_3955: bool = (Sess = A) in
                        (
                            {3590}if v_3955 then
                            (
                                {3591}let pkSess_3956: bitstring = pub(skA) in
                                {3592}out(c, GetEndpointRequest);
                                {3593}in(c, (=GetEndpointResponse,=pkSess_3956,=Sign,SP_3957: bitstring,UP_3958: bitstring));
                                {3594}new Nc_3959: bitstring;
                                {3595}let gNc_3960: bitstring = exp(g,Nc_3959) in
                                {3596}let m1_3961: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3960) in
                                {3597}out(c, (pkCli_3856,m1_3961,sign(h(m1_3961),skCli_3855)));
                                {3598}in(c, (em2_3962: bitstring,sigM2_3963: bitstring));
                                {3599}let m2_3964: bitstring = em2_3962 in
                                {3600}if (verify(h(m2_3964),sigM2_3963,pkSess_3956) <> true) then
                                    0
                                else
                                    {3601}let (=OpenSecureChannelResponse,PartS_3965: bitstring,ST_3966: bitstring,TTL_3967: bitstring) = m2_3964 in
                                    {3602}let Kcli_3968: bitstring = exp(PartS_3965,Nc_3959) in
                                    {3603}out(c, senc(mCli(pkCli_3856,pkSess_3956),Kcli_3968))
                            )
                            else
                                {3604}let v_3969: bool = (Sess = B) in
                                (
                                    {3605}if v_3969 then
                                    (
                                        {3606}let pkSess_3970: bitstring = pub(skB) in
                                        {3607}out(c, GetEndpointRequest);
                                        {3608}in(c, (=GetEndpointResponse,=pkSess_3970,=Sign,SP_3971: bitstring,UP_3972: bitstring));
                                        {3609}new Nc_3973: bitstring;
                                        {3610}let gNc_3974: bitstring = exp(g,Nc_3973) in
                                        {3611}let m1_3975: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3974) in
                                        {3612}out(c, (pkCli_3856,m1_3975,sign(h(m1_3975),skCli_3855)));
                                        {3613}in(c, (em2_3976: bitstring,sigM2_3977: bitstring));
                                        {3614}let m2_3978: bitstring = em2_3976 in
                                        {3615}if (verify(h(m2_3978),sigM2_3977,pkSess_3970) <> true) then
                                            0
                                        else
                                            {3616}let (=OpenSecureChannelResponse,PartS_3979: bitstring,ST_3980: bitstring,TTL_3981: bitstring) = m2_3978 in
                                            {3617}let Kcli_3982: bitstring = exp(PartS_3979,Nc_3973) in
                                            {3618}out(c, senc(mCli(pkCli_3856,pkSess_3970),Kcli_3982))
                                    )
                                    else
                                        {3619}let v_3983: bool = (Sess = C) in
                                        (
                                            {3620}if v_3983 then
                                            (
                                                {3621}let pkSess_3984: bitstring = pub(skC) in
                                                {3622}out(c, GetEndpointRequest);
                                                {3623}in(c, (=GetEndpointResponse,=pkSess_3984,=Sign,SP_3985: bitstring,UP_3986: bitstring));
                                                {3624}new Nc_3987: bitstring;
                                                {3625}let gNc_3988: bitstring = exp(g,Nc_3987) in
                                                {3626}let m1_3989: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_3988) in
                                                {3627}out(c, (pkCli_3856,m1_3989,sign(h(m1_3989),skCli_3855)));
                                                {3628}in(c, (em2_3990: bitstring,sigM2_3991: bitstring));
                                                {3629}let m2_3992: bitstring = em2_3990 in
                                                {3630}if (verify(h(m2_3992),sigM2_3991,pkSess_3984) <> true) then
                                                    0
                                                else
                                                    {3631}let (=OpenSecureChannelResponse,PartS_3993: bitstring,ST_3994: bitstring,TTL_3995: bitstring) = m2_3992 in
                                                    {3632}let Kcli_3996: bitstring = exp(PartS_3993,Nc_3987) in
                                                    {3633}out(c, senc(mCli(pkCli_3856,pkSess_3984),Kcli_3996))
                                            )
                                            else
                                                {3634}let pkSess_3997: bitstring = pub(sk(Sess)) in
                                                {3635}out(c, GetEndpointRequest);
                                                {3636}in(c, (=GetEndpointResponse,=pkSess_3997,=Sign,SP_3998: bitstring,UP_3999: bitstring));
                                                {3637}new Nc_4000: bitstring;
                                                {3638}let gNc_4001: bitstring = exp(g,Nc_4000) in
                                                {3639}let m1_4002: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4001) in
                                                {3640}out(c, (pkCli_3856,m1_4002,sign(h(m1_4002),skCli_3855)));
                                                {3641}in(c, (em2_4003: bitstring,sigM2_4004: bitstring));
                                                {3642}let m2_4005: bitstring = em2_4003 in
                                                {3643}if (verify(h(m2_4005),sigM2_4004,pkSess_3997) <> true) then
                                                    0
                                                else
                                                    {3644}let (=OpenSecureChannelResponse,PartS_4006: bitstring,ST_4007: bitstring,TTL_4008: bitstring) = m2_4005 in
                                                    {3645}let Kcli_4009: bitstring = exp(PartS_4006,Nc_4000) in
                                                    {3646}out(c, senc(mCli(pkCli_3856,pkSess_3997),Kcli_4009))
                                        )
                                        else
                                            {3647}let pkSess_4010: bitstring = fail-any in
                                            {3648}out(c, GetEndpointRequest);
                                            {3649}in(c, (=GetEndpointResponse,=pkSess_4010,=Sign,SP_4011: bitstring,UP_4012: bitstring));
                                            {3650}new Nc_4013: bitstring;
                                            {3651}let gNc_4014: bitstring = exp(g,Nc_4013) in
                                            {3652}let m1_4015: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4014) in
                                            {3653}out(c, (pkCli_3856,m1_4015,sign(h(m1_4015),skCli_3855)));
                                            {3654}in(c, (em2_4016: bitstring,sigM2_4017: bitstring));
                                            {3655}let m2_4018: bitstring = em2_4016 in
                                            {3656}if (verify(h(m2_4018),sigM2_4017,pkSess_4010) <> true) then
                                                0
                                            else
                                                {3657}let (=OpenSecureChannelResponse,PartS_4019: bitstring,ST_4020: bitstring,TTL_4021: bitstring) = m2_4018 in
                                                {3658}let Kcli_4022: bitstring = exp(PartS_4019,Nc_4013) in
                                                {3659}out(c, senc(mCli(pkCli_3856,pkSess_4010),Kcli_4022))
                                )
                                else
                                    {3660}let pkSess_4023: bitstring = fail-any in
                                    {3661}out(c, GetEndpointRequest);
                                    {3662}in(c, (=GetEndpointResponse,=pkSess_4023,=Sign,SP_4024: bitstring,UP_4025: bitstring));
                                    {3663}new Nc_4026: bitstring;
                                    {3664}let gNc_4027: bitstring = exp(g,Nc_4026) in
                                    {3665}let m1_4028: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4027) in
                                    {3666}out(c, (pkCli_3856,m1_4028,sign(h(m1_4028),skCli_3855)));
                                    {3667}in(c, (em2_4029: bitstring,sigM2_4030: bitstring));
                                    {3668}let m2_4031: bitstring = em2_4029 in
                                    {3669}if (verify(h(m2_4031),sigM2_4030,pkSess_4023) <> true) then
                                        0
                                    else
                                        {3670}let (=OpenSecureChannelResponse,PartS_4032: bitstring,ST_4033: bitstring,TTL_4034: bitstring) = m2_4031 in
                                        {3671}let Kcli_4035: bitstring = exp(PartS_4032,Nc_4026) in
                                        {3672}out(c, senc(mCli(pkCli_3856,pkSess_4023),Kcli_4035))
                        )
                        else
                            {3673}let pkSess_4036: bitstring = fail-any in
                            {3674}out(c, GetEndpointRequest);
                            {3675}in(c, (=GetEndpointResponse,=pkSess_4036,=Sign,SP_4037: bitstring,UP_4038: bitstring));
                            {3676}new Nc_4039: bitstring;
                            {3677}let gNc_4040: bitstring = exp(g,Nc_4039) in
                            {3678}let m1_4041: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4040) in
                            {3679}out(c, (pkCli_3856,m1_4041,sign(h(m1_4041),skCli_3855)));
                            {3680}in(c, (em2_4042: bitstring,sigM2_4043: bitstring));
                            {3681}let m2_4044: bitstring = em2_4042 in
                            {3682}if (verify(h(m2_4044),sigM2_4043,pkSess_4036) <> true) then
                                0
                            else
                                {3683}let (=OpenSecureChannelResponse,PartS_4045: bitstring,ST_4046: bitstring,TTL_4047: bitstring) = m2_4044 in
                                {3684}let Kcli_4048: bitstring = exp(PartS_4045,Nc_4039) in
                                {3685}out(c, senc(mCli(pkCli_3856,pkSess_4036),Kcli_4048))
                    )
                    else
                        {3686}let v_4049: bool = (Disco = C) in
                        (
                            {3687}if v_4049 then
                            (
                                {3688}let pkDisco_4050: bitstring = pub(skC) in
                                {3689}let v_4051: bool = (Sess = A) in
                                (
                                    {3690}if v_4051 then
                                    (
                                        {3691}let pkSess_4052: bitstring = pub(skA) in
                                        {3692}out(c, GetEndpointRequest);
                                        {3693}in(c, (=GetEndpointResponse,=pkSess_4052,=Sign,SP_4053: bitstring,UP_4054: bitstring));
                                        {3694}new Nc_4055: bitstring;
                                        {3695}let gNc_4056: bitstring = exp(g,Nc_4055) in
                                        {3696}let m1_4057: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4056) in
                                        {3697}out(c, (pkCli_3856,m1_4057,sign(h(m1_4057),skCli_3855)));
                                        {3698}in(c, (em2_4058: bitstring,sigM2_4059: bitstring));
                                        {3699}let m2_4060: bitstring = em2_4058 in
                                        {3700}if (verify(h(m2_4060),sigM2_4059,pkSess_4052) <> true) then
                                            0
                                        else
                                            {3701}let (=OpenSecureChannelResponse,PartS_4061: bitstring,ST_4062: bitstring,TTL_4063: bitstring) = m2_4060 in
                                            {3702}let Kcli_4064: bitstring = exp(PartS_4061,Nc_4055) in
                                            {3703}out(c, senc(mCli(pkCli_3856,pkSess_4052),Kcli_4064))
                                    )
                                    else
                                        {3704}let v_4065: bool = (Sess = B) in
                                        (
                                            {3705}if v_4065 then
                                            (
                                                {3706}let pkSess_4066: bitstring = pub(skB) in
                                                {3707}out(c, GetEndpointRequest);
                                                {3708}in(c, (=GetEndpointResponse,=pkSess_4066,=Sign,SP_4067: bitstring,UP_4068: bitstring));
                                                {3709}new Nc_4069: bitstring;
                                                {3710}let gNc_4070: bitstring = exp(g,Nc_4069) in
                                                {3711}let m1_4071: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4070) in
                                                {3712}out(c, (pkCli_3856,m1_4071,sign(h(m1_4071),skCli_3855)));
                                                {3713}in(c, (em2_4072: bitstring,sigM2_4073: bitstring));
                                                {3714}let m2_4074: bitstring = em2_4072 in
                                                {3715}if (verify(h(m2_4074),sigM2_4073,pkSess_4066) <> true) then
                                                    0
                                                else
                                                    {3716}let (=OpenSecureChannelResponse,PartS_4075: bitstring,ST_4076: bitstring,TTL_4077: bitstring) = m2_4074 in
                                                    {3717}let Kcli_4078: bitstring = exp(PartS_4075,Nc_4069) in
                                                    {3718}out(c, senc(mCli(pkCli_3856,pkSess_4066),Kcli_4078))
                                            )
                                            else
                                                {3719}let v_4079: bool = (Sess = C) in
                                                (
                                                    {3720}if v_4079 then
                                                    (
                                                        {3721}let pkSess_4080: bitstring = pub(skC) in
                                                        {3722}out(c, GetEndpointRequest);
                                                        {3723}in(c, (=GetEndpointResponse,=pkSess_4080,=Sign,SP_4081: bitstring,UP_4082: bitstring));
                                                        {3724}new Nc_4083: bitstring;
                                                        {3725}let gNc_4084: bitstring = exp(g,Nc_4083) in
                                                        {3726}let m1_4085: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4084) in
                                                        {3727}out(c, (pkCli_3856,m1_4085,sign(h(m1_4085),skCli_3855)));
                                                        {3728}in(c, (em2_4086: bitstring,sigM2_4087: bitstring));
                                                        {3729}let m2_4088: bitstring = em2_4086 in
                                                        {3730}if (verify(h(m2_4088),sigM2_4087,pkSess_4080) <> true) then
                                                            0
                                                        else
                                                            {3731}let (=OpenSecureChannelResponse,PartS_4089: bitstring,ST_4090: bitstring,TTL_4091: bitstring) = m2_4088 in
                                                            {3732}let Kcli_4092: bitstring = exp(PartS_4089,Nc_4083) in
                                                            {3733}out(c, senc(mCli(pkCli_3856,pkSess_4080),Kcli_4092))
                                                    )
                                                    else
                                                        {3734}let pkSess_4093: bitstring = pub(sk(Sess)) in
                                                        {3735}out(c, GetEndpointRequest);
                                                        {3736}in(c, (=GetEndpointResponse,=pkSess_4093,=Sign,SP_4094: bitstring,UP_4095: bitstring));
                                                        {3737}new Nc_4096: bitstring;
                                                        {3738}let gNc_4097: bitstring = exp(g,Nc_4096) in
                                                        {3739}let m1_4098: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4097) in
                                                        {3740}out(c, (pkCli_3856,m1_4098,sign(h(m1_4098),skCli_3855)));
                                                        {3741}in(c, (em2_4099: bitstring,sigM2_4100: bitstring));
                                                        {3742}let m2_4101: bitstring = em2_4099 in
                                                        {3743}if (verify(h(m2_4101),sigM2_4100,pkSess_4093) <> true) then
                                                            0
                                                        else
                                                            {3744}let (=OpenSecureChannelResponse,PartS_4102: bitstring,ST_4103: bitstring,TTL_4104: bitstring) = m2_4101 in
                                                            {3745}let Kcli_4105: bitstring = exp(PartS_4102,Nc_4096) in
                                                            {3746}out(c, senc(mCli(pkCli_3856,pkSess_4093),Kcli_4105))
                                                )
                                                else
                                                    {3747}let pkSess_4106: bitstring = fail-any in
                                                    {3748}out(c, GetEndpointRequest);
                                                    {3749}in(c, (=GetEndpointResponse,=pkSess_4106,=Sign,SP_4107: bitstring,UP_4108: bitstring));
                                                    {3750}new Nc_4109: bitstring;
                                                    {3751}let gNc_4110: bitstring = exp(g,Nc_4109) in
                                                    {3752}let m1_4111: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4110) in
                                                    {3753}out(c, (pkCli_3856,m1_4111,sign(h(m1_4111),skCli_3855)));
                                                    {3754}in(c, (em2_4112: bitstring,sigM2_4113: bitstring));
                                                    {3755}let m2_4114: bitstring = em2_4112 in
                                                    {3756}if (verify(h(m2_4114),sigM2_4113,pkSess_4106) <> true) then
                                                        0
                                                    else
                                                        {3757}let (=OpenSecureChannelResponse,PartS_4115: bitstring,ST_4116: bitstring,TTL_4117: bitstring) = m2_4114 in
                                                        {3758}let Kcli_4118: bitstring = exp(PartS_4115,Nc_4109) in
                                                        {3759}out(c, senc(mCli(pkCli_3856,pkSess_4106),Kcli_4118))
                                        )
                                        else
                                            {3760}let pkSess_4119: bitstring = fail-any in
                                            {3761}out(c, GetEndpointRequest);
                                            {3762}in(c, (=GetEndpointResponse,=pkSess_4119,=Sign,SP_4120: bitstring,UP_4121: bitstring));
                                            {3763}new Nc_4122: bitstring;
                                            {3764}let gNc_4123: bitstring = exp(g,Nc_4122) in
                                            {3765}let m1_4124: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4123) in
                                            {3766}out(c, (pkCli_3856,m1_4124,sign(h(m1_4124),skCli_3855)));
                                            {3767}in(c, (em2_4125: bitstring,sigM2_4126: bitstring));
                                            {3768}let m2_4127: bitstring = em2_4125 in
                                            {3769}if (verify(h(m2_4127),sigM2_4126,pkSess_4119) <> true) then
                                                0
                                            else
                                                {3770}let (=OpenSecureChannelResponse,PartS_4128: bitstring,ST_4129: bitstring,TTL_4130: bitstring) = m2_4127 in
                                                {3771}let Kcli_4131: bitstring = exp(PartS_4128,Nc_4122) in
                                                {3772}out(c, senc(mCli(pkCli_3856,pkSess_4119),Kcli_4131))
                                )
                                else
                                    {3773}let pkSess_4132: bitstring = fail-any in
                                    {3774}out(c, GetEndpointRequest);
                                    {3775}in(c, (=GetEndpointResponse,=pkSess_4132,=Sign,SP_4133: bitstring,UP_4134: bitstring));
                                    {3776}new Nc_4135: bitstring;
                                    {3777}let gNc_4136: bitstring = exp(g,Nc_4135) in
                                    {3778}let m1_4137: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4136) in
                                    {3779}out(c, (pkCli_3856,m1_4137,sign(h(m1_4137),skCli_3855)));
                                    {3780}in(c, (em2_4138: bitstring,sigM2_4139: bitstring));
                                    {3781}let m2_4140: bitstring = em2_4138 in
                                    {3782}if (verify(h(m2_4140),sigM2_4139,pkSess_4132) <> true) then
                                        0
                                    else
                                        {3783}let (=OpenSecureChannelResponse,PartS_4141: bitstring,ST_4142: bitstring,TTL_4143: bitstring) = m2_4140 in
                                        {3784}let Kcli_4144: bitstring = exp(PartS_4141,Nc_4135) in
                                        {3785}out(c, senc(mCli(pkCli_3856,pkSess_4132),Kcli_4144))
                            )
                            else
                                {3786}let pkDisco_4145: bitstring = pub(sk(Disco)) in
                                {3787}let v_4146: bool = (Sess = A) in
                                (
                                    {3788}if v_4146 then
                                    (
                                        {3789}let pkSess_4147: bitstring = pub(skA) in
                                        {3790}out(c, GetEndpointRequest);
                                        {3791}in(c, (=GetEndpointResponse,=pkSess_4147,=Sign,SP_4148: bitstring,UP_4149: bitstring));
                                        {3792}new Nc_4150: bitstring;
                                        {3793}let gNc_4151: bitstring = exp(g,Nc_4150) in
                                        {3794}let m1_4152: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4151) in
                                        {3795}out(c, (pkCli_3856,m1_4152,sign(h(m1_4152),skCli_3855)));
                                        {3796}in(c, (em2_4153: bitstring,sigM2_4154: bitstring));
                                        {3797}let m2_4155: bitstring = em2_4153 in
                                        {3798}if (verify(h(m2_4155),sigM2_4154,pkSess_4147) <> true) then
                                            0
                                        else
                                            {3799}let (=OpenSecureChannelResponse,PartS_4156: bitstring,ST_4157: bitstring,TTL_4158: bitstring) = m2_4155 in
                                            {3800}let Kcli_4159: bitstring = exp(PartS_4156,Nc_4150) in
                                            {3801}out(c, senc(mCli(pkCli_3856,pkSess_4147),Kcli_4159))
                                    )
                                    else
                                        {3802}let v_4160: bool = (Sess = B) in
                                        (
                                            {3803}if v_4160 then
                                            (
                                                {3804}let pkSess_4161: bitstring = pub(skB) in
                                                {3805}out(c, GetEndpointRequest);
                                                {3806}in(c, (=GetEndpointResponse,=pkSess_4161,=Sign,SP_4162: bitstring,UP_4163: bitstring));
                                                {3807}new Nc_4164: bitstring;
                                                {3808}let gNc_4165: bitstring = exp(g,Nc_4164) in
                                                {3809}let m1_4166: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4165) in
                                                {3810}out(c, (pkCli_3856,m1_4166,sign(h(m1_4166),skCli_3855)));
                                                {3811}in(c, (em2_4167: bitstring,sigM2_4168: bitstring));
                                                {3812}let m2_4169: bitstring = em2_4167 in
                                                {3813}if (verify(h(m2_4169),sigM2_4168,pkSess_4161) <> true) then
                                                    0
                                                else
                                                    {3814}let (=OpenSecureChannelResponse,PartS_4170: bitstring,ST_4171: bitstring,TTL_4172: bitstring) = m2_4169 in
                                                    {3815}let Kcli_4173: bitstring = exp(PartS_4170,Nc_4164) in
                                                    {3816}out(c, senc(mCli(pkCli_3856,pkSess_4161),Kcli_4173))
                                            )
                                            else
                                                {3817}let v_4174: bool = (Sess = C) in
                                                (
                                                    {3818}if v_4174 then
                                                    (
                                                        {3819}let pkSess_4175: bitstring = pub(skC) in
                                                        {3820}out(c, GetEndpointRequest);
                                                        {3821}in(c, (=GetEndpointResponse,=pkSess_4175,=Sign,SP_4176: bitstring,UP_4177: bitstring));
                                                        {3822}new Nc_4178: bitstring;
                                                        {3823}let gNc_4179: bitstring = exp(g,Nc_4178) in
                                                        {3824}let m1_4180: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4179) in
                                                        {3825}out(c, (pkCli_3856,m1_4180,sign(h(m1_4180),skCli_3855)));
                                                        {3826}in(c, (em2_4181: bitstring,sigM2_4182: bitstring));
                                                        {3827}let m2_4183: bitstring = em2_4181 in
                                                        {3828}if (verify(h(m2_4183),sigM2_4182,pkSess_4175) <> true) then
                                                            0
                                                        else
                                                            {3829}let (=OpenSecureChannelResponse,PartS_4184: bitstring,ST_4185: bitstring,TTL_4186: bitstring) = m2_4183 in
                                                            {3830}let Kcli_4187: bitstring = exp(PartS_4184,Nc_4178) in
                                                            {3831}out(c, senc(mCli(pkCli_3856,pkSess_4175),Kcli_4187))
                                                    )
                                                    else
                                                        {3832}let pkSess_4188: bitstring = pub(sk(Sess)) in
                                                        {3833}out(c, GetEndpointRequest);
                                                        {3834}in(c, (=GetEndpointResponse,=pkSess_4188,=Sign,SP_4189: bitstring,UP_4190: bitstring));
                                                        {3835}new Nc_4191: bitstring;
                                                        {3836}let gNc_4192: bitstring = exp(g,Nc_4191) in
                                                        {3837}let m1_4193: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4192) in
                                                        {3838}out(c, (pkCli_3856,m1_4193,sign(h(m1_4193),skCli_3855)));
                                                        {3839}in(c, (em2_4194: bitstring,sigM2_4195: bitstring));
                                                        {3840}let m2_4196: bitstring = em2_4194 in
                                                        {3841}if (verify(h(m2_4196),sigM2_4195,pkSess_4188) <> true) then
                                                            0
                                                        else
                                                            {3842}let (=OpenSecureChannelResponse,PartS_4197: bitstring,ST_4198: bitstring,TTL_4199: bitstring) = m2_4196 in
                                                            {3843}let Kcli_4200: bitstring = exp(PartS_4197,Nc_4191) in
                                                            {3844}out(c, senc(mCli(pkCli_3856,pkSess_4188),Kcli_4200))
                                                )
                                                else
                                                    {3845}let pkSess_4201: bitstring = fail-any in
                                                    {3846}out(c, GetEndpointRequest);
                                                    {3847}in(c, (=GetEndpointResponse,=pkSess_4201,=Sign,SP_4202: bitstring,UP_4203: bitstring));
                                                    {3848}new Nc_4204: bitstring;
                                                    {3849}let gNc_4205: bitstring = exp(g,Nc_4204) in
                                                    {3850}let m1_4206: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4205) in
                                                    {3851}out(c, (pkCli_3856,m1_4206,sign(h(m1_4206),skCli_3855)));
                                                    {3852}in(c, (em2_4207: bitstring,sigM2_4208: bitstring));
                                                    {3853}let m2_4209: bitstring = em2_4207 in
                                                    {3854}if (verify(h(m2_4209),sigM2_4208,pkSess_4201) <> true) then
                                                        0
                                                    else
                                                        {3855}let (=OpenSecureChannelResponse,PartS_4210: bitstring,ST_4211: bitstring,TTL_4212: bitstring) = m2_4209 in
                                                        {3856}let Kcli_4213: bitstring = exp(PartS_4210,Nc_4204) in
                                                        {3857}out(c, senc(mCli(pkCli_3856,pkSess_4201),Kcli_4213))
                                        )
                                        else
                                            {3858}let pkSess_4214: bitstring = fail-any in
                                            {3859}out(c, GetEndpointRequest);
                                            {3860}in(c, (=GetEndpointResponse,=pkSess_4214,=Sign,SP_4215: bitstring,UP_4216: bitstring));
                                            {3861}new Nc_4217: bitstring;
                                            {3862}let gNc_4218: bitstring = exp(g,Nc_4217) in
                                            {3863}let m1_4219: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4218) in
                                            {3864}out(c, (pkCli_3856,m1_4219,sign(h(m1_4219),skCli_3855)));
                                            {3865}in(c, (em2_4220: bitstring,sigM2_4221: bitstring));
                                            {3866}let m2_4222: bitstring = em2_4220 in
                                            {3867}if (verify(h(m2_4222),sigM2_4221,pkSess_4214) <> true) then
                                                0
                                            else
                                                {3868}let (=OpenSecureChannelResponse,PartS_4223: bitstring,ST_4224: bitstring,TTL_4225: bitstring) = m2_4222 in
                                                {3869}let Kcli_4226: bitstring = exp(PartS_4223,Nc_4217) in
                                                {3870}out(c, senc(mCli(pkCli_3856,pkSess_4214),Kcli_4226))
                                )
                                else
                                    {3871}let pkSess_4227: bitstring = fail-any in
                                    {3872}out(c, GetEndpointRequest);
                                    {3873}in(c, (=GetEndpointResponse,=pkSess_4227,=Sign,SP_4228: bitstring,UP_4229: bitstring));
                                    {3874}new Nc_4230: bitstring;
                                    {3875}let gNc_4231: bitstring = exp(g,Nc_4230) in
                                    {3876}let m1_4232: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4231) in
                                    {3877}out(c, (pkCli_3856,m1_4232,sign(h(m1_4232),skCli_3855)));
                                    {3878}in(c, (em2_4233: bitstring,sigM2_4234: bitstring));
                                    {3879}let m2_4235: bitstring = em2_4233 in
                                    {3880}if (verify(h(m2_4235),sigM2_4234,pkSess_4227) <> true) then
                                        0
                                    else
                                        {3881}let (=OpenSecureChannelResponse,PartS_4236: bitstring,ST_4237: bitstring,TTL_4238: bitstring) = m2_4235 in
                                        {3882}let Kcli_4239: bitstring = exp(PartS_4236,Nc_4230) in
                                        {3883}out(c, senc(mCli(pkCli_3856,pkSess_4227),Kcli_4239))
                        )
                        else
                            {3884}let pkDisco_4240: bitstring = fail-any in
                            {3885}let v_4241: bool = (Sess = A) in
                            (
                                {3886}if v_4241 then
                                (
                                    {3887}let pkSess_4242: bitstring = pub(skA) in
                                    {3888}out(c, GetEndpointRequest);
                                    {3889}in(c, (=GetEndpointResponse,=pkSess_4242,=Sign,SP_4243: bitstring,UP_4244: bitstring));
                                    {3890}new Nc_4245: bitstring;
                                    {3891}let gNc_4246: bitstring = exp(g,Nc_4245) in
                                    {3892}let m1_4247: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4246) in
                                    {3893}out(c, (pkCli_3856,m1_4247,sign(h(m1_4247),skCli_3855)));
                                    {3894}in(c, (em2_4248: bitstring,sigM2_4249: bitstring));
                                    {3895}let m2_4250: bitstring = em2_4248 in
                                    {3896}if (verify(h(m2_4250),sigM2_4249,pkSess_4242) <> true) then
                                        0
                                    else
                                        {3897}let (=OpenSecureChannelResponse,PartS_4251: bitstring,ST_4252: bitstring,TTL_4253: bitstring) = m2_4250 in
                                        {3898}let Kcli_4254: bitstring = exp(PartS_4251,Nc_4245) in
                                        {3899}out(c, senc(mCli(pkCli_3856,pkSess_4242),Kcli_4254))
                                )
                                else
                                    {3900}let v_4255: bool = (Sess = B) in
                                    (
                                        {3901}if v_4255 then
                                        (
                                            {3902}let pkSess_4256: bitstring = pub(skB) in
                                            {3903}out(c, GetEndpointRequest);
                                            {3904}in(c, (=GetEndpointResponse,=pkSess_4256,=Sign,SP_4257: bitstring,UP_4258: bitstring));
                                            {3905}new Nc_4259: bitstring;
                                            {3906}let gNc_4260: bitstring = exp(g,Nc_4259) in
                                            {3907}let m1_4261: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4260) in
                                            {3908}out(c, (pkCli_3856,m1_4261,sign(h(m1_4261),skCli_3855)));
                                            {3909}in(c, (em2_4262: bitstring,sigM2_4263: bitstring));
                                            {3910}let m2_4264: bitstring = em2_4262 in
                                            {3911}if (verify(h(m2_4264),sigM2_4263,pkSess_4256) <> true) then
                                                0
                                            else
                                                {3912}let (=OpenSecureChannelResponse,PartS_4265: bitstring,ST_4266: bitstring,TTL_4267: bitstring) = m2_4264 in
                                                {3913}let Kcli_4268: bitstring = exp(PartS_4265,Nc_4259) in
                                                {3914}out(c, senc(mCli(pkCli_3856,pkSess_4256),Kcli_4268))
                                        )
                                        else
                                            {3915}let v_4269: bool = (Sess = C) in
                                            (
                                                {3916}if v_4269 then
                                                (
                                                    {3917}let pkSess_4270: bitstring = pub(skC) in
                                                    {3918}out(c, GetEndpointRequest);
                                                    {3919}in(c, (=GetEndpointResponse,=pkSess_4270,=Sign,SP_4271: bitstring,UP_4272: bitstring));
                                                    {3920}new Nc_4273: bitstring;
                                                    {3921}let gNc_4274: bitstring = exp(g,Nc_4273) in
                                                    {3922}let m1_4275: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4274) in
                                                    {3923}out(c, (pkCli_3856,m1_4275,sign(h(m1_4275),skCli_3855)));
                                                    {3924}in(c, (em2_4276: bitstring,sigM2_4277: bitstring));
                                                    {3925}let m2_4278: bitstring = em2_4276 in
                                                    {3926}if (verify(h(m2_4278),sigM2_4277,pkSess_4270) <> true) then
                                                        0
                                                    else
                                                        {3927}let (=OpenSecureChannelResponse,PartS_4279: bitstring,ST_4280: bitstring,TTL_4281: bitstring) = m2_4278 in
                                                        {3928}let Kcli_4282: bitstring = exp(PartS_4279,Nc_4273) in
                                                        {3929}out(c, senc(mCli(pkCli_3856,pkSess_4270),Kcli_4282))
                                                )
                                                else
                                                    {3930}let pkSess_4283: bitstring = pub(sk(Sess)) in
                                                    {3931}out(c, GetEndpointRequest);
                                                    {3932}in(c, (=GetEndpointResponse,=pkSess_4283,=Sign,SP_4284: bitstring,UP_4285: bitstring));
                                                    {3933}new Nc_4286: bitstring;
                                                    {3934}let gNc_4287: bitstring = exp(g,Nc_4286) in
                                                    {3935}let m1_4288: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4287) in
                                                    {3936}out(c, (pkCli_3856,m1_4288,sign(h(m1_4288),skCli_3855)));
                                                    {3937}in(c, (em2_4289: bitstring,sigM2_4290: bitstring));
                                                    {3938}let m2_4291: bitstring = em2_4289 in
                                                    {3939}if (verify(h(m2_4291),sigM2_4290,pkSess_4283) <> true) then
                                                        0
                                                    else
                                                        {3940}let (=OpenSecureChannelResponse,PartS_4292: bitstring,ST_4293: bitstring,TTL_4294: bitstring) = m2_4291 in
                                                        {3941}let Kcli_4295: bitstring = exp(PartS_4292,Nc_4286) in
                                                        {3942}out(c, senc(mCli(pkCli_3856,pkSess_4283),Kcli_4295))
                                            )
                                            else
                                                {3943}let pkSess_4296: bitstring = fail-any in
                                                {3944}out(c, GetEndpointRequest);
                                                {3945}in(c, (=GetEndpointResponse,=pkSess_4296,=Sign,SP_4297: bitstring,UP_4298: bitstring));
                                                {3946}new Nc_4299: bitstring;
                                                {3947}let gNc_4300: bitstring = exp(g,Nc_4299) in
                                                {3948}let m1_4301: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4300) in
                                                {3949}out(c, (pkCli_3856,m1_4301,sign(h(m1_4301),skCli_3855)));
                                                {3950}in(c, (em2_4302: bitstring,sigM2_4303: bitstring));
                                                {3951}let m2_4304: bitstring = em2_4302 in
                                                {3952}if (verify(h(m2_4304),sigM2_4303,pkSess_4296) <> true) then
                                                    0
                                                else
                                                    {3953}let (=OpenSecureChannelResponse,PartS_4305: bitstring,ST_4306: bitstring,TTL_4307: bitstring) = m2_4304 in
                                                    {3954}let Kcli_4308: bitstring = exp(PartS_4305,Nc_4299) in
                                                    {3955}out(c, senc(mCli(pkCli_3856,pkSess_4296),Kcli_4308))
                                    )
                                    else
                                        {3956}let pkSess_4309: bitstring = fail-any in
                                        {3957}out(c, GetEndpointRequest);
                                        {3958}in(c, (=GetEndpointResponse,=pkSess_4309,=Sign,SP_4310: bitstring,UP_4311: bitstring));
                                        {3959}new Nc_4312: bitstring;
                                        {3960}let gNc_4313: bitstring = exp(g,Nc_4312) in
                                        {3961}let m1_4314: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4313) in
                                        {3962}out(c, (pkCli_3856,m1_4314,sign(h(m1_4314),skCli_3855)));
                                        {3963}in(c, (em2_4315: bitstring,sigM2_4316: bitstring));
                                        {3964}let m2_4317: bitstring = em2_4315 in
                                        {3965}if (verify(h(m2_4317),sigM2_4316,pkSess_4309) <> true) then
                                            0
                                        else
                                            {3966}let (=OpenSecureChannelResponse,PartS_4318: bitstring,ST_4319: bitstring,TTL_4320: bitstring) = m2_4317 in
                                            {3967}let Kcli_4321: bitstring = exp(PartS_4318,Nc_4312) in
                                            {3968}out(c, senc(mCli(pkCli_3856,pkSess_4309),Kcli_4321))
                            )
                            else
                                {3969}let pkSess_4322: bitstring = fail-any in
                                {3970}out(c, GetEndpointRequest);
                                {3971}in(c, (=GetEndpointResponse,=pkSess_4322,=Sign,SP_4323: bitstring,UP_4324: bitstring));
                                {3972}new Nc_4325: bitstring;
                                {3973}let gNc_4326: bitstring = exp(g,Nc_4325) in
                                {3974}let m1_4327: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4326) in
                                {3975}out(c, (pkCli_3856,m1_4327,sign(h(m1_4327),skCli_3855)));
                                {3976}in(c, (em2_4328: bitstring,sigM2_4329: bitstring));
                                {3977}let m2_4330: bitstring = em2_4328 in
                                {3978}if (verify(h(m2_4330),sigM2_4329,pkSess_4322) <> true) then
                                    0
                                else
                                    {3979}let (=OpenSecureChannelResponse,PartS_4331: bitstring,ST_4332: bitstring,TTL_4333: bitstring) = m2_4330 in
                                    {3980}let Kcli_4334: bitstring = exp(PartS_4331,Nc_4325) in
                                    {3981}out(c, senc(mCli(pkCli_3856,pkSess_4322),Kcli_4334))
                )
                else
                    {3982}let pkDisco_4335: bitstring = fail-any in
                    {3983}let v_4336: bool = (Sess = A) in
                    (
                        {3984}if v_4336 then
                        (
                            {3985}let pkSess_4337: bitstring = pub(skA) in
                            {3986}out(c, GetEndpointRequest);
                            {3987}in(c, (=GetEndpointResponse,=pkSess_4337,=Sign,SP_4338: bitstring,UP_4339: bitstring));
                            {3988}new Nc_4340: bitstring;
                            {3989}let gNc_4341: bitstring = exp(g,Nc_4340) in
                            {3990}let m1_4342: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4341) in
                            {3991}out(c, (pkCli_3856,m1_4342,sign(h(m1_4342),skCli_3855)));
                            {3992}in(c, (em2_4343: bitstring,sigM2_4344: bitstring));
                            {3993}let m2_4345: bitstring = em2_4343 in
                            {3994}if (verify(h(m2_4345),sigM2_4344,pkSess_4337) <> true) then
                                0
                            else
                                {3995}let (=OpenSecureChannelResponse,PartS_4346: bitstring,ST_4347: bitstring,TTL_4348: bitstring) = m2_4345 in
                                {3996}let Kcli_4349: bitstring = exp(PartS_4346,Nc_4340) in
                                {3997}out(c, senc(mCli(pkCli_3856,pkSess_4337),Kcli_4349))
                        )
                        else
                            {3998}let v_4350: bool = (Sess = B) in
                            (
                                {3999}if v_4350 then
                                (
                                    {4000}let pkSess_4351: bitstring = pub(skB) in
                                    {4001}out(c, GetEndpointRequest);
                                    {4002}in(c, (=GetEndpointResponse,=pkSess_4351,=Sign,SP_4352: bitstring,UP_4353: bitstring));
                                    {4003}new Nc_4354: bitstring;
                                    {4004}let gNc_4355: bitstring = exp(g,Nc_4354) in
                                    {4005}let m1_4356: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4355) in
                                    {4006}out(c, (pkCli_3856,m1_4356,sign(h(m1_4356),skCli_3855)));
                                    {4007}in(c, (em2_4357: bitstring,sigM2_4358: bitstring));
                                    {4008}let m2_4359: bitstring = em2_4357 in
                                    {4009}if (verify(h(m2_4359),sigM2_4358,pkSess_4351) <> true) then
                                        0
                                    else
                                        {4010}let (=OpenSecureChannelResponse,PartS_4360: bitstring,ST_4361: bitstring,TTL_4362: bitstring) = m2_4359 in
                                        {4011}let Kcli_4363: bitstring = exp(PartS_4360,Nc_4354) in
                                        {4012}out(c, senc(mCli(pkCli_3856,pkSess_4351),Kcli_4363))
                                )
                                else
                                    {4013}let v_4364: bool = (Sess = C) in
                                    (
                                        {4014}if v_4364 then
                                        (
                                            {4015}let pkSess_4365: bitstring = pub(skC) in
                                            {4016}out(c, GetEndpointRequest);
                                            {4017}in(c, (=GetEndpointResponse,=pkSess_4365,=Sign,SP_4366: bitstring,UP_4367: bitstring));
                                            {4018}new Nc_4368: bitstring;
                                            {4019}let gNc_4369: bitstring = exp(g,Nc_4368) in
                                            {4020}let m1_4370: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4369) in
                                            {4021}out(c, (pkCli_3856,m1_4370,sign(h(m1_4370),skCli_3855)));
                                            {4022}in(c, (em2_4371: bitstring,sigM2_4372: bitstring));
                                            {4023}let m2_4373: bitstring = em2_4371 in
                                            {4024}if (verify(h(m2_4373),sigM2_4372,pkSess_4365) <> true) then
                                                0
                                            else
                                                {4025}let (=OpenSecureChannelResponse,PartS_4374: bitstring,ST_4375: bitstring,TTL_4376: bitstring) = m2_4373 in
                                                {4026}let Kcli_4377: bitstring = exp(PartS_4374,Nc_4368) in
                                                {4027}out(c, senc(mCli(pkCli_3856,pkSess_4365),Kcli_4377))
                                        )
                                        else
                                            {4028}let pkSess_4378: bitstring = pub(sk(Sess)) in
                                            {4029}out(c, GetEndpointRequest);
                                            {4030}in(c, (=GetEndpointResponse,=pkSess_4378,=Sign,SP_4379: bitstring,UP_4380: bitstring));
                                            {4031}new Nc_4381: bitstring;
                                            {4032}let gNc_4382: bitstring = exp(g,Nc_4381) in
                                            {4033}let m1_4383: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4382) in
                                            {4034}out(c, (pkCli_3856,m1_4383,sign(h(m1_4383),skCli_3855)));
                                            {4035}in(c, (em2_4384: bitstring,sigM2_4385: bitstring));
                                            {4036}let m2_4386: bitstring = em2_4384 in
                                            {4037}if (verify(h(m2_4386),sigM2_4385,pkSess_4378) <> true) then
                                                0
                                            else
                                                {4038}let (=OpenSecureChannelResponse,PartS_4387: bitstring,ST_4388: bitstring,TTL_4389: bitstring) = m2_4386 in
                                                {4039}let Kcli_4390: bitstring = exp(PartS_4387,Nc_4381) in
                                                {4040}out(c, senc(mCli(pkCli_3856,pkSess_4378),Kcli_4390))
                                    )
                                    else
                                        {4041}let pkSess_4391: bitstring = fail-any in
                                        {4042}out(c, GetEndpointRequest);
                                        {4043}in(c, (=GetEndpointResponse,=pkSess_4391,=Sign,SP_4392: bitstring,UP_4393: bitstring));
                                        {4044}new Nc_4394: bitstring;
                                        {4045}let gNc_4395: bitstring = exp(g,Nc_4394) in
                                        {4046}let m1_4396: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4395) in
                                        {4047}out(c, (pkCli_3856,m1_4396,sign(h(m1_4396),skCli_3855)));
                                        {4048}in(c, (em2_4397: bitstring,sigM2_4398: bitstring));
                                        {4049}let m2_4399: bitstring = em2_4397 in
                                        {4050}if (verify(h(m2_4399),sigM2_4398,pkSess_4391) <> true) then
                                            0
                                        else
                                            {4051}let (=OpenSecureChannelResponse,PartS_4400: bitstring,ST_4401: bitstring,TTL_4402: bitstring) = m2_4399 in
                                            {4052}let Kcli_4403: bitstring = exp(PartS_4400,Nc_4394) in
                                            {4053}out(c, senc(mCli(pkCli_3856,pkSess_4391),Kcli_4403))
                            )
                            else
                                {4054}let pkSess_4404: bitstring = fail-any in
                                {4055}out(c, GetEndpointRequest);
                                {4056}in(c, (=GetEndpointResponse,=pkSess_4404,=Sign,SP_4405: bitstring,UP_4406: bitstring));
                                {4057}new Nc_4407: bitstring;
                                {4058}let gNc_4408: bitstring = exp(g,Nc_4407) in
                                {4059}let m1_4409: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4408) in
                                {4060}out(c, (pkCli_3856,m1_4409,sign(h(m1_4409),skCli_3855)));
                                {4061}in(c, (em2_4410: bitstring,sigM2_4411: bitstring));
                                {4062}let m2_4412: bitstring = em2_4410 in
                                {4063}if (verify(h(m2_4412),sigM2_4411,pkSess_4404) <> true) then
                                    0
                                else
                                    {4064}let (=OpenSecureChannelResponse,PartS_4413: bitstring,ST_4414: bitstring,TTL_4415: bitstring) = m2_4412 in
                                    {4065}let Kcli_4416: bitstring = exp(PartS_4413,Nc_4407) in
                                    {4066}out(c, senc(mCli(pkCli_3856,pkSess_4404),Kcli_4416))
                    )
                    else
                        {4067}let pkSess_4417: bitstring = fail-any in
                        {4068}out(c, GetEndpointRequest);
                        {4069}in(c, (=GetEndpointResponse,=pkSess_4417,=Sign,SP_4418: bitstring,UP_4419: bitstring));
                        {4070}new Nc_4420: bitstring;
                        {4071}let gNc_4421: bitstring = exp(g,Nc_4420) in
                        {4072}let m1_4422: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4421) in
                        {4073}out(c, (pkCli_3856,m1_4422,sign(h(m1_4422),skCli_3855)));
                        {4074}in(c, (em2_4423: bitstring,sigM2_4424: bitstring));
                        {4075}let m2_4425: bitstring = em2_4423 in
                        {4076}if (verify(h(m2_4425),sigM2_4424,pkSess_4417) <> true) then
                            0
                        else
                            {4077}let (=OpenSecureChannelResponse,PartS_4426: bitstring,ST_4427: bitstring,TTL_4428: bitstring) = m2_4425 in
                            {4078}let Kcli_4429: bitstring = exp(PartS_4426,Nc_4420) in
                            {4079}out(c, senc(mCli(pkCli_3856,pkSess_4417),Kcli_4429))
        )
        else
            {4080}let pkDisco_4430: bitstring = fail-any in
            {4081}let v_4431: bool = (Sess = A) in
            (
                {4082}if v_4431 then
                (
                    {4083}let pkSess_4432: bitstring = pub(skA) in
                    {4084}out(c, GetEndpointRequest);
                    {4085}in(c, (=GetEndpointResponse,=pkSess_4432,=Sign,SP_4433: bitstring,UP_4434: bitstring));
                    {4086}new Nc_4435: bitstring;
                    {4087}let gNc_4436: bitstring = exp(g,Nc_4435) in
                    {4088}let m1_4437: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4436) in
                    {4089}out(c, (pkCli_3856,m1_4437,sign(h(m1_4437),skCli_3855)));
                    {4090}in(c, (em2_4438: bitstring,sigM2_4439: bitstring));
                    {4091}let m2_4440: bitstring = em2_4438 in
                    {4092}if (verify(h(m2_4440),sigM2_4439,pkSess_4432) <> true) then
                        0
                    else
                        {4093}let (=OpenSecureChannelResponse,PartS_4441: bitstring,ST_4442: bitstring,TTL_4443: bitstring) = m2_4440 in
                        {4094}let Kcli_4444: bitstring = exp(PartS_4441,Nc_4435) in
                        {4095}out(c, senc(mCli(pkCli_3856,pkSess_4432),Kcli_4444))
                )
                else
                    {4096}let v_4445: bool = (Sess = B) in
                    (
                        {4097}if v_4445 then
                        (
                            {4098}let pkSess_4446: bitstring = pub(skB) in
                            {4099}out(c, GetEndpointRequest);
                            {4100}in(c, (=GetEndpointResponse,=pkSess_4446,=Sign,SP_4447: bitstring,UP_4448: bitstring));
                            {4101}new Nc_4449: bitstring;
                            {4102}let gNc_4450: bitstring = exp(g,Nc_4449) in
                            {4103}let m1_4451: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4450) in
                            {4104}out(c, (pkCli_3856,m1_4451,sign(h(m1_4451),skCli_3855)));
                            {4105}in(c, (em2_4452: bitstring,sigM2_4453: bitstring));
                            {4106}let m2_4454: bitstring = em2_4452 in
                            {4107}if (verify(h(m2_4454),sigM2_4453,pkSess_4446) <> true) then
                                0
                            else
                                {4108}let (=OpenSecureChannelResponse,PartS_4455: bitstring,ST_4456: bitstring,TTL_4457: bitstring) = m2_4454 in
                                {4109}let Kcli_4458: bitstring = exp(PartS_4455,Nc_4449) in
                                {4110}out(c, senc(mCli(pkCli_3856,pkSess_4446),Kcli_4458))
                        )
                        else
                            {4111}let v_4459: bool = (Sess = C) in
                            (
                                {4112}if v_4459 then
                                (
                                    {4113}let pkSess_4460: bitstring = pub(skC) in
                                    {4114}out(c, GetEndpointRequest);
                                    {4115}in(c, (=GetEndpointResponse,=pkSess_4460,=Sign,SP_4461: bitstring,UP_4462: bitstring));
                                    {4116}new Nc_4463: bitstring;
                                    {4117}let gNc_4464: bitstring = exp(g,Nc_4463) in
                                    {4118}let m1_4465: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4464) in
                                    {4119}out(c, (pkCli_3856,m1_4465,sign(h(m1_4465),skCli_3855)));
                                    {4120}in(c, (em2_4466: bitstring,sigM2_4467: bitstring));
                                    {4121}let m2_4468: bitstring = em2_4466 in
                                    {4122}if (verify(h(m2_4468),sigM2_4467,pkSess_4460) <> true) then
                                        0
                                    else
                                        {4123}let (=OpenSecureChannelResponse,PartS_4469: bitstring,ST_4470: bitstring,TTL_4471: bitstring) = m2_4468 in
                                        {4124}let Kcli_4472: bitstring = exp(PartS_4469,Nc_4463) in
                                        {4125}out(c, senc(mCli(pkCli_3856,pkSess_4460),Kcli_4472))
                                )
                                else
                                    {4126}let pkSess_4473: bitstring = pub(sk(Sess)) in
                                    {4127}out(c, GetEndpointRequest);
                                    {4128}in(c, (=GetEndpointResponse,=pkSess_4473,=Sign,SP_4474: bitstring,UP_4475: bitstring));
                                    {4129}new Nc_4476: bitstring;
                                    {4130}let gNc_4477: bitstring = exp(g,Nc_4476) in
                                    {4131}let m1_4478: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4477) in
                                    {4132}out(c, (pkCli_3856,m1_4478,sign(h(m1_4478),skCli_3855)));
                                    {4133}in(c, (em2_4479: bitstring,sigM2_4480: bitstring));
                                    {4134}let m2_4481: bitstring = em2_4479 in
                                    {4135}if (verify(h(m2_4481),sigM2_4480,pkSess_4473) <> true) then
                                        0
                                    else
                                        {4136}let (=OpenSecureChannelResponse,PartS_4482: bitstring,ST_4483: bitstring,TTL_4484: bitstring) = m2_4481 in
                                        {4137}let Kcli_4485: bitstring = exp(PartS_4482,Nc_4476) in
                                        {4138}out(c, senc(mCli(pkCli_3856,pkSess_4473),Kcli_4485))
                            )
                            else
                                {4139}let pkSess_4486: bitstring = fail-any in
                                {4140}out(c, GetEndpointRequest);
                                {4141}in(c, (=GetEndpointResponse,=pkSess_4486,=Sign,SP_4487: bitstring,UP_4488: bitstring));
                                {4142}new Nc_4489: bitstring;
                                {4143}let gNc_4490: bitstring = exp(g,Nc_4489) in
                                {4144}let m1_4491: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4490) in
                                {4145}out(c, (pkCli_3856,m1_4491,sign(h(m1_4491),skCli_3855)));
                                {4146}in(c, (em2_4492: bitstring,sigM2_4493: bitstring));
                                {4147}let m2_4494: bitstring = em2_4492 in
                                {4148}if (verify(h(m2_4494),sigM2_4493,pkSess_4486) <> true) then
                                    0
                                else
                                    {4149}let (=OpenSecureChannelResponse,PartS_4495: bitstring,ST_4496: bitstring,TTL_4497: bitstring) = m2_4494 in
                                    {4150}let Kcli_4498: bitstring = exp(PartS_4495,Nc_4489) in
                                    {4151}out(c, senc(mCli(pkCli_3856,pkSess_4486),Kcli_4498))
                    )
                    else
                        {4152}let pkSess_4499: bitstring = fail-any in
                        {4153}out(c, GetEndpointRequest);
                        {4154}in(c, (=GetEndpointResponse,=pkSess_4499,=Sign,SP_4500: bitstring,UP_4501: bitstring));
                        {4155}new Nc_4502: bitstring;
                        {4156}let gNc_4503: bitstring = exp(g,Nc_4502) in
                        {4157}let m1_4504: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4503) in
                        {4158}out(c, (pkCli_3856,m1_4504,sign(h(m1_4504),skCli_3855)));
                        {4159}in(c, (em2_4505: bitstring,sigM2_4506: bitstring));
                        {4160}let m2_4507: bitstring = em2_4505 in
                        {4161}if (verify(h(m2_4507),sigM2_4506,pkSess_4499) <> true) then
                            0
                        else
                            {4162}let (=OpenSecureChannelResponse,PartS_4508: bitstring,ST_4509: bitstring,TTL_4510: bitstring) = m2_4507 in
                            {4163}let Kcli_4511: bitstring = exp(PartS_4508,Nc_4502) in
                            {4164}out(c, senc(mCli(pkCli_3856,pkSess_4499),Kcli_4511))
            )
            else
                {4165}let pkSess_4512: bitstring = fail-any in
                {4166}out(c, GetEndpointRequest);
                {4167}in(c, (=GetEndpointResponse,=pkSess_4512,=Sign,SP_4513: bitstring,UP_4514: bitstring));
                {4168}new Nc_4515: bitstring;
                {4169}let gNc_4516: bitstring = exp(g,Nc_4515) in
                {4170}let m1_4517: bitstring = (OpenSecureChannelRequest,pkCli_3856,gNc_4516) in
                {4171}out(c, (pkCli_3856,m1_4517,sign(h(m1_4517),skCli_3855)));
                {4172}in(c, (em2_4518: bitstring,sigM2_4519: bitstring));
                {4173}let m2_4520: bitstring = em2_4518 in
                {4174}if (verify(h(m2_4520),sigM2_4519,pkSess_4512) <> true) then
                    0
                else
                    {4175}let (=OpenSecureChannelResponse,PartS_4521: bitstring,ST_4522: bitstring,TTL_4523: bitstring) = m2_4520 in
                    {4176}let Kcli_4524: bitstring = exp(PartS_4521,Nc_4515) in
                    {4177}out(c, senc(mCli(pkCli_3856,pkSess_4512),Kcli_4524))
) | (
    {4178}!
    {4179}in(c, (Cli_4525: host,Disco_4526: host,Sess_4527: host));
    {4180}let v_4528: bool = (Disco_4526 = A) in
    (
        {4181}if v_4528 then
        (
            {4182}let skDisco: bitstring = skA in
            {4183}let pkDisco_4529: bitstring = pub(skDisco) in
            {4184}let v_4530: bool = (Cli_4525 = A) in
            (
                {4185}if v_4530 then
                (
                    {4186}let pkCli_4531: bitstring = pub(skA) in
                    {4187}let v_4532: bool = (Sess_4527 = A) in
                    (
                        {4188}if v_4532 then
                        (
                            {4189}let pkSess_4533: bitstring = pub(skA) in
                            {4190}in(c, =GetEndpointRequest);
                            {4191}new SP_4534: bitstring;
                            {4192}new UP_4535: bitstring;
                            {4193}out(c, (GetEndpointResponse,pkSess_4533,None,SP_4534,UP_4535))
                        )
                        else
                            {4194}let v_4536: bool = (Sess_4527 = B) in
                            (
                                {4195}if v_4536 then
                                (
                                    {4196}let pkSess_4537: bitstring = pub(skB) in
                                    {4197}in(c, =GetEndpointRequest);
                                    {4198}new SP_4538: bitstring;
                                    {4199}new UP_4539: bitstring;
                                    {4200}out(c, (GetEndpointResponse,pkSess_4537,None,SP_4538,UP_4539))
                                )
                                else
                                    {4201}let v_4540: bool = (Sess_4527 = C) in
                                    (
                                        {4202}if v_4540 then
                                        (
                                            {4203}let pkSess_4541: bitstring = pub(skC) in
                                            {4204}in(c, =GetEndpointRequest);
                                            {4205}new SP_4542: bitstring;
                                            {4206}new UP_4543: bitstring;
                                            {4207}out(c, (GetEndpointResponse,pkSess_4541,None,SP_4542,UP_4543))
                                        )
                                        else
                                            {4208}let pkSess_4544: bitstring = pub(sk(Sess_4527)) in
                                            {4209}in(c, =GetEndpointRequest);
                                            {4210}new SP_4545: bitstring;
                                            {4211}new UP_4546: bitstring;
                                            {4212}out(c, (GetEndpointResponse,pkSess_4544,None,SP_4545,UP_4546))
                                    )
                                    else
                                        {4213}let pkSess_4547: bitstring = fail-any in
                                        {4214}in(c, =GetEndpointRequest);
                                        {4215}new SP_4548: bitstring;
                                        {4216}new UP_4549: bitstring;
                                        {4217}out(c, (GetEndpointResponse,pkSess_4547,None,SP_4548,UP_4549))
                            )
                            else
                                {4218}let pkSess_4550: bitstring = fail-any in
                                {4219}in(c, =GetEndpointRequest);
                                {4220}new SP_4551: bitstring;
                                {4221}new UP_4552: bitstring;
                                {4222}out(c, (GetEndpointResponse,pkSess_4550,None,SP_4551,UP_4552))
                    )
                    else
                        {4223}let pkSess_4553: bitstring = fail-any in
                        {4224}in(c, =GetEndpointRequest);
                        {4225}new SP_4554: bitstring;
                        {4226}new UP_4555: bitstring;
                        {4227}out(c, (GetEndpointResponse,pkSess_4553,None,SP_4554,UP_4555))
                )
                else
                    {4228}let v_4556: bool = (Cli_4525 = B) in
                    (
                        {4229}if v_4556 then
                        (
                            {4230}let pkCli_4557: bitstring = pub(skB) in
                            {4231}let v_4558: bool = (Sess_4527 = A) in
                            (
                                {4232}if v_4558 then
                                (
                                    {4233}let pkSess_4559: bitstring = pub(skA) in
                                    {4234}in(c, =GetEndpointRequest);
                                    {4235}new SP_4560: bitstring;
                                    {4236}new UP_4561: bitstring;
                                    {4237}out(c, (GetEndpointResponse,pkSess_4559,None,SP_4560,UP_4561))
                                )
                                else
                                    {4238}let v_4562: bool = (Sess_4527 = B) in
                                    (
                                        {4239}if v_4562 then
                                        (
                                            {4240}let pkSess_4563: bitstring = pub(skB) in
                                            {4241}in(c, =GetEndpointRequest);
                                            {4242}new SP_4564: bitstring;
                                            {4243}new UP_4565: bitstring;
                                            {4244}out(c, (GetEndpointResponse,pkSess_4563,None,SP_4564,UP_4565))
                                        )
                                        else
                                            {4245}let v_4566: bool = (Sess_4527 = C) in
                                            (
                                                {4246}if v_4566 then
                                                (
                                                    {4247}let pkSess_4567: bitstring = pub(skC) in
                                                    {4248}in(c, =GetEndpointRequest);
                                                    {4249}new SP_4568: bitstring;
                                                    {4250}new UP_4569: bitstring;
                                                    {4251}out(c, (GetEndpointResponse,pkSess_4567,None,SP_4568,UP_4569))
                                                )
                                                else
                                                    {4252}let pkSess_4570: bitstring = pub(sk(Sess_4527)) in
                                                    {4253}in(c, =GetEndpointRequest);
                                                    {4254}new SP_4571: bitstring;
                                                    {4255}new UP_4572: bitstring;
                                                    {4256}out(c, (GetEndpointResponse,pkSess_4570,None,SP_4571,UP_4572))
                                            )
                                            else
                                                {4257}let pkSess_4573: bitstring = fail-any in
                                                {4258}in(c, =GetEndpointRequest);
                                                {4259}new SP_4574: bitstring;
                                                {4260}new UP_4575: bitstring;
                                                {4261}out(c, (GetEndpointResponse,pkSess_4573,None,SP_4574,UP_4575))
                                    )
                                    else
                                        {4262}let pkSess_4576: bitstring = fail-any in
                                        {4263}in(c, =GetEndpointRequest);
                                        {4264}new SP_4577: bitstring;
                                        {4265}new UP_4578: bitstring;
                                        {4266}out(c, (GetEndpointResponse,pkSess_4576,None,SP_4577,UP_4578))
                            )
                            else
                                {4267}let pkSess_4579: bitstring = fail-any in
                                {4268}in(c, =GetEndpointRequest);
                                {4269}new SP_4580: bitstring;
                                {4270}new UP_4581: bitstring;
                                {4271}out(c, (GetEndpointResponse,pkSess_4579,None,SP_4580,UP_4581))
                        )
                        else
                            {4272}let v_4582: bool = (Cli_4525 = C) in
                            (
                                {4273}if v_4582 then
                                (
                                    {4274}let pkCli_4583: bitstring = pub(skC) in
                                    {4275}let v_4584: bool = (Sess_4527 = A) in
                                    (
                                        {4276}if v_4584 then
                                        (
                                            {4277}let pkSess_4585: bitstring = pub(skA) in
                                            {4278}in(c, =GetEndpointRequest);
                                            {4279}new SP_4586: bitstring;
                                            {4280}new UP_4587: bitstring;
                                            {4281}out(c, (GetEndpointResponse,pkSess_4585,None,SP_4586,UP_4587))
                                        )
                                        else
                                            {4282}let v_4588: bool = (Sess_4527 = B) in
                                            (
                                                {4283}if v_4588 then
                                                (
                                                    {4284}let pkSess_4589: bitstring = pub(skB) in
                                                    {4285}in(c, =GetEndpointRequest);
                                                    {4286}new SP_4590: bitstring;
                                                    {4287}new UP_4591: bitstring;
                                                    {4288}out(c, (GetEndpointResponse,pkSess_4589,None,SP_4590,UP_4591))
                                                )
                                                else
                                                    {4289}let v_4592: bool = (Sess_4527 = C) in
                                                    (
                                                        {4290}if v_4592 then
                                                        (
                                                            {4291}let pkSess_4593: bitstring = pub(skC) in
                                                            {4292}in(c, =GetEndpointRequest);
                                                            {4293}new SP_4594: bitstring;
                                                            {4294}new UP_4595: bitstring;
                                                            {4295}out(c, (GetEndpointResponse,pkSess_4593,None,SP_4594,UP_4595))
                                                        )
                                                        else
                                                            {4296}let pkSess_4596: bitstring = pub(sk(Sess_4527)) in
                                                            {4297}in(c, =GetEndpointRequest);
                                                            {4298}new SP_4597: bitstring;
                                                            {4299}new UP_4598: bitstring;
                                                            {4300}out(c, (GetEndpointResponse,pkSess_4596,None,SP_4597,UP_4598))
                                                    )
                                                    else
                                                        {4301}let pkSess_4599: bitstring = fail-any in
                                                        {4302}in(c, =GetEndpointRequest);
                                                        {4303}new SP_4600: bitstring;
                                                        {4304}new UP_4601: bitstring;
                                                        {4305}out(c, (GetEndpointResponse,pkSess_4599,None,SP_4600,UP_4601))
                                            )
                                            else
                                                {4306}let pkSess_4602: bitstring = fail-any in
                                                {4307}in(c, =GetEndpointRequest);
                                                {4308}new SP_4603: bitstring;
                                                {4309}new UP_4604: bitstring;
                                                {4310}out(c, (GetEndpointResponse,pkSess_4602,None,SP_4603,UP_4604))
                                    )
                                    else
                                        {4311}let pkSess_4605: bitstring = fail-any in
                                        {4312}in(c, =GetEndpointRequest);
                                        {4313}new SP_4606: bitstring;
                                        {4314}new UP_4607: bitstring;
                                        {4315}out(c, (GetEndpointResponse,pkSess_4605,None,SP_4606,UP_4607))
                                )
                                else
                                    {4316}let pkCli_4608: bitstring = pub(sk(Cli_4525)) in
                                    {4317}let v_4609: bool = (Sess_4527 = A) in
                                    (
                                        {4318}if v_4609 then
                                        (
                                            {4319}let pkSess_4610: bitstring = pub(skA) in
                                            {4320}in(c, =GetEndpointRequest);
                                            {4321}new SP_4611: bitstring;
                                            {4322}new UP_4612: bitstring;
                                            {4323}out(c, (GetEndpointResponse,pkSess_4610,None,SP_4611,UP_4612))
                                        )
                                        else
                                            {4324}let v_4613: bool = (Sess_4527 = B) in
                                            (
                                                {4325}if v_4613 then
                                                (
                                                    {4326}let pkSess_4614: bitstring = pub(skB) in
                                                    {4327}in(c, =GetEndpointRequest);
                                                    {4328}new SP_4615: bitstring;
                                                    {4329}new UP_4616: bitstring;
                                                    {4330}out(c, (GetEndpointResponse,pkSess_4614,None,SP_4615,UP_4616))
                                                )
                                                else
                                                    {4331}let v_4617: bool = (Sess_4527 = C) in
                                                    (
                                                        {4332}if v_4617 then
                                                        (
                                                            {4333}let pkSess_4618: bitstring = pub(skC) in
                                                            {4334}in(c, =GetEndpointRequest);
                                                            {4335}new SP_4619: bitstring;
                                                            {4336}new UP_4620: bitstring;
                                                            {4337}out(c, (GetEndpointResponse,pkSess_4618,None,SP_4619,UP_4620))
                                                        )
                                                        else
                                                            {4338}let pkSess_4621: bitstring = pub(sk(Sess_4527)) in
                                                            {4339}in(c, =GetEndpointRequest);
                                                            {4340}new SP_4622: bitstring;
                                                            {4341}new UP_4623: bitstring;
                                                            {4342}out(c, (GetEndpointResponse,pkSess_4621,None,SP_4622,UP_4623))
                                                    )
                                                    else
                                                        {4343}let pkSess_4624: bitstring = fail-any in
                                                        {4344}in(c, =GetEndpointRequest);
                                                        {4345}new SP_4625: bitstring;
                                                        {4346}new UP_4626: bitstring;
                                                        {4347}out(c, (GetEndpointResponse,pkSess_4624,None,SP_4625,UP_4626))
                                            )
                                            else
                                                {4348}let pkSess_4627: bitstring = fail-any in
                                                {4349}in(c, =GetEndpointRequest);
                                                {4350}new SP_4628: bitstring;
                                                {4351}new UP_4629: bitstring;
                                                {4352}out(c, (GetEndpointResponse,pkSess_4627,None,SP_4628,UP_4629))
                                    )
                                    else
                                        {4353}let pkSess_4630: bitstring = fail-any in
                                        {4354}in(c, =GetEndpointRequest);
                                        {4355}new SP_4631: bitstring;
                                        {4356}new UP_4632: bitstring;
                                        {4357}out(c, (GetEndpointResponse,pkSess_4630,None,SP_4631,UP_4632))
                            )
                            else
                                {4358}let pkCli_4633: bitstring = fail-any in
                                {4359}let v_4634: bool = (Sess_4527 = A) in
                                (
                                    {4360}if v_4634 then
                                    (
                                        {4361}let pkSess_4635: bitstring = pub(skA) in
                                        {4362}in(c, =GetEndpointRequest);
                                        {4363}new SP_4636: bitstring;
                                        {4364}new UP_4637: bitstring;
                                        {4365}out(c, (GetEndpointResponse,pkSess_4635,None,SP_4636,UP_4637))
                                    )
                                    else
                                        {4366}let v_4638: bool = (Sess_4527 = B) in
                                        (
                                            {4367}if v_4638 then
                                            (
                                                {4368}let pkSess_4639: bitstring = pub(skB) in
                                                {4369}in(c, =GetEndpointRequest);
                                                {4370}new SP_4640: bitstring;
                                                {4371}new UP_4641: bitstring;
                                                {4372}out(c, (GetEndpointResponse,pkSess_4639,None,SP_4640,UP_4641))
                                            )
                                            else
                                                {4373}let v_4642: bool = (Sess_4527 = C) in
                                                (
                                                    {4374}if v_4642 then
                                                    (
                                                        {4375}let pkSess_4643: bitstring = pub(skC) in
                                                        {4376}in(c, =GetEndpointRequest);
                                                        {4377}new SP_4644: bitstring;
                                                        {4378}new UP_4645: bitstring;
                                                        {4379}out(c, (GetEndpointResponse,pkSess_4643,None,SP_4644,UP_4645))
                                                    )
                                                    else
                                                        {4380}let pkSess_4646: bitstring = pub(sk(Sess_4527)) in
                                                        {4381}in(c, =GetEndpointRequest);
                                                        {4382}new SP_4647: bitstring;
                                                        {4383}new UP_4648: bitstring;
                                                        {4384}out(c, (GetEndpointResponse,pkSess_4646,None,SP_4647,UP_4648))
                                                )
                                                else
                                                    {4385}let pkSess_4649: bitstring = fail-any in
                                                    {4386}in(c, =GetEndpointRequest);
                                                    {4387}new SP_4650: bitstring;
                                                    {4388}new UP_4651: bitstring;
                                                    {4389}out(c, (GetEndpointResponse,pkSess_4649,None,SP_4650,UP_4651))
                                        )
                                        else
                                            {4390}let pkSess_4652: bitstring = fail-any in
                                            {4391}in(c, =GetEndpointRequest);
                                            {4392}new SP_4653: bitstring;
                                            {4393}new UP_4654: bitstring;
                                            {4394}out(c, (GetEndpointResponse,pkSess_4652,None,SP_4653,UP_4654))
                                )
                                else
                                    {4395}let pkSess_4655: bitstring = fail-any in
                                    {4396}in(c, =GetEndpointRequest);
                                    {4397}new SP_4656: bitstring;
                                    {4398}new UP_4657: bitstring;
                                    {4399}out(c, (GetEndpointResponse,pkSess_4655,None,SP_4656,UP_4657))
                    )
                    else
                        {4400}let pkCli_4658: bitstring = fail-any in
                        {4401}let v_4659: bool = (Sess_4527 = A) in
                        (
                            {4402}if v_4659 then
                            (
                                {4403}let pkSess_4660: bitstring = pub(skA) in
                                {4404}in(c, =GetEndpointRequest);
                                {4405}new SP_4661: bitstring;
                                {4406}new UP_4662: bitstring;
                                {4407}out(c, (GetEndpointResponse,pkSess_4660,None,SP_4661,UP_4662))
                            )
                            else
                                {4408}let v_4663: bool = (Sess_4527 = B) in
                                (
                                    {4409}if v_4663 then
                                    (
                                        {4410}let pkSess_4664: bitstring = pub(skB) in
                                        {4411}in(c, =GetEndpointRequest);
                                        {4412}new SP_4665: bitstring;
                                        {4413}new UP_4666: bitstring;
                                        {4414}out(c, (GetEndpointResponse,pkSess_4664,None,SP_4665,UP_4666))
                                    )
                                    else
                                        {4415}let v_4667: bool = (Sess_4527 = C) in
                                        (
                                            {4416}if v_4667 then
                                            (
                                                {4417}let pkSess_4668: bitstring = pub(skC) in
                                                {4418}in(c, =GetEndpointRequest);
                                                {4419}new SP_4669: bitstring;
                                                {4420}new UP_4670: bitstring;
                                                {4421}out(c, (GetEndpointResponse,pkSess_4668,None,SP_4669,UP_4670))
                                            )
                                            else
                                                {4422}let pkSess_4671: bitstring = pub(sk(Sess_4527)) in
                                                {4423}in(c, =GetEndpointRequest);
                                                {4424}new SP_4672: bitstring;
                                                {4425}new UP_4673: bitstring;
                                                {4426}out(c, (GetEndpointResponse,pkSess_4671,None,SP_4672,UP_4673))
                                        )
                                        else
                                            {4427}let pkSess_4674: bitstring = fail-any in
                                            {4428}in(c, =GetEndpointRequest);
                                            {4429}new SP_4675: bitstring;
                                            {4430}new UP_4676: bitstring;
                                            {4431}out(c, (GetEndpointResponse,pkSess_4674,None,SP_4675,UP_4676))
                                )
                                else
                                    {4432}let pkSess_4677: bitstring = fail-any in
                                    {4433}in(c, =GetEndpointRequest);
                                    {4434}new SP_4678: bitstring;
                                    {4435}new UP_4679: bitstring;
                                    {4436}out(c, (GetEndpointResponse,pkSess_4677,None,SP_4678,UP_4679))
                        )
                        else
                            {4437}let pkSess_4680: bitstring = fail-any in
                            {4438}in(c, =GetEndpointRequest);
                            {4439}new SP_4681: bitstring;
                            {4440}new UP_4682: bitstring;
                            {4441}out(c, (GetEndpointResponse,pkSess_4680,None,SP_4681,UP_4682))
            )
            else
                {4442}let pkCli_4683: bitstring = fail-any in
                {4443}let v_4684: bool = (Sess_4527 = A) in
                (
                    {4444}if v_4684 then
                    (
                        {4445}let pkSess_4685: bitstring = pub(skA) in
                        {4446}in(c, =GetEndpointRequest);
                        {4447}new SP_4686: bitstring;
                        {4448}new UP_4687: bitstring;
                        {4449}out(c, (GetEndpointResponse,pkSess_4685,None,SP_4686,UP_4687))
                    )
                    else
                        {4450}let v_4688: bool = (Sess_4527 = B) in
                        (
                            {4451}if v_4688 then
                            (
                                {4452}let pkSess_4689: bitstring = pub(skB) in
                                {4453}in(c, =GetEndpointRequest);
                                {4454}new SP_4690: bitstring;
                                {4455}new UP_4691: bitstring;
                                {4456}out(c, (GetEndpointResponse,pkSess_4689,None,SP_4690,UP_4691))
                            )
                            else
                                {4457}let v_4692: bool = (Sess_4527 = C) in
                                (
                                    {4458}if v_4692 then
                                    (
                                        {4459}let pkSess_4693: bitstring = pub(skC) in
                                        {4460}in(c, =GetEndpointRequest);
                                        {4461}new SP_4694: bitstring;
                                        {4462}new UP_4695: bitstring;
                                        {4463}out(c, (GetEndpointResponse,pkSess_4693,None,SP_4694,UP_4695))
                                    )
                                    else
                                        {4464}let pkSess_4696: bitstring = pub(sk(Sess_4527)) in
                                        {4465}in(c, =GetEndpointRequest);
                                        {4466}new SP_4697: bitstring;
                                        {4467}new UP_4698: bitstring;
                                        {4468}out(c, (GetEndpointResponse,pkSess_4696,None,SP_4697,UP_4698))
                                )
                                else
                                    {4469}let pkSess_4699: bitstring = fail-any in
                                    {4470}in(c, =GetEndpointRequest);
                                    {4471}new SP_4700: bitstring;
                                    {4472}new UP_4701: bitstring;
                                    {4473}out(c, (GetEndpointResponse,pkSess_4699,None,SP_4700,UP_4701))
                        )
                        else
                            {4474}let pkSess_4702: bitstring = fail-any in
                            {4475}in(c, =GetEndpointRequest);
                            {4476}new SP_4703: bitstring;
                            {4477}new UP_4704: bitstring;
                            {4478}out(c, (GetEndpointResponse,pkSess_4702,None,SP_4703,UP_4704))
                )
                else
                    {4479}let pkSess_4705: bitstring = fail-any in
                    {4480}in(c, =GetEndpointRequest);
                    {4481}new SP_4706: bitstring;
                    {4482}new UP_4707: bitstring;
                    {4483}out(c, (GetEndpointResponse,pkSess_4705,None,SP_4706,UP_4707))
        )
        else
            {4484}let v_4708: bool = (Disco_4526 = B) in
            (
                {4485}if v_4708 then
                (
                    {4486}let skDisco_4709: bitstring = skB in
                    {4487}let pkDisco_4710: bitstring = pub(skDisco_4709) in
                    {4488}let v_4711: bool = (Cli_4525 = A) in
                    (
                        {4489}if v_4711 then
                        (
                            {4490}let pkCli_4712: bitstring = pub(skA) in
                            {4491}let v_4713: bool = (Sess_4527 = A) in
                            (
                                {4492}if v_4713 then
                                (
                                    {4493}let pkSess_4714: bitstring = pub(skA) in
                                    {4494}in(c, =GetEndpointRequest);
                                    {4495}new SP_4715: bitstring;
                                    {4496}new UP_4716: bitstring;
                                    {4497}out(c, (GetEndpointResponse,pkSess_4714,None,SP_4715,UP_4716))
                                )
                                else
                                    {4498}let v_4717: bool = (Sess_4527 = B) in
                                    (
                                        {4499}if v_4717 then
                                        (
                                            {4500}let pkSess_4718: bitstring = pub(skB) in
                                            {4501}in(c, =GetEndpointRequest);
                                            {4502}new SP_4719: bitstring;
                                            {4503}new UP_4720: bitstring;
                                            {4504}out(c, (GetEndpointResponse,pkSess_4718,None,SP_4719,UP_4720))
                                        )
                                        else
                                            {4505}let v_4721: bool = (Sess_4527 = C) in
                                            (
                                                {4506}if v_4721 then
                                                (
                                                    {4507}let pkSess_4722: bitstring = pub(skC) in
                                                    {4508}in(c, =GetEndpointRequest);
                                                    {4509}new SP_4723: bitstring;
                                                    {4510}new UP_4724: bitstring;
                                                    {4511}out(c, (GetEndpointResponse,pkSess_4722,None,SP_4723,UP_4724))
                                                )
                                                else
                                                    {4512}let pkSess_4725: bitstring = pub(sk(Sess_4527)) in
                                                    {4513}in(c, =GetEndpointRequest);
                                                    {4514}new SP_4726: bitstring;
                                                    {4515}new UP_4727: bitstring;
                                                    {4516}out(c, (GetEndpointResponse,pkSess_4725,None,SP_4726,UP_4727))
                                            )
                                            else
                                                {4517}let pkSess_4728: bitstring = fail-any in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4729: bitstring;
                                                {4520}new UP_4730: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4728,None,SP_4729,UP_4730))
                                    )
                                    else
                                        {4522}let pkSess_4731: bitstring = fail-any in
                                        {4523}in(c, =GetEndpointRequest);
                                        {4524}new SP_4732: bitstring;
                                        {4525}new UP_4733: bitstring;
                                        {4526}out(c, (GetEndpointResponse,pkSess_4731,None,SP_4732,UP_4733))
                            )
                            else
                                {4527}let pkSess_4734: bitstring = fail-any in
                                {4528}in(c, =GetEndpointRequest);
                                {4529}new SP_4735: bitstring;
                                {4530}new UP_4736: bitstring;
                                {4531}out(c, (GetEndpointResponse,pkSess_4734,None,SP_4735,UP_4736))
                        )
                        else
                            {4532}let v_4737: bool = (Cli_4525 = B) in
                            (
                                {4533}if v_4737 then
                                (
                                    {4534}let pkCli_4738: bitstring = pub(skB) in
                                    {4535}let v_4739: bool = (Sess_4527 = A) in
                                    (
                                        {4536}if v_4739 then
                                        (
                                            {4537}let pkSess_4740: bitstring = pub(skA) in
                                            {4538}in(c, =GetEndpointRequest);
                                            {4539}new SP_4741: bitstring;
                                            {4540}new UP_4742: bitstring;
                                            {4541}out(c, (GetEndpointResponse,pkSess_4740,None,SP_4741,UP_4742))
                                        )
                                        else
                                            {4542}let v_4743: bool = (Sess_4527 = B) in
                                            (
                                                {4543}if v_4743 then
                                                (
                                                    {4544}let pkSess_4744: bitstring = pub(skB) in
                                                    {4545}in(c, =GetEndpointRequest);
                                                    {4546}new SP_4745: bitstring;
                                                    {4547}new UP_4746: bitstring;
                                                    {4548}out(c, (GetEndpointResponse,pkSess_4744,None,SP_4745,UP_4746))
                                                )
                                                else
                                                    {4549}let v_4747: bool = (Sess_4527 = C) in
                                                    (
                                                        {4550}if v_4747 then
                                                        (
                                                            {4551}let pkSess_4748: bitstring = pub(skC) in
                                                            {4552}in(c, =GetEndpointRequest);
                                                            {4553}new SP_4749: bitstring;
                                                            {4554}new UP_4750: bitstring;
                                                            {4555}out(c, (GetEndpointResponse,pkSess_4748,None,SP_4749,UP_4750))
                                                        )
                                                        else
                                                            {4556}let pkSess_4751: bitstring = pub(sk(Sess_4527)) in
                                                            {4557}in(c, =GetEndpointRequest);
                                                            {4558}new SP_4752: bitstring;
                                                            {4559}new UP_4753: bitstring;
                                                            {4560}out(c, (GetEndpointResponse,pkSess_4751,None,SP_4752,UP_4753))
                                                    )
                                                    else
                                                        {4561}let pkSess_4754: bitstring = fail-any in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4755: bitstring;
                                                        {4564}new UP_4756: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4754,None,SP_4755,UP_4756))
                                            )
                                            else
                                                {4566}let pkSess_4757: bitstring = fail-any in
                                                {4567}in(c, =GetEndpointRequest);
                                                {4568}new SP_4758: bitstring;
                                                {4569}new UP_4759: bitstring;
                                                {4570}out(c, (GetEndpointResponse,pkSess_4757,None,SP_4758,UP_4759))
                                    )
                                    else
                                        {4571}let pkSess_4760: bitstring = fail-any in
                                        {4572}in(c, =GetEndpointRequest);
                                        {4573}new SP_4761: bitstring;
                                        {4574}new UP_4762: bitstring;
                                        {4575}out(c, (GetEndpointResponse,pkSess_4760,None,SP_4761,UP_4762))
                                )
                                else
                                    {4576}let v_4763: bool = (Cli_4525 = C) in
                                    (
                                        {4577}if v_4763 then
                                        (
                                            {4578}let pkCli_4764: bitstring = pub(skC) in
                                            {4579}let v_4765: bool = (Sess_4527 = A) in
                                            (
                                                {4580}if v_4765 then
                                                (
                                                    {4581}let pkSess_4766: bitstring = pub(skA) in
                                                    {4582}in(c, =GetEndpointRequest);
                                                    {4583}new SP_4767: bitstring;
                                                    {4584}new UP_4768: bitstring;
                                                    {4585}out(c, (GetEndpointResponse,pkSess_4766,None,SP_4767,UP_4768))
                                                )
                                                else
                                                    {4586}let v_4769: bool = (Sess_4527 = B) in
                                                    (
                                                        {4587}if v_4769 then
                                                        (
                                                            {4588}let pkSess_4770: bitstring = pub(skB) in
                                                            {4589}in(c, =GetEndpointRequest);
                                                            {4590}new SP_4771: bitstring;
                                                            {4591}new UP_4772: bitstring;
                                                            {4592}out(c, (GetEndpointResponse,pkSess_4770,None,SP_4771,UP_4772))
                                                        )
                                                        else
                                                            {4593}let v_4773: bool = (Sess_4527 = C) in
                                                            (
                                                                {4594}if v_4773 then
                                                                (
                                                                    {4595}let pkSess_4774: bitstring = pub(skC) in
                                                                    {4596}in(c, =GetEndpointRequest);
                                                                    {4597}new SP_4775: bitstring;
                                                                    {4598}new UP_4776: bitstring;
                                                                    {4599}out(c, (GetEndpointResponse,pkSess_4774,None,SP_4775,UP_4776))
                                                                )
                                                                else
                                                                    {4600}let pkSess_4777: bitstring = pub(sk(Sess_4527)) in
                                                                    {4601}in(c, =GetEndpointRequest);
                                                                    {4602}new SP_4778: bitstring;
                                                                    {4603}new UP_4779: bitstring;
                                                                    {4604}out(c, (GetEndpointResponse,pkSess_4777,None,SP_4778,UP_4779))
                                                            )
                                                            else
                                                                {4605}let pkSess_4780: bitstring = fail-any in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4781: bitstring;
                                                                {4608}new UP_4782: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4780,None,SP_4781,UP_4782))
                                                    )
                                                    else
                                                        {4610}let pkSess_4783: bitstring = fail-any in
                                                        {4611}in(c, =GetEndpointRequest);
                                                        {4612}new SP_4784: bitstring;
                                                        {4613}new UP_4785: bitstring;
                                                        {4614}out(c, (GetEndpointResponse,pkSess_4783,None,SP_4784,UP_4785))
                                            )
                                            else
                                                {4615}let pkSess_4786: bitstring = fail-any in
                                                {4616}in(c, =GetEndpointRequest);
                                                {4617}new SP_4787: bitstring;
                                                {4618}new UP_4788: bitstring;
                                                {4619}out(c, (GetEndpointResponse,pkSess_4786,None,SP_4787,UP_4788))
                                        )
                                        else
                                            {4620}let pkCli_4789: bitstring = pub(sk(Cli_4525)) in
                                            {4621}let v_4790: bool = (Sess_4527 = A) in
                                            (
                                                {4622}if v_4790 then
                                                (
                                                    {4623}let pkSess_4791: bitstring = pub(skA) in
                                                    {4624}in(c, =GetEndpointRequest);
                                                    {4625}new SP_4792: bitstring;
                                                    {4626}new UP_4793: bitstring;
                                                    {4627}out(c, (GetEndpointResponse,pkSess_4791,None,SP_4792,UP_4793))
                                                )
                                                else
                                                    {4628}let v_4794: bool = (Sess_4527 = B) in
                                                    (
                                                        {4629}if v_4794 then
                                                        (
                                                            {4630}let pkSess_4795: bitstring = pub(skB) in
                                                            {4631}in(c, =GetEndpointRequest);
                                                            {4632}new SP_4796: bitstring;
                                                            {4633}new UP_4797: bitstring;
                                                            {4634}out(c, (GetEndpointResponse,pkSess_4795,None,SP_4796,UP_4797))
                                                        )
                                                        else
                                                            {4635}let v_4798: bool = (Sess_4527 = C) in
                                                            (
                                                                {4636}if v_4798 then
                                                                (
                                                                    {4637}let pkSess_4799: bitstring = pub(skC) in
                                                                    {4638}in(c, =GetEndpointRequest);
                                                                    {4639}new SP_4800: bitstring;
                                                                    {4640}new UP_4801: bitstring;
                                                                    {4641}out(c, (GetEndpointResponse,pkSess_4799,None,SP_4800,UP_4801))
                                                                )
                                                                else
                                                                    {4642}let pkSess_4802: bitstring = pub(sk(Sess_4527)) in
                                                                    {4643}in(c, =GetEndpointRequest);
                                                                    {4644}new SP_4803: bitstring;
                                                                    {4645}new UP_4804: bitstring;
                                                                    {4646}out(c, (GetEndpointResponse,pkSess_4802,None,SP_4803,UP_4804))
                                                            )
                                                            else
                                                                {4647}let pkSess_4805: bitstring = fail-any in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4806: bitstring;
                                                                {4650}new UP_4807: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4805,None,SP_4806,UP_4807))
                                                    )
                                                    else
                                                        {4652}let pkSess_4808: bitstring = fail-any in
                                                        {4653}in(c, =GetEndpointRequest);
                                                        {4654}new SP_4809: bitstring;
                                                        {4655}new UP_4810: bitstring;
                                                        {4656}out(c, (GetEndpointResponse,pkSess_4808,None,SP_4809,UP_4810))
                                            )
                                            else
                                                {4657}let pkSess_4811: bitstring = fail-any in
                                                {4658}in(c, =GetEndpointRequest);
                                                {4659}new SP_4812: bitstring;
                                                {4660}new UP_4813: bitstring;
                                                {4661}out(c, (GetEndpointResponse,pkSess_4811,None,SP_4812,UP_4813))
                                    )
                                    else
                                        {4662}let pkCli_4814: bitstring = fail-any in
                                        {4663}let v_4815: bool = (Sess_4527 = A) in
                                        (
                                            {4664}if v_4815 then
                                            (
                                                {4665}let pkSess_4816: bitstring = pub(skA) in
                                                {4666}in(c, =GetEndpointRequest);
                                                {4667}new SP_4817: bitstring;
                                                {4668}new UP_4818: bitstring;
                                                {4669}out(c, (GetEndpointResponse,pkSess_4816,None,SP_4817,UP_4818))
                                            )
                                            else
                                                {4670}let v_4819: bool = (Sess_4527 = B) in
                                                (
                                                    {4671}if v_4819 then
                                                    (
                                                        {4672}let pkSess_4820: bitstring = pub(skB) in
                                                        {4673}in(c, =GetEndpointRequest);
                                                        {4674}new SP_4821: bitstring;
                                                        {4675}new UP_4822: bitstring;
                                                        {4676}out(c, (GetEndpointResponse,pkSess_4820,None,SP_4821,UP_4822))
                                                    )
                                                    else
                                                        {4677}let v_4823: bool = (Sess_4527 = C) in
                                                        (
                                                            {4678}if v_4823 then
                                                            (
                                                                {4679}let pkSess_4824: bitstring = pub(skC) in
                                                                {4680}in(c, =GetEndpointRequest);
                                                                {4681}new SP_4825: bitstring;
                                                                {4682}new UP_4826: bitstring;
                                                                {4683}out(c, (GetEndpointResponse,pkSess_4824,None,SP_4825,UP_4826))
                                                            )
                                                            else
                                                                {4684}let pkSess_4827: bitstring = pub(sk(Sess_4527)) in
                                                                {4685}in(c, =GetEndpointRequest);
                                                                {4686}new SP_4828: bitstring;
                                                                {4687}new UP_4829: bitstring;
                                                                {4688}out(c, (GetEndpointResponse,pkSess_4827,None,SP_4828,UP_4829))
                                                        )
                                                        else
                                                            {4689}let pkSess_4830: bitstring = fail-any in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4831: bitstring;
                                                            {4692}new UP_4832: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4830,None,SP_4831,UP_4832))
                                                )
                                                else
                                                    {4694}let pkSess_4833: bitstring = fail-any in
                                                    {4695}in(c, =GetEndpointRequest);
                                                    {4696}new SP_4834: bitstring;
                                                    {4697}new UP_4835: bitstring;
                                                    {4698}out(c, (GetEndpointResponse,pkSess_4833,None,SP_4834,UP_4835))
                                        )
                                        else
                                            {4699}let pkSess_4836: bitstring = fail-any in
                                            {4700}in(c, =GetEndpointRequest);
                                            {4701}new SP_4837: bitstring;
                                            {4702}new UP_4838: bitstring;
                                            {4703}out(c, (GetEndpointResponse,pkSess_4836,None,SP_4837,UP_4838))
                            )
                            else
                                {4704}let pkCli_4839: bitstring = fail-any in
                                {4705}let v_4840: bool = (Sess_4527 = A) in
                                (
                                    {4706}if v_4840 then
                                    (
                                        {4707}let pkSess_4841: bitstring = pub(skA) in
                                        {4708}in(c, =GetEndpointRequest);
                                        {4709}new SP_4842: bitstring;
                                        {4710}new UP_4843: bitstring;
                                        {4711}out(c, (GetEndpointResponse,pkSess_4841,None,SP_4842,UP_4843))
                                    )
                                    else
                                        {4712}let v_4844: bool = (Sess_4527 = B) in
                                        (
                                            {4713}if v_4844 then
                                            (
                                                {4714}let pkSess_4845: bitstring = pub(skB) in
                                                {4715}in(c, =GetEndpointRequest);
                                                {4716}new SP_4846: bitstring;
                                                {4717}new UP_4847: bitstring;
                                                {4718}out(c, (GetEndpointResponse,pkSess_4845,None,SP_4846,UP_4847))
                                            )
                                            else
                                                {4719}let v_4848: bool = (Sess_4527 = C) in
                                                (
                                                    {4720}if v_4848 then
                                                    (
                                                        {4721}let pkSess_4849: bitstring = pub(skC) in
                                                        {4722}in(c, =GetEndpointRequest);
                                                        {4723}new SP_4850: bitstring;
                                                        {4724}new UP_4851: bitstring;
                                                        {4725}out(c, (GetEndpointResponse,pkSess_4849,None,SP_4850,UP_4851))
                                                    )
                                                    else
                                                        {4726}let pkSess_4852: bitstring = pub(sk(Sess_4527)) in
                                                        {4727}in(c, =GetEndpointRequest);
                                                        {4728}new SP_4853: bitstring;
                                                        {4729}new UP_4854: bitstring;
                                                        {4730}out(c, (GetEndpointResponse,pkSess_4852,None,SP_4853,UP_4854))
                                                )
                                                else
                                                    {4731}let pkSess_4855: bitstring = fail-any in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4856: bitstring;
                                                    {4734}new UP_4857: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4855,None,SP_4856,UP_4857))
                                        )
                                        else
                                            {4736}let pkSess_4858: bitstring = fail-any in
                                            {4737}in(c, =GetEndpointRequest);
                                            {4738}new SP_4859: bitstring;
                                            {4739}new UP_4860: bitstring;
                                            {4740}out(c, (GetEndpointResponse,pkSess_4858,None,SP_4859,UP_4860))
                                )
                                else
                                    {4741}let pkSess_4861: bitstring = fail-any in
                                    {4742}in(c, =GetEndpointRequest);
                                    {4743}new SP_4862: bitstring;
                                    {4744}new UP_4863: bitstring;
                                    {4745}out(c, (GetEndpointResponse,pkSess_4861,None,SP_4862,UP_4863))
                    )
                    else
                        {4746}let pkCli_4864: bitstring = fail-any in
                        {4747}let v_4865: bool = (Sess_4527 = A) in
                        (
                            {4748}if v_4865 then
                            (
                                {4749}let pkSess_4866: bitstring = pub(skA) in
                                {4750}in(c, =GetEndpointRequest);
                                {4751}new SP_4867: bitstring;
                                {4752}new UP_4868: bitstring;
                                {4753}out(c, (GetEndpointResponse,pkSess_4866,None,SP_4867,UP_4868))
                            )
                            else
                                {4754}let v_4869: bool = (Sess_4527 = B) in
                                (
                                    {4755}if v_4869 then
                                    (
                                        {4756}let pkSess_4870: bitstring = pub(skB) in
                                        {4757}in(c, =GetEndpointRequest);
                                        {4758}new SP_4871: bitstring;
                                        {4759}new UP_4872: bitstring;
                                        {4760}out(c, (GetEndpointResponse,pkSess_4870,None,SP_4871,UP_4872))
                                    )
                                    else
                                        {4761}let v_4873: bool = (Sess_4527 = C) in
                                        (
                                            {4762}if v_4873 then
                                            (
                                                {4763}let pkSess_4874: bitstring = pub(skC) in
                                                {4764}in(c, =GetEndpointRequest);
                                                {4765}new SP_4875: bitstring;
                                                {4766}new UP_4876: bitstring;
                                                {4767}out(c, (GetEndpointResponse,pkSess_4874,None,SP_4875,UP_4876))
                                            )
                                            else
                                                {4768}let pkSess_4877: bitstring = pub(sk(Sess_4527)) in
                                                {4769}in(c, =GetEndpointRequest);
                                                {4770}new SP_4878: bitstring;
                                                {4771}new UP_4879: bitstring;
                                                {4772}out(c, (GetEndpointResponse,pkSess_4877,None,SP_4878,UP_4879))
                                        )
                                        else
                                            {4773}let pkSess_4880: bitstring = fail-any in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4881: bitstring;
                                            {4776}new UP_4882: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4880,None,SP_4881,UP_4882))
                                )
                                else
                                    {4778}let pkSess_4883: bitstring = fail-any in
                                    {4779}in(c, =GetEndpointRequest);
                                    {4780}new SP_4884: bitstring;
                                    {4781}new UP_4885: bitstring;
                                    {4782}out(c, (GetEndpointResponse,pkSess_4883,None,SP_4884,UP_4885))
                        )
                        else
                            {4783}let pkSess_4886: bitstring = fail-any in
                            {4784}in(c, =GetEndpointRequest);
                            {4785}new SP_4887: bitstring;
                            {4786}new UP_4888: bitstring;
                            {4787}out(c, (GetEndpointResponse,pkSess_4886,None,SP_4887,UP_4888))
                )
                else
                    {4788}let =true = (Disco_4526 = C) in
                    (
                        {4789}let skDisco_4889: bitstring = skC in
                        {4790}let pkDisco_4890: bitstring = pub(skDisco_4889) in
                        {4791}let v_4891: bool = (Cli_4525 = A) in
                        (
                            {4792}if v_4891 then
                            (
                                {4793}let pkCli_4892: bitstring = pub(skA) in
                                {4794}let v_4893: bool = (Sess_4527 = A) in
                                (
                                    {4795}if v_4893 then
                                    (
                                        {4796}let pkSess_4894: bitstring = pub(skA) in
                                        {4797}in(c, =GetEndpointRequest);
                                        {4798}new SP_4895: bitstring;
                                        {4799}new UP_4896: bitstring;
                                        {4800}out(c, (GetEndpointResponse,pkSess_4894,None,SP_4895,UP_4896))
                                    )
                                    else
                                        {4801}let v_4897: bool = (Sess_4527 = B) in
                                        (
                                            {4802}if v_4897 then
                                            (
                                                {4803}let pkSess_4898: bitstring = pub(skB) in
                                                {4804}in(c, =GetEndpointRequest);
                                                {4805}new SP_4899: bitstring;
                                                {4806}new UP_4900: bitstring;
                                                {4807}out(c, (GetEndpointResponse,pkSess_4898,None,SP_4899,UP_4900))
                                            )
                                            else
                                                {4808}let v_4901: bool = (Sess_4527 = C) in
                                                (
                                                    {4809}if v_4901 then
                                                    (
                                                        {4810}let pkSess_4902: bitstring = pub(skC) in
                                                        {4811}in(c, =GetEndpointRequest);
                                                        {4812}new SP_4903: bitstring;
                                                        {4813}new UP_4904: bitstring;
                                                        {4814}out(c, (GetEndpointResponse,pkSess_4902,None,SP_4903,UP_4904))
                                                    )
                                                    else
                                                        {4815}let pkSess_4905: bitstring = pub(sk(Sess_4527)) in
                                                        {4816}in(c, =GetEndpointRequest);
                                                        {4817}new SP_4906: bitstring;
                                                        {4818}new UP_4907: bitstring;
                                                        {4819}out(c, (GetEndpointResponse,pkSess_4905,None,SP_4906,UP_4907))
                                                )
                                                else
                                                    {4820}let pkSess_4908: bitstring = fail-any in
                                                    {4821}in(c, =GetEndpointRequest);
                                                    {4822}new SP_4909: bitstring;
                                                    {4823}new UP_4910: bitstring;
                                                    {4824}out(c, (GetEndpointResponse,pkSess_4908,None,SP_4909,UP_4910))
                                        )
                                        else
                                            {4825}let pkSess_4911: bitstring = fail-any in
                                            {4826}in(c, =GetEndpointRequest);
                                            {4827}new SP_4912: bitstring;
                                            {4828}new UP_4913: bitstring;
                                            {4829}out(c, (GetEndpointResponse,pkSess_4911,None,SP_4912,UP_4913))
                                )
                                else
                                    {4830}let pkSess_4914: bitstring = fail-any in
                                    {4831}in(c, =GetEndpointRequest);
                                    {4832}new SP_4915: bitstring;
                                    {4833}new UP_4916: bitstring;
                                    {4834}out(c, (GetEndpointResponse,pkSess_4914,None,SP_4915,UP_4916))
                            )
                            else
                                {4835}let v_4917: bool = (Cli_4525 = B) in
                                (
                                    {4836}if v_4917 then
                                    (
                                        {4837}let pkCli_4918: bitstring = pub(skB) in
                                        {4838}let v_4919: bool = (Sess_4527 = A) in
                                        (
                                            {4839}if v_4919 then
                                            (
                                                {4840}let pkSess_4920: bitstring = pub(skA) in
                                                {4841}in(c, =GetEndpointRequest);
                                                {4842}new SP_4921: bitstring;
                                                {4843}new UP_4922: bitstring;
                                                {4844}out(c, (GetEndpointResponse,pkSess_4920,None,SP_4921,UP_4922))
                                            )
                                            else
                                                {4845}let v_4923: bool = (Sess_4527 = B) in
                                                (
                                                    {4846}if v_4923 then
                                                    (
                                                        {4847}let pkSess_4924: bitstring = pub(skB) in
                                                        {4848}in(c, =GetEndpointRequest);
                                                        {4849}new SP_4925: bitstring;
                                                        {4850}new UP_4926: bitstring;
                                                        {4851}out(c, (GetEndpointResponse,pkSess_4924,None,SP_4925,UP_4926))
                                                    )
                                                    else
                                                        {4852}let v_4927: bool = (Sess_4527 = C) in
                                                        (
                                                            {4853}if v_4927 then
                                                            (
                                                                {4854}let pkSess_4928: bitstring = pub(skC) in
                                                                {4855}in(c, =GetEndpointRequest);
                                                                {4856}new SP_4929: bitstring;
                                                                {4857}new UP_4930: bitstring;
                                                                {4858}out(c, (GetEndpointResponse,pkSess_4928,None,SP_4929,UP_4930))
                                                            )
                                                            else
                                                                {4859}let pkSess_4931: bitstring = pub(sk(Sess_4527)) in
                                                                {4860}in(c, =GetEndpointRequest);
                                                                {4861}new SP_4932: bitstring;
                                                                {4862}new UP_4933: bitstring;
                                                                {4863}out(c, (GetEndpointResponse,pkSess_4931,None,SP_4932,UP_4933))
                                                        )
                                                        else
                                                            {4864}let pkSess_4934: bitstring = fail-any in
                                                            {4865}in(c, =GetEndpointRequest);
                                                            {4866}new SP_4935: bitstring;
                                                            {4867}new UP_4936: bitstring;
                                                            {4868}out(c, (GetEndpointResponse,pkSess_4934,None,SP_4935,UP_4936))
                                                )
                                                else
                                                    {4869}let pkSess_4937: bitstring = fail-any in
                                                    {4870}in(c, =GetEndpointRequest);
                                                    {4871}new SP_4938: bitstring;
                                                    {4872}new UP_4939: bitstring;
                                                    {4873}out(c, (GetEndpointResponse,pkSess_4937,None,SP_4938,UP_4939))
                                        )
                                        else
                                            {4874}let pkSess_4940: bitstring = fail-any in
                                            {4875}in(c, =GetEndpointRequest);
                                            {4876}new SP_4941: bitstring;
                                            {4877}new UP_4942: bitstring;
                                            {4878}out(c, (GetEndpointResponse,pkSess_4940,None,SP_4941,UP_4942))
                                    )
                                    else
                                        {4879}let v_4943: bool = (Cli_4525 = C) in
                                        (
                                            {4880}if v_4943 then
                                            (
                                                {4881}let pkCli_4944: bitstring = pub(skC) in
                                                {4882}let v_4945: bool = (Sess_4527 = A) in
                                                (
                                                    {4883}if v_4945 then
                                                    (
                                                        {4884}let pkSess_4946: bitstring = pub(skA) in
                                                        {4885}in(c, =GetEndpointRequest);
                                                        {4886}new SP_4947: bitstring;
                                                        {4887}new UP_4948: bitstring;
                                                        {4888}out(c, (GetEndpointResponse,pkSess_4946,None,SP_4947,UP_4948))
                                                    )
                                                    else
                                                        {4889}let v_4949: bool = (Sess_4527 = B) in
                                                        (
                                                            {4890}if v_4949 then
                                                            (
                                                                {4891}let pkSess_4950: bitstring = pub(skB) in
                                                                {4892}in(c, =GetEndpointRequest);
                                                                {4893}new SP_4951: bitstring;
                                                                {4894}new UP_4952: bitstring;
                                                                {4895}out(c, (GetEndpointResponse,pkSess_4950,None,SP_4951,UP_4952))
                                                            )
                                                            else
                                                                {4896}let v_4953: bool = (Sess_4527 = C) in
                                                                (
                                                                    {4897}if v_4953 then
                                                                    (
                                                                        {4898}let pkSess_4954: bitstring = pub(skC) in
                                                                        {4899}in(c, =GetEndpointRequest);
                                                                        {4900}new SP_4955: bitstring;
                                                                        {4901}new UP_4956: bitstring;
                                                                        {4902}out(c, (GetEndpointResponse,pkSess_4954,None,SP_4955,UP_4956))
                                                                    )
                                                                    else
                                                                        {4903}let pkSess_4957: bitstring = pub(sk(Sess_4527)) in
                                                                        {4904}in(c, =GetEndpointRequest);
                                                                        {4905}new SP_4958: bitstring;
                                                                        {4906}new UP_4959: bitstring;
                                                                        {4907}out(c, (GetEndpointResponse,pkSess_4957,None,SP_4958,UP_4959))
                                                                )
                                                                else
                                                                    {4908}let pkSess_4960: bitstring = fail-any in
                                                                    {4909}in(c, =GetEndpointRequest);
                                                                    {4910}new SP_4961: bitstring;
                                                                    {4911}new UP_4962: bitstring;
                                                                    {4912}out(c, (GetEndpointResponse,pkSess_4960,None,SP_4961,UP_4962))
                                                        )
                                                        else
                                                            {4913}let pkSess_4963: bitstring = fail-any in
                                                            {4914}in(c, =GetEndpointRequest);
                                                            {4915}new SP_4964: bitstring;
                                                            {4916}new UP_4965: bitstring;
                                                            {4917}out(c, (GetEndpointResponse,pkSess_4963,None,SP_4964,UP_4965))
                                                )
                                                else
                                                    {4918}let pkSess_4966: bitstring = fail-any in
                                                    {4919}in(c, =GetEndpointRequest);
                                                    {4920}new SP_4967: bitstring;
                                                    {4921}new UP_4968: bitstring;
                                                    {4922}out(c, (GetEndpointResponse,pkSess_4966,None,SP_4967,UP_4968))
                                            )
                                            else
                                                {4923}let pkCli_4969: bitstring = pub(sk(Cli_4525)) in
                                                {4924}let v_4970: bool = (Sess_4527 = A) in
                                                (
                                                    {4925}if v_4970 then
                                                    (
                                                        {4926}let pkSess_4971: bitstring = pub(skA) in
                                                        {4927}in(c, =GetEndpointRequest);
                                                        {4928}new SP_4972: bitstring;
                                                        {4929}new UP_4973: bitstring;
                                                        {4930}out(c, (GetEndpointResponse,pkSess_4971,None,SP_4972,UP_4973))
                                                    )
                                                    else
                                                        {4931}let v_4974: bool = (Sess_4527 = B) in
                                                        (
                                                            {4932}if v_4974 then
                                                            (
                                                                {4933}let pkSess_4975: bitstring = pub(skB) in
                                                                {4934}in(c, =GetEndpointRequest);
                                                                {4935}new SP_4976: bitstring;
                                                                {4936}new UP_4977: bitstring;
                                                                {4937}out(c, (GetEndpointResponse,pkSess_4975,None,SP_4976,UP_4977))
                                                            )
                                                            else
                                                                {4938}let v_4978: bool = (Sess_4527 = C) in
                                                                (
                                                                    {4939}if v_4978 then
                                                                    (
                                                                        {4940}let pkSess_4979: bitstring = pub(skC) in
                                                                        {4941}in(c, =GetEndpointRequest);
                                                                        {4942}new SP_4980: bitstring;
                                                                        {4943}new UP_4981: bitstring;
                                                                        {4944}out(c, (GetEndpointResponse,pkSess_4979,None,SP_4980,UP_4981))
                                                                    )
                                                                    else
                                                                        {4945}let pkSess_4982: bitstring = pub(sk(Sess_4527)) in
                                                                        {4946}in(c, =GetEndpointRequest);
                                                                        {4947}new SP_4983: bitstring;
                                                                        {4948}new UP_4984: bitstring;
                                                                        {4949}out(c, (GetEndpointResponse,pkSess_4982,None,SP_4983,UP_4984))
                                                                )
                                                                else
                                                                    {4950}let pkSess_4985: bitstring = fail-any in
                                                                    {4951}in(c, =GetEndpointRequest);
                                                                    {4952}new SP_4986: bitstring;
                                                                    {4953}new UP_4987: bitstring;
                                                                    {4954}out(c, (GetEndpointResponse,pkSess_4985,None,SP_4986,UP_4987))
                                                        )
                                                        else
                                                            {4955}let pkSess_4988: bitstring = fail-any in
                                                            {4956}in(c, =GetEndpointRequest);
                                                            {4957}new SP_4989: bitstring;
                                                            {4958}new UP_4990: bitstring;
                                                            {4959}out(c, (GetEndpointResponse,pkSess_4988,None,SP_4989,UP_4990))
                                                )
                                                else
                                                    {4960}let pkSess_4991: bitstring = fail-any in
                                                    {4961}in(c, =GetEndpointRequest);
                                                    {4962}new SP_4992: bitstring;
                                                    {4963}new UP_4993: bitstring;
                                                    {4964}out(c, (GetEndpointResponse,pkSess_4991,None,SP_4992,UP_4993))
                                        )
                                        else
                                            {4965}let pkCli_4994: bitstring = fail-any in
                                            {4966}let v_4995: bool = (Sess_4527 = A) in
                                            (
                                                {4967}if v_4995 then
                                                (
                                                    {4968}let pkSess_4996: bitstring = pub(skA) in
                                                    {4969}in(c, =GetEndpointRequest);
                                                    {4970}new SP_4997: bitstring;
                                                    {4971}new UP_4998: bitstring;
                                                    {4972}out(c, (GetEndpointResponse,pkSess_4996,None,SP_4997,UP_4998))
                                                )
                                                else
                                                    {4973}let v_4999: bool = (Sess_4527 = B) in
                                                    (
                                                        {4974}if v_4999 then
                                                        (
                                                            {4975}let pkSess_5000: bitstring = pub(skB) in
                                                            {4976}in(c, =GetEndpointRequest);
                                                            {4977}new SP_5001: bitstring;
                                                            {4978}new UP_5002: bitstring;
                                                            {4979}out(c, (GetEndpointResponse,pkSess_5000,None,SP_5001,UP_5002))
                                                        )
                                                        else
                                                            {4980}let v_5003: bool = (Sess_4527 = C) in
                                                            (
                                                                {4981}if v_5003 then
                                                                (
                                                                    {4982}let pkSess_5004: bitstring = pub(skC) in
                                                                    {4983}in(c, =GetEndpointRequest);
                                                                    {4984}new SP_5005: bitstring;
                                                                    {4985}new UP_5006: bitstring;
                                                                    {4986}out(c, (GetEndpointResponse,pkSess_5004,None,SP_5005,UP_5006))
                                                                )
                                                                else
                                                                    {4987}let pkSess_5007: bitstring = pub(sk(Sess_4527)) in
                                                                    {4988}in(c, =GetEndpointRequest);
                                                                    {4989}new SP_5008: bitstring;
                                                                    {4990}new UP_5009: bitstring;
                                                                    {4991}out(c, (GetEndpointResponse,pkSess_5007,None,SP_5008,UP_5009))
                                                            )
                                                            else
                                                                {4992}let pkSess_5010: bitstring = fail-any in
                                                                {4993}in(c, =GetEndpointRequest);
                                                                {4994}new SP_5011: bitstring;
                                                                {4995}new UP_5012: bitstring;
                                                                {4996}out(c, (GetEndpointResponse,pkSess_5010,None,SP_5011,UP_5012))
                                                    )
                                                    else
                                                        {4997}let pkSess_5013: bitstring = fail-any in
                                                        {4998}in(c, =GetEndpointRequest);
                                                        {4999}new SP_5014: bitstring;
                                                        {5000}new UP_5015: bitstring;
                                                        {5001}out(c, (GetEndpointResponse,pkSess_5013,None,SP_5014,UP_5015))
                                            )
                                            else
                                                {5002}let pkSess_5016: bitstring = fail-any in
                                                {5003}in(c, =GetEndpointRequest);
                                                {5004}new SP_5017: bitstring;
                                                {5005}new UP_5018: bitstring;
                                                {5006}out(c, (GetEndpointResponse,pkSess_5016,None,SP_5017,UP_5018))
                                )
                                else
                                    {5007}let pkCli_5019: bitstring = fail-any in
                                    {5008}let v_5020: bool = (Sess_4527 = A) in
                                    (
                                        {5009}if v_5020 then
                                        (
                                            {5010}let pkSess_5021: bitstring = pub(skA) in
                                            {5011}in(c, =GetEndpointRequest);
                                            {5012}new SP_5022: bitstring;
                                            {5013}new UP_5023: bitstring;
                                            {5014}out(c, (GetEndpointResponse,pkSess_5021,None,SP_5022,UP_5023))
                                        )
                                        else
                                            {5015}let v_5024: bool = (Sess_4527 = B) in
                                            (
                                                {5016}if v_5024 then
                                                (
                                                    {5017}let pkSess_5025: bitstring = pub(skB) in
                                                    {5018}in(c, =GetEndpointRequest);
                                                    {5019}new SP_5026: bitstring;
                                                    {5020}new UP_5027: bitstring;
                                                    {5021}out(c, (GetEndpointResponse,pkSess_5025,None,SP_5026,UP_5027))
                                                )
                                                else
                                                    {5022}let v_5028: bool = (Sess_4527 = C) in
                                                    (
                                                        {5023}if v_5028 then
                                                        (
                                                            {5024}let pkSess_5029: bitstring = pub(skC) in
                                                            {5025}in(c, =GetEndpointRequest);
                                                            {5026}new SP_5030: bitstring;
                                                            {5027}new UP_5031: bitstring;
                                                            {5028}out(c, (GetEndpointResponse,pkSess_5029,None,SP_5030,UP_5031))
                                                        )
                                                        else
                                                            {5029}let pkSess_5032: bitstring = pub(sk(Sess_4527)) in
                                                            {5030}in(c, =GetEndpointRequest);
                                                            {5031}new SP_5033: bitstring;
                                                            {5032}new UP_5034: bitstring;
                                                            {5033}out(c, (GetEndpointResponse,pkSess_5032,None,SP_5033,UP_5034))
                                                    )
                                                    else
                                                        {5034}let pkSess_5035: bitstring = fail-any in
                                                        {5035}in(c, =GetEndpointRequest);
                                                        {5036}new SP_5036: bitstring;
                                                        {5037}new UP_5037: bitstring;
                                                        {5038}out(c, (GetEndpointResponse,pkSess_5035,None,SP_5036,UP_5037))
                                            )
                                            else
                                                {5039}let pkSess_5038: bitstring = fail-any in
                                                {5040}in(c, =GetEndpointRequest);
                                                {5041}new SP_5039: bitstring;
                                                {5042}new UP_5040: bitstring;
                                                {5043}out(c, (GetEndpointResponse,pkSess_5038,None,SP_5039,UP_5040))
                                    )
                                    else
                                        {5044}let pkSess_5041: bitstring = fail-any in
                                        {5045}in(c, =GetEndpointRequest);
                                        {5046}new SP_5042: bitstring;
                                        {5047}new UP_5043: bitstring;
                                        {5048}out(c, (GetEndpointResponse,pkSess_5041,None,SP_5042,UP_5043))
                        )
                        else
                            {5049}let pkCli_5044: bitstring = fail-any in
                            {5050}let v_5045: bool = (Sess_4527 = A) in
                            (
                                {5051}if v_5045 then
                                (
                                    {5052}let pkSess_5046: bitstring = pub(skA) in
                                    {5053}in(c, =GetEndpointRequest);
                                    {5054}new SP_5047: bitstring;
                                    {5055}new UP_5048: bitstring;
                                    {5056}out(c, (GetEndpointResponse,pkSess_5046,None,SP_5047,UP_5048))
                                )
                                else
                                    {5057}let v_5049: bool = (Sess_4527 = B) in
                                    (
                                        {5058}if v_5049 then
                                        (
                                            {5059}let pkSess_5050: bitstring = pub(skB) in
                                            {5060}in(c, =GetEndpointRequest);
                                            {5061}new SP_5051: bitstring;
                                            {5062}new UP_5052: bitstring;
                                            {5063}out(c, (GetEndpointResponse,pkSess_5050,None,SP_5051,UP_5052))
                                        )
                                        else
                                            {5064}let v_5053: bool = (Sess_4527 = C) in
                                            (
                                                {5065}if v_5053 then
                                                (
                                                    {5066}let pkSess_5054: bitstring = pub(skC) in
                                                    {5067}in(c, =GetEndpointRequest);
                                                    {5068}new SP_5055: bitstring;
                                                    {5069}new UP_5056: bitstring;
                                                    {5070}out(c, (GetEndpointResponse,pkSess_5054,None,SP_5055,UP_5056))
                                                )
                                                else
                                                    {5071}let pkSess_5057: bitstring = pub(sk(Sess_4527)) in
                                                    {5072}in(c, =GetEndpointRequest);
                                                    {5073}new SP_5058: bitstring;
                                                    {5074}new UP_5059: bitstring;
                                                    {5075}out(c, (GetEndpointResponse,pkSess_5057,None,SP_5058,UP_5059))
                                            )
                                            else
                                                {5076}let pkSess_5060: bitstring = fail-any in
                                                {5077}in(c, =GetEndpointRequest);
                                                {5078}new SP_5061: bitstring;
                                                {5079}new UP_5062: bitstring;
                                                {5080}out(c, (GetEndpointResponse,pkSess_5060,None,SP_5061,UP_5062))
                                    )
                                    else
                                        {5081}let pkSess_5063: bitstring = fail-any in
                                        {5082}in(c, =GetEndpointRequest);
                                        {5083}new SP_5064: bitstring;
                                        {5084}new UP_5065: bitstring;
                                        {5085}out(c, (GetEndpointResponse,pkSess_5063,None,SP_5064,UP_5065))
                            )
                            else
                                {5086}let pkSess_5066: bitstring = fail-any in
                                {5087}in(c, =GetEndpointRequest);
                                {5088}new SP_5067: bitstring;
                                {5089}new UP_5068: bitstring;
                                {5090}out(c, (GetEndpointResponse,pkSess_5066,None,SP_5067,UP_5068))
                    )
                    else
                        {5091}let skDisco_5069: bitstring = fail-any in
                        {5092}let pkDisco_5070: bitstring = pub(skDisco_5069) in
                        {5093}let v_5071: bool = (Cli_4525 = A) in
                        (
                            {5094}if v_5071 then
                            (
                                {5095}let pkCli_5072: bitstring = pub(skA) in
                                {5096}let v_5073: bool = (Sess_4527 = A) in
                                (
                                    {5097}if v_5073 then
                                    (
                                        {5098}let pkSess_5074: bitstring = pub(skA) in
                                        {5099}in(c, =GetEndpointRequest);
                                        {5100}new SP_5075: bitstring;
                                        {5101}new UP_5076: bitstring;
                                        {5102}out(c, (GetEndpointResponse,pkSess_5074,None,SP_5075,UP_5076))
                                    )
                                    else
                                        {5103}let v_5077: bool = (Sess_4527 = B) in
                                        (
                                            {5104}if v_5077 then
                                            (
                                                {5105}let pkSess_5078: bitstring = pub(skB) in
                                                {5106}in(c, =GetEndpointRequest);
                                                {5107}new SP_5079: bitstring;
                                                {5108}new UP_5080: bitstring;
                                                {5109}out(c, (GetEndpointResponse,pkSess_5078,None,SP_5079,UP_5080))
                                            )
                                            else
                                                {5110}let v_5081: bool = (Sess_4527 = C) in
                                                (
                                                    {5111}if v_5081 then
                                                    (
                                                        {5112}let pkSess_5082: bitstring = pub(skC) in
                                                        {5113}in(c, =GetEndpointRequest);
                                                        {5114}new SP_5083: bitstring;
                                                        {5115}new UP_5084: bitstring;
                                                        {5116}out(c, (GetEndpointResponse,pkSess_5082,None,SP_5083,UP_5084))
                                                    )
                                                    else
                                                        {5117}let pkSess_5085: bitstring = pub(sk(Sess_4527)) in
                                                        {5118}in(c, =GetEndpointRequest);
                                                        {5119}new SP_5086: bitstring;
                                                        {5120}new UP_5087: bitstring;
                                                        {5121}out(c, (GetEndpointResponse,pkSess_5085,None,SP_5086,UP_5087))
                                                )
                                                else
                                                    {5122}let pkSess_5088: bitstring = fail-any in
                                                    {5123}in(c, =GetEndpointRequest);
                                                    {5124}new SP_5089: bitstring;
                                                    {5125}new UP_5090: bitstring;
                                                    {5126}out(c, (GetEndpointResponse,pkSess_5088,None,SP_5089,UP_5090))
                                        )
                                        else
                                            {5127}let pkSess_5091: bitstring = fail-any in
                                            {5128}in(c, =GetEndpointRequest);
                                            {5129}new SP_5092: bitstring;
                                            {5130}new UP_5093: bitstring;
                                            {5131}out(c, (GetEndpointResponse,pkSess_5091,None,SP_5092,UP_5093))
                                )
                                else
                                    {5132}let pkSess_5094: bitstring = fail-any in
                                    {5133}in(c, =GetEndpointRequest);
                                    {5134}new SP_5095: bitstring;
                                    {5135}new UP_5096: bitstring;
                                    {5136}out(c, (GetEndpointResponse,pkSess_5094,None,SP_5095,UP_5096))
                            )
                            else
                                {5137}let v_5097: bool = (Cli_4525 = B) in
                                (
                                    {5138}if v_5097 then
                                    (
                                        {5139}let pkCli_5098: bitstring = pub(skB) in
                                        {5140}let v_5099: bool = (Sess_4527 = A) in
                                        (
                                            {5141}if v_5099 then
                                            (
                                                {5142}let pkSess_5100: bitstring = pub(skA) in
                                                {5143}in(c, =GetEndpointRequest);
                                                {5144}new SP_5101: bitstring;
                                                {5145}new UP_5102: bitstring;
                                                {5146}out(c, (GetEndpointResponse,pkSess_5100,None,SP_5101,UP_5102))
                                            )
                                            else
                                                {5147}let v_5103: bool = (Sess_4527 = B) in
                                                (
                                                    {5148}if v_5103 then
                                                    (
                                                        {5149}let pkSess_5104: bitstring = pub(skB) in
                                                        {5150}in(c, =GetEndpointRequest);
                                                        {5151}new SP_5105: bitstring;
                                                        {5152}new UP_5106: bitstring;
                                                        {5153}out(c, (GetEndpointResponse,pkSess_5104,None,SP_5105,UP_5106))
                                                    )
                                                    else
                                                        {5154}let v_5107: bool = (Sess_4527 = C) in
                                                        (
                                                            {5155}if v_5107 then
                                                            (
                                                                {5156}let pkSess_5108: bitstring = pub(skC) in
                                                                {5157}in(c, =GetEndpointRequest);
                                                                {5158}new SP_5109: bitstring;
                                                                {5159}new UP_5110: bitstring;
                                                                {5160}out(c, (GetEndpointResponse,pkSess_5108,None,SP_5109,UP_5110))
                                                            )
                                                            else
                                                                {5161}let pkSess_5111: bitstring = pub(sk(Sess_4527)) in
                                                                {5162}in(c, =GetEndpointRequest);
                                                                {5163}new SP_5112: bitstring;
                                                                {5164}new UP_5113: bitstring;
                                                                {5165}out(c, (GetEndpointResponse,pkSess_5111,None,SP_5112,UP_5113))
                                                        )
                                                        else
                                                            {5166}let pkSess_5114: bitstring = fail-any in
                                                            {5167}in(c, =GetEndpointRequest);
                                                            {5168}new SP_5115: bitstring;
                                                            {5169}new UP_5116: bitstring;
                                                            {5170}out(c, (GetEndpointResponse,pkSess_5114,None,SP_5115,UP_5116))
                                                )
                                                else
                                                    {5171}let pkSess_5117: bitstring = fail-any in
                                                    {5172}in(c, =GetEndpointRequest);
                                                    {5173}new SP_5118: bitstring;
                                                    {5174}new UP_5119: bitstring;
                                                    {5175}out(c, (GetEndpointResponse,pkSess_5117,None,SP_5118,UP_5119))
                                        )
                                        else
                                            {5176}let pkSess_5120: bitstring = fail-any in
                                            {5177}in(c, =GetEndpointRequest);
                                            {5178}new SP_5121: bitstring;
                                            {5179}new UP_5122: bitstring;
                                            {5180}out(c, (GetEndpointResponse,pkSess_5120,None,SP_5121,UP_5122))
                                    )
                                    else
                                        {5181}let v_5123: bool = (Cli_4525 = C) in
                                        (
                                            {5182}if v_5123 then
                                            (
                                                {5183}let pkCli_5124: bitstring = pub(skC) in
                                                {5184}let v_5125: bool = (Sess_4527 = A) in
                                                (
                                                    {5185}if v_5125 then
                                                    (
                                                        {5186}let pkSess_5126: bitstring = pub(skA) in
                                                        {5187}in(c, =GetEndpointRequest);
                                                        {5188}new SP_5127: bitstring;
                                                        {5189}new UP_5128: bitstring;
                                                        {5190}out(c, (GetEndpointResponse,pkSess_5126,None,SP_5127,UP_5128))
                                                    )
                                                    else
                                                        {5191}let v_5129: bool = (Sess_4527 = B) in
                                                        (
                                                            {5192}if v_5129 then
                                                            (
                                                                {5193}let pkSess_5130: bitstring = pub(skB) in
                                                                {5194}in(c, =GetEndpointRequest);
                                                                {5195}new SP_5131: bitstring;
                                                                {5196}new UP_5132: bitstring;
                                                                {5197}out(c, (GetEndpointResponse,pkSess_5130,None,SP_5131,UP_5132))
                                                            )
                                                            else
                                                                {5198}let v_5133: bool = (Sess_4527 = C) in
                                                                (
                                                                    {5199}if v_5133 then
                                                                    (
                                                                        {5200}let pkSess_5134: bitstring = pub(skC) in
                                                                        {5201}in(c, =GetEndpointRequest);
                                                                        {5202}new SP_5135: bitstring;
                                                                        {5203}new UP_5136: bitstring;
                                                                        {5204}out(c, (GetEndpointResponse,pkSess_5134,None,SP_5135,UP_5136))
                                                                    )
                                                                    else
                                                                        {5205}let pkSess_5137: bitstring = pub(sk(Sess_4527)) in
                                                                        {5206}in(c, =GetEndpointRequest);
                                                                        {5207}new SP_5138: bitstring;
                                                                        {5208}new UP_5139: bitstring;
                                                                        {5209}out(c, (GetEndpointResponse,pkSess_5137,None,SP_5138,UP_5139))
                                                                )
                                                                else
                                                                    {5210}let pkSess_5140: bitstring = fail-any in
                                                                    {5211}in(c, =GetEndpointRequest);
                                                                    {5212}new SP_5141: bitstring;
                                                                    {5213}new UP_5142: bitstring;
                                                                    {5214}out(c, (GetEndpointResponse,pkSess_5140,None,SP_5141,UP_5142))
                                                        )
                                                        else
                                                            {5215}let pkSess_5143: bitstring = fail-any in
                                                            {5216}in(c, =GetEndpointRequest);
                                                            {5217}new SP_5144: bitstring;
                                                            {5218}new UP_5145: bitstring;
                                                            {5219}out(c, (GetEndpointResponse,pkSess_5143,None,SP_5144,UP_5145))
                                                )
                                                else
                                                    {5220}let pkSess_5146: bitstring = fail-any in
                                                    {5221}in(c, =GetEndpointRequest);
                                                    {5222}new SP_5147: bitstring;
                                                    {5223}new UP_5148: bitstring;
                                                    {5224}out(c, (GetEndpointResponse,pkSess_5146,None,SP_5147,UP_5148))
                                            )
                                            else
                                                {5225}let pkCli_5149: bitstring = pub(sk(Cli_4525)) in
                                                {5226}let v_5150: bool = (Sess_4527 = A) in
                                                (
                                                    {5227}if v_5150 then
                                                    (
                                                        {5228}let pkSess_5151: bitstring = pub(skA) in
                                                        {5229}in(c, =GetEndpointRequest);
                                                        {5230}new SP_5152: bitstring;
                                                        {5231}new UP_5153: bitstring;
                                                        {5232}out(c, (GetEndpointResponse,pkSess_5151,None,SP_5152,UP_5153))
                                                    )
                                                    else
                                                        {5233}let v_5154: bool = (Sess_4527 = B) in
                                                        (
                                                            {5234}if v_5154 then
                                                            (
                                                                {5235}let pkSess_5155: bitstring = pub(skB) in
                                                                {5236}in(c, =GetEndpointRequest);
                                                                {5237}new SP_5156: bitstring;
                                                                {5238}new UP_5157: bitstring;
                                                                {5239}out(c, (GetEndpointResponse,pkSess_5155,None,SP_5156,UP_5157))
                                                            )
                                                            else
                                                                {5240}let v_5158: bool = (Sess_4527 = C) in
                                                                (
                                                                    {5241}if v_5158 then
                                                                    (
                                                                        {5242}let pkSess_5159: bitstring = pub(skC) in
                                                                        {5243}in(c, =GetEndpointRequest);
                                                                        {5244}new SP_5160: bitstring;
                                                                        {5245}new UP_5161: bitstring;
                                                                        {5246}out(c, (GetEndpointResponse,pkSess_5159,None,SP_5160,UP_5161))
                                                                    )
                                                                    else
                                                                        {5247}let pkSess_5162: bitstring = pub(sk(Sess_4527)) in
                                                                        {5248}in(c, =GetEndpointRequest);
                                                                        {5249}new SP_5163: bitstring;
                                                                        {5250}new UP_5164: bitstring;
                                                                        {5251}out(c, (GetEndpointResponse,pkSess_5162,None,SP_5163,UP_5164))
                                                                )
                                                                else
                                                                    {5252}let pkSess_5165: bitstring = fail-any in
                                                                    {5253}in(c, =GetEndpointRequest);
                                                                    {5254}new SP_5166: bitstring;
                                                                    {5255}new UP_5167: bitstring;
                                                                    {5256}out(c, (GetEndpointResponse,pkSess_5165,None,SP_5166,UP_5167))
                                                        )
                                                        else
                                                            {5257}let pkSess_5168: bitstring = fail-any in
                                                            {5258}in(c, =GetEndpointRequest);
                                                            {5259}new SP_5169: bitstring;
                                                            {5260}new UP_5170: bitstring;
                                                            {5261}out(c, (GetEndpointResponse,pkSess_5168,None,SP_5169,UP_5170))
                                                )
                                                else
                                                    {5262}let pkSess_5171: bitstring = fail-any in
                                                    {5263}in(c, =GetEndpointRequest);
                                                    {5264}new SP_5172: bitstring;
                                                    {5265}new UP_5173: bitstring;
                                                    {5266}out(c, (GetEndpointResponse,pkSess_5171,None,SP_5172,UP_5173))
                                        )
                                        else
                                            {5267}let pkCli_5174: bitstring = fail-any in
                                            {5268}let v_5175: bool = (Sess_4527 = A) in
                                            (
                                                {5269}if v_5175 then
                                                (
                                                    {5270}let pkSess_5176: bitstring = pub(skA) in
                                                    {5271}in(c, =GetEndpointRequest);
                                                    {5272}new SP_5177: bitstring;
                                                    {5273}new UP_5178: bitstring;
                                                    {5274}out(c, (GetEndpointResponse,pkSess_5176,None,SP_5177,UP_5178))
                                                )
                                                else
                                                    {5275}let v_5179: bool = (Sess_4527 = B) in
                                                    (
                                                        {5276}if v_5179 then
                                                        (
                                                            {5277}let pkSess_5180: bitstring = pub(skB) in
                                                            {5278}in(c, =GetEndpointRequest);
                                                            {5279}new SP_5181: bitstring;
                                                            {5280}new UP_5182: bitstring;
                                                            {5281}out(c, (GetEndpointResponse,pkSess_5180,None,SP_5181,UP_5182))
                                                        )
                                                        else
                                                            {5282}let v_5183: bool = (Sess_4527 = C) in
                                                            (
                                                                {5283}if v_5183 then
                                                                (
                                                                    {5284}let pkSess_5184: bitstring = pub(skC) in
                                                                    {5285}in(c, =GetEndpointRequest);
                                                                    {5286}new SP_5185: bitstring;
                                                                    {5287}new UP_5186: bitstring;
                                                                    {5288}out(c, (GetEndpointResponse,pkSess_5184,None,SP_5185,UP_5186))
                                                                )
                                                                else
                                                                    {5289}let pkSess_5187: bitstring = pub(sk(Sess_4527)) in
                                                                    {5290}in(c, =GetEndpointRequest);
                                                                    {5291}new SP_5188: bitstring;
                                                                    {5292}new UP_5189: bitstring;
                                                                    {5293}out(c, (GetEndpointResponse,pkSess_5187,None,SP_5188,UP_5189))
                                                            )
                                                            else
                                                                {5294}let pkSess_5190: bitstring = fail-any in
                                                                {5295}in(c, =GetEndpointRequest);
                                                                {5296}new SP_5191: bitstring;
                                                                {5297}new UP_5192: bitstring;
                                                                {5298}out(c, (GetEndpointResponse,pkSess_5190,None,SP_5191,UP_5192))
                                                    )
                                                    else
                                                        {5299}let pkSess_5193: bitstring = fail-any in
                                                        {5300}in(c, =GetEndpointRequest);
                                                        {5301}new SP_5194: bitstring;
                                                        {5302}new UP_5195: bitstring;
                                                        {5303}out(c, (GetEndpointResponse,pkSess_5193,None,SP_5194,UP_5195))
                                            )
                                            else
                                                {5304}let pkSess_5196: bitstring = fail-any in
                                                {5305}in(c, =GetEndpointRequest);
                                                {5306}new SP_5197: bitstring;
                                                {5307}new UP_5198: bitstring;
                                                {5308}out(c, (GetEndpointResponse,pkSess_5196,None,SP_5197,UP_5198))
                                )
                                else
                                    {5309}let pkCli_5199: bitstring = fail-any in
                                    {5310}let v_5200: bool = (Sess_4527 = A) in
                                    (
                                        {5311}if v_5200 then
                                        (
                                            {5312}let pkSess_5201: bitstring = pub(skA) in
                                            {5313}in(c, =GetEndpointRequest);
                                            {5314}new SP_5202: bitstring;
                                            {5315}new UP_5203: bitstring;
                                            {5316}out(c, (GetEndpointResponse,pkSess_5201,None,SP_5202,UP_5203))
                                        )
                                        else
                                            {5317}let v_5204: bool = (Sess_4527 = B) in
                                            (
                                                {5318}if v_5204 then
                                                (
                                                    {5319}let pkSess_5205: bitstring = pub(skB) in
                                                    {5320}in(c, =GetEndpointRequest);
                                                    {5321}new SP_5206: bitstring;
                                                    {5322}new UP_5207: bitstring;
                                                    {5323}out(c, (GetEndpointResponse,pkSess_5205,None,SP_5206,UP_5207))
                                                )
                                                else
                                                    {5324}let v_5208: bool = (Sess_4527 = C) in
                                                    (
                                                        {5325}if v_5208 then
                                                        (
                                                            {5326}let pkSess_5209: bitstring = pub(skC) in
                                                            {5327}in(c, =GetEndpointRequest);
                                                            {5328}new SP_5210: bitstring;
                                                            {5329}new UP_5211: bitstring;
                                                            {5330}out(c, (GetEndpointResponse,pkSess_5209,None,SP_5210,UP_5211))
                                                        )
                                                        else
                                                            {5331}let pkSess_5212: bitstring = pub(sk(Sess_4527)) in
                                                            {5332}in(c, =GetEndpointRequest);
                                                            {5333}new SP_5213: bitstring;
                                                            {5334}new UP_5214: bitstring;
                                                            {5335}out(c, (GetEndpointResponse,pkSess_5212,None,SP_5213,UP_5214))
                                                    )
                                                    else
                                                        {5336}let pkSess_5215: bitstring = fail-any in
                                                        {5337}in(c, =GetEndpointRequest);
                                                        {5338}new SP_5216: bitstring;
                                                        {5339}new UP_5217: bitstring;
                                                        {5340}out(c, (GetEndpointResponse,pkSess_5215,None,SP_5216,UP_5217))
                                            )
                                            else
                                                {5341}let pkSess_5218: bitstring = fail-any in
                                                {5342}in(c, =GetEndpointRequest);
                                                {5343}new SP_5219: bitstring;
                                                {5344}new UP_5220: bitstring;
                                                {5345}out(c, (GetEndpointResponse,pkSess_5218,None,SP_5219,UP_5220))
                                    )
                                    else
                                        {5346}let pkSess_5221: bitstring = fail-any in
                                        {5347}in(c, =GetEndpointRequest);
                                        {5348}new SP_5222: bitstring;
                                        {5349}new UP_5223: bitstring;
                                        {5350}out(c, (GetEndpointResponse,pkSess_5221,None,SP_5222,UP_5223))
                        )
                        else
                            {5351}let pkCli_5224: bitstring = fail-any in
                            {5352}let v_5225: bool = (Sess_4527 = A) in
                            (
                                {5353}if v_5225 then
                                (
                                    {5354}let pkSess_5226: bitstring = pub(skA) in
                                    {5355}in(c, =GetEndpointRequest);
                                    {5356}new SP_5227: bitstring;
                                    {5357}new UP_5228: bitstring;
                                    {5358}out(c, (GetEndpointResponse,pkSess_5226,None,SP_5227,UP_5228))
                                )
                                else
                                    {5359}let v_5229: bool = (Sess_4527 = B) in
                                    (
                                        {5360}if v_5229 then
                                        (
                                            {5361}let pkSess_5230: bitstring = pub(skB) in
                                            {5362}in(c, =GetEndpointRequest);
                                            {5363}new SP_5231: bitstring;
                                            {5364}new UP_5232: bitstring;
                                            {5365}out(c, (GetEndpointResponse,pkSess_5230,None,SP_5231,UP_5232))
                                        )
                                        else
                                            {5366}let v_5233: bool = (Sess_4527 = C) in
                                            (
                                                {5367}if v_5233 then
                                                (
                                                    {5368}let pkSess_5234: bitstring = pub(skC) in
                                                    {5369}in(c, =GetEndpointRequest);
                                                    {5370}new SP_5235: bitstring;
                                                    {5371}new UP_5236: bitstring;
                                                    {5372}out(c, (GetEndpointResponse,pkSess_5234,None,SP_5235,UP_5236))
                                                )
                                                else
                                                    {5373}let pkSess_5237: bitstring = pub(sk(Sess_4527)) in
                                                    {5374}in(c, =GetEndpointRequest);
                                                    {5375}new SP_5238: bitstring;
                                                    {5376}new UP_5239: bitstring;
                                                    {5377}out(c, (GetEndpointResponse,pkSess_5237,None,SP_5238,UP_5239))
                                            )
                                            else
                                                {5378}let pkSess_5240: bitstring = fail-any in
                                                {5379}in(c, =GetEndpointRequest);
                                                {5380}new SP_5241: bitstring;
                                                {5381}new UP_5242: bitstring;
                                                {5382}out(c, (GetEndpointResponse,pkSess_5240,None,SP_5241,UP_5242))
                                    )
                                    else
                                        {5383}let pkSess_5243: bitstring = fail-any in
                                        {5384}in(c, =GetEndpointRequest);
                                        {5385}new SP_5244: bitstring;
                                        {5386}new UP_5245: bitstring;
                                        {5387}out(c, (GetEndpointResponse,pkSess_5243,None,SP_5244,UP_5245))
                            )
                            else
                                {5388}let pkSess_5246: bitstring = fail-any in
                                {5389}in(c, =GetEndpointRequest);
                                {5390}new SP_5247: bitstring;
                                {5391}new UP_5248: bitstring;
                                {5392}out(c, (GetEndpointResponse,pkSess_5246,None,SP_5247,UP_5248))
            )
            else
                {5393}let skDisco_5249: bitstring = fail-any in
                {5394}let pkDisco_5250: bitstring = pub(skDisco_5249) in
                {5395}let v_5251: bool = (Cli_4525 = A) in
                (
                    {5396}if v_5251 then
                    (
                        {5397}let pkCli_5252: bitstring = pub(skA) in
                        {5398}let v_5253: bool = (Sess_4527 = A) in
                        (
                            {5399}if v_5253 then
                            (
                                {5400}let pkSess_5254: bitstring = pub(skA) in
                                {5401}in(c, =GetEndpointRequest);
                                {5402}new SP_5255: bitstring;
                                {5403}new UP_5256: bitstring;
                                {5404}out(c, (GetEndpointResponse,pkSess_5254,None,SP_5255,UP_5256))
                            )
                            else
                                {5405}let v_5257: bool = (Sess_4527 = B) in
                                (
                                    {5406}if v_5257 then
                                    (
                                        {5407}let pkSess_5258: bitstring = pub(skB) in
                                        {5408}in(c, =GetEndpointRequest);
                                        {5409}new SP_5259: bitstring;
                                        {5410}new UP_5260: bitstring;
                                        {5411}out(c, (GetEndpointResponse,pkSess_5258,None,SP_5259,UP_5260))
                                    )
                                    else
                                        {5412}let v_5261: bool = (Sess_4527 = C) in
                                        (
                                            {5413}if v_5261 then
                                            (
                                                {5414}let pkSess_5262: bitstring = pub(skC) in
                                                {5415}in(c, =GetEndpointRequest);
                                                {5416}new SP_5263: bitstring;
                                                {5417}new UP_5264: bitstring;
                                                {5418}out(c, (GetEndpointResponse,pkSess_5262,None,SP_5263,UP_5264))
                                            )
                                            else
                                                {5419}let pkSess_5265: bitstring = pub(sk(Sess_4527)) in
                                                {5420}in(c, =GetEndpointRequest);
                                                {5421}new SP_5266: bitstring;
                                                {5422}new UP_5267: bitstring;
                                                {5423}out(c, (GetEndpointResponse,pkSess_5265,None,SP_5266,UP_5267))
                                        )
                                        else
                                            {5424}let pkSess_5268: bitstring = fail-any in
                                            {5425}in(c, =GetEndpointRequest);
                                            {5426}new SP_5269: bitstring;
                                            {5427}new UP_5270: bitstring;
                                            {5428}out(c, (GetEndpointResponse,pkSess_5268,None,SP_5269,UP_5270))
                                )
                                else
                                    {5429}let pkSess_5271: bitstring = fail-any in
                                    {5430}in(c, =GetEndpointRequest);
                                    {5431}new SP_5272: bitstring;
                                    {5432}new UP_5273: bitstring;
                                    {5433}out(c, (GetEndpointResponse,pkSess_5271,None,SP_5272,UP_5273))
                        )
                        else
                            {5434}let pkSess_5274: bitstring = fail-any in
                            {5435}in(c, =GetEndpointRequest);
                            {5436}new SP_5275: bitstring;
                            {5437}new UP_5276: bitstring;
                            {5438}out(c, (GetEndpointResponse,pkSess_5274,None,SP_5275,UP_5276))
                    )
                    else
                        {5439}let v_5277: bool = (Cli_4525 = B) in
                        (
                            {5440}if v_5277 then
                            (
                                {5441}let pkCli_5278: bitstring = pub(skB) in
                                {5442}let v_5279: bool = (Sess_4527 = A) in
                                (
                                    {5443}if v_5279 then
                                    (
                                        {5444}let pkSess_5280: bitstring = pub(skA) in
                                        {5445}in(c, =GetEndpointRequest);
                                        {5446}new SP_5281: bitstring;
                                        {5447}new UP_5282: bitstring;
                                        {5448}out(c, (GetEndpointResponse,pkSess_5280,None,SP_5281,UP_5282))
                                    )
                                    else
                                        {5449}let v_5283: bool = (Sess_4527 = B) in
                                        (
                                            {5450}if v_5283 then
                                            (
                                                {5451}let pkSess_5284: bitstring = pub(skB) in
                                                {5452}in(c, =GetEndpointRequest);
                                                {5453}new SP_5285: bitstring;
                                                {5454}new UP_5286: bitstring;
                                                {5455}out(c, (GetEndpointResponse,pkSess_5284,None,SP_5285,UP_5286))
                                            )
                                            else
                                                {5456}let v_5287: bool = (Sess_4527 = C) in
                                                (
                                                    {5457}if v_5287 then
                                                    (
                                                        {5458}let pkSess_5288: bitstring = pub(skC) in
                                                        {5459}in(c, =GetEndpointRequest);
                                                        {5460}new SP_5289: bitstring;
                                                        {5461}new UP_5290: bitstring;
                                                        {5462}out(c, (GetEndpointResponse,pkSess_5288,None,SP_5289,UP_5290))
                                                    )
                                                    else
                                                        {5463}let pkSess_5291: bitstring = pub(sk(Sess_4527)) in
                                                        {5464}in(c, =GetEndpointRequest);
                                                        {5465}new SP_5292: bitstring;
                                                        {5466}new UP_5293: bitstring;
                                                        {5467}out(c, (GetEndpointResponse,pkSess_5291,None,SP_5292,UP_5293))
                                                )
                                                else
                                                    {5468}let pkSess_5294: bitstring = fail-any in
                                                    {5469}in(c, =GetEndpointRequest);
                                                    {5470}new SP_5295: bitstring;
                                                    {5471}new UP_5296: bitstring;
                                                    {5472}out(c, (GetEndpointResponse,pkSess_5294,None,SP_5295,UP_5296))
                                        )
                                        else
                                            {5473}let pkSess_5297: bitstring = fail-any in
                                            {5474}in(c, =GetEndpointRequest);
                                            {5475}new SP_5298: bitstring;
                                            {5476}new UP_5299: bitstring;
                                            {5477}out(c, (GetEndpointResponse,pkSess_5297,None,SP_5298,UP_5299))
                                )
                                else
                                    {5478}let pkSess_5300: bitstring = fail-any in
                                    {5479}in(c, =GetEndpointRequest);
                                    {5480}new SP_5301: bitstring;
                                    {5481}new UP_5302: bitstring;
                                    {5482}out(c, (GetEndpointResponse,pkSess_5300,None,SP_5301,UP_5302))
                            )
                            else
                                {5483}let v_5303: bool = (Cli_4525 = C) in
                                (
                                    {5484}if v_5303 then
                                    (
                                        {5485}let pkCli_5304: bitstring = pub(skC) in
                                        {5486}let v_5305: bool = (Sess_4527 = A) in
                                        (
                                            {5487}if v_5305 then
                                            (
                                                {5488}let pkSess_5306: bitstring = pub(skA) in
                                                {5489}in(c, =GetEndpointRequest);
                                                {5490}new SP_5307: bitstring;
                                                {5491}new UP_5308: bitstring;
                                                {5492}out(c, (GetEndpointResponse,pkSess_5306,None,SP_5307,UP_5308))
                                            )
                                            else
                                                {5493}let v_5309: bool = (Sess_4527 = B) in
                                                (
                                                    {5494}if v_5309 then
                                                    (
                                                        {5495}let pkSess_5310: bitstring = pub(skB) in
                                                        {5496}in(c, =GetEndpointRequest);
                                                        {5497}new SP_5311: bitstring;
                                                        {5498}new UP_5312: bitstring;
                                                        {5499}out(c, (GetEndpointResponse,pkSess_5310,None,SP_5311,UP_5312))
                                                    )
                                                    else
                                                        {5500}let v_5313: bool = (Sess_4527 = C) in
                                                        (
                                                            {5501}if v_5313 then
                                                            (
                                                                {5502}let pkSess_5314: bitstring = pub(skC) in
                                                                {5503}in(c, =GetEndpointRequest);
                                                                {5504}new SP_5315: bitstring;
                                                                {5505}new UP_5316: bitstring;
                                                                {5506}out(c, (GetEndpointResponse,pkSess_5314,None,SP_5315,UP_5316))
                                                            )
                                                            else
                                                                {5507}let pkSess_5317: bitstring = pub(sk(Sess_4527)) in
                                                                {5508}in(c, =GetEndpointRequest);
                                                                {5509}new SP_5318: bitstring;
                                                                {5510}new UP_5319: bitstring;
                                                                {5511}out(c, (GetEndpointResponse,pkSess_5317,None,SP_5318,UP_5319))
                                                        )
                                                        else
                                                            {5512}let pkSess_5320: bitstring = fail-any in
                                                            {5513}in(c, =GetEndpointRequest);
                                                            {5514}new SP_5321: bitstring;
                                                            {5515}new UP_5322: bitstring;
                                                            {5516}out(c, (GetEndpointResponse,pkSess_5320,None,SP_5321,UP_5322))
                                                )
                                                else
                                                    {5517}let pkSess_5323: bitstring = fail-any in
                                                    {5518}in(c, =GetEndpointRequest);
                                                    {5519}new SP_5324: bitstring;
                                                    {5520}new UP_5325: bitstring;
                                                    {5521}out(c, (GetEndpointResponse,pkSess_5323,None,SP_5324,UP_5325))
                                        )
                                        else
                                            {5522}let pkSess_5326: bitstring = fail-any in
                                            {5523}in(c, =GetEndpointRequest);
                                            {5524}new SP_5327: bitstring;
                                            {5525}new UP_5328: bitstring;
                                            {5526}out(c, (GetEndpointResponse,pkSess_5326,None,SP_5327,UP_5328))
                                    )
                                    else
                                        {5527}let pkCli_5329: bitstring = pub(sk(Cli_4525)) in
                                        {5528}let v_5330: bool = (Sess_4527 = A) in
                                        (
                                            {5529}if v_5330 then
                                            (
                                                {5530}let pkSess_5331: bitstring = pub(skA) in
                                                {5531}in(c, =GetEndpointRequest);
                                                {5532}new SP_5332: bitstring;
                                                {5533}new UP_5333: bitstring;
                                                {5534}out(c, (GetEndpointResponse,pkSess_5331,None,SP_5332,UP_5333))
                                            )
                                            else
                                                {5535}let v_5334: bool = (Sess_4527 = B) in
                                                (
                                                    {5536}if v_5334 then
                                                    (
                                                        {5537}let pkSess_5335: bitstring = pub(skB) in
                                                        {5538}in(c, =GetEndpointRequest);
                                                        {5539}new SP_5336: bitstring;
                                                        {5540}new UP_5337: bitstring;
                                                        {5541}out(c, (GetEndpointResponse,pkSess_5335,None,SP_5336,UP_5337))
                                                    )
                                                    else
                                                        {5542}let v_5338: bool = (Sess_4527 = C) in
                                                        (
                                                            {5543}if v_5338 then
                                                            (
                                                                {5544}let pkSess_5339: bitstring = pub(skC) in
                                                                {5545}in(c, =GetEndpointRequest);
                                                                {5546}new SP_5340: bitstring;
                                                                {5547}new UP_5341: bitstring;
                                                                {5548}out(c, (GetEndpointResponse,pkSess_5339,None,SP_5340,UP_5341))
                                                            )
                                                            else
                                                                {5549}let pkSess_5342: bitstring = pub(sk(Sess_4527)) in
                                                                {5550}in(c, =GetEndpointRequest);
                                                                {5551}new SP_5343: bitstring;
                                                                {5552}new UP_5344: bitstring;
                                                                {5553}out(c, (GetEndpointResponse,pkSess_5342,None,SP_5343,UP_5344))
                                                        )
                                                        else
                                                            {5554}let pkSess_5345: bitstring = fail-any in
                                                            {5555}in(c, =GetEndpointRequest);
                                                            {5556}new SP_5346: bitstring;
                                                            {5557}new UP_5347: bitstring;
                                                            {5558}out(c, (GetEndpointResponse,pkSess_5345,None,SP_5346,UP_5347))
                                                )
                                                else
                                                    {5559}let pkSess_5348: bitstring = fail-any in
                                                    {5560}in(c, =GetEndpointRequest);
                                                    {5561}new SP_5349: bitstring;
                                                    {5562}new UP_5350: bitstring;
                                                    {5563}out(c, (GetEndpointResponse,pkSess_5348,None,SP_5349,UP_5350))
                                        )
                                        else
                                            {5564}let pkSess_5351: bitstring = fail-any in
                                            {5565}in(c, =GetEndpointRequest);
                                            {5566}new SP_5352: bitstring;
                                            {5567}new UP_5353: bitstring;
                                            {5568}out(c, (GetEndpointResponse,pkSess_5351,None,SP_5352,UP_5353))
                                )
                                else
                                    {5569}let pkCli_5354: bitstring = fail-any in
                                    {5570}let v_5355: bool = (Sess_4527 = A) in
                                    (
                                        {5571}if v_5355 then
                                        (
                                            {5572}let pkSess_5356: bitstring = pub(skA) in
                                            {5573}in(c, =GetEndpointRequest);
                                            {5574}new SP_5357: bitstring;
                                            {5575}new UP_5358: bitstring;
                                            {5576}out(c, (GetEndpointResponse,pkSess_5356,None,SP_5357,UP_5358))
                                        )
                                        else
                                            {5577}let v_5359: bool = (Sess_4527 = B) in
                                            (
                                                {5578}if v_5359 then
                                                (
                                                    {5579}let pkSess_5360: bitstring = pub(skB) in
                                                    {5580}in(c, =GetEndpointRequest);
                                                    {5581}new SP_5361: bitstring;
                                                    {5582}new UP_5362: bitstring;
                                                    {5583}out(c, (GetEndpointResponse,pkSess_5360,None,SP_5361,UP_5362))
                                                )
                                                else
                                                    {5584}let v_5363: bool = (Sess_4527 = C) in
                                                    (
                                                        {5585}if v_5363 then
                                                        (
                                                            {5586}let pkSess_5364: bitstring = pub(skC) in
                                                            {5587}in(c, =GetEndpointRequest);
                                                            {5588}new SP_5365: bitstring;
                                                            {5589}new UP_5366: bitstring;
                                                            {5590}out(c, (GetEndpointResponse,pkSess_5364,None,SP_5365,UP_5366))
                                                        )
                                                        else
                                                            {5591}let pkSess_5367: bitstring = pub(sk(Sess_4527)) in
                                                            {5592}in(c, =GetEndpointRequest);
                                                            {5593}new SP_5368: bitstring;
                                                            {5594}new UP_5369: bitstring;
                                                            {5595}out(c, (GetEndpointResponse,pkSess_5367,None,SP_5368,UP_5369))
                                                    )
                                                    else
                                                        {5596}let pkSess_5370: bitstring = fail-any in
                                                        {5597}in(c, =GetEndpointRequest);
                                                        {5598}new SP_5371: bitstring;
                                                        {5599}new UP_5372: bitstring;
                                                        {5600}out(c, (GetEndpointResponse,pkSess_5370,None,SP_5371,UP_5372))
                                            )
                                            else
                                                {5601}let pkSess_5373: bitstring = fail-any in
                                                {5602}in(c, =GetEndpointRequest);
                                                {5603}new SP_5374: bitstring;
                                                {5604}new UP_5375: bitstring;
                                                {5605}out(c, (GetEndpointResponse,pkSess_5373,None,SP_5374,UP_5375))
                                    )
                                    else
                                        {5606}let pkSess_5376: bitstring = fail-any in
                                        {5607}in(c, =GetEndpointRequest);
                                        {5608}new SP_5377: bitstring;
                                        {5609}new UP_5378: bitstring;
                                        {5610}out(c, (GetEndpointResponse,pkSess_5376,None,SP_5377,UP_5378))
                        )
                        else
                            {5611}let pkCli_5379: bitstring = fail-any in
                            {5612}let v_5380: bool = (Sess_4527 = A) in
                            (
                                {5613}if v_5380 then
                                (
                                    {5614}let pkSess_5381: bitstring = pub(skA) in
                                    {5615}in(c, =GetEndpointRequest);
                                    {5616}new SP_5382: bitstring;
                                    {5617}new UP_5383: bitstring;
                                    {5618}out(c, (GetEndpointResponse,pkSess_5381,None,SP_5382,UP_5383))
                                )
                                else
                                    {5619}let v_5384: bool = (Sess_4527 = B) in
                                    (
                                        {5620}if v_5384 then
                                        (
                                            {5621}let pkSess_5385: bitstring = pub(skB) in
                                            {5622}in(c, =GetEndpointRequest);
                                            {5623}new SP_5386: bitstring;
                                            {5624}new UP_5387: bitstring;
                                            {5625}out(c, (GetEndpointResponse,pkSess_5385,None,SP_5386,UP_5387))
                                        )
                                        else
                                            {5626}let v_5388: bool = (Sess_4527 = C) in
                                            (
                                                {5627}if v_5388 then
                                                (
                                                    {5628}let pkSess_5389: bitstring = pub(skC) in
                                                    {5629}in(c, =GetEndpointRequest);
                                                    {5630}new SP_5390: bitstring;
                                                    {5631}new UP_5391: bitstring;
                                                    {5632}out(c, (GetEndpointResponse,pkSess_5389,None,SP_5390,UP_5391))
                                                )
                                                else
                                                    {5633}let pkSess_5392: bitstring = pub(sk(Sess_4527)) in
                                                    {5634}in(c, =GetEndpointRequest);
                                                    {5635}new SP_5393: bitstring;
                                                    {5636}new UP_5394: bitstring;
                                                    {5637}out(c, (GetEndpointResponse,pkSess_5392,None,SP_5393,UP_5394))
                                            )
                                            else
                                                {5638}let pkSess_5395: bitstring = fail-any in
                                                {5639}in(c, =GetEndpointRequest);
                                                {5640}new SP_5396: bitstring;
                                                {5641}new UP_5397: bitstring;
                                                {5642}out(c, (GetEndpointResponse,pkSess_5395,None,SP_5396,UP_5397))
                                    )
                                    else
                                        {5643}let pkSess_5398: bitstring = fail-any in
                                        {5644}in(c, =GetEndpointRequest);
                                        {5645}new SP_5399: bitstring;
                                        {5646}new UP_5400: bitstring;
                                        {5647}out(c, (GetEndpointResponse,pkSess_5398,None,SP_5399,UP_5400))
                            )
                            else
                                {5648}let pkSess_5401: bitstring = fail-any in
                                {5649}in(c, =GetEndpointRequest);
                                {5650}new SP_5402: bitstring;
                                {5651}new UP_5403: bitstring;
                                {5652}out(c, (GetEndpointResponse,pkSess_5401,None,SP_5402,UP_5403))
                )
                else
                    {5653}let pkCli_5404: bitstring = fail-any in
                    {5654}let v_5405: bool = (Sess_4527 = A) in
                    (
                        {5655}if v_5405 then
                        (
                            {5656}let pkSess_5406: bitstring = pub(skA) in
                            {5657}in(c, =GetEndpointRequest);
                            {5658}new SP_5407: bitstring;
                            {5659}new UP_5408: bitstring;
                            {5660}out(c, (GetEndpointResponse,pkSess_5406,None,SP_5407,UP_5408))
                        )
                        else
                            {5661}let v_5409: bool = (Sess_4527 = B) in
                            (
                                {5662}if v_5409 then
                                (
                                    {5663}let pkSess_5410: bitstring = pub(skB) in
                                    {5664}in(c, =GetEndpointRequest);
                                    {5665}new SP_5411: bitstring;
                                    {5666}new UP_5412: bitstring;
                                    {5667}out(c, (GetEndpointResponse,pkSess_5410,None,SP_5411,UP_5412))
                                )
                                else
                                    {5668}let v_5413: bool = (Sess_4527 = C) in
                                    (
                                        {5669}if v_5413 then
                                        (
                                            {5670}let pkSess_5414: bitstring = pub(skC) in
                                            {5671}in(c, =GetEndpointRequest);
                                            {5672}new SP_5415: bitstring;
                                            {5673}new UP_5416: bitstring;
                                            {5674}out(c, (GetEndpointResponse,pkSess_5414,None,SP_5415,UP_5416))
                                        )
                                        else
                                            {5675}let pkSess_5417: bitstring = pub(sk(Sess_4527)) in
                                            {5676}in(c, =GetEndpointRequest);
                                            {5677}new SP_5418: bitstring;
                                            {5678}new UP_5419: bitstring;
                                            {5679}out(c, (GetEndpointResponse,pkSess_5417,None,SP_5418,UP_5419))
                                    )
                                    else
                                        {5680}let pkSess_5420: bitstring = fail-any in
                                        {5681}in(c, =GetEndpointRequest);
                                        {5682}new SP_5421: bitstring;
                                        {5683}new UP_5422: bitstring;
                                        {5684}out(c, (GetEndpointResponse,pkSess_5420,None,SP_5421,UP_5422))
                            )
                            else
                                {5685}let pkSess_5423: bitstring = fail-any in
                                {5686}in(c, =GetEndpointRequest);
                                {5687}new SP_5424: bitstring;
                                {5688}new UP_5425: bitstring;
                                {5689}out(c, (GetEndpointResponse,pkSess_5423,None,SP_5424,UP_5425))
                    )
                    else
                        {5690}let pkSess_5426: bitstring = fail-any in
                        {5691}in(c, =GetEndpointRequest);
                        {5692}new SP_5427: bitstring;
                        {5693}new UP_5428: bitstring;
                        {5694}out(c, (GetEndpointResponse,pkSess_5426,None,SP_5427,UP_5428))
    )
    else
        {5695}let skDisco_5429: bitstring = fail-any in
        {5696}let pkDisco_5430: bitstring = pub(skDisco_5429) in
        {5697}let v_5431: bool = (Cli_4525 = A) in
        (
            {5698}if v_5431 then
            (
                {5699}let pkCli_5432: bitstring = pub(skA) in
                {5700}let v_5433: bool = (Sess_4527 = A) in
                (
                    {5701}if v_5433 then
                    (
                        {5702}let pkSess_5434: bitstring = pub(skA) in
                        {5703}in(c, =GetEndpointRequest);
                        {5704}new SP_5435: bitstring;
                        {5705}new UP_5436: bitstring;
                        {5706}out(c, (GetEndpointResponse,pkSess_5434,None,SP_5435,UP_5436))
                    )
                    else
                        {5707}let v_5437: bool = (Sess_4527 = B) in
                        (
                            {5708}if v_5437 then
                            (
                                {5709}let pkSess_5438: bitstring = pub(skB) in
                                {5710}in(c, =GetEndpointRequest);
                                {5711}new SP_5439: bitstring;
                                {5712}new UP_5440: bitstring;
                                {5713}out(c, (GetEndpointResponse,pkSess_5438,None,SP_5439,UP_5440))
                            )
                            else
                                {5714}let v_5441: bool = (Sess_4527 = C) in
                                (
                                    {5715}if v_5441 then
                                    (
                                        {5716}let pkSess_5442: bitstring = pub(skC) in
                                        {5717}in(c, =GetEndpointRequest);
                                        {5718}new SP_5443: bitstring;
                                        {5719}new UP_5444: bitstring;
                                        {5720}out(c, (GetEndpointResponse,pkSess_5442,None,SP_5443,UP_5444))
                                    )
                                    else
                                        {5721}let pkSess_5445: bitstring = pub(sk(Sess_4527)) in
                                        {5722}in(c, =GetEndpointRequest);
                                        {5723}new SP_5446: bitstring;
                                        {5724}new UP_5447: bitstring;
                                        {5725}out(c, (GetEndpointResponse,pkSess_5445,None,SP_5446,UP_5447))
                                )
                                else
                                    {5726}let pkSess_5448: bitstring = fail-any in
                                    {5727}in(c, =GetEndpointRequest);
                                    {5728}new SP_5449: bitstring;
                                    {5729}new UP_5450: bitstring;
                                    {5730}out(c, (GetEndpointResponse,pkSess_5448,None,SP_5449,UP_5450))
                        )
                        else
                            {5731}let pkSess_5451: bitstring = fail-any in
                            {5732}in(c, =GetEndpointRequest);
                            {5733}new SP_5452: bitstring;
                            {5734}new UP_5453: bitstring;
                            {5735}out(c, (GetEndpointResponse,pkSess_5451,None,SP_5452,UP_5453))
                )
                else
                    {5736}let pkSess_5454: bitstring = fail-any in
                    {5737}in(c, =GetEndpointRequest);
                    {5738}new SP_5455: bitstring;
                    {5739}new UP_5456: bitstring;
                    {5740}out(c, (GetEndpointResponse,pkSess_5454,None,SP_5455,UP_5456))
            )
            else
                {5741}let v_5457: bool = (Cli_4525 = B) in
                (
                    {5742}if v_5457 then
                    (
                        {5743}let pkCli_5458: bitstring = pub(skB) in
                        {5744}let v_5459: bool = (Sess_4527 = A) in
                        (
                            {5745}if v_5459 then
                            (
                                {5746}let pkSess_5460: bitstring = pub(skA) in
                                {5747}in(c, =GetEndpointRequest);
                                {5748}new SP_5461: bitstring;
                                {5749}new UP_5462: bitstring;
                                {5750}out(c, (GetEndpointResponse,pkSess_5460,None,SP_5461,UP_5462))
                            )
                            else
                                {5751}let v_5463: bool = (Sess_4527 = B) in
                                (
                                    {5752}if v_5463 then
                                    (
                                        {5753}let pkSess_5464: bitstring = pub(skB) in
                                        {5754}in(c, =GetEndpointRequest);
                                        {5755}new SP_5465: bitstring;
                                        {5756}new UP_5466: bitstring;
                                        {5757}out(c, (GetEndpointResponse,pkSess_5464,None,SP_5465,UP_5466))
                                    )
                                    else
                                        {5758}let v_5467: bool = (Sess_4527 = C) in
                                        (
                                            {5759}if v_5467 then
                                            (
                                                {5760}let pkSess_5468: bitstring = pub(skC) in
                                                {5761}in(c, =GetEndpointRequest);
                                                {5762}new SP_5469: bitstring;
                                                {5763}new UP_5470: bitstring;
                                                {5764}out(c, (GetEndpointResponse,pkSess_5468,None,SP_5469,UP_5470))
                                            )
                                            else
                                                {5765}let pkSess_5471: bitstring = pub(sk(Sess_4527)) in
                                                {5766}in(c, =GetEndpointRequest);
                                                {5767}new SP_5472: bitstring;
                                                {5768}new UP_5473: bitstring;
                                                {5769}out(c, (GetEndpointResponse,pkSess_5471,None,SP_5472,UP_5473))
                                        )
                                        else
                                            {5770}let pkSess_5474: bitstring = fail-any in
                                            {5771}in(c, =GetEndpointRequest);
                                            {5772}new SP_5475: bitstring;
                                            {5773}new UP_5476: bitstring;
                                            {5774}out(c, (GetEndpointResponse,pkSess_5474,None,SP_5475,UP_5476))
                                )
                                else
                                    {5775}let pkSess_5477: bitstring = fail-any in
                                    {5776}in(c, =GetEndpointRequest);
                                    {5777}new SP_5478: bitstring;
                                    {5778}new UP_5479: bitstring;
                                    {5779}out(c, (GetEndpointResponse,pkSess_5477,None,SP_5478,UP_5479))
                        )
                        else
                            {5780}let pkSess_5480: bitstring = fail-any in
                            {5781}in(c, =GetEndpointRequest);
                            {5782}new SP_5481: bitstring;
                            {5783}new UP_5482: bitstring;
                            {5784}out(c, (GetEndpointResponse,pkSess_5480,None,SP_5481,UP_5482))
                    )
                    else
                        {5785}let v_5483: bool = (Cli_4525 = C) in
                        (
                            {5786}if v_5483 then
                            (
                                {5787}let pkCli_5484: bitstring = pub(skC) in
                                {5788}let v_5485: bool = (Sess_4527 = A) in
                                (
                                    {5789}if v_5485 then
                                    (
                                        {5790}let pkSess_5486: bitstring = pub(skA) in
                                        {5791}in(c, =GetEndpointRequest);
                                        {5792}new SP_5487: bitstring;
                                        {5793}new UP_5488: bitstring;
                                        {5794}out(c, (GetEndpointResponse,pkSess_5486,None,SP_5487,UP_5488))
                                    )
                                    else
                                        {5795}let v_5489: bool = (Sess_4527 = B) in
                                        (
                                            {5796}if v_5489 then
                                            (
                                                {5797}let pkSess_5490: bitstring = pub(skB) in
                                                {5798}in(c, =GetEndpointRequest);
                                                {5799}new SP_5491: bitstring;
                                                {5800}new UP_5492: bitstring;
                                                {5801}out(c, (GetEndpointResponse,pkSess_5490,None,SP_5491,UP_5492))
                                            )
                                            else
                                                {5802}let v_5493: bool = (Sess_4527 = C) in
                                                (
                                                    {5803}if v_5493 then
                                                    (
                                                        {5804}let pkSess_5494: bitstring = pub(skC) in
                                                        {5805}in(c, =GetEndpointRequest);
                                                        {5806}new SP_5495: bitstring;
                                                        {5807}new UP_5496: bitstring;
                                                        {5808}out(c, (GetEndpointResponse,pkSess_5494,None,SP_5495,UP_5496))
                                                    )
                                                    else
                                                        {5809}let pkSess_5497: bitstring = pub(sk(Sess_4527)) in
                                                        {5810}in(c, =GetEndpointRequest);
                                                        {5811}new SP_5498: bitstring;
                                                        {5812}new UP_5499: bitstring;
                                                        {5813}out(c, (GetEndpointResponse,pkSess_5497,None,SP_5498,UP_5499))
                                                )
                                                else
                                                    {5814}let pkSess_5500: bitstring = fail-any in
                                                    {5815}in(c, =GetEndpointRequest);
                                                    {5816}new SP_5501: bitstring;
                                                    {5817}new UP_5502: bitstring;
                                                    {5818}out(c, (GetEndpointResponse,pkSess_5500,None,SP_5501,UP_5502))
                                        )
                                        else
                                            {5819}let pkSess_5503: bitstring = fail-any in
                                            {5820}in(c, =GetEndpointRequest);
                                            {5821}new SP_5504: bitstring;
                                            {5822}new UP_5505: bitstring;
                                            {5823}out(c, (GetEndpointResponse,pkSess_5503,None,SP_5504,UP_5505))
                                )
                                else
                                    {5824}let pkSess_5506: bitstring = fail-any in
                                    {5825}in(c, =GetEndpointRequest);
                                    {5826}new SP_5507: bitstring;
                                    {5827}new UP_5508: bitstring;
                                    {5828}out(c, (GetEndpointResponse,pkSess_5506,None,SP_5507,UP_5508))
                            )
                            else
                                {5829}let pkCli_5509: bitstring = pub(sk(Cli_4525)) in
                                {5830}let v_5510: bool = (Sess_4527 = A) in
                                (
                                    {5831}if v_5510 then
                                    (
                                        {5832}let pkSess_5511: bitstring = pub(skA) in
                                        {5833}in(c, =GetEndpointRequest);
                                        {5834}new SP_5512: bitstring;
                                        {5835}new UP_5513: bitstring;
                                        {5836}out(c, (GetEndpointResponse,pkSess_5511,None,SP_5512,UP_5513))
                                    )
                                    else
                                        {5837}let v_5514: bool = (Sess_4527 = B) in
                                        (
                                            {5838}if v_5514 then
                                            (
                                                {5839}let pkSess_5515: bitstring = pub(skB) in
                                                {5840}in(c, =GetEndpointRequest);
                                                {5841}new SP_5516: bitstring;
                                                {5842}new UP_5517: bitstring;
                                                {5843}out(c, (GetEndpointResponse,pkSess_5515,None,SP_5516,UP_5517))
                                            )
                                            else
                                                {5844}let v_5518: bool = (Sess_4527 = C) in
                                                (
                                                    {5845}if v_5518 then
                                                    (
                                                        {5846}let pkSess_5519: bitstring = pub(skC) in
                                                        {5847}in(c, =GetEndpointRequest);
                                                        {5848}new SP_5520: bitstring;
                                                        {5849}new UP_5521: bitstring;
                                                        {5850}out(c, (GetEndpointResponse,pkSess_5519,None,SP_5520,UP_5521))
                                                    )
                                                    else
                                                        {5851}let pkSess_5522: bitstring = pub(sk(Sess_4527)) in
                                                        {5852}in(c, =GetEndpointRequest);
                                                        {5853}new SP_5523: bitstring;
                                                        {5854}new UP_5524: bitstring;
                                                        {5855}out(c, (GetEndpointResponse,pkSess_5522,None,SP_5523,UP_5524))
                                                )
                                                else
                                                    {5856}let pkSess_5525: bitstring = fail-any in
                                                    {5857}in(c, =GetEndpointRequest);
                                                    {5858}new SP_5526: bitstring;
                                                    {5859}new UP_5527: bitstring;
                                                    {5860}out(c, (GetEndpointResponse,pkSess_5525,None,SP_5526,UP_5527))
                                        )
                                        else
                                            {5861}let pkSess_5528: bitstring = fail-any in
                                            {5862}in(c, =GetEndpointRequest);
                                            {5863}new SP_5529: bitstring;
                                            {5864}new UP_5530: bitstring;
                                            {5865}out(c, (GetEndpointResponse,pkSess_5528,None,SP_5529,UP_5530))
                                )
                                else
                                    {5866}let pkSess_5531: bitstring = fail-any in
                                    {5867}in(c, =GetEndpointRequest);
                                    {5868}new SP_5532: bitstring;
                                    {5869}new UP_5533: bitstring;
                                    {5870}out(c, (GetEndpointResponse,pkSess_5531,None,SP_5532,UP_5533))
                        )
                        else
                            {5871}let pkCli_5534: bitstring = fail-any in
                            {5872}let v_5535: bool = (Sess_4527 = A) in
                            (
                                {5873}if v_5535 then
                                (
                                    {5874}let pkSess_5536: bitstring = pub(skA) in
                                    {5875}in(c, =GetEndpointRequest);
                                    {5876}new SP_5537: bitstring;
                                    {5877}new UP_5538: bitstring;
                                    {5878}out(c, (GetEndpointResponse,pkSess_5536,None,SP_5537,UP_5538))
                                )
                                else
                                    {5879}let v_5539: bool = (Sess_4527 = B) in
                                    (
                                        {5880}if v_5539 then
                                        (
                                            {5881}let pkSess_5540: bitstring = pub(skB) in
                                            {5882}in(c, =GetEndpointRequest);
                                            {5883}new SP_5541: bitstring;
                                            {5884}new UP_5542: bitstring;
                                            {5885}out(c, (GetEndpointResponse,pkSess_5540,None,SP_5541,UP_5542))
                                        )
                                        else
                                            {5886}let v_5543: bool = (Sess_4527 = C) in
                                            (
                                                {5887}if v_5543 then
                                                (
                                                    {5888}let pkSess_5544: bitstring = pub(skC) in
                                                    {5889}in(c, =GetEndpointRequest);
                                                    {5890}new SP_5545: bitstring;
                                                    {5891}new UP_5546: bitstring;
                                                    {5892}out(c, (GetEndpointResponse,pkSess_5544,None,SP_5545,UP_5546))
                                                )
                                                else
                                                    {5893}let pkSess_5547: bitstring = pub(sk(Sess_4527)) in
                                                    {5894}in(c, =GetEndpointRequest);
                                                    {5895}new SP_5548: bitstring;
                                                    {5896}new UP_5549: bitstring;
                                                    {5897}out(c, (GetEndpointResponse,pkSess_5547,None,SP_5548,UP_5549))
                                            )
                                            else
                                                {5898}let pkSess_5550: bitstring = fail-any in
                                                {5899}in(c, =GetEndpointRequest);
                                                {5900}new SP_5551: bitstring;
                                                {5901}new UP_5552: bitstring;
                                                {5902}out(c, (GetEndpointResponse,pkSess_5550,None,SP_5551,UP_5552))
                                    )
                                    else
                                        {5903}let pkSess_5553: bitstring = fail-any in
                                        {5904}in(c, =GetEndpointRequest);
                                        {5905}new SP_5554: bitstring;
                                        {5906}new UP_5555: bitstring;
                                        {5907}out(c, (GetEndpointResponse,pkSess_5553,None,SP_5554,UP_5555))
                            )
                            else
                                {5908}let pkSess_5556: bitstring = fail-any in
                                {5909}in(c, =GetEndpointRequest);
                                {5910}new SP_5557: bitstring;
                                {5911}new UP_5558: bitstring;
                                {5912}out(c, (GetEndpointResponse,pkSess_5556,None,SP_5557,UP_5558))
                )
                else
                    {5913}let pkCli_5559: bitstring = fail-any in
                    {5914}let v_5560: bool = (Sess_4527 = A) in
                    (
                        {5915}if v_5560 then
                        (
                            {5916}let pkSess_5561: bitstring = pub(skA) in
                            {5917}in(c, =GetEndpointRequest);
                            {5918}new SP_5562: bitstring;
                            {5919}new UP_5563: bitstring;
                            {5920}out(c, (GetEndpointResponse,pkSess_5561,None,SP_5562,UP_5563))
                        )
                        else
                            {5921}let v_5564: bool = (Sess_4527 = B) in
                            (
                                {5922}if v_5564 then
                                (
                                    {5923}let pkSess_5565: bitstring = pub(skB) in
                                    {5924}in(c, =GetEndpointRequest);
                                    {5925}new SP_5566: bitstring;
                                    {5926}new UP_5567: bitstring;
                                    {5927}out(c, (GetEndpointResponse,pkSess_5565,None,SP_5566,UP_5567))
                                )
                                else
                                    {5928}let v_5568: bool = (Sess_4527 = C) in
                                    (
                                        {5929}if v_5568 then
                                        (
                                            {5930}let pkSess_5569: bitstring = pub(skC) in
                                            {5931}in(c, =GetEndpointRequest);
                                            {5932}new SP_5570: bitstring;
                                            {5933}new UP_5571: bitstring;
                                            {5934}out(c, (GetEndpointResponse,pkSess_5569,None,SP_5570,UP_5571))
                                        )
                                        else
                                            {5935}let pkSess_5572: bitstring = pub(sk(Sess_4527)) in
                                            {5936}in(c, =GetEndpointRequest);
                                            {5937}new SP_5573: bitstring;
                                            {5938}new UP_5574: bitstring;
                                            {5939}out(c, (GetEndpointResponse,pkSess_5572,None,SP_5573,UP_5574))
                                    )
                                    else
                                        {5940}let pkSess_5575: bitstring = fail-any in
                                        {5941}in(c, =GetEndpointRequest);
                                        {5942}new SP_5576: bitstring;
                                        {5943}new UP_5577: bitstring;
                                        {5944}out(c, (GetEndpointResponse,pkSess_5575,None,SP_5576,UP_5577))
                            )
                            else
                                {5945}let pkSess_5578: bitstring = fail-any in
                                {5946}in(c, =GetEndpointRequest);
                                {5947}new SP_5579: bitstring;
                                {5948}new UP_5580: bitstring;
                                {5949}out(c, (GetEndpointResponse,pkSess_5578,None,SP_5579,UP_5580))
                    )
                    else
                        {5950}let pkSess_5581: bitstring = fail-any in
                        {5951}in(c, =GetEndpointRequest);
                        {5952}new SP_5582: bitstring;
                        {5953}new UP_5583: bitstring;
                        {5954}out(c, (GetEndpointResponse,pkSess_5581,None,SP_5582,UP_5583))
        )
        else
            {5955}let pkCli_5584: bitstring = fail-any in
            {5956}let v_5585: bool = (Sess_4527 = A) in
            (
                {5957}if v_5585 then
                (
                    {5958}let pkSess_5586: bitstring = pub(skA) in
                    {5959}in(c, =GetEndpointRequest);
                    {5960}new SP_5587: bitstring;
                    {5961}new UP_5588: bitstring;
                    {5962}out(c, (GetEndpointResponse,pkSess_5586,None,SP_5587,UP_5588))
                )
                else
                    {5963}let v_5589: bool = (Sess_4527 = B) in
                    (
                        {5964}if v_5589 then
                        (
                            {5965}let pkSess_5590: bitstring = pub(skB) in
                            {5966}in(c, =GetEndpointRequest);
                            {5967}new SP_5591: bitstring;
                            {5968}new UP_5592: bitstring;
                            {5969}out(c, (GetEndpointResponse,pkSess_5590,None,SP_5591,UP_5592))
                        )
                        else
                            {5970}let v_5593: bool = (Sess_4527 = C) in
                            (
                                {5971}if v_5593 then
                                (
                                    {5972}let pkSess_5594: bitstring = pub(skC) in
                                    {5973}in(c, =GetEndpointRequest);
                                    {5974}new SP_5595: bitstring;
                                    {5975}new UP_5596: bitstring;
                                    {5976}out(c, (GetEndpointResponse,pkSess_5594,None,SP_5595,UP_5596))
                                )
                                else
                                    {5977}let pkSess_5597: bitstring = pub(sk(Sess_4527)) in
                                    {5978}in(c, =GetEndpointRequest);
                                    {5979}new SP_5598: bitstring;
                                    {5980}new UP_5599: bitstring;
                                    {5981}out(c, (GetEndpointResponse,pkSess_5597,None,SP_5598,UP_5599))
                            )
                            else
                                {5982}let pkSess_5600: bitstring = fail-any in
                                {5983}in(c, =GetEndpointRequest);
                                {5984}new SP_5601: bitstring;
                                {5985}new UP_5602: bitstring;
                                {5986}out(c, (GetEndpointResponse,pkSess_5600,None,SP_5601,UP_5602))
                    )
                    else
                        {5987}let pkSess_5603: bitstring = fail-any in
                        {5988}in(c, =GetEndpointRequest);
                        {5989}new SP_5604: bitstring;
                        {5990}new UP_5605: bitstring;
                        {5991}out(c, (GetEndpointResponse,pkSess_5603,None,SP_5604,UP_5605))
            )
            else
                {5992}let pkSess_5606: bitstring = fail-any in
                {5993}in(c, =GetEndpointRequest);
                {5994}new SP_5607: bitstring;
                {5995}new UP_5608: bitstring;
                {5996}out(c, (GetEndpointResponse,pkSess_5606,None,SP_5607,UP_5608))
) | (
    {5997}!
    {5998}in(c, (Cli_5609: host,Disco_5610: host,Sess_5611: host));
    {5999}let v_5612: bool = (Sess_5611 = A) in
    (
        {6000}if v_5612 then
        (
            {6001}let skSess: bitstring = skA in
            {6002}let pkSess_5613: bitstring = pub(skSess) in
            {6003}let v_5614: bool = (Cli_5609 = A) in
            (
                {6004}if v_5614 then
                (
                    {6005}let pkCli_5615: bitstring = pub(skA) in
                    {6006}let v_5616: bool = (Disco_5610 = A) in
                    (
                        {6007}if v_5616 then
                        (
                            {6008}let pkDisco_5617: bitstring = pub(skA) in
                            {6009}in(c, (=pkCli_5615,em1: bitstring));
                            {6010}let m1_5618: bitstring = em1 in
                            {6011}let (=OpenSecureChannelRequest,=pkCli_5615,PartC: bitstring) = m1_5618 in
                            {6012}new Ns: bitstring;
                            {6013}new ST_5619: bitstring;
                            {6014}new TTL_5620: bitstring;
                            {6015}let gNs: bitstring = exp(g,Ns) in
                            {6016}let m2_5621: bitstring = (OpenSecureChannelResponse,gNs,ST_5619,TTL_5620) in
                            {6017}out(c, m2_5621);
                            {6018}let Ksrv: bitstring = exp(PartC,Ns) in
                            {6019}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv))
                        )
                        else
                            {6020}let v_5622: bool = (Disco_5610 = B) in
                            (
                                {6021}if v_5622 then
                                (
                                    {6022}let pkDisco_5623: bitstring = pub(skB) in
                                    {6023}in(c, (=pkCli_5615,em1_5624: bitstring));
                                    {6024}let m1_5625: bitstring = em1_5624 in
                                    {6025}let (=OpenSecureChannelRequest,=pkCli_5615,PartC_5626: bitstring) = m1_5625 in
                                    {6026}new Ns_5627: bitstring;
                                    {6027}new ST_5628: bitstring;
                                    {6028}new TTL_5629: bitstring;
                                    {6029}let gNs_5630: bitstring = exp(g,Ns_5627) in
                                    {6030}let m2_5631: bitstring = (OpenSecureChannelResponse,gNs_5630,ST_5628,TTL_5629) in
                                    {6031}out(c, m2_5631);
                                    {6032}let Ksrv_5632: bitstring = exp(PartC_5626,Ns_5627) in
                                    {6033}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv_5632))
                                )
                                else
                                    {6034}let v_5633: bool = (Disco_5610 = C) in
                                    (
                                        {6035}if v_5633 then
                                        (
                                            {6036}let pkDisco_5634: bitstring = pub(skC) in
                                            {6037}in(c, (=pkCli_5615,em1_5635: bitstring));
                                            {6038}let m1_5636: bitstring = em1_5635 in
                                            {6039}let (=OpenSecureChannelRequest,=pkCli_5615,PartC_5637: bitstring) = m1_5636 in
                                            {6040}new Ns_5638: bitstring;
                                            {6041}new ST_5639: bitstring;
                                            {6042}new TTL_5640: bitstring;
                                            {6043}let gNs_5641: bitstring = exp(g,Ns_5638) in
                                            {6044}let m2_5642: bitstring = (OpenSecureChannelResponse,gNs_5641,ST_5639,TTL_5640) in
                                            {6045}out(c, m2_5642);
                                            {6046}let Ksrv_5643: bitstring = exp(PartC_5637,Ns_5638) in
                                            {6047}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv_5643))
                                        )
                                        else
                                            {6048}let pkDisco_5644: bitstring = pub(sk(Disco_5610)) in
                                            {6049}in(c, (=pkCli_5615,em1_5645: bitstring));
                                            {6050}let m1_5646: bitstring = em1_5645 in
                                            {6051}let (=OpenSecureChannelRequest,=pkCli_5615,PartC_5647: bitstring) = m1_5646 in
                                            {6052}new Ns_5648: bitstring;
                                            {6053}new ST_5649: bitstring;
                                            {6054}new TTL_5650: bitstring;
                                            {6055}let gNs_5651: bitstring = exp(g,Ns_5648) in
                                            {6056}let m2_5652: bitstring = (OpenSecureChannelResponse,gNs_5651,ST_5649,TTL_5650) in
                                            {6057}out(c, m2_5652);
                                            {6058}let Ksrv_5653: bitstring = exp(PartC_5647,Ns_5648) in
                                            {6059}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv_5653))
                                    )
                                    else
                                        {6060}let pkDisco_5654: bitstring = fail-any in
                                        {6061}in(c, (=pkCli_5615,em1_5655: bitstring));
                                        {6062}let m1_5656: bitstring = em1_5655 in
                                        {6063}let (=OpenSecureChannelRequest,=pkCli_5615,PartC_5657: bitstring) = m1_5656 in
                                        {6064}new Ns_5658: bitstring;
                                        {6065}new ST_5659: bitstring;
                                        {6066}new TTL_5660: bitstring;
                                        {6067}let gNs_5661: bitstring = exp(g,Ns_5658) in
                                        {6068}let m2_5662: bitstring = (OpenSecureChannelResponse,gNs_5661,ST_5659,TTL_5660) in
                                        {6069}out(c, m2_5662);
                                        {6070}let Ksrv_5663: bitstring = exp(PartC_5657,Ns_5658) in
                                        {6071}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv_5663))
                            )
                            else
                                {6072}let pkDisco_5664: bitstring = fail-any in
                                {6073}in(c, (=pkCli_5615,em1_5665: bitstring));
                                {6074}let m1_5666: bitstring = em1_5665 in
                                {6075}let (=OpenSecureChannelRequest,=pkCli_5615,PartC_5667: bitstring) = m1_5666 in
                                {6076}new Ns_5668: bitstring;
                                {6077}new ST_5669: bitstring;
                                {6078}new TTL_5670: bitstring;
                                {6079}let gNs_5671: bitstring = exp(g,Ns_5668) in
                                {6080}let m2_5672: bitstring = (OpenSecureChannelResponse,gNs_5671,ST_5669,TTL_5670) in
                                {6081}out(c, m2_5672);
                                {6082}let Ksrv_5673: bitstring = exp(PartC_5667,Ns_5668) in
                                {6083}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv_5673))
                    )
                    else
                        {6084}let pkDisco_5674: bitstring = fail-any in
                        {6085}in(c, (=pkCli_5615,em1_5675: bitstring));
                        {6086}let m1_5676: bitstring = em1_5675 in
                        {6087}let (=OpenSecureChannelRequest,=pkCli_5615,PartC_5677: bitstring) = m1_5676 in
                        {6088}new Ns_5678: bitstring;
                        {6089}new ST_5679: bitstring;
                        {6090}new TTL_5680: bitstring;
                        {6091}let gNs_5681: bitstring = exp(g,Ns_5678) in
                        {6092}let m2_5682: bitstring = (OpenSecureChannelResponse,gNs_5681,ST_5679,TTL_5680) in
                        {6093}out(c, m2_5682);
                        {6094}let Ksrv_5683: bitstring = exp(PartC_5677,Ns_5678) in
                        {6095}out(c, senc(mSrv(pkCli_5615,pkSess_5613),Ksrv_5683))
                )
                else
                    {6096}let v_5684: bool = (Cli_5609 = B) in
                    (
                        {6097}if v_5684 then
                        (
                            {6098}let pkCli_5685: bitstring = pub(skB) in
                            {6099}let v_5686: bool = (Disco_5610 = A) in
                            (
                                {6100}if v_5686 then
                                (
                                    {6101}let pkDisco_5687: bitstring = pub(skA) in
                                    {6102}in(c, (=pkCli_5685,em1_5688: bitstring));
                                    {6103}let m1_5689: bitstring = em1_5688 in
                                    {6104}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5690: bitstring) = m1_5689 in
                                    {6105}new Ns_5691: bitstring;
                                    {6106}new ST_5692: bitstring;
                                    {6107}new TTL_5693: bitstring;
                                    {6108}let gNs_5694: bitstring = exp(g,Ns_5691) in
                                    {6109}let m2_5695: bitstring = (OpenSecureChannelResponse,gNs_5694,ST_5692,TTL_5693) in
                                    {6110}out(c, m2_5695);
                                    {6111}let Ksrv_5696: bitstring = exp(PartC_5690,Ns_5691) in
                                    {6112}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5696))
                                )
                                else
                                    {6113}let v_5697: bool = (Disco_5610 = B) in
                                    (
                                        {6114}if v_5697 then
                                        (
                                            {6115}let pkDisco_5698: bitstring = pub(skB) in
                                            {6116}in(c, (=pkCli_5685,em1_5699: bitstring));
                                            {6117}let m1_5700: bitstring = em1_5699 in
                                            {6118}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5701: bitstring) = m1_5700 in
                                            {6119}new Ns_5702: bitstring;
                                            {6120}new ST_5703: bitstring;
                                            {6121}new TTL_5704: bitstring;
                                            {6122}let gNs_5705: bitstring = exp(g,Ns_5702) in
                                            {6123}let m2_5706: bitstring = (OpenSecureChannelResponse,gNs_5705,ST_5703,TTL_5704) in
                                            {6124}out(c, m2_5706);
                                            {6125}let Ksrv_5707: bitstring = exp(PartC_5701,Ns_5702) in
                                            {6126}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5707))
                                        )
                                        else
                                            {6127}let v_5708: bool = (Disco_5610 = C) in
                                            (
                                                {6128}if v_5708 then
                                                (
                                                    {6129}let pkDisco_5709: bitstring = pub(skC) in
                                                    {6130}in(c, (=pkCli_5685,em1_5710: bitstring));
                                                    {6131}let m1_5711: bitstring = em1_5710 in
                                                    {6132}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5712: bitstring) = m1_5711 in
                                                    {6133}new Ns_5713: bitstring;
                                                    {6134}new ST_5714: bitstring;
                                                    {6135}new TTL_5715: bitstring;
                                                    {6136}let gNs_5716: bitstring = exp(g,Ns_5713) in
                                                    {6137}let m2_5717: bitstring = (OpenSecureChannelResponse,gNs_5716,ST_5714,TTL_5715) in
                                                    {6138}out(c, m2_5717);
                                                    {6139}let Ksrv_5718: bitstring = exp(PartC_5712,Ns_5713) in
                                                    {6140}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5718))
                                                )
                                                else
                                                    {6141}let pkDisco_5719: bitstring = pub(sk(Disco_5610)) in
                                                    {6142}in(c, (=pkCli_5685,em1_5720: bitstring));
                                                    {6143}let m1_5721: bitstring = em1_5720 in
                                                    {6144}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5722: bitstring) = m1_5721 in
                                                    {6145}new Ns_5723: bitstring;
                                                    {6146}new ST_5724: bitstring;
                                                    {6147}new TTL_5725: bitstring;
                                                    {6148}let gNs_5726: bitstring = exp(g,Ns_5723) in
                                                    {6149}let m2_5727: bitstring = (OpenSecureChannelResponse,gNs_5726,ST_5724,TTL_5725) in
                                                    {6150}out(c, m2_5727);
                                                    {6151}let Ksrv_5728: bitstring = exp(PartC_5722,Ns_5723) in
                                                    {6152}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5728))
                                            )
                                            else
                                                {6153}let pkDisco_5729: bitstring = fail-any in
                                                {6154}in(c, (=pkCli_5685,em1_5730: bitstring));
                                                {6155}let m1_5731: bitstring = em1_5730 in
                                                {6156}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5732: bitstring) = m1_5731 in
                                                {6157}new Ns_5733: bitstring;
                                                {6158}new ST_5734: bitstring;
                                                {6159}new TTL_5735: bitstring;
                                                {6160}let gNs_5736: bitstring = exp(g,Ns_5733) in
                                                {6161}let m2_5737: bitstring = (OpenSecureChannelResponse,gNs_5736,ST_5734,TTL_5735) in
                                                {6162}out(c, m2_5737);
                                                {6163}let Ksrv_5738: bitstring = exp(PartC_5732,Ns_5733) in
                                                {6164}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5738))
                                    )
                                    else
                                        {6165}let pkDisco_5739: bitstring = fail-any in
                                        {6166}in(c, (=pkCli_5685,em1_5740: bitstring));
                                        {6167}let m1_5741: bitstring = em1_5740 in
                                        {6168}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5742: bitstring) = m1_5741 in
                                        {6169}new Ns_5743: bitstring;
                                        {6170}new ST_5744: bitstring;
                                        {6171}new TTL_5745: bitstring;
                                        {6172}let gNs_5746: bitstring = exp(g,Ns_5743) in
                                        {6173}let m2_5747: bitstring = (OpenSecureChannelResponse,gNs_5746,ST_5744,TTL_5745) in
                                        {6174}out(c, m2_5747);
                                        {6175}let Ksrv_5748: bitstring = exp(PartC_5742,Ns_5743) in
                                        {6176}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5748))
                            )
                            else
                                {6177}let pkDisco_5749: bitstring = fail-any in
                                {6178}in(c, (=pkCli_5685,em1_5750: bitstring));
                                {6179}let m1_5751: bitstring = em1_5750 in
                                {6180}let (=OpenSecureChannelRequest,=pkCli_5685,PartC_5752: bitstring) = m1_5751 in
                                {6181}new Ns_5753: bitstring;
                                {6182}new ST_5754: bitstring;
                                {6183}new TTL_5755: bitstring;
                                {6184}let gNs_5756: bitstring = exp(g,Ns_5753) in
                                {6185}let m2_5757: bitstring = (OpenSecureChannelResponse,gNs_5756,ST_5754,TTL_5755) in
                                {6186}out(c, m2_5757);
                                {6187}let Ksrv_5758: bitstring = exp(PartC_5752,Ns_5753) in
                                {6188}out(c, senc(mSrv(pkCli_5685,pkSess_5613),Ksrv_5758))
                        )
                        else
                            {6189}let v_5759: bool = (Cli_5609 = C) in
                            (
                                {6190}if v_5759 then
                                (
                                    {6191}let pkCli_5760: bitstring = pub(skC) in
                                    {6192}let v_5761: bool = (Disco_5610 = A) in
                                    (
                                        {6193}if v_5761 then
                                        (
                                            {6194}let pkDisco_5762: bitstring = pub(skA) in
                                            {6195}in(c, (=pkCli_5760,em1_5763: bitstring));
                                            {6196}let m1_5764: bitstring = em1_5763 in
                                            {6197}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5765: bitstring) = m1_5764 in
                                            {6198}new Ns_5766: bitstring;
                                            {6199}new ST_5767: bitstring;
                                            {6200}new TTL_5768: bitstring;
                                            {6201}let gNs_5769: bitstring = exp(g,Ns_5766) in
                                            {6202}let m2_5770: bitstring = (OpenSecureChannelResponse,gNs_5769,ST_5767,TTL_5768) in
                                            {6203}out(c, m2_5770);
                                            {6204}let Ksrv_5771: bitstring = exp(PartC_5765,Ns_5766) in
                                            {6205}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5771))
                                        )
                                        else
                                            {6206}let v_5772: bool = (Disco_5610 = B) in
                                            (
                                                {6207}if v_5772 then
                                                (
                                                    {6208}let pkDisco_5773: bitstring = pub(skB) in
                                                    {6209}in(c, (=pkCli_5760,em1_5774: bitstring));
                                                    {6210}let m1_5775: bitstring = em1_5774 in
                                                    {6211}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5776: bitstring) = m1_5775 in
                                                    {6212}new Ns_5777: bitstring;
                                                    {6213}new ST_5778: bitstring;
                                                    {6214}new TTL_5779: bitstring;
                                                    {6215}let gNs_5780: bitstring = exp(g,Ns_5777) in
                                                    {6216}let m2_5781: bitstring = (OpenSecureChannelResponse,gNs_5780,ST_5778,TTL_5779) in
                                                    {6217}out(c, m2_5781);
                                                    {6218}let Ksrv_5782: bitstring = exp(PartC_5776,Ns_5777) in
                                                    {6219}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5782))
                                                )
                                                else
                                                    {6220}let v_5783: bool = (Disco_5610 = C) in
                                                    (
                                                        {6221}if v_5783 then
                                                        (
                                                            {6222}let pkDisco_5784: bitstring = pub(skC) in
                                                            {6223}in(c, (=pkCli_5760,em1_5785: bitstring));
                                                            {6224}let m1_5786: bitstring = em1_5785 in
                                                            {6225}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5787: bitstring) = m1_5786 in
                                                            {6226}new Ns_5788: bitstring;
                                                            {6227}new ST_5789: bitstring;
                                                            {6228}new TTL_5790: bitstring;
                                                            {6229}let gNs_5791: bitstring = exp(g,Ns_5788) in
                                                            {6230}let m2_5792: bitstring = (OpenSecureChannelResponse,gNs_5791,ST_5789,TTL_5790) in
                                                            {6231}out(c, m2_5792);
                                                            {6232}let Ksrv_5793: bitstring = exp(PartC_5787,Ns_5788) in
                                                            {6233}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5793))
                                                        )
                                                        else
                                                            {6234}let pkDisco_5794: bitstring = pub(sk(Disco_5610)) in
                                                            {6235}in(c, (=pkCli_5760,em1_5795: bitstring));
                                                            {6236}let m1_5796: bitstring = em1_5795 in
                                                            {6237}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5797: bitstring) = m1_5796 in
                                                            {6238}new Ns_5798: bitstring;
                                                            {6239}new ST_5799: bitstring;
                                                            {6240}new TTL_5800: bitstring;
                                                            {6241}let gNs_5801: bitstring = exp(g,Ns_5798) in
                                                            {6242}let m2_5802: bitstring = (OpenSecureChannelResponse,gNs_5801,ST_5799,TTL_5800) in
                                                            {6243}out(c, m2_5802);
                                                            {6244}let Ksrv_5803: bitstring = exp(PartC_5797,Ns_5798) in
                                                            {6245}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5803))
                                                    )
                                                    else
                                                        {6246}let pkDisco_5804: bitstring = fail-any in
                                                        {6247}in(c, (=pkCli_5760,em1_5805: bitstring));
                                                        {6248}let m1_5806: bitstring = em1_5805 in
                                                        {6249}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5807: bitstring) = m1_5806 in
                                                        {6250}new Ns_5808: bitstring;
                                                        {6251}new ST_5809: bitstring;
                                                        {6252}new TTL_5810: bitstring;
                                                        {6253}let gNs_5811: bitstring = exp(g,Ns_5808) in
                                                        {6254}let m2_5812: bitstring = (OpenSecureChannelResponse,gNs_5811,ST_5809,TTL_5810) in
                                                        {6255}out(c, m2_5812);
                                                        {6256}let Ksrv_5813: bitstring = exp(PartC_5807,Ns_5808) in
                                                        {6257}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5813))
                                            )
                                            else
                                                {6258}let pkDisco_5814: bitstring = fail-any in
                                                {6259}in(c, (=pkCli_5760,em1_5815: bitstring));
                                                {6260}let m1_5816: bitstring = em1_5815 in
                                                {6261}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5817: bitstring) = m1_5816 in
                                                {6262}new Ns_5818: bitstring;
                                                {6263}new ST_5819: bitstring;
                                                {6264}new TTL_5820: bitstring;
                                                {6265}let gNs_5821: bitstring = exp(g,Ns_5818) in
                                                {6266}let m2_5822: bitstring = (OpenSecureChannelResponse,gNs_5821,ST_5819,TTL_5820) in
                                                {6267}out(c, m2_5822);
                                                {6268}let Ksrv_5823: bitstring = exp(PartC_5817,Ns_5818) in
                                                {6269}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5823))
                                    )
                                    else
                                        {6270}let pkDisco_5824: bitstring = fail-any in
                                        {6271}in(c, (=pkCli_5760,em1_5825: bitstring));
                                        {6272}let m1_5826: bitstring = em1_5825 in
                                        {6273}let (=OpenSecureChannelRequest,=pkCli_5760,PartC_5827: bitstring) = m1_5826 in
                                        {6274}new Ns_5828: bitstring;
                                        {6275}new ST_5829: bitstring;
                                        {6276}new TTL_5830: bitstring;
                                        {6277}let gNs_5831: bitstring = exp(g,Ns_5828) in
                                        {6278}let m2_5832: bitstring = (OpenSecureChannelResponse,gNs_5831,ST_5829,TTL_5830) in
                                        {6279}out(c, m2_5832);
                                        {6280}let Ksrv_5833: bitstring = exp(PartC_5827,Ns_5828) in
                                        {6281}out(c, senc(mSrv(pkCli_5760,pkSess_5613),Ksrv_5833))
                                )
                                else
                                    {6282}let pkCli_5834: bitstring = pub(sk(Cli_5609)) in
                                    {6283}let v_5835: bool = (Disco_5610 = A) in
                                    (
                                        {6284}if v_5835 then
                                        (
                                            {6285}let pkDisco_5836: bitstring = pub(skA) in
                                            {6286}in(c, (=pkCli_5834,em1_5837: bitstring));
                                            {6287}let m1_5838: bitstring = em1_5837 in
                                            {6288}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5839: bitstring) = m1_5838 in
                                            {6289}new Ns_5840: bitstring;
                                            {6290}new ST_5841: bitstring;
                                            {6291}new TTL_5842: bitstring;
                                            {6292}let gNs_5843: bitstring = exp(g,Ns_5840) in
                                            {6293}let m2_5844: bitstring = (OpenSecureChannelResponse,gNs_5843,ST_5841,TTL_5842) in
                                            {6294}out(c, m2_5844);
                                            {6295}let Ksrv_5845: bitstring = exp(PartC_5839,Ns_5840) in
                                            {6296}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5845))
                                        )
                                        else
                                            {6297}let v_5846: bool = (Disco_5610 = B) in
                                            (
                                                {6298}if v_5846 then
                                                (
                                                    {6299}let pkDisco_5847: bitstring = pub(skB) in
                                                    {6300}in(c, (=pkCli_5834,em1_5848: bitstring));
                                                    {6301}let m1_5849: bitstring = em1_5848 in
                                                    {6302}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5850: bitstring) = m1_5849 in
                                                    {6303}new Ns_5851: bitstring;
                                                    {6304}new ST_5852: bitstring;
                                                    {6305}new TTL_5853: bitstring;
                                                    {6306}let gNs_5854: bitstring = exp(g,Ns_5851) in
                                                    {6307}let m2_5855: bitstring = (OpenSecureChannelResponse,gNs_5854,ST_5852,TTL_5853) in
                                                    {6308}out(c, m2_5855);
                                                    {6309}let Ksrv_5856: bitstring = exp(PartC_5850,Ns_5851) in
                                                    {6310}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5856))
                                                )
                                                else
                                                    {6311}let v_5857: bool = (Disco_5610 = C) in
                                                    (
                                                        {6312}if v_5857 then
                                                        (
                                                            {6313}let pkDisco_5858: bitstring = pub(skC) in
                                                            {6314}in(c, (=pkCli_5834,em1_5859: bitstring));
                                                            {6315}let m1_5860: bitstring = em1_5859 in
                                                            {6316}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5861: bitstring) = m1_5860 in
                                                            {6317}new Ns_5862: bitstring;
                                                            {6318}new ST_5863: bitstring;
                                                            {6319}new TTL_5864: bitstring;
                                                            {6320}let gNs_5865: bitstring = exp(g,Ns_5862) in
                                                            {6321}let m2_5866: bitstring = (OpenSecureChannelResponse,gNs_5865,ST_5863,TTL_5864) in
                                                            {6322}out(c, m2_5866);
                                                            {6323}let Ksrv_5867: bitstring = exp(PartC_5861,Ns_5862) in
                                                            {6324}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5867))
                                                        )
                                                        else
                                                            {6325}let pkDisco_5868: bitstring = pub(sk(Disco_5610)) in
                                                            {6326}in(c, (=pkCli_5834,em1_5869: bitstring));
                                                            {6327}let m1_5870: bitstring = em1_5869 in
                                                            {6328}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5871: bitstring) = m1_5870 in
                                                            {6329}new Ns_5872: bitstring;
                                                            {6330}new ST_5873: bitstring;
                                                            {6331}new TTL_5874: bitstring;
                                                            {6332}let gNs_5875: bitstring = exp(g,Ns_5872) in
                                                            {6333}let m2_5876: bitstring = (OpenSecureChannelResponse,gNs_5875,ST_5873,TTL_5874) in
                                                            {6334}out(c, m2_5876);
                                                            {6335}let Ksrv_5877: bitstring = exp(PartC_5871,Ns_5872) in
                                                            {6336}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5877))
                                                    )
                                                    else
                                                        {6337}let pkDisco_5878: bitstring = fail-any in
                                                        {6338}in(c, (=pkCli_5834,em1_5879: bitstring));
                                                        {6339}let m1_5880: bitstring = em1_5879 in
                                                        {6340}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5881: bitstring) = m1_5880 in
                                                        {6341}new Ns_5882: bitstring;
                                                        {6342}new ST_5883: bitstring;
                                                        {6343}new TTL_5884: bitstring;
                                                        {6344}let gNs_5885: bitstring = exp(g,Ns_5882) in
                                                        {6345}let m2_5886: bitstring = (OpenSecureChannelResponse,gNs_5885,ST_5883,TTL_5884) in
                                                        {6346}out(c, m2_5886);
                                                        {6347}let Ksrv_5887: bitstring = exp(PartC_5881,Ns_5882) in
                                                        {6348}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5887))
                                            )
                                            else
                                                {6349}let pkDisco_5888: bitstring = fail-any in
                                                {6350}in(c, (=pkCli_5834,em1_5889: bitstring));
                                                {6351}let m1_5890: bitstring = em1_5889 in
                                                {6352}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5891: bitstring) = m1_5890 in
                                                {6353}new Ns_5892: bitstring;
                                                {6354}new ST_5893: bitstring;
                                                {6355}new TTL_5894: bitstring;
                                                {6356}let gNs_5895: bitstring = exp(g,Ns_5892) in
                                                {6357}let m2_5896: bitstring = (OpenSecureChannelResponse,gNs_5895,ST_5893,TTL_5894) in
                                                {6358}out(c, m2_5896);
                                                {6359}let Ksrv_5897: bitstring = exp(PartC_5891,Ns_5892) in
                                                {6360}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5897))
                                    )
                                    else
                                        {6361}let pkDisco_5898: bitstring = fail-any in
                                        {6362}in(c, (=pkCli_5834,em1_5899: bitstring));
                                        {6363}let m1_5900: bitstring = em1_5899 in
                                        {6364}let (=OpenSecureChannelRequest,=pkCli_5834,PartC_5901: bitstring) = m1_5900 in
                                        {6365}new Ns_5902: bitstring;
                                        {6366}new ST_5903: bitstring;
                                        {6367}new TTL_5904: bitstring;
                                        {6368}let gNs_5905: bitstring = exp(g,Ns_5902) in
                                        {6369}let m2_5906: bitstring = (OpenSecureChannelResponse,gNs_5905,ST_5903,TTL_5904) in
                                        {6370}out(c, m2_5906);
                                        {6371}let Ksrv_5907: bitstring = exp(PartC_5901,Ns_5902) in
                                        {6372}out(c, senc(mSrv(pkCli_5834,pkSess_5613),Ksrv_5907))
                            )
                            else
                                {6373}let pkCli_5908: bitstring = fail-any in
                                {6374}let v_5909: bool = (Disco_5610 = A) in
                                (
                                    {6375}if v_5909 then
                                    (
                                        {6376}let pkDisco_5910: bitstring = pub(skA) in
                                        {6377}in(c, (=pkCli_5908,em1_5911: bitstring));
                                        {6378}let m1_5912: bitstring = em1_5911 in
                                        {6379}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5913: bitstring) = m1_5912 in
                                        {6380}new Ns_5914: bitstring;
                                        {6381}new ST_5915: bitstring;
                                        {6382}new TTL_5916: bitstring;
                                        {6383}let gNs_5917: bitstring = exp(g,Ns_5914) in
                                        {6384}let m2_5918: bitstring = (OpenSecureChannelResponse,gNs_5917,ST_5915,TTL_5916) in
                                        {6385}out(c, m2_5918);
                                        {6386}let Ksrv_5919: bitstring = exp(PartC_5913,Ns_5914) in
                                        {6387}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5919))
                                    )
                                    else
                                        {6388}let v_5920: bool = (Disco_5610 = B) in
                                        (
                                            {6389}if v_5920 then
                                            (
                                                {6390}let pkDisco_5921: bitstring = pub(skB) in
                                                {6391}in(c, (=pkCli_5908,em1_5922: bitstring));
                                                {6392}let m1_5923: bitstring = em1_5922 in
                                                {6393}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5924: bitstring) = m1_5923 in
                                                {6394}new Ns_5925: bitstring;
                                                {6395}new ST_5926: bitstring;
                                                {6396}new TTL_5927: bitstring;
                                                {6397}let gNs_5928: bitstring = exp(g,Ns_5925) in
                                                {6398}let m2_5929: bitstring = (OpenSecureChannelResponse,gNs_5928,ST_5926,TTL_5927) in
                                                {6399}out(c, m2_5929);
                                                {6400}let Ksrv_5930: bitstring = exp(PartC_5924,Ns_5925) in
                                                {6401}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5930))
                                            )
                                            else
                                                {6402}let v_5931: bool = (Disco_5610 = C) in
                                                (
                                                    {6403}if v_5931 then
                                                    (
                                                        {6404}let pkDisco_5932: bitstring = pub(skC) in
                                                        {6405}in(c, (=pkCli_5908,em1_5933: bitstring));
                                                        {6406}let m1_5934: bitstring = em1_5933 in
                                                        {6407}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5935: bitstring) = m1_5934 in
                                                        {6408}new Ns_5936: bitstring;
                                                        {6409}new ST_5937: bitstring;
                                                        {6410}new TTL_5938: bitstring;
                                                        {6411}let gNs_5939: bitstring = exp(g,Ns_5936) in
                                                        {6412}let m2_5940: bitstring = (OpenSecureChannelResponse,gNs_5939,ST_5937,TTL_5938) in
                                                        {6413}out(c, m2_5940);
                                                        {6414}let Ksrv_5941: bitstring = exp(PartC_5935,Ns_5936) in
                                                        {6415}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5941))
                                                    )
                                                    else
                                                        {6416}let pkDisco_5942: bitstring = pub(sk(Disco_5610)) in
                                                        {6417}in(c, (=pkCli_5908,em1_5943: bitstring));
                                                        {6418}let m1_5944: bitstring = em1_5943 in
                                                        {6419}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5945: bitstring) = m1_5944 in
                                                        {6420}new Ns_5946: bitstring;
                                                        {6421}new ST_5947: bitstring;
                                                        {6422}new TTL_5948: bitstring;
                                                        {6423}let gNs_5949: bitstring = exp(g,Ns_5946) in
                                                        {6424}let m2_5950: bitstring = (OpenSecureChannelResponse,gNs_5949,ST_5947,TTL_5948) in
                                                        {6425}out(c, m2_5950);
                                                        {6426}let Ksrv_5951: bitstring = exp(PartC_5945,Ns_5946) in
                                                        {6427}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5951))
                                                )
                                                else
                                                    {6428}let pkDisco_5952: bitstring = fail-any in
                                                    {6429}in(c, (=pkCli_5908,em1_5953: bitstring));
                                                    {6430}let m1_5954: bitstring = em1_5953 in
                                                    {6431}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5955: bitstring) = m1_5954 in
                                                    {6432}new Ns_5956: bitstring;
                                                    {6433}new ST_5957: bitstring;
                                                    {6434}new TTL_5958: bitstring;
                                                    {6435}let gNs_5959: bitstring = exp(g,Ns_5956) in
                                                    {6436}let m2_5960: bitstring = (OpenSecureChannelResponse,gNs_5959,ST_5957,TTL_5958) in
                                                    {6437}out(c, m2_5960);
                                                    {6438}let Ksrv_5961: bitstring = exp(PartC_5955,Ns_5956) in
                                                    {6439}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5961))
                                        )
                                        else
                                            {6440}let pkDisco_5962: bitstring = fail-any in
                                            {6441}in(c, (=pkCli_5908,em1_5963: bitstring));
                                            {6442}let m1_5964: bitstring = em1_5963 in
                                            {6443}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5965: bitstring) = m1_5964 in
                                            {6444}new Ns_5966: bitstring;
                                            {6445}new ST_5967: bitstring;
                                            {6446}new TTL_5968: bitstring;
                                            {6447}let gNs_5969: bitstring = exp(g,Ns_5966) in
                                            {6448}let m2_5970: bitstring = (OpenSecureChannelResponse,gNs_5969,ST_5967,TTL_5968) in
                                            {6449}out(c, m2_5970);
                                            {6450}let Ksrv_5971: bitstring = exp(PartC_5965,Ns_5966) in
                                            {6451}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5971))
                                )
                                else
                                    {6452}let pkDisco_5972: bitstring = fail-any in
                                    {6453}in(c, (=pkCli_5908,em1_5973: bitstring));
                                    {6454}let m1_5974: bitstring = em1_5973 in
                                    {6455}let (=OpenSecureChannelRequest,=pkCli_5908,PartC_5975: bitstring) = m1_5974 in
                                    {6456}new Ns_5976: bitstring;
                                    {6457}new ST_5977: bitstring;
                                    {6458}new TTL_5978: bitstring;
                                    {6459}let gNs_5979: bitstring = exp(g,Ns_5976) in
                                    {6460}let m2_5980: bitstring = (OpenSecureChannelResponse,gNs_5979,ST_5977,TTL_5978) in
                                    {6461}out(c, m2_5980);
                                    {6462}let Ksrv_5981: bitstring = exp(PartC_5975,Ns_5976) in
                                    {6463}out(c, senc(mSrv(pkCli_5908,pkSess_5613),Ksrv_5981))
                    )
                    else
                        {6464}let pkCli_5982: bitstring = fail-any in
                        {6465}let v_5983: bool = (Disco_5610 = A) in
                        (
                            {6466}if v_5983 then
                            (
                                {6467}let pkDisco_5984: bitstring = pub(skA) in
                                {6468}in(c, (=pkCli_5982,em1_5985: bitstring));
                                {6469}let m1_5986: bitstring = em1_5985 in
                                {6470}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_5987: bitstring) = m1_5986 in
                                {6471}new Ns_5988: bitstring;
                                {6472}new ST_5989: bitstring;
                                {6473}new TTL_5990: bitstring;
                                {6474}let gNs_5991: bitstring = exp(g,Ns_5988) in
                                {6475}let m2_5992: bitstring = (OpenSecureChannelResponse,gNs_5991,ST_5989,TTL_5990) in
                                {6476}out(c, m2_5992);
                                {6477}let Ksrv_5993: bitstring = exp(PartC_5987,Ns_5988) in
                                {6478}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_5993))
                            )
                            else
                                {6479}let v_5994: bool = (Disco_5610 = B) in
                                (
                                    {6480}if v_5994 then
                                    (
                                        {6481}let pkDisco_5995: bitstring = pub(skB) in
                                        {6482}in(c, (=pkCli_5982,em1_5996: bitstring));
                                        {6483}let m1_5997: bitstring = em1_5996 in
                                        {6484}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_5998: bitstring) = m1_5997 in
                                        {6485}new Ns_5999: bitstring;
                                        {6486}new ST_6000: bitstring;
                                        {6487}new TTL_6001: bitstring;
                                        {6488}let gNs_6002: bitstring = exp(g,Ns_5999) in
                                        {6489}let m2_6003: bitstring = (OpenSecureChannelResponse,gNs_6002,ST_6000,TTL_6001) in
                                        {6490}out(c, m2_6003);
                                        {6491}let Ksrv_6004: bitstring = exp(PartC_5998,Ns_5999) in
                                        {6492}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_6004))
                                    )
                                    else
                                        {6493}let v_6005: bool = (Disco_5610 = C) in
                                        (
                                            {6494}if v_6005 then
                                            (
                                                {6495}let pkDisco_6006: bitstring = pub(skC) in
                                                {6496}in(c, (=pkCli_5982,em1_6007: bitstring));
                                                {6497}let m1_6008: bitstring = em1_6007 in
                                                {6498}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_6009: bitstring) = m1_6008 in
                                                {6499}new Ns_6010: bitstring;
                                                {6500}new ST_6011: bitstring;
                                                {6501}new TTL_6012: bitstring;
                                                {6502}let gNs_6013: bitstring = exp(g,Ns_6010) in
                                                {6503}let m2_6014: bitstring = (OpenSecureChannelResponse,gNs_6013,ST_6011,TTL_6012) in
                                                {6504}out(c, m2_6014);
                                                {6505}let Ksrv_6015: bitstring = exp(PartC_6009,Ns_6010) in
                                                {6506}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_6015))
                                            )
                                            else
                                                {6507}let pkDisco_6016: bitstring = pub(sk(Disco_5610)) in
                                                {6508}in(c, (=pkCli_5982,em1_6017: bitstring));
                                                {6509}let m1_6018: bitstring = em1_6017 in
                                                {6510}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_6019: bitstring) = m1_6018 in
                                                {6511}new Ns_6020: bitstring;
                                                {6512}new ST_6021: bitstring;
                                                {6513}new TTL_6022: bitstring;
                                                {6514}let gNs_6023: bitstring = exp(g,Ns_6020) in
                                                {6515}let m2_6024: bitstring = (OpenSecureChannelResponse,gNs_6023,ST_6021,TTL_6022) in
                                                {6516}out(c, m2_6024);
                                                {6517}let Ksrv_6025: bitstring = exp(PartC_6019,Ns_6020) in
                                                {6518}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_6025))
                                        )
                                        else
                                            {6519}let pkDisco_6026: bitstring = fail-any in
                                            {6520}in(c, (=pkCli_5982,em1_6027: bitstring));
                                            {6521}let m1_6028: bitstring = em1_6027 in
                                            {6522}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_6029: bitstring) = m1_6028 in
                                            {6523}new Ns_6030: bitstring;
                                            {6524}new ST_6031: bitstring;
                                            {6525}new TTL_6032: bitstring;
                                            {6526}let gNs_6033: bitstring = exp(g,Ns_6030) in
                                            {6527}let m2_6034: bitstring = (OpenSecureChannelResponse,gNs_6033,ST_6031,TTL_6032) in
                                            {6528}out(c, m2_6034);
                                            {6529}let Ksrv_6035: bitstring = exp(PartC_6029,Ns_6030) in
                                            {6530}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_6035))
                                )
                                else
                                    {6531}let pkDisco_6036: bitstring = fail-any in
                                    {6532}in(c, (=pkCli_5982,em1_6037: bitstring));
                                    {6533}let m1_6038: bitstring = em1_6037 in
                                    {6534}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_6039: bitstring) = m1_6038 in
                                    {6535}new Ns_6040: bitstring;
                                    {6536}new ST_6041: bitstring;
                                    {6537}new TTL_6042: bitstring;
                                    {6538}let gNs_6043: bitstring = exp(g,Ns_6040) in
                                    {6539}let m2_6044: bitstring = (OpenSecureChannelResponse,gNs_6043,ST_6041,TTL_6042) in
                                    {6540}out(c, m2_6044);
                                    {6541}let Ksrv_6045: bitstring = exp(PartC_6039,Ns_6040) in
                                    {6542}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_6045))
                        )
                        else
                            {6543}let pkDisco_6046: bitstring = fail-any in
                            {6544}in(c, (=pkCli_5982,em1_6047: bitstring));
                            {6545}let m1_6048: bitstring = em1_6047 in
                            {6546}let (=OpenSecureChannelRequest,=pkCli_5982,PartC_6049: bitstring) = m1_6048 in
                            {6547}new Ns_6050: bitstring;
                            {6548}new ST_6051: bitstring;
                            {6549}new TTL_6052: bitstring;
                            {6550}let gNs_6053: bitstring = exp(g,Ns_6050) in
                            {6551}let m2_6054: bitstring = (OpenSecureChannelResponse,gNs_6053,ST_6051,TTL_6052) in
                            {6552}out(c, m2_6054);
                            {6553}let Ksrv_6055: bitstring = exp(PartC_6049,Ns_6050) in
                            {6554}out(c, senc(mSrv(pkCli_5982,pkSess_5613),Ksrv_6055))
            )
            else
                {6555}let pkCli_6056: bitstring = fail-any in
                {6556}let v_6057: bool = (Disco_5610 = A) in
                (
                    {6557}if v_6057 then
                    (
                        {6558}let pkDisco_6058: bitstring = pub(skA) in
                        {6559}in(c, (=pkCli_6056,em1_6059: bitstring));
                        {6560}let m1_6060: bitstring = em1_6059 in
                        {6561}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6061: bitstring) = m1_6060 in
                        {6562}new Ns_6062: bitstring;
                        {6563}new ST_6063: bitstring;
                        {6564}new TTL_6064: bitstring;
                        {6565}let gNs_6065: bitstring = exp(g,Ns_6062) in
                        {6566}let m2_6066: bitstring = (OpenSecureChannelResponse,gNs_6065,ST_6063,TTL_6064) in
                        {6567}out(c, m2_6066);
                        {6568}let Ksrv_6067: bitstring = exp(PartC_6061,Ns_6062) in
                        {6569}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6067))
                    )
                    else
                        {6570}let v_6068: bool = (Disco_5610 = B) in
                        (
                            {6571}if v_6068 then
                            (
                                {6572}let pkDisco_6069: bitstring = pub(skB) in
                                {6573}in(c, (=pkCli_6056,em1_6070: bitstring));
                                {6574}let m1_6071: bitstring = em1_6070 in
                                {6575}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6072: bitstring) = m1_6071 in
                                {6576}new Ns_6073: bitstring;
                                {6577}new ST_6074: bitstring;
                                {6578}new TTL_6075: bitstring;
                                {6579}let gNs_6076: bitstring = exp(g,Ns_6073) in
                                {6580}let m2_6077: bitstring = (OpenSecureChannelResponse,gNs_6076,ST_6074,TTL_6075) in
                                {6581}out(c, m2_6077);
                                {6582}let Ksrv_6078: bitstring = exp(PartC_6072,Ns_6073) in
                                {6583}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6078))
                            )
                            else
                                {6584}let v_6079: bool = (Disco_5610 = C) in
                                (
                                    {6585}if v_6079 then
                                    (
                                        {6586}let pkDisco_6080: bitstring = pub(skC) in
                                        {6587}in(c, (=pkCli_6056,em1_6081: bitstring));
                                        {6588}let m1_6082: bitstring = em1_6081 in
                                        {6589}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6083: bitstring) = m1_6082 in
                                        {6590}new Ns_6084: bitstring;
                                        {6591}new ST_6085: bitstring;
                                        {6592}new TTL_6086: bitstring;
                                        {6593}let gNs_6087: bitstring = exp(g,Ns_6084) in
                                        {6594}let m2_6088: bitstring = (OpenSecureChannelResponse,gNs_6087,ST_6085,TTL_6086) in
                                        {6595}out(c, m2_6088);
                                        {6596}let Ksrv_6089: bitstring = exp(PartC_6083,Ns_6084) in
                                        {6597}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6089))
                                    )
                                    else
                                        {6598}let pkDisco_6090: bitstring = pub(sk(Disco_5610)) in
                                        {6599}in(c, (=pkCli_6056,em1_6091: bitstring));
                                        {6600}let m1_6092: bitstring = em1_6091 in
                                        {6601}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6093: bitstring) = m1_6092 in
                                        {6602}new Ns_6094: bitstring;
                                        {6603}new ST_6095: bitstring;
                                        {6604}new TTL_6096: bitstring;
                                        {6605}let gNs_6097: bitstring = exp(g,Ns_6094) in
                                        {6606}let m2_6098: bitstring = (OpenSecureChannelResponse,gNs_6097,ST_6095,TTL_6096) in
                                        {6607}out(c, m2_6098);
                                        {6608}let Ksrv_6099: bitstring = exp(PartC_6093,Ns_6094) in
                                        {6609}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6099))
                                )
                                else
                                    {6610}let pkDisco_6100: bitstring = fail-any in
                                    {6611}in(c, (=pkCli_6056,em1_6101: bitstring));
                                    {6612}let m1_6102: bitstring = em1_6101 in
                                    {6613}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6103: bitstring) = m1_6102 in
                                    {6614}new Ns_6104: bitstring;
                                    {6615}new ST_6105: bitstring;
                                    {6616}new TTL_6106: bitstring;
                                    {6617}let gNs_6107: bitstring = exp(g,Ns_6104) in
                                    {6618}let m2_6108: bitstring = (OpenSecureChannelResponse,gNs_6107,ST_6105,TTL_6106) in
                                    {6619}out(c, m2_6108);
                                    {6620}let Ksrv_6109: bitstring = exp(PartC_6103,Ns_6104) in
                                    {6621}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6109))
                        )
                        else
                            {6622}let pkDisco_6110: bitstring = fail-any in
                            {6623}in(c, (=pkCli_6056,em1_6111: bitstring));
                            {6624}let m1_6112: bitstring = em1_6111 in
                            {6625}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6113: bitstring) = m1_6112 in
                            {6626}new Ns_6114: bitstring;
                            {6627}new ST_6115: bitstring;
                            {6628}new TTL_6116: bitstring;
                            {6629}let gNs_6117: bitstring = exp(g,Ns_6114) in
                            {6630}let m2_6118: bitstring = (OpenSecureChannelResponse,gNs_6117,ST_6115,TTL_6116) in
                            {6631}out(c, m2_6118);
                            {6632}let Ksrv_6119: bitstring = exp(PartC_6113,Ns_6114) in
                            {6633}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6119))
                )
                else
                    {6634}let pkDisco_6120: bitstring = fail-any in
                    {6635}in(c, (=pkCli_6056,em1_6121: bitstring));
                    {6636}let m1_6122: bitstring = em1_6121 in
                    {6637}let (=OpenSecureChannelRequest,=pkCli_6056,PartC_6123: bitstring) = m1_6122 in
                    {6638}new Ns_6124: bitstring;
                    {6639}new ST_6125: bitstring;
                    {6640}new TTL_6126: bitstring;
                    {6641}let gNs_6127: bitstring = exp(g,Ns_6124) in
                    {6642}let m2_6128: bitstring = (OpenSecureChannelResponse,gNs_6127,ST_6125,TTL_6126) in
                    {6643}out(c, m2_6128);
                    {6644}let Ksrv_6129: bitstring = exp(PartC_6123,Ns_6124) in
                    {6645}out(c, senc(mSrv(pkCli_6056,pkSess_5613),Ksrv_6129))
        )
        else
            {6646}let v_6130: bool = (Sess_5611 = B) in
            (
                {6647}if v_6130 then
                (
                    {6648}let skSess_6131: bitstring = skB in
                    {6649}let pkSess_6132: bitstring = pub(skSess_6131) in
                    {6650}let v_6133: bool = (Cli_5609 = A) in
                    (
                        {6651}if v_6133 then
                        (
                            {6652}let pkCli_6134: bitstring = pub(skA) in
                            {6653}let v_6135: bool = (Disco_5610 = A) in
                            (
                                {6654}if v_6135 then
                                (
                                    {6655}let pkDisco_6136: bitstring = pub(skA) in
                                    {6656}in(c, (=pkCli_6134,em1_6137: bitstring));
                                    {6657}let m1_6138: bitstring = em1_6137 in
                                    {6658}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6139: bitstring) = m1_6138 in
                                    {6659}new Ns_6140: bitstring;
                                    {6660}new ST_6141: bitstring;
                                    {6661}new TTL_6142: bitstring;
                                    {6662}let gNs_6143: bitstring = exp(g,Ns_6140) in
                                    {6663}let m2_6144: bitstring = (OpenSecureChannelResponse,gNs_6143,ST_6141,TTL_6142) in
                                    {6664}out(c, m2_6144);
                                    {6665}let Ksrv_6145: bitstring = exp(PartC_6139,Ns_6140) in
                                    {6666}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6145))
                                )
                                else
                                    {6667}let v_6146: bool = (Disco_5610 = B) in
                                    (
                                        {6668}if v_6146 then
                                        (
                                            {6669}let pkDisco_6147: bitstring = pub(skB) in
                                            {6670}in(c, (=pkCli_6134,em1_6148: bitstring));
                                            {6671}let m1_6149: bitstring = em1_6148 in
                                            {6672}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6150: bitstring) = m1_6149 in
                                            {6673}new Ns_6151: bitstring;
                                            {6674}new ST_6152: bitstring;
                                            {6675}new TTL_6153: bitstring;
                                            {6676}let gNs_6154: bitstring = exp(g,Ns_6151) in
                                            {6677}let m2_6155: bitstring = (OpenSecureChannelResponse,gNs_6154,ST_6152,TTL_6153) in
                                            {6678}out(c, m2_6155);
                                            {6679}let Ksrv_6156: bitstring = exp(PartC_6150,Ns_6151) in
                                            {6680}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6156))
                                        )
                                        else
                                            {6681}let v_6157: bool = (Disco_5610 = C) in
                                            (
                                                {6682}if v_6157 then
                                                (
                                                    {6683}let pkDisco_6158: bitstring = pub(skC) in
                                                    {6684}in(c, (=pkCli_6134,em1_6159: bitstring));
                                                    {6685}let m1_6160: bitstring = em1_6159 in
                                                    {6686}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6161: bitstring) = m1_6160 in
                                                    {6687}new Ns_6162: bitstring;
                                                    {6688}new ST_6163: bitstring;
                                                    {6689}new TTL_6164: bitstring;
                                                    {6690}let gNs_6165: bitstring = exp(g,Ns_6162) in
                                                    {6691}let m2_6166: bitstring = (OpenSecureChannelResponse,gNs_6165,ST_6163,TTL_6164) in
                                                    {6692}out(c, m2_6166);
                                                    {6693}let Ksrv_6167: bitstring = exp(PartC_6161,Ns_6162) in
                                                    {6694}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6167))
                                                )
                                                else
                                                    {6695}let pkDisco_6168: bitstring = pub(sk(Disco_5610)) in
                                                    {6696}in(c, (=pkCli_6134,em1_6169: bitstring));
                                                    {6697}let m1_6170: bitstring = em1_6169 in
                                                    {6698}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6171: bitstring) = m1_6170 in
                                                    {6699}new Ns_6172: bitstring;
                                                    {6700}new ST_6173: bitstring;
                                                    {6701}new TTL_6174: bitstring;
                                                    {6702}let gNs_6175: bitstring = exp(g,Ns_6172) in
                                                    {6703}let m2_6176: bitstring = (OpenSecureChannelResponse,gNs_6175,ST_6173,TTL_6174) in
                                                    {6704}out(c, m2_6176);
                                                    {6705}let Ksrv_6177: bitstring = exp(PartC_6171,Ns_6172) in
                                                    {6706}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6177))
                                            )
                                            else
                                                {6707}let pkDisco_6178: bitstring = fail-any in
                                                {6708}in(c, (=pkCli_6134,em1_6179: bitstring));
                                                {6709}let m1_6180: bitstring = em1_6179 in
                                                {6710}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6181: bitstring) = m1_6180 in
                                                {6711}new Ns_6182: bitstring;
                                                {6712}new ST_6183: bitstring;
                                                {6713}new TTL_6184: bitstring;
                                                {6714}let gNs_6185: bitstring = exp(g,Ns_6182) in
                                                {6715}let m2_6186: bitstring = (OpenSecureChannelResponse,gNs_6185,ST_6183,TTL_6184) in
                                                {6716}out(c, m2_6186);
                                                {6717}let Ksrv_6187: bitstring = exp(PartC_6181,Ns_6182) in
                                                {6718}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6187))
                                    )
                                    else
                                        {6719}let pkDisco_6188: bitstring = fail-any in
                                        {6720}in(c, (=pkCli_6134,em1_6189: bitstring));
                                        {6721}let m1_6190: bitstring = em1_6189 in
                                        {6722}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6191: bitstring) = m1_6190 in
                                        {6723}new Ns_6192: bitstring;
                                        {6724}new ST_6193: bitstring;
                                        {6725}new TTL_6194: bitstring;
                                        {6726}let gNs_6195: bitstring = exp(g,Ns_6192) in
                                        {6727}let m2_6196: bitstring = (OpenSecureChannelResponse,gNs_6195,ST_6193,TTL_6194) in
                                        {6728}out(c, m2_6196);
                                        {6729}let Ksrv_6197: bitstring = exp(PartC_6191,Ns_6192) in
                                        {6730}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6197))
                            )
                            else
                                {6731}let pkDisco_6198: bitstring = fail-any in
                                {6732}in(c, (=pkCli_6134,em1_6199: bitstring));
                                {6733}let m1_6200: bitstring = em1_6199 in
                                {6734}let (=OpenSecureChannelRequest,=pkCli_6134,PartC_6201: bitstring) = m1_6200 in
                                {6735}new Ns_6202: bitstring;
                                {6736}new ST_6203: bitstring;
                                {6737}new TTL_6204: bitstring;
                                {6738}let gNs_6205: bitstring = exp(g,Ns_6202) in
                                {6739}let m2_6206: bitstring = (OpenSecureChannelResponse,gNs_6205,ST_6203,TTL_6204) in
                                {6740}out(c, m2_6206);
                                {6741}let Ksrv_6207: bitstring = exp(PartC_6201,Ns_6202) in
                                {6742}out(c, senc(mSrv(pkCli_6134,pkSess_6132),Ksrv_6207))
                        )
                        else
                            {6743}let v_6208: bool = (Cli_5609 = B) in
                            (
                                {6744}if v_6208 then
                                (
                                    {6745}let pkCli_6209: bitstring = pub(skB) in
                                    {6746}let v_6210: bool = (Disco_5610 = A) in
                                    (
                                        {6747}if v_6210 then
                                        (
                                            {6748}let pkDisco_6211: bitstring = pub(skA) in
                                            {6749}in(c, (=pkCli_6209,em1_6212: bitstring));
                                            {6750}let m1_6213: bitstring = em1_6212 in
                                            {6751}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6214: bitstring) = m1_6213 in
                                            {6752}new Ns_6215: bitstring;
                                            {6753}new ST_6216: bitstring;
                                            {6754}new TTL_6217: bitstring;
                                            {6755}let gNs_6218: bitstring = exp(g,Ns_6215) in
                                            {6756}let m2_6219: bitstring = (OpenSecureChannelResponse,gNs_6218,ST_6216,TTL_6217) in
                                            {6757}out(c, m2_6219);
                                            {6758}let Ksrv_6220: bitstring = exp(PartC_6214,Ns_6215) in
                                            {6759}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6220))
                                        )
                                        else
                                            {6760}let v_6221: bool = (Disco_5610 = B) in
                                            (
                                                {6761}if v_6221 then
                                                (
                                                    {6762}let pkDisco_6222: bitstring = pub(skB) in
                                                    {6763}in(c, (=pkCli_6209,em1_6223: bitstring));
                                                    {6764}let m1_6224: bitstring = em1_6223 in
                                                    {6765}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6225: bitstring) = m1_6224 in
                                                    {6766}new Ns_6226: bitstring;
                                                    {6767}new ST_6227: bitstring;
                                                    {6768}new TTL_6228: bitstring;
                                                    {6769}let gNs_6229: bitstring = exp(g,Ns_6226) in
                                                    {6770}let m2_6230: bitstring = (OpenSecureChannelResponse,gNs_6229,ST_6227,TTL_6228) in
                                                    {6771}out(c, m2_6230);
                                                    {6772}let Ksrv_6231: bitstring = exp(PartC_6225,Ns_6226) in
                                                    {6773}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6231))
                                                )
                                                else
                                                    {6774}let v_6232: bool = (Disco_5610 = C) in
                                                    (
                                                        {6775}if v_6232 then
                                                        (
                                                            {6776}let pkDisco_6233: bitstring = pub(skC) in
                                                            {6777}in(c, (=pkCli_6209,em1_6234: bitstring));
                                                            {6778}let m1_6235: bitstring = em1_6234 in
                                                            {6779}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6236: bitstring) = m1_6235 in
                                                            {6780}new Ns_6237: bitstring;
                                                            {6781}new ST_6238: bitstring;
                                                            {6782}new TTL_6239: bitstring;
                                                            {6783}let gNs_6240: bitstring = exp(g,Ns_6237) in
                                                            {6784}let m2_6241: bitstring = (OpenSecureChannelResponse,gNs_6240,ST_6238,TTL_6239) in
                                                            {6785}out(c, m2_6241);
                                                            {6786}let Ksrv_6242: bitstring = exp(PartC_6236,Ns_6237) in
                                                            {6787}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6242))
                                                        )
                                                        else
                                                            {6788}let pkDisco_6243: bitstring = pub(sk(Disco_5610)) in
                                                            {6789}in(c, (=pkCli_6209,em1_6244: bitstring));
                                                            {6790}let m1_6245: bitstring = em1_6244 in
                                                            {6791}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6246: bitstring) = m1_6245 in
                                                            {6792}new Ns_6247: bitstring;
                                                            {6793}new ST_6248: bitstring;
                                                            {6794}new TTL_6249: bitstring;
                                                            {6795}let gNs_6250: bitstring = exp(g,Ns_6247) in
                                                            {6796}let m2_6251: bitstring = (OpenSecureChannelResponse,gNs_6250,ST_6248,TTL_6249) in
                                                            {6797}out(c, m2_6251);
                                                            {6798}let Ksrv_6252: bitstring = exp(PartC_6246,Ns_6247) in
                                                            {6799}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6252))
                                                    )
                                                    else
                                                        {6800}let pkDisco_6253: bitstring = fail-any in
                                                        {6801}in(c, (=pkCli_6209,em1_6254: bitstring));
                                                        {6802}let m1_6255: bitstring = em1_6254 in
                                                        {6803}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6256: bitstring) = m1_6255 in
                                                        {6804}new Ns_6257: bitstring;
                                                        {6805}new ST_6258: bitstring;
                                                        {6806}new TTL_6259: bitstring;
                                                        {6807}let gNs_6260: bitstring = exp(g,Ns_6257) in
                                                        {6808}let m2_6261: bitstring = (OpenSecureChannelResponse,gNs_6260,ST_6258,TTL_6259) in
                                                        {6809}out(c, m2_6261);
                                                        {6810}let Ksrv_6262: bitstring = exp(PartC_6256,Ns_6257) in
                                                        {6811}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6262))
                                            )
                                            else
                                                {6812}let pkDisco_6263: bitstring = fail-any in
                                                {6813}in(c, (=pkCli_6209,em1_6264: bitstring));
                                                {6814}let m1_6265: bitstring = em1_6264 in
                                                {6815}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6266: bitstring) = m1_6265 in
                                                {6816}new Ns_6267: bitstring;
                                                {6817}new ST_6268: bitstring;
                                                {6818}new TTL_6269: bitstring;
                                                {6819}let gNs_6270: bitstring = exp(g,Ns_6267) in
                                                {6820}let m2_6271: bitstring = (OpenSecureChannelResponse,gNs_6270,ST_6268,TTL_6269) in
                                                {6821}out(c, m2_6271);
                                                {6822}let Ksrv_6272: bitstring = exp(PartC_6266,Ns_6267) in
                                                {6823}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6272))
                                    )
                                    else
                                        {6824}let pkDisco_6273: bitstring = fail-any in
                                        {6825}in(c, (=pkCli_6209,em1_6274: bitstring));
                                        {6826}let m1_6275: bitstring = em1_6274 in
                                        {6827}let (=OpenSecureChannelRequest,=pkCli_6209,PartC_6276: bitstring) = m1_6275 in
                                        {6828}new Ns_6277: bitstring;
                                        {6829}new ST_6278: bitstring;
                                        {6830}new TTL_6279: bitstring;
                                        {6831}let gNs_6280: bitstring = exp(g,Ns_6277) in
                                        {6832}let m2_6281: bitstring = (OpenSecureChannelResponse,gNs_6280,ST_6278,TTL_6279) in
                                        {6833}out(c, m2_6281);
                                        {6834}let Ksrv_6282: bitstring = exp(PartC_6276,Ns_6277) in
                                        {6835}out(c, senc(mSrv(pkCli_6209,pkSess_6132),Ksrv_6282))
                                )
                                else
                                    {6836}let v_6283: bool = (Cli_5609 = C) in
                                    (
                                        {6837}if v_6283 then
                                        (
                                            {6838}let pkCli_6284: bitstring = pub(skC) in
                                            {6839}let v_6285: bool = (Disco_5610 = A) in
                                            (
                                                {6840}if v_6285 then
                                                (
                                                    {6841}let pkDisco_6286: bitstring = pub(skA) in
                                                    {6842}in(c, (=pkCli_6284,em1_6287: bitstring));
                                                    {6843}let m1_6288: bitstring = em1_6287 in
                                                    {6844}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6289: bitstring) = m1_6288 in
                                                    {6845}new Ns_6290: bitstring;
                                                    {6846}new ST_6291: bitstring;
                                                    {6847}new TTL_6292: bitstring;
                                                    {6848}let gNs_6293: bitstring = exp(g,Ns_6290) in
                                                    {6849}let m2_6294: bitstring = (OpenSecureChannelResponse,gNs_6293,ST_6291,TTL_6292) in
                                                    {6850}out(c, m2_6294);
                                                    {6851}let Ksrv_6295: bitstring = exp(PartC_6289,Ns_6290) in
                                                    {6852}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6295))
                                                )
                                                else
                                                    {6853}let v_6296: bool = (Disco_5610 = B) in
                                                    (
                                                        {6854}if v_6296 then
                                                        (
                                                            {6855}let pkDisco_6297: bitstring = pub(skB) in
                                                            {6856}in(c, (=pkCli_6284,em1_6298: bitstring));
                                                            {6857}let m1_6299: bitstring = em1_6298 in
                                                            {6858}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6300: bitstring) = m1_6299 in
                                                            {6859}new Ns_6301: bitstring;
                                                            {6860}new ST_6302: bitstring;
                                                            {6861}new TTL_6303: bitstring;
                                                            {6862}let gNs_6304: bitstring = exp(g,Ns_6301) in
                                                            {6863}let m2_6305: bitstring = (OpenSecureChannelResponse,gNs_6304,ST_6302,TTL_6303) in
                                                            {6864}out(c, m2_6305);
                                                            {6865}let Ksrv_6306: bitstring = exp(PartC_6300,Ns_6301) in
                                                            {6866}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6306))
                                                        )
                                                        else
                                                            {6867}let v_6307: bool = (Disco_5610 = C) in
                                                            (
                                                                {6868}if v_6307 then
                                                                (
                                                                    {6869}let pkDisco_6308: bitstring = pub(skC) in
                                                                    {6870}in(c, (=pkCli_6284,em1_6309: bitstring));
                                                                    {6871}let m1_6310: bitstring = em1_6309 in
                                                                    {6872}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6311: bitstring) = m1_6310 in
                                                                    {6873}new Ns_6312: bitstring;
                                                                    {6874}new ST_6313: bitstring;
                                                                    {6875}new TTL_6314: bitstring;
                                                                    {6876}let gNs_6315: bitstring = exp(g,Ns_6312) in
                                                                    {6877}let m2_6316: bitstring = (OpenSecureChannelResponse,gNs_6315,ST_6313,TTL_6314) in
                                                                    {6878}out(c, m2_6316);
                                                                    {6879}let Ksrv_6317: bitstring = exp(PartC_6311,Ns_6312) in
                                                                    {6880}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6317))
                                                                )
                                                                else
                                                                    {6881}let pkDisco_6318: bitstring = pub(sk(Disco_5610)) in
                                                                    {6882}in(c, (=pkCli_6284,em1_6319: bitstring));
                                                                    {6883}let m1_6320: bitstring = em1_6319 in
                                                                    {6884}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6321: bitstring) = m1_6320 in
                                                                    {6885}new Ns_6322: bitstring;
                                                                    {6886}new ST_6323: bitstring;
                                                                    {6887}new TTL_6324: bitstring;
                                                                    {6888}let gNs_6325: bitstring = exp(g,Ns_6322) in
                                                                    {6889}let m2_6326: bitstring = (OpenSecureChannelResponse,gNs_6325,ST_6323,TTL_6324) in
                                                                    {6890}out(c, m2_6326);
                                                                    {6891}let Ksrv_6327: bitstring = exp(PartC_6321,Ns_6322) in
                                                                    {6892}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6327))
                                                            )
                                                            else
                                                                {6893}let pkDisco_6328: bitstring = fail-any in
                                                                {6894}in(c, (=pkCli_6284,em1_6329: bitstring));
                                                                {6895}let m1_6330: bitstring = em1_6329 in
                                                                {6896}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6331: bitstring) = m1_6330 in
                                                                {6897}new Ns_6332: bitstring;
                                                                {6898}new ST_6333: bitstring;
                                                                {6899}new TTL_6334: bitstring;
                                                                {6900}let gNs_6335: bitstring = exp(g,Ns_6332) in
                                                                {6901}let m2_6336: bitstring = (OpenSecureChannelResponse,gNs_6335,ST_6333,TTL_6334) in
                                                                {6902}out(c, m2_6336);
                                                                {6903}let Ksrv_6337: bitstring = exp(PartC_6331,Ns_6332) in
                                                                {6904}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6337))
                                                    )
                                                    else
                                                        {6905}let pkDisco_6338: bitstring = fail-any in
                                                        {6906}in(c, (=pkCli_6284,em1_6339: bitstring));
                                                        {6907}let m1_6340: bitstring = em1_6339 in
                                                        {6908}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6341: bitstring) = m1_6340 in
                                                        {6909}new Ns_6342: bitstring;
                                                        {6910}new ST_6343: bitstring;
                                                        {6911}new TTL_6344: bitstring;
                                                        {6912}let gNs_6345: bitstring = exp(g,Ns_6342) in
                                                        {6913}let m2_6346: bitstring = (OpenSecureChannelResponse,gNs_6345,ST_6343,TTL_6344) in
                                                        {6914}out(c, m2_6346);
                                                        {6915}let Ksrv_6347: bitstring = exp(PartC_6341,Ns_6342) in
                                                        {6916}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6347))
                                            )
                                            else
                                                {6917}let pkDisco_6348: bitstring = fail-any in
                                                {6918}in(c, (=pkCli_6284,em1_6349: bitstring));
                                                {6919}let m1_6350: bitstring = em1_6349 in
                                                {6920}let (=OpenSecureChannelRequest,=pkCli_6284,PartC_6351: bitstring) = m1_6350 in
                                                {6921}new Ns_6352: bitstring;
                                                {6922}new ST_6353: bitstring;
                                                {6923}new TTL_6354: bitstring;
                                                {6924}let gNs_6355: bitstring = exp(g,Ns_6352) in
                                                {6925}let m2_6356: bitstring = (OpenSecureChannelResponse,gNs_6355,ST_6353,TTL_6354) in
                                                {6926}out(c, m2_6356);
                                                {6927}let Ksrv_6357: bitstring = exp(PartC_6351,Ns_6352) in
                                                {6928}out(c, senc(mSrv(pkCli_6284,pkSess_6132),Ksrv_6357))
                                        )
                                        else
                                            {6929}let pkCli_6358: bitstring = pub(sk(Cli_5609)) in
                                            {6930}let v_6359: bool = (Disco_5610 = A) in
                                            (
                                                {6931}if v_6359 then
                                                (
                                                    {6932}let pkDisco_6360: bitstring = pub(skA) in
                                                    {6933}in(c, (=pkCli_6358,em1_6361: bitstring));
                                                    {6934}let m1_6362: bitstring = em1_6361 in
                                                    {6935}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6363: bitstring) = m1_6362 in
                                                    {6936}new Ns_6364: bitstring;
                                                    {6937}new ST_6365: bitstring;
                                                    {6938}new TTL_6366: bitstring;
                                                    {6939}let gNs_6367: bitstring = exp(g,Ns_6364) in
                                                    {6940}let m2_6368: bitstring = (OpenSecureChannelResponse,gNs_6367,ST_6365,TTL_6366) in
                                                    {6941}out(c, m2_6368);
                                                    {6942}let Ksrv_6369: bitstring = exp(PartC_6363,Ns_6364) in
                                                    {6943}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6369))
                                                )
                                                else
                                                    {6944}let v_6370: bool = (Disco_5610 = B) in
                                                    (
                                                        {6945}if v_6370 then
                                                        (
                                                            {6946}let pkDisco_6371: bitstring = pub(skB) in
                                                            {6947}in(c, (=pkCli_6358,em1_6372: bitstring));
                                                            {6948}let m1_6373: bitstring = em1_6372 in
                                                            {6949}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6374: bitstring) = m1_6373 in
                                                            {6950}new Ns_6375: bitstring;
                                                            {6951}new ST_6376: bitstring;
                                                            {6952}new TTL_6377: bitstring;
                                                            {6953}let gNs_6378: bitstring = exp(g,Ns_6375) in
                                                            {6954}let m2_6379: bitstring = (OpenSecureChannelResponse,gNs_6378,ST_6376,TTL_6377) in
                                                            {6955}out(c, m2_6379);
                                                            {6956}let Ksrv_6380: bitstring = exp(PartC_6374,Ns_6375) in
                                                            {6957}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6380))
                                                        )
                                                        else
                                                            {6958}let v_6381: bool = (Disco_5610 = C) in
                                                            (
                                                                {6959}if v_6381 then
                                                                (
                                                                    {6960}let pkDisco_6382: bitstring = pub(skC) in
                                                                    {6961}in(c, (=pkCli_6358,em1_6383: bitstring));
                                                                    {6962}let m1_6384: bitstring = em1_6383 in
                                                                    {6963}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6385: bitstring) = m1_6384 in
                                                                    {6964}new Ns_6386: bitstring;
                                                                    {6965}new ST_6387: bitstring;
                                                                    {6966}new TTL_6388: bitstring;
                                                                    {6967}let gNs_6389: bitstring = exp(g,Ns_6386) in
                                                                    {6968}let m2_6390: bitstring = (OpenSecureChannelResponse,gNs_6389,ST_6387,TTL_6388) in
                                                                    {6969}out(c, m2_6390);
                                                                    {6970}let Ksrv_6391: bitstring = exp(PartC_6385,Ns_6386) in
                                                                    {6971}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6391))
                                                                )
                                                                else
                                                                    {6972}let pkDisco_6392: bitstring = pub(sk(Disco_5610)) in
                                                                    {6973}in(c, (=pkCli_6358,em1_6393: bitstring));
                                                                    {6974}let m1_6394: bitstring = em1_6393 in
                                                                    {6975}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6395: bitstring) = m1_6394 in
                                                                    {6976}new Ns_6396: bitstring;
                                                                    {6977}new ST_6397: bitstring;
                                                                    {6978}new TTL_6398: bitstring;
                                                                    {6979}let gNs_6399: bitstring = exp(g,Ns_6396) in
                                                                    {6980}let m2_6400: bitstring = (OpenSecureChannelResponse,gNs_6399,ST_6397,TTL_6398) in
                                                                    {6981}out(c, m2_6400);
                                                                    {6982}let Ksrv_6401: bitstring = exp(PartC_6395,Ns_6396) in
                                                                    {6983}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6401))
                                                            )
                                                            else
                                                                {6984}let pkDisco_6402: bitstring = fail-any in
                                                                {6985}in(c, (=pkCli_6358,em1_6403: bitstring));
                                                                {6986}let m1_6404: bitstring = em1_6403 in
                                                                {6987}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6405: bitstring) = m1_6404 in
                                                                {6988}new Ns_6406: bitstring;
                                                                {6989}new ST_6407: bitstring;
                                                                {6990}new TTL_6408: bitstring;
                                                                {6991}let gNs_6409: bitstring = exp(g,Ns_6406) in
                                                                {6992}let m2_6410: bitstring = (OpenSecureChannelResponse,gNs_6409,ST_6407,TTL_6408) in
                                                                {6993}out(c, m2_6410);
                                                                {6994}let Ksrv_6411: bitstring = exp(PartC_6405,Ns_6406) in
                                                                {6995}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6411))
                                                    )
                                                    else
                                                        {6996}let pkDisco_6412: bitstring = fail-any in
                                                        {6997}in(c, (=pkCli_6358,em1_6413: bitstring));
                                                        {6998}let m1_6414: bitstring = em1_6413 in
                                                        {6999}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6415: bitstring) = m1_6414 in
                                                        {7000}new Ns_6416: bitstring;
                                                        {7001}new ST_6417: bitstring;
                                                        {7002}new TTL_6418: bitstring;
                                                        {7003}let gNs_6419: bitstring = exp(g,Ns_6416) in
                                                        {7004}let m2_6420: bitstring = (OpenSecureChannelResponse,gNs_6419,ST_6417,TTL_6418) in
                                                        {7005}out(c, m2_6420);
                                                        {7006}let Ksrv_6421: bitstring = exp(PartC_6415,Ns_6416) in
                                                        {7007}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6421))
                                            )
                                            else
                                                {7008}let pkDisco_6422: bitstring = fail-any in
                                                {7009}in(c, (=pkCli_6358,em1_6423: bitstring));
                                                {7010}let m1_6424: bitstring = em1_6423 in
                                                {7011}let (=OpenSecureChannelRequest,=pkCli_6358,PartC_6425: bitstring) = m1_6424 in
                                                {7012}new Ns_6426: bitstring;
                                                {7013}new ST_6427: bitstring;
                                                {7014}new TTL_6428: bitstring;
                                                {7015}let gNs_6429: bitstring = exp(g,Ns_6426) in
                                                {7016}let m2_6430: bitstring = (OpenSecureChannelResponse,gNs_6429,ST_6427,TTL_6428) in
                                                {7017}out(c, m2_6430);
                                                {7018}let Ksrv_6431: bitstring = exp(PartC_6425,Ns_6426) in
                                                {7019}out(c, senc(mSrv(pkCli_6358,pkSess_6132),Ksrv_6431))
                                    )
                                    else
                                        {7020}let pkCli_6432: bitstring = fail-any in
                                        {7021}let v_6433: bool = (Disco_5610 = A) in
                                        (
                                            {7022}if v_6433 then
                                            (
                                                {7023}let pkDisco_6434: bitstring = pub(skA) in
                                                {7024}in(c, (=pkCli_6432,em1_6435: bitstring));
                                                {7025}let m1_6436: bitstring = em1_6435 in
                                                {7026}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6437: bitstring) = m1_6436 in
                                                {7027}new Ns_6438: bitstring;
                                                {7028}new ST_6439: bitstring;
                                                {7029}new TTL_6440: bitstring;
                                                {7030}let gNs_6441: bitstring = exp(g,Ns_6438) in
                                                {7031}let m2_6442: bitstring = (OpenSecureChannelResponse,gNs_6441,ST_6439,TTL_6440) in
                                                {7032}out(c, m2_6442);
                                                {7033}let Ksrv_6443: bitstring = exp(PartC_6437,Ns_6438) in
                                                {7034}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6443))
                                            )
                                            else
                                                {7035}let v_6444: bool = (Disco_5610 = B) in
                                                (
                                                    {7036}if v_6444 then
                                                    (
                                                        {7037}let pkDisco_6445: bitstring = pub(skB) in
                                                        {7038}in(c, (=pkCli_6432,em1_6446: bitstring));
                                                        {7039}let m1_6447: bitstring = em1_6446 in
                                                        {7040}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6448: bitstring) = m1_6447 in
                                                        {7041}new Ns_6449: bitstring;
                                                        {7042}new ST_6450: bitstring;
                                                        {7043}new TTL_6451: bitstring;
                                                        {7044}let gNs_6452: bitstring = exp(g,Ns_6449) in
                                                        {7045}let m2_6453: bitstring = (OpenSecureChannelResponse,gNs_6452,ST_6450,TTL_6451) in
                                                        {7046}out(c, m2_6453);
                                                        {7047}let Ksrv_6454: bitstring = exp(PartC_6448,Ns_6449) in
                                                        {7048}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6454))
                                                    )
                                                    else
                                                        {7049}let v_6455: bool = (Disco_5610 = C) in
                                                        (
                                                            {7050}if v_6455 then
                                                            (
                                                                {7051}let pkDisco_6456: bitstring = pub(skC) in
                                                                {7052}in(c, (=pkCli_6432,em1_6457: bitstring));
                                                                {7053}let m1_6458: bitstring = em1_6457 in
                                                                {7054}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6459: bitstring) = m1_6458 in
                                                                {7055}new Ns_6460: bitstring;
                                                                {7056}new ST_6461: bitstring;
                                                                {7057}new TTL_6462: bitstring;
                                                                {7058}let gNs_6463: bitstring = exp(g,Ns_6460) in
                                                                {7059}let m2_6464: bitstring = (OpenSecureChannelResponse,gNs_6463,ST_6461,TTL_6462) in
                                                                {7060}out(c, m2_6464);
                                                                {7061}let Ksrv_6465: bitstring = exp(PartC_6459,Ns_6460) in
                                                                {7062}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6465))
                                                            )
                                                            else
                                                                {7063}let pkDisco_6466: bitstring = pub(sk(Disco_5610)) in
                                                                {7064}in(c, (=pkCli_6432,em1_6467: bitstring));
                                                                {7065}let m1_6468: bitstring = em1_6467 in
                                                                {7066}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6469: bitstring) = m1_6468 in
                                                                {7067}new Ns_6470: bitstring;
                                                                {7068}new ST_6471: bitstring;
                                                                {7069}new TTL_6472: bitstring;
                                                                {7070}let gNs_6473: bitstring = exp(g,Ns_6470) in
                                                                {7071}let m2_6474: bitstring = (OpenSecureChannelResponse,gNs_6473,ST_6471,TTL_6472) in
                                                                {7072}out(c, m2_6474);
                                                                {7073}let Ksrv_6475: bitstring = exp(PartC_6469,Ns_6470) in
                                                                {7074}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6475))
                                                        )
                                                        else
                                                            {7075}let pkDisco_6476: bitstring = fail-any in
                                                            {7076}in(c, (=pkCli_6432,em1_6477: bitstring));
                                                            {7077}let m1_6478: bitstring = em1_6477 in
                                                            {7078}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6479: bitstring) = m1_6478 in
                                                            {7079}new Ns_6480: bitstring;
                                                            {7080}new ST_6481: bitstring;
                                                            {7081}new TTL_6482: bitstring;
                                                            {7082}let gNs_6483: bitstring = exp(g,Ns_6480) in
                                                            {7083}let m2_6484: bitstring = (OpenSecureChannelResponse,gNs_6483,ST_6481,TTL_6482) in
                                                            {7084}out(c, m2_6484);
                                                            {7085}let Ksrv_6485: bitstring = exp(PartC_6479,Ns_6480) in
                                                            {7086}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6485))
                                                )
                                                else
                                                    {7087}let pkDisco_6486: bitstring = fail-any in
                                                    {7088}in(c, (=pkCli_6432,em1_6487: bitstring));
                                                    {7089}let m1_6488: bitstring = em1_6487 in
                                                    {7090}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6489: bitstring) = m1_6488 in
                                                    {7091}new Ns_6490: bitstring;
                                                    {7092}new ST_6491: bitstring;
                                                    {7093}new TTL_6492: bitstring;
                                                    {7094}let gNs_6493: bitstring = exp(g,Ns_6490) in
                                                    {7095}let m2_6494: bitstring = (OpenSecureChannelResponse,gNs_6493,ST_6491,TTL_6492) in
                                                    {7096}out(c, m2_6494);
                                                    {7097}let Ksrv_6495: bitstring = exp(PartC_6489,Ns_6490) in
                                                    {7098}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6495))
                                        )
                                        else
                                            {7099}let pkDisco_6496: bitstring = fail-any in
                                            {7100}in(c, (=pkCli_6432,em1_6497: bitstring));
                                            {7101}let m1_6498: bitstring = em1_6497 in
                                            {7102}let (=OpenSecureChannelRequest,=pkCli_6432,PartC_6499: bitstring) = m1_6498 in
                                            {7103}new Ns_6500: bitstring;
                                            {7104}new ST_6501: bitstring;
                                            {7105}new TTL_6502: bitstring;
                                            {7106}let gNs_6503: bitstring = exp(g,Ns_6500) in
                                            {7107}let m2_6504: bitstring = (OpenSecureChannelResponse,gNs_6503,ST_6501,TTL_6502) in
                                            {7108}out(c, m2_6504);
                                            {7109}let Ksrv_6505: bitstring = exp(PartC_6499,Ns_6500) in
                                            {7110}out(c, senc(mSrv(pkCli_6432,pkSess_6132),Ksrv_6505))
                            )
                            else
                                {7111}let pkCli_6506: bitstring = fail-any in
                                {7112}let v_6507: bool = (Disco_5610 = A) in
                                (
                                    {7113}if v_6507 then
                                    (
                                        {7114}let pkDisco_6508: bitstring = pub(skA) in
                                        {7115}in(c, (=pkCli_6506,em1_6509: bitstring));
                                        {7116}let m1_6510: bitstring = em1_6509 in
                                        {7117}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6511: bitstring) = m1_6510 in
                                        {7118}new Ns_6512: bitstring;
                                        {7119}new ST_6513: bitstring;
                                        {7120}new TTL_6514: bitstring;
                                        {7121}let gNs_6515: bitstring = exp(g,Ns_6512) in
                                        {7122}let m2_6516: bitstring = (OpenSecureChannelResponse,gNs_6515,ST_6513,TTL_6514) in
                                        {7123}out(c, m2_6516);
                                        {7124}let Ksrv_6517: bitstring = exp(PartC_6511,Ns_6512) in
                                        {7125}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6517))
                                    )
                                    else
                                        {7126}let v_6518: bool = (Disco_5610 = B) in
                                        (
                                            {7127}if v_6518 then
                                            (
                                                {7128}let pkDisco_6519: bitstring = pub(skB) in
                                                {7129}in(c, (=pkCli_6506,em1_6520: bitstring));
                                                {7130}let m1_6521: bitstring = em1_6520 in
                                                {7131}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6522: bitstring) = m1_6521 in
                                                {7132}new Ns_6523: bitstring;
                                                {7133}new ST_6524: bitstring;
                                                {7134}new TTL_6525: bitstring;
                                                {7135}let gNs_6526: bitstring = exp(g,Ns_6523) in
                                                {7136}let m2_6527: bitstring = (OpenSecureChannelResponse,gNs_6526,ST_6524,TTL_6525) in
                                                {7137}out(c, m2_6527);
                                                {7138}let Ksrv_6528: bitstring = exp(PartC_6522,Ns_6523) in
                                                {7139}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6528))
                                            )
                                            else
                                                {7140}let v_6529: bool = (Disco_5610 = C) in
                                                (
                                                    {7141}if v_6529 then
                                                    (
                                                        {7142}let pkDisco_6530: bitstring = pub(skC) in
                                                        {7143}in(c, (=pkCli_6506,em1_6531: bitstring));
                                                        {7144}let m1_6532: bitstring = em1_6531 in
                                                        {7145}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6533: bitstring) = m1_6532 in
                                                        {7146}new Ns_6534: bitstring;
                                                        {7147}new ST_6535: bitstring;
                                                        {7148}new TTL_6536: bitstring;
                                                        {7149}let gNs_6537: bitstring = exp(g,Ns_6534) in
                                                        {7150}let m2_6538: bitstring = (OpenSecureChannelResponse,gNs_6537,ST_6535,TTL_6536) in
                                                        {7151}out(c, m2_6538);
                                                        {7152}let Ksrv_6539: bitstring = exp(PartC_6533,Ns_6534) in
                                                        {7153}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6539))
                                                    )
                                                    else
                                                        {7154}let pkDisco_6540: bitstring = pub(sk(Disco_5610)) in
                                                        {7155}in(c, (=pkCli_6506,em1_6541: bitstring));
                                                        {7156}let m1_6542: bitstring = em1_6541 in
                                                        {7157}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6543: bitstring) = m1_6542 in
                                                        {7158}new Ns_6544: bitstring;
                                                        {7159}new ST_6545: bitstring;
                                                        {7160}new TTL_6546: bitstring;
                                                        {7161}let gNs_6547: bitstring = exp(g,Ns_6544) in
                                                        {7162}let m2_6548: bitstring = (OpenSecureChannelResponse,gNs_6547,ST_6545,TTL_6546) in
                                                        {7163}out(c, m2_6548);
                                                        {7164}let Ksrv_6549: bitstring = exp(PartC_6543,Ns_6544) in
                                                        {7165}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6549))
                                                )
                                                else
                                                    {7166}let pkDisco_6550: bitstring = fail-any in
                                                    {7167}in(c, (=pkCli_6506,em1_6551: bitstring));
                                                    {7168}let m1_6552: bitstring = em1_6551 in
                                                    {7169}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6553: bitstring) = m1_6552 in
                                                    {7170}new Ns_6554: bitstring;
                                                    {7171}new ST_6555: bitstring;
                                                    {7172}new TTL_6556: bitstring;
                                                    {7173}let gNs_6557: bitstring = exp(g,Ns_6554) in
                                                    {7174}let m2_6558: bitstring = (OpenSecureChannelResponse,gNs_6557,ST_6555,TTL_6556) in
                                                    {7175}out(c, m2_6558);
                                                    {7176}let Ksrv_6559: bitstring = exp(PartC_6553,Ns_6554) in
                                                    {7177}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6559))
                                        )
                                        else
                                            {7178}let pkDisco_6560: bitstring = fail-any in
                                            {7179}in(c, (=pkCli_6506,em1_6561: bitstring));
                                            {7180}let m1_6562: bitstring = em1_6561 in
                                            {7181}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6563: bitstring) = m1_6562 in
                                            {7182}new Ns_6564: bitstring;
                                            {7183}new ST_6565: bitstring;
                                            {7184}new TTL_6566: bitstring;
                                            {7185}let gNs_6567: bitstring = exp(g,Ns_6564) in
                                            {7186}let m2_6568: bitstring = (OpenSecureChannelResponse,gNs_6567,ST_6565,TTL_6566) in
                                            {7187}out(c, m2_6568);
                                            {7188}let Ksrv_6569: bitstring = exp(PartC_6563,Ns_6564) in
                                            {7189}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6569))
                                )
                                else
                                    {7190}let pkDisco_6570: bitstring = fail-any in
                                    {7191}in(c, (=pkCli_6506,em1_6571: bitstring));
                                    {7192}let m1_6572: bitstring = em1_6571 in
                                    {7193}let (=OpenSecureChannelRequest,=pkCli_6506,PartC_6573: bitstring) = m1_6572 in
                                    {7194}new Ns_6574: bitstring;
                                    {7195}new ST_6575: bitstring;
                                    {7196}new TTL_6576: bitstring;
                                    {7197}let gNs_6577: bitstring = exp(g,Ns_6574) in
                                    {7198}let m2_6578: bitstring = (OpenSecureChannelResponse,gNs_6577,ST_6575,TTL_6576) in
                                    {7199}out(c, m2_6578);
                                    {7200}let Ksrv_6579: bitstring = exp(PartC_6573,Ns_6574) in
                                    {7201}out(c, senc(mSrv(pkCli_6506,pkSess_6132),Ksrv_6579))
                    )
                    else
                        {7202}let pkCli_6580: bitstring = fail-any in
                        {7203}let v_6581: bool = (Disco_5610 = A) in
                        (
                            {7204}if v_6581 then
                            (
                                {7205}let pkDisco_6582: bitstring = pub(skA) in
                                {7206}in(c, (=pkCli_6580,em1_6583: bitstring));
                                {7207}let m1_6584: bitstring = em1_6583 in
                                {7208}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6585: bitstring) = m1_6584 in
                                {7209}new Ns_6586: bitstring;
                                {7210}new ST_6587: bitstring;
                                {7211}new TTL_6588: bitstring;
                                {7212}let gNs_6589: bitstring = exp(g,Ns_6586) in
                                {7213}let m2_6590: bitstring = (OpenSecureChannelResponse,gNs_6589,ST_6587,TTL_6588) in
                                {7214}out(c, m2_6590);
                                {7215}let Ksrv_6591: bitstring = exp(PartC_6585,Ns_6586) in
                                {7216}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6591))
                            )
                            else
                                {7217}let v_6592: bool = (Disco_5610 = B) in
                                (
                                    {7218}if v_6592 then
                                    (
                                        {7219}let pkDisco_6593: bitstring = pub(skB) in
                                        {7220}in(c, (=pkCli_6580,em1_6594: bitstring));
                                        {7221}let m1_6595: bitstring = em1_6594 in
                                        {7222}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6596: bitstring) = m1_6595 in
                                        {7223}new Ns_6597: bitstring;
                                        {7224}new ST_6598: bitstring;
                                        {7225}new TTL_6599: bitstring;
                                        {7226}let gNs_6600: bitstring = exp(g,Ns_6597) in
                                        {7227}let m2_6601: bitstring = (OpenSecureChannelResponse,gNs_6600,ST_6598,TTL_6599) in
                                        {7228}out(c, m2_6601);
                                        {7229}let Ksrv_6602: bitstring = exp(PartC_6596,Ns_6597) in
                                        {7230}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6602))
                                    )
                                    else
                                        {7231}let v_6603: bool = (Disco_5610 = C) in
                                        (
                                            {7232}if v_6603 then
                                            (
                                                {7233}let pkDisco_6604: bitstring = pub(skC) in
                                                {7234}in(c, (=pkCli_6580,em1_6605: bitstring));
                                                {7235}let m1_6606: bitstring = em1_6605 in
                                                {7236}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6607: bitstring) = m1_6606 in
                                                {7237}new Ns_6608: bitstring;
                                                {7238}new ST_6609: bitstring;
                                                {7239}new TTL_6610: bitstring;
                                                {7240}let gNs_6611: bitstring = exp(g,Ns_6608) in
                                                {7241}let m2_6612: bitstring = (OpenSecureChannelResponse,gNs_6611,ST_6609,TTL_6610) in
                                                {7242}out(c, m2_6612);
                                                {7243}let Ksrv_6613: bitstring = exp(PartC_6607,Ns_6608) in
                                                {7244}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6613))
                                            )
                                            else
                                                {7245}let pkDisco_6614: bitstring = pub(sk(Disco_5610)) in
                                                {7246}in(c, (=pkCli_6580,em1_6615: bitstring));
                                                {7247}let m1_6616: bitstring = em1_6615 in
                                                {7248}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6617: bitstring) = m1_6616 in
                                                {7249}new Ns_6618: bitstring;
                                                {7250}new ST_6619: bitstring;
                                                {7251}new TTL_6620: bitstring;
                                                {7252}let gNs_6621: bitstring = exp(g,Ns_6618) in
                                                {7253}let m2_6622: bitstring = (OpenSecureChannelResponse,gNs_6621,ST_6619,TTL_6620) in
                                                {7254}out(c, m2_6622);
                                                {7255}let Ksrv_6623: bitstring = exp(PartC_6617,Ns_6618) in
                                                {7256}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6623))
                                        )
                                        else
                                            {7257}let pkDisco_6624: bitstring = fail-any in
                                            {7258}in(c, (=pkCli_6580,em1_6625: bitstring));
                                            {7259}let m1_6626: bitstring = em1_6625 in
                                            {7260}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6627: bitstring) = m1_6626 in
                                            {7261}new Ns_6628: bitstring;
                                            {7262}new ST_6629: bitstring;
                                            {7263}new TTL_6630: bitstring;
                                            {7264}let gNs_6631: bitstring = exp(g,Ns_6628) in
                                            {7265}let m2_6632: bitstring = (OpenSecureChannelResponse,gNs_6631,ST_6629,TTL_6630) in
                                            {7266}out(c, m2_6632);
                                            {7267}let Ksrv_6633: bitstring = exp(PartC_6627,Ns_6628) in
                                            {7268}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6633))
                                )
                                else
                                    {7269}let pkDisco_6634: bitstring = fail-any in
                                    {7270}in(c, (=pkCli_6580,em1_6635: bitstring));
                                    {7271}let m1_6636: bitstring = em1_6635 in
                                    {7272}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6637: bitstring) = m1_6636 in
                                    {7273}new Ns_6638: bitstring;
                                    {7274}new ST_6639: bitstring;
                                    {7275}new TTL_6640: bitstring;
                                    {7276}let gNs_6641: bitstring = exp(g,Ns_6638) in
                                    {7277}let m2_6642: bitstring = (OpenSecureChannelResponse,gNs_6641,ST_6639,TTL_6640) in
                                    {7278}out(c, m2_6642);
                                    {7279}let Ksrv_6643: bitstring = exp(PartC_6637,Ns_6638) in
                                    {7280}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6643))
                        )
                        else
                            {7281}let pkDisco_6644: bitstring = fail-any in
                            {7282}in(c, (=pkCli_6580,em1_6645: bitstring));
                            {7283}let m1_6646: bitstring = em1_6645 in
                            {7284}let (=OpenSecureChannelRequest,=pkCli_6580,PartC_6647: bitstring) = m1_6646 in
                            {7285}new Ns_6648: bitstring;
                            {7286}new ST_6649: bitstring;
                            {7287}new TTL_6650: bitstring;
                            {7288}let gNs_6651: bitstring = exp(g,Ns_6648) in
                            {7289}let m2_6652: bitstring = (OpenSecureChannelResponse,gNs_6651,ST_6649,TTL_6650) in
                            {7290}out(c, m2_6652);
                            {7291}let Ksrv_6653: bitstring = exp(PartC_6647,Ns_6648) in
                            {7292}out(c, senc(mSrv(pkCli_6580,pkSess_6132),Ksrv_6653))
                )
                else
                    {7293}let =true = (Sess_5611 = C) in
                    (
                        {7294}let skSess_6654: bitstring = skC in
                        {7295}let pkSess_6655: bitstring = pub(skSess_6654) in
                        {7296}let v_6656: bool = (Cli_5609 = A) in
                        (
                            {7297}if v_6656 then
                            (
                                {7298}let pkCli_6657: bitstring = pub(skA) in
                                {7299}let v_6658: bool = (Disco_5610 = A) in
                                (
                                    {7300}if v_6658 then
                                    (
                                        {7301}let pkDisco_6659: bitstring = pub(skA) in
                                        {7302}in(c, (=pkCli_6657,em1_6660: bitstring));
                                        {7303}let m1_6661: bitstring = em1_6660 in
                                        {7304}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6662: bitstring) = m1_6661 in
                                        {7305}new Ns_6663: bitstring;
                                        {7306}new ST_6664: bitstring;
                                        {7307}new TTL_6665: bitstring;
                                        {7308}let gNs_6666: bitstring = exp(g,Ns_6663) in
                                        {7309}let m2_6667: bitstring = (OpenSecureChannelResponse,gNs_6666,ST_6664,TTL_6665) in
                                        {7310}out(c, m2_6667);
                                        {7311}let Ksrv_6668: bitstring = exp(PartC_6662,Ns_6663) in
                                        {7312}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6668))
                                    )
                                    else
                                        {7313}let v_6669: bool = (Disco_5610 = B) in
                                        (
                                            {7314}if v_6669 then
                                            (
                                                {7315}let pkDisco_6670: bitstring = pub(skB) in
                                                {7316}in(c, (=pkCli_6657,em1_6671: bitstring));
                                                {7317}let m1_6672: bitstring = em1_6671 in
                                                {7318}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6673: bitstring) = m1_6672 in
                                                {7319}new Ns_6674: bitstring;
                                                {7320}new ST_6675: bitstring;
                                                {7321}new TTL_6676: bitstring;
                                                {7322}let gNs_6677: bitstring = exp(g,Ns_6674) in
                                                {7323}let m2_6678: bitstring = (OpenSecureChannelResponse,gNs_6677,ST_6675,TTL_6676) in
                                                {7324}out(c, m2_6678);
                                                {7325}let Ksrv_6679: bitstring = exp(PartC_6673,Ns_6674) in
                                                {7326}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6679))
                                            )
                                            else
                                                {7327}let v_6680: bool = (Disco_5610 = C) in
                                                (
                                                    {7328}if v_6680 then
                                                    (
                                                        {7329}let pkDisco_6681: bitstring = pub(skC) in
                                                        {7330}in(c, (=pkCli_6657,em1_6682: bitstring));
                                                        {7331}let m1_6683: bitstring = em1_6682 in
                                                        {7332}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6684: bitstring) = m1_6683 in
                                                        {7333}new Ns_6685: bitstring;
                                                        {7334}new ST_6686: bitstring;
                                                        {7335}new TTL_6687: bitstring;
                                                        {7336}let gNs_6688: bitstring = exp(g,Ns_6685) in
                                                        {7337}let m2_6689: bitstring = (OpenSecureChannelResponse,gNs_6688,ST_6686,TTL_6687) in
                                                        {7338}out(c, m2_6689);
                                                        {7339}let Ksrv_6690: bitstring = exp(PartC_6684,Ns_6685) in
                                                        {7340}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6690))
                                                    )
                                                    else
                                                        {7341}let pkDisco_6691: bitstring = pub(sk(Disco_5610)) in
                                                        {7342}in(c, (=pkCli_6657,em1_6692: bitstring));
                                                        {7343}let m1_6693: bitstring = em1_6692 in
                                                        {7344}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6694: bitstring) = m1_6693 in
                                                        {7345}new Ns_6695: bitstring;
                                                        {7346}new ST_6696: bitstring;
                                                        {7347}new TTL_6697: bitstring;
                                                        {7348}let gNs_6698: bitstring = exp(g,Ns_6695) in
                                                        {7349}let m2_6699: bitstring = (OpenSecureChannelResponse,gNs_6698,ST_6696,TTL_6697) in
                                                        {7350}out(c, m2_6699);
                                                        {7351}let Ksrv_6700: bitstring = exp(PartC_6694,Ns_6695) in
                                                        {7352}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6700))
                                                )
                                                else
                                                    {7353}let pkDisco_6701: bitstring = fail-any in
                                                    {7354}in(c, (=pkCli_6657,em1_6702: bitstring));
                                                    {7355}let m1_6703: bitstring = em1_6702 in
                                                    {7356}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6704: bitstring) = m1_6703 in
                                                    {7357}new Ns_6705: bitstring;
                                                    {7358}new ST_6706: bitstring;
                                                    {7359}new TTL_6707: bitstring;
                                                    {7360}let gNs_6708: bitstring = exp(g,Ns_6705) in
                                                    {7361}let m2_6709: bitstring = (OpenSecureChannelResponse,gNs_6708,ST_6706,TTL_6707) in
                                                    {7362}out(c, m2_6709);
                                                    {7363}let Ksrv_6710: bitstring = exp(PartC_6704,Ns_6705) in
                                                    {7364}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6710))
                                        )
                                        else
                                            {7365}let pkDisco_6711: bitstring = fail-any in
                                            {7366}in(c, (=pkCli_6657,em1_6712: bitstring));
                                            {7367}let m1_6713: bitstring = em1_6712 in
                                            {7368}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6714: bitstring) = m1_6713 in
                                            {7369}new Ns_6715: bitstring;
                                            {7370}new ST_6716: bitstring;
                                            {7371}new TTL_6717: bitstring;
                                            {7372}let gNs_6718: bitstring = exp(g,Ns_6715) in
                                            {7373}let m2_6719: bitstring = (OpenSecureChannelResponse,gNs_6718,ST_6716,TTL_6717) in
                                            {7374}out(c, m2_6719);
                                            {7375}let Ksrv_6720: bitstring = exp(PartC_6714,Ns_6715) in
                                            {7376}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6720))
                                )
                                else
                                    {7377}let pkDisco_6721: bitstring = fail-any in
                                    {7378}in(c, (=pkCli_6657,em1_6722: bitstring));
                                    {7379}let m1_6723: bitstring = em1_6722 in
                                    {7380}let (=OpenSecureChannelRequest,=pkCli_6657,PartC_6724: bitstring) = m1_6723 in
                                    {7381}new Ns_6725: bitstring;
                                    {7382}new ST_6726: bitstring;
                                    {7383}new TTL_6727: bitstring;
                                    {7384}let gNs_6728: bitstring = exp(g,Ns_6725) in
                                    {7385}let m2_6729: bitstring = (OpenSecureChannelResponse,gNs_6728,ST_6726,TTL_6727) in
                                    {7386}out(c, m2_6729);
                                    {7387}let Ksrv_6730: bitstring = exp(PartC_6724,Ns_6725) in
                                    {7388}out(c, senc(mSrv(pkCli_6657,pkSess_6655),Ksrv_6730))
                            )
                            else
                                {7389}let v_6731: bool = (Cli_5609 = B) in
                                (
                                    {7390}if v_6731 then
                                    (
                                        {7391}let pkCli_6732: bitstring = pub(skB) in
                                        {7392}let v_6733: bool = (Disco_5610 = A) in
                                        (
                                            {7393}if v_6733 then
                                            (
                                                {7394}let pkDisco_6734: bitstring = pub(skA) in
                                                {7395}in(c, (=pkCli_6732,em1_6735: bitstring));
                                                {7396}let m1_6736: bitstring = em1_6735 in
                                                {7397}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6737: bitstring) = m1_6736 in
                                                {7398}new Ns_6738: bitstring;
                                                {7399}new ST_6739: bitstring;
                                                {7400}new TTL_6740: bitstring;
                                                {7401}let gNs_6741: bitstring = exp(g,Ns_6738) in
                                                {7402}let m2_6742: bitstring = (OpenSecureChannelResponse,gNs_6741,ST_6739,TTL_6740) in
                                                {7403}out(c, m2_6742);
                                                {7404}let Ksrv_6743: bitstring = exp(PartC_6737,Ns_6738) in
                                                {7405}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6743))
                                            )
                                            else
                                                {7406}let v_6744: bool = (Disco_5610 = B) in
                                                (
                                                    {7407}if v_6744 then
                                                    (
                                                        {7408}let pkDisco_6745: bitstring = pub(skB) in
                                                        {7409}in(c, (=pkCli_6732,em1_6746: bitstring));
                                                        {7410}let m1_6747: bitstring = em1_6746 in
                                                        {7411}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6748: bitstring) = m1_6747 in
                                                        {7412}new Ns_6749: bitstring;
                                                        {7413}new ST_6750: bitstring;
                                                        {7414}new TTL_6751: bitstring;
                                                        {7415}let gNs_6752: bitstring = exp(g,Ns_6749) in
                                                        {7416}let m2_6753: bitstring = (OpenSecureChannelResponse,gNs_6752,ST_6750,TTL_6751) in
                                                        {7417}out(c, m2_6753);
                                                        {7418}let Ksrv_6754: bitstring = exp(PartC_6748,Ns_6749) in
                                                        {7419}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6754))
                                                    )
                                                    else
                                                        {7420}let v_6755: bool = (Disco_5610 = C) in
                                                        (
                                                            {7421}if v_6755 then
                                                            (
                                                                {7422}let pkDisco_6756: bitstring = pub(skC) in
                                                                {7423}in(c, (=pkCli_6732,em1_6757: bitstring));
                                                                {7424}let m1_6758: bitstring = em1_6757 in
                                                                {7425}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6759: bitstring) = m1_6758 in
                                                                {7426}new Ns_6760: bitstring;
                                                                {7427}new ST_6761: bitstring;
                                                                {7428}new TTL_6762: bitstring;
                                                                {7429}let gNs_6763: bitstring = exp(g,Ns_6760) in
                                                                {7430}let m2_6764: bitstring = (OpenSecureChannelResponse,gNs_6763,ST_6761,TTL_6762) in
                                                                {7431}out(c, m2_6764);
                                                                {7432}let Ksrv_6765: bitstring = exp(PartC_6759,Ns_6760) in
                                                                {7433}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6765))
                                                            )
                                                            else
                                                                {7434}let pkDisco_6766: bitstring = pub(sk(Disco_5610)) in
                                                                {7435}in(c, (=pkCli_6732,em1_6767: bitstring));
                                                                {7436}let m1_6768: bitstring = em1_6767 in
                                                                {7437}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6769: bitstring) = m1_6768 in
                                                                {7438}new Ns_6770: bitstring;
                                                                {7439}new ST_6771: bitstring;
                                                                {7440}new TTL_6772: bitstring;
                                                                {7441}let gNs_6773: bitstring = exp(g,Ns_6770) in
                                                                {7442}let m2_6774: bitstring = (OpenSecureChannelResponse,gNs_6773,ST_6771,TTL_6772) in
                                                                {7443}out(c, m2_6774);
                                                                {7444}let Ksrv_6775: bitstring = exp(PartC_6769,Ns_6770) in
                                                                {7445}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6775))
                                                        )
                                                        else
                                                            {7446}let pkDisco_6776: bitstring = fail-any in
                                                            {7447}in(c, (=pkCli_6732,em1_6777: bitstring));
                                                            {7448}let m1_6778: bitstring = em1_6777 in
                                                            {7449}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6779: bitstring) = m1_6778 in
                                                            {7450}new Ns_6780: bitstring;
                                                            {7451}new ST_6781: bitstring;
                                                            {7452}new TTL_6782: bitstring;
                                                            {7453}let gNs_6783: bitstring = exp(g,Ns_6780) in
                                                            {7454}let m2_6784: bitstring = (OpenSecureChannelResponse,gNs_6783,ST_6781,TTL_6782) in
                                                            {7455}out(c, m2_6784);
                                                            {7456}let Ksrv_6785: bitstring = exp(PartC_6779,Ns_6780) in
                                                            {7457}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6785))
                                                )
                                                else
                                                    {7458}let pkDisco_6786: bitstring = fail-any in
                                                    {7459}in(c, (=pkCli_6732,em1_6787: bitstring));
                                                    {7460}let m1_6788: bitstring = em1_6787 in
                                                    {7461}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6789: bitstring) = m1_6788 in
                                                    {7462}new Ns_6790: bitstring;
                                                    {7463}new ST_6791: bitstring;
                                                    {7464}new TTL_6792: bitstring;
                                                    {7465}let gNs_6793: bitstring = exp(g,Ns_6790) in
                                                    {7466}let m2_6794: bitstring = (OpenSecureChannelResponse,gNs_6793,ST_6791,TTL_6792) in
                                                    {7467}out(c, m2_6794);
                                                    {7468}let Ksrv_6795: bitstring = exp(PartC_6789,Ns_6790) in
                                                    {7469}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6795))
                                        )
                                        else
                                            {7470}let pkDisco_6796: bitstring = fail-any in
                                            {7471}in(c, (=pkCli_6732,em1_6797: bitstring));
                                            {7472}let m1_6798: bitstring = em1_6797 in
                                            {7473}let (=OpenSecureChannelRequest,=pkCli_6732,PartC_6799: bitstring) = m1_6798 in
                                            {7474}new Ns_6800: bitstring;
                                            {7475}new ST_6801: bitstring;
                                            {7476}new TTL_6802: bitstring;
                                            {7477}let gNs_6803: bitstring = exp(g,Ns_6800) in
                                            {7478}let m2_6804: bitstring = (OpenSecureChannelResponse,gNs_6803,ST_6801,TTL_6802) in
                                            {7479}out(c, m2_6804);
                                            {7480}let Ksrv_6805: bitstring = exp(PartC_6799,Ns_6800) in
                                            {7481}out(c, senc(mSrv(pkCli_6732,pkSess_6655),Ksrv_6805))
                                    )
                                    else
                                        {7482}let v_6806: bool = (Cli_5609 = C) in
                                        (
                                            {7483}if v_6806 then
                                            (
                                                {7484}let pkCli_6807: bitstring = pub(skC) in
                                                {7485}let v_6808: bool = (Disco_5610 = A) in
                                                (
                                                    {7486}if v_6808 then
                                                    (
                                                        {7487}let pkDisco_6809: bitstring = pub(skA) in
                                                        {7488}in(c, (=pkCli_6807,em1_6810: bitstring));
                                                        {7489}let m1_6811: bitstring = em1_6810 in
                                                        {7490}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6812: bitstring) = m1_6811 in
                                                        {7491}new Ns_6813: bitstring;
                                                        {7492}new ST_6814: bitstring;
                                                        {7493}new TTL_6815: bitstring;
                                                        {7494}let gNs_6816: bitstring = exp(g,Ns_6813) in
                                                        {7495}let m2_6817: bitstring = (OpenSecureChannelResponse,gNs_6816,ST_6814,TTL_6815) in
                                                        {7496}out(c, m2_6817);
                                                        {7497}let Ksrv_6818: bitstring = exp(PartC_6812,Ns_6813) in
                                                        {7498}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6818))
                                                    )
                                                    else
                                                        {7499}let v_6819: bool = (Disco_5610 = B) in
                                                        (
                                                            {7500}if v_6819 then
                                                            (
                                                                {7501}let pkDisco_6820: bitstring = pub(skB) in
                                                                {7502}in(c, (=pkCli_6807,em1_6821: bitstring));
                                                                {7503}let m1_6822: bitstring = em1_6821 in
                                                                {7504}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6823: bitstring) = m1_6822 in
                                                                {7505}new Ns_6824: bitstring;
                                                                {7506}new ST_6825: bitstring;
                                                                {7507}new TTL_6826: bitstring;
                                                                {7508}let gNs_6827: bitstring = exp(g,Ns_6824) in
                                                                {7509}let m2_6828: bitstring = (OpenSecureChannelResponse,gNs_6827,ST_6825,TTL_6826) in
                                                                {7510}out(c, m2_6828);
                                                                {7511}let Ksrv_6829: bitstring = exp(PartC_6823,Ns_6824) in
                                                                {7512}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6829))
                                                            )
                                                            else
                                                                {7513}let v_6830: bool = (Disco_5610 = C) in
                                                                (
                                                                    {7514}if v_6830 then
                                                                    (
                                                                        {7515}let pkDisco_6831: bitstring = pub(skC) in
                                                                        {7516}in(c, (=pkCli_6807,em1_6832: bitstring));
                                                                        {7517}let m1_6833: bitstring = em1_6832 in
                                                                        {7518}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6834: bitstring) = m1_6833 in
                                                                        {7519}new Ns_6835: bitstring;
                                                                        {7520}new ST_6836: bitstring;
                                                                        {7521}new TTL_6837: bitstring;
                                                                        {7522}let gNs_6838: bitstring = exp(g,Ns_6835) in
                                                                        {7523}let m2_6839: bitstring = (OpenSecureChannelResponse,gNs_6838,ST_6836,TTL_6837) in
                                                                        {7524}out(c, m2_6839);
                                                                        {7525}let Ksrv_6840: bitstring = exp(PartC_6834,Ns_6835) in
                                                                        {7526}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6840))
                                                                    )
                                                                    else
                                                                        {7527}let pkDisco_6841: bitstring = pub(sk(Disco_5610)) in
                                                                        {7528}in(c, (=pkCli_6807,em1_6842: bitstring));
                                                                        {7529}let m1_6843: bitstring = em1_6842 in
                                                                        {7530}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6844: bitstring) = m1_6843 in
                                                                        {7531}new Ns_6845: bitstring;
                                                                        {7532}new ST_6846: bitstring;
                                                                        {7533}new TTL_6847: bitstring;
                                                                        {7534}let gNs_6848: bitstring = exp(g,Ns_6845) in
                                                                        {7535}let m2_6849: bitstring = (OpenSecureChannelResponse,gNs_6848,ST_6846,TTL_6847) in
                                                                        {7536}out(c, m2_6849);
                                                                        {7537}let Ksrv_6850: bitstring = exp(PartC_6844,Ns_6845) in
                                                                        {7538}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6850))
                                                                )
                                                                else
                                                                    {7539}let pkDisco_6851: bitstring = fail-any in
                                                                    {7540}in(c, (=pkCli_6807,em1_6852: bitstring));
                                                                    {7541}let m1_6853: bitstring = em1_6852 in
                                                                    {7542}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6854: bitstring) = m1_6853 in
                                                                    {7543}new Ns_6855: bitstring;
                                                                    {7544}new ST_6856: bitstring;
                                                                    {7545}new TTL_6857: bitstring;
                                                                    {7546}let gNs_6858: bitstring = exp(g,Ns_6855) in
                                                                    {7547}let m2_6859: bitstring = (OpenSecureChannelResponse,gNs_6858,ST_6856,TTL_6857) in
                                                                    {7548}out(c, m2_6859);
                                                                    {7549}let Ksrv_6860: bitstring = exp(PartC_6854,Ns_6855) in
                                                                    {7550}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6860))
                                                        )
                                                        else
                                                            {7551}let pkDisco_6861: bitstring = fail-any in
                                                            {7552}in(c, (=pkCli_6807,em1_6862: bitstring));
                                                            {7553}let m1_6863: bitstring = em1_6862 in
                                                            {7554}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6864: bitstring) = m1_6863 in
                                                            {7555}new Ns_6865: bitstring;
                                                            {7556}new ST_6866: bitstring;
                                                            {7557}new TTL_6867: bitstring;
                                                            {7558}let gNs_6868: bitstring = exp(g,Ns_6865) in
                                                            {7559}let m2_6869: bitstring = (OpenSecureChannelResponse,gNs_6868,ST_6866,TTL_6867) in
                                                            {7560}out(c, m2_6869);
                                                            {7561}let Ksrv_6870: bitstring = exp(PartC_6864,Ns_6865) in
                                                            {7562}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6870))
                                                )
                                                else
                                                    {7563}let pkDisco_6871: bitstring = fail-any in
                                                    {7564}in(c, (=pkCli_6807,em1_6872: bitstring));
                                                    {7565}let m1_6873: bitstring = em1_6872 in
                                                    {7566}let (=OpenSecureChannelRequest,=pkCli_6807,PartC_6874: bitstring) = m1_6873 in
                                                    {7567}new Ns_6875: bitstring;
                                                    {7568}new ST_6876: bitstring;
                                                    {7569}new TTL_6877: bitstring;
                                                    {7570}let gNs_6878: bitstring = exp(g,Ns_6875) in
                                                    {7571}let m2_6879: bitstring = (OpenSecureChannelResponse,gNs_6878,ST_6876,TTL_6877) in
                                                    {7572}out(c, m2_6879);
                                                    {7573}let Ksrv_6880: bitstring = exp(PartC_6874,Ns_6875) in
                                                    {7574}out(c, senc(mSrv(pkCli_6807,pkSess_6655),Ksrv_6880))
                                            )
                                            else
                                                {7575}let pkCli_6881: bitstring = pub(sk(Cli_5609)) in
                                                {7576}let v_6882: bool = (Disco_5610 = A) in
                                                (
                                                    {7577}if v_6882 then
                                                    (
                                                        {7578}let pkDisco_6883: bitstring = pub(skA) in
                                                        {7579}in(c, (=pkCli_6881,em1_6884: bitstring));
                                                        {7580}let m1_6885: bitstring = em1_6884 in
                                                        {7581}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6886: bitstring) = m1_6885 in
                                                        {7582}new Ns_6887: bitstring;
                                                        {7583}new ST_6888: bitstring;
                                                        {7584}new TTL_6889: bitstring;
                                                        {7585}let gNs_6890: bitstring = exp(g,Ns_6887) in
                                                        {7586}let m2_6891: bitstring = (OpenSecureChannelResponse,gNs_6890,ST_6888,TTL_6889) in
                                                        {7587}out(c, m2_6891);
                                                        {7588}let Ksrv_6892: bitstring = exp(PartC_6886,Ns_6887) in
                                                        {7589}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6892))
                                                    )
                                                    else
                                                        {7590}let v_6893: bool = (Disco_5610 = B) in
                                                        (
                                                            {7591}if v_6893 then
                                                            (
                                                                {7592}let pkDisco_6894: bitstring = pub(skB) in
                                                                {7593}in(c, (=pkCli_6881,em1_6895: bitstring));
                                                                {7594}let m1_6896: bitstring = em1_6895 in
                                                                {7595}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6897: bitstring) = m1_6896 in
                                                                {7596}new Ns_6898: bitstring;
                                                                {7597}new ST_6899: bitstring;
                                                                {7598}new TTL_6900: bitstring;
                                                                {7599}let gNs_6901: bitstring = exp(g,Ns_6898) in
                                                                {7600}let m2_6902: bitstring = (OpenSecureChannelResponse,gNs_6901,ST_6899,TTL_6900) in
                                                                {7601}out(c, m2_6902);
                                                                {7602}let Ksrv_6903: bitstring = exp(PartC_6897,Ns_6898) in
                                                                {7603}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6903))
                                                            )
                                                            else
                                                                {7604}let v_6904: bool = (Disco_5610 = C) in
                                                                (
                                                                    {7605}if v_6904 then
                                                                    (
                                                                        {7606}let pkDisco_6905: bitstring = pub(skC) in
                                                                        {7607}in(c, (=pkCli_6881,em1_6906: bitstring));
                                                                        {7608}let m1_6907: bitstring = em1_6906 in
                                                                        {7609}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6908: bitstring) = m1_6907 in
                                                                        {7610}new Ns_6909: bitstring;
                                                                        {7611}new ST_6910: bitstring;
                                                                        {7612}new TTL_6911: bitstring;
                                                                        {7613}let gNs_6912: bitstring = exp(g,Ns_6909) in
                                                                        {7614}let m2_6913: bitstring = (OpenSecureChannelResponse,gNs_6912,ST_6910,TTL_6911) in
                                                                        {7615}out(c, m2_6913);
                                                                        {7616}let Ksrv_6914: bitstring = exp(PartC_6908,Ns_6909) in
                                                                        {7617}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6914))
                                                                    )
                                                                    else
                                                                        {7618}let pkDisco_6915: bitstring = pub(sk(Disco_5610)) in
                                                                        {7619}in(c, (=pkCli_6881,em1_6916: bitstring));
                                                                        {7620}let m1_6917: bitstring = em1_6916 in
                                                                        {7621}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6918: bitstring) = m1_6917 in
                                                                        {7622}new Ns_6919: bitstring;
                                                                        {7623}new ST_6920: bitstring;
                                                                        {7624}new TTL_6921: bitstring;
                                                                        {7625}let gNs_6922: bitstring = exp(g,Ns_6919) in
                                                                        {7626}let m2_6923: bitstring = (OpenSecureChannelResponse,gNs_6922,ST_6920,TTL_6921) in
                                                                        {7627}out(c, m2_6923);
                                                                        {7628}let Ksrv_6924: bitstring = exp(PartC_6918,Ns_6919) in
                                                                        {7629}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6924))
                                                                )
                                                                else
                                                                    {7630}let pkDisco_6925: bitstring = fail-any in
                                                                    {7631}in(c, (=pkCli_6881,em1_6926: bitstring));
                                                                    {7632}let m1_6927: bitstring = em1_6926 in
                                                                    {7633}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6928: bitstring) = m1_6927 in
                                                                    {7634}new Ns_6929: bitstring;
                                                                    {7635}new ST_6930: bitstring;
                                                                    {7636}new TTL_6931: bitstring;
                                                                    {7637}let gNs_6932: bitstring = exp(g,Ns_6929) in
                                                                    {7638}let m2_6933: bitstring = (OpenSecureChannelResponse,gNs_6932,ST_6930,TTL_6931) in
                                                                    {7639}out(c, m2_6933);
                                                                    {7640}let Ksrv_6934: bitstring = exp(PartC_6928,Ns_6929) in
                                                                    {7641}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6934))
                                                        )
                                                        else
                                                            {7642}let pkDisco_6935: bitstring = fail-any in
                                                            {7643}in(c, (=pkCli_6881,em1_6936: bitstring));
                                                            {7644}let m1_6937: bitstring = em1_6936 in
                                                            {7645}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6938: bitstring) = m1_6937 in
                                                            {7646}new Ns_6939: bitstring;
                                                            {7647}new ST_6940: bitstring;
                                                            {7648}new TTL_6941: bitstring;
                                                            {7649}let gNs_6942: bitstring = exp(g,Ns_6939) in
                                                            {7650}let m2_6943: bitstring = (OpenSecureChannelResponse,gNs_6942,ST_6940,TTL_6941) in
                                                            {7651}out(c, m2_6943);
                                                            {7652}let Ksrv_6944: bitstring = exp(PartC_6938,Ns_6939) in
                                                            {7653}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6944))
                                                )
                                                else
                                                    {7654}let pkDisco_6945: bitstring = fail-any in
                                                    {7655}in(c, (=pkCli_6881,em1_6946: bitstring));
                                                    {7656}let m1_6947: bitstring = em1_6946 in
                                                    {7657}let (=OpenSecureChannelRequest,=pkCli_6881,PartC_6948: bitstring) = m1_6947 in
                                                    {7658}new Ns_6949: bitstring;
                                                    {7659}new ST_6950: bitstring;
                                                    {7660}new TTL_6951: bitstring;
                                                    {7661}let gNs_6952: bitstring = exp(g,Ns_6949) in
                                                    {7662}let m2_6953: bitstring = (OpenSecureChannelResponse,gNs_6952,ST_6950,TTL_6951) in
                                                    {7663}out(c, m2_6953);
                                                    {7664}let Ksrv_6954: bitstring = exp(PartC_6948,Ns_6949) in
                                                    {7665}out(c, senc(mSrv(pkCli_6881,pkSess_6655),Ksrv_6954))
                                        )
                                        else
                                            {7666}let pkCli_6955: bitstring = fail-any in
                                            {7667}let v_6956: bool = (Disco_5610 = A) in
                                            (
                                                {7668}if v_6956 then
                                                (
                                                    {7669}let pkDisco_6957: bitstring = pub(skA) in
                                                    {7670}in(c, (=pkCli_6955,em1_6958: bitstring));
                                                    {7671}let m1_6959: bitstring = em1_6958 in
                                                    {7672}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_6960: bitstring) = m1_6959 in
                                                    {7673}new Ns_6961: bitstring;
                                                    {7674}new ST_6962: bitstring;
                                                    {7675}new TTL_6963: bitstring;
                                                    {7676}let gNs_6964: bitstring = exp(g,Ns_6961) in
                                                    {7677}let m2_6965: bitstring = (OpenSecureChannelResponse,gNs_6964,ST_6962,TTL_6963) in
                                                    {7678}out(c, m2_6965);
                                                    {7679}let Ksrv_6966: bitstring = exp(PartC_6960,Ns_6961) in
                                                    {7680}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_6966))
                                                )
                                                else
                                                    {7681}let v_6967: bool = (Disco_5610 = B) in
                                                    (
                                                        {7682}if v_6967 then
                                                        (
                                                            {7683}let pkDisco_6968: bitstring = pub(skB) in
                                                            {7684}in(c, (=pkCli_6955,em1_6969: bitstring));
                                                            {7685}let m1_6970: bitstring = em1_6969 in
                                                            {7686}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_6971: bitstring) = m1_6970 in
                                                            {7687}new Ns_6972: bitstring;
                                                            {7688}new ST_6973: bitstring;
                                                            {7689}new TTL_6974: bitstring;
                                                            {7690}let gNs_6975: bitstring = exp(g,Ns_6972) in
                                                            {7691}let m2_6976: bitstring = (OpenSecureChannelResponse,gNs_6975,ST_6973,TTL_6974) in
                                                            {7692}out(c, m2_6976);
                                                            {7693}let Ksrv_6977: bitstring = exp(PartC_6971,Ns_6972) in
                                                            {7694}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_6977))
                                                        )
                                                        else
                                                            {7695}let v_6978: bool = (Disco_5610 = C) in
                                                            (
                                                                {7696}if v_6978 then
                                                                (
                                                                    {7697}let pkDisco_6979: bitstring = pub(skC) in
                                                                    {7698}in(c, (=pkCli_6955,em1_6980: bitstring));
                                                                    {7699}let m1_6981: bitstring = em1_6980 in
                                                                    {7700}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_6982: bitstring) = m1_6981 in
                                                                    {7701}new Ns_6983: bitstring;
                                                                    {7702}new ST_6984: bitstring;
                                                                    {7703}new TTL_6985: bitstring;
                                                                    {7704}let gNs_6986: bitstring = exp(g,Ns_6983) in
                                                                    {7705}let m2_6987: bitstring = (OpenSecureChannelResponse,gNs_6986,ST_6984,TTL_6985) in
                                                                    {7706}out(c, m2_6987);
                                                                    {7707}let Ksrv_6988: bitstring = exp(PartC_6982,Ns_6983) in
                                                                    {7708}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_6988))
                                                                )
                                                                else
                                                                    {7709}let pkDisco_6989: bitstring = pub(sk(Disco_5610)) in
                                                                    {7710}in(c, (=pkCli_6955,em1_6990: bitstring));
                                                                    {7711}let m1_6991: bitstring = em1_6990 in
                                                                    {7712}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_6992: bitstring) = m1_6991 in
                                                                    {7713}new Ns_6993: bitstring;
                                                                    {7714}new ST_6994: bitstring;
                                                                    {7715}new TTL_6995: bitstring;
                                                                    {7716}let gNs_6996: bitstring = exp(g,Ns_6993) in
                                                                    {7717}let m2_6997: bitstring = (OpenSecureChannelResponse,gNs_6996,ST_6994,TTL_6995) in
                                                                    {7718}out(c, m2_6997);
                                                                    {7719}let Ksrv_6998: bitstring = exp(PartC_6992,Ns_6993) in
                                                                    {7720}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_6998))
                                                            )
                                                            else
                                                                {7721}let pkDisco_6999: bitstring = fail-any in
                                                                {7722}in(c, (=pkCli_6955,em1_7000: bitstring));
                                                                {7723}let m1_7001: bitstring = em1_7000 in
                                                                {7724}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_7002: bitstring) = m1_7001 in
                                                                {7725}new Ns_7003: bitstring;
                                                                {7726}new ST_7004: bitstring;
                                                                {7727}new TTL_7005: bitstring;
                                                                {7728}let gNs_7006: bitstring = exp(g,Ns_7003) in
                                                                {7729}let m2_7007: bitstring = (OpenSecureChannelResponse,gNs_7006,ST_7004,TTL_7005) in
                                                                {7730}out(c, m2_7007);
                                                                {7731}let Ksrv_7008: bitstring = exp(PartC_7002,Ns_7003) in
                                                                {7732}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_7008))
                                                    )
                                                    else
                                                        {7733}let pkDisco_7009: bitstring = fail-any in
                                                        {7734}in(c, (=pkCli_6955,em1_7010: bitstring));
                                                        {7735}let m1_7011: bitstring = em1_7010 in
                                                        {7736}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_7012: bitstring) = m1_7011 in
                                                        {7737}new Ns_7013: bitstring;
                                                        {7738}new ST_7014: bitstring;
                                                        {7739}new TTL_7015: bitstring;
                                                        {7740}let gNs_7016: bitstring = exp(g,Ns_7013) in
                                                        {7741}let m2_7017: bitstring = (OpenSecureChannelResponse,gNs_7016,ST_7014,TTL_7015) in
                                                        {7742}out(c, m2_7017);
                                                        {7743}let Ksrv_7018: bitstring = exp(PartC_7012,Ns_7013) in
                                                        {7744}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_7018))
                                            )
                                            else
                                                {7745}let pkDisco_7019: bitstring = fail-any in
                                                {7746}in(c, (=pkCli_6955,em1_7020: bitstring));
                                                {7747}let m1_7021: bitstring = em1_7020 in
                                                {7748}let (=OpenSecureChannelRequest,=pkCli_6955,PartC_7022: bitstring) = m1_7021 in
                                                {7749}new Ns_7023: bitstring;
                                                {7750}new ST_7024: bitstring;
                                                {7751}new TTL_7025: bitstring;
                                                {7752}let gNs_7026: bitstring = exp(g,Ns_7023) in
                                                {7753}let m2_7027: bitstring = (OpenSecureChannelResponse,gNs_7026,ST_7024,TTL_7025) in
                                                {7754}out(c, m2_7027);
                                                {7755}let Ksrv_7028: bitstring = exp(PartC_7022,Ns_7023) in
                                                {7756}out(c, senc(mSrv(pkCli_6955,pkSess_6655),Ksrv_7028))
                                )
                                else
                                    {7757}let pkCli_7029: bitstring = fail-any in
                                    {7758}let v_7030: bool = (Disco_5610 = A) in
                                    (
                                        {7759}if v_7030 then
                                        (
                                            {7760}let pkDisco_7031: bitstring = pub(skA) in
                                            {7761}in(c, (=pkCli_7029,em1_7032: bitstring));
                                            {7762}let m1_7033: bitstring = em1_7032 in
                                            {7763}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7034: bitstring) = m1_7033 in
                                            {7764}new Ns_7035: bitstring;
                                            {7765}new ST_7036: bitstring;
                                            {7766}new TTL_7037: bitstring;
                                            {7767}let gNs_7038: bitstring = exp(g,Ns_7035) in
                                            {7768}let m2_7039: bitstring = (OpenSecureChannelResponse,gNs_7038,ST_7036,TTL_7037) in
                                            {7769}out(c, m2_7039);
                                            {7770}let Ksrv_7040: bitstring = exp(PartC_7034,Ns_7035) in
                                            {7771}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7040))
                                        )
                                        else
                                            {7772}let v_7041: bool = (Disco_5610 = B) in
                                            (
                                                {7773}if v_7041 then
                                                (
                                                    {7774}let pkDisco_7042: bitstring = pub(skB) in
                                                    {7775}in(c, (=pkCli_7029,em1_7043: bitstring));
                                                    {7776}let m1_7044: bitstring = em1_7043 in
                                                    {7777}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7045: bitstring) = m1_7044 in
                                                    {7778}new Ns_7046: bitstring;
                                                    {7779}new ST_7047: bitstring;
                                                    {7780}new TTL_7048: bitstring;
                                                    {7781}let gNs_7049: bitstring = exp(g,Ns_7046) in
                                                    {7782}let m2_7050: bitstring = (OpenSecureChannelResponse,gNs_7049,ST_7047,TTL_7048) in
                                                    {7783}out(c, m2_7050);
                                                    {7784}let Ksrv_7051: bitstring = exp(PartC_7045,Ns_7046) in
                                                    {7785}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7051))
                                                )
                                                else
                                                    {7786}let v_7052: bool = (Disco_5610 = C) in
                                                    (
                                                        {7787}if v_7052 then
                                                        (
                                                            {7788}let pkDisco_7053: bitstring = pub(skC) in
                                                            {7789}in(c, (=pkCli_7029,em1_7054: bitstring));
                                                            {7790}let m1_7055: bitstring = em1_7054 in
                                                            {7791}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7056: bitstring) = m1_7055 in
                                                            {7792}new Ns_7057: bitstring;
                                                            {7793}new ST_7058: bitstring;
                                                            {7794}new TTL_7059: bitstring;
                                                            {7795}let gNs_7060: bitstring = exp(g,Ns_7057) in
                                                            {7796}let m2_7061: bitstring = (OpenSecureChannelResponse,gNs_7060,ST_7058,TTL_7059) in
                                                            {7797}out(c, m2_7061);
                                                            {7798}let Ksrv_7062: bitstring = exp(PartC_7056,Ns_7057) in
                                                            {7799}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7062))
                                                        )
                                                        else
                                                            {7800}let pkDisco_7063: bitstring = pub(sk(Disco_5610)) in
                                                            {7801}in(c, (=pkCli_7029,em1_7064: bitstring));
                                                            {7802}let m1_7065: bitstring = em1_7064 in
                                                            {7803}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7066: bitstring) = m1_7065 in
                                                            {7804}new Ns_7067: bitstring;
                                                            {7805}new ST_7068: bitstring;
                                                            {7806}new TTL_7069: bitstring;
                                                            {7807}let gNs_7070: bitstring = exp(g,Ns_7067) in
                                                            {7808}let m2_7071: bitstring = (OpenSecureChannelResponse,gNs_7070,ST_7068,TTL_7069) in
                                                            {7809}out(c, m2_7071);
                                                            {7810}let Ksrv_7072: bitstring = exp(PartC_7066,Ns_7067) in
                                                            {7811}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7072))
                                                    )
                                                    else
                                                        {7812}let pkDisco_7073: bitstring = fail-any in
                                                        {7813}in(c, (=pkCli_7029,em1_7074: bitstring));
                                                        {7814}let m1_7075: bitstring = em1_7074 in
                                                        {7815}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7076: bitstring) = m1_7075 in
                                                        {7816}new Ns_7077: bitstring;
                                                        {7817}new ST_7078: bitstring;
                                                        {7818}new TTL_7079: bitstring;
                                                        {7819}let gNs_7080: bitstring = exp(g,Ns_7077) in
                                                        {7820}let m2_7081: bitstring = (OpenSecureChannelResponse,gNs_7080,ST_7078,TTL_7079) in
                                                        {7821}out(c, m2_7081);
                                                        {7822}let Ksrv_7082: bitstring = exp(PartC_7076,Ns_7077) in
                                                        {7823}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7082))
                                            )
                                            else
                                                {7824}let pkDisco_7083: bitstring = fail-any in
                                                {7825}in(c, (=pkCli_7029,em1_7084: bitstring));
                                                {7826}let m1_7085: bitstring = em1_7084 in
                                                {7827}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7086: bitstring) = m1_7085 in
                                                {7828}new Ns_7087: bitstring;
                                                {7829}new ST_7088: bitstring;
                                                {7830}new TTL_7089: bitstring;
                                                {7831}let gNs_7090: bitstring = exp(g,Ns_7087) in
                                                {7832}let m2_7091: bitstring = (OpenSecureChannelResponse,gNs_7090,ST_7088,TTL_7089) in
                                                {7833}out(c, m2_7091);
                                                {7834}let Ksrv_7092: bitstring = exp(PartC_7086,Ns_7087) in
                                                {7835}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7092))
                                    )
                                    else
                                        {7836}let pkDisco_7093: bitstring = fail-any in
                                        {7837}in(c, (=pkCli_7029,em1_7094: bitstring));
                                        {7838}let m1_7095: bitstring = em1_7094 in
                                        {7839}let (=OpenSecureChannelRequest,=pkCli_7029,PartC_7096: bitstring) = m1_7095 in
                                        {7840}new Ns_7097: bitstring;
                                        {7841}new ST_7098: bitstring;
                                        {7842}new TTL_7099: bitstring;
                                        {7843}let gNs_7100: bitstring = exp(g,Ns_7097) in
                                        {7844}let m2_7101: bitstring = (OpenSecureChannelResponse,gNs_7100,ST_7098,TTL_7099) in
                                        {7845}out(c, m2_7101);
                                        {7846}let Ksrv_7102: bitstring = exp(PartC_7096,Ns_7097) in
                                        {7847}out(c, senc(mSrv(pkCli_7029,pkSess_6655),Ksrv_7102))
                        )
                        else
                            {7848}let pkCli_7103: bitstring = fail-any in
                            {7849}let v_7104: bool = (Disco_5610 = A) in
                            (
                                {7850}if v_7104 then
                                (
                                    {7851}let pkDisco_7105: bitstring = pub(skA) in
                                    {7852}in(c, (=pkCli_7103,em1_7106: bitstring));
                                    {7853}let m1_7107: bitstring = em1_7106 in
                                    {7854}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7108: bitstring) = m1_7107 in
                                    {7855}new Ns_7109: bitstring;
                                    {7856}new ST_7110: bitstring;
                                    {7857}new TTL_7111: bitstring;
                                    {7858}let gNs_7112: bitstring = exp(g,Ns_7109) in
                                    {7859}let m2_7113: bitstring = (OpenSecureChannelResponse,gNs_7112,ST_7110,TTL_7111) in
                                    {7860}out(c, m2_7113);
                                    {7861}let Ksrv_7114: bitstring = exp(PartC_7108,Ns_7109) in
                                    {7862}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7114))
                                )
                                else
                                    {7863}let v_7115: bool = (Disco_5610 = B) in
                                    (
                                        {7864}if v_7115 then
                                        (
                                            {7865}let pkDisco_7116: bitstring = pub(skB) in
                                            {7866}in(c, (=pkCli_7103,em1_7117: bitstring));
                                            {7867}let m1_7118: bitstring = em1_7117 in
                                            {7868}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7119: bitstring) = m1_7118 in
                                            {7869}new Ns_7120: bitstring;
                                            {7870}new ST_7121: bitstring;
                                            {7871}new TTL_7122: bitstring;
                                            {7872}let gNs_7123: bitstring = exp(g,Ns_7120) in
                                            {7873}let m2_7124: bitstring = (OpenSecureChannelResponse,gNs_7123,ST_7121,TTL_7122) in
                                            {7874}out(c, m2_7124);
                                            {7875}let Ksrv_7125: bitstring = exp(PartC_7119,Ns_7120) in
                                            {7876}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7125))
                                        )
                                        else
                                            {7877}let v_7126: bool = (Disco_5610 = C) in
                                            (
                                                {7878}if v_7126 then
                                                (
                                                    {7879}let pkDisco_7127: bitstring = pub(skC) in
                                                    {7880}in(c, (=pkCli_7103,em1_7128: bitstring));
                                                    {7881}let m1_7129: bitstring = em1_7128 in
                                                    {7882}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7130: bitstring) = m1_7129 in
                                                    {7883}new Ns_7131: bitstring;
                                                    {7884}new ST_7132: bitstring;
                                                    {7885}new TTL_7133: bitstring;
                                                    {7886}let gNs_7134: bitstring = exp(g,Ns_7131) in
                                                    {7887}let m2_7135: bitstring = (OpenSecureChannelResponse,gNs_7134,ST_7132,TTL_7133) in
                                                    {7888}out(c, m2_7135);
                                                    {7889}let Ksrv_7136: bitstring = exp(PartC_7130,Ns_7131) in
                                                    {7890}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7136))
                                                )
                                                else
                                                    {7891}let pkDisco_7137: bitstring = pub(sk(Disco_5610)) in
                                                    {7892}in(c, (=pkCli_7103,em1_7138: bitstring));
                                                    {7893}let m1_7139: bitstring = em1_7138 in
                                                    {7894}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7140: bitstring) = m1_7139 in
                                                    {7895}new Ns_7141: bitstring;
                                                    {7896}new ST_7142: bitstring;
                                                    {7897}new TTL_7143: bitstring;
                                                    {7898}let gNs_7144: bitstring = exp(g,Ns_7141) in
                                                    {7899}let m2_7145: bitstring = (OpenSecureChannelResponse,gNs_7144,ST_7142,TTL_7143) in
                                                    {7900}out(c, m2_7145);
                                                    {7901}let Ksrv_7146: bitstring = exp(PartC_7140,Ns_7141) in
                                                    {7902}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7146))
                                            )
                                            else
                                                {7903}let pkDisco_7147: bitstring = fail-any in
                                                {7904}in(c, (=pkCli_7103,em1_7148: bitstring));
                                                {7905}let m1_7149: bitstring = em1_7148 in
                                                {7906}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7150: bitstring) = m1_7149 in
                                                {7907}new Ns_7151: bitstring;
                                                {7908}new ST_7152: bitstring;
                                                {7909}new TTL_7153: bitstring;
                                                {7910}let gNs_7154: bitstring = exp(g,Ns_7151) in
                                                {7911}let m2_7155: bitstring = (OpenSecureChannelResponse,gNs_7154,ST_7152,TTL_7153) in
                                                {7912}out(c, m2_7155);
                                                {7913}let Ksrv_7156: bitstring = exp(PartC_7150,Ns_7151) in
                                                {7914}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7156))
                                    )
                                    else
                                        {7915}let pkDisco_7157: bitstring = fail-any in
                                        {7916}in(c, (=pkCli_7103,em1_7158: bitstring));
                                        {7917}let m1_7159: bitstring = em1_7158 in
                                        {7918}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7160: bitstring) = m1_7159 in
                                        {7919}new Ns_7161: bitstring;
                                        {7920}new ST_7162: bitstring;
                                        {7921}new TTL_7163: bitstring;
                                        {7922}let gNs_7164: bitstring = exp(g,Ns_7161) in
                                        {7923}let m2_7165: bitstring = (OpenSecureChannelResponse,gNs_7164,ST_7162,TTL_7163) in
                                        {7924}out(c, m2_7165);
                                        {7925}let Ksrv_7166: bitstring = exp(PartC_7160,Ns_7161) in
                                        {7926}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7166))
                            )
                            else
                                {7927}let pkDisco_7167: bitstring = fail-any in
                                {7928}in(c, (=pkCli_7103,em1_7168: bitstring));
                                {7929}let m1_7169: bitstring = em1_7168 in
                                {7930}let (=OpenSecureChannelRequest,=pkCli_7103,PartC_7170: bitstring) = m1_7169 in
                                {7931}new Ns_7171: bitstring;
                                {7932}new ST_7172: bitstring;
                                {7933}new TTL_7173: bitstring;
                                {7934}let gNs_7174: bitstring = exp(g,Ns_7171) in
                                {7935}let m2_7175: bitstring = (OpenSecureChannelResponse,gNs_7174,ST_7172,TTL_7173) in
                                {7936}out(c, m2_7175);
                                {7937}let Ksrv_7176: bitstring = exp(PartC_7170,Ns_7171) in
                                {7938}out(c, senc(mSrv(pkCli_7103,pkSess_6655),Ksrv_7176))
                    )
                    else
                        {7939}let skSess_7177: bitstring = fail-any in
                        {7940}let pkSess_7178: bitstring = pub(skSess_7177) in
                        {7941}let v_7179: bool = (Cli_5609 = A) in
                        (
                            {7942}if v_7179 then
                            (
                                {7943}let pkCli_7180: bitstring = pub(skA) in
                                {7944}let v_7181: bool = (Disco_5610 = A) in
                                (
                                    {7945}if v_7181 then
                                    (
                                        {7946}let pkDisco_7182: bitstring = pub(skA) in
                                        {7947}in(c, (=pkCli_7180,em1_7183: bitstring));
                                        {7948}let m1_7184: bitstring = em1_7183 in
                                        {7949}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7185: bitstring) = m1_7184 in
                                        {7950}new Ns_7186: bitstring;
                                        {7951}new ST_7187: bitstring;
                                        {7952}new TTL_7188: bitstring;
                                        {7953}let gNs_7189: bitstring = exp(g,Ns_7186) in
                                        {7954}let m2_7190: bitstring = (OpenSecureChannelResponse,gNs_7189,ST_7187,TTL_7188) in
                                        {7955}out(c, m2_7190);
                                        {7956}let Ksrv_7191: bitstring = exp(PartC_7185,Ns_7186) in
                                        {7957}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7191))
                                    )
                                    else
                                        {7958}let v_7192: bool = (Disco_5610 = B) in
                                        (
                                            {7959}if v_7192 then
                                            (
                                                {7960}let pkDisco_7193: bitstring = pub(skB) in
                                                {7961}in(c, (=pkCli_7180,em1_7194: bitstring));
                                                {7962}let m1_7195: bitstring = em1_7194 in
                                                {7963}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7196: bitstring) = m1_7195 in
                                                {7964}new Ns_7197: bitstring;
                                                {7965}new ST_7198: bitstring;
                                                {7966}new TTL_7199: bitstring;
                                                {7967}let gNs_7200: bitstring = exp(g,Ns_7197) in
                                                {7968}let m2_7201: bitstring = (OpenSecureChannelResponse,gNs_7200,ST_7198,TTL_7199) in
                                                {7969}out(c, m2_7201);
                                                {7970}let Ksrv_7202: bitstring = exp(PartC_7196,Ns_7197) in
                                                {7971}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7202))
                                            )
                                            else
                                                {7972}let v_7203: bool = (Disco_5610 = C) in
                                                (
                                                    {7973}if v_7203 then
                                                    (
                                                        {7974}let pkDisco_7204: bitstring = pub(skC) in
                                                        {7975}in(c, (=pkCli_7180,em1_7205: bitstring));
                                                        {7976}let m1_7206: bitstring = em1_7205 in
                                                        {7977}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7207: bitstring) = m1_7206 in
                                                        {7978}new Ns_7208: bitstring;
                                                        {7979}new ST_7209: bitstring;
                                                        {7980}new TTL_7210: bitstring;
                                                        {7981}let gNs_7211: bitstring = exp(g,Ns_7208) in
                                                        {7982}let m2_7212: bitstring = (OpenSecureChannelResponse,gNs_7211,ST_7209,TTL_7210) in
                                                        {7983}out(c, m2_7212);
                                                        {7984}let Ksrv_7213: bitstring = exp(PartC_7207,Ns_7208) in
                                                        {7985}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7213))
                                                    )
                                                    else
                                                        {7986}let pkDisco_7214: bitstring = pub(sk(Disco_5610)) in
                                                        {7987}in(c, (=pkCli_7180,em1_7215: bitstring));
                                                        {7988}let m1_7216: bitstring = em1_7215 in
                                                        {7989}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7217: bitstring) = m1_7216 in
                                                        {7990}new Ns_7218: bitstring;
                                                        {7991}new ST_7219: bitstring;
                                                        {7992}new TTL_7220: bitstring;
                                                        {7993}let gNs_7221: bitstring = exp(g,Ns_7218) in
                                                        {7994}let m2_7222: bitstring = (OpenSecureChannelResponse,gNs_7221,ST_7219,TTL_7220) in
                                                        {7995}out(c, m2_7222);
                                                        {7996}let Ksrv_7223: bitstring = exp(PartC_7217,Ns_7218) in
                                                        {7997}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7223))
                                                )
                                                else
                                                    {7998}let pkDisco_7224: bitstring = fail-any in
                                                    {7999}in(c, (=pkCli_7180,em1_7225: bitstring));
                                                    {8000}let m1_7226: bitstring = em1_7225 in
                                                    {8001}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7227: bitstring) = m1_7226 in
                                                    {8002}new Ns_7228: bitstring;
                                                    {8003}new ST_7229: bitstring;
                                                    {8004}new TTL_7230: bitstring;
                                                    {8005}let gNs_7231: bitstring = exp(g,Ns_7228) in
                                                    {8006}let m2_7232: bitstring = (OpenSecureChannelResponse,gNs_7231,ST_7229,TTL_7230) in
                                                    {8007}out(c, m2_7232);
                                                    {8008}let Ksrv_7233: bitstring = exp(PartC_7227,Ns_7228) in
                                                    {8009}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7233))
                                        )
                                        else
                                            {8010}let pkDisco_7234: bitstring = fail-any in
                                            {8011}in(c, (=pkCli_7180,em1_7235: bitstring));
                                            {8012}let m1_7236: bitstring = em1_7235 in
                                            {8013}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7237: bitstring) = m1_7236 in
                                            {8014}new Ns_7238: bitstring;
                                            {8015}new ST_7239: bitstring;
                                            {8016}new TTL_7240: bitstring;
                                            {8017}let gNs_7241: bitstring = exp(g,Ns_7238) in
                                            {8018}let m2_7242: bitstring = (OpenSecureChannelResponse,gNs_7241,ST_7239,TTL_7240) in
                                            {8019}out(c, m2_7242);
                                            {8020}let Ksrv_7243: bitstring = exp(PartC_7237,Ns_7238) in
                                            {8021}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7243))
                                )
                                else
                                    {8022}let pkDisco_7244: bitstring = fail-any in
                                    {8023}in(c, (=pkCli_7180,em1_7245: bitstring));
                                    {8024}let m1_7246: bitstring = em1_7245 in
                                    {8025}let (=OpenSecureChannelRequest,=pkCli_7180,PartC_7247: bitstring) = m1_7246 in
                                    {8026}new Ns_7248: bitstring;
                                    {8027}new ST_7249: bitstring;
                                    {8028}new TTL_7250: bitstring;
                                    {8029}let gNs_7251: bitstring = exp(g,Ns_7248) in
                                    {8030}let m2_7252: bitstring = (OpenSecureChannelResponse,gNs_7251,ST_7249,TTL_7250) in
                                    {8031}out(c, m2_7252);
                                    {8032}let Ksrv_7253: bitstring = exp(PartC_7247,Ns_7248) in
                                    {8033}out(c, senc(mSrv(pkCli_7180,pkSess_7178),Ksrv_7253))
                            )
                            else
                                {8034}let v_7254: bool = (Cli_5609 = B) in
                                (
                                    {8035}if v_7254 then
                                    (
                                        {8036}let pkCli_7255: bitstring = pub(skB) in
                                        {8037}let v_7256: bool = (Disco_5610 = A) in
                                        (
                                            {8038}if v_7256 then
                                            (
                                                {8039}let pkDisco_7257: bitstring = pub(skA) in
                                                {8040}in(c, (=pkCli_7255,em1_7258: bitstring));
                                                {8041}let m1_7259: bitstring = em1_7258 in
                                                {8042}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7260: bitstring) = m1_7259 in
                                                {8043}new Ns_7261: bitstring;
                                                {8044}new ST_7262: bitstring;
                                                {8045}new TTL_7263: bitstring;
                                                {8046}let gNs_7264: bitstring = exp(g,Ns_7261) in
                                                {8047}let m2_7265: bitstring = (OpenSecureChannelResponse,gNs_7264,ST_7262,TTL_7263) in
                                                {8048}out(c, m2_7265);
                                                {8049}let Ksrv_7266: bitstring = exp(PartC_7260,Ns_7261) in
                                                {8050}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7266))
                                            )
                                            else
                                                {8051}let v_7267: bool = (Disco_5610 = B) in
                                                (
                                                    {8052}if v_7267 then
                                                    (
                                                        {8053}let pkDisco_7268: bitstring = pub(skB) in
                                                        {8054}in(c, (=pkCli_7255,em1_7269: bitstring));
                                                        {8055}let m1_7270: bitstring = em1_7269 in
                                                        {8056}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7271: bitstring) = m1_7270 in
                                                        {8057}new Ns_7272: bitstring;
                                                        {8058}new ST_7273: bitstring;
                                                        {8059}new TTL_7274: bitstring;
                                                        {8060}let gNs_7275: bitstring = exp(g,Ns_7272) in
                                                        {8061}let m2_7276: bitstring = (OpenSecureChannelResponse,gNs_7275,ST_7273,TTL_7274) in
                                                        {8062}out(c, m2_7276);
                                                        {8063}let Ksrv_7277: bitstring = exp(PartC_7271,Ns_7272) in
                                                        {8064}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7277))
                                                    )
                                                    else
                                                        {8065}let v_7278: bool = (Disco_5610 = C) in
                                                        (
                                                            {8066}if v_7278 then
                                                            (
                                                                {8067}let pkDisco_7279: bitstring = pub(skC) in
                                                                {8068}in(c, (=pkCli_7255,em1_7280: bitstring));
                                                                {8069}let m1_7281: bitstring = em1_7280 in
                                                                {8070}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7282: bitstring) = m1_7281 in
                                                                {8071}new Ns_7283: bitstring;
                                                                {8072}new ST_7284: bitstring;
                                                                {8073}new TTL_7285: bitstring;
                                                                {8074}let gNs_7286: bitstring = exp(g,Ns_7283) in
                                                                {8075}let m2_7287: bitstring = (OpenSecureChannelResponse,gNs_7286,ST_7284,TTL_7285) in
                                                                {8076}out(c, m2_7287);
                                                                {8077}let Ksrv_7288: bitstring = exp(PartC_7282,Ns_7283) in
                                                                {8078}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7288))
                                                            )
                                                            else
                                                                {8079}let pkDisco_7289: bitstring = pub(sk(Disco_5610)) in
                                                                {8080}in(c, (=pkCli_7255,em1_7290: bitstring));
                                                                {8081}let m1_7291: bitstring = em1_7290 in
                                                                {8082}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7292: bitstring) = m1_7291 in
                                                                {8083}new Ns_7293: bitstring;
                                                                {8084}new ST_7294: bitstring;
                                                                {8085}new TTL_7295: bitstring;
                                                                {8086}let gNs_7296: bitstring = exp(g,Ns_7293) in
                                                                {8087}let m2_7297: bitstring = (OpenSecureChannelResponse,gNs_7296,ST_7294,TTL_7295) in
                                                                {8088}out(c, m2_7297);
                                                                {8089}let Ksrv_7298: bitstring = exp(PartC_7292,Ns_7293) in
                                                                {8090}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7298))
                                                        )
                                                        else
                                                            {8091}let pkDisco_7299: bitstring = fail-any in
                                                            {8092}in(c, (=pkCli_7255,em1_7300: bitstring));
                                                            {8093}let m1_7301: bitstring = em1_7300 in
                                                            {8094}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7302: bitstring) = m1_7301 in
                                                            {8095}new Ns_7303: bitstring;
                                                            {8096}new ST_7304: bitstring;
                                                            {8097}new TTL_7305: bitstring;
                                                            {8098}let gNs_7306: bitstring = exp(g,Ns_7303) in
                                                            {8099}let m2_7307: bitstring = (OpenSecureChannelResponse,gNs_7306,ST_7304,TTL_7305) in
                                                            {8100}out(c, m2_7307);
                                                            {8101}let Ksrv_7308: bitstring = exp(PartC_7302,Ns_7303) in
                                                            {8102}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7308))
                                                )
                                                else
                                                    {8103}let pkDisco_7309: bitstring = fail-any in
                                                    {8104}in(c, (=pkCli_7255,em1_7310: bitstring));
                                                    {8105}let m1_7311: bitstring = em1_7310 in
                                                    {8106}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7312: bitstring) = m1_7311 in
                                                    {8107}new Ns_7313: bitstring;
                                                    {8108}new ST_7314: bitstring;
                                                    {8109}new TTL_7315: bitstring;
                                                    {8110}let gNs_7316: bitstring = exp(g,Ns_7313) in
                                                    {8111}let m2_7317: bitstring = (OpenSecureChannelResponse,gNs_7316,ST_7314,TTL_7315) in
                                                    {8112}out(c, m2_7317);
                                                    {8113}let Ksrv_7318: bitstring = exp(PartC_7312,Ns_7313) in
                                                    {8114}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7318))
                                        )
                                        else
                                            {8115}let pkDisco_7319: bitstring = fail-any in
                                            {8116}in(c, (=pkCli_7255,em1_7320: bitstring));
                                            {8117}let m1_7321: bitstring = em1_7320 in
                                            {8118}let (=OpenSecureChannelRequest,=pkCli_7255,PartC_7322: bitstring) = m1_7321 in
                                            {8119}new Ns_7323: bitstring;
                                            {8120}new ST_7324: bitstring;
                                            {8121}new TTL_7325: bitstring;
                                            {8122}let gNs_7326: bitstring = exp(g,Ns_7323) in
                                            {8123}let m2_7327: bitstring = (OpenSecureChannelResponse,gNs_7326,ST_7324,TTL_7325) in
                                            {8124}out(c, m2_7327);
                                            {8125}let Ksrv_7328: bitstring = exp(PartC_7322,Ns_7323) in
                                            {8126}out(c, senc(mSrv(pkCli_7255,pkSess_7178),Ksrv_7328))
                                    )
                                    else
                                        {8127}let v_7329: bool = (Cli_5609 = C) in
                                        (
                                            {8128}if v_7329 then
                                            (
                                                {8129}let pkCli_7330: bitstring = pub(skC) in
                                                {8130}let v_7331: bool = (Disco_5610 = A) in
                                                (
                                                    {8131}if v_7331 then
                                                    (
                                                        {8132}let pkDisco_7332: bitstring = pub(skA) in
                                                        {8133}in(c, (=pkCli_7330,em1_7333: bitstring));
                                                        {8134}let m1_7334: bitstring = em1_7333 in
                                                        {8135}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7335: bitstring) = m1_7334 in
                                                        {8136}new Ns_7336: bitstring;
                                                        {8137}new ST_7337: bitstring;
                                                        {8138}new TTL_7338: bitstring;
                                                        {8139}let gNs_7339: bitstring = exp(g,Ns_7336) in
                                                        {8140}let m2_7340: bitstring = (OpenSecureChannelResponse,gNs_7339,ST_7337,TTL_7338) in
                                                        {8141}out(c, m2_7340);
                                                        {8142}let Ksrv_7341: bitstring = exp(PartC_7335,Ns_7336) in
                                                        {8143}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7341))
                                                    )
                                                    else
                                                        {8144}let v_7342: bool = (Disco_5610 = B) in
                                                        (
                                                            {8145}if v_7342 then
                                                            (
                                                                {8146}let pkDisco_7343: bitstring = pub(skB) in
                                                                {8147}in(c, (=pkCli_7330,em1_7344: bitstring));
                                                                {8148}let m1_7345: bitstring = em1_7344 in
                                                                {8149}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7346: bitstring) = m1_7345 in
                                                                {8150}new Ns_7347: bitstring;
                                                                {8151}new ST_7348: bitstring;
                                                                {8152}new TTL_7349: bitstring;
                                                                {8153}let gNs_7350: bitstring = exp(g,Ns_7347) in
                                                                {8154}let m2_7351: bitstring = (OpenSecureChannelResponse,gNs_7350,ST_7348,TTL_7349) in
                                                                {8155}out(c, m2_7351);
                                                                {8156}let Ksrv_7352: bitstring = exp(PartC_7346,Ns_7347) in
                                                                {8157}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7352))
                                                            )
                                                            else
                                                                {8158}let v_7353: bool = (Disco_5610 = C) in
                                                                (
                                                                    {8159}if v_7353 then
                                                                    (
                                                                        {8160}let pkDisco_7354: bitstring = pub(skC) in
                                                                        {8161}in(c, (=pkCli_7330,em1_7355: bitstring));
                                                                        {8162}let m1_7356: bitstring = em1_7355 in
                                                                        {8163}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7357: bitstring) = m1_7356 in
                                                                        {8164}new Ns_7358: bitstring;
                                                                        {8165}new ST_7359: bitstring;
                                                                        {8166}new TTL_7360: bitstring;
                                                                        {8167}let gNs_7361: bitstring = exp(g,Ns_7358) in
                                                                        {8168}let m2_7362: bitstring = (OpenSecureChannelResponse,gNs_7361,ST_7359,TTL_7360) in
                                                                        {8169}out(c, m2_7362);
                                                                        {8170}let Ksrv_7363: bitstring = exp(PartC_7357,Ns_7358) in
                                                                        {8171}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7363))
                                                                    )
                                                                    else
                                                                        {8172}let pkDisco_7364: bitstring = pub(sk(Disco_5610)) in
                                                                        {8173}in(c, (=pkCli_7330,em1_7365: bitstring));
                                                                        {8174}let m1_7366: bitstring = em1_7365 in
                                                                        {8175}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7367: bitstring) = m1_7366 in
                                                                        {8176}new Ns_7368: bitstring;
                                                                        {8177}new ST_7369: bitstring;
                                                                        {8178}new TTL_7370: bitstring;
                                                                        {8179}let gNs_7371: bitstring = exp(g,Ns_7368) in
                                                                        {8180}let m2_7372: bitstring = (OpenSecureChannelResponse,gNs_7371,ST_7369,TTL_7370) in
                                                                        {8181}out(c, m2_7372);
                                                                        {8182}let Ksrv_7373: bitstring = exp(PartC_7367,Ns_7368) in
                                                                        {8183}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7373))
                                                                )
                                                                else
                                                                    {8184}let pkDisco_7374: bitstring = fail-any in
                                                                    {8185}in(c, (=pkCli_7330,em1_7375: bitstring));
                                                                    {8186}let m1_7376: bitstring = em1_7375 in
                                                                    {8187}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7377: bitstring) = m1_7376 in
                                                                    {8188}new Ns_7378: bitstring;
                                                                    {8189}new ST_7379: bitstring;
                                                                    {8190}new TTL_7380: bitstring;
                                                                    {8191}let gNs_7381: bitstring = exp(g,Ns_7378) in
                                                                    {8192}let m2_7382: bitstring = (OpenSecureChannelResponse,gNs_7381,ST_7379,TTL_7380) in
                                                                    {8193}out(c, m2_7382);
                                                                    {8194}let Ksrv_7383: bitstring = exp(PartC_7377,Ns_7378) in
                                                                    {8195}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7383))
                                                        )
                                                        else
                                                            {8196}let pkDisco_7384: bitstring = fail-any in
                                                            {8197}in(c, (=pkCli_7330,em1_7385: bitstring));
                                                            {8198}let m1_7386: bitstring = em1_7385 in
                                                            {8199}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7387: bitstring) = m1_7386 in
                                                            {8200}new Ns_7388: bitstring;
                                                            {8201}new ST_7389: bitstring;
                                                            {8202}new TTL_7390: bitstring;
                                                            {8203}let gNs_7391: bitstring = exp(g,Ns_7388) in
                                                            {8204}let m2_7392: bitstring = (OpenSecureChannelResponse,gNs_7391,ST_7389,TTL_7390) in
                                                            {8205}out(c, m2_7392);
                                                            {8206}let Ksrv_7393: bitstring = exp(PartC_7387,Ns_7388) in
                                                            {8207}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7393))
                                                )
                                                else
                                                    {8208}let pkDisco_7394: bitstring = fail-any in
                                                    {8209}in(c, (=pkCli_7330,em1_7395: bitstring));
                                                    {8210}let m1_7396: bitstring = em1_7395 in
                                                    {8211}let (=OpenSecureChannelRequest,=pkCli_7330,PartC_7397: bitstring) = m1_7396 in
                                                    {8212}new Ns_7398: bitstring;
                                                    {8213}new ST_7399: bitstring;
                                                    {8214}new TTL_7400: bitstring;
                                                    {8215}let gNs_7401: bitstring = exp(g,Ns_7398) in
                                                    {8216}let m2_7402: bitstring = (OpenSecureChannelResponse,gNs_7401,ST_7399,TTL_7400) in
                                                    {8217}out(c, m2_7402);
                                                    {8218}let Ksrv_7403: bitstring = exp(PartC_7397,Ns_7398) in
                                                    {8219}out(c, senc(mSrv(pkCli_7330,pkSess_7178),Ksrv_7403))
                                            )
                                            else
                                                {8220}let pkCli_7404: bitstring = pub(sk(Cli_5609)) in
                                                {8221}let v_7405: bool = (Disco_5610 = A) in
                                                (
                                                    {8222}if v_7405 then
                                                    (
                                                        {8223}let pkDisco_7406: bitstring = pub(skA) in
                                                        {8224}in(c, (=pkCli_7404,em1_7407: bitstring));
                                                        {8225}let m1_7408: bitstring = em1_7407 in
                                                        {8226}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7409: bitstring) = m1_7408 in
                                                        {8227}new Ns_7410: bitstring;
                                                        {8228}new ST_7411: bitstring;
                                                        {8229}new TTL_7412: bitstring;
                                                        {8230}let gNs_7413: bitstring = exp(g,Ns_7410) in
                                                        {8231}let m2_7414: bitstring = (OpenSecureChannelResponse,gNs_7413,ST_7411,TTL_7412) in
                                                        {8232}out(c, m2_7414);
                                                        {8233}let Ksrv_7415: bitstring = exp(PartC_7409,Ns_7410) in
                                                        {8234}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7415))
                                                    )
                                                    else
                                                        {8235}let v_7416: bool = (Disco_5610 = B) in
                                                        (
                                                            {8236}if v_7416 then
                                                            (
                                                                {8237}let pkDisco_7417: bitstring = pub(skB) in
                                                                {8238}in(c, (=pkCli_7404,em1_7418: bitstring));
                                                                {8239}let m1_7419: bitstring = em1_7418 in
                                                                {8240}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7420: bitstring) = m1_7419 in
                                                                {8241}new Ns_7421: bitstring;
                                                                {8242}new ST_7422: bitstring;
                                                                {8243}new TTL_7423: bitstring;
                                                                {8244}let gNs_7424: bitstring = exp(g,Ns_7421) in
                                                                {8245}let m2_7425: bitstring = (OpenSecureChannelResponse,gNs_7424,ST_7422,TTL_7423) in
                                                                {8246}out(c, m2_7425);
                                                                {8247}let Ksrv_7426: bitstring = exp(PartC_7420,Ns_7421) in
                                                                {8248}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7426))
                                                            )
                                                            else
                                                                {8249}let v_7427: bool = (Disco_5610 = C) in
                                                                (
                                                                    {8250}if v_7427 then
                                                                    (
                                                                        {8251}let pkDisco_7428: bitstring = pub(skC) in
                                                                        {8252}in(c, (=pkCli_7404,em1_7429: bitstring));
                                                                        {8253}let m1_7430: bitstring = em1_7429 in
                                                                        {8254}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7431: bitstring) = m1_7430 in
                                                                        {8255}new Ns_7432: bitstring;
                                                                        {8256}new ST_7433: bitstring;
                                                                        {8257}new TTL_7434: bitstring;
                                                                        {8258}let gNs_7435: bitstring = exp(g,Ns_7432) in
                                                                        {8259}let m2_7436: bitstring = (OpenSecureChannelResponse,gNs_7435,ST_7433,TTL_7434) in
                                                                        {8260}out(c, m2_7436);
                                                                        {8261}let Ksrv_7437: bitstring = exp(PartC_7431,Ns_7432) in
                                                                        {8262}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7437))
                                                                    )
                                                                    else
                                                                        {8263}let pkDisco_7438: bitstring = pub(sk(Disco_5610)) in
                                                                        {8264}in(c, (=pkCli_7404,em1_7439: bitstring));
                                                                        {8265}let m1_7440: bitstring = em1_7439 in
                                                                        {8266}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7441: bitstring) = m1_7440 in
                                                                        {8267}new Ns_7442: bitstring;
                                                                        {8268}new ST_7443: bitstring;
                                                                        {8269}new TTL_7444: bitstring;
                                                                        {8270}let gNs_7445: bitstring = exp(g,Ns_7442) in
                                                                        {8271}let m2_7446: bitstring = (OpenSecureChannelResponse,gNs_7445,ST_7443,TTL_7444) in
                                                                        {8272}out(c, m2_7446);
                                                                        {8273}let Ksrv_7447: bitstring = exp(PartC_7441,Ns_7442) in
                                                                        {8274}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7447))
                                                                )
                                                                else
                                                                    {8275}let pkDisco_7448: bitstring = fail-any in
                                                                    {8276}in(c, (=pkCli_7404,em1_7449: bitstring));
                                                                    {8277}let m1_7450: bitstring = em1_7449 in
                                                                    {8278}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7451: bitstring) = m1_7450 in
                                                                    {8279}new Ns_7452: bitstring;
                                                                    {8280}new ST_7453: bitstring;
                                                                    {8281}new TTL_7454: bitstring;
                                                                    {8282}let gNs_7455: bitstring = exp(g,Ns_7452) in
                                                                    {8283}let m2_7456: bitstring = (OpenSecureChannelResponse,gNs_7455,ST_7453,TTL_7454) in
                                                                    {8284}out(c, m2_7456);
                                                                    {8285}let Ksrv_7457: bitstring = exp(PartC_7451,Ns_7452) in
                                                                    {8286}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7457))
                                                        )
                                                        else
                                                            {8287}let pkDisco_7458: bitstring = fail-any in
                                                            {8288}in(c, (=pkCli_7404,em1_7459: bitstring));
                                                            {8289}let m1_7460: bitstring = em1_7459 in
                                                            {8290}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7461: bitstring) = m1_7460 in
                                                            {8291}new Ns_7462: bitstring;
                                                            {8292}new ST_7463: bitstring;
                                                            {8293}new TTL_7464: bitstring;
                                                            {8294}let gNs_7465: bitstring = exp(g,Ns_7462) in
                                                            {8295}let m2_7466: bitstring = (OpenSecureChannelResponse,gNs_7465,ST_7463,TTL_7464) in
                                                            {8296}out(c, m2_7466);
                                                            {8297}let Ksrv_7467: bitstring = exp(PartC_7461,Ns_7462) in
                                                            {8298}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7467))
                                                )
                                                else
                                                    {8299}let pkDisco_7468: bitstring = fail-any in
                                                    {8300}in(c, (=pkCli_7404,em1_7469: bitstring));
                                                    {8301}let m1_7470: bitstring = em1_7469 in
                                                    {8302}let (=OpenSecureChannelRequest,=pkCli_7404,PartC_7471: bitstring) = m1_7470 in
                                                    {8303}new Ns_7472: bitstring;
                                                    {8304}new ST_7473: bitstring;
                                                    {8305}new TTL_7474: bitstring;
                                                    {8306}let gNs_7475: bitstring = exp(g,Ns_7472) in
                                                    {8307}let m2_7476: bitstring = (OpenSecureChannelResponse,gNs_7475,ST_7473,TTL_7474) in
                                                    {8308}out(c, m2_7476);
                                                    {8309}let Ksrv_7477: bitstring = exp(PartC_7471,Ns_7472) in
                                                    {8310}out(c, senc(mSrv(pkCli_7404,pkSess_7178),Ksrv_7477))
                                        )
                                        else
                                            {8311}let pkCli_7478: bitstring = fail-any in
                                            {8312}let v_7479: bool = (Disco_5610 = A) in
                                            (
                                                {8313}if v_7479 then
                                                (
                                                    {8314}let pkDisco_7480: bitstring = pub(skA) in
                                                    {8315}in(c, (=pkCli_7478,em1_7481: bitstring));
                                                    {8316}let m1_7482: bitstring = em1_7481 in
                                                    {8317}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7483: bitstring) = m1_7482 in
                                                    {8318}new Ns_7484: bitstring;
                                                    {8319}new ST_7485: bitstring;
                                                    {8320}new TTL_7486: bitstring;
                                                    {8321}let gNs_7487: bitstring = exp(g,Ns_7484) in
                                                    {8322}let m2_7488: bitstring = (OpenSecureChannelResponse,gNs_7487,ST_7485,TTL_7486) in
                                                    {8323}out(c, m2_7488);
                                                    {8324}let Ksrv_7489: bitstring = exp(PartC_7483,Ns_7484) in
                                                    {8325}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7489))
                                                )
                                                else
                                                    {8326}let v_7490: bool = (Disco_5610 = B) in
                                                    (
                                                        {8327}if v_7490 then
                                                        (
                                                            {8328}let pkDisco_7491: bitstring = pub(skB) in
                                                            {8329}in(c, (=pkCli_7478,em1_7492: bitstring));
                                                            {8330}let m1_7493: bitstring = em1_7492 in
                                                            {8331}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7494: bitstring) = m1_7493 in
                                                            {8332}new Ns_7495: bitstring;
                                                            {8333}new ST_7496: bitstring;
                                                            {8334}new TTL_7497: bitstring;
                                                            {8335}let gNs_7498: bitstring = exp(g,Ns_7495) in
                                                            {8336}let m2_7499: bitstring = (OpenSecureChannelResponse,gNs_7498,ST_7496,TTL_7497) in
                                                            {8337}out(c, m2_7499);
                                                            {8338}let Ksrv_7500: bitstring = exp(PartC_7494,Ns_7495) in
                                                            {8339}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7500))
                                                        )
                                                        else
                                                            {8340}let v_7501: bool = (Disco_5610 = C) in
                                                            (
                                                                {8341}if v_7501 then
                                                                (
                                                                    {8342}let pkDisco_7502: bitstring = pub(skC) in
                                                                    {8343}in(c, (=pkCli_7478,em1_7503: bitstring));
                                                                    {8344}let m1_7504: bitstring = em1_7503 in
                                                                    {8345}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7505: bitstring) = m1_7504 in
                                                                    {8346}new Ns_7506: bitstring;
                                                                    {8347}new ST_7507: bitstring;
                                                                    {8348}new TTL_7508: bitstring;
                                                                    {8349}let gNs_7509: bitstring = exp(g,Ns_7506) in
                                                                    {8350}let m2_7510: bitstring = (OpenSecureChannelResponse,gNs_7509,ST_7507,TTL_7508) in
                                                                    {8351}out(c, m2_7510);
                                                                    {8352}let Ksrv_7511: bitstring = exp(PartC_7505,Ns_7506) in
                                                                    {8353}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7511))
                                                                )
                                                                else
                                                                    {8354}let pkDisco_7512: bitstring = pub(sk(Disco_5610)) in
                                                                    {8355}in(c, (=pkCli_7478,em1_7513: bitstring));
                                                                    {8356}let m1_7514: bitstring = em1_7513 in
                                                                    {8357}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7515: bitstring) = m1_7514 in
                                                                    {8358}new Ns_7516: bitstring;
                                                                    {8359}new ST_7517: bitstring;
                                                                    {8360}new TTL_7518: bitstring;
                                                                    {8361}let gNs_7519: bitstring = exp(g,Ns_7516) in
                                                                    {8362}let m2_7520: bitstring = (OpenSecureChannelResponse,gNs_7519,ST_7517,TTL_7518) in
                                                                    {8363}out(c, m2_7520);
                                                                    {8364}let Ksrv_7521: bitstring = exp(PartC_7515,Ns_7516) in
                                                                    {8365}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7521))
                                                            )
                                                            else
                                                                {8366}let pkDisco_7522: bitstring = fail-any in
                                                                {8367}in(c, (=pkCli_7478,em1_7523: bitstring));
                                                                {8368}let m1_7524: bitstring = em1_7523 in
                                                                {8369}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7525: bitstring) = m1_7524 in
                                                                {8370}new Ns_7526: bitstring;
                                                                {8371}new ST_7527: bitstring;
                                                                {8372}new TTL_7528: bitstring;
                                                                {8373}let gNs_7529: bitstring = exp(g,Ns_7526) in
                                                                {8374}let m2_7530: bitstring = (OpenSecureChannelResponse,gNs_7529,ST_7527,TTL_7528) in
                                                                {8375}out(c, m2_7530);
                                                                {8376}let Ksrv_7531: bitstring = exp(PartC_7525,Ns_7526) in
                                                                {8377}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7531))
                                                    )
                                                    else
                                                        {8378}let pkDisco_7532: bitstring = fail-any in
                                                        {8379}in(c, (=pkCli_7478,em1_7533: bitstring));
                                                        {8380}let m1_7534: bitstring = em1_7533 in
                                                        {8381}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7535: bitstring) = m1_7534 in
                                                        {8382}new Ns_7536: bitstring;
                                                        {8383}new ST_7537: bitstring;
                                                        {8384}new TTL_7538: bitstring;
                                                        {8385}let gNs_7539: bitstring = exp(g,Ns_7536) in
                                                        {8386}let m2_7540: bitstring = (OpenSecureChannelResponse,gNs_7539,ST_7537,TTL_7538) in
                                                        {8387}out(c, m2_7540);
                                                        {8388}let Ksrv_7541: bitstring = exp(PartC_7535,Ns_7536) in
                                                        {8389}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7541))
                                            )
                                            else
                                                {8390}let pkDisco_7542: bitstring = fail-any in
                                                {8391}in(c, (=pkCli_7478,em1_7543: bitstring));
                                                {8392}let m1_7544: bitstring = em1_7543 in
                                                {8393}let (=OpenSecureChannelRequest,=pkCli_7478,PartC_7545: bitstring) = m1_7544 in
                                                {8394}new Ns_7546: bitstring;
                                                {8395}new ST_7547: bitstring;
                                                {8396}new TTL_7548: bitstring;
                                                {8397}let gNs_7549: bitstring = exp(g,Ns_7546) in
                                                {8398}let m2_7550: bitstring = (OpenSecureChannelResponse,gNs_7549,ST_7547,TTL_7548) in
                                                {8399}out(c, m2_7550);
                                                {8400}let Ksrv_7551: bitstring = exp(PartC_7545,Ns_7546) in
                                                {8401}out(c, senc(mSrv(pkCli_7478,pkSess_7178),Ksrv_7551))
                                )
                                else
                                    {8402}let pkCli_7552: bitstring = fail-any in
                                    {8403}let v_7553: bool = (Disco_5610 = A) in
                                    (
                                        {8404}if v_7553 then
                                        (
                                            {8405}let pkDisco_7554: bitstring = pub(skA) in
                                            {8406}in(c, (=pkCli_7552,em1_7555: bitstring));
                                            {8407}let m1_7556: bitstring = em1_7555 in
                                            {8408}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7557: bitstring) = m1_7556 in
                                            {8409}new Ns_7558: bitstring;
                                            {8410}new ST_7559: bitstring;
                                            {8411}new TTL_7560: bitstring;
                                            {8412}let gNs_7561: bitstring = exp(g,Ns_7558) in
                                            {8413}let m2_7562: bitstring = (OpenSecureChannelResponse,gNs_7561,ST_7559,TTL_7560) in
                                            {8414}out(c, m2_7562);
                                            {8415}let Ksrv_7563: bitstring = exp(PartC_7557,Ns_7558) in
                                            {8416}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7563))
                                        )
                                        else
                                            {8417}let v_7564: bool = (Disco_5610 = B) in
                                            (
                                                {8418}if v_7564 then
                                                (
                                                    {8419}let pkDisco_7565: bitstring = pub(skB) in
                                                    {8420}in(c, (=pkCli_7552,em1_7566: bitstring));
                                                    {8421}let m1_7567: bitstring = em1_7566 in
                                                    {8422}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7568: bitstring) = m1_7567 in
                                                    {8423}new Ns_7569: bitstring;
                                                    {8424}new ST_7570: bitstring;
                                                    {8425}new TTL_7571: bitstring;
                                                    {8426}let gNs_7572: bitstring = exp(g,Ns_7569) in
                                                    {8427}let m2_7573: bitstring = (OpenSecureChannelResponse,gNs_7572,ST_7570,TTL_7571) in
                                                    {8428}out(c, m2_7573);
                                                    {8429}let Ksrv_7574: bitstring = exp(PartC_7568,Ns_7569) in
                                                    {8430}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7574))
                                                )
                                                else
                                                    {8431}let v_7575: bool = (Disco_5610 = C) in
                                                    (
                                                        {8432}if v_7575 then
                                                        (
                                                            {8433}let pkDisco_7576: bitstring = pub(skC) in
                                                            {8434}in(c, (=pkCli_7552,em1_7577: bitstring));
                                                            {8435}let m1_7578: bitstring = em1_7577 in
                                                            {8436}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7579: bitstring) = m1_7578 in
                                                            {8437}new Ns_7580: bitstring;
                                                            {8438}new ST_7581: bitstring;
                                                            {8439}new TTL_7582: bitstring;
                                                            {8440}let gNs_7583: bitstring = exp(g,Ns_7580) in
                                                            {8441}let m2_7584: bitstring = (OpenSecureChannelResponse,gNs_7583,ST_7581,TTL_7582) in
                                                            {8442}out(c, m2_7584);
                                                            {8443}let Ksrv_7585: bitstring = exp(PartC_7579,Ns_7580) in
                                                            {8444}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7585))
                                                        )
                                                        else
                                                            {8445}let pkDisco_7586: bitstring = pub(sk(Disco_5610)) in
                                                            {8446}in(c, (=pkCli_7552,em1_7587: bitstring));
                                                            {8447}let m1_7588: bitstring = em1_7587 in
                                                            {8448}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7589: bitstring) = m1_7588 in
                                                            {8449}new Ns_7590: bitstring;
                                                            {8450}new ST_7591: bitstring;
                                                            {8451}new TTL_7592: bitstring;
                                                            {8452}let gNs_7593: bitstring = exp(g,Ns_7590) in
                                                            {8453}let m2_7594: bitstring = (OpenSecureChannelResponse,gNs_7593,ST_7591,TTL_7592) in
                                                            {8454}out(c, m2_7594);
                                                            {8455}let Ksrv_7595: bitstring = exp(PartC_7589,Ns_7590) in
                                                            {8456}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7595))
                                                    )
                                                    else
                                                        {8457}let pkDisco_7596: bitstring = fail-any in
                                                        {8458}in(c, (=pkCli_7552,em1_7597: bitstring));
                                                        {8459}let m1_7598: bitstring = em1_7597 in
                                                        {8460}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7599: bitstring) = m1_7598 in
                                                        {8461}new Ns_7600: bitstring;
                                                        {8462}new ST_7601: bitstring;
                                                        {8463}new TTL_7602: bitstring;
                                                        {8464}let gNs_7603: bitstring = exp(g,Ns_7600) in
                                                        {8465}let m2_7604: bitstring = (OpenSecureChannelResponse,gNs_7603,ST_7601,TTL_7602) in
                                                        {8466}out(c, m2_7604);
                                                        {8467}let Ksrv_7605: bitstring = exp(PartC_7599,Ns_7600) in
                                                        {8468}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7605))
                                            )
                                            else
                                                {8469}let pkDisco_7606: bitstring = fail-any in
                                                {8470}in(c, (=pkCli_7552,em1_7607: bitstring));
                                                {8471}let m1_7608: bitstring = em1_7607 in
                                                {8472}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7609: bitstring) = m1_7608 in
                                                {8473}new Ns_7610: bitstring;
                                                {8474}new ST_7611: bitstring;
                                                {8475}new TTL_7612: bitstring;
                                                {8476}let gNs_7613: bitstring = exp(g,Ns_7610) in
                                                {8477}let m2_7614: bitstring = (OpenSecureChannelResponse,gNs_7613,ST_7611,TTL_7612) in
                                                {8478}out(c, m2_7614);
                                                {8479}let Ksrv_7615: bitstring = exp(PartC_7609,Ns_7610) in
                                                {8480}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7615))
                                    )
                                    else
                                        {8481}let pkDisco_7616: bitstring = fail-any in
                                        {8482}in(c, (=pkCli_7552,em1_7617: bitstring));
                                        {8483}let m1_7618: bitstring = em1_7617 in
                                        {8484}let (=OpenSecureChannelRequest,=pkCli_7552,PartC_7619: bitstring) = m1_7618 in
                                        {8485}new Ns_7620: bitstring;
                                        {8486}new ST_7621: bitstring;
                                        {8487}new TTL_7622: bitstring;
                                        {8488}let gNs_7623: bitstring = exp(g,Ns_7620) in
                                        {8489}let m2_7624: bitstring = (OpenSecureChannelResponse,gNs_7623,ST_7621,TTL_7622) in
                                        {8490}out(c, m2_7624);
                                        {8491}let Ksrv_7625: bitstring = exp(PartC_7619,Ns_7620) in
                                        {8492}out(c, senc(mSrv(pkCli_7552,pkSess_7178),Ksrv_7625))
                        )
                        else
                            {8493}let pkCli_7626: bitstring = fail-any in
                            {8494}let v_7627: bool = (Disco_5610 = A) in
                            (
                                {8495}if v_7627 then
                                (
                                    {8496}let pkDisco_7628: bitstring = pub(skA) in
                                    {8497}in(c, (=pkCli_7626,em1_7629: bitstring));
                                    {8498}let m1_7630: bitstring = em1_7629 in
                                    {8499}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7631: bitstring) = m1_7630 in
                                    {8500}new Ns_7632: bitstring;
                                    {8501}new ST_7633: bitstring;
                                    {8502}new TTL_7634: bitstring;
                                    {8503}let gNs_7635: bitstring = exp(g,Ns_7632) in
                                    {8504}let m2_7636: bitstring = (OpenSecureChannelResponse,gNs_7635,ST_7633,TTL_7634) in
                                    {8505}out(c, m2_7636);
                                    {8506}let Ksrv_7637: bitstring = exp(PartC_7631,Ns_7632) in
                                    {8507}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7637))
                                )
                                else
                                    {8508}let v_7638: bool = (Disco_5610 = B) in
                                    (
                                        {8509}if v_7638 then
                                        (
                                            {8510}let pkDisco_7639: bitstring = pub(skB) in
                                            {8511}in(c, (=pkCli_7626,em1_7640: bitstring));
                                            {8512}let m1_7641: bitstring = em1_7640 in
                                            {8513}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7642: bitstring) = m1_7641 in
                                            {8514}new Ns_7643: bitstring;
                                            {8515}new ST_7644: bitstring;
                                            {8516}new TTL_7645: bitstring;
                                            {8517}let gNs_7646: bitstring = exp(g,Ns_7643) in
                                            {8518}let m2_7647: bitstring = (OpenSecureChannelResponse,gNs_7646,ST_7644,TTL_7645) in
                                            {8519}out(c, m2_7647);
                                            {8520}let Ksrv_7648: bitstring = exp(PartC_7642,Ns_7643) in
                                            {8521}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7648))
                                        )
                                        else
                                            {8522}let v_7649: bool = (Disco_5610 = C) in
                                            (
                                                {8523}if v_7649 then
                                                (
                                                    {8524}let pkDisco_7650: bitstring = pub(skC) in
                                                    {8525}in(c, (=pkCli_7626,em1_7651: bitstring));
                                                    {8526}let m1_7652: bitstring = em1_7651 in
                                                    {8527}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7653: bitstring) = m1_7652 in
                                                    {8528}new Ns_7654: bitstring;
                                                    {8529}new ST_7655: bitstring;
                                                    {8530}new TTL_7656: bitstring;
                                                    {8531}let gNs_7657: bitstring = exp(g,Ns_7654) in
                                                    {8532}let m2_7658: bitstring = (OpenSecureChannelResponse,gNs_7657,ST_7655,TTL_7656) in
                                                    {8533}out(c, m2_7658);
                                                    {8534}let Ksrv_7659: bitstring = exp(PartC_7653,Ns_7654) in
                                                    {8535}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7659))
                                                )
                                                else
                                                    {8536}let pkDisco_7660: bitstring = pub(sk(Disco_5610)) in
                                                    {8537}in(c, (=pkCli_7626,em1_7661: bitstring));
                                                    {8538}let m1_7662: bitstring = em1_7661 in
                                                    {8539}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7663: bitstring) = m1_7662 in
                                                    {8540}new Ns_7664: bitstring;
                                                    {8541}new ST_7665: bitstring;
                                                    {8542}new TTL_7666: bitstring;
                                                    {8543}let gNs_7667: bitstring = exp(g,Ns_7664) in
                                                    {8544}let m2_7668: bitstring = (OpenSecureChannelResponse,gNs_7667,ST_7665,TTL_7666) in
                                                    {8545}out(c, m2_7668);
                                                    {8546}let Ksrv_7669: bitstring = exp(PartC_7663,Ns_7664) in
                                                    {8547}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7669))
                                            )
                                            else
                                                {8548}let pkDisco_7670: bitstring = fail-any in
                                                {8549}in(c, (=pkCli_7626,em1_7671: bitstring));
                                                {8550}let m1_7672: bitstring = em1_7671 in
                                                {8551}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7673: bitstring) = m1_7672 in
                                                {8552}new Ns_7674: bitstring;
                                                {8553}new ST_7675: bitstring;
                                                {8554}new TTL_7676: bitstring;
                                                {8555}let gNs_7677: bitstring = exp(g,Ns_7674) in
                                                {8556}let m2_7678: bitstring = (OpenSecureChannelResponse,gNs_7677,ST_7675,TTL_7676) in
                                                {8557}out(c, m2_7678);
                                                {8558}let Ksrv_7679: bitstring = exp(PartC_7673,Ns_7674) in
                                                {8559}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7679))
                                    )
                                    else
                                        {8560}let pkDisco_7680: bitstring = fail-any in
                                        {8561}in(c, (=pkCli_7626,em1_7681: bitstring));
                                        {8562}let m1_7682: bitstring = em1_7681 in
                                        {8563}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7683: bitstring) = m1_7682 in
                                        {8564}new Ns_7684: bitstring;
                                        {8565}new ST_7685: bitstring;
                                        {8566}new TTL_7686: bitstring;
                                        {8567}let gNs_7687: bitstring = exp(g,Ns_7684) in
                                        {8568}let m2_7688: bitstring = (OpenSecureChannelResponse,gNs_7687,ST_7685,TTL_7686) in
                                        {8569}out(c, m2_7688);
                                        {8570}let Ksrv_7689: bitstring = exp(PartC_7683,Ns_7684) in
                                        {8571}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7689))
                            )
                            else
                                {8572}let pkDisco_7690: bitstring = fail-any in
                                {8573}in(c, (=pkCli_7626,em1_7691: bitstring));
                                {8574}let m1_7692: bitstring = em1_7691 in
                                {8575}let (=OpenSecureChannelRequest,=pkCli_7626,PartC_7693: bitstring) = m1_7692 in
                                {8576}new Ns_7694: bitstring;
                                {8577}new ST_7695: bitstring;
                                {8578}new TTL_7696: bitstring;
                                {8579}let gNs_7697: bitstring = exp(g,Ns_7694) in
                                {8580}let m2_7698: bitstring = (OpenSecureChannelResponse,gNs_7697,ST_7695,TTL_7696) in
                                {8581}out(c, m2_7698);
                                {8582}let Ksrv_7699: bitstring = exp(PartC_7693,Ns_7694) in
                                {8583}out(c, senc(mSrv(pkCli_7626,pkSess_7178),Ksrv_7699))
            )
            else
                {8584}let skSess_7700: bitstring = fail-any in
                {8585}let pkSess_7701: bitstring = pub(skSess_7700) in
                {8586}let v_7702: bool = (Cli_5609 = A) in
                (
                    {8587}if v_7702 then
                    (
                        {8588}let pkCli_7703: bitstring = pub(skA) in
                        {8589}let v_7704: bool = (Disco_5610 = A) in
                        (
                            {8590}if v_7704 then
                            (
                                {8591}let pkDisco_7705: bitstring = pub(skA) in
                                {8592}in(c, (=pkCli_7703,em1_7706: bitstring));
                                {8593}let m1_7707: bitstring = em1_7706 in
                                {8594}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7708: bitstring) = m1_7707 in
                                {8595}new Ns_7709: bitstring;
                                {8596}new ST_7710: bitstring;
                                {8597}new TTL_7711: bitstring;
                                {8598}let gNs_7712: bitstring = exp(g,Ns_7709) in
                                {8599}let m2_7713: bitstring = (OpenSecureChannelResponse,gNs_7712,ST_7710,TTL_7711) in
                                {8600}out(c, m2_7713);
                                {8601}let Ksrv_7714: bitstring = exp(PartC_7708,Ns_7709) in
                                {8602}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7714))
                            )
                            else
                                {8603}let v_7715: bool = (Disco_5610 = B) in
                                (
                                    {8604}if v_7715 then
                                    (
                                        {8605}let pkDisco_7716: bitstring = pub(skB) in
                                        {8606}in(c, (=pkCli_7703,em1_7717: bitstring));
                                        {8607}let m1_7718: bitstring = em1_7717 in
                                        {8608}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7719: bitstring) = m1_7718 in
                                        {8609}new Ns_7720: bitstring;
                                        {8610}new ST_7721: bitstring;
                                        {8611}new TTL_7722: bitstring;
                                        {8612}let gNs_7723: bitstring = exp(g,Ns_7720) in
                                        {8613}let m2_7724: bitstring = (OpenSecureChannelResponse,gNs_7723,ST_7721,TTL_7722) in
                                        {8614}out(c, m2_7724);
                                        {8615}let Ksrv_7725: bitstring = exp(PartC_7719,Ns_7720) in
                                        {8616}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7725))
                                    )
                                    else
                                        {8617}let v_7726: bool = (Disco_5610 = C) in
                                        (
                                            {8618}if v_7726 then
                                            (
                                                {8619}let pkDisco_7727: bitstring = pub(skC) in
                                                {8620}in(c, (=pkCli_7703,em1_7728: bitstring));
                                                {8621}let m1_7729: bitstring = em1_7728 in
                                                {8622}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7730: bitstring) = m1_7729 in
                                                {8623}new Ns_7731: bitstring;
                                                {8624}new ST_7732: bitstring;
                                                {8625}new TTL_7733: bitstring;
                                                {8626}let gNs_7734: bitstring = exp(g,Ns_7731) in
                                                {8627}let m2_7735: bitstring = (OpenSecureChannelResponse,gNs_7734,ST_7732,TTL_7733) in
                                                {8628}out(c, m2_7735);
                                                {8629}let Ksrv_7736: bitstring = exp(PartC_7730,Ns_7731) in
                                                {8630}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7736))
                                            )
                                            else
                                                {8631}let pkDisco_7737: bitstring = pub(sk(Disco_5610)) in
                                                {8632}in(c, (=pkCli_7703,em1_7738: bitstring));
                                                {8633}let m1_7739: bitstring = em1_7738 in
                                                {8634}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7740: bitstring) = m1_7739 in
                                                {8635}new Ns_7741: bitstring;
                                                {8636}new ST_7742: bitstring;
                                                {8637}new TTL_7743: bitstring;
                                                {8638}let gNs_7744: bitstring = exp(g,Ns_7741) in
                                                {8639}let m2_7745: bitstring = (OpenSecureChannelResponse,gNs_7744,ST_7742,TTL_7743) in
                                                {8640}out(c, m2_7745);
                                                {8641}let Ksrv_7746: bitstring = exp(PartC_7740,Ns_7741) in
                                                {8642}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7746))
                                        )
                                        else
                                            {8643}let pkDisco_7747: bitstring = fail-any in
                                            {8644}in(c, (=pkCli_7703,em1_7748: bitstring));
                                            {8645}let m1_7749: bitstring = em1_7748 in
                                            {8646}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7750: bitstring) = m1_7749 in
                                            {8647}new Ns_7751: bitstring;
                                            {8648}new ST_7752: bitstring;
                                            {8649}new TTL_7753: bitstring;
                                            {8650}let gNs_7754: bitstring = exp(g,Ns_7751) in
                                            {8651}let m2_7755: bitstring = (OpenSecureChannelResponse,gNs_7754,ST_7752,TTL_7753) in
                                            {8652}out(c, m2_7755);
                                            {8653}let Ksrv_7756: bitstring = exp(PartC_7750,Ns_7751) in
                                            {8654}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7756))
                                )
                                else
                                    {8655}let pkDisco_7757: bitstring = fail-any in
                                    {8656}in(c, (=pkCli_7703,em1_7758: bitstring));
                                    {8657}let m1_7759: bitstring = em1_7758 in
                                    {8658}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7760: bitstring) = m1_7759 in
                                    {8659}new Ns_7761: bitstring;
                                    {8660}new ST_7762: bitstring;
                                    {8661}new TTL_7763: bitstring;
                                    {8662}let gNs_7764: bitstring = exp(g,Ns_7761) in
                                    {8663}let m2_7765: bitstring = (OpenSecureChannelResponse,gNs_7764,ST_7762,TTL_7763) in
                                    {8664}out(c, m2_7765);
                                    {8665}let Ksrv_7766: bitstring = exp(PartC_7760,Ns_7761) in
                                    {8666}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7766))
                        )
                        else
                            {8667}let pkDisco_7767: bitstring = fail-any in
                            {8668}in(c, (=pkCli_7703,em1_7768: bitstring));
                            {8669}let m1_7769: bitstring = em1_7768 in
                            {8670}let (=OpenSecureChannelRequest,=pkCli_7703,PartC_7770: bitstring) = m1_7769 in
                            {8671}new Ns_7771: bitstring;
                            {8672}new ST_7772: bitstring;
                            {8673}new TTL_7773: bitstring;
                            {8674}let gNs_7774: bitstring = exp(g,Ns_7771) in
                            {8675}let m2_7775: bitstring = (OpenSecureChannelResponse,gNs_7774,ST_7772,TTL_7773) in
                            {8676}out(c, m2_7775);
                            {8677}let Ksrv_7776: bitstring = exp(PartC_7770,Ns_7771) in
                            {8678}out(c, senc(mSrv(pkCli_7703,pkSess_7701),Ksrv_7776))
                    )
                    else
                        {8679}let v_7777: bool = (Cli_5609 = B) in
                        (
                            {8680}if v_7777 then
                            (
                                {8681}let pkCli_7778: bitstring = pub(skB) in
                                {8682}let v_7779: bool = (Disco_5610 = A) in
                                (
                                    {8683}if v_7779 then
                                    (
                                        {8684}let pkDisco_7780: bitstring = pub(skA) in
                                        {8685}in(c, (=pkCli_7778,em1_7781: bitstring));
                                        {8686}let m1_7782: bitstring = em1_7781 in
                                        {8687}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7783: bitstring) = m1_7782 in
                                        {8688}new Ns_7784: bitstring;
                                        {8689}new ST_7785: bitstring;
                                        {8690}new TTL_7786: bitstring;
                                        {8691}let gNs_7787: bitstring = exp(g,Ns_7784) in
                                        {8692}let m2_7788: bitstring = (OpenSecureChannelResponse,gNs_7787,ST_7785,TTL_7786) in
                                        {8693}out(c, m2_7788);
                                        {8694}let Ksrv_7789: bitstring = exp(PartC_7783,Ns_7784) in
                                        {8695}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7789))
                                    )
                                    else
                                        {8696}let v_7790: bool = (Disco_5610 = B) in
                                        (
                                            {8697}if v_7790 then
                                            (
                                                {8698}let pkDisco_7791: bitstring = pub(skB) in
                                                {8699}in(c, (=pkCli_7778,em1_7792: bitstring));
                                                {8700}let m1_7793: bitstring = em1_7792 in
                                                {8701}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7794: bitstring) = m1_7793 in
                                                {8702}new Ns_7795: bitstring;
                                                {8703}new ST_7796: bitstring;
                                                {8704}new TTL_7797: bitstring;
                                                {8705}let gNs_7798: bitstring = exp(g,Ns_7795) in
                                                {8706}let m2_7799: bitstring = (OpenSecureChannelResponse,gNs_7798,ST_7796,TTL_7797) in
                                                {8707}out(c, m2_7799);
                                                {8708}let Ksrv_7800: bitstring = exp(PartC_7794,Ns_7795) in
                                                {8709}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7800))
                                            )
                                            else
                                                {8710}let v_7801: bool = (Disco_5610 = C) in
                                                (
                                                    {8711}if v_7801 then
                                                    (
                                                        {8712}let pkDisco_7802: bitstring = pub(skC) in
                                                        {8713}in(c, (=pkCli_7778,em1_7803: bitstring));
                                                        {8714}let m1_7804: bitstring = em1_7803 in
                                                        {8715}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7805: bitstring) = m1_7804 in
                                                        {8716}new Ns_7806: bitstring;
                                                        {8717}new ST_7807: bitstring;
                                                        {8718}new TTL_7808: bitstring;
                                                        {8719}let gNs_7809: bitstring = exp(g,Ns_7806) in
                                                        {8720}let m2_7810: bitstring = (OpenSecureChannelResponse,gNs_7809,ST_7807,TTL_7808) in
                                                        {8721}out(c, m2_7810);
                                                        {8722}let Ksrv_7811: bitstring = exp(PartC_7805,Ns_7806) in
                                                        {8723}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7811))
                                                    )
                                                    else
                                                        {8724}let pkDisco_7812: bitstring = pub(sk(Disco_5610)) in
                                                        {8725}in(c, (=pkCli_7778,em1_7813: bitstring));
                                                        {8726}let m1_7814: bitstring = em1_7813 in
                                                        {8727}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7815: bitstring) = m1_7814 in
                                                        {8728}new Ns_7816: bitstring;
                                                        {8729}new ST_7817: bitstring;
                                                        {8730}new TTL_7818: bitstring;
                                                        {8731}let gNs_7819: bitstring = exp(g,Ns_7816) in
                                                        {8732}let m2_7820: bitstring = (OpenSecureChannelResponse,gNs_7819,ST_7817,TTL_7818) in
                                                        {8733}out(c, m2_7820);
                                                        {8734}let Ksrv_7821: bitstring = exp(PartC_7815,Ns_7816) in
                                                        {8735}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7821))
                                                )
                                                else
                                                    {8736}let pkDisco_7822: bitstring = fail-any in
                                                    {8737}in(c, (=pkCli_7778,em1_7823: bitstring));
                                                    {8738}let m1_7824: bitstring = em1_7823 in
                                                    {8739}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7825: bitstring) = m1_7824 in
                                                    {8740}new Ns_7826: bitstring;
                                                    {8741}new ST_7827: bitstring;
                                                    {8742}new TTL_7828: bitstring;
                                                    {8743}let gNs_7829: bitstring = exp(g,Ns_7826) in
                                                    {8744}let m2_7830: bitstring = (OpenSecureChannelResponse,gNs_7829,ST_7827,TTL_7828) in
                                                    {8745}out(c, m2_7830);
                                                    {8746}let Ksrv_7831: bitstring = exp(PartC_7825,Ns_7826) in
                                                    {8747}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7831))
                                        )
                                        else
                                            {8748}let pkDisco_7832: bitstring = fail-any in
                                            {8749}in(c, (=pkCli_7778,em1_7833: bitstring));
                                            {8750}let m1_7834: bitstring = em1_7833 in
                                            {8751}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7835: bitstring) = m1_7834 in
                                            {8752}new Ns_7836: bitstring;
                                            {8753}new ST_7837: bitstring;
                                            {8754}new TTL_7838: bitstring;
                                            {8755}let gNs_7839: bitstring = exp(g,Ns_7836) in
                                            {8756}let m2_7840: bitstring = (OpenSecureChannelResponse,gNs_7839,ST_7837,TTL_7838) in
                                            {8757}out(c, m2_7840);
                                            {8758}let Ksrv_7841: bitstring = exp(PartC_7835,Ns_7836) in
                                            {8759}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7841))
                                )
                                else
                                    {8760}let pkDisco_7842: bitstring = fail-any in
                                    {8761}in(c, (=pkCli_7778,em1_7843: bitstring));
                                    {8762}let m1_7844: bitstring = em1_7843 in
                                    {8763}let (=OpenSecureChannelRequest,=pkCli_7778,PartC_7845: bitstring) = m1_7844 in
                                    {8764}new Ns_7846: bitstring;
                                    {8765}new ST_7847: bitstring;
                                    {8766}new TTL_7848: bitstring;
                                    {8767}let gNs_7849: bitstring = exp(g,Ns_7846) in
                                    {8768}let m2_7850: bitstring = (OpenSecureChannelResponse,gNs_7849,ST_7847,TTL_7848) in
                                    {8769}out(c, m2_7850);
                                    {8770}let Ksrv_7851: bitstring = exp(PartC_7845,Ns_7846) in
                                    {8771}out(c, senc(mSrv(pkCli_7778,pkSess_7701),Ksrv_7851))
                            )
                            else
                                {8772}let v_7852: bool = (Cli_5609 = C) in
                                (
                                    {8773}if v_7852 then
                                    (
                                        {8774}let pkCli_7853: bitstring = pub(skC) in
                                        {8775}let v_7854: bool = (Disco_5610 = A) in
                                        (
                                            {8776}if v_7854 then
                                            (
                                                {8777}let pkDisco_7855: bitstring = pub(skA) in
                                                {8778}in(c, (=pkCli_7853,em1_7856: bitstring));
                                                {8779}let m1_7857: bitstring = em1_7856 in
                                                {8780}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7858: bitstring) = m1_7857 in
                                                {8781}new Ns_7859: bitstring;
                                                {8782}new ST_7860: bitstring;
                                                {8783}new TTL_7861: bitstring;
                                                {8784}let gNs_7862: bitstring = exp(g,Ns_7859) in
                                                {8785}let m2_7863: bitstring = (OpenSecureChannelResponse,gNs_7862,ST_7860,TTL_7861) in
                                                {8786}out(c, m2_7863);
                                                {8787}let Ksrv_7864: bitstring = exp(PartC_7858,Ns_7859) in
                                                {8788}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7864))
                                            )
                                            else
                                                {8789}let v_7865: bool = (Disco_5610 = B) in
                                                (
                                                    {8790}if v_7865 then
                                                    (
                                                        {8791}let pkDisco_7866: bitstring = pub(skB) in
                                                        {8792}in(c, (=pkCli_7853,em1_7867: bitstring));
                                                        {8793}let m1_7868: bitstring = em1_7867 in
                                                        {8794}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7869: bitstring) = m1_7868 in
                                                        {8795}new Ns_7870: bitstring;
                                                        {8796}new ST_7871: bitstring;
                                                        {8797}new TTL_7872: bitstring;
                                                        {8798}let gNs_7873: bitstring = exp(g,Ns_7870) in
                                                        {8799}let m2_7874: bitstring = (OpenSecureChannelResponse,gNs_7873,ST_7871,TTL_7872) in
                                                        {8800}out(c, m2_7874);
                                                        {8801}let Ksrv_7875: bitstring = exp(PartC_7869,Ns_7870) in
                                                        {8802}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7875))
                                                    )
                                                    else
                                                        {8803}let v_7876: bool = (Disco_5610 = C) in
                                                        (
                                                            {8804}if v_7876 then
                                                            (
                                                                {8805}let pkDisco_7877: bitstring = pub(skC) in
                                                                {8806}in(c, (=pkCli_7853,em1_7878: bitstring));
                                                                {8807}let m1_7879: bitstring = em1_7878 in
                                                                {8808}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7880: bitstring) = m1_7879 in
                                                                {8809}new Ns_7881: bitstring;
                                                                {8810}new ST_7882: bitstring;
                                                                {8811}new TTL_7883: bitstring;
                                                                {8812}let gNs_7884: bitstring = exp(g,Ns_7881) in
                                                                {8813}let m2_7885: bitstring = (OpenSecureChannelResponse,gNs_7884,ST_7882,TTL_7883) in
                                                                {8814}out(c, m2_7885);
                                                                {8815}let Ksrv_7886: bitstring = exp(PartC_7880,Ns_7881) in
                                                                {8816}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7886))
                                                            )
                                                            else
                                                                {8817}let pkDisco_7887: bitstring = pub(sk(Disco_5610)) in
                                                                {8818}in(c, (=pkCli_7853,em1_7888: bitstring));
                                                                {8819}let m1_7889: bitstring = em1_7888 in
                                                                {8820}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7890: bitstring) = m1_7889 in
                                                                {8821}new Ns_7891: bitstring;
                                                                {8822}new ST_7892: bitstring;
                                                                {8823}new TTL_7893: bitstring;
                                                                {8824}let gNs_7894: bitstring = exp(g,Ns_7891) in
                                                                {8825}let m2_7895: bitstring = (OpenSecureChannelResponse,gNs_7894,ST_7892,TTL_7893) in
                                                                {8826}out(c, m2_7895);
                                                                {8827}let Ksrv_7896: bitstring = exp(PartC_7890,Ns_7891) in
                                                                {8828}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7896))
                                                        )
                                                        else
                                                            {8829}let pkDisco_7897: bitstring = fail-any in
                                                            {8830}in(c, (=pkCli_7853,em1_7898: bitstring));
                                                            {8831}let m1_7899: bitstring = em1_7898 in
                                                            {8832}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7900: bitstring) = m1_7899 in
                                                            {8833}new Ns_7901: bitstring;
                                                            {8834}new ST_7902: bitstring;
                                                            {8835}new TTL_7903: bitstring;
                                                            {8836}let gNs_7904: bitstring = exp(g,Ns_7901) in
                                                            {8837}let m2_7905: bitstring = (OpenSecureChannelResponse,gNs_7904,ST_7902,TTL_7903) in
                                                            {8838}out(c, m2_7905);
                                                            {8839}let Ksrv_7906: bitstring = exp(PartC_7900,Ns_7901) in
                                                            {8840}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7906))
                                                )
                                                else
                                                    {8841}let pkDisco_7907: bitstring = fail-any in
                                                    {8842}in(c, (=pkCli_7853,em1_7908: bitstring));
                                                    {8843}let m1_7909: bitstring = em1_7908 in
                                                    {8844}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7910: bitstring) = m1_7909 in
                                                    {8845}new Ns_7911: bitstring;
                                                    {8846}new ST_7912: bitstring;
                                                    {8847}new TTL_7913: bitstring;
                                                    {8848}let gNs_7914: bitstring = exp(g,Ns_7911) in
                                                    {8849}let m2_7915: bitstring = (OpenSecureChannelResponse,gNs_7914,ST_7912,TTL_7913) in
                                                    {8850}out(c, m2_7915);
                                                    {8851}let Ksrv_7916: bitstring = exp(PartC_7910,Ns_7911) in
                                                    {8852}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7916))
                                        )
                                        else
                                            {8853}let pkDisco_7917: bitstring = fail-any in
                                            {8854}in(c, (=pkCli_7853,em1_7918: bitstring));
                                            {8855}let m1_7919: bitstring = em1_7918 in
                                            {8856}let (=OpenSecureChannelRequest,=pkCli_7853,PartC_7920: bitstring) = m1_7919 in
                                            {8857}new Ns_7921: bitstring;
                                            {8858}new ST_7922: bitstring;
                                            {8859}new TTL_7923: bitstring;
                                            {8860}let gNs_7924: bitstring = exp(g,Ns_7921) in
                                            {8861}let m2_7925: bitstring = (OpenSecureChannelResponse,gNs_7924,ST_7922,TTL_7923) in
                                            {8862}out(c, m2_7925);
                                            {8863}let Ksrv_7926: bitstring = exp(PartC_7920,Ns_7921) in
                                            {8864}out(c, senc(mSrv(pkCli_7853,pkSess_7701),Ksrv_7926))
                                    )
                                    else
                                        {8865}let pkCli_7927: bitstring = pub(sk(Cli_5609)) in
                                        {8866}let v_7928: bool = (Disco_5610 = A) in
                                        (
                                            {8867}if v_7928 then
                                            (
                                                {8868}let pkDisco_7929: bitstring = pub(skA) in
                                                {8869}in(c, (=pkCli_7927,em1_7930: bitstring));
                                                {8870}let m1_7931: bitstring = em1_7930 in
                                                {8871}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7932: bitstring) = m1_7931 in
                                                {8872}new Ns_7933: bitstring;
                                                {8873}new ST_7934: bitstring;
                                                {8874}new TTL_7935: bitstring;
                                                {8875}let gNs_7936: bitstring = exp(g,Ns_7933) in
                                                {8876}let m2_7937: bitstring = (OpenSecureChannelResponse,gNs_7936,ST_7934,TTL_7935) in
                                                {8877}out(c, m2_7937);
                                                {8878}let Ksrv_7938: bitstring = exp(PartC_7932,Ns_7933) in
                                                {8879}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_7938))
                                            )
                                            else
                                                {8880}let v_7939: bool = (Disco_5610 = B) in
                                                (
                                                    {8881}if v_7939 then
                                                    (
                                                        {8882}let pkDisco_7940: bitstring = pub(skB) in
                                                        {8883}in(c, (=pkCli_7927,em1_7941: bitstring));
                                                        {8884}let m1_7942: bitstring = em1_7941 in
                                                        {8885}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7943: bitstring) = m1_7942 in
                                                        {8886}new Ns_7944: bitstring;
                                                        {8887}new ST_7945: bitstring;
                                                        {8888}new TTL_7946: bitstring;
                                                        {8889}let gNs_7947: bitstring = exp(g,Ns_7944) in
                                                        {8890}let m2_7948: bitstring = (OpenSecureChannelResponse,gNs_7947,ST_7945,TTL_7946) in
                                                        {8891}out(c, m2_7948);
                                                        {8892}let Ksrv_7949: bitstring = exp(PartC_7943,Ns_7944) in
                                                        {8893}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_7949))
                                                    )
                                                    else
                                                        {8894}let v_7950: bool = (Disco_5610 = C) in
                                                        (
                                                            {8895}if v_7950 then
                                                            (
                                                                {8896}let pkDisco_7951: bitstring = pub(skC) in
                                                                {8897}in(c, (=pkCli_7927,em1_7952: bitstring));
                                                                {8898}let m1_7953: bitstring = em1_7952 in
                                                                {8899}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7954: bitstring) = m1_7953 in
                                                                {8900}new Ns_7955: bitstring;
                                                                {8901}new ST_7956: bitstring;
                                                                {8902}new TTL_7957: bitstring;
                                                                {8903}let gNs_7958: bitstring = exp(g,Ns_7955) in
                                                                {8904}let m2_7959: bitstring = (OpenSecureChannelResponse,gNs_7958,ST_7956,TTL_7957) in
                                                                {8905}out(c, m2_7959);
                                                                {8906}let Ksrv_7960: bitstring = exp(PartC_7954,Ns_7955) in
                                                                {8907}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_7960))
                                                            )
                                                            else
                                                                {8908}let pkDisco_7961: bitstring = pub(sk(Disco_5610)) in
                                                                {8909}in(c, (=pkCli_7927,em1_7962: bitstring));
                                                                {8910}let m1_7963: bitstring = em1_7962 in
                                                                {8911}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7964: bitstring) = m1_7963 in
                                                                {8912}new Ns_7965: bitstring;
                                                                {8913}new ST_7966: bitstring;
                                                                {8914}new TTL_7967: bitstring;
                                                                {8915}let gNs_7968: bitstring = exp(g,Ns_7965) in
                                                                {8916}let m2_7969: bitstring = (OpenSecureChannelResponse,gNs_7968,ST_7966,TTL_7967) in
                                                                {8917}out(c, m2_7969);
                                                                {8918}let Ksrv_7970: bitstring = exp(PartC_7964,Ns_7965) in
                                                                {8919}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_7970))
                                                        )
                                                        else
                                                            {8920}let pkDisco_7971: bitstring = fail-any in
                                                            {8921}in(c, (=pkCli_7927,em1_7972: bitstring));
                                                            {8922}let m1_7973: bitstring = em1_7972 in
                                                            {8923}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7974: bitstring) = m1_7973 in
                                                            {8924}new Ns_7975: bitstring;
                                                            {8925}new ST_7976: bitstring;
                                                            {8926}new TTL_7977: bitstring;
                                                            {8927}let gNs_7978: bitstring = exp(g,Ns_7975) in
                                                            {8928}let m2_7979: bitstring = (OpenSecureChannelResponse,gNs_7978,ST_7976,TTL_7977) in
                                                            {8929}out(c, m2_7979);
                                                            {8930}let Ksrv_7980: bitstring = exp(PartC_7974,Ns_7975) in
                                                            {8931}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_7980))
                                                )
                                                else
                                                    {8932}let pkDisco_7981: bitstring = fail-any in
                                                    {8933}in(c, (=pkCli_7927,em1_7982: bitstring));
                                                    {8934}let m1_7983: bitstring = em1_7982 in
                                                    {8935}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7984: bitstring) = m1_7983 in
                                                    {8936}new Ns_7985: bitstring;
                                                    {8937}new ST_7986: bitstring;
                                                    {8938}new TTL_7987: bitstring;
                                                    {8939}let gNs_7988: bitstring = exp(g,Ns_7985) in
                                                    {8940}let m2_7989: bitstring = (OpenSecureChannelResponse,gNs_7988,ST_7986,TTL_7987) in
                                                    {8941}out(c, m2_7989);
                                                    {8942}let Ksrv_7990: bitstring = exp(PartC_7984,Ns_7985) in
                                                    {8943}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_7990))
                                        )
                                        else
                                            {8944}let pkDisco_7991: bitstring = fail-any in
                                            {8945}in(c, (=pkCli_7927,em1_7992: bitstring));
                                            {8946}let m1_7993: bitstring = em1_7992 in
                                            {8947}let (=OpenSecureChannelRequest,=pkCli_7927,PartC_7994: bitstring) = m1_7993 in
                                            {8948}new Ns_7995: bitstring;
                                            {8949}new ST_7996: bitstring;
                                            {8950}new TTL_7997: bitstring;
                                            {8951}let gNs_7998: bitstring = exp(g,Ns_7995) in
                                            {8952}let m2_7999: bitstring = (OpenSecureChannelResponse,gNs_7998,ST_7996,TTL_7997) in
                                            {8953}out(c, m2_7999);
                                            {8954}let Ksrv_8000: bitstring = exp(PartC_7994,Ns_7995) in
                                            {8955}out(c, senc(mSrv(pkCli_7927,pkSess_7701),Ksrv_8000))
                                )
                                else
                                    {8956}let pkCli_8001: bitstring = fail-any in
                                    {8957}let v_8002: bool = (Disco_5610 = A) in
                                    (
                                        {8958}if v_8002 then
                                        (
                                            {8959}let pkDisco_8003: bitstring = pub(skA) in
                                            {8960}in(c, (=pkCli_8001,em1_8004: bitstring));
                                            {8961}let m1_8005: bitstring = em1_8004 in
                                            {8962}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8006: bitstring) = m1_8005 in
                                            {8963}new Ns_8007: bitstring;
                                            {8964}new ST_8008: bitstring;
                                            {8965}new TTL_8009: bitstring;
                                            {8966}let gNs_8010: bitstring = exp(g,Ns_8007) in
                                            {8967}let m2_8011: bitstring = (OpenSecureChannelResponse,gNs_8010,ST_8008,TTL_8009) in
                                            {8968}out(c, m2_8011);
                                            {8969}let Ksrv_8012: bitstring = exp(PartC_8006,Ns_8007) in
                                            {8970}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8012))
                                        )
                                        else
                                            {8971}let v_8013: bool = (Disco_5610 = B) in
                                            (
                                                {8972}if v_8013 then
                                                (
                                                    {8973}let pkDisco_8014: bitstring = pub(skB) in
                                                    {8974}in(c, (=pkCli_8001,em1_8015: bitstring));
                                                    {8975}let m1_8016: bitstring = em1_8015 in
                                                    {8976}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8017: bitstring) = m1_8016 in
                                                    {8977}new Ns_8018: bitstring;
                                                    {8978}new ST_8019: bitstring;
                                                    {8979}new TTL_8020: bitstring;
                                                    {8980}let gNs_8021: bitstring = exp(g,Ns_8018) in
                                                    {8981}let m2_8022: bitstring = (OpenSecureChannelResponse,gNs_8021,ST_8019,TTL_8020) in
                                                    {8982}out(c, m2_8022);
                                                    {8983}let Ksrv_8023: bitstring = exp(PartC_8017,Ns_8018) in
                                                    {8984}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8023))
                                                )
                                                else
                                                    {8985}let v_8024: bool = (Disco_5610 = C) in
                                                    (
                                                        {8986}if v_8024 then
                                                        (
                                                            {8987}let pkDisco_8025: bitstring = pub(skC) in
                                                            {8988}in(c, (=pkCli_8001,em1_8026: bitstring));
                                                            {8989}let m1_8027: bitstring = em1_8026 in
                                                            {8990}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8028: bitstring) = m1_8027 in
                                                            {8991}new Ns_8029: bitstring;
                                                            {8992}new ST_8030: bitstring;
                                                            {8993}new TTL_8031: bitstring;
                                                            {8994}let gNs_8032: bitstring = exp(g,Ns_8029) in
                                                            {8995}let m2_8033: bitstring = (OpenSecureChannelResponse,gNs_8032,ST_8030,TTL_8031) in
                                                            {8996}out(c, m2_8033);
                                                            {8997}let Ksrv_8034: bitstring = exp(PartC_8028,Ns_8029) in
                                                            {8998}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8034))
                                                        )
                                                        else
                                                            {8999}let pkDisco_8035: bitstring = pub(sk(Disco_5610)) in
                                                            {9000}in(c, (=pkCli_8001,em1_8036: bitstring));
                                                            {9001}let m1_8037: bitstring = em1_8036 in
                                                            {9002}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8038: bitstring) = m1_8037 in
                                                            {9003}new Ns_8039: bitstring;
                                                            {9004}new ST_8040: bitstring;
                                                            {9005}new TTL_8041: bitstring;
                                                            {9006}let gNs_8042: bitstring = exp(g,Ns_8039) in
                                                            {9007}let m2_8043: bitstring = (OpenSecureChannelResponse,gNs_8042,ST_8040,TTL_8041) in
                                                            {9008}out(c, m2_8043);
                                                            {9009}let Ksrv_8044: bitstring = exp(PartC_8038,Ns_8039) in
                                                            {9010}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8044))
                                                    )
                                                    else
                                                        {9011}let pkDisco_8045: bitstring = fail-any in
                                                        {9012}in(c, (=pkCli_8001,em1_8046: bitstring));
                                                        {9013}let m1_8047: bitstring = em1_8046 in
                                                        {9014}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8048: bitstring) = m1_8047 in
                                                        {9015}new Ns_8049: bitstring;
                                                        {9016}new ST_8050: bitstring;
                                                        {9017}new TTL_8051: bitstring;
                                                        {9018}let gNs_8052: bitstring = exp(g,Ns_8049) in
                                                        {9019}let m2_8053: bitstring = (OpenSecureChannelResponse,gNs_8052,ST_8050,TTL_8051) in
                                                        {9020}out(c, m2_8053);
                                                        {9021}let Ksrv_8054: bitstring = exp(PartC_8048,Ns_8049) in
                                                        {9022}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8054))
                                            )
                                            else
                                                {9023}let pkDisco_8055: bitstring = fail-any in
                                                {9024}in(c, (=pkCli_8001,em1_8056: bitstring));
                                                {9025}let m1_8057: bitstring = em1_8056 in
                                                {9026}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8058: bitstring) = m1_8057 in
                                                {9027}new Ns_8059: bitstring;
                                                {9028}new ST_8060: bitstring;
                                                {9029}new TTL_8061: bitstring;
                                                {9030}let gNs_8062: bitstring = exp(g,Ns_8059) in
                                                {9031}let m2_8063: bitstring = (OpenSecureChannelResponse,gNs_8062,ST_8060,TTL_8061) in
                                                {9032}out(c, m2_8063);
                                                {9033}let Ksrv_8064: bitstring = exp(PartC_8058,Ns_8059) in
                                                {9034}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8064))
                                    )
                                    else
                                        {9035}let pkDisco_8065: bitstring = fail-any in
                                        {9036}in(c, (=pkCli_8001,em1_8066: bitstring));
                                        {9037}let m1_8067: bitstring = em1_8066 in
                                        {9038}let (=OpenSecureChannelRequest,=pkCli_8001,PartC_8068: bitstring) = m1_8067 in
                                        {9039}new Ns_8069: bitstring;
                                        {9040}new ST_8070: bitstring;
                                        {9041}new TTL_8071: bitstring;
                                        {9042}let gNs_8072: bitstring = exp(g,Ns_8069) in
                                        {9043}let m2_8073: bitstring = (OpenSecureChannelResponse,gNs_8072,ST_8070,TTL_8071) in
                                        {9044}out(c, m2_8073);
                                        {9045}let Ksrv_8074: bitstring = exp(PartC_8068,Ns_8069) in
                                        {9046}out(c, senc(mSrv(pkCli_8001,pkSess_7701),Ksrv_8074))
                        )
                        else
                            {9047}let pkCli_8075: bitstring = fail-any in
                            {9048}let v_8076: bool = (Disco_5610 = A) in
                            (
                                {9049}if v_8076 then
                                (
                                    {9050}let pkDisco_8077: bitstring = pub(skA) in
                                    {9051}in(c, (=pkCli_8075,em1_8078: bitstring));
                                    {9052}let m1_8079: bitstring = em1_8078 in
                                    {9053}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8080: bitstring) = m1_8079 in
                                    {9054}new Ns_8081: bitstring;
                                    {9055}new ST_8082: bitstring;
                                    {9056}new TTL_8083: bitstring;
                                    {9057}let gNs_8084: bitstring = exp(g,Ns_8081) in
                                    {9058}let m2_8085: bitstring = (OpenSecureChannelResponse,gNs_8084,ST_8082,TTL_8083) in
                                    {9059}out(c, m2_8085);
                                    {9060}let Ksrv_8086: bitstring = exp(PartC_8080,Ns_8081) in
                                    {9061}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8086))
                                )
                                else
                                    {9062}let v_8087: bool = (Disco_5610 = B) in
                                    (
                                        {9063}if v_8087 then
                                        (
                                            {9064}let pkDisco_8088: bitstring = pub(skB) in
                                            {9065}in(c, (=pkCli_8075,em1_8089: bitstring));
                                            {9066}let m1_8090: bitstring = em1_8089 in
                                            {9067}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8091: bitstring) = m1_8090 in
                                            {9068}new Ns_8092: bitstring;
                                            {9069}new ST_8093: bitstring;
                                            {9070}new TTL_8094: bitstring;
                                            {9071}let gNs_8095: bitstring = exp(g,Ns_8092) in
                                            {9072}let m2_8096: bitstring = (OpenSecureChannelResponse,gNs_8095,ST_8093,TTL_8094) in
                                            {9073}out(c, m2_8096);
                                            {9074}let Ksrv_8097: bitstring = exp(PartC_8091,Ns_8092) in
                                            {9075}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8097))
                                        )
                                        else
                                            {9076}let v_8098: bool = (Disco_5610 = C) in
                                            (
                                                {9077}if v_8098 then
                                                (
                                                    {9078}let pkDisco_8099: bitstring = pub(skC) in
                                                    {9079}in(c, (=pkCli_8075,em1_8100: bitstring));
                                                    {9080}let m1_8101: bitstring = em1_8100 in
                                                    {9081}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8102: bitstring) = m1_8101 in
                                                    {9082}new Ns_8103: bitstring;
                                                    {9083}new ST_8104: bitstring;
                                                    {9084}new TTL_8105: bitstring;
                                                    {9085}let gNs_8106: bitstring = exp(g,Ns_8103) in
                                                    {9086}let m2_8107: bitstring = (OpenSecureChannelResponse,gNs_8106,ST_8104,TTL_8105) in
                                                    {9087}out(c, m2_8107);
                                                    {9088}let Ksrv_8108: bitstring = exp(PartC_8102,Ns_8103) in
                                                    {9089}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8108))
                                                )
                                                else
                                                    {9090}let pkDisco_8109: bitstring = pub(sk(Disco_5610)) in
                                                    {9091}in(c, (=pkCli_8075,em1_8110: bitstring));
                                                    {9092}let m1_8111: bitstring = em1_8110 in
                                                    {9093}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8112: bitstring) = m1_8111 in
                                                    {9094}new Ns_8113: bitstring;
                                                    {9095}new ST_8114: bitstring;
                                                    {9096}new TTL_8115: bitstring;
                                                    {9097}let gNs_8116: bitstring = exp(g,Ns_8113) in
                                                    {9098}let m2_8117: bitstring = (OpenSecureChannelResponse,gNs_8116,ST_8114,TTL_8115) in
                                                    {9099}out(c, m2_8117);
                                                    {9100}let Ksrv_8118: bitstring = exp(PartC_8112,Ns_8113) in
                                                    {9101}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8118))
                                            )
                                            else
                                                {9102}let pkDisco_8119: bitstring = fail-any in
                                                {9103}in(c, (=pkCli_8075,em1_8120: bitstring));
                                                {9104}let m1_8121: bitstring = em1_8120 in
                                                {9105}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8122: bitstring) = m1_8121 in
                                                {9106}new Ns_8123: bitstring;
                                                {9107}new ST_8124: bitstring;
                                                {9108}new TTL_8125: bitstring;
                                                {9109}let gNs_8126: bitstring = exp(g,Ns_8123) in
                                                {9110}let m2_8127: bitstring = (OpenSecureChannelResponse,gNs_8126,ST_8124,TTL_8125) in
                                                {9111}out(c, m2_8127);
                                                {9112}let Ksrv_8128: bitstring = exp(PartC_8122,Ns_8123) in
                                                {9113}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8128))
                                    )
                                    else
                                        {9114}let pkDisco_8129: bitstring = fail-any in
                                        {9115}in(c, (=pkCli_8075,em1_8130: bitstring));
                                        {9116}let m1_8131: bitstring = em1_8130 in
                                        {9117}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8132: bitstring) = m1_8131 in
                                        {9118}new Ns_8133: bitstring;
                                        {9119}new ST_8134: bitstring;
                                        {9120}new TTL_8135: bitstring;
                                        {9121}let gNs_8136: bitstring = exp(g,Ns_8133) in
                                        {9122}let m2_8137: bitstring = (OpenSecureChannelResponse,gNs_8136,ST_8134,TTL_8135) in
                                        {9123}out(c, m2_8137);
                                        {9124}let Ksrv_8138: bitstring = exp(PartC_8132,Ns_8133) in
                                        {9125}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8138))
                            )
                            else
                                {9126}let pkDisco_8139: bitstring = fail-any in
                                {9127}in(c, (=pkCli_8075,em1_8140: bitstring));
                                {9128}let m1_8141: bitstring = em1_8140 in
                                {9129}let (=OpenSecureChannelRequest,=pkCli_8075,PartC_8142: bitstring) = m1_8141 in
                                {9130}new Ns_8143: bitstring;
                                {9131}new ST_8144: bitstring;
                                {9132}new TTL_8145: bitstring;
                                {9133}let gNs_8146: bitstring = exp(g,Ns_8143) in
                                {9134}let m2_8147: bitstring = (OpenSecureChannelResponse,gNs_8146,ST_8144,TTL_8145) in
                                {9135}out(c, m2_8147);
                                {9136}let Ksrv_8148: bitstring = exp(PartC_8142,Ns_8143) in
                                {9137}out(c, senc(mSrv(pkCli_8075,pkSess_7701),Ksrv_8148))
                )
                else
                    {9138}let pkCli_8149: bitstring = fail-any in
                    {9139}let v_8150: bool = (Disco_5610 = A) in
                    (
                        {9140}if v_8150 then
                        (
                            {9141}let pkDisco_8151: bitstring = pub(skA) in
                            {9142}in(c, (=pkCli_8149,em1_8152: bitstring));
                            {9143}let m1_8153: bitstring = em1_8152 in
                            {9144}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8154: bitstring) = m1_8153 in
                            {9145}new Ns_8155: bitstring;
                            {9146}new ST_8156: bitstring;
                            {9147}new TTL_8157: bitstring;
                            {9148}let gNs_8158: bitstring = exp(g,Ns_8155) in
                            {9149}let m2_8159: bitstring = (OpenSecureChannelResponse,gNs_8158,ST_8156,TTL_8157) in
                            {9150}out(c, m2_8159);
                            {9151}let Ksrv_8160: bitstring = exp(PartC_8154,Ns_8155) in
                            {9152}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8160))
                        )
                        else
                            {9153}let v_8161: bool = (Disco_5610 = B) in
                            (
                                {9154}if v_8161 then
                                (
                                    {9155}let pkDisco_8162: bitstring = pub(skB) in
                                    {9156}in(c, (=pkCli_8149,em1_8163: bitstring));
                                    {9157}let m1_8164: bitstring = em1_8163 in
                                    {9158}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8165: bitstring) = m1_8164 in
                                    {9159}new Ns_8166: bitstring;
                                    {9160}new ST_8167: bitstring;
                                    {9161}new TTL_8168: bitstring;
                                    {9162}let gNs_8169: bitstring = exp(g,Ns_8166) in
                                    {9163}let m2_8170: bitstring = (OpenSecureChannelResponse,gNs_8169,ST_8167,TTL_8168) in
                                    {9164}out(c, m2_8170);
                                    {9165}let Ksrv_8171: bitstring = exp(PartC_8165,Ns_8166) in
                                    {9166}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8171))
                                )
                                else
                                    {9167}let v_8172: bool = (Disco_5610 = C) in
                                    (
                                        {9168}if v_8172 then
                                        (
                                            {9169}let pkDisco_8173: bitstring = pub(skC) in
                                            {9170}in(c, (=pkCli_8149,em1_8174: bitstring));
                                            {9171}let m1_8175: bitstring = em1_8174 in
                                            {9172}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8176: bitstring) = m1_8175 in
                                            {9173}new Ns_8177: bitstring;
                                            {9174}new ST_8178: bitstring;
                                            {9175}new TTL_8179: bitstring;
                                            {9176}let gNs_8180: bitstring = exp(g,Ns_8177) in
                                            {9177}let m2_8181: bitstring = (OpenSecureChannelResponse,gNs_8180,ST_8178,TTL_8179) in
                                            {9178}out(c, m2_8181);
                                            {9179}let Ksrv_8182: bitstring = exp(PartC_8176,Ns_8177) in
                                            {9180}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8182))
                                        )
                                        else
                                            {9181}let pkDisco_8183: bitstring = pub(sk(Disco_5610)) in
                                            {9182}in(c, (=pkCli_8149,em1_8184: bitstring));
                                            {9183}let m1_8185: bitstring = em1_8184 in
                                            {9184}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8186: bitstring) = m1_8185 in
                                            {9185}new Ns_8187: bitstring;
                                            {9186}new ST_8188: bitstring;
                                            {9187}new TTL_8189: bitstring;
                                            {9188}let gNs_8190: bitstring = exp(g,Ns_8187) in
                                            {9189}let m2_8191: bitstring = (OpenSecureChannelResponse,gNs_8190,ST_8188,TTL_8189) in
                                            {9190}out(c, m2_8191);
                                            {9191}let Ksrv_8192: bitstring = exp(PartC_8186,Ns_8187) in
                                            {9192}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8192))
                                    )
                                    else
                                        {9193}let pkDisco_8193: bitstring = fail-any in
                                        {9194}in(c, (=pkCli_8149,em1_8194: bitstring));
                                        {9195}let m1_8195: bitstring = em1_8194 in
                                        {9196}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8196: bitstring) = m1_8195 in
                                        {9197}new Ns_8197: bitstring;
                                        {9198}new ST_8198: bitstring;
                                        {9199}new TTL_8199: bitstring;
                                        {9200}let gNs_8200: bitstring = exp(g,Ns_8197) in
                                        {9201}let m2_8201: bitstring = (OpenSecureChannelResponse,gNs_8200,ST_8198,TTL_8199) in
                                        {9202}out(c, m2_8201);
                                        {9203}let Ksrv_8202: bitstring = exp(PartC_8196,Ns_8197) in
                                        {9204}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8202))
                            )
                            else
                                {9205}let pkDisco_8203: bitstring = fail-any in
                                {9206}in(c, (=pkCli_8149,em1_8204: bitstring));
                                {9207}let m1_8205: bitstring = em1_8204 in
                                {9208}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8206: bitstring) = m1_8205 in
                                {9209}new Ns_8207: bitstring;
                                {9210}new ST_8208: bitstring;
                                {9211}new TTL_8209: bitstring;
                                {9212}let gNs_8210: bitstring = exp(g,Ns_8207) in
                                {9213}let m2_8211: bitstring = (OpenSecureChannelResponse,gNs_8210,ST_8208,TTL_8209) in
                                {9214}out(c, m2_8211);
                                {9215}let Ksrv_8212: bitstring = exp(PartC_8206,Ns_8207) in
                                {9216}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8212))
                    )
                    else
                        {9217}let pkDisco_8213: bitstring = fail-any in
                        {9218}in(c, (=pkCli_8149,em1_8214: bitstring));
                        {9219}let m1_8215: bitstring = em1_8214 in
                        {9220}let (=OpenSecureChannelRequest,=pkCli_8149,PartC_8216: bitstring) = m1_8215 in
                        {9221}new Ns_8217: bitstring;
                        {9222}new ST_8218: bitstring;
                        {9223}new TTL_8219: bitstring;
                        {9224}let gNs_8220: bitstring = exp(g,Ns_8217) in
                        {9225}let m2_8221: bitstring = (OpenSecureChannelResponse,gNs_8220,ST_8218,TTL_8219) in
                        {9226}out(c, m2_8221);
                        {9227}let Ksrv_8222: bitstring = exp(PartC_8216,Ns_8217) in
                        {9228}out(c, senc(mSrv(pkCli_8149,pkSess_7701),Ksrv_8222))
    )
    else
        {9229}let skSess_8223: bitstring = fail-any in
        {9230}let pkSess_8224: bitstring = pub(skSess_8223) in
        {9231}let v_8225: bool = (Cli_5609 = A) in
        (
            {9232}if v_8225 then
            (
                {9233}let pkCli_8226: bitstring = pub(skA) in
                {9234}let v_8227: bool = (Disco_5610 = A) in
                (
                    {9235}if v_8227 then
                    (
                        {9236}let pkDisco_8228: bitstring = pub(skA) in
                        {9237}in(c, (=pkCli_8226,em1_8229: bitstring));
                        {9238}let m1_8230: bitstring = em1_8229 in
                        {9239}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8231: bitstring) = m1_8230 in
                        {9240}new Ns_8232: bitstring;
                        {9241}new ST_8233: bitstring;
                        {9242}new TTL_8234: bitstring;
                        {9243}let gNs_8235: bitstring = exp(g,Ns_8232) in
                        {9244}let m2_8236: bitstring = (OpenSecureChannelResponse,gNs_8235,ST_8233,TTL_8234) in
                        {9245}out(c, m2_8236);
                        {9246}let Ksrv_8237: bitstring = exp(PartC_8231,Ns_8232) in
                        {9247}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8237))
                    )
                    else
                        {9248}let v_8238: bool = (Disco_5610 = B) in
                        (
                            {9249}if v_8238 then
                            (
                                {9250}let pkDisco_8239: bitstring = pub(skB) in
                                {9251}in(c, (=pkCli_8226,em1_8240: bitstring));
                                {9252}let m1_8241: bitstring = em1_8240 in
                                {9253}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8242: bitstring) = m1_8241 in
                                {9254}new Ns_8243: bitstring;
                                {9255}new ST_8244: bitstring;
                                {9256}new TTL_8245: bitstring;
                                {9257}let gNs_8246: bitstring = exp(g,Ns_8243) in
                                {9258}let m2_8247: bitstring = (OpenSecureChannelResponse,gNs_8246,ST_8244,TTL_8245) in
                                {9259}out(c, m2_8247);
                                {9260}let Ksrv_8248: bitstring = exp(PartC_8242,Ns_8243) in
                                {9261}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8248))
                            )
                            else
                                {9262}let v_8249: bool = (Disco_5610 = C) in
                                (
                                    {9263}if v_8249 then
                                    (
                                        {9264}let pkDisco_8250: bitstring = pub(skC) in
                                        {9265}in(c, (=pkCli_8226,em1_8251: bitstring));
                                        {9266}let m1_8252: bitstring = em1_8251 in
                                        {9267}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8253: bitstring) = m1_8252 in
                                        {9268}new Ns_8254: bitstring;
                                        {9269}new ST_8255: bitstring;
                                        {9270}new TTL_8256: bitstring;
                                        {9271}let gNs_8257: bitstring = exp(g,Ns_8254) in
                                        {9272}let m2_8258: bitstring = (OpenSecureChannelResponse,gNs_8257,ST_8255,TTL_8256) in
                                        {9273}out(c, m2_8258);
                                        {9274}let Ksrv_8259: bitstring = exp(PartC_8253,Ns_8254) in
                                        {9275}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8259))
                                    )
                                    else
                                        {9276}let pkDisco_8260: bitstring = pub(sk(Disco_5610)) in
                                        {9277}in(c, (=pkCli_8226,em1_8261: bitstring));
                                        {9278}let m1_8262: bitstring = em1_8261 in
                                        {9279}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8263: bitstring) = m1_8262 in
                                        {9280}new Ns_8264: bitstring;
                                        {9281}new ST_8265: bitstring;
                                        {9282}new TTL_8266: bitstring;
                                        {9283}let gNs_8267: bitstring = exp(g,Ns_8264) in
                                        {9284}let m2_8268: bitstring = (OpenSecureChannelResponse,gNs_8267,ST_8265,TTL_8266) in
                                        {9285}out(c, m2_8268);
                                        {9286}let Ksrv_8269: bitstring = exp(PartC_8263,Ns_8264) in
                                        {9287}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8269))
                                )
                                else
                                    {9288}let pkDisco_8270: bitstring = fail-any in
                                    {9289}in(c, (=pkCli_8226,em1_8271: bitstring));
                                    {9290}let m1_8272: bitstring = em1_8271 in
                                    {9291}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8273: bitstring) = m1_8272 in
                                    {9292}new Ns_8274: bitstring;
                                    {9293}new ST_8275: bitstring;
                                    {9294}new TTL_8276: bitstring;
                                    {9295}let gNs_8277: bitstring = exp(g,Ns_8274) in
                                    {9296}let m2_8278: bitstring = (OpenSecureChannelResponse,gNs_8277,ST_8275,TTL_8276) in
                                    {9297}out(c, m2_8278);
                                    {9298}let Ksrv_8279: bitstring = exp(PartC_8273,Ns_8274) in
                                    {9299}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8279))
                        )
                        else
                            {9300}let pkDisco_8280: bitstring = fail-any in
                            {9301}in(c, (=pkCli_8226,em1_8281: bitstring));
                            {9302}let m1_8282: bitstring = em1_8281 in
                            {9303}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8283: bitstring) = m1_8282 in
                            {9304}new Ns_8284: bitstring;
                            {9305}new ST_8285: bitstring;
                            {9306}new TTL_8286: bitstring;
                            {9307}let gNs_8287: bitstring = exp(g,Ns_8284) in
                            {9308}let m2_8288: bitstring = (OpenSecureChannelResponse,gNs_8287,ST_8285,TTL_8286) in
                            {9309}out(c, m2_8288);
                            {9310}let Ksrv_8289: bitstring = exp(PartC_8283,Ns_8284) in
                            {9311}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8289))
                )
                else
                    {9312}let pkDisco_8290: bitstring = fail-any in
                    {9313}in(c, (=pkCli_8226,em1_8291: bitstring));
                    {9314}let m1_8292: bitstring = em1_8291 in
                    {9315}let (=OpenSecureChannelRequest,=pkCli_8226,PartC_8293: bitstring) = m1_8292 in
                    {9316}new Ns_8294: bitstring;
                    {9317}new ST_8295: bitstring;
                    {9318}new TTL_8296: bitstring;
                    {9319}let gNs_8297: bitstring = exp(g,Ns_8294) in
                    {9320}let m2_8298: bitstring = (OpenSecureChannelResponse,gNs_8297,ST_8295,TTL_8296) in
                    {9321}out(c, m2_8298);
                    {9322}let Ksrv_8299: bitstring = exp(PartC_8293,Ns_8294) in
                    {9323}out(c, senc(mSrv(pkCli_8226,pkSess_8224),Ksrv_8299))
            )
            else
                {9324}let v_8300: bool = (Cli_5609 = B) in
                (
                    {9325}if v_8300 then
                    (
                        {9326}let pkCli_8301: bitstring = pub(skB) in
                        {9327}let v_8302: bool = (Disco_5610 = A) in
                        (
                            {9328}if v_8302 then
                            (
                                {9329}let pkDisco_8303: bitstring = pub(skA) in
                                {9330}in(c, (=pkCli_8301,em1_8304: bitstring));
                                {9331}let m1_8305: bitstring = em1_8304 in
                                {9332}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8306: bitstring) = m1_8305 in
                                {9333}new Ns_8307: bitstring;
                                {9334}new ST_8308: bitstring;
                                {9335}new TTL_8309: bitstring;
                                {9336}let gNs_8310: bitstring = exp(g,Ns_8307) in
                                {9337}let m2_8311: bitstring = (OpenSecureChannelResponse,gNs_8310,ST_8308,TTL_8309) in
                                {9338}out(c, m2_8311);
                                {9339}let Ksrv_8312: bitstring = exp(PartC_8306,Ns_8307) in
                                {9340}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8312))
                            )
                            else
                                {9341}let v_8313: bool = (Disco_5610 = B) in
                                (
                                    {9342}if v_8313 then
                                    (
                                        {9343}let pkDisco_8314: bitstring = pub(skB) in
                                        {9344}in(c, (=pkCli_8301,em1_8315: bitstring));
                                        {9345}let m1_8316: bitstring = em1_8315 in
                                        {9346}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8317: bitstring) = m1_8316 in
                                        {9347}new Ns_8318: bitstring;
                                        {9348}new ST_8319: bitstring;
                                        {9349}new TTL_8320: bitstring;
                                        {9350}let gNs_8321: bitstring = exp(g,Ns_8318) in
                                        {9351}let m2_8322: bitstring = (OpenSecureChannelResponse,gNs_8321,ST_8319,TTL_8320) in
                                        {9352}out(c, m2_8322);
                                        {9353}let Ksrv_8323: bitstring = exp(PartC_8317,Ns_8318) in
                                        {9354}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8323))
                                    )
                                    else
                                        {9355}let v_8324: bool = (Disco_5610 = C) in
                                        (
                                            {9356}if v_8324 then
                                            (
                                                {9357}let pkDisco_8325: bitstring = pub(skC) in
                                                {9358}in(c, (=pkCli_8301,em1_8326: bitstring));
                                                {9359}let m1_8327: bitstring = em1_8326 in
                                                {9360}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8328: bitstring) = m1_8327 in
                                                {9361}new Ns_8329: bitstring;
                                                {9362}new ST_8330: bitstring;
                                                {9363}new TTL_8331: bitstring;
                                                {9364}let gNs_8332: bitstring = exp(g,Ns_8329) in
                                                {9365}let m2_8333: bitstring = (OpenSecureChannelResponse,gNs_8332,ST_8330,TTL_8331) in
                                                {9366}out(c, m2_8333);
                                                {9367}let Ksrv_8334: bitstring = exp(PartC_8328,Ns_8329) in
                                                {9368}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8334))
                                            )
                                            else
                                                {9369}let pkDisco_8335: bitstring = pub(sk(Disco_5610)) in
                                                {9370}in(c, (=pkCli_8301,em1_8336: bitstring));
                                                {9371}let m1_8337: bitstring = em1_8336 in
                                                {9372}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8338: bitstring) = m1_8337 in
                                                {9373}new Ns_8339: bitstring;
                                                {9374}new ST_8340: bitstring;
                                                {9375}new TTL_8341: bitstring;
                                                {9376}let gNs_8342: bitstring = exp(g,Ns_8339) in
                                                {9377}let m2_8343: bitstring = (OpenSecureChannelResponse,gNs_8342,ST_8340,TTL_8341) in
                                                {9378}out(c, m2_8343);
                                                {9379}let Ksrv_8344: bitstring = exp(PartC_8338,Ns_8339) in
                                                {9380}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8344))
                                        )
                                        else
                                            {9381}let pkDisco_8345: bitstring = fail-any in
                                            {9382}in(c, (=pkCli_8301,em1_8346: bitstring));
                                            {9383}let m1_8347: bitstring = em1_8346 in
                                            {9384}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8348: bitstring) = m1_8347 in
                                            {9385}new Ns_8349: bitstring;
                                            {9386}new ST_8350: bitstring;
                                            {9387}new TTL_8351: bitstring;
                                            {9388}let gNs_8352: bitstring = exp(g,Ns_8349) in
                                            {9389}let m2_8353: bitstring = (OpenSecureChannelResponse,gNs_8352,ST_8350,TTL_8351) in
                                            {9390}out(c, m2_8353);
                                            {9391}let Ksrv_8354: bitstring = exp(PartC_8348,Ns_8349) in
                                            {9392}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8354))
                                )
                                else
                                    {9393}let pkDisco_8355: bitstring = fail-any in
                                    {9394}in(c, (=pkCli_8301,em1_8356: bitstring));
                                    {9395}let m1_8357: bitstring = em1_8356 in
                                    {9396}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8358: bitstring) = m1_8357 in
                                    {9397}new Ns_8359: bitstring;
                                    {9398}new ST_8360: bitstring;
                                    {9399}new TTL_8361: bitstring;
                                    {9400}let gNs_8362: bitstring = exp(g,Ns_8359) in
                                    {9401}let m2_8363: bitstring = (OpenSecureChannelResponse,gNs_8362,ST_8360,TTL_8361) in
                                    {9402}out(c, m2_8363);
                                    {9403}let Ksrv_8364: bitstring = exp(PartC_8358,Ns_8359) in
                                    {9404}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8364))
                        )
                        else
                            {9405}let pkDisco_8365: bitstring = fail-any in
                            {9406}in(c, (=pkCli_8301,em1_8366: bitstring));
                            {9407}let m1_8367: bitstring = em1_8366 in
                            {9408}let (=OpenSecureChannelRequest,=pkCli_8301,PartC_8368: bitstring) = m1_8367 in
                            {9409}new Ns_8369: bitstring;
                            {9410}new ST_8370: bitstring;
                            {9411}new TTL_8371: bitstring;
                            {9412}let gNs_8372: bitstring = exp(g,Ns_8369) in
                            {9413}let m2_8373: bitstring = (OpenSecureChannelResponse,gNs_8372,ST_8370,TTL_8371) in
                            {9414}out(c, m2_8373);
                            {9415}let Ksrv_8374: bitstring = exp(PartC_8368,Ns_8369) in
                            {9416}out(c, senc(mSrv(pkCli_8301,pkSess_8224),Ksrv_8374))
                    )
                    else
                        {9417}let v_8375: bool = (Cli_5609 = C) in
                        (
                            {9418}if v_8375 then
                            (
                                {9419}let pkCli_8376: bitstring = pub(skC) in
                                {9420}let v_8377: bool = (Disco_5610 = A) in
                                (
                                    {9421}if v_8377 then
                                    (
                                        {9422}let pkDisco_8378: bitstring = pub(skA) in
                                        {9423}in(c, (=pkCli_8376,em1_8379: bitstring));
                                        {9424}let m1_8380: bitstring = em1_8379 in
                                        {9425}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8381: bitstring) = m1_8380 in
                                        {9426}new Ns_8382: bitstring;
                                        {9427}new ST_8383: bitstring;
                                        {9428}new TTL_8384: bitstring;
                                        {9429}let gNs_8385: bitstring = exp(g,Ns_8382) in
                                        {9430}let m2_8386: bitstring = (OpenSecureChannelResponse,gNs_8385,ST_8383,TTL_8384) in
                                        {9431}out(c, m2_8386);
                                        {9432}let Ksrv_8387: bitstring = exp(PartC_8381,Ns_8382) in
                                        {9433}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8387))
                                    )
                                    else
                                        {9434}let v_8388: bool = (Disco_5610 = B) in
                                        (
                                            {9435}if v_8388 then
                                            (
                                                {9436}let pkDisco_8389: bitstring = pub(skB) in
                                                {9437}in(c, (=pkCli_8376,em1_8390: bitstring));
                                                {9438}let m1_8391: bitstring = em1_8390 in
                                                {9439}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8392: bitstring) = m1_8391 in
                                                {9440}new Ns_8393: bitstring;
                                                {9441}new ST_8394: bitstring;
                                                {9442}new TTL_8395: bitstring;
                                                {9443}let gNs_8396: bitstring = exp(g,Ns_8393) in
                                                {9444}let m2_8397: bitstring = (OpenSecureChannelResponse,gNs_8396,ST_8394,TTL_8395) in
                                                {9445}out(c, m2_8397);
                                                {9446}let Ksrv_8398: bitstring = exp(PartC_8392,Ns_8393) in
                                                {9447}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8398))
                                            )
                                            else
                                                {9448}let v_8399: bool = (Disco_5610 = C) in
                                                (
                                                    {9449}if v_8399 then
                                                    (
                                                        {9450}let pkDisco_8400: bitstring = pub(skC) in
                                                        {9451}in(c, (=pkCli_8376,em1_8401: bitstring));
                                                        {9452}let m1_8402: bitstring = em1_8401 in
                                                        {9453}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8403: bitstring) = m1_8402 in
                                                        {9454}new Ns_8404: bitstring;
                                                        {9455}new ST_8405: bitstring;
                                                        {9456}new TTL_8406: bitstring;
                                                        {9457}let gNs_8407: bitstring = exp(g,Ns_8404) in
                                                        {9458}let m2_8408: bitstring = (OpenSecureChannelResponse,gNs_8407,ST_8405,TTL_8406) in
                                                        {9459}out(c, m2_8408);
                                                        {9460}let Ksrv_8409: bitstring = exp(PartC_8403,Ns_8404) in
                                                        {9461}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8409))
                                                    )
                                                    else
                                                        {9462}let pkDisco_8410: bitstring = pub(sk(Disco_5610)) in
                                                        {9463}in(c, (=pkCli_8376,em1_8411: bitstring));
                                                        {9464}let m1_8412: bitstring = em1_8411 in
                                                        {9465}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8413: bitstring) = m1_8412 in
                                                        {9466}new Ns_8414: bitstring;
                                                        {9467}new ST_8415: bitstring;
                                                        {9468}new TTL_8416: bitstring;
                                                        {9469}let gNs_8417: bitstring = exp(g,Ns_8414) in
                                                        {9470}let m2_8418: bitstring = (OpenSecureChannelResponse,gNs_8417,ST_8415,TTL_8416) in
                                                        {9471}out(c, m2_8418);
                                                        {9472}let Ksrv_8419: bitstring = exp(PartC_8413,Ns_8414) in
                                                        {9473}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8419))
                                                )
                                                else
                                                    {9474}let pkDisco_8420: bitstring = fail-any in
                                                    {9475}in(c, (=pkCli_8376,em1_8421: bitstring));
                                                    {9476}let m1_8422: bitstring = em1_8421 in
                                                    {9477}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8423: bitstring) = m1_8422 in
                                                    {9478}new Ns_8424: bitstring;
                                                    {9479}new ST_8425: bitstring;
                                                    {9480}new TTL_8426: bitstring;
                                                    {9481}let gNs_8427: bitstring = exp(g,Ns_8424) in
                                                    {9482}let m2_8428: bitstring = (OpenSecureChannelResponse,gNs_8427,ST_8425,TTL_8426) in
                                                    {9483}out(c, m2_8428);
                                                    {9484}let Ksrv_8429: bitstring = exp(PartC_8423,Ns_8424) in
                                                    {9485}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8429))
                                        )
                                        else
                                            {9486}let pkDisco_8430: bitstring = fail-any in
                                            {9487}in(c, (=pkCli_8376,em1_8431: bitstring));
                                            {9488}let m1_8432: bitstring = em1_8431 in
                                            {9489}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8433: bitstring) = m1_8432 in
                                            {9490}new Ns_8434: bitstring;
                                            {9491}new ST_8435: bitstring;
                                            {9492}new TTL_8436: bitstring;
                                            {9493}let gNs_8437: bitstring = exp(g,Ns_8434) in
                                            {9494}let m2_8438: bitstring = (OpenSecureChannelResponse,gNs_8437,ST_8435,TTL_8436) in
                                            {9495}out(c, m2_8438);
                                            {9496}let Ksrv_8439: bitstring = exp(PartC_8433,Ns_8434) in
                                            {9497}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8439))
                                )
                                else
                                    {9498}let pkDisco_8440: bitstring = fail-any in
                                    {9499}in(c, (=pkCli_8376,em1_8441: bitstring));
                                    {9500}let m1_8442: bitstring = em1_8441 in
                                    {9501}let (=OpenSecureChannelRequest,=pkCli_8376,PartC_8443: bitstring) = m1_8442 in
                                    {9502}new Ns_8444: bitstring;
                                    {9503}new ST_8445: bitstring;
                                    {9504}new TTL_8446: bitstring;
                                    {9505}let gNs_8447: bitstring = exp(g,Ns_8444) in
                                    {9506}let m2_8448: bitstring = (OpenSecureChannelResponse,gNs_8447,ST_8445,TTL_8446) in
                                    {9507}out(c, m2_8448);
                                    {9508}let Ksrv_8449: bitstring = exp(PartC_8443,Ns_8444) in
                                    {9509}out(c, senc(mSrv(pkCli_8376,pkSess_8224),Ksrv_8449))
                            )
                            else
                                {9510}let pkCli_8450: bitstring = pub(sk(Cli_5609)) in
                                {9511}let v_8451: bool = (Disco_5610 = A) in
                                (
                                    {9512}if v_8451 then
                                    (
                                        {9513}let pkDisco_8452: bitstring = pub(skA) in
                                        {9514}in(c, (=pkCli_8450,em1_8453: bitstring));
                                        {9515}let m1_8454: bitstring = em1_8453 in
                                        {9516}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8455: bitstring) = m1_8454 in
                                        {9517}new Ns_8456: bitstring;
                                        {9518}new ST_8457: bitstring;
                                        {9519}new TTL_8458: bitstring;
                                        {9520}let gNs_8459: bitstring = exp(g,Ns_8456) in
                                        {9521}let m2_8460: bitstring = (OpenSecureChannelResponse,gNs_8459,ST_8457,TTL_8458) in
                                        {9522}out(c, m2_8460);
                                        {9523}let Ksrv_8461: bitstring = exp(PartC_8455,Ns_8456) in
                                        {9524}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8461))
                                    )
                                    else
                                        {9525}let v_8462: bool = (Disco_5610 = B) in
                                        (
                                            {9526}if v_8462 then
                                            (
                                                {9527}let pkDisco_8463: bitstring = pub(skB) in
                                                {9528}in(c, (=pkCli_8450,em1_8464: bitstring));
                                                {9529}let m1_8465: bitstring = em1_8464 in
                                                {9530}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8466: bitstring) = m1_8465 in
                                                {9531}new Ns_8467: bitstring;
                                                {9532}new ST_8468: bitstring;
                                                {9533}new TTL_8469: bitstring;
                                                {9534}let gNs_8470: bitstring = exp(g,Ns_8467) in
                                                {9535}let m2_8471: bitstring = (OpenSecureChannelResponse,gNs_8470,ST_8468,TTL_8469) in
                                                {9536}out(c, m2_8471);
                                                {9537}let Ksrv_8472: bitstring = exp(PartC_8466,Ns_8467) in
                                                {9538}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8472))
                                            )
                                            else
                                                {9539}let v_8473: bool = (Disco_5610 = C) in
                                                (
                                                    {9540}if v_8473 then
                                                    (
                                                        {9541}let pkDisco_8474: bitstring = pub(skC) in
                                                        {9542}in(c, (=pkCli_8450,em1_8475: bitstring));
                                                        {9543}let m1_8476: bitstring = em1_8475 in
                                                        {9544}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8477: bitstring) = m1_8476 in
                                                        {9545}new Ns_8478: bitstring;
                                                        {9546}new ST_8479: bitstring;
                                                        {9547}new TTL_8480: bitstring;
                                                        {9548}let gNs_8481: bitstring = exp(g,Ns_8478) in
                                                        {9549}let m2_8482: bitstring = (OpenSecureChannelResponse,gNs_8481,ST_8479,TTL_8480) in
                                                        {9550}out(c, m2_8482);
                                                        {9551}let Ksrv_8483: bitstring = exp(PartC_8477,Ns_8478) in
                                                        {9552}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8483))
                                                    )
                                                    else
                                                        {9553}let pkDisco_8484: bitstring = pub(sk(Disco_5610)) in
                                                        {9554}in(c, (=pkCli_8450,em1_8485: bitstring));
                                                        {9555}let m1_8486: bitstring = em1_8485 in
                                                        {9556}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8487: bitstring) = m1_8486 in
                                                        {9557}new Ns_8488: bitstring;
                                                        {9558}new ST_8489: bitstring;
                                                        {9559}new TTL_8490: bitstring;
                                                        {9560}let gNs_8491: bitstring = exp(g,Ns_8488) in
                                                        {9561}let m2_8492: bitstring = (OpenSecureChannelResponse,gNs_8491,ST_8489,TTL_8490) in
                                                        {9562}out(c, m2_8492);
                                                        {9563}let Ksrv_8493: bitstring = exp(PartC_8487,Ns_8488) in
                                                        {9564}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8493))
                                                )
                                                else
                                                    {9565}let pkDisco_8494: bitstring = fail-any in
                                                    {9566}in(c, (=pkCli_8450,em1_8495: bitstring));
                                                    {9567}let m1_8496: bitstring = em1_8495 in
                                                    {9568}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8497: bitstring) = m1_8496 in
                                                    {9569}new Ns_8498: bitstring;
                                                    {9570}new ST_8499: bitstring;
                                                    {9571}new TTL_8500: bitstring;
                                                    {9572}let gNs_8501: bitstring = exp(g,Ns_8498) in
                                                    {9573}let m2_8502: bitstring = (OpenSecureChannelResponse,gNs_8501,ST_8499,TTL_8500) in
                                                    {9574}out(c, m2_8502);
                                                    {9575}let Ksrv_8503: bitstring = exp(PartC_8497,Ns_8498) in
                                                    {9576}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8503))
                                        )
                                        else
                                            {9577}let pkDisco_8504: bitstring = fail-any in
                                            {9578}in(c, (=pkCli_8450,em1_8505: bitstring));
                                            {9579}let m1_8506: bitstring = em1_8505 in
                                            {9580}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8507: bitstring) = m1_8506 in
                                            {9581}new Ns_8508: bitstring;
                                            {9582}new ST_8509: bitstring;
                                            {9583}new TTL_8510: bitstring;
                                            {9584}let gNs_8511: bitstring = exp(g,Ns_8508) in
                                            {9585}let m2_8512: bitstring = (OpenSecureChannelResponse,gNs_8511,ST_8509,TTL_8510) in
                                            {9586}out(c, m2_8512);
                                            {9587}let Ksrv_8513: bitstring = exp(PartC_8507,Ns_8508) in
                                            {9588}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8513))
                                )
                                else
                                    {9589}let pkDisco_8514: bitstring = fail-any in
                                    {9590}in(c, (=pkCli_8450,em1_8515: bitstring));
                                    {9591}let m1_8516: bitstring = em1_8515 in
                                    {9592}let (=OpenSecureChannelRequest,=pkCli_8450,PartC_8517: bitstring) = m1_8516 in
                                    {9593}new Ns_8518: bitstring;
                                    {9594}new ST_8519: bitstring;
                                    {9595}new TTL_8520: bitstring;
                                    {9596}let gNs_8521: bitstring = exp(g,Ns_8518) in
                                    {9597}let m2_8522: bitstring = (OpenSecureChannelResponse,gNs_8521,ST_8519,TTL_8520) in
                                    {9598}out(c, m2_8522);
                                    {9599}let Ksrv_8523: bitstring = exp(PartC_8517,Ns_8518) in
                                    {9600}out(c, senc(mSrv(pkCli_8450,pkSess_8224),Ksrv_8523))
                        )
                        else
                            {9601}let pkCli_8524: bitstring = fail-any in
                            {9602}let v_8525: bool = (Disco_5610 = A) in
                            (
                                {9603}if v_8525 then
                                (
                                    {9604}let pkDisco_8526: bitstring = pub(skA) in
                                    {9605}in(c, (=pkCli_8524,em1_8527: bitstring));
                                    {9606}let m1_8528: bitstring = em1_8527 in
                                    {9607}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8529: bitstring) = m1_8528 in
                                    {9608}new Ns_8530: bitstring;
                                    {9609}new ST_8531: bitstring;
                                    {9610}new TTL_8532: bitstring;
                                    {9611}let gNs_8533: bitstring = exp(g,Ns_8530) in
                                    {9612}let m2_8534: bitstring = (OpenSecureChannelResponse,gNs_8533,ST_8531,TTL_8532) in
                                    {9613}out(c, m2_8534);
                                    {9614}let Ksrv_8535: bitstring = exp(PartC_8529,Ns_8530) in
                                    {9615}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8535))
                                )
                                else
                                    {9616}let v_8536: bool = (Disco_5610 = B) in
                                    (
                                        {9617}if v_8536 then
                                        (
                                            {9618}let pkDisco_8537: bitstring = pub(skB) in
                                            {9619}in(c, (=pkCli_8524,em1_8538: bitstring));
                                            {9620}let m1_8539: bitstring = em1_8538 in
                                            {9621}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8540: bitstring) = m1_8539 in
                                            {9622}new Ns_8541: bitstring;
                                            {9623}new ST_8542: bitstring;
                                            {9624}new TTL_8543: bitstring;
                                            {9625}let gNs_8544: bitstring = exp(g,Ns_8541) in
                                            {9626}let m2_8545: bitstring = (OpenSecureChannelResponse,gNs_8544,ST_8542,TTL_8543) in
                                            {9627}out(c, m2_8545);
                                            {9628}let Ksrv_8546: bitstring = exp(PartC_8540,Ns_8541) in
                                            {9629}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8546))
                                        )
                                        else
                                            {9630}let v_8547: bool = (Disco_5610 = C) in
                                            (
                                                {9631}if v_8547 then
                                                (
                                                    {9632}let pkDisco_8548: bitstring = pub(skC) in
                                                    {9633}in(c, (=pkCli_8524,em1_8549: bitstring));
                                                    {9634}let m1_8550: bitstring = em1_8549 in
                                                    {9635}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8551: bitstring) = m1_8550 in
                                                    {9636}new Ns_8552: bitstring;
                                                    {9637}new ST_8553: bitstring;
                                                    {9638}new TTL_8554: bitstring;
                                                    {9639}let gNs_8555: bitstring = exp(g,Ns_8552) in
                                                    {9640}let m2_8556: bitstring = (OpenSecureChannelResponse,gNs_8555,ST_8553,TTL_8554) in
                                                    {9641}out(c, m2_8556);
                                                    {9642}let Ksrv_8557: bitstring = exp(PartC_8551,Ns_8552) in
                                                    {9643}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8557))
                                                )
                                                else
                                                    {9644}let pkDisco_8558: bitstring = pub(sk(Disco_5610)) in
                                                    {9645}in(c, (=pkCli_8524,em1_8559: bitstring));
                                                    {9646}let m1_8560: bitstring = em1_8559 in
                                                    {9647}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8561: bitstring) = m1_8560 in
                                                    {9648}new Ns_8562: bitstring;
                                                    {9649}new ST_8563: bitstring;
                                                    {9650}new TTL_8564: bitstring;
                                                    {9651}let gNs_8565: bitstring = exp(g,Ns_8562) in
                                                    {9652}let m2_8566: bitstring = (OpenSecureChannelResponse,gNs_8565,ST_8563,TTL_8564) in
                                                    {9653}out(c, m2_8566);
                                                    {9654}let Ksrv_8567: bitstring = exp(PartC_8561,Ns_8562) in
                                                    {9655}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8567))
                                            )
                                            else
                                                {9656}let pkDisco_8568: bitstring = fail-any in
                                                {9657}in(c, (=pkCli_8524,em1_8569: bitstring));
                                                {9658}let m1_8570: bitstring = em1_8569 in
                                                {9659}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8571: bitstring) = m1_8570 in
                                                {9660}new Ns_8572: bitstring;
                                                {9661}new ST_8573: bitstring;
                                                {9662}new TTL_8574: bitstring;
                                                {9663}let gNs_8575: bitstring = exp(g,Ns_8572) in
                                                {9664}let m2_8576: bitstring = (OpenSecureChannelResponse,gNs_8575,ST_8573,TTL_8574) in
                                                {9665}out(c, m2_8576);
                                                {9666}let Ksrv_8577: bitstring = exp(PartC_8571,Ns_8572) in
                                                {9667}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8577))
                                    )
                                    else
                                        {9668}let pkDisco_8578: bitstring = fail-any in
                                        {9669}in(c, (=pkCli_8524,em1_8579: bitstring));
                                        {9670}let m1_8580: bitstring = em1_8579 in
                                        {9671}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8581: bitstring) = m1_8580 in
                                        {9672}new Ns_8582: bitstring;
                                        {9673}new ST_8583: bitstring;
                                        {9674}new TTL_8584: bitstring;
                                        {9675}let gNs_8585: bitstring = exp(g,Ns_8582) in
                                        {9676}let m2_8586: bitstring = (OpenSecureChannelResponse,gNs_8585,ST_8583,TTL_8584) in
                                        {9677}out(c, m2_8586);
                                        {9678}let Ksrv_8587: bitstring = exp(PartC_8581,Ns_8582) in
                                        {9679}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8587))
                            )
                            else
                                {9680}let pkDisco_8588: bitstring = fail-any in
                                {9681}in(c, (=pkCli_8524,em1_8589: bitstring));
                                {9682}let m1_8590: bitstring = em1_8589 in
                                {9683}let (=OpenSecureChannelRequest,=pkCli_8524,PartC_8591: bitstring) = m1_8590 in
                                {9684}new Ns_8592: bitstring;
                                {9685}new ST_8593: bitstring;
                                {9686}new TTL_8594: bitstring;
                                {9687}let gNs_8595: bitstring = exp(g,Ns_8592) in
                                {9688}let m2_8596: bitstring = (OpenSecureChannelResponse,gNs_8595,ST_8593,TTL_8594) in
                                {9689}out(c, m2_8596);
                                {9690}let Ksrv_8597: bitstring = exp(PartC_8591,Ns_8592) in
                                {9691}out(c, senc(mSrv(pkCli_8524,pkSess_8224),Ksrv_8597))
                )
                else
                    {9692}let pkCli_8598: bitstring = fail-any in
                    {9693}let v_8599: bool = (Disco_5610 = A) in
                    (
                        {9694}if v_8599 then
                        (
                            {9695}let pkDisco_8600: bitstring = pub(skA) in
                            {9696}in(c, (=pkCli_8598,em1_8601: bitstring));
                            {9697}let m1_8602: bitstring = em1_8601 in
                            {9698}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8603: bitstring) = m1_8602 in
                            {9699}new Ns_8604: bitstring;
                            {9700}new ST_8605: bitstring;
                            {9701}new TTL_8606: bitstring;
                            {9702}let gNs_8607: bitstring = exp(g,Ns_8604) in
                            {9703}let m2_8608: bitstring = (OpenSecureChannelResponse,gNs_8607,ST_8605,TTL_8606) in
                            {9704}out(c, m2_8608);
                            {9705}let Ksrv_8609: bitstring = exp(PartC_8603,Ns_8604) in
                            {9706}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8609))
                        )
                        else
                            {9707}let v_8610: bool = (Disco_5610 = B) in
                            (
                                {9708}if v_8610 then
                                (
                                    {9709}let pkDisco_8611: bitstring = pub(skB) in
                                    {9710}in(c, (=pkCli_8598,em1_8612: bitstring));
                                    {9711}let m1_8613: bitstring = em1_8612 in
                                    {9712}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8614: bitstring) = m1_8613 in
                                    {9713}new Ns_8615: bitstring;
                                    {9714}new ST_8616: bitstring;
                                    {9715}new TTL_8617: bitstring;
                                    {9716}let gNs_8618: bitstring = exp(g,Ns_8615) in
                                    {9717}let m2_8619: bitstring = (OpenSecureChannelResponse,gNs_8618,ST_8616,TTL_8617) in
                                    {9718}out(c, m2_8619);
                                    {9719}let Ksrv_8620: bitstring = exp(PartC_8614,Ns_8615) in
                                    {9720}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8620))
                                )
                                else
                                    {9721}let v_8621: bool = (Disco_5610 = C) in
                                    (
                                        {9722}if v_8621 then
                                        (
                                            {9723}let pkDisco_8622: bitstring = pub(skC) in
                                            {9724}in(c, (=pkCli_8598,em1_8623: bitstring));
                                            {9725}let m1_8624: bitstring = em1_8623 in
                                            {9726}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8625: bitstring) = m1_8624 in
                                            {9727}new Ns_8626: bitstring;
                                            {9728}new ST_8627: bitstring;
                                            {9729}new TTL_8628: bitstring;
                                            {9730}let gNs_8629: bitstring = exp(g,Ns_8626) in
                                            {9731}let m2_8630: bitstring = (OpenSecureChannelResponse,gNs_8629,ST_8627,TTL_8628) in
                                            {9732}out(c, m2_8630);
                                            {9733}let Ksrv_8631: bitstring = exp(PartC_8625,Ns_8626) in
                                            {9734}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8631))
                                        )
                                        else
                                            {9735}let pkDisco_8632: bitstring = pub(sk(Disco_5610)) in
                                            {9736}in(c, (=pkCli_8598,em1_8633: bitstring));
                                            {9737}let m1_8634: bitstring = em1_8633 in
                                            {9738}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8635: bitstring) = m1_8634 in
                                            {9739}new Ns_8636: bitstring;
                                            {9740}new ST_8637: bitstring;
                                            {9741}new TTL_8638: bitstring;
                                            {9742}let gNs_8639: bitstring = exp(g,Ns_8636) in
                                            {9743}let m2_8640: bitstring = (OpenSecureChannelResponse,gNs_8639,ST_8637,TTL_8638) in
                                            {9744}out(c, m2_8640);
                                            {9745}let Ksrv_8641: bitstring = exp(PartC_8635,Ns_8636) in
                                            {9746}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8641))
                                    )
                                    else
                                        {9747}let pkDisco_8642: bitstring = fail-any in
                                        {9748}in(c, (=pkCli_8598,em1_8643: bitstring));
                                        {9749}let m1_8644: bitstring = em1_8643 in
                                        {9750}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8645: bitstring) = m1_8644 in
                                        {9751}new Ns_8646: bitstring;
                                        {9752}new ST_8647: bitstring;
                                        {9753}new TTL_8648: bitstring;
                                        {9754}let gNs_8649: bitstring = exp(g,Ns_8646) in
                                        {9755}let m2_8650: bitstring = (OpenSecureChannelResponse,gNs_8649,ST_8647,TTL_8648) in
                                        {9756}out(c, m2_8650);
                                        {9757}let Ksrv_8651: bitstring = exp(PartC_8645,Ns_8646) in
                                        {9758}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8651))
                            )
                            else
                                {9759}let pkDisco_8652: bitstring = fail-any in
                                {9760}in(c, (=pkCli_8598,em1_8653: bitstring));
                                {9761}let m1_8654: bitstring = em1_8653 in
                                {9762}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8655: bitstring) = m1_8654 in
                                {9763}new Ns_8656: bitstring;
                                {9764}new ST_8657: bitstring;
                                {9765}new TTL_8658: bitstring;
                                {9766}let gNs_8659: bitstring = exp(g,Ns_8656) in
                                {9767}let m2_8660: bitstring = (OpenSecureChannelResponse,gNs_8659,ST_8657,TTL_8658) in
                                {9768}out(c, m2_8660);
                                {9769}let Ksrv_8661: bitstring = exp(PartC_8655,Ns_8656) in
                                {9770}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8661))
                    )
                    else
                        {9771}let pkDisco_8662: bitstring = fail-any in
                        {9772}in(c, (=pkCli_8598,em1_8663: bitstring));
                        {9773}let m1_8664: bitstring = em1_8663 in
                        {9774}let (=OpenSecureChannelRequest,=pkCli_8598,PartC_8665: bitstring) = m1_8664 in
                        {9775}new Ns_8666: bitstring;
                        {9776}new ST_8667: bitstring;
                        {9777}new TTL_8668: bitstring;
                        {9778}let gNs_8669: bitstring = exp(g,Ns_8666) in
                        {9779}let m2_8670: bitstring = (OpenSecureChannelResponse,gNs_8669,ST_8667,TTL_8668) in
                        {9780}out(c, m2_8670);
                        {9781}let Ksrv_8671: bitstring = exp(PartC_8665,Ns_8666) in
                        {9782}out(c, senc(mSrv(pkCli_8598,pkSess_8224),Ksrv_8671))
        )
        else
            {9783}let pkCli_8672: bitstring = fail-any in
            {9784}let v_8673: bool = (Disco_5610 = A) in
            (
                {9785}if v_8673 then
                (
                    {9786}let pkDisco_8674: bitstring = pub(skA) in
                    {9787}in(c, (=pkCli_8672,em1_8675: bitstring));
                    {9788}let m1_8676: bitstring = em1_8675 in
                    {9789}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8677: bitstring) = m1_8676 in
                    {9790}new Ns_8678: bitstring;
                    {9791}new ST_8679: bitstring;
                    {9792}new TTL_8680: bitstring;
                    {9793}let gNs_8681: bitstring = exp(g,Ns_8678) in
                    {9794}let m2_8682: bitstring = (OpenSecureChannelResponse,gNs_8681,ST_8679,TTL_8680) in
                    {9795}out(c, m2_8682);
                    {9796}let Ksrv_8683: bitstring = exp(PartC_8677,Ns_8678) in
                    {9797}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8683))
                )
                else
                    {9798}let v_8684: bool = (Disco_5610 = B) in
                    (
                        {9799}if v_8684 then
                        (
                            {9800}let pkDisco_8685: bitstring = pub(skB) in
                            {9801}in(c, (=pkCli_8672,em1_8686: bitstring));
                            {9802}let m1_8687: bitstring = em1_8686 in
                            {9803}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8688: bitstring) = m1_8687 in
                            {9804}new Ns_8689: bitstring;
                            {9805}new ST_8690: bitstring;
                            {9806}new TTL_8691: bitstring;
                            {9807}let gNs_8692: bitstring = exp(g,Ns_8689) in
                            {9808}let m2_8693: bitstring = (OpenSecureChannelResponse,gNs_8692,ST_8690,TTL_8691) in
                            {9809}out(c, m2_8693);
                            {9810}let Ksrv_8694: bitstring = exp(PartC_8688,Ns_8689) in
                            {9811}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8694))
                        )
                        else
                            {9812}let v_8695: bool = (Disco_5610 = C) in
                            (
                                {9813}if v_8695 then
                                (
                                    {9814}let pkDisco_8696: bitstring = pub(skC) in
                                    {9815}in(c, (=pkCli_8672,em1_8697: bitstring));
                                    {9816}let m1_8698: bitstring = em1_8697 in
                                    {9817}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8699: bitstring) = m1_8698 in
                                    {9818}new Ns_8700: bitstring;
                                    {9819}new ST_8701: bitstring;
                                    {9820}new TTL_8702: bitstring;
                                    {9821}let gNs_8703: bitstring = exp(g,Ns_8700) in
                                    {9822}let m2_8704: bitstring = (OpenSecureChannelResponse,gNs_8703,ST_8701,TTL_8702) in
                                    {9823}out(c, m2_8704);
                                    {9824}let Ksrv_8705: bitstring = exp(PartC_8699,Ns_8700) in
                                    {9825}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8705))
                                )
                                else
                                    {9826}let pkDisco_8706: bitstring = pub(sk(Disco_5610)) in
                                    {9827}in(c, (=pkCli_8672,em1_8707: bitstring));
                                    {9828}let m1_8708: bitstring = em1_8707 in
                                    {9829}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8709: bitstring) = m1_8708 in
                                    {9830}new Ns_8710: bitstring;
                                    {9831}new ST_8711: bitstring;
                                    {9832}new TTL_8712: bitstring;
                                    {9833}let gNs_8713: bitstring = exp(g,Ns_8710) in
                                    {9834}let m2_8714: bitstring = (OpenSecureChannelResponse,gNs_8713,ST_8711,TTL_8712) in
                                    {9835}out(c, m2_8714);
                                    {9836}let Ksrv_8715: bitstring = exp(PartC_8709,Ns_8710) in
                                    {9837}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8715))
                            )
                            else
                                {9838}let pkDisco_8716: bitstring = fail-any in
                                {9839}in(c, (=pkCli_8672,em1_8717: bitstring));
                                {9840}let m1_8718: bitstring = em1_8717 in
                                {9841}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8719: bitstring) = m1_8718 in
                                {9842}new Ns_8720: bitstring;
                                {9843}new ST_8721: bitstring;
                                {9844}new TTL_8722: bitstring;
                                {9845}let gNs_8723: bitstring = exp(g,Ns_8720) in
                                {9846}let m2_8724: bitstring = (OpenSecureChannelResponse,gNs_8723,ST_8721,TTL_8722) in
                                {9847}out(c, m2_8724);
                                {9848}let Ksrv_8725: bitstring = exp(PartC_8719,Ns_8720) in
                                {9849}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8725))
                    )
                    else
                        {9850}let pkDisco_8726: bitstring = fail-any in
                        {9851}in(c, (=pkCli_8672,em1_8727: bitstring));
                        {9852}let m1_8728: bitstring = em1_8727 in
                        {9853}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8729: bitstring) = m1_8728 in
                        {9854}new Ns_8730: bitstring;
                        {9855}new ST_8731: bitstring;
                        {9856}new TTL_8732: bitstring;
                        {9857}let gNs_8733: bitstring = exp(g,Ns_8730) in
                        {9858}let m2_8734: bitstring = (OpenSecureChannelResponse,gNs_8733,ST_8731,TTL_8732) in
                        {9859}out(c, m2_8734);
                        {9860}let Ksrv_8735: bitstring = exp(PartC_8729,Ns_8730) in
                        {9861}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8735))
            )
            else
                {9862}let pkDisco_8736: bitstring = fail-any in
                {9863}in(c, (=pkCli_8672,em1_8737: bitstring));
                {9864}let m1_8738: bitstring = em1_8737 in
                {9865}let (=OpenSecureChannelRequest,=pkCli_8672,PartC_8739: bitstring) = m1_8738 in
                {9866}new Ns_8740: bitstring;
                {9867}new ST_8741: bitstring;
                {9868}new TTL_8742: bitstring;
                {9869}let gNs_8743: bitstring = exp(g,Ns_8740) in
                {9870}let m2_8744: bitstring = (OpenSecureChannelResponse,gNs_8743,ST_8741,TTL_8742) in
                {9871}out(c, m2_8744);
                {9872}let Ksrv_8745: bitstring = exp(PartC_8739,Ns_8740) in
                {9873}out(c, senc(mSrv(pkCli_8672,pkSess_8224),Ksrv_8745))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 143 rules. 532 rules in the queue.
400 rules inserted. The rule base contains 171 rules. 532 rules in the queue.
600 rules inserted. The rule base contains 231 rules. 532 rules in the queue.
800 rules inserted. The rule base contains 231 rules. 530 rules in the queue.
1000 rules inserted. The rule base contains 256 rules. 530 rules in the queue.
1200 rules inserted. The rule base contains 290 rules. 529 rules in the queue.
1400 rules inserted. The rule base contains 325 rules. 506 rules in the queue.
1600 rules inserted. The rule base contains 295 rules. 504 rules in the queue.
1800 rules inserted. The rule base contains 279 rules. 504 rules in the queue.
2000 rules inserted. The rule base contains 347 rules. 632 rules in the queue.
2200 rules inserted. The rule base contains 377 rules. 1188 rules in the queue.
2400 rules inserted. The rule base contains 423 rules. 1530 rules in the queue.
2600 rules inserted. The rule base contains 461 rules. 2280 rules in the queue.
2800 rules inserted. The rule base contains 489 rules. 2941 rules in the queue.
3000 rules inserted. The rule base contains 543 rules. 4162 rules in the queue.
3200 rules inserted. The rule base contains 555 rules. 4350 rules in the queue.
3400 rules inserted. The rule base contains 576 rules. 5392 rules in the queue.
3600 rules inserted. The rule base contains 587 rules. 6057 rules in the queue.
3800 rules inserted. The rule base contains 607 rules. 7100 rules in the queue.
4000 rules inserted. The rule base contains 608 rules. 7188 rules in the queue.
4200 rules inserted. The rule base contains 610 rules. 7186 rules in the queue.
4400 rules inserted. The rule base contains 613 rules. 7186 rules in the queue.
4600 rules inserted. The rule base contains 621 rules. 7278 rules in the queue.
4800 rules inserted. The rule base contains 629 rules. 7372 rules in the queue.
5000 rules inserted. The rule base contains 641 rules. 7560 rules in the queue.
5200 rules inserted. The rule base contains 645 rules. 7560 rules in the queue.
5400 rules inserted. The rule base contains 653 rules. 7652 rules in the queue.
5600 rules inserted. The rule base contains 653 rules. 7645 rules in the queue.
5800 rules inserted. The rule base contains 659 rules. 7737 rules in the queue.
6000 rules inserted. The rule base contains 663 rules. 7737 rules in the queue.
6200 rules inserted. The rule base contains 675 rules. 7925 rules in the queue.
6400 rules inserted. The rule base contains 683 rules. 8019 rules in the queue.
6600 rules inserted. The rule base contains 691 rules. 8111 rules in the queue.
6800 rules inserted. The rule base contains 695 rules. 8111 rules in the queue.
7000 rules inserted. The rule base contains 699 rules. 8109 rules in the queue.
7200 rules inserted. The rule base contains 698 rules. 8102 rules in the queue.
7400 rules inserted. The rule base contains 709 rules. 8290 rules in the queue.
7600 rules inserted. The rule base contains 712 rules. 8288 rules in the queue.
7800 rules inserted. The rule base contains 716 rules. 8284 rules in the queue.
8000 rules inserted. The rule base contains 719 rules. 8281 rules in the queue.
8200 rules inserted. The rule base contains 731 rules. 8560 rules in the queue.
8400 rules inserted. The rule base contains 736 rules. 8652 rules in the queue.
8600 rules inserted. The rule base contains 740 rules. 8648 rules in the queue.
8800 rules inserted. The rule base contains 743 rules. 8645 rules in the queue.
9000 rules inserted. The rule base contains 752 rules. 8830 rules in the queue.
9200 rules inserted. The rule base contains 755 rules. 8827 rules in the queue.
9400 rules inserted. The rule base contains 761 rules. 8918 rules in the queue.
9600 rules inserted. The rule base contains 767 rules. 9009 rules in the queue.
9800 rules inserted. The rule base contains 770 rules. 9006 rules in the queue.
10000 rules inserted. The rule base contains 776 rules. 9097 rules in the queue.
10200 rules inserted. The rule base contains 785 rules. 9282 rules in the queue.
10400 rules inserted. The rule base contains 791 rules. 9373 rules in the queue.
10600 rules inserted. The rule base contains 794 rules. 9370 rules in the queue.
10800 rules inserted. The rule base contains 797 rules. 9367 rules in the queue.
11000 rules inserted. The rule base contains 800 rules. 9364 rules in the queue.
11200 rules inserted. The rule base contains 844 rules. 9320 rules in the queue.
11400 rules inserted. The rule base contains 877 rules. 9285 rules in the queue.
11600 rules inserted. The rule base contains 884 rules. 9270 rules in the queue.
11800 rules inserted. The rule base contains 886 rules. 9268 rules in the queue.
12000 rules inserted. The rule base contains 885 rules. 9261 rules in the queue.
12200 rules inserted. The rule base contains 887 rules. 9259 rules in the queue.
12400 rules inserted. The rule base contains 887 rules. 9252 rules in the queue.
12600 rules inserted. The rule base contains 889 rules. 9250 rules in the queue.
12800 rules inserted. The rule base contains 888 rules. 9243 rules in the queue.
13000 rules inserted. The rule base contains 890 rules. 9241 rules in the queue.
13200 rules inserted. The rule base contains 932 rules. 9199 rules in the queue.
13400 rules inserted. The rule base contains 975 rules. 9155 rules in the queue.
13600 rules inserted. The rule base contains 980 rules. 9243 rules in the queue.
13800 rules inserted. The rule base contains 978 rules. 9144 rules in the queue.
14000 rules inserted. The rule base contains 978 rules. 9137 rules in the queue.
14200 rules inserted. The rule base contains 980 rules. 9135 rules in the queue.
14400 rules inserted. The rule base contains 979 rules. 9128 rules in the queue.
14600 rules inserted. The rule base contains 981 rules. 9126 rules in the queue.
14800 rules inserted. The rule base contains 980 rules. 9119 rules in the queue.
15000 rules inserted. The rule base contains 982 rules. 9117 rules in the queue.
15200 rules inserted. The rule base contains 1009 rules. 9090 rules in the queue.
15400 rules inserted. The rule base contains 1069 rules. 9030 rules in the queue.
15600 rules inserted. The rule base contains 1073 rules. 9028 rules in the queue.
15800 rules inserted. The rule base contains 1106 rules. 8986 rules in the queue.
16000 rules inserted. The rule base contains 1113 rules. 8979 rules in the queue.
16200 rules inserted. The rule base contains 1113 rules. 8979 rules in the queue.
16400 rules inserted. The rule base contains 1113 rules. 8979 rules in the queue.
16600 rules inserted. The rule base contains 1115 rules. 8977 rules in the queue.
16800 rules inserted. The rule base contains 1116 rules. 8976 rules in the queue.
17000 rules inserted. The rule base contains 1157 rules. 8935 rules in the queue.
17200 rules inserted. The rule base contains 1159 rules. 8933 rules in the queue.
17400 rules inserted. The rule base contains 1159 rules. 8933 rules in the queue.
17600 rules inserted. The rule base contains 1160 rules. 8932 rules in the queue.
17800 rules inserted. The rule base contains 1172 rules. 8920 rules in the queue.
18000 rules inserted. The rule base contains 1203 rules. 8889 rules in the queue.
18200 rules inserted. The rule base contains 1204 rules. 8888 rules in the queue.
18400 rules inserted. The rule base contains 1204 rules. 8888 rules in the queue.
18600 rules inserted. The rule base contains 1235 rules. 8857 rules in the queue.
18800 rules inserted. The rule base contains 1247 rules. 8845 rules in the queue.
19000 rules inserted. The rule base contains 1247 rules. 8845 rules in the queue.
19200 rules inserted. The rule base contains 1248 rules. 8844 rules in the queue.
19400 rules inserted. The rule base contains 1250 rules. 8842 rules in the queue.
19600 rules inserted. The rule base contains 1250 rules. 8842 rules in the queue.
19800 rules inserted. The rule base contains 1251 rules. 8841 rules in the queue.
20000 rules inserted. The rule base contains 1293 rules. 8799 rules in the queue.
20200 rules inserted. The rule base contains 1293 rules. 8799 rules in the queue.
20400 rules inserted. The rule base contains 1335 rules. 8757 rules in the queue.
20600 rules inserted. The rule base contains 1444 rules. 8648 rules in the queue.
20800 rules inserted. The rule base contains 1526 rules. 8566 rules in the queue.
21000 rules inserted. The rule base contains 1573 rules. 8518 rules in the queue.
21200 rules inserted. The rule base contains 1649 rules. 8442 rules in the queue.
21400 rules inserted. The rule base contains 1711 rules. 8379 rules in the queue.
21600 rules inserted. The rule base contains 1776 rules. 8314 rules in the queue.
21800 rules inserted. The rule base contains 1806 rules. 8282 rules in the queue.
22000 rules inserted. The rule base contains 1896 rules. 8192 rules in the queue.
22200 rules inserted. The rule base contains 1941 rules. 8146 rules in the queue.
22400 rules inserted. The rule base contains 2023 rules. 8064 rules in the queue.
22600 rules inserted. The rule base contains 2089 rules. 7998 rules in the queue.
22800 rules inserted. The rule base contains 2171 rules. 7916 rules in the queue.
23000 rules inserted. The rule base contains 2217 rules. 7870 rules in the queue.
23200 rules inserted. The rule base contains 2261 rules. 7826 rules in the queue.
23400 rules inserted. The rule base contains 2343 rules. 7743 rules in the queue.
23600 rules inserted. The rule base contains 2386 rules. 7699 rules in the queue.
23800 rules inserted. The rule base contains 2432 rules. 7653 rules in the queue.
24000 rules inserted. The rule base contains 2522 rules. 7563 rules in the queue.
24200 rules inserted. The rule base contains 2612 rules. 7473 rules in the queue.
24400 rules inserted. The rule base contains 2702 rules. 7383 rules in the queue.
24600 rules inserted. The rule base contains 2718 rules. 7367 rules in the queue.
24800 rules inserted. The rule base contains 2799 rules. 7286 rules in the queue.
25000 rules inserted. The rule base contains 2901 rules. 7184 rules in the queue.
25200 rules inserted. The rule base contains 2986 rules. 7100 rules in the queue.
25400 rules inserted. The rule base contains 3030 rules. 7056 rules in the queue.
25600 rules inserted. The rule base contains 3072 rules. 7014 rules in the queue.
25800 rules inserted. The rule base contains 3114 rules. 6972 rules in the queue.
26000 rules inserted. The rule base contains 3182 rules. 6904 rules in the queue.
26200 rules inserted. The rule base contains 3266 rules. 6820 rules in the queue.
26400 rules inserted. The rule base contains 3351 rules. 6736 rules in the queue.
26600 rules inserted. The rule base contains 3355 rules. 6732 rules in the queue.
26800 rules inserted. The rule base contains 3449 rules. 6638 rules in the queue.
27000 rules inserted. The rule base contains 3512 rules. 6576 rules in the queue.
27200 rules inserted. The rule base contains 3587 rules. 6501 rules in the queue.
27400 rules inserted. The rule base contains 3632 rules. 6456 rules in the queue.
27600 rules inserted. The rule base contains 3713 rules. 6375 rules in the queue.
27800 rules inserted. The rule base contains 3795 rules. 6294 rules in the queue.
28000 rules inserted. The rule base contains 3837 rules. 6252 rules in the queue.
28200 rules inserted. The rule base contains 3855 rules. 6234 rules in the queue.
28400 rules inserted. The rule base contains 3921 rules. 6168 rules in the queue.
28600 rules inserted. The rule base contains 3991 rules. 6098 rules in the queue.
28800 rules inserted. The rule base contains 4075 rules. 6014 rules in the queue.
29000 rules inserted. The rule base contains 4161 rules. 5929 rules in the queue.
29200 rules inserted. The rule base contains 4254 rules. 5837 rules in the queue.
29400 rules inserted. The rule base contains 4366 rules. 5725 rules in the queue.
29600 rules inserted. The rule base contains 4465 rules. 5626 rules in the queue.
29800 rules inserted. The rule base contains 4564 rules. 5527 rules in the queue.
30000 rules inserted. The rule base contains 4673 rules. 5418 rules in the queue.
30200 rules inserted. The rule base contains 4763 rules. 5328 rules in the queue.
30400 rules inserted. The rule base contains 4861 rules. 5230 rules in the queue.
30600 rules inserted. The rule base contains 4981 rules. 5110 rules in the queue.
30800 rules inserted. The rule base contains 5076 rules. 5015 rules in the queue.
31000 rules inserted. The rule base contains 5183 rules. 4908 rules in the queue.
31200 rules inserted. The rule base contains 5285 rules. 4806 rules in the queue.
31400 rules inserted. The rule base contains 5384 rules. 4707 rules in the queue.
31600 rules inserted. The rule base contains 5473 rules. 4618 rules in the queue.
31800 rules inserted. The rule base contains 5589 rules. 4502 rules in the queue.
32000 rules inserted. The rule base contains 5669 rules. 4422 rules in the queue.
32200 rules inserted. The rule base contains 5781 rules. 4310 rules in the queue.
32400 rules inserted. The rule base contains 5899 rules. 4195 rules in the queue.
32600 rules inserted. The rule base contains 5979 rules. 4116 rules in the queue.
32800 rules inserted. The rule base contains 6088 rules. 4007 rules in the queue.
33000 rules inserted. The rule base contains 6176 rules. 3920 rules in the queue.
33200 rules inserted. The rule base contains 6298 rules. 3799 rules in the queue.
33400 rules inserted. The rule base contains 6377 rules. 3721 rules in the queue.
33600 rules inserted. The rule base contains 6493 rules. 3608 rules in the queue.
33800 rules inserted. The rule base contains 6595 rules. 3506 rules in the queue.
34000 rules inserted. The rule base contains 6682 rules. 3420 rules in the queue.
34200 rules inserted. The rule base contains 6781 rules. 3322 rules in the queue.
34400 rules inserted. The rule base contains 6886 rules. 3218 rules in the queue.
34600 rules inserted. The rule base contains 6988 rules. 3116 rules in the queue.
34800 rules inserted. The rule base contains 7080 rules. 3025 rules in the queue.
35000 rules inserted. The rule base contains 7192 rules. 2916 rules in the queue.
35200 rules inserted. The rule base contains 7281 rules. 2828 rules in the queue.
35400 rules inserted. The rule base contains 7388 rules. 2721 rules in the queue.
35600 rules inserted. The rule base contains 7493 rules. 2616 rules in the queue.
35800 rules inserted. The rule base contains 7583 rules. 2526 rules in the queue.
36000 rules inserted. The rule base contains 7691 rules. 2418 rules in the queue.
36200 rules inserted. The rule base contains 7799 rules. 2310 rules in the queue.
36400 rules inserted. The rule base contains 7893 rules. 2216 rules in the queue.
36600 rules inserted. The rule base contains 7980 rules. 2122 rules in the queue.
36800 rules inserted. The rule base contains 8092 rules. 2010 rules in the queue.
37000 rules inserted. The rule base contains 8185 rules. 1917 rules in the queue.
37200 rules inserted. The rule base contains 8283 rules. 1812 rules in the queue.
37400 rules inserted. The rule base contains 8386 rules. 1709 rules in the queue.
37600 rules inserted. The rule base contains 8489 rules. 1607 rules in the queue.
37800 rules inserted. The rule base contains 8593 rules. 1504 rules in the queue.
38000 rules inserted. The rule base contains 8656 rules. 1432 rules in the queue.
38200 rules inserted. The rule base contains 8711 rules. 1377 rules in the queue.
38400 rules inserted. The rule base contains 8759 rules. 1329 rules in the queue.
38600 rules inserted. The rule base contains 8812 rules. 1276 rules in the queue.
38800 rules inserted. The rule base contains 8862 rules. 1225 rules in the queue.
39000 rules inserted. The rule base contains 8912 rules. 1174 rules in the queue.
39200 rules inserted. The rule base contains 8967 rules. 1118 rules in the queue.
39400 rules inserted. The rule base contains 9031 rules. 1054 rules in the queue.
39600 rules inserted. The rule base contains 9101 rules. 984 rules in the queue.
39800 rules inserted. The rule base contains 9177 rules. 908 rules in the queue.
40000 rules inserted. The rule base contains 9262 rules. 823 rules in the queue.
40200 rules inserted. The rule base contains 9338 rules. 747 rules in the queue.
40400 rules inserted. The rule base contains 9415 rules. 670 rules in the queue.
40600 rules inserted. The rule base contains 9562 rules. 523 rules in the queue.
40800 rules inserted. The rule base contains 9722 rules. 363 rules in the queue.
41000 rules inserted. The rule base contains 9871 rules. 214 rules in the queue.
41200 rules inserted. The rule base contains 10053 rules. 32 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
goal reachable: attacker(mSrv(pub(skA[]),pub(skC[])))
Abbreviations:
Ns_576437 = Ns_6663[em1_6660 = (OpenSecureChannelRequest,pub(skA[]),g),Sess_5611 = C[],Disco_5610 = A[],Cli_5609 = A[],!1 = @sid_576434]
ST_576438 = ST_6664[em1_6660 = (OpenSecureChannelRequest,pub(skA[]),g),Sess_5611 = C[],Disco_5610 = A[],Cli_5609 = A[],!1 = @sid_576434]
TTL_576439 = TTL_6665[em1_6660 = (OpenSecureChannelRequest,pub(skA[]),g),Sess_5611 = C[],Disco_5610 = A[],Cli_5609 = A[],!1 = @sid_576434]

1. The attacker initially knows C[].
attacker(C[]).

2. The attacker initially knows A[].
attacker(A[]).

3. By 2, the attacker may know A[].
By 2, the attacker may know A[].
By 1, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

4. Using the function g the attacker may obtain g.
attacker(g).

5. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 5, the attacker may know pub(skA[]).
By 4, the attacker may know g.
Using the function 3-tuple the attacker may obtain (OpenSecureChannelRequest,pub(skA[]),g).
attacker((OpenSecureChannelRequest,pub(skA[]),g)).

8. By 5, the attacker may know pub(skA[]).
By 7, the attacker may know (OpenSecureChannelRequest,pub(skA[]),g).
Using the function 2-tuple the attacker may obtain (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g)).
attacker((pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g))).

9. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {5998}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g)) that the attacker may have by 8 may be received at input {7302}.
So the message (OpenSecureChannelResponse,exp(g,Ns_576437),ST_576438,TTL_576439) may be sent to the attacker at output {7310}.
attacker((OpenSecureChannelResponse,exp(g,Ns_576437),ST_576438,TTL_576439)).

10. By 9, the attacker may know (OpenSecureChannelResponse,exp(g,Ns_576437),ST_576438,TTL_576439).
Using the function 2-proj-4-tuple the attacker may obtain exp(g,Ns_576437).
attacker(exp(g,Ns_576437)).

11. The message (A[],A[],C[]) that the attacker may have by 3 may be received at input {5998}.
The message (pub(skA[]),(OpenSecureChannelRequest,pub(skA[]),g)) that the attacker may have by 8 may be received at input {7302}.
So the message senc(mSrv(pub(skA[]),pub(skC[])),exp(g,Ns_576437)) may be sent to the attacker at output {7312}.
attacker(senc(mSrv(pub(skA[]),pub(skC[])),exp(g,Ns_576437))).

12. By 11, the attacker may know senc(mSrv(pub(skA[]),pub(skC[])),exp(g,Ns_576437)).
By 10, the attacker may know exp(g,Ns_576437).
Using the function sdec the attacker may obtain mSrv(pub(skA[]),pub(skC[])).
attacker(mSrv(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {5998} in copy a

in(c, (pub(skA),(OpenSecureChannelRequest,pub(skA),g))) at {7302} in copy a

new Ns_6663 creating Ns_576440 at {7305} in copy a

new ST_6664 creating ST_576441 at {7306} in copy a

new TTL_6665 creating TTL_576442 at {7307} in copy a

out(c, (OpenSecureChannelResponse,exp(g,Ns_576440),ST_576441,TTL_576442)) at {7310} in copy a

out(c, senc(mSrv(pub(skA),pub(skC)),exp(g,Ns_576440))) at {7312} in copy a

The attacker has the message mSrv(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is false.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 143 rules. 532 rules in the queue.
400 rules inserted. The rule base contains 171 rules. 532 rules in the queue.
600 rules inserted. The rule base contains 231 rules. 532 rules in the queue.
800 rules inserted. The rule base contains 231 rules. 530 rules in the queue.
1000 rules inserted. The rule base contains 256 rules. 530 rules in the queue.
1200 rules inserted. The rule base contains 290 rules. 529 rules in the queue.
1400 rules inserted. The rule base contains 325 rules. 506 rules in the queue.
1600 rules inserted. The rule base contains 295 rules. 504 rules in the queue.
1800 rules inserted. The rule base contains 279 rules. 504 rules in the queue.
2000 rules inserted. The rule base contains 347 rules. 632 rules in the queue.
2200 rules inserted. The rule base contains 377 rules. 1188 rules in the queue.
2400 rules inserted. The rule base contains 423 rules. 1530 rules in the queue.
2600 rules inserted. The rule base contains 461 rules. 2280 rules in the queue.
2800 rules inserted. The rule base contains 489 rules. 2941 rules in the queue.
3000 rules inserted. The rule base contains 543 rules. 4162 rules in the queue.
3200 rules inserted. The rule base contains 555 rules. 4350 rules in the queue.
3400 rules inserted. The rule base contains 576 rules. 5392 rules in the queue.
3600 rules inserted. The rule base contains 587 rules. 6057 rules in the queue.
3800 rules inserted. The rule base contains 607 rules. 7100 rules in the queue.
4000 rules inserted. The rule base contains 608 rules. 7188 rules in the queue.
4200 rules inserted. The rule base contains 610 rules. 7186 rules in the queue.
4400 rules inserted. The rule base contains 613 rules. 7186 rules in the queue.
4600 rules inserted. The rule base contains 621 rules. 7278 rules in the queue.
4800 rules inserted. The rule base contains 629 rules. 7372 rules in the queue.
5000 rules inserted. The rule base contains 641 rules. 7560 rules in the queue.
5200 rules inserted. The rule base contains 645 rules. 7560 rules in the queue.
5400 rules inserted. The rule base contains 653 rules. 7652 rules in the queue.
5600 rules inserted. The rule base contains 653 rules. 7645 rules in the queue.
5800 rules inserted. The rule base contains 659 rules. 7737 rules in the queue.
6000 rules inserted. The rule base contains 663 rules. 7737 rules in the queue.
6200 rules inserted. The rule base contains 675 rules. 7925 rules in the queue.
6400 rules inserted. The rule base contains 683 rules. 8019 rules in the queue.
6600 rules inserted. The rule base contains 691 rules. 8111 rules in the queue.
6800 rules inserted. The rule base contains 695 rules. 8111 rules in the queue.
7000 rules inserted. The rule base contains 699 rules. 8109 rules in the queue.
7200 rules inserted. The rule base contains 698 rules. 8102 rules in the queue.
7400 rules inserted. The rule base contains 709 rules. 8290 rules in the queue.
7600 rules inserted. The rule base contains 712 rules. 8288 rules in the queue.
7800 rules inserted. The rule base contains 716 rules. 8284 rules in the queue.
8000 rules inserted. The rule base contains 719 rules. 8281 rules in the queue.
8200 rules inserted. The rule base contains 731 rules. 8560 rules in the queue.
8400 rules inserted. The rule base contains 736 rules. 8652 rules in the queue.
8600 rules inserted. The rule base contains 740 rules. 8648 rules in the queue.
8800 rules inserted. The rule base contains 743 rules. 8645 rules in the queue.
9000 rules inserted. The rule base contains 752 rules. 8830 rules in the queue.
9200 rules inserted. The rule base contains 755 rules. 8827 rules in the queue.
9400 rules inserted. The rule base contains 761 rules. 8918 rules in the queue.
9600 rules inserted. The rule base contains 767 rules. 9009 rules in the queue.
9800 rules inserted. The rule base contains 770 rules. 9006 rules in the queue.
10000 rules inserted. The rule base contains 776 rules. 9097 rules in the queue.
10200 rules inserted. The rule base contains 785 rules. 9282 rules in the queue.
10400 rules inserted. The rule base contains 791 rules. 9373 rules in the queue.
10600 rules inserted. The rule base contains 794 rules. 9370 rules in the queue.
10800 rules inserted. The rule base contains 797 rules. 9367 rules in the queue.
11000 rules inserted. The rule base contains 800 rules. 9364 rules in the queue.
11200 rules inserted. The rule base contains 844 rules. 9320 rules in the queue.
11400 rules inserted. The rule base contains 877 rules. 9285 rules in the queue.
11600 rules inserted. The rule base contains 884 rules. 9270 rules in the queue.
11800 rules inserted. The rule base contains 886 rules. 9268 rules in the queue.
12000 rules inserted. The rule base contains 885 rules. 9261 rules in the queue.
12200 rules inserted. The rule base contains 887 rules. 9259 rules in the queue.
12400 rules inserted. The rule base contains 887 rules. 9252 rules in the queue.
12600 rules inserted. The rule base contains 889 rules. 9250 rules in the queue.
12800 rules inserted. The rule base contains 888 rules. 9243 rules in the queue.
13000 rules inserted. The rule base contains 890 rules. 9241 rules in the queue.
13200 rules inserted. The rule base contains 932 rules. 9199 rules in the queue.
13400 rules inserted. The rule base contains 975 rules. 9155 rules in the queue.
13600 rules inserted. The rule base contains 980 rules. 9243 rules in the queue.
13800 rules inserted. The rule base contains 978 rules. 9144 rules in the queue.
14000 rules inserted. The rule base contains 978 rules. 9137 rules in the queue.
14200 rules inserted. The rule base contains 980 rules. 9135 rules in the queue.
14400 rules inserted. The rule base contains 979 rules. 9128 rules in the queue.
14600 rules inserted. The rule base contains 981 rules. 9126 rules in the queue.
14800 rules inserted. The rule base contains 980 rules. 9119 rules in the queue.
15000 rules inserted. The rule base contains 982 rules. 9117 rules in the queue.
15200 rules inserted. The rule base contains 1009 rules. 9090 rules in the queue.
15400 rules inserted. The rule base contains 1069 rules. 9030 rules in the queue.
15600 rules inserted. The rule base contains 1073 rules. 9028 rules in the queue.
15800 rules inserted. The rule base contains 1106 rules. 8986 rules in the queue.
16000 rules inserted. The rule base contains 1113 rules. 8979 rules in the queue.
16200 rules inserted. The rule base contains 1113 rules. 8979 rules in the queue.
16400 rules inserted. The rule base contains 1113 rules. 8979 rules in the queue.
16600 rules inserted. The rule base contains 1115 rules. 8977 rules in the queue.
16800 rules inserted. The rule base contains 1116 rules. 8976 rules in the queue.
17000 rules inserted. The rule base contains 1157 rules. 8935 rules in the queue.
17200 rules inserted. The rule base contains 1159 rules. 8933 rules in the queue.
17400 rules inserted. The rule base contains 1159 rules. 8933 rules in the queue.
17600 rules inserted. The rule base contains 1160 rules. 8932 rules in the queue.
17800 rules inserted. The rule base contains 1172 rules. 8920 rules in the queue.
18000 rules inserted. The rule base contains 1203 rules. 8889 rules in the queue.
18200 rules inserted. The rule base contains 1204 rules. 8888 rules in the queue.
18400 rules inserted. The rule base contains 1204 rules. 8888 rules in the queue.
18600 rules inserted. The rule base contains 1235 rules. 8857 rules in the queue.
18800 rules inserted. The rule base contains 1247 rules. 8845 rules in the queue.
19000 rules inserted. The rule base contains 1247 rules. 8845 rules in the queue.
19200 rules inserted. The rule base contains 1248 rules. 8844 rules in the queue.
19400 rules inserted. The rule base contains 1250 rules. 8842 rules in the queue.
19600 rules inserted. The rule base contains 1250 rules. 8842 rules in the queue.
19800 rules inserted. The rule base contains 1251 rules. 8841 rules in the queue.
20000 rules inserted. The rule base contains 1293 rules. 8799 rules in the queue.
20200 rules inserted. The rule base contains 1293 rules. 8799 rules in the queue.
20400 rules inserted. The rule base contains 1335 rules. 8757 rules in the queue.
20600 rules inserted. The rule base contains 1444 rules. 8648 rules in the queue.
20800 rules inserted. The rule base contains 1526 rules. 8566 rules in the queue.
21000 rules inserted. The rule base contains 1573 rules. 8518 rules in the queue.
21200 rules inserted. The rule base contains 1649 rules. 8442 rules in the queue.
21400 rules inserted. The rule base contains 1711 rules. 8379 rules in the queue.
21600 rules inserted. The rule base contains 1776 rules. 8314 rules in the queue.
21800 rules inserted. The rule base contains 1806 rules. 8282 rules in the queue.
22000 rules inserted. The rule base contains 1896 rules. 8192 rules in the queue.
22200 rules inserted. The rule base contains 1941 rules. 8146 rules in the queue.
22400 rules inserted. The rule base contains 2023 rules. 8064 rules in the queue.
22600 rules inserted. The rule base contains 2089 rules. 7998 rules in the queue.
22800 rules inserted. The rule base contains 2171 rules. 7916 rules in the queue.
23000 rules inserted. The rule base contains 2217 rules. 7870 rules in the queue.
23200 rules inserted. The rule base contains 2261 rules. 7826 rules in the queue.
23400 rules inserted. The rule base contains 2343 rules. 7743 rules in the queue.
23600 rules inserted. The rule base contains 2386 rules. 7699 rules in the queue.
23800 rules inserted. The rule base contains 2432 rules. 7653 rules in the queue.
24000 rules inserted. The rule base contains 2522 rules. 7563 rules in the queue.
24200 rules inserted. The rule base contains 2612 rules. 7473 rules in the queue.
24400 rules inserted. The rule base contains 2702 rules. 7383 rules in the queue.
24600 rules inserted. The rule base contains 2718 rules. 7367 rules in the queue.
24800 rules inserted. The rule base contains 2799 rules. 7286 rules in the queue.
25000 rules inserted. The rule base contains 2901 rules. 7184 rules in the queue.
25200 rules inserted. The rule base contains 2986 rules. 7100 rules in the queue.
25400 rules inserted. The rule base contains 3030 rules. 7056 rules in the queue.
25600 rules inserted. The rule base contains 3072 rules. 7014 rules in the queue.
25800 rules inserted. The rule base contains 3114 rules. 6972 rules in the queue.
26000 rules inserted. The rule base contains 3182 rules. 6904 rules in the queue.
26200 rules inserted. The rule base contains 3266 rules. 6820 rules in the queue.
26400 rules inserted. The rule base contains 3351 rules. 6736 rules in the queue.
26600 rules inserted. The rule base contains 3355 rules. 6732 rules in the queue.
26800 rules inserted. The rule base contains 3449 rules. 6638 rules in the queue.
27000 rules inserted. The rule base contains 3512 rules. 6576 rules in the queue.
27200 rules inserted. The rule base contains 3587 rules. 6501 rules in the queue.
27400 rules inserted. The rule base contains 3632 rules. 6456 rules in the queue.
27600 rules inserted. The rule base contains 3713 rules. 6375 rules in the queue.
27800 rules inserted. The rule base contains 3795 rules. 6294 rules in the queue.
28000 rules inserted. The rule base contains 3837 rules. 6252 rules in the queue.
28200 rules inserted. The rule base contains 3855 rules. 6234 rules in the queue.
28400 rules inserted. The rule base contains 3921 rules. 6168 rules in the queue.
28600 rules inserted. The rule base contains 3991 rules. 6098 rules in the queue.
28800 rules inserted. The rule base contains 4075 rules. 6014 rules in the queue.
29000 rules inserted. The rule base contains 4161 rules. 5929 rules in the queue.
29200 rules inserted. The rule base contains 4254 rules. 5837 rules in the queue.
29400 rules inserted. The rule base contains 4366 rules. 5725 rules in the queue.
29600 rules inserted. The rule base contains 4465 rules. 5626 rules in the queue.
29800 rules inserted. The rule base contains 4564 rules. 5527 rules in the queue.
30000 rules inserted. The rule base contains 4673 rules. 5418 rules in the queue.
30200 rules inserted. The rule base contains 4763 rules. 5328 rules in the queue.
30400 rules inserted. The rule base contains 4861 rules. 5230 rules in the queue.
30600 rules inserted. The rule base contains 4981 rules. 5110 rules in the queue.
30800 rules inserted. The rule base contains 5076 rules. 5015 rules in the queue.
31000 rules inserted. The rule base contains 5183 rules. 4908 rules in the queue.
31200 rules inserted. The rule base contains 5285 rules. 4806 rules in the queue.
31400 rules inserted. The rule base contains 5384 rules. 4707 rules in the queue.
31600 rules inserted. The rule base contains 5473 rules. 4618 rules in the queue.
31800 rules inserted. The rule base contains 5589 rules. 4502 rules in the queue.
32000 rules inserted. The rule base contains 5669 rules. 4422 rules in the queue.
32200 rules inserted. The rule base contains 5781 rules. 4310 rules in the queue.
32400 rules inserted. The rule base contains 5899 rules. 4195 rules in the queue.
32600 rules inserted. The rule base contains 5979 rules. 4116 rules in the queue.
32800 rules inserted. The rule base contains 6088 rules. 4007 rules in the queue.
33000 rules inserted. The rule base contains 6176 rules. 3920 rules in the queue.
33200 rules inserted. The rule base contains 6298 rules. 3799 rules in the queue.
33400 rules inserted. The rule base contains 6377 rules. 3721 rules in the queue.
33600 rules inserted. The rule base contains 6493 rules. 3608 rules in the queue.
33800 rules inserted. The rule base contains 6595 rules. 3506 rules in the queue.
34000 rules inserted. The rule base contains 6682 rules. 3420 rules in the queue.
34200 rules inserted. The rule base contains 6781 rules. 3322 rules in the queue.
34400 rules inserted. The rule base contains 6886 rules. 3218 rules in the queue.
34600 rules inserted. The rule base contains 6988 rules. 3116 rules in the queue.
34800 rules inserted. The rule base contains 7080 rules. 3025 rules in the queue.
35000 rules inserted. The rule base contains 7192 rules. 2916 rules in the queue.
35200 rules inserted. The rule base contains 7281 rules. 2828 rules in the queue.
35400 rules inserted. The rule base contains 7388 rules. 2721 rules in the queue.
35600 rules inserted. The rule base contains 7493 rules. 2616 rules in the queue.
35800 rules inserted. The rule base contains 7583 rules. 2526 rules in the queue.
36000 rules inserted. The rule base contains 7691 rules. 2418 rules in the queue.
36200 rules inserted. The rule base contains 7799 rules. 2310 rules in the queue.
36400 rules inserted. The rule base contains 7893 rules. 2216 rules in the queue.
36600 rules inserted. The rule base contains 7980 rules. 2122 rules in the queue.
36800 rules inserted. The rule base contains 8092 rules. 2010 rules in the queue.
37000 rules inserted. The rule base contains 8185 rules. 1917 rules in the queue.
37200 rules inserted. The rule base contains 8283 rules. 1812 rules in the queue.
37400 rules inserted. The rule base contains 8386 rules. 1709 rules in the queue.
37600 rules inserted. The rule base contains 8489 rules. 1607 rules in the queue.
37800 rules inserted. The rule base contains 8593 rules. 1504 rules in the queue.
38000 rules inserted. The rule base contains 8656 rules. 1432 rules in the queue.
38200 rules inserted. The rule base contains 8711 rules. 1377 rules in the queue.
38400 rules inserted. The rule base contains 8759 rules. 1329 rules in the queue.
38600 rules inserted. The rule base contains 8812 rules. 1276 rules in the queue.
38800 rules inserted. The rule base contains 8862 rules. 1225 rules in the queue.
39000 rules inserted. The rule base contains 8912 rules. 1174 rules in the queue.
39200 rules inserted. The rule base contains 8967 rules. 1118 rules in the queue.
39400 rules inserted. The rule base contains 9031 rules. 1054 rules in the queue.
39600 rules inserted. The rule base contains 9101 rules. 984 rules in the queue.
39800 rules inserted. The rule base contains 9177 rules. 908 rules in the queue.
40000 rules inserted. The rule base contains 9262 rules. 823 rules in the queue.
40200 rules inserted. The rule base contains 9338 rules. 747 rules in the queue.
40400 rules inserted. The rule base contains 9415 rules. 670 rules in the queue.
40600 rules inserted. The rule base contains 9562 rules. 523 rules in the queue.
40800 rules inserted. The rule base contains 9722 rules. 363 rules in the queue.
41000 rules inserted. The rule base contains 9871 rules. 214 rules in the queue.
41200 rules inserted. The rule base contains 10053 rules. 32 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is true.
