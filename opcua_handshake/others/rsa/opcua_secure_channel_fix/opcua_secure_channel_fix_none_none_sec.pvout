Linear part:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Completing equations...
Completed equations:
exp(exp(g,x_26),y) = exp(exp(g,y),x_26)
Convergent part:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Completing equations...
Completed equations:
dec(enc(x_13,pub(k_14)),k_14) = x_13
Process:
{1}let pkA: bitstring = pub(skA) in
{2}out(c, pkA);
{3}let pkB: bitstring = pub(skB) in
{4}out(c, pkB);
{5}let pkC: bitstring = pub(skC) in
{6}out(c, pkC);
(
    {7}!
    {8}in(c, (Cli: host,Disco: host,Sess: host));
    {9}let v_509: bool = (Cli = A) in
    (
        {10}if v_509 then
        (
            {11}let skCli: bitstring = skA in
            {12}let pkCli: bitstring = pub(skCli) in
            {13}let v_510: bool = (Disco = A) in
            (
                {14}if v_510 then
                (
                    {15}let pkDisco: bitstring = pub(skA) in
                    {16}let v_511: bool = (Sess = A) in
                    (
                        {17}if v_511 then
                        (
                            {18}let pkSess: bitstring = pub(skA) in
                            {19}out(c, GetEndpointRequest);
                            {20}in(c, (=GetEndpointResponse,=pkSess,=None,SP: bitstring,UP: bitstring));
                            {21}new Nc: bitstring;
                            {22}let m1: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc) in
                            {23}out(c, (pkCli,m1));
                            {24}in(c, em2: bitstring);
                            {25}let m2: bitstring = em2 in
                            {26}let (=OpenSecureChannelResponse,=Cli,Ns: bitstring,ST: bitstring,TTL: bitstring) = m2 in
                            {27}let Kcli: bitstring = h((Nc,Ns)) in
                            {28}out(c, senc(mCli(pkCli,pkSess),Kcli))
                        )
                        else
                            {29}let v_512: bool = (Sess = B) in
                            (
                                {30}if v_512 then
                                (
                                    {31}let pkSess_513: bitstring = pub(skB) in
                                    {32}out(c, GetEndpointRequest);
                                    {33}in(c, (=GetEndpointResponse,=pkSess_513,=None,SP_514: bitstring,UP_515: bitstring));
                                    {34}new Nc_516: bitstring;
                                    {35}let m1_517: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_516) in
                                    {36}out(c, (pkCli,m1_517));
                                    {37}in(c, em2_518: bitstring);
                                    {38}let m2_519: bitstring = em2_518 in
                                    {39}let (=OpenSecureChannelResponse,=Cli,Ns_520: bitstring,ST_521: bitstring,TTL_522: bitstring) = m2_519 in
                                    {40}let Kcli_523: bitstring = h((Nc_516,Ns_520)) in
                                    {41}out(c, senc(mCli(pkCli,pkSess_513),Kcli_523))
                                )
                                else
                                    {42}let v_524: bool = (Sess = C) in
                                    (
                                        {43}if v_524 then
                                        (
                                            {44}let pkSess_525: bitstring = pub(skC) in
                                            {45}out(c, GetEndpointRequest);
                                            {46}in(c, (=GetEndpointResponse,=pkSess_525,=None,SP_526: bitstring,UP_527: bitstring));
                                            {47}new Nc_528: bitstring;
                                            {48}let m1_529: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_528) in
                                            {49}out(c, (pkCli,m1_529));
                                            {50}in(c, em2_530: bitstring);
                                            {51}let m2_531: bitstring = em2_530 in
                                            {52}let (=OpenSecureChannelResponse,=Cli,Ns_532: bitstring,ST_533: bitstring,TTL_534: bitstring) = m2_531 in
                                            {53}let Kcli_535: bitstring = h((Nc_528,Ns_532)) in
                                            {54}out(c, senc(mCli(pkCli,pkSess_525),Kcli_535))
                                        )
                                        else
                                            {55}let pkSess_536: bitstring = pub(sk(Sess)) in
                                            {56}out(c, GetEndpointRequest);
                                            {57}in(c, (=GetEndpointResponse,=pkSess_536,=None,SP_537: bitstring,UP_538: bitstring));
                                            {58}new Nc_539: bitstring;
                                            {59}let m1_540: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_539) in
                                            {60}out(c, (pkCli,m1_540));
                                            {61}in(c, em2_541: bitstring);
                                            {62}let m2_542: bitstring = em2_541 in
                                            {63}let (=OpenSecureChannelResponse,=Cli,Ns_543: bitstring,ST_544: bitstring,TTL_545: bitstring) = m2_542 in
                                            {64}let Kcli_546: bitstring = h((Nc_539,Ns_543)) in
                                            {65}out(c, senc(mCli(pkCli,pkSess_536),Kcli_546))
                                    )
                                    else
                                        {66}let pkSess_547: bitstring = fail-any in
                                        {67}out(c, GetEndpointRequest);
                                        {68}in(c, (=GetEndpointResponse,=pkSess_547,=None,SP_548: bitstring,UP_549: bitstring));
                                        {69}new Nc_550: bitstring;
                                        {70}let m1_551: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_550) in
                                        {71}out(c, (pkCli,m1_551));
                                        {72}in(c, em2_552: bitstring);
                                        {73}let m2_553: bitstring = em2_552 in
                                        {74}let (=OpenSecureChannelResponse,=Cli,Ns_554: bitstring,ST_555: bitstring,TTL_556: bitstring) = m2_553 in
                                        {75}let Kcli_557: bitstring = h((Nc_550,Ns_554)) in
                                        {76}out(c, senc(mCli(pkCli,pkSess_547),Kcli_557))
                            )
                            else
                                {77}let pkSess_558: bitstring = fail-any in
                                {78}out(c, GetEndpointRequest);
                                {79}in(c, (=GetEndpointResponse,=pkSess_558,=None,SP_559: bitstring,UP_560: bitstring));
                                {80}new Nc_561: bitstring;
                                {81}let m1_562: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_561) in
                                {82}out(c, (pkCli,m1_562));
                                {83}in(c, em2_563: bitstring);
                                {84}let m2_564: bitstring = em2_563 in
                                {85}let (=OpenSecureChannelResponse,=Cli,Ns_565: bitstring,ST_566: bitstring,TTL_567: bitstring) = m2_564 in
                                {86}let Kcli_568: bitstring = h((Nc_561,Ns_565)) in
                                {87}out(c, senc(mCli(pkCli,pkSess_558),Kcli_568))
                    )
                    else
                        {88}let pkSess_569: bitstring = fail-any in
                        {89}out(c, GetEndpointRequest);
                        {90}in(c, (=GetEndpointResponse,=pkSess_569,=None,SP_570: bitstring,UP_571: bitstring));
                        {91}new Nc_572: bitstring;
                        {92}let m1_573: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_572) in
                        {93}out(c, (pkCli,m1_573));
                        {94}in(c, em2_574: bitstring);
                        {95}let m2_575: bitstring = em2_574 in
                        {96}let (=OpenSecureChannelResponse,=Cli,Ns_576: bitstring,ST_577: bitstring,TTL_578: bitstring) = m2_575 in
                        {97}let Kcli_579: bitstring = h((Nc_572,Ns_576)) in
                        {98}out(c, senc(mCli(pkCli,pkSess_569),Kcli_579))
                )
                else
                    {99}let v_580: bool = (Disco = B) in
                    (
                        {100}if v_580 then
                        (
                            {101}let pkDisco_581: bitstring = pub(skB) in
                            {102}let v_582: bool = (Sess = A) in
                            (
                                {103}if v_582 then
                                (
                                    {104}let pkSess_583: bitstring = pub(skA) in
                                    {105}out(c, GetEndpointRequest);
                                    {106}in(c, (=GetEndpointResponse,=pkSess_583,=None,SP_584: bitstring,UP_585: bitstring));
                                    {107}new Nc_586: bitstring;
                                    {108}let m1_587: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_586) in
                                    {109}out(c, (pkCli,m1_587));
                                    {110}in(c, em2_588: bitstring);
                                    {111}let m2_589: bitstring = em2_588 in
                                    {112}let (=OpenSecureChannelResponse,=Cli,Ns_590: bitstring,ST_591: bitstring,TTL_592: bitstring) = m2_589 in
                                    {113}let Kcli_593: bitstring = h((Nc_586,Ns_590)) in
                                    {114}out(c, senc(mCli(pkCli,pkSess_583),Kcli_593))
                                )
                                else
                                    {115}let v_594: bool = (Sess = B) in
                                    (
                                        {116}if v_594 then
                                        (
                                            {117}let pkSess_595: bitstring = pub(skB) in
                                            {118}out(c, GetEndpointRequest);
                                            {119}in(c, (=GetEndpointResponse,=pkSess_595,=None,SP_596: bitstring,UP_597: bitstring));
                                            {120}new Nc_598: bitstring;
                                            {121}let m1_599: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_598) in
                                            {122}out(c, (pkCli,m1_599));
                                            {123}in(c, em2_600: bitstring);
                                            {124}let m2_601: bitstring = em2_600 in
                                            {125}let (=OpenSecureChannelResponse,=Cli,Ns_602: bitstring,ST_603: bitstring,TTL_604: bitstring) = m2_601 in
                                            {126}let Kcli_605: bitstring = h((Nc_598,Ns_602)) in
                                            {127}out(c, senc(mCli(pkCli,pkSess_595),Kcli_605))
                                        )
                                        else
                                            {128}let v_606: bool = (Sess = C) in
                                            (
                                                {129}if v_606 then
                                                (
                                                    {130}let pkSess_607: bitstring = pub(skC) in
                                                    {131}out(c, GetEndpointRequest);
                                                    {132}in(c, (=GetEndpointResponse,=pkSess_607,=None,SP_608: bitstring,UP_609: bitstring));
                                                    {133}new Nc_610: bitstring;
                                                    {134}let m1_611: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_610) in
                                                    {135}out(c, (pkCli,m1_611));
                                                    {136}in(c, em2_612: bitstring);
                                                    {137}let m2_613: bitstring = em2_612 in
                                                    {138}let (=OpenSecureChannelResponse,=Cli,Ns_614: bitstring,ST_615: bitstring,TTL_616: bitstring) = m2_613 in
                                                    {139}let Kcli_617: bitstring = h((Nc_610,Ns_614)) in
                                                    {140}out(c, senc(mCli(pkCli,pkSess_607),Kcli_617))
                                                )
                                                else
                                                    {141}let pkSess_618: bitstring = pub(sk(Sess)) in
                                                    {142}out(c, GetEndpointRequest);
                                                    {143}in(c, (=GetEndpointResponse,=pkSess_618,=None,SP_619: bitstring,UP_620: bitstring));
                                                    {144}new Nc_621: bitstring;
                                                    {145}let m1_622: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_621) in
                                                    {146}out(c, (pkCli,m1_622));
                                                    {147}in(c, em2_623: bitstring);
                                                    {148}let m2_624: bitstring = em2_623 in
                                                    {149}let (=OpenSecureChannelResponse,=Cli,Ns_625: bitstring,ST_626: bitstring,TTL_627: bitstring) = m2_624 in
                                                    {150}let Kcli_628: bitstring = h((Nc_621,Ns_625)) in
                                                    {151}out(c, senc(mCli(pkCli,pkSess_618),Kcli_628))
                                            )
                                            else
                                                {152}let pkSess_629: bitstring = fail-any in
                                                {153}out(c, GetEndpointRequest);
                                                {154}in(c, (=GetEndpointResponse,=pkSess_629,=None,SP_630: bitstring,UP_631: bitstring));
                                                {155}new Nc_632: bitstring;
                                                {156}let m1_633: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_632) in
                                                {157}out(c, (pkCli,m1_633));
                                                {158}in(c, em2_634: bitstring);
                                                {159}let m2_635: bitstring = em2_634 in
                                                {160}let (=OpenSecureChannelResponse,=Cli,Ns_636: bitstring,ST_637: bitstring,TTL_638: bitstring) = m2_635 in
                                                {161}let Kcli_639: bitstring = h((Nc_632,Ns_636)) in
                                                {162}out(c, senc(mCli(pkCli,pkSess_629),Kcli_639))
                                    )
                                    else
                                        {163}let pkSess_640: bitstring = fail-any in
                                        {164}out(c, GetEndpointRequest);
                                        {165}in(c, (=GetEndpointResponse,=pkSess_640,=None,SP_641: bitstring,UP_642: bitstring));
                                        {166}new Nc_643: bitstring;
                                        {167}let m1_644: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_643) in
                                        {168}out(c, (pkCli,m1_644));
                                        {169}in(c, em2_645: bitstring);
                                        {170}let m2_646: bitstring = em2_645 in
                                        {171}let (=OpenSecureChannelResponse,=Cli,Ns_647: bitstring,ST_648: bitstring,TTL_649: bitstring) = m2_646 in
                                        {172}let Kcli_650: bitstring = h((Nc_643,Ns_647)) in
                                        {173}out(c, senc(mCli(pkCli,pkSess_640),Kcli_650))
                            )
                            else
                                {174}let pkSess_651: bitstring = fail-any in
                                {175}out(c, GetEndpointRequest);
                                {176}in(c, (=GetEndpointResponse,=pkSess_651,=None,SP_652: bitstring,UP_653: bitstring));
                                {177}new Nc_654: bitstring;
                                {178}let m1_655: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_654) in
                                {179}out(c, (pkCli,m1_655));
                                {180}in(c, em2_656: bitstring);
                                {181}let m2_657: bitstring = em2_656 in
                                {182}let (=OpenSecureChannelResponse,=Cli,Ns_658: bitstring,ST_659: bitstring,TTL_660: bitstring) = m2_657 in
                                {183}let Kcli_661: bitstring = h((Nc_654,Ns_658)) in
                                {184}out(c, senc(mCli(pkCli,pkSess_651),Kcli_661))
                        )
                        else
                            {185}let v_662: bool = (Disco = C) in
                            (
                                {186}if v_662 then
                                (
                                    {187}let pkDisco_663: bitstring = pub(skC) in
                                    {188}let v_664: bool = (Sess = A) in
                                    (
                                        {189}if v_664 then
                                        (
                                            {190}let pkSess_665: bitstring = pub(skA) in
                                            {191}out(c, GetEndpointRequest);
                                            {192}in(c, (=GetEndpointResponse,=pkSess_665,=None,SP_666: bitstring,UP_667: bitstring));
                                            {193}new Nc_668: bitstring;
                                            {194}let m1_669: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_668) in
                                            {195}out(c, (pkCli,m1_669));
                                            {196}in(c, em2_670: bitstring);
                                            {197}let m2_671: bitstring = em2_670 in
                                            {198}let (=OpenSecureChannelResponse,=Cli,Ns_672: bitstring,ST_673: bitstring,TTL_674: bitstring) = m2_671 in
                                            {199}let Kcli_675: bitstring = h((Nc_668,Ns_672)) in
                                            {200}out(c, senc(mCli(pkCli,pkSess_665),Kcli_675))
                                        )
                                        else
                                            {201}let v_676: bool = (Sess = B) in
                                            (
                                                {202}if v_676 then
                                                (
                                                    {203}let pkSess_677: bitstring = pub(skB) in
                                                    {204}out(c, GetEndpointRequest);
                                                    {205}in(c, (=GetEndpointResponse,=pkSess_677,=None,SP_678: bitstring,UP_679: bitstring));
                                                    {206}new Nc_680: bitstring;
                                                    {207}let m1_681: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_680) in
                                                    {208}out(c, (pkCli,m1_681));
                                                    {209}in(c, em2_682: bitstring);
                                                    {210}let m2_683: bitstring = em2_682 in
                                                    {211}let (=OpenSecureChannelResponse,=Cli,Ns_684: bitstring,ST_685: bitstring,TTL_686: bitstring) = m2_683 in
                                                    {212}let Kcli_687: bitstring = h((Nc_680,Ns_684)) in
                                                    {213}out(c, senc(mCli(pkCli,pkSess_677),Kcli_687))
                                                )
                                                else
                                                    {214}let v_688: bool = (Sess = C) in
                                                    (
                                                        {215}if v_688 then
                                                        (
                                                            {216}let pkSess_689: bitstring = pub(skC) in
                                                            {217}out(c, GetEndpointRequest);
                                                            {218}in(c, (=GetEndpointResponse,=pkSess_689,=None,SP_690: bitstring,UP_691: bitstring));
                                                            {219}new Nc_692: bitstring;
                                                            {220}let m1_693: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_692) in
                                                            {221}out(c, (pkCli,m1_693));
                                                            {222}in(c, em2_694: bitstring);
                                                            {223}let m2_695: bitstring = em2_694 in
                                                            {224}let (=OpenSecureChannelResponse,=Cli,Ns_696: bitstring,ST_697: bitstring,TTL_698: bitstring) = m2_695 in
                                                            {225}let Kcli_699: bitstring = h((Nc_692,Ns_696)) in
                                                            {226}out(c, senc(mCli(pkCli,pkSess_689),Kcli_699))
                                                        )
                                                        else
                                                            {227}let pkSess_700: bitstring = pub(sk(Sess)) in
                                                            {228}out(c, GetEndpointRequest);
                                                            {229}in(c, (=GetEndpointResponse,=pkSess_700,=None,SP_701: bitstring,UP_702: bitstring));
                                                            {230}new Nc_703: bitstring;
                                                            {231}let m1_704: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_703) in
                                                            {232}out(c, (pkCli,m1_704));
                                                            {233}in(c, em2_705: bitstring);
                                                            {234}let m2_706: bitstring = em2_705 in
                                                            {235}let (=OpenSecureChannelResponse,=Cli,Ns_707: bitstring,ST_708: bitstring,TTL_709: bitstring) = m2_706 in
                                                            {236}let Kcli_710: bitstring = h((Nc_703,Ns_707)) in
                                                            {237}out(c, senc(mCli(pkCli,pkSess_700),Kcli_710))
                                                    )
                                                    else
                                                        {238}let pkSess_711: bitstring = fail-any in
                                                        {239}out(c, GetEndpointRequest);
                                                        {240}in(c, (=GetEndpointResponse,=pkSess_711,=None,SP_712: bitstring,UP_713: bitstring));
                                                        {241}new Nc_714: bitstring;
                                                        {242}let m1_715: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_714) in
                                                        {243}out(c, (pkCli,m1_715));
                                                        {244}in(c, em2_716: bitstring);
                                                        {245}let m2_717: bitstring = em2_716 in
                                                        {246}let (=OpenSecureChannelResponse,=Cli,Ns_718: bitstring,ST_719: bitstring,TTL_720: bitstring) = m2_717 in
                                                        {247}let Kcli_721: bitstring = h((Nc_714,Ns_718)) in
                                                        {248}out(c, senc(mCli(pkCli,pkSess_711),Kcli_721))
                                            )
                                            else
                                                {249}let pkSess_722: bitstring = fail-any in
                                                {250}out(c, GetEndpointRequest);
                                                {251}in(c, (=GetEndpointResponse,=pkSess_722,=None,SP_723: bitstring,UP_724: bitstring));
                                                {252}new Nc_725: bitstring;
                                                {253}let m1_726: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_725) in
                                                {254}out(c, (pkCli,m1_726));
                                                {255}in(c, em2_727: bitstring);
                                                {256}let m2_728: bitstring = em2_727 in
                                                {257}let (=OpenSecureChannelResponse,=Cli,Ns_729: bitstring,ST_730: bitstring,TTL_731: bitstring) = m2_728 in
                                                {258}let Kcli_732: bitstring = h((Nc_725,Ns_729)) in
                                                {259}out(c, senc(mCli(pkCli,pkSess_722),Kcli_732))
                                    )
                                    else
                                        {260}let pkSess_733: bitstring = fail-any in
                                        {261}out(c, GetEndpointRequest);
                                        {262}in(c, (=GetEndpointResponse,=pkSess_733,=None,SP_734: bitstring,UP_735: bitstring));
                                        {263}new Nc_736: bitstring;
                                        {264}let m1_737: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_736) in
                                        {265}out(c, (pkCli,m1_737));
                                        {266}in(c, em2_738: bitstring);
                                        {267}let m2_739: bitstring = em2_738 in
                                        {268}let (=OpenSecureChannelResponse,=Cli,Ns_740: bitstring,ST_741: bitstring,TTL_742: bitstring) = m2_739 in
                                        {269}let Kcli_743: bitstring = h((Nc_736,Ns_740)) in
                                        {270}out(c, senc(mCli(pkCli,pkSess_733),Kcli_743))
                                )
                                else
                                    {271}let pkDisco_744: bitstring = pub(sk(Disco)) in
                                    {272}let v_745: bool = (Sess = A) in
                                    (
                                        {273}if v_745 then
                                        (
                                            {274}let pkSess_746: bitstring = pub(skA) in
                                            {275}out(c, GetEndpointRequest);
                                            {276}in(c, (=GetEndpointResponse,=pkSess_746,=None,SP_747: bitstring,UP_748: bitstring));
                                            {277}new Nc_749: bitstring;
                                            {278}let m1_750: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_749) in
                                            {279}out(c, (pkCli,m1_750));
                                            {280}in(c, em2_751: bitstring);
                                            {281}let m2_752: bitstring = em2_751 in
                                            {282}let (=OpenSecureChannelResponse,=Cli,Ns_753: bitstring,ST_754: bitstring,TTL_755: bitstring) = m2_752 in
                                            {283}let Kcli_756: bitstring = h((Nc_749,Ns_753)) in
                                            {284}out(c, senc(mCli(pkCli,pkSess_746),Kcli_756))
                                        )
                                        else
                                            {285}let v_757: bool = (Sess = B) in
                                            (
                                                {286}if v_757 then
                                                (
                                                    {287}let pkSess_758: bitstring = pub(skB) in
                                                    {288}out(c, GetEndpointRequest);
                                                    {289}in(c, (=GetEndpointResponse,=pkSess_758,=None,SP_759: bitstring,UP_760: bitstring));
                                                    {290}new Nc_761: bitstring;
                                                    {291}let m1_762: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_761) in
                                                    {292}out(c, (pkCli,m1_762));
                                                    {293}in(c, em2_763: bitstring);
                                                    {294}let m2_764: bitstring = em2_763 in
                                                    {295}let (=OpenSecureChannelResponse,=Cli,Ns_765: bitstring,ST_766: bitstring,TTL_767: bitstring) = m2_764 in
                                                    {296}let Kcli_768: bitstring = h((Nc_761,Ns_765)) in
                                                    {297}out(c, senc(mCli(pkCli,pkSess_758),Kcli_768))
                                                )
                                                else
                                                    {298}let v_769: bool = (Sess = C) in
                                                    (
                                                        {299}if v_769 then
                                                        (
                                                            {300}let pkSess_770: bitstring = pub(skC) in
                                                            {301}out(c, GetEndpointRequest);
                                                            {302}in(c, (=GetEndpointResponse,=pkSess_770,=None,SP_771: bitstring,UP_772: bitstring));
                                                            {303}new Nc_773: bitstring;
                                                            {304}let m1_774: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_773) in
                                                            {305}out(c, (pkCli,m1_774));
                                                            {306}in(c, em2_775: bitstring);
                                                            {307}let m2_776: bitstring = em2_775 in
                                                            {308}let (=OpenSecureChannelResponse,=Cli,Ns_777: bitstring,ST_778: bitstring,TTL_779: bitstring) = m2_776 in
                                                            {309}let Kcli_780: bitstring = h((Nc_773,Ns_777)) in
                                                            {310}out(c, senc(mCli(pkCli,pkSess_770),Kcli_780))
                                                        )
                                                        else
                                                            {311}let pkSess_781: bitstring = pub(sk(Sess)) in
                                                            {312}out(c, GetEndpointRequest);
                                                            {313}in(c, (=GetEndpointResponse,=pkSess_781,=None,SP_782: bitstring,UP_783: bitstring));
                                                            {314}new Nc_784: bitstring;
                                                            {315}let m1_785: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_784) in
                                                            {316}out(c, (pkCli,m1_785));
                                                            {317}in(c, em2_786: bitstring);
                                                            {318}let m2_787: bitstring = em2_786 in
                                                            {319}let (=OpenSecureChannelResponse,=Cli,Ns_788: bitstring,ST_789: bitstring,TTL_790: bitstring) = m2_787 in
                                                            {320}let Kcli_791: bitstring = h((Nc_784,Ns_788)) in
                                                            {321}out(c, senc(mCli(pkCli,pkSess_781),Kcli_791))
                                                    )
                                                    else
                                                        {322}let pkSess_792: bitstring = fail-any in
                                                        {323}out(c, GetEndpointRequest);
                                                        {324}in(c, (=GetEndpointResponse,=pkSess_792,=None,SP_793: bitstring,UP_794: bitstring));
                                                        {325}new Nc_795: bitstring;
                                                        {326}let m1_796: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_795) in
                                                        {327}out(c, (pkCli,m1_796));
                                                        {328}in(c, em2_797: bitstring);
                                                        {329}let m2_798: bitstring = em2_797 in
                                                        {330}let (=OpenSecureChannelResponse,=Cli,Ns_799: bitstring,ST_800: bitstring,TTL_801: bitstring) = m2_798 in
                                                        {331}let Kcli_802: bitstring = h((Nc_795,Ns_799)) in
                                                        {332}out(c, senc(mCli(pkCli,pkSess_792),Kcli_802))
                                            )
                                            else
                                                {333}let pkSess_803: bitstring = fail-any in
                                                {334}out(c, GetEndpointRequest);
                                                {335}in(c, (=GetEndpointResponse,=pkSess_803,=None,SP_804: bitstring,UP_805: bitstring));
                                                {336}new Nc_806: bitstring;
                                                {337}let m1_807: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_806) in
                                                {338}out(c, (pkCli,m1_807));
                                                {339}in(c, em2_808: bitstring);
                                                {340}let m2_809: bitstring = em2_808 in
                                                {341}let (=OpenSecureChannelResponse,=Cli,Ns_810: bitstring,ST_811: bitstring,TTL_812: bitstring) = m2_809 in
                                                {342}let Kcli_813: bitstring = h((Nc_806,Ns_810)) in
                                                {343}out(c, senc(mCli(pkCli,pkSess_803),Kcli_813))
                                    )
                                    else
                                        {344}let pkSess_814: bitstring = fail-any in
                                        {345}out(c, GetEndpointRequest);
                                        {346}in(c, (=GetEndpointResponse,=pkSess_814,=None,SP_815: bitstring,UP_816: bitstring));
                                        {347}new Nc_817: bitstring;
                                        {348}let m1_818: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_817) in
                                        {349}out(c, (pkCli,m1_818));
                                        {350}in(c, em2_819: bitstring);
                                        {351}let m2_820: bitstring = em2_819 in
                                        {352}let (=OpenSecureChannelResponse,=Cli,Ns_821: bitstring,ST_822: bitstring,TTL_823: bitstring) = m2_820 in
                                        {353}let Kcli_824: bitstring = h((Nc_817,Ns_821)) in
                                        {354}out(c, senc(mCli(pkCli,pkSess_814),Kcli_824))
                            )
                            else
                                {355}let pkDisco_825: bitstring = fail-any in
                                {356}let v_826: bool = (Sess = A) in
                                (
                                    {357}if v_826 then
                                    (
                                        {358}let pkSess_827: bitstring = pub(skA) in
                                        {359}out(c, GetEndpointRequest);
                                        {360}in(c, (=GetEndpointResponse,=pkSess_827,=None,SP_828: bitstring,UP_829: bitstring));
                                        {361}new Nc_830: bitstring;
                                        {362}let m1_831: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_830) in
                                        {363}out(c, (pkCli,m1_831));
                                        {364}in(c, em2_832: bitstring);
                                        {365}let m2_833: bitstring = em2_832 in
                                        {366}let (=OpenSecureChannelResponse,=Cli,Ns_834: bitstring,ST_835: bitstring,TTL_836: bitstring) = m2_833 in
                                        {367}let Kcli_837: bitstring = h((Nc_830,Ns_834)) in
                                        {368}out(c, senc(mCli(pkCli,pkSess_827),Kcli_837))
                                    )
                                    else
                                        {369}let v_838: bool = (Sess = B) in
                                        (
                                            {370}if v_838 then
                                            (
                                                {371}let pkSess_839: bitstring = pub(skB) in
                                                {372}out(c, GetEndpointRequest);
                                                {373}in(c, (=GetEndpointResponse,=pkSess_839,=None,SP_840: bitstring,UP_841: bitstring));
                                                {374}new Nc_842: bitstring;
                                                {375}let m1_843: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_842) in
                                                {376}out(c, (pkCli,m1_843));
                                                {377}in(c, em2_844: bitstring);
                                                {378}let m2_845: bitstring = em2_844 in
                                                {379}let (=OpenSecureChannelResponse,=Cli,Ns_846: bitstring,ST_847: bitstring,TTL_848: bitstring) = m2_845 in
                                                {380}let Kcli_849: bitstring = h((Nc_842,Ns_846)) in
                                                {381}out(c, senc(mCli(pkCli,pkSess_839),Kcli_849))
                                            )
                                            else
                                                {382}let v_850: bool = (Sess = C) in
                                                (
                                                    {383}if v_850 then
                                                    (
                                                        {384}let pkSess_851: bitstring = pub(skC) in
                                                        {385}out(c, GetEndpointRequest);
                                                        {386}in(c, (=GetEndpointResponse,=pkSess_851,=None,SP_852: bitstring,UP_853: bitstring));
                                                        {387}new Nc_854: bitstring;
                                                        {388}let m1_855: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_854) in
                                                        {389}out(c, (pkCli,m1_855));
                                                        {390}in(c, em2_856: bitstring);
                                                        {391}let m2_857: bitstring = em2_856 in
                                                        {392}let (=OpenSecureChannelResponse,=Cli,Ns_858: bitstring,ST_859: bitstring,TTL_860: bitstring) = m2_857 in
                                                        {393}let Kcli_861: bitstring = h((Nc_854,Ns_858)) in
                                                        {394}out(c, senc(mCli(pkCli,pkSess_851),Kcli_861))
                                                    )
                                                    else
                                                        {395}let pkSess_862: bitstring = pub(sk(Sess)) in
                                                        {396}out(c, GetEndpointRequest);
                                                        {397}in(c, (=GetEndpointResponse,=pkSess_862,=None,SP_863: bitstring,UP_864: bitstring));
                                                        {398}new Nc_865: bitstring;
                                                        {399}let m1_866: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_865) in
                                                        {400}out(c, (pkCli,m1_866));
                                                        {401}in(c, em2_867: bitstring);
                                                        {402}let m2_868: bitstring = em2_867 in
                                                        {403}let (=OpenSecureChannelResponse,=Cli,Ns_869: bitstring,ST_870: bitstring,TTL_871: bitstring) = m2_868 in
                                                        {404}let Kcli_872: bitstring = h((Nc_865,Ns_869)) in
                                                        {405}out(c, senc(mCli(pkCli,pkSess_862),Kcli_872))
                                                )
                                                else
                                                    {406}let pkSess_873: bitstring = fail-any in
                                                    {407}out(c, GetEndpointRequest);
                                                    {408}in(c, (=GetEndpointResponse,=pkSess_873,=None,SP_874: bitstring,UP_875: bitstring));
                                                    {409}new Nc_876: bitstring;
                                                    {410}let m1_877: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_876) in
                                                    {411}out(c, (pkCli,m1_877));
                                                    {412}in(c, em2_878: bitstring);
                                                    {413}let m2_879: bitstring = em2_878 in
                                                    {414}let (=OpenSecureChannelResponse,=Cli,Ns_880: bitstring,ST_881: bitstring,TTL_882: bitstring) = m2_879 in
                                                    {415}let Kcli_883: bitstring = h((Nc_876,Ns_880)) in
                                                    {416}out(c, senc(mCli(pkCli,pkSess_873),Kcli_883))
                                        )
                                        else
                                            {417}let pkSess_884: bitstring = fail-any in
                                            {418}out(c, GetEndpointRequest);
                                            {419}in(c, (=GetEndpointResponse,=pkSess_884,=None,SP_885: bitstring,UP_886: bitstring));
                                            {420}new Nc_887: bitstring;
                                            {421}let m1_888: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_887) in
                                            {422}out(c, (pkCli,m1_888));
                                            {423}in(c, em2_889: bitstring);
                                            {424}let m2_890: bitstring = em2_889 in
                                            {425}let (=OpenSecureChannelResponse,=Cli,Ns_891: bitstring,ST_892: bitstring,TTL_893: bitstring) = m2_890 in
                                            {426}let Kcli_894: bitstring = h((Nc_887,Ns_891)) in
                                            {427}out(c, senc(mCli(pkCli,pkSess_884),Kcli_894))
                                )
                                else
                                    {428}let pkSess_895: bitstring = fail-any in
                                    {429}out(c, GetEndpointRequest);
                                    {430}in(c, (=GetEndpointResponse,=pkSess_895,=None,SP_896: bitstring,UP_897: bitstring));
                                    {431}new Nc_898: bitstring;
                                    {432}let m1_899: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_898) in
                                    {433}out(c, (pkCli,m1_899));
                                    {434}in(c, em2_900: bitstring);
                                    {435}let m2_901: bitstring = em2_900 in
                                    {436}let (=OpenSecureChannelResponse,=Cli,Ns_902: bitstring,ST_903: bitstring,TTL_904: bitstring) = m2_901 in
                                    {437}let Kcli_905: bitstring = h((Nc_898,Ns_902)) in
                                    {438}out(c, senc(mCli(pkCli,pkSess_895),Kcli_905))
                    )
                    else
                        {439}let pkDisco_906: bitstring = fail-any in
                        {440}let v_907: bool = (Sess = A) in
                        (
                            {441}if v_907 then
                            (
                                {442}let pkSess_908: bitstring = pub(skA) in
                                {443}out(c, GetEndpointRequest);
                                {444}in(c, (=GetEndpointResponse,=pkSess_908,=None,SP_909: bitstring,UP_910: bitstring));
                                {445}new Nc_911: bitstring;
                                {446}let m1_912: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_911) in
                                {447}out(c, (pkCli,m1_912));
                                {448}in(c, em2_913: bitstring);
                                {449}let m2_914: bitstring = em2_913 in
                                {450}let (=OpenSecureChannelResponse,=Cli,Ns_915: bitstring,ST_916: bitstring,TTL_917: bitstring) = m2_914 in
                                {451}let Kcli_918: bitstring = h((Nc_911,Ns_915)) in
                                {452}out(c, senc(mCli(pkCli,pkSess_908),Kcli_918))
                            )
                            else
                                {453}let v_919: bool = (Sess = B) in
                                (
                                    {454}if v_919 then
                                    (
                                        {455}let pkSess_920: bitstring = pub(skB) in
                                        {456}out(c, GetEndpointRequest);
                                        {457}in(c, (=GetEndpointResponse,=pkSess_920,=None,SP_921: bitstring,UP_922: bitstring));
                                        {458}new Nc_923: bitstring;
                                        {459}let m1_924: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_923) in
                                        {460}out(c, (pkCli,m1_924));
                                        {461}in(c, em2_925: bitstring);
                                        {462}let m2_926: bitstring = em2_925 in
                                        {463}let (=OpenSecureChannelResponse,=Cli,Ns_927: bitstring,ST_928: bitstring,TTL_929: bitstring) = m2_926 in
                                        {464}let Kcli_930: bitstring = h((Nc_923,Ns_927)) in
                                        {465}out(c, senc(mCli(pkCli,pkSess_920),Kcli_930))
                                    )
                                    else
                                        {466}let v_931: bool = (Sess = C) in
                                        (
                                            {467}if v_931 then
                                            (
                                                {468}let pkSess_932: bitstring = pub(skC) in
                                                {469}out(c, GetEndpointRequest);
                                                {470}in(c, (=GetEndpointResponse,=pkSess_932,=None,SP_933: bitstring,UP_934: bitstring));
                                                {471}new Nc_935: bitstring;
                                                {472}let m1_936: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_935) in
                                                {473}out(c, (pkCli,m1_936));
                                                {474}in(c, em2_937: bitstring);
                                                {475}let m2_938: bitstring = em2_937 in
                                                {476}let (=OpenSecureChannelResponse,=Cli,Ns_939: bitstring,ST_940: bitstring,TTL_941: bitstring) = m2_938 in
                                                {477}let Kcli_942: bitstring = h((Nc_935,Ns_939)) in
                                                {478}out(c, senc(mCli(pkCli,pkSess_932),Kcli_942))
                                            )
                                            else
                                                {479}let pkSess_943: bitstring = pub(sk(Sess)) in
                                                {480}out(c, GetEndpointRequest);
                                                {481}in(c, (=GetEndpointResponse,=pkSess_943,=None,SP_944: bitstring,UP_945: bitstring));
                                                {482}new Nc_946: bitstring;
                                                {483}let m1_947: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_946) in
                                                {484}out(c, (pkCli,m1_947));
                                                {485}in(c, em2_948: bitstring);
                                                {486}let m2_949: bitstring = em2_948 in
                                                {487}let (=OpenSecureChannelResponse,=Cli,Ns_950: bitstring,ST_951: bitstring,TTL_952: bitstring) = m2_949 in
                                                {488}let Kcli_953: bitstring = h((Nc_946,Ns_950)) in
                                                {489}out(c, senc(mCli(pkCli,pkSess_943),Kcli_953))
                                        )
                                        else
                                            {490}let pkSess_954: bitstring = fail-any in
                                            {491}out(c, GetEndpointRequest);
                                            {492}in(c, (=GetEndpointResponse,=pkSess_954,=None,SP_955: bitstring,UP_956: bitstring));
                                            {493}new Nc_957: bitstring;
                                            {494}let m1_958: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_957) in
                                            {495}out(c, (pkCli,m1_958));
                                            {496}in(c, em2_959: bitstring);
                                            {497}let m2_960: bitstring = em2_959 in
                                            {498}let (=OpenSecureChannelResponse,=Cli,Ns_961: bitstring,ST_962: bitstring,TTL_963: bitstring) = m2_960 in
                                            {499}let Kcli_964: bitstring = h((Nc_957,Ns_961)) in
                                            {500}out(c, senc(mCli(pkCli,pkSess_954),Kcli_964))
                                )
                                else
                                    {501}let pkSess_965: bitstring = fail-any in
                                    {502}out(c, GetEndpointRequest);
                                    {503}in(c, (=GetEndpointResponse,=pkSess_965,=None,SP_966: bitstring,UP_967: bitstring));
                                    {504}new Nc_968: bitstring;
                                    {505}let m1_969: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_968) in
                                    {506}out(c, (pkCli,m1_969));
                                    {507}in(c, em2_970: bitstring);
                                    {508}let m2_971: bitstring = em2_970 in
                                    {509}let (=OpenSecureChannelResponse,=Cli,Ns_972: bitstring,ST_973: bitstring,TTL_974: bitstring) = m2_971 in
                                    {510}let Kcli_975: bitstring = h((Nc_968,Ns_972)) in
                                    {511}out(c, senc(mCli(pkCli,pkSess_965),Kcli_975))
                        )
                        else
                            {512}let pkSess_976: bitstring = fail-any in
                            {513}out(c, GetEndpointRequest);
                            {514}in(c, (=GetEndpointResponse,=pkSess_976,=None,SP_977: bitstring,UP_978: bitstring));
                            {515}new Nc_979: bitstring;
                            {516}let m1_980: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_979) in
                            {517}out(c, (pkCli,m1_980));
                            {518}in(c, em2_981: bitstring);
                            {519}let m2_982: bitstring = em2_981 in
                            {520}let (=OpenSecureChannelResponse,=Cli,Ns_983: bitstring,ST_984: bitstring,TTL_985: bitstring) = m2_982 in
                            {521}let Kcli_986: bitstring = h((Nc_979,Ns_983)) in
                            {522}out(c, senc(mCli(pkCli,pkSess_976),Kcli_986))
            )
            else
                {523}let pkDisco_987: bitstring = fail-any in
                {524}let v_988: bool = (Sess = A) in
                (
                    {525}if v_988 then
                    (
                        {526}let pkSess_989: bitstring = pub(skA) in
                        {527}out(c, GetEndpointRequest);
                        {528}in(c, (=GetEndpointResponse,=pkSess_989,=None,SP_990: bitstring,UP_991: bitstring));
                        {529}new Nc_992: bitstring;
                        {530}let m1_993: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_992) in
                        {531}out(c, (pkCli,m1_993));
                        {532}in(c, em2_994: bitstring);
                        {533}let m2_995: bitstring = em2_994 in
                        {534}let (=OpenSecureChannelResponse,=Cli,Ns_996: bitstring,ST_997: bitstring,TTL_998: bitstring) = m2_995 in
                        {535}let Kcli_999: bitstring = h((Nc_992,Ns_996)) in
                        {536}out(c, senc(mCli(pkCli,pkSess_989),Kcli_999))
                    )
                    else
                        {537}let v_1000: bool = (Sess = B) in
                        (
                            {538}if v_1000 then
                            (
                                {539}let pkSess_1001: bitstring = pub(skB) in
                                {540}out(c, GetEndpointRequest);
                                {541}in(c, (=GetEndpointResponse,=pkSess_1001,=None,SP_1002: bitstring,UP_1003: bitstring));
                                {542}new Nc_1004: bitstring;
                                {543}let m1_1005: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1004) in
                                {544}out(c, (pkCli,m1_1005));
                                {545}in(c, em2_1006: bitstring);
                                {546}let m2_1007: bitstring = em2_1006 in
                                {547}let (=OpenSecureChannelResponse,=Cli,Ns_1008: bitstring,ST_1009: bitstring,TTL_1010: bitstring) = m2_1007 in
                                {548}let Kcli_1011: bitstring = h((Nc_1004,Ns_1008)) in
                                {549}out(c, senc(mCli(pkCli,pkSess_1001),Kcli_1011))
                            )
                            else
                                {550}let v_1012: bool = (Sess = C) in
                                (
                                    {551}if v_1012 then
                                    (
                                        {552}let pkSess_1013: bitstring = pub(skC) in
                                        {553}out(c, GetEndpointRequest);
                                        {554}in(c, (=GetEndpointResponse,=pkSess_1013,=None,SP_1014: bitstring,UP_1015: bitstring));
                                        {555}new Nc_1016: bitstring;
                                        {556}let m1_1017: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1016) in
                                        {557}out(c, (pkCli,m1_1017));
                                        {558}in(c, em2_1018: bitstring);
                                        {559}let m2_1019: bitstring = em2_1018 in
                                        {560}let (=OpenSecureChannelResponse,=Cli,Ns_1020: bitstring,ST_1021: bitstring,TTL_1022: bitstring) = m2_1019 in
                                        {561}let Kcli_1023: bitstring = h((Nc_1016,Ns_1020)) in
                                        {562}out(c, senc(mCli(pkCli,pkSess_1013),Kcli_1023))
                                    )
                                    else
                                        {563}let pkSess_1024: bitstring = pub(sk(Sess)) in
                                        {564}out(c, GetEndpointRequest);
                                        {565}in(c, (=GetEndpointResponse,=pkSess_1024,=None,SP_1025: bitstring,UP_1026: bitstring));
                                        {566}new Nc_1027: bitstring;
                                        {567}let m1_1028: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1027) in
                                        {568}out(c, (pkCli,m1_1028));
                                        {569}in(c, em2_1029: bitstring);
                                        {570}let m2_1030: bitstring = em2_1029 in
                                        {571}let (=OpenSecureChannelResponse,=Cli,Ns_1031: bitstring,ST_1032: bitstring,TTL_1033: bitstring) = m2_1030 in
                                        {572}let Kcli_1034: bitstring = h((Nc_1027,Ns_1031)) in
                                        {573}out(c, senc(mCli(pkCli,pkSess_1024),Kcli_1034))
                                )
                                else
                                    {574}let pkSess_1035: bitstring = fail-any in
                                    {575}out(c, GetEndpointRequest);
                                    {576}in(c, (=GetEndpointResponse,=pkSess_1035,=None,SP_1036: bitstring,UP_1037: bitstring));
                                    {577}new Nc_1038: bitstring;
                                    {578}let m1_1039: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1038) in
                                    {579}out(c, (pkCli,m1_1039));
                                    {580}in(c, em2_1040: bitstring);
                                    {581}let m2_1041: bitstring = em2_1040 in
                                    {582}let (=OpenSecureChannelResponse,=Cli,Ns_1042: bitstring,ST_1043: bitstring,TTL_1044: bitstring) = m2_1041 in
                                    {583}let Kcli_1045: bitstring = h((Nc_1038,Ns_1042)) in
                                    {584}out(c, senc(mCli(pkCli,pkSess_1035),Kcli_1045))
                        )
                        else
                            {585}let pkSess_1046: bitstring = fail-any in
                            {586}out(c, GetEndpointRequest);
                            {587}in(c, (=GetEndpointResponse,=pkSess_1046,=None,SP_1047: bitstring,UP_1048: bitstring));
                            {588}new Nc_1049: bitstring;
                            {589}let m1_1050: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1049) in
                            {590}out(c, (pkCli,m1_1050));
                            {591}in(c, em2_1051: bitstring);
                            {592}let m2_1052: bitstring = em2_1051 in
                            {593}let (=OpenSecureChannelResponse,=Cli,Ns_1053: bitstring,ST_1054: bitstring,TTL_1055: bitstring) = m2_1052 in
                            {594}let Kcli_1056: bitstring = h((Nc_1049,Ns_1053)) in
                            {595}out(c, senc(mCli(pkCli,pkSess_1046),Kcli_1056))
                )
                else
                    {596}let pkSess_1057: bitstring = fail-any in
                    {597}out(c, GetEndpointRequest);
                    {598}in(c, (=GetEndpointResponse,=pkSess_1057,=None,SP_1058: bitstring,UP_1059: bitstring));
                    {599}new Nc_1060: bitstring;
                    {600}let m1_1061: bitstring = (OpenSecureChannelRequest,Sess,pkCli,Nc_1060) in
                    {601}out(c, (pkCli,m1_1061));
                    {602}in(c, em2_1062: bitstring);
                    {603}let m2_1063: bitstring = em2_1062 in
                    {604}let (=OpenSecureChannelResponse,=Cli,Ns_1064: bitstring,ST_1065: bitstring,TTL_1066: bitstring) = m2_1063 in
                    {605}let Kcli_1067: bitstring = h((Nc_1060,Ns_1064)) in
                    {606}out(c, senc(mCli(pkCli,pkSess_1057),Kcli_1067))
        )
        else
            {607}let v_1068: bool = (Cli = B) in
            (
                {608}if v_1068 then
                (
                    {609}let skCli_1069: bitstring = skB in
                    {610}let pkCli_1070: bitstring = pub(skCli_1069) in
                    {611}let v_1071: bool = (Disco = A) in
                    (
                        {612}if v_1071 then
                        (
                            {613}let pkDisco_1072: bitstring = pub(skA) in
                            {614}let v_1073: bool = (Sess = A) in
                            (
                                {615}if v_1073 then
                                (
                                    {616}let pkSess_1074: bitstring = pub(skA) in
                                    {617}out(c, GetEndpointRequest);
                                    {618}in(c, (=GetEndpointResponse,=pkSess_1074,=None,SP_1075: bitstring,UP_1076: bitstring));
                                    {619}new Nc_1077: bitstring;
                                    {620}let m1_1078: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1077) in
                                    {621}out(c, (pkCli_1070,m1_1078));
                                    {622}in(c, em2_1079: bitstring);
                                    {623}let m2_1080: bitstring = em2_1079 in
                                    {624}let (=OpenSecureChannelResponse,=Cli,Ns_1081: bitstring,ST_1082: bitstring,TTL_1083: bitstring) = m2_1080 in
                                    {625}let Kcli_1084: bitstring = h((Nc_1077,Ns_1081)) in
                                    {626}out(c, senc(mCli(pkCli_1070,pkSess_1074),Kcli_1084))
                                )
                                else
                                    {627}let v_1085: bool = (Sess = B) in
                                    (
                                        {628}if v_1085 then
                                        (
                                            {629}let pkSess_1086: bitstring = pub(skB) in
                                            {630}out(c, GetEndpointRequest);
                                            {631}in(c, (=GetEndpointResponse,=pkSess_1086,=None,SP_1087: bitstring,UP_1088: bitstring));
                                            {632}new Nc_1089: bitstring;
                                            {633}let m1_1090: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1089) in
                                            {634}out(c, (pkCli_1070,m1_1090));
                                            {635}in(c, em2_1091: bitstring);
                                            {636}let m2_1092: bitstring = em2_1091 in
                                            {637}let (=OpenSecureChannelResponse,=Cli,Ns_1093: bitstring,ST_1094: bitstring,TTL_1095: bitstring) = m2_1092 in
                                            {638}let Kcli_1096: bitstring = h((Nc_1089,Ns_1093)) in
                                            {639}out(c, senc(mCli(pkCli_1070,pkSess_1086),Kcli_1096))
                                        )
                                        else
                                            {640}let v_1097: bool = (Sess = C) in
                                            (
                                                {641}if v_1097 then
                                                (
                                                    {642}let pkSess_1098: bitstring = pub(skC) in
                                                    {643}out(c, GetEndpointRequest);
                                                    {644}in(c, (=GetEndpointResponse,=pkSess_1098,=None,SP_1099: bitstring,UP_1100: bitstring));
                                                    {645}new Nc_1101: bitstring;
                                                    {646}let m1_1102: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1101) in
                                                    {647}out(c, (pkCli_1070,m1_1102));
                                                    {648}in(c, em2_1103: bitstring);
                                                    {649}let m2_1104: bitstring = em2_1103 in
                                                    {650}let (=OpenSecureChannelResponse,=Cli,Ns_1105: bitstring,ST_1106: bitstring,TTL_1107: bitstring) = m2_1104 in
                                                    {651}let Kcli_1108: bitstring = h((Nc_1101,Ns_1105)) in
                                                    {652}out(c, senc(mCli(pkCli_1070,pkSess_1098),Kcli_1108))
                                                )
                                                else
                                                    {653}let pkSess_1109: bitstring = pub(sk(Sess)) in
                                                    {654}out(c, GetEndpointRequest);
                                                    {655}in(c, (=GetEndpointResponse,=pkSess_1109,=None,SP_1110: bitstring,UP_1111: bitstring));
                                                    {656}new Nc_1112: bitstring;
                                                    {657}let m1_1113: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1112) in
                                                    {658}out(c, (pkCli_1070,m1_1113));
                                                    {659}in(c, em2_1114: bitstring);
                                                    {660}let m2_1115: bitstring = em2_1114 in
                                                    {661}let (=OpenSecureChannelResponse,=Cli,Ns_1116: bitstring,ST_1117: bitstring,TTL_1118: bitstring) = m2_1115 in
                                                    {662}let Kcli_1119: bitstring = h((Nc_1112,Ns_1116)) in
                                                    {663}out(c, senc(mCli(pkCli_1070,pkSess_1109),Kcli_1119))
                                            )
                                            else
                                                {664}let pkSess_1120: bitstring = fail-any in
                                                {665}out(c, GetEndpointRequest);
                                                {666}in(c, (=GetEndpointResponse,=pkSess_1120,=None,SP_1121: bitstring,UP_1122: bitstring));
                                                {667}new Nc_1123: bitstring;
                                                {668}let m1_1124: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1123) in
                                                {669}out(c, (pkCli_1070,m1_1124));
                                                {670}in(c, em2_1125: bitstring);
                                                {671}let m2_1126: bitstring = em2_1125 in
                                                {672}let (=OpenSecureChannelResponse,=Cli,Ns_1127: bitstring,ST_1128: bitstring,TTL_1129: bitstring) = m2_1126 in
                                                {673}let Kcli_1130: bitstring = h((Nc_1123,Ns_1127)) in
                                                {674}out(c, senc(mCli(pkCli_1070,pkSess_1120),Kcli_1130))
                                    )
                                    else
                                        {675}let pkSess_1131: bitstring = fail-any in
                                        {676}out(c, GetEndpointRequest);
                                        {677}in(c, (=GetEndpointResponse,=pkSess_1131,=None,SP_1132: bitstring,UP_1133: bitstring));
                                        {678}new Nc_1134: bitstring;
                                        {679}let m1_1135: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1134) in
                                        {680}out(c, (pkCli_1070,m1_1135));
                                        {681}in(c, em2_1136: bitstring);
                                        {682}let m2_1137: bitstring = em2_1136 in
                                        {683}let (=OpenSecureChannelResponse,=Cli,Ns_1138: bitstring,ST_1139: bitstring,TTL_1140: bitstring) = m2_1137 in
                                        {684}let Kcli_1141: bitstring = h((Nc_1134,Ns_1138)) in
                                        {685}out(c, senc(mCli(pkCli_1070,pkSess_1131),Kcli_1141))
                            )
                            else
                                {686}let pkSess_1142: bitstring = fail-any in
                                {687}out(c, GetEndpointRequest);
                                {688}in(c, (=GetEndpointResponse,=pkSess_1142,=None,SP_1143: bitstring,UP_1144: bitstring));
                                {689}new Nc_1145: bitstring;
                                {690}let m1_1146: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1145) in
                                {691}out(c, (pkCli_1070,m1_1146));
                                {692}in(c, em2_1147: bitstring);
                                {693}let m2_1148: bitstring = em2_1147 in
                                {694}let (=OpenSecureChannelResponse,=Cli,Ns_1149: bitstring,ST_1150: bitstring,TTL_1151: bitstring) = m2_1148 in
                                {695}let Kcli_1152: bitstring = h((Nc_1145,Ns_1149)) in
                                {696}out(c, senc(mCli(pkCli_1070,pkSess_1142),Kcli_1152))
                        )
                        else
                            {697}let v_1153: bool = (Disco = B) in
                            (
                                {698}if v_1153 then
                                (
                                    {699}let pkDisco_1154: bitstring = pub(skB) in
                                    {700}let v_1155: bool = (Sess = A) in
                                    (
                                        {701}if v_1155 then
                                        (
                                            {702}let pkSess_1156: bitstring = pub(skA) in
                                            {703}out(c, GetEndpointRequest);
                                            {704}in(c, (=GetEndpointResponse,=pkSess_1156,=None,SP_1157: bitstring,UP_1158: bitstring));
                                            {705}new Nc_1159: bitstring;
                                            {706}let m1_1160: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1159) in
                                            {707}out(c, (pkCli_1070,m1_1160));
                                            {708}in(c, em2_1161: bitstring);
                                            {709}let m2_1162: bitstring = em2_1161 in
                                            {710}let (=OpenSecureChannelResponse,=Cli,Ns_1163: bitstring,ST_1164: bitstring,TTL_1165: bitstring) = m2_1162 in
                                            {711}let Kcli_1166: bitstring = h((Nc_1159,Ns_1163)) in
                                            {712}out(c, senc(mCli(pkCli_1070,pkSess_1156),Kcli_1166))
                                        )
                                        else
                                            {713}let v_1167: bool = (Sess = B) in
                                            (
                                                {714}if v_1167 then
                                                (
                                                    {715}let pkSess_1168: bitstring = pub(skB) in
                                                    {716}out(c, GetEndpointRequest);
                                                    {717}in(c, (=GetEndpointResponse,=pkSess_1168,=None,SP_1169: bitstring,UP_1170: bitstring));
                                                    {718}new Nc_1171: bitstring;
                                                    {719}let m1_1172: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1171) in
                                                    {720}out(c, (pkCli_1070,m1_1172));
                                                    {721}in(c, em2_1173: bitstring);
                                                    {722}let m2_1174: bitstring = em2_1173 in
                                                    {723}let (=OpenSecureChannelResponse,=Cli,Ns_1175: bitstring,ST_1176: bitstring,TTL_1177: bitstring) = m2_1174 in
                                                    {724}let Kcli_1178: bitstring = h((Nc_1171,Ns_1175)) in
                                                    {725}out(c, senc(mCli(pkCli_1070,pkSess_1168),Kcli_1178))
                                                )
                                                else
                                                    {726}let v_1179: bool = (Sess = C) in
                                                    (
                                                        {727}if v_1179 then
                                                        (
                                                            {728}let pkSess_1180: bitstring = pub(skC) in
                                                            {729}out(c, GetEndpointRequest);
                                                            {730}in(c, (=GetEndpointResponse,=pkSess_1180,=None,SP_1181: bitstring,UP_1182: bitstring));
                                                            {731}new Nc_1183: bitstring;
                                                            {732}let m1_1184: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1183) in
                                                            {733}out(c, (pkCli_1070,m1_1184));
                                                            {734}in(c, em2_1185: bitstring);
                                                            {735}let m2_1186: bitstring = em2_1185 in
                                                            {736}let (=OpenSecureChannelResponse,=Cli,Ns_1187: bitstring,ST_1188: bitstring,TTL_1189: bitstring) = m2_1186 in
                                                            {737}let Kcli_1190: bitstring = h((Nc_1183,Ns_1187)) in
                                                            {738}out(c, senc(mCli(pkCli_1070,pkSess_1180),Kcli_1190))
                                                        )
                                                        else
                                                            {739}let pkSess_1191: bitstring = pub(sk(Sess)) in
                                                            {740}out(c, GetEndpointRequest);
                                                            {741}in(c, (=GetEndpointResponse,=pkSess_1191,=None,SP_1192: bitstring,UP_1193: bitstring));
                                                            {742}new Nc_1194: bitstring;
                                                            {743}let m1_1195: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1194) in
                                                            {744}out(c, (pkCli_1070,m1_1195));
                                                            {745}in(c, em2_1196: bitstring);
                                                            {746}let m2_1197: bitstring = em2_1196 in
                                                            {747}let (=OpenSecureChannelResponse,=Cli,Ns_1198: bitstring,ST_1199: bitstring,TTL_1200: bitstring) = m2_1197 in
                                                            {748}let Kcli_1201: bitstring = h((Nc_1194,Ns_1198)) in
                                                            {749}out(c, senc(mCli(pkCli_1070,pkSess_1191),Kcli_1201))
                                                    )
                                                    else
                                                        {750}let pkSess_1202: bitstring = fail-any in
                                                        {751}out(c, GetEndpointRequest);
                                                        {752}in(c, (=GetEndpointResponse,=pkSess_1202,=None,SP_1203: bitstring,UP_1204: bitstring));
                                                        {753}new Nc_1205: bitstring;
                                                        {754}let m1_1206: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1205) in
                                                        {755}out(c, (pkCli_1070,m1_1206));
                                                        {756}in(c, em2_1207: bitstring);
                                                        {757}let m2_1208: bitstring = em2_1207 in
                                                        {758}let (=OpenSecureChannelResponse,=Cli,Ns_1209: bitstring,ST_1210: bitstring,TTL_1211: bitstring) = m2_1208 in
                                                        {759}let Kcli_1212: bitstring = h((Nc_1205,Ns_1209)) in
                                                        {760}out(c, senc(mCli(pkCli_1070,pkSess_1202),Kcli_1212))
                                            )
                                            else
                                                {761}let pkSess_1213: bitstring = fail-any in
                                                {762}out(c, GetEndpointRequest);
                                                {763}in(c, (=GetEndpointResponse,=pkSess_1213,=None,SP_1214: bitstring,UP_1215: bitstring));
                                                {764}new Nc_1216: bitstring;
                                                {765}let m1_1217: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1216) in
                                                {766}out(c, (pkCli_1070,m1_1217));
                                                {767}in(c, em2_1218: bitstring);
                                                {768}let m2_1219: bitstring = em2_1218 in
                                                {769}let (=OpenSecureChannelResponse,=Cli,Ns_1220: bitstring,ST_1221: bitstring,TTL_1222: bitstring) = m2_1219 in
                                                {770}let Kcli_1223: bitstring = h((Nc_1216,Ns_1220)) in
                                                {771}out(c, senc(mCli(pkCli_1070,pkSess_1213),Kcli_1223))
                                    )
                                    else
                                        {772}let pkSess_1224: bitstring = fail-any in
                                        {773}out(c, GetEndpointRequest);
                                        {774}in(c, (=GetEndpointResponse,=pkSess_1224,=None,SP_1225: bitstring,UP_1226: bitstring));
                                        {775}new Nc_1227: bitstring;
                                        {776}let m1_1228: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1227) in
                                        {777}out(c, (pkCli_1070,m1_1228));
                                        {778}in(c, em2_1229: bitstring);
                                        {779}let m2_1230: bitstring = em2_1229 in
                                        {780}let (=OpenSecureChannelResponse,=Cli,Ns_1231: bitstring,ST_1232: bitstring,TTL_1233: bitstring) = m2_1230 in
                                        {781}let Kcli_1234: bitstring = h((Nc_1227,Ns_1231)) in
                                        {782}out(c, senc(mCli(pkCli_1070,pkSess_1224),Kcli_1234))
                                )
                                else
                                    {783}let v_1235: bool = (Disco = C) in
                                    (
                                        {784}if v_1235 then
                                        (
                                            {785}let pkDisco_1236: bitstring = pub(skC) in
                                            {786}let v_1237: bool = (Sess = A) in
                                            (
                                                {787}if v_1237 then
                                                (
                                                    {788}let pkSess_1238: bitstring = pub(skA) in
                                                    {789}out(c, GetEndpointRequest);
                                                    {790}in(c, (=GetEndpointResponse,=pkSess_1238,=None,SP_1239: bitstring,UP_1240: bitstring));
                                                    {791}new Nc_1241: bitstring;
                                                    {792}let m1_1242: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1241) in
                                                    {793}out(c, (pkCli_1070,m1_1242));
                                                    {794}in(c, em2_1243: bitstring);
                                                    {795}let m2_1244: bitstring = em2_1243 in
                                                    {796}let (=OpenSecureChannelResponse,=Cli,Ns_1245: bitstring,ST_1246: bitstring,TTL_1247: bitstring) = m2_1244 in
                                                    {797}let Kcli_1248: bitstring = h((Nc_1241,Ns_1245)) in
                                                    {798}out(c, senc(mCli(pkCli_1070,pkSess_1238),Kcli_1248))
                                                )
                                                else
                                                    {799}let v_1249: bool = (Sess = B) in
                                                    (
                                                        {800}if v_1249 then
                                                        (
                                                            {801}let pkSess_1250: bitstring = pub(skB) in
                                                            {802}out(c, GetEndpointRequest);
                                                            {803}in(c, (=GetEndpointResponse,=pkSess_1250,=None,SP_1251: bitstring,UP_1252: bitstring));
                                                            {804}new Nc_1253: bitstring;
                                                            {805}let m1_1254: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1253) in
                                                            {806}out(c, (pkCli_1070,m1_1254));
                                                            {807}in(c, em2_1255: bitstring);
                                                            {808}let m2_1256: bitstring = em2_1255 in
                                                            {809}let (=OpenSecureChannelResponse,=Cli,Ns_1257: bitstring,ST_1258: bitstring,TTL_1259: bitstring) = m2_1256 in
                                                            {810}let Kcli_1260: bitstring = h((Nc_1253,Ns_1257)) in
                                                            {811}out(c, senc(mCli(pkCli_1070,pkSess_1250),Kcli_1260))
                                                        )
                                                        else
                                                            {812}let v_1261: bool = (Sess = C) in
                                                            (
                                                                {813}if v_1261 then
                                                                (
                                                                    {814}let pkSess_1262: bitstring = pub(skC) in
                                                                    {815}out(c, GetEndpointRequest);
                                                                    {816}in(c, (=GetEndpointResponse,=pkSess_1262,=None,SP_1263: bitstring,UP_1264: bitstring));
                                                                    {817}new Nc_1265: bitstring;
                                                                    {818}let m1_1266: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1265) in
                                                                    {819}out(c, (pkCli_1070,m1_1266));
                                                                    {820}in(c, em2_1267: bitstring);
                                                                    {821}let m2_1268: bitstring = em2_1267 in
                                                                    {822}let (=OpenSecureChannelResponse,=Cli,Ns_1269: bitstring,ST_1270: bitstring,TTL_1271: bitstring) = m2_1268 in
                                                                    {823}let Kcli_1272: bitstring = h((Nc_1265,Ns_1269)) in
                                                                    {824}out(c, senc(mCli(pkCli_1070,pkSess_1262),Kcli_1272))
                                                                )
                                                                else
                                                                    {825}let pkSess_1273: bitstring = pub(sk(Sess)) in
                                                                    {826}out(c, GetEndpointRequest);
                                                                    {827}in(c, (=GetEndpointResponse,=pkSess_1273,=None,SP_1274: bitstring,UP_1275: bitstring));
                                                                    {828}new Nc_1276: bitstring;
                                                                    {829}let m1_1277: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1276) in
                                                                    {830}out(c, (pkCli_1070,m1_1277));
                                                                    {831}in(c, em2_1278: bitstring);
                                                                    {832}let m2_1279: bitstring = em2_1278 in
                                                                    {833}let (=OpenSecureChannelResponse,=Cli,Ns_1280: bitstring,ST_1281: bitstring,TTL_1282: bitstring) = m2_1279 in
                                                                    {834}let Kcli_1283: bitstring = h((Nc_1276,Ns_1280)) in
                                                                    {835}out(c, senc(mCli(pkCli_1070,pkSess_1273),Kcli_1283))
                                                            )
                                                            else
                                                                {836}let pkSess_1284: bitstring = fail-any in
                                                                {837}out(c, GetEndpointRequest);
                                                                {838}in(c, (=GetEndpointResponse,=pkSess_1284,=None,SP_1285: bitstring,UP_1286: bitstring));
                                                                {839}new Nc_1287: bitstring;
                                                                {840}let m1_1288: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1287) in
                                                                {841}out(c, (pkCli_1070,m1_1288));
                                                                {842}in(c, em2_1289: bitstring);
                                                                {843}let m2_1290: bitstring = em2_1289 in
                                                                {844}let (=OpenSecureChannelResponse,=Cli,Ns_1291: bitstring,ST_1292: bitstring,TTL_1293: bitstring) = m2_1290 in
                                                                {845}let Kcli_1294: bitstring = h((Nc_1287,Ns_1291)) in
                                                                {846}out(c, senc(mCli(pkCli_1070,pkSess_1284),Kcli_1294))
                                                    )
                                                    else
                                                        {847}let pkSess_1295: bitstring = fail-any in
                                                        {848}out(c, GetEndpointRequest);
                                                        {849}in(c, (=GetEndpointResponse,=pkSess_1295,=None,SP_1296: bitstring,UP_1297: bitstring));
                                                        {850}new Nc_1298: bitstring;
                                                        {851}let m1_1299: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1298) in
                                                        {852}out(c, (pkCli_1070,m1_1299));
                                                        {853}in(c, em2_1300: bitstring);
                                                        {854}let m2_1301: bitstring = em2_1300 in
                                                        {855}let (=OpenSecureChannelResponse,=Cli,Ns_1302: bitstring,ST_1303: bitstring,TTL_1304: bitstring) = m2_1301 in
                                                        {856}let Kcli_1305: bitstring = h((Nc_1298,Ns_1302)) in
                                                        {857}out(c, senc(mCli(pkCli_1070,pkSess_1295),Kcli_1305))
                                            )
                                            else
                                                {858}let pkSess_1306: bitstring = fail-any in
                                                {859}out(c, GetEndpointRequest);
                                                {860}in(c, (=GetEndpointResponse,=pkSess_1306,=None,SP_1307: bitstring,UP_1308: bitstring));
                                                {861}new Nc_1309: bitstring;
                                                {862}let m1_1310: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1309) in
                                                {863}out(c, (pkCli_1070,m1_1310));
                                                {864}in(c, em2_1311: bitstring);
                                                {865}let m2_1312: bitstring = em2_1311 in
                                                {866}let (=OpenSecureChannelResponse,=Cli,Ns_1313: bitstring,ST_1314: bitstring,TTL_1315: bitstring) = m2_1312 in
                                                {867}let Kcli_1316: bitstring = h((Nc_1309,Ns_1313)) in
                                                {868}out(c, senc(mCli(pkCli_1070,pkSess_1306),Kcli_1316))
                                        )
                                        else
                                            {869}let pkDisco_1317: bitstring = pub(sk(Disco)) in
                                            {870}let v_1318: bool = (Sess = A) in
                                            (
                                                {871}if v_1318 then
                                                (
                                                    {872}let pkSess_1319: bitstring = pub(skA) in
                                                    {873}out(c, GetEndpointRequest);
                                                    {874}in(c, (=GetEndpointResponse,=pkSess_1319,=None,SP_1320: bitstring,UP_1321: bitstring));
                                                    {875}new Nc_1322: bitstring;
                                                    {876}let m1_1323: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1322) in
                                                    {877}out(c, (pkCli_1070,m1_1323));
                                                    {878}in(c, em2_1324: bitstring);
                                                    {879}let m2_1325: bitstring = em2_1324 in
                                                    {880}let (=OpenSecureChannelResponse,=Cli,Ns_1326: bitstring,ST_1327: bitstring,TTL_1328: bitstring) = m2_1325 in
                                                    {881}let Kcli_1329: bitstring = h((Nc_1322,Ns_1326)) in
                                                    {882}out(c, senc(mCli(pkCli_1070,pkSess_1319),Kcli_1329))
                                                )
                                                else
                                                    {883}let v_1330: bool = (Sess = B) in
                                                    (
                                                        {884}if v_1330 then
                                                        (
                                                            {885}let pkSess_1331: bitstring = pub(skB) in
                                                            {886}out(c, GetEndpointRequest);
                                                            {887}in(c, (=GetEndpointResponse,=pkSess_1331,=None,SP_1332: bitstring,UP_1333: bitstring));
                                                            {888}new Nc_1334: bitstring;
                                                            {889}let m1_1335: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1334) in
                                                            {890}out(c, (pkCli_1070,m1_1335));
                                                            {891}in(c, em2_1336: bitstring);
                                                            {892}let m2_1337: bitstring = em2_1336 in
                                                            {893}let (=OpenSecureChannelResponse,=Cli,Ns_1338: bitstring,ST_1339: bitstring,TTL_1340: bitstring) = m2_1337 in
                                                            {894}let Kcli_1341: bitstring = h((Nc_1334,Ns_1338)) in
                                                            {895}out(c, senc(mCli(pkCli_1070,pkSess_1331),Kcli_1341))
                                                        )
                                                        else
                                                            {896}let v_1342: bool = (Sess = C) in
                                                            (
                                                                {897}if v_1342 then
                                                                (
                                                                    {898}let pkSess_1343: bitstring = pub(skC) in
                                                                    {899}out(c, GetEndpointRequest);
                                                                    {900}in(c, (=GetEndpointResponse,=pkSess_1343,=None,SP_1344: bitstring,UP_1345: bitstring));
                                                                    {901}new Nc_1346: bitstring;
                                                                    {902}let m1_1347: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1346) in
                                                                    {903}out(c, (pkCli_1070,m1_1347));
                                                                    {904}in(c, em2_1348: bitstring);
                                                                    {905}let m2_1349: bitstring = em2_1348 in
                                                                    {906}let (=OpenSecureChannelResponse,=Cli,Ns_1350: bitstring,ST_1351: bitstring,TTL_1352: bitstring) = m2_1349 in
                                                                    {907}let Kcli_1353: bitstring = h((Nc_1346,Ns_1350)) in
                                                                    {908}out(c, senc(mCli(pkCli_1070,pkSess_1343),Kcli_1353))
                                                                )
                                                                else
                                                                    {909}let pkSess_1354: bitstring = pub(sk(Sess)) in
                                                                    {910}out(c, GetEndpointRequest);
                                                                    {911}in(c, (=GetEndpointResponse,=pkSess_1354,=None,SP_1355: bitstring,UP_1356: bitstring));
                                                                    {912}new Nc_1357: bitstring;
                                                                    {913}let m1_1358: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1357) in
                                                                    {914}out(c, (pkCli_1070,m1_1358));
                                                                    {915}in(c, em2_1359: bitstring);
                                                                    {916}let m2_1360: bitstring = em2_1359 in
                                                                    {917}let (=OpenSecureChannelResponse,=Cli,Ns_1361: bitstring,ST_1362: bitstring,TTL_1363: bitstring) = m2_1360 in
                                                                    {918}let Kcli_1364: bitstring = h((Nc_1357,Ns_1361)) in
                                                                    {919}out(c, senc(mCli(pkCli_1070,pkSess_1354),Kcli_1364))
                                                            )
                                                            else
                                                                {920}let pkSess_1365: bitstring = fail-any in
                                                                {921}out(c, GetEndpointRequest);
                                                                {922}in(c, (=GetEndpointResponse,=pkSess_1365,=None,SP_1366: bitstring,UP_1367: bitstring));
                                                                {923}new Nc_1368: bitstring;
                                                                {924}let m1_1369: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1368) in
                                                                {925}out(c, (pkCli_1070,m1_1369));
                                                                {926}in(c, em2_1370: bitstring);
                                                                {927}let m2_1371: bitstring = em2_1370 in
                                                                {928}let (=OpenSecureChannelResponse,=Cli,Ns_1372: bitstring,ST_1373: bitstring,TTL_1374: bitstring) = m2_1371 in
                                                                {929}let Kcli_1375: bitstring = h((Nc_1368,Ns_1372)) in
                                                                {930}out(c, senc(mCli(pkCli_1070,pkSess_1365),Kcli_1375))
                                                    )
                                                    else
                                                        {931}let pkSess_1376: bitstring = fail-any in
                                                        {932}out(c, GetEndpointRequest);
                                                        {933}in(c, (=GetEndpointResponse,=pkSess_1376,=None,SP_1377: bitstring,UP_1378: bitstring));
                                                        {934}new Nc_1379: bitstring;
                                                        {935}let m1_1380: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1379) in
                                                        {936}out(c, (pkCli_1070,m1_1380));
                                                        {937}in(c, em2_1381: bitstring);
                                                        {938}let m2_1382: bitstring = em2_1381 in
                                                        {939}let (=OpenSecureChannelResponse,=Cli,Ns_1383: bitstring,ST_1384: bitstring,TTL_1385: bitstring) = m2_1382 in
                                                        {940}let Kcli_1386: bitstring = h((Nc_1379,Ns_1383)) in
                                                        {941}out(c, senc(mCli(pkCli_1070,pkSess_1376),Kcli_1386))
                                            )
                                            else
                                                {942}let pkSess_1387: bitstring = fail-any in
                                                {943}out(c, GetEndpointRequest);
                                                {944}in(c, (=GetEndpointResponse,=pkSess_1387,=None,SP_1388: bitstring,UP_1389: bitstring));
                                                {945}new Nc_1390: bitstring;
                                                {946}let m1_1391: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1390) in
                                                {947}out(c, (pkCli_1070,m1_1391));
                                                {948}in(c, em2_1392: bitstring);
                                                {949}let m2_1393: bitstring = em2_1392 in
                                                {950}let (=OpenSecureChannelResponse,=Cli,Ns_1394: bitstring,ST_1395: bitstring,TTL_1396: bitstring) = m2_1393 in
                                                {951}let Kcli_1397: bitstring = h((Nc_1390,Ns_1394)) in
                                                {952}out(c, senc(mCli(pkCli_1070,pkSess_1387),Kcli_1397))
                                    )
                                    else
                                        {953}let pkDisco_1398: bitstring = fail-any in
                                        {954}let v_1399: bool = (Sess = A) in
                                        (
                                            {955}if v_1399 then
                                            (
                                                {956}let pkSess_1400: bitstring = pub(skA) in
                                                {957}out(c, GetEndpointRequest);
                                                {958}in(c, (=GetEndpointResponse,=pkSess_1400,=None,SP_1401: bitstring,UP_1402: bitstring));
                                                {959}new Nc_1403: bitstring;
                                                {960}let m1_1404: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1403) in
                                                {961}out(c, (pkCli_1070,m1_1404));
                                                {962}in(c, em2_1405: bitstring);
                                                {963}let m2_1406: bitstring = em2_1405 in
                                                {964}let (=OpenSecureChannelResponse,=Cli,Ns_1407: bitstring,ST_1408: bitstring,TTL_1409: bitstring) = m2_1406 in
                                                {965}let Kcli_1410: bitstring = h((Nc_1403,Ns_1407)) in
                                                {966}out(c, senc(mCli(pkCli_1070,pkSess_1400),Kcli_1410))
                                            )
                                            else
                                                {967}let v_1411: bool = (Sess = B) in
                                                (
                                                    {968}if v_1411 then
                                                    (
                                                        {969}let pkSess_1412: bitstring = pub(skB) in
                                                        {970}out(c, GetEndpointRequest);
                                                        {971}in(c, (=GetEndpointResponse,=pkSess_1412,=None,SP_1413: bitstring,UP_1414: bitstring));
                                                        {972}new Nc_1415: bitstring;
                                                        {973}let m1_1416: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1415) in
                                                        {974}out(c, (pkCli_1070,m1_1416));
                                                        {975}in(c, em2_1417: bitstring);
                                                        {976}let m2_1418: bitstring = em2_1417 in
                                                        {977}let (=OpenSecureChannelResponse,=Cli,Ns_1419: bitstring,ST_1420: bitstring,TTL_1421: bitstring) = m2_1418 in
                                                        {978}let Kcli_1422: bitstring = h((Nc_1415,Ns_1419)) in
                                                        {979}out(c, senc(mCli(pkCli_1070,pkSess_1412),Kcli_1422))
                                                    )
                                                    else
                                                        {980}let v_1423: bool = (Sess = C) in
                                                        (
                                                            {981}if v_1423 then
                                                            (
                                                                {982}let pkSess_1424: bitstring = pub(skC) in
                                                                {983}out(c, GetEndpointRequest);
                                                                {984}in(c, (=GetEndpointResponse,=pkSess_1424,=None,SP_1425: bitstring,UP_1426: bitstring));
                                                                {985}new Nc_1427: bitstring;
                                                                {986}let m1_1428: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1427) in
                                                                {987}out(c, (pkCli_1070,m1_1428));
                                                                {988}in(c, em2_1429: bitstring);
                                                                {989}let m2_1430: bitstring = em2_1429 in
                                                                {990}let (=OpenSecureChannelResponse,=Cli,Ns_1431: bitstring,ST_1432: bitstring,TTL_1433: bitstring) = m2_1430 in
                                                                {991}let Kcli_1434: bitstring = h((Nc_1427,Ns_1431)) in
                                                                {992}out(c, senc(mCli(pkCli_1070,pkSess_1424),Kcli_1434))
                                                            )
                                                            else
                                                                {993}let pkSess_1435: bitstring = pub(sk(Sess)) in
                                                                {994}out(c, GetEndpointRequest);
                                                                {995}in(c, (=GetEndpointResponse,=pkSess_1435,=None,SP_1436: bitstring,UP_1437: bitstring));
                                                                {996}new Nc_1438: bitstring;
                                                                {997}let m1_1439: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1438) in
                                                                {998}out(c, (pkCli_1070,m1_1439));
                                                                {999}in(c, em2_1440: bitstring);
                                                                {1000}let m2_1441: bitstring = em2_1440 in
                                                                {1001}let (=OpenSecureChannelResponse,=Cli,Ns_1442: bitstring,ST_1443: bitstring,TTL_1444: bitstring) = m2_1441 in
                                                                {1002}let Kcli_1445: bitstring = h((Nc_1438,Ns_1442)) in
                                                                {1003}out(c, senc(mCli(pkCli_1070,pkSess_1435),Kcli_1445))
                                                        )
                                                        else
                                                            {1004}let pkSess_1446: bitstring = fail-any in
                                                            {1005}out(c, GetEndpointRequest);
                                                            {1006}in(c, (=GetEndpointResponse,=pkSess_1446,=None,SP_1447: bitstring,UP_1448: bitstring));
                                                            {1007}new Nc_1449: bitstring;
                                                            {1008}let m1_1450: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1449) in
                                                            {1009}out(c, (pkCli_1070,m1_1450));
                                                            {1010}in(c, em2_1451: bitstring);
                                                            {1011}let m2_1452: bitstring = em2_1451 in
                                                            {1012}let (=OpenSecureChannelResponse,=Cli,Ns_1453: bitstring,ST_1454: bitstring,TTL_1455: bitstring) = m2_1452 in
                                                            {1013}let Kcli_1456: bitstring = h((Nc_1449,Ns_1453)) in
                                                            {1014}out(c, senc(mCli(pkCli_1070,pkSess_1446),Kcli_1456))
                                                )
                                                else
                                                    {1015}let pkSess_1457: bitstring = fail-any in
                                                    {1016}out(c, GetEndpointRequest);
                                                    {1017}in(c, (=GetEndpointResponse,=pkSess_1457,=None,SP_1458: bitstring,UP_1459: bitstring));
                                                    {1018}new Nc_1460: bitstring;
                                                    {1019}let m1_1461: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1460) in
                                                    {1020}out(c, (pkCli_1070,m1_1461));
                                                    {1021}in(c, em2_1462: bitstring);
                                                    {1022}let m2_1463: bitstring = em2_1462 in
                                                    {1023}let (=OpenSecureChannelResponse,=Cli,Ns_1464: bitstring,ST_1465: bitstring,TTL_1466: bitstring) = m2_1463 in
                                                    {1024}let Kcli_1467: bitstring = h((Nc_1460,Ns_1464)) in
                                                    {1025}out(c, senc(mCli(pkCli_1070,pkSess_1457),Kcli_1467))
                                        )
                                        else
                                            {1026}let pkSess_1468: bitstring = fail-any in
                                            {1027}out(c, GetEndpointRequest);
                                            {1028}in(c, (=GetEndpointResponse,=pkSess_1468,=None,SP_1469: bitstring,UP_1470: bitstring));
                                            {1029}new Nc_1471: bitstring;
                                            {1030}let m1_1472: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1471) in
                                            {1031}out(c, (pkCli_1070,m1_1472));
                                            {1032}in(c, em2_1473: bitstring);
                                            {1033}let m2_1474: bitstring = em2_1473 in
                                            {1034}let (=OpenSecureChannelResponse,=Cli,Ns_1475: bitstring,ST_1476: bitstring,TTL_1477: bitstring) = m2_1474 in
                                            {1035}let Kcli_1478: bitstring = h((Nc_1471,Ns_1475)) in
                                            {1036}out(c, senc(mCli(pkCli_1070,pkSess_1468),Kcli_1478))
                            )
                            else
                                {1037}let pkDisco_1479: bitstring = fail-any in
                                {1038}let v_1480: bool = (Sess = A) in
                                (
                                    {1039}if v_1480 then
                                    (
                                        {1040}let pkSess_1481: bitstring = pub(skA) in
                                        {1041}out(c, GetEndpointRequest);
                                        {1042}in(c, (=GetEndpointResponse,=pkSess_1481,=None,SP_1482: bitstring,UP_1483: bitstring));
                                        {1043}new Nc_1484: bitstring;
                                        {1044}let m1_1485: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1484) in
                                        {1045}out(c, (pkCli_1070,m1_1485));
                                        {1046}in(c, em2_1486: bitstring);
                                        {1047}let m2_1487: bitstring = em2_1486 in
                                        {1048}let (=OpenSecureChannelResponse,=Cli,Ns_1488: bitstring,ST_1489: bitstring,TTL_1490: bitstring) = m2_1487 in
                                        {1049}let Kcli_1491: bitstring = h((Nc_1484,Ns_1488)) in
                                        {1050}out(c, senc(mCli(pkCli_1070,pkSess_1481),Kcli_1491))
                                    )
                                    else
                                        {1051}let v_1492: bool = (Sess = B) in
                                        (
                                            {1052}if v_1492 then
                                            (
                                                {1053}let pkSess_1493: bitstring = pub(skB) in
                                                {1054}out(c, GetEndpointRequest);
                                                {1055}in(c, (=GetEndpointResponse,=pkSess_1493,=None,SP_1494: bitstring,UP_1495: bitstring));
                                                {1056}new Nc_1496: bitstring;
                                                {1057}let m1_1497: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1496) in
                                                {1058}out(c, (pkCli_1070,m1_1497));
                                                {1059}in(c, em2_1498: bitstring);
                                                {1060}let m2_1499: bitstring = em2_1498 in
                                                {1061}let (=OpenSecureChannelResponse,=Cli,Ns_1500: bitstring,ST_1501: bitstring,TTL_1502: bitstring) = m2_1499 in
                                                {1062}let Kcli_1503: bitstring = h((Nc_1496,Ns_1500)) in
                                                {1063}out(c, senc(mCli(pkCli_1070,pkSess_1493),Kcli_1503))
                                            )
                                            else
                                                {1064}let v_1504: bool = (Sess = C) in
                                                (
                                                    {1065}if v_1504 then
                                                    (
                                                        {1066}let pkSess_1505: bitstring = pub(skC) in
                                                        {1067}out(c, GetEndpointRequest);
                                                        {1068}in(c, (=GetEndpointResponse,=pkSess_1505,=None,SP_1506: bitstring,UP_1507: bitstring));
                                                        {1069}new Nc_1508: bitstring;
                                                        {1070}let m1_1509: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1508) in
                                                        {1071}out(c, (pkCli_1070,m1_1509));
                                                        {1072}in(c, em2_1510: bitstring);
                                                        {1073}let m2_1511: bitstring = em2_1510 in
                                                        {1074}let (=OpenSecureChannelResponse,=Cli,Ns_1512: bitstring,ST_1513: bitstring,TTL_1514: bitstring) = m2_1511 in
                                                        {1075}let Kcli_1515: bitstring = h((Nc_1508,Ns_1512)) in
                                                        {1076}out(c, senc(mCli(pkCli_1070,pkSess_1505),Kcli_1515))
                                                    )
                                                    else
                                                        {1077}let pkSess_1516: bitstring = pub(sk(Sess)) in
                                                        {1078}out(c, GetEndpointRequest);
                                                        {1079}in(c, (=GetEndpointResponse,=pkSess_1516,=None,SP_1517: bitstring,UP_1518: bitstring));
                                                        {1080}new Nc_1519: bitstring;
                                                        {1081}let m1_1520: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1519) in
                                                        {1082}out(c, (pkCli_1070,m1_1520));
                                                        {1083}in(c, em2_1521: bitstring);
                                                        {1084}let m2_1522: bitstring = em2_1521 in
                                                        {1085}let (=OpenSecureChannelResponse,=Cli,Ns_1523: bitstring,ST_1524: bitstring,TTL_1525: bitstring) = m2_1522 in
                                                        {1086}let Kcli_1526: bitstring = h((Nc_1519,Ns_1523)) in
                                                        {1087}out(c, senc(mCli(pkCli_1070,pkSess_1516),Kcli_1526))
                                                )
                                                else
                                                    {1088}let pkSess_1527: bitstring = fail-any in
                                                    {1089}out(c, GetEndpointRequest);
                                                    {1090}in(c, (=GetEndpointResponse,=pkSess_1527,=None,SP_1528: bitstring,UP_1529: bitstring));
                                                    {1091}new Nc_1530: bitstring;
                                                    {1092}let m1_1531: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1530) in
                                                    {1093}out(c, (pkCli_1070,m1_1531));
                                                    {1094}in(c, em2_1532: bitstring);
                                                    {1095}let m2_1533: bitstring = em2_1532 in
                                                    {1096}let (=OpenSecureChannelResponse,=Cli,Ns_1534: bitstring,ST_1535: bitstring,TTL_1536: bitstring) = m2_1533 in
                                                    {1097}let Kcli_1537: bitstring = h((Nc_1530,Ns_1534)) in
                                                    {1098}out(c, senc(mCli(pkCli_1070,pkSess_1527),Kcli_1537))
                                        )
                                        else
                                            {1099}let pkSess_1538: bitstring = fail-any in
                                            {1100}out(c, GetEndpointRequest);
                                            {1101}in(c, (=GetEndpointResponse,=pkSess_1538,=None,SP_1539: bitstring,UP_1540: bitstring));
                                            {1102}new Nc_1541: bitstring;
                                            {1103}let m1_1542: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1541) in
                                            {1104}out(c, (pkCli_1070,m1_1542));
                                            {1105}in(c, em2_1543: bitstring);
                                            {1106}let m2_1544: bitstring = em2_1543 in
                                            {1107}let (=OpenSecureChannelResponse,=Cli,Ns_1545: bitstring,ST_1546: bitstring,TTL_1547: bitstring) = m2_1544 in
                                            {1108}let Kcli_1548: bitstring = h((Nc_1541,Ns_1545)) in
                                            {1109}out(c, senc(mCli(pkCli_1070,pkSess_1538),Kcli_1548))
                                )
                                else
                                    {1110}let pkSess_1549: bitstring = fail-any in
                                    {1111}out(c, GetEndpointRequest);
                                    {1112}in(c, (=GetEndpointResponse,=pkSess_1549,=None,SP_1550: bitstring,UP_1551: bitstring));
                                    {1113}new Nc_1552: bitstring;
                                    {1114}let m1_1553: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1552) in
                                    {1115}out(c, (pkCli_1070,m1_1553));
                                    {1116}in(c, em2_1554: bitstring);
                                    {1117}let m2_1555: bitstring = em2_1554 in
                                    {1118}let (=OpenSecureChannelResponse,=Cli,Ns_1556: bitstring,ST_1557: bitstring,TTL_1558: bitstring) = m2_1555 in
                                    {1119}let Kcli_1559: bitstring = h((Nc_1552,Ns_1556)) in
                                    {1120}out(c, senc(mCli(pkCli_1070,pkSess_1549),Kcli_1559))
                    )
                    else
                        {1121}let pkDisco_1560: bitstring = fail-any in
                        {1122}let v_1561: bool = (Sess = A) in
                        (
                            {1123}if v_1561 then
                            (
                                {1124}let pkSess_1562: bitstring = pub(skA) in
                                {1125}out(c, GetEndpointRequest);
                                {1126}in(c, (=GetEndpointResponse,=pkSess_1562,=None,SP_1563: bitstring,UP_1564: bitstring));
                                {1127}new Nc_1565: bitstring;
                                {1128}let m1_1566: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1565) in
                                {1129}out(c, (pkCli_1070,m1_1566));
                                {1130}in(c, em2_1567: bitstring);
                                {1131}let m2_1568: bitstring = em2_1567 in
                                {1132}let (=OpenSecureChannelResponse,=Cli,Ns_1569: bitstring,ST_1570: bitstring,TTL_1571: bitstring) = m2_1568 in
                                {1133}let Kcli_1572: bitstring = h((Nc_1565,Ns_1569)) in
                                {1134}out(c, senc(mCli(pkCli_1070,pkSess_1562),Kcli_1572))
                            )
                            else
                                {1135}let v_1573: bool = (Sess = B) in
                                (
                                    {1136}if v_1573 then
                                    (
                                        {1137}let pkSess_1574: bitstring = pub(skB) in
                                        {1138}out(c, GetEndpointRequest);
                                        {1139}in(c, (=GetEndpointResponse,=pkSess_1574,=None,SP_1575: bitstring,UP_1576: bitstring));
                                        {1140}new Nc_1577: bitstring;
                                        {1141}let m1_1578: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1577) in
                                        {1142}out(c, (pkCli_1070,m1_1578));
                                        {1143}in(c, em2_1579: bitstring);
                                        {1144}let m2_1580: bitstring = em2_1579 in
                                        {1145}let (=OpenSecureChannelResponse,=Cli,Ns_1581: bitstring,ST_1582: bitstring,TTL_1583: bitstring) = m2_1580 in
                                        {1146}let Kcli_1584: bitstring = h((Nc_1577,Ns_1581)) in
                                        {1147}out(c, senc(mCli(pkCli_1070,pkSess_1574),Kcli_1584))
                                    )
                                    else
                                        {1148}let v_1585: bool = (Sess = C) in
                                        (
                                            {1149}if v_1585 then
                                            (
                                                {1150}let pkSess_1586: bitstring = pub(skC) in
                                                {1151}out(c, GetEndpointRequest);
                                                {1152}in(c, (=GetEndpointResponse,=pkSess_1586,=None,SP_1587: bitstring,UP_1588: bitstring));
                                                {1153}new Nc_1589: bitstring;
                                                {1154}let m1_1590: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1589) in
                                                {1155}out(c, (pkCli_1070,m1_1590));
                                                {1156}in(c, em2_1591: bitstring);
                                                {1157}let m2_1592: bitstring = em2_1591 in
                                                {1158}let (=OpenSecureChannelResponse,=Cli,Ns_1593: bitstring,ST_1594: bitstring,TTL_1595: bitstring) = m2_1592 in
                                                {1159}let Kcli_1596: bitstring = h((Nc_1589,Ns_1593)) in
                                                {1160}out(c, senc(mCli(pkCli_1070,pkSess_1586),Kcli_1596))
                                            )
                                            else
                                                {1161}let pkSess_1597: bitstring = pub(sk(Sess)) in
                                                {1162}out(c, GetEndpointRequest);
                                                {1163}in(c, (=GetEndpointResponse,=pkSess_1597,=None,SP_1598: bitstring,UP_1599: bitstring));
                                                {1164}new Nc_1600: bitstring;
                                                {1165}let m1_1601: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1600) in
                                                {1166}out(c, (pkCli_1070,m1_1601));
                                                {1167}in(c, em2_1602: bitstring);
                                                {1168}let m2_1603: bitstring = em2_1602 in
                                                {1169}let (=OpenSecureChannelResponse,=Cli,Ns_1604: bitstring,ST_1605: bitstring,TTL_1606: bitstring) = m2_1603 in
                                                {1170}let Kcli_1607: bitstring = h((Nc_1600,Ns_1604)) in
                                                {1171}out(c, senc(mCli(pkCli_1070,pkSess_1597),Kcli_1607))
                                        )
                                        else
                                            {1172}let pkSess_1608: bitstring = fail-any in
                                            {1173}out(c, GetEndpointRequest);
                                            {1174}in(c, (=GetEndpointResponse,=pkSess_1608,=None,SP_1609: bitstring,UP_1610: bitstring));
                                            {1175}new Nc_1611: bitstring;
                                            {1176}let m1_1612: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1611) in
                                            {1177}out(c, (pkCli_1070,m1_1612));
                                            {1178}in(c, em2_1613: bitstring);
                                            {1179}let m2_1614: bitstring = em2_1613 in
                                            {1180}let (=OpenSecureChannelResponse,=Cli,Ns_1615: bitstring,ST_1616: bitstring,TTL_1617: bitstring) = m2_1614 in
                                            {1181}let Kcli_1618: bitstring = h((Nc_1611,Ns_1615)) in
                                            {1182}out(c, senc(mCli(pkCli_1070,pkSess_1608),Kcli_1618))
                                )
                                else
                                    {1183}let pkSess_1619: bitstring = fail-any in
                                    {1184}out(c, GetEndpointRequest);
                                    {1185}in(c, (=GetEndpointResponse,=pkSess_1619,=None,SP_1620: bitstring,UP_1621: bitstring));
                                    {1186}new Nc_1622: bitstring;
                                    {1187}let m1_1623: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1622) in
                                    {1188}out(c, (pkCli_1070,m1_1623));
                                    {1189}in(c, em2_1624: bitstring);
                                    {1190}let m2_1625: bitstring = em2_1624 in
                                    {1191}let (=OpenSecureChannelResponse,=Cli,Ns_1626: bitstring,ST_1627: bitstring,TTL_1628: bitstring) = m2_1625 in
                                    {1192}let Kcli_1629: bitstring = h((Nc_1622,Ns_1626)) in
                                    {1193}out(c, senc(mCli(pkCli_1070,pkSess_1619),Kcli_1629))
                        )
                        else
                            {1194}let pkSess_1630: bitstring = fail-any in
                            {1195}out(c, GetEndpointRequest);
                            {1196}in(c, (=GetEndpointResponse,=pkSess_1630,=None,SP_1631: bitstring,UP_1632: bitstring));
                            {1197}new Nc_1633: bitstring;
                            {1198}let m1_1634: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1070,Nc_1633) in
                            {1199}out(c, (pkCli_1070,m1_1634));
                            {1200}in(c, em2_1635: bitstring);
                            {1201}let m2_1636: bitstring = em2_1635 in
                            {1202}let (=OpenSecureChannelResponse,=Cli,Ns_1637: bitstring,ST_1638: bitstring,TTL_1639: bitstring) = m2_1636 in
                            {1203}let Kcli_1640: bitstring = h((Nc_1633,Ns_1637)) in
                            {1204}out(c, senc(mCli(pkCli_1070,pkSess_1630),Kcli_1640))
                )
                else
                    {1205}let =true = (Cli = C) in
                    (
                        {1206}let skCli_1641: bitstring = skC in
                        {1207}let pkCli_1642: bitstring = pub(skCli_1641) in
                        {1208}let v_1643: bool = (Disco = A) in
                        (
                            {1209}if v_1643 then
                            (
                                {1210}let pkDisco_1644: bitstring = pub(skA) in
                                {1211}let v_1645: bool = (Sess = A) in
                                (
                                    {1212}if v_1645 then
                                    (
                                        {1213}let pkSess_1646: bitstring = pub(skA) in
                                        {1214}out(c, GetEndpointRequest);
                                        {1215}in(c, (=GetEndpointResponse,=pkSess_1646,=None,SP_1647: bitstring,UP_1648: bitstring));
                                        {1216}new Nc_1649: bitstring;
                                        {1217}let m1_1650: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1649) in
                                        {1218}out(c, (pkCli_1642,m1_1650));
                                        {1219}in(c, em2_1651: bitstring);
                                        {1220}let m2_1652: bitstring = em2_1651 in
                                        {1221}let (=OpenSecureChannelResponse,=Cli,Ns_1653: bitstring,ST_1654: bitstring,TTL_1655: bitstring) = m2_1652 in
                                        {1222}let Kcli_1656: bitstring = h((Nc_1649,Ns_1653)) in
                                        {1223}out(c, senc(mCli(pkCli_1642,pkSess_1646),Kcli_1656))
                                    )
                                    else
                                        {1224}let v_1657: bool = (Sess = B) in
                                        (
                                            {1225}if v_1657 then
                                            (
                                                {1226}let pkSess_1658: bitstring = pub(skB) in
                                                {1227}out(c, GetEndpointRequest);
                                                {1228}in(c, (=GetEndpointResponse,=pkSess_1658,=None,SP_1659: bitstring,UP_1660: bitstring));
                                                {1229}new Nc_1661: bitstring;
                                                {1230}let m1_1662: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1661) in
                                                {1231}out(c, (pkCli_1642,m1_1662));
                                                {1232}in(c, em2_1663: bitstring);
                                                {1233}let m2_1664: bitstring = em2_1663 in
                                                {1234}let (=OpenSecureChannelResponse,=Cli,Ns_1665: bitstring,ST_1666: bitstring,TTL_1667: bitstring) = m2_1664 in
                                                {1235}let Kcli_1668: bitstring = h((Nc_1661,Ns_1665)) in
                                                {1236}out(c, senc(mCli(pkCli_1642,pkSess_1658),Kcli_1668))
                                            )
                                            else
                                                {1237}let v_1669: bool = (Sess = C) in
                                                (
                                                    {1238}if v_1669 then
                                                    (
                                                        {1239}let pkSess_1670: bitstring = pub(skC) in
                                                        {1240}out(c, GetEndpointRequest);
                                                        {1241}in(c, (=GetEndpointResponse,=pkSess_1670,=None,SP_1671: bitstring,UP_1672: bitstring));
                                                        {1242}new Nc_1673: bitstring;
                                                        {1243}let m1_1674: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1673) in
                                                        {1244}out(c, (pkCli_1642,m1_1674));
                                                        {1245}in(c, em2_1675: bitstring);
                                                        {1246}let m2_1676: bitstring = em2_1675 in
                                                        {1247}let (=OpenSecureChannelResponse,=Cli,Ns_1677: bitstring,ST_1678: bitstring,TTL_1679: bitstring) = m2_1676 in
                                                        {1248}let Kcli_1680: bitstring = h((Nc_1673,Ns_1677)) in
                                                        {1249}out(c, senc(mCli(pkCli_1642,pkSess_1670),Kcli_1680))
                                                    )
                                                    else
                                                        {1250}let pkSess_1681: bitstring = pub(sk(Sess)) in
                                                        {1251}out(c, GetEndpointRequest);
                                                        {1252}in(c, (=GetEndpointResponse,=pkSess_1681,=None,SP_1682: bitstring,UP_1683: bitstring));
                                                        {1253}new Nc_1684: bitstring;
                                                        {1254}let m1_1685: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1684) in
                                                        {1255}out(c, (pkCli_1642,m1_1685));
                                                        {1256}in(c, em2_1686: bitstring);
                                                        {1257}let m2_1687: bitstring = em2_1686 in
                                                        {1258}let (=OpenSecureChannelResponse,=Cli,Ns_1688: bitstring,ST_1689: bitstring,TTL_1690: bitstring) = m2_1687 in
                                                        {1259}let Kcli_1691: bitstring = h((Nc_1684,Ns_1688)) in
                                                        {1260}out(c, senc(mCli(pkCli_1642,pkSess_1681),Kcli_1691))
                                                )
                                                else
                                                    {1261}let pkSess_1692: bitstring = fail-any in
                                                    {1262}out(c, GetEndpointRequest);
                                                    {1263}in(c, (=GetEndpointResponse,=pkSess_1692,=None,SP_1693: bitstring,UP_1694: bitstring));
                                                    {1264}new Nc_1695: bitstring;
                                                    {1265}let m1_1696: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1695) in
                                                    {1266}out(c, (pkCli_1642,m1_1696));
                                                    {1267}in(c, em2_1697: bitstring);
                                                    {1268}let m2_1698: bitstring = em2_1697 in
                                                    {1269}let (=OpenSecureChannelResponse,=Cli,Ns_1699: bitstring,ST_1700: bitstring,TTL_1701: bitstring) = m2_1698 in
                                                    {1270}let Kcli_1702: bitstring = h((Nc_1695,Ns_1699)) in
                                                    {1271}out(c, senc(mCli(pkCli_1642,pkSess_1692),Kcli_1702))
                                        )
                                        else
                                            {1272}let pkSess_1703: bitstring = fail-any in
                                            {1273}out(c, GetEndpointRequest);
                                            {1274}in(c, (=GetEndpointResponse,=pkSess_1703,=None,SP_1704: bitstring,UP_1705: bitstring));
                                            {1275}new Nc_1706: bitstring;
                                            {1276}let m1_1707: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1706) in
                                            {1277}out(c, (pkCli_1642,m1_1707));
                                            {1278}in(c, em2_1708: bitstring);
                                            {1279}let m2_1709: bitstring = em2_1708 in
                                            {1280}let (=OpenSecureChannelResponse,=Cli,Ns_1710: bitstring,ST_1711: bitstring,TTL_1712: bitstring) = m2_1709 in
                                            {1281}let Kcli_1713: bitstring = h((Nc_1706,Ns_1710)) in
                                            {1282}out(c, senc(mCli(pkCli_1642,pkSess_1703),Kcli_1713))
                                )
                                else
                                    {1283}let pkSess_1714: bitstring = fail-any in
                                    {1284}out(c, GetEndpointRequest);
                                    {1285}in(c, (=GetEndpointResponse,=pkSess_1714,=None,SP_1715: bitstring,UP_1716: bitstring));
                                    {1286}new Nc_1717: bitstring;
                                    {1287}let m1_1718: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1717) in
                                    {1288}out(c, (pkCli_1642,m1_1718));
                                    {1289}in(c, em2_1719: bitstring);
                                    {1290}let m2_1720: bitstring = em2_1719 in
                                    {1291}let (=OpenSecureChannelResponse,=Cli,Ns_1721: bitstring,ST_1722: bitstring,TTL_1723: bitstring) = m2_1720 in
                                    {1292}let Kcli_1724: bitstring = h((Nc_1717,Ns_1721)) in
                                    {1293}out(c, senc(mCli(pkCli_1642,pkSess_1714),Kcli_1724))
                            )
                            else
                                {1294}let v_1725: bool = (Disco = B) in
                                (
                                    {1295}if v_1725 then
                                    (
                                        {1296}let pkDisco_1726: bitstring = pub(skB) in
                                        {1297}let v_1727: bool = (Sess = A) in
                                        (
                                            {1298}if v_1727 then
                                            (
                                                {1299}let pkSess_1728: bitstring = pub(skA) in
                                                {1300}out(c, GetEndpointRequest);
                                                {1301}in(c, (=GetEndpointResponse,=pkSess_1728,=None,SP_1729: bitstring,UP_1730: bitstring));
                                                {1302}new Nc_1731: bitstring;
                                                {1303}let m1_1732: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1731) in
                                                {1304}out(c, (pkCli_1642,m1_1732));
                                                {1305}in(c, em2_1733: bitstring);
                                                {1306}let m2_1734: bitstring = em2_1733 in
                                                {1307}let (=OpenSecureChannelResponse,=Cli,Ns_1735: bitstring,ST_1736: bitstring,TTL_1737: bitstring) = m2_1734 in
                                                {1308}let Kcli_1738: bitstring = h((Nc_1731,Ns_1735)) in
                                                {1309}out(c, senc(mCli(pkCli_1642,pkSess_1728),Kcli_1738))
                                            )
                                            else
                                                {1310}let v_1739: bool = (Sess = B) in
                                                (
                                                    {1311}if v_1739 then
                                                    (
                                                        {1312}let pkSess_1740: bitstring = pub(skB) in
                                                        {1313}out(c, GetEndpointRequest);
                                                        {1314}in(c, (=GetEndpointResponse,=pkSess_1740,=None,SP_1741: bitstring,UP_1742: bitstring));
                                                        {1315}new Nc_1743: bitstring;
                                                        {1316}let m1_1744: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1743) in
                                                        {1317}out(c, (pkCli_1642,m1_1744));
                                                        {1318}in(c, em2_1745: bitstring);
                                                        {1319}let m2_1746: bitstring = em2_1745 in
                                                        {1320}let (=OpenSecureChannelResponse,=Cli,Ns_1747: bitstring,ST_1748: bitstring,TTL_1749: bitstring) = m2_1746 in
                                                        {1321}let Kcli_1750: bitstring = h((Nc_1743,Ns_1747)) in
                                                        {1322}out(c, senc(mCli(pkCli_1642,pkSess_1740),Kcli_1750))
                                                    )
                                                    else
                                                        {1323}let v_1751: bool = (Sess = C) in
                                                        (
                                                            {1324}if v_1751 then
                                                            (
                                                                {1325}let pkSess_1752: bitstring = pub(skC) in
                                                                {1326}out(c, GetEndpointRequest);
                                                                {1327}in(c, (=GetEndpointResponse,=pkSess_1752,=None,SP_1753: bitstring,UP_1754: bitstring));
                                                                {1328}new Nc_1755: bitstring;
                                                                {1329}let m1_1756: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1755) in
                                                                {1330}out(c, (pkCli_1642,m1_1756));
                                                                {1331}in(c, em2_1757: bitstring);
                                                                {1332}let m2_1758: bitstring = em2_1757 in
                                                                {1333}let (=OpenSecureChannelResponse,=Cli,Ns_1759: bitstring,ST_1760: bitstring,TTL_1761: bitstring) = m2_1758 in
                                                                {1334}let Kcli_1762: bitstring = h((Nc_1755,Ns_1759)) in
                                                                {1335}out(c, senc(mCli(pkCli_1642,pkSess_1752),Kcli_1762))
                                                            )
                                                            else
                                                                {1336}let pkSess_1763: bitstring = pub(sk(Sess)) in
                                                                {1337}out(c, GetEndpointRequest);
                                                                {1338}in(c, (=GetEndpointResponse,=pkSess_1763,=None,SP_1764: bitstring,UP_1765: bitstring));
                                                                {1339}new Nc_1766: bitstring;
                                                                {1340}let m1_1767: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1766) in
                                                                {1341}out(c, (pkCli_1642,m1_1767));
                                                                {1342}in(c, em2_1768: bitstring);
                                                                {1343}let m2_1769: bitstring = em2_1768 in
                                                                {1344}let (=OpenSecureChannelResponse,=Cli,Ns_1770: bitstring,ST_1771: bitstring,TTL_1772: bitstring) = m2_1769 in
                                                                {1345}let Kcli_1773: bitstring = h((Nc_1766,Ns_1770)) in
                                                                {1346}out(c, senc(mCli(pkCli_1642,pkSess_1763),Kcli_1773))
                                                        )
                                                        else
                                                            {1347}let pkSess_1774: bitstring = fail-any in
                                                            {1348}out(c, GetEndpointRequest);
                                                            {1349}in(c, (=GetEndpointResponse,=pkSess_1774,=None,SP_1775: bitstring,UP_1776: bitstring));
                                                            {1350}new Nc_1777: bitstring;
                                                            {1351}let m1_1778: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1777) in
                                                            {1352}out(c, (pkCli_1642,m1_1778));
                                                            {1353}in(c, em2_1779: bitstring);
                                                            {1354}let m2_1780: bitstring = em2_1779 in
                                                            {1355}let (=OpenSecureChannelResponse,=Cli,Ns_1781: bitstring,ST_1782: bitstring,TTL_1783: bitstring) = m2_1780 in
                                                            {1356}let Kcli_1784: bitstring = h((Nc_1777,Ns_1781)) in
                                                            {1357}out(c, senc(mCli(pkCli_1642,pkSess_1774),Kcli_1784))
                                                )
                                                else
                                                    {1358}let pkSess_1785: bitstring = fail-any in
                                                    {1359}out(c, GetEndpointRequest);
                                                    {1360}in(c, (=GetEndpointResponse,=pkSess_1785,=None,SP_1786: bitstring,UP_1787: bitstring));
                                                    {1361}new Nc_1788: bitstring;
                                                    {1362}let m1_1789: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1788) in
                                                    {1363}out(c, (pkCli_1642,m1_1789));
                                                    {1364}in(c, em2_1790: bitstring);
                                                    {1365}let m2_1791: bitstring = em2_1790 in
                                                    {1366}let (=OpenSecureChannelResponse,=Cli,Ns_1792: bitstring,ST_1793: bitstring,TTL_1794: bitstring) = m2_1791 in
                                                    {1367}let Kcli_1795: bitstring = h((Nc_1788,Ns_1792)) in
                                                    {1368}out(c, senc(mCli(pkCli_1642,pkSess_1785),Kcli_1795))
                                        )
                                        else
                                            {1369}let pkSess_1796: bitstring = fail-any in
                                            {1370}out(c, GetEndpointRequest);
                                            {1371}in(c, (=GetEndpointResponse,=pkSess_1796,=None,SP_1797: bitstring,UP_1798: bitstring));
                                            {1372}new Nc_1799: bitstring;
                                            {1373}let m1_1800: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1799) in
                                            {1374}out(c, (pkCli_1642,m1_1800));
                                            {1375}in(c, em2_1801: bitstring);
                                            {1376}let m2_1802: bitstring = em2_1801 in
                                            {1377}let (=OpenSecureChannelResponse,=Cli,Ns_1803: bitstring,ST_1804: bitstring,TTL_1805: bitstring) = m2_1802 in
                                            {1378}let Kcli_1806: bitstring = h((Nc_1799,Ns_1803)) in
                                            {1379}out(c, senc(mCli(pkCli_1642,pkSess_1796),Kcli_1806))
                                    )
                                    else
                                        {1380}let v_1807: bool = (Disco = C) in
                                        (
                                            {1381}if v_1807 then
                                            (
                                                {1382}let pkDisco_1808: bitstring = pub(skC) in
                                                {1383}let v_1809: bool = (Sess = A) in
                                                (
                                                    {1384}if v_1809 then
                                                    (
                                                        {1385}let pkSess_1810: bitstring = pub(skA) in
                                                        {1386}out(c, GetEndpointRequest);
                                                        {1387}in(c, (=GetEndpointResponse,=pkSess_1810,=None,SP_1811: bitstring,UP_1812: bitstring));
                                                        {1388}new Nc_1813: bitstring;
                                                        {1389}let m1_1814: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1813) in
                                                        {1390}out(c, (pkCli_1642,m1_1814));
                                                        {1391}in(c, em2_1815: bitstring);
                                                        {1392}let m2_1816: bitstring = em2_1815 in
                                                        {1393}let (=OpenSecureChannelResponse,=Cli,Ns_1817: bitstring,ST_1818: bitstring,TTL_1819: bitstring) = m2_1816 in
                                                        {1394}let Kcli_1820: bitstring = h((Nc_1813,Ns_1817)) in
                                                        {1395}out(c, senc(mCli(pkCli_1642,pkSess_1810),Kcli_1820))
                                                    )
                                                    else
                                                        {1396}let v_1821: bool = (Sess = B) in
                                                        (
                                                            {1397}if v_1821 then
                                                            (
                                                                {1398}let pkSess_1822: bitstring = pub(skB) in
                                                                {1399}out(c, GetEndpointRequest);
                                                                {1400}in(c, (=GetEndpointResponse,=pkSess_1822,=None,SP_1823: bitstring,UP_1824: bitstring));
                                                                {1401}new Nc_1825: bitstring;
                                                                {1402}let m1_1826: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1825) in
                                                                {1403}out(c, (pkCli_1642,m1_1826));
                                                                {1404}in(c, em2_1827: bitstring);
                                                                {1405}let m2_1828: bitstring = em2_1827 in
                                                                {1406}let (=OpenSecureChannelResponse,=Cli,Ns_1829: bitstring,ST_1830: bitstring,TTL_1831: bitstring) = m2_1828 in
                                                                {1407}let Kcli_1832: bitstring = h((Nc_1825,Ns_1829)) in
                                                                {1408}out(c, senc(mCli(pkCli_1642,pkSess_1822),Kcli_1832))
                                                            )
                                                            else
                                                                {1409}let v_1833: bool = (Sess = C) in
                                                                (
                                                                    {1410}if v_1833 then
                                                                    (
                                                                        {1411}let pkSess_1834: bitstring = pub(skC) in
                                                                        {1412}out(c, GetEndpointRequest);
                                                                        {1413}in(c, (=GetEndpointResponse,=pkSess_1834,=None,SP_1835: bitstring,UP_1836: bitstring));
                                                                        {1414}new Nc_1837: bitstring;
                                                                        {1415}let m1_1838: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1837) in
                                                                        {1416}out(c, (pkCli_1642,m1_1838));
                                                                        {1417}in(c, em2_1839: bitstring);
                                                                        {1418}let m2_1840: bitstring = em2_1839 in
                                                                        {1419}let (=OpenSecureChannelResponse,=Cli,Ns_1841: bitstring,ST_1842: bitstring,TTL_1843: bitstring) = m2_1840 in
                                                                        {1420}let Kcli_1844: bitstring = h((Nc_1837,Ns_1841)) in
                                                                        {1421}out(c, senc(mCli(pkCli_1642,pkSess_1834),Kcli_1844))
                                                                    )
                                                                    else
                                                                        {1422}let pkSess_1845: bitstring = pub(sk(Sess)) in
                                                                        {1423}out(c, GetEndpointRequest);
                                                                        {1424}in(c, (=GetEndpointResponse,=pkSess_1845,=None,SP_1846: bitstring,UP_1847: bitstring));
                                                                        {1425}new Nc_1848: bitstring;
                                                                        {1426}let m1_1849: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1848) in
                                                                        {1427}out(c, (pkCli_1642,m1_1849));
                                                                        {1428}in(c, em2_1850: bitstring);
                                                                        {1429}let m2_1851: bitstring = em2_1850 in
                                                                        {1430}let (=OpenSecureChannelResponse,=Cli,Ns_1852: bitstring,ST_1853: bitstring,TTL_1854: bitstring) = m2_1851 in
                                                                        {1431}let Kcli_1855: bitstring = h((Nc_1848,Ns_1852)) in
                                                                        {1432}out(c, senc(mCli(pkCli_1642,pkSess_1845),Kcli_1855))
                                                                )
                                                                else
                                                                    {1433}let pkSess_1856: bitstring = fail-any in
                                                                    {1434}out(c, GetEndpointRequest);
                                                                    {1435}in(c, (=GetEndpointResponse,=pkSess_1856,=None,SP_1857: bitstring,UP_1858: bitstring));
                                                                    {1436}new Nc_1859: bitstring;
                                                                    {1437}let m1_1860: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1859) in
                                                                    {1438}out(c, (pkCli_1642,m1_1860));
                                                                    {1439}in(c, em2_1861: bitstring);
                                                                    {1440}let m2_1862: bitstring = em2_1861 in
                                                                    {1441}let (=OpenSecureChannelResponse,=Cli,Ns_1863: bitstring,ST_1864: bitstring,TTL_1865: bitstring) = m2_1862 in
                                                                    {1442}let Kcli_1866: bitstring = h((Nc_1859,Ns_1863)) in
                                                                    {1443}out(c, senc(mCli(pkCli_1642,pkSess_1856),Kcli_1866))
                                                        )
                                                        else
                                                            {1444}let pkSess_1867: bitstring = fail-any in
                                                            {1445}out(c, GetEndpointRequest);
                                                            {1446}in(c, (=GetEndpointResponse,=pkSess_1867,=None,SP_1868: bitstring,UP_1869: bitstring));
                                                            {1447}new Nc_1870: bitstring;
                                                            {1448}let m1_1871: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1870) in
                                                            {1449}out(c, (pkCli_1642,m1_1871));
                                                            {1450}in(c, em2_1872: bitstring);
                                                            {1451}let m2_1873: bitstring = em2_1872 in
                                                            {1452}let (=OpenSecureChannelResponse,=Cli,Ns_1874: bitstring,ST_1875: bitstring,TTL_1876: bitstring) = m2_1873 in
                                                            {1453}let Kcli_1877: bitstring = h((Nc_1870,Ns_1874)) in
                                                            {1454}out(c, senc(mCli(pkCli_1642,pkSess_1867),Kcli_1877))
                                                )
                                                else
                                                    {1455}let pkSess_1878: bitstring = fail-any in
                                                    {1456}out(c, GetEndpointRequest);
                                                    {1457}in(c, (=GetEndpointResponse,=pkSess_1878,=None,SP_1879: bitstring,UP_1880: bitstring));
                                                    {1458}new Nc_1881: bitstring;
                                                    {1459}let m1_1882: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1881) in
                                                    {1460}out(c, (pkCli_1642,m1_1882));
                                                    {1461}in(c, em2_1883: bitstring);
                                                    {1462}let m2_1884: bitstring = em2_1883 in
                                                    {1463}let (=OpenSecureChannelResponse,=Cli,Ns_1885: bitstring,ST_1886: bitstring,TTL_1887: bitstring) = m2_1884 in
                                                    {1464}let Kcli_1888: bitstring = h((Nc_1881,Ns_1885)) in
                                                    {1465}out(c, senc(mCli(pkCli_1642,pkSess_1878),Kcli_1888))
                                            )
                                            else
                                                {1466}let pkDisco_1889: bitstring = pub(sk(Disco)) in
                                                {1467}let v_1890: bool = (Sess = A) in
                                                (
                                                    {1468}if v_1890 then
                                                    (
                                                        {1469}let pkSess_1891: bitstring = pub(skA) in
                                                        {1470}out(c, GetEndpointRequest);
                                                        {1471}in(c, (=GetEndpointResponse,=pkSess_1891,=None,SP_1892: bitstring,UP_1893: bitstring));
                                                        {1472}new Nc_1894: bitstring;
                                                        {1473}let m1_1895: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1894) in
                                                        {1474}out(c, (pkCli_1642,m1_1895));
                                                        {1475}in(c, em2_1896: bitstring);
                                                        {1476}let m2_1897: bitstring = em2_1896 in
                                                        {1477}let (=OpenSecureChannelResponse,=Cli,Ns_1898: bitstring,ST_1899: bitstring,TTL_1900: bitstring) = m2_1897 in
                                                        {1478}let Kcli_1901: bitstring = h((Nc_1894,Ns_1898)) in
                                                        {1479}out(c, senc(mCli(pkCli_1642,pkSess_1891),Kcli_1901))
                                                    )
                                                    else
                                                        {1480}let v_1902: bool = (Sess = B) in
                                                        (
                                                            {1481}if v_1902 then
                                                            (
                                                                {1482}let pkSess_1903: bitstring = pub(skB) in
                                                                {1483}out(c, GetEndpointRequest);
                                                                {1484}in(c, (=GetEndpointResponse,=pkSess_1903,=None,SP_1904: bitstring,UP_1905: bitstring));
                                                                {1485}new Nc_1906: bitstring;
                                                                {1486}let m1_1907: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1906) in
                                                                {1487}out(c, (pkCli_1642,m1_1907));
                                                                {1488}in(c, em2_1908: bitstring);
                                                                {1489}let m2_1909: bitstring = em2_1908 in
                                                                {1490}let (=OpenSecureChannelResponse,=Cli,Ns_1910: bitstring,ST_1911: bitstring,TTL_1912: bitstring) = m2_1909 in
                                                                {1491}let Kcli_1913: bitstring = h((Nc_1906,Ns_1910)) in
                                                                {1492}out(c, senc(mCli(pkCli_1642,pkSess_1903),Kcli_1913))
                                                            )
                                                            else
                                                                {1493}let v_1914: bool = (Sess = C) in
                                                                (
                                                                    {1494}if v_1914 then
                                                                    (
                                                                        {1495}let pkSess_1915: bitstring = pub(skC) in
                                                                        {1496}out(c, GetEndpointRequest);
                                                                        {1497}in(c, (=GetEndpointResponse,=pkSess_1915,=None,SP_1916: bitstring,UP_1917: bitstring));
                                                                        {1498}new Nc_1918: bitstring;
                                                                        {1499}let m1_1919: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1918) in
                                                                        {1500}out(c, (pkCli_1642,m1_1919));
                                                                        {1501}in(c, em2_1920: bitstring);
                                                                        {1502}let m2_1921: bitstring = em2_1920 in
                                                                        {1503}let (=OpenSecureChannelResponse,=Cli,Ns_1922: bitstring,ST_1923: bitstring,TTL_1924: bitstring) = m2_1921 in
                                                                        {1504}let Kcli_1925: bitstring = h((Nc_1918,Ns_1922)) in
                                                                        {1505}out(c, senc(mCli(pkCli_1642,pkSess_1915),Kcli_1925))
                                                                    )
                                                                    else
                                                                        {1506}let pkSess_1926: bitstring = pub(sk(Sess)) in
                                                                        {1507}out(c, GetEndpointRequest);
                                                                        {1508}in(c, (=GetEndpointResponse,=pkSess_1926,=None,SP_1927: bitstring,UP_1928: bitstring));
                                                                        {1509}new Nc_1929: bitstring;
                                                                        {1510}let m1_1930: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1929) in
                                                                        {1511}out(c, (pkCli_1642,m1_1930));
                                                                        {1512}in(c, em2_1931: bitstring);
                                                                        {1513}let m2_1932: bitstring = em2_1931 in
                                                                        {1514}let (=OpenSecureChannelResponse,=Cli,Ns_1933: bitstring,ST_1934: bitstring,TTL_1935: bitstring) = m2_1932 in
                                                                        {1515}let Kcli_1936: bitstring = h((Nc_1929,Ns_1933)) in
                                                                        {1516}out(c, senc(mCli(pkCli_1642,pkSess_1926),Kcli_1936))
                                                                )
                                                                else
                                                                    {1517}let pkSess_1937: bitstring = fail-any in
                                                                    {1518}out(c, GetEndpointRequest);
                                                                    {1519}in(c, (=GetEndpointResponse,=pkSess_1937,=None,SP_1938: bitstring,UP_1939: bitstring));
                                                                    {1520}new Nc_1940: bitstring;
                                                                    {1521}let m1_1941: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1940) in
                                                                    {1522}out(c, (pkCli_1642,m1_1941));
                                                                    {1523}in(c, em2_1942: bitstring);
                                                                    {1524}let m2_1943: bitstring = em2_1942 in
                                                                    {1525}let (=OpenSecureChannelResponse,=Cli,Ns_1944: bitstring,ST_1945: bitstring,TTL_1946: bitstring) = m2_1943 in
                                                                    {1526}let Kcli_1947: bitstring = h((Nc_1940,Ns_1944)) in
                                                                    {1527}out(c, senc(mCli(pkCli_1642,pkSess_1937),Kcli_1947))
                                                        )
                                                        else
                                                            {1528}let pkSess_1948: bitstring = fail-any in
                                                            {1529}out(c, GetEndpointRequest);
                                                            {1530}in(c, (=GetEndpointResponse,=pkSess_1948,=None,SP_1949: bitstring,UP_1950: bitstring));
                                                            {1531}new Nc_1951: bitstring;
                                                            {1532}let m1_1952: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1951) in
                                                            {1533}out(c, (pkCli_1642,m1_1952));
                                                            {1534}in(c, em2_1953: bitstring);
                                                            {1535}let m2_1954: bitstring = em2_1953 in
                                                            {1536}let (=OpenSecureChannelResponse,=Cli,Ns_1955: bitstring,ST_1956: bitstring,TTL_1957: bitstring) = m2_1954 in
                                                            {1537}let Kcli_1958: bitstring = h((Nc_1951,Ns_1955)) in
                                                            {1538}out(c, senc(mCli(pkCli_1642,pkSess_1948),Kcli_1958))
                                                )
                                                else
                                                    {1539}let pkSess_1959: bitstring = fail-any in
                                                    {1540}out(c, GetEndpointRequest);
                                                    {1541}in(c, (=GetEndpointResponse,=pkSess_1959,=None,SP_1960: bitstring,UP_1961: bitstring));
                                                    {1542}new Nc_1962: bitstring;
                                                    {1543}let m1_1963: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1962) in
                                                    {1544}out(c, (pkCli_1642,m1_1963));
                                                    {1545}in(c, em2_1964: bitstring);
                                                    {1546}let m2_1965: bitstring = em2_1964 in
                                                    {1547}let (=OpenSecureChannelResponse,=Cli,Ns_1966: bitstring,ST_1967: bitstring,TTL_1968: bitstring) = m2_1965 in
                                                    {1548}let Kcli_1969: bitstring = h((Nc_1962,Ns_1966)) in
                                                    {1549}out(c, senc(mCli(pkCli_1642,pkSess_1959),Kcli_1969))
                                        )
                                        else
                                            {1550}let pkDisco_1970: bitstring = fail-any in
                                            {1551}let v_1971: bool = (Sess = A) in
                                            (
                                                {1552}if v_1971 then
                                                (
                                                    {1553}let pkSess_1972: bitstring = pub(skA) in
                                                    {1554}out(c, GetEndpointRequest);
                                                    {1555}in(c, (=GetEndpointResponse,=pkSess_1972,=None,SP_1973: bitstring,UP_1974: bitstring));
                                                    {1556}new Nc_1975: bitstring;
                                                    {1557}let m1_1976: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1975) in
                                                    {1558}out(c, (pkCli_1642,m1_1976));
                                                    {1559}in(c, em2_1977: bitstring);
                                                    {1560}let m2_1978: bitstring = em2_1977 in
                                                    {1561}let (=OpenSecureChannelResponse,=Cli,Ns_1979: bitstring,ST_1980: bitstring,TTL_1981: bitstring) = m2_1978 in
                                                    {1562}let Kcli_1982: bitstring = h((Nc_1975,Ns_1979)) in
                                                    {1563}out(c, senc(mCli(pkCli_1642,pkSess_1972),Kcli_1982))
                                                )
                                                else
                                                    {1564}let v_1983: bool = (Sess = B) in
                                                    (
                                                        {1565}if v_1983 then
                                                        (
                                                            {1566}let pkSess_1984: bitstring = pub(skB) in
                                                            {1567}out(c, GetEndpointRequest);
                                                            {1568}in(c, (=GetEndpointResponse,=pkSess_1984,=None,SP_1985: bitstring,UP_1986: bitstring));
                                                            {1569}new Nc_1987: bitstring;
                                                            {1570}let m1_1988: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1987) in
                                                            {1571}out(c, (pkCli_1642,m1_1988));
                                                            {1572}in(c, em2_1989: bitstring);
                                                            {1573}let m2_1990: bitstring = em2_1989 in
                                                            {1574}let (=OpenSecureChannelResponse,=Cli,Ns_1991: bitstring,ST_1992: bitstring,TTL_1993: bitstring) = m2_1990 in
                                                            {1575}let Kcli_1994: bitstring = h((Nc_1987,Ns_1991)) in
                                                            {1576}out(c, senc(mCli(pkCli_1642,pkSess_1984),Kcli_1994))
                                                        )
                                                        else
                                                            {1577}let v_1995: bool = (Sess = C) in
                                                            (
                                                                {1578}if v_1995 then
                                                                (
                                                                    {1579}let pkSess_1996: bitstring = pub(skC) in
                                                                    {1580}out(c, GetEndpointRequest);
                                                                    {1581}in(c, (=GetEndpointResponse,=pkSess_1996,=None,SP_1997: bitstring,UP_1998: bitstring));
                                                                    {1582}new Nc_1999: bitstring;
                                                                    {1583}let m1_2000: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_1999) in
                                                                    {1584}out(c, (pkCli_1642,m1_2000));
                                                                    {1585}in(c, em2_2001: bitstring);
                                                                    {1586}let m2_2002: bitstring = em2_2001 in
                                                                    {1587}let (=OpenSecureChannelResponse,=Cli,Ns_2003: bitstring,ST_2004: bitstring,TTL_2005: bitstring) = m2_2002 in
                                                                    {1588}let Kcli_2006: bitstring = h((Nc_1999,Ns_2003)) in
                                                                    {1589}out(c, senc(mCli(pkCli_1642,pkSess_1996),Kcli_2006))
                                                                )
                                                                else
                                                                    {1590}let pkSess_2007: bitstring = pub(sk(Sess)) in
                                                                    {1591}out(c, GetEndpointRequest);
                                                                    {1592}in(c, (=GetEndpointResponse,=pkSess_2007,=None,SP_2008: bitstring,UP_2009: bitstring));
                                                                    {1593}new Nc_2010: bitstring;
                                                                    {1594}let m1_2011: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2010) in
                                                                    {1595}out(c, (pkCli_1642,m1_2011));
                                                                    {1596}in(c, em2_2012: bitstring);
                                                                    {1597}let m2_2013: bitstring = em2_2012 in
                                                                    {1598}let (=OpenSecureChannelResponse,=Cli,Ns_2014: bitstring,ST_2015: bitstring,TTL_2016: bitstring) = m2_2013 in
                                                                    {1599}let Kcli_2017: bitstring = h((Nc_2010,Ns_2014)) in
                                                                    {1600}out(c, senc(mCli(pkCli_1642,pkSess_2007),Kcli_2017))
                                                            )
                                                            else
                                                                {1601}let pkSess_2018: bitstring = fail-any in
                                                                {1602}out(c, GetEndpointRequest);
                                                                {1603}in(c, (=GetEndpointResponse,=pkSess_2018,=None,SP_2019: bitstring,UP_2020: bitstring));
                                                                {1604}new Nc_2021: bitstring;
                                                                {1605}let m1_2022: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2021) in
                                                                {1606}out(c, (pkCli_1642,m1_2022));
                                                                {1607}in(c, em2_2023: bitstring);
                                                                {1608}let m2_2024: bitstring = em2_2023 in
                                                                {1609}let (=OpenSecureChannelResponse,=Cli,Ns_2025: bitstring,ST_2026: bitstring,TTL_2027: bitstring) = m2_2024 in
                                                                {1610}let Kcli_2028: bitstring = h((Nc_2021,Ns_2025)) in
                                                                {1611}out(c, senc(mCli(pkCli_1642,pkSess_2018),Kcli_2028))
                                                    )
                                                    else
                                                        {1612}let pkSess_2029: bitstring = fail-any in
                                                        {1613}out(c, GetEndpointRequest);
                                                        {1614}in(c, (=GetEndpointResponse,=pkSess_2029,=None,SP_2030: bitstring,UP_2031: bitstring));
                                                        {1615}new Nc_2032: bitstring;
                                                        {1616}let m1_2033: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2032) in
                                                        {1617}out(c, (pkCli_1642,m1_2033));
                                                        {1618}in(c, em2_2034: bitstring);
                                                        {1619}let m2_2035: bitstring = em2_2034 in
                                                        {1620}let (=OpenSecureChannelResponse,=Cli,Ns_2036: bitstring,ST_2037: bitstring,TTL_2038: bitstring) = m2_2035 in
                                                        {1621}let Kcli_2039: bitstring = h((Nc_2032,Ns_2036)) in
                                                        {1622}out(c, senc(mCli(pkCli_1642,pkSess_2029),Kcli_2039))
                                            )
                                            else
                                                {1623}let pkSess_2040: bitstring = fail-any in
                                                {1624}out(c, GetEndpointRequest);
                                                {1625}in(c, (=GetEndpointResponse,=pkSess_2040,=None,SP_2041: bitstring,UP_2042: bitstring));
                                                {1626}new Nc_2043: bitstring;
                                                {1627}let m1_2044: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2043) in
                                                {1628}out(c, (pkCli_1642,m1_2044));
                                                {1629}in(c, em2_2045: bitstring);
                                                {1630}let m2_2046: bitstring = em2_2045 in
                                                {1631}let (=OpenSecureChannelResponse,=Cli,Ns_2047: bitstring,ST_2048: bitstring,TTL_2049: bitstring) = m2_2046 in
                                                {1632}let Kcli_2050: bitstring = h((Nc_2043,Ns_2047)) in
                                                {1633}out(c, senc(mCli(pkCli_1642,pkSess_2040),Kcli_2050))
                                )
                                else
                                    {1634}let pkDisco_2051: bitstring = fail-any in
                                    {1635}let v_2052: bool = (Sess = A) in
                                    (
                                        {1636}if v_2052 then
                                        (
                                            {1637}let pkSess_2053: bitstring = pub(skA) in
                                            {1638}out(c, GetEndpointRequest);
                                            {1639}in(c, (=GetEndpointResponse,=pkSess_2053,=None,SP_2054: bitstring,UP_2055: bitstring));
                                            {1640}new Nc_2056: bitstring;
                                            {1641}let m1_2057: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2056) in
                                            {1642}out(c, (pkCli_1642,m1_2057));
                                            {1643}in(c, em2_2058: bitstring);
                                            {1644}let m2_2059: bitstring = em2_2058 in
                                            {1645}let (=OpenSecureChannelResponse,=Cli,Ns_2060: bitstring,ST_2061: bitstring,TTL_2062: bitstring) = m2_2059 in
                                            {1646}let Kcli_2063: bitstring = h((Nc_2056,Ns_2060)) in
                                            {1647}out(c, senc(mCli(pkCli_1642,pkSess_2053),Kcli_2063))
                                        )
                                        else
                                            {1648}let v_2064: bool = (Sess = B) in
                                            (
                                                {1649}if v_2064 then
                                                (
                                                    {1650}let pkSess_2065: bitstring = pub(skB) in
                                                    {1651}out(c, GetEndpointRequest);
                                                    {1652}in(c, (=GetEndpointResponse,=pkSess_2065,=None,SP_2066: bitstring,UP_2067: bitstring));
                                                    {1653}new Nc_2068: bitstring;
                                                    {1654}let m1_2069: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2068) in
                                                    {1655}out(c, (pkCli_1642,m1_2069));
                                                    {1656}in(c, em2_2070: bitstring);
                                                    {1657}let m2_2071: bitstring = em2_2070 in
                                                    {1658}let (=OpenSecureChannelResponse,=Cli,Ns_2072: bitstring,ST_2073: bitstring,TTL_2074: bitstring) = m2_2071 in
                                                    {1659}let Kcli_2075: bitstring = h((Nc_2068,Ns_2072)) in
                                                    {1660}out(c, senc(mCli(pkCli_1642,pkSess_2065),Kcli_2075))
                                                )
                                                else
                                                    {1661}let v_2076: bool = (Sess = C) in
                                                    (
                                                        {1662}if v_2076 then
                                                        (
                                                            {1663}let pkSess_2077: bitstring = pub(skC) in
                                                            {1664}out(c, GetEndpointRequest);
                                                            {1665}in(c, (=GetEndpointResponse,=pkSess_2077,=None,SP_2078: bitstring,UP_2079: bitstring));
                                                            {1666}new Nc_2080: bitstring;
                                                            {1667}let m1_2081: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2080) in
                                                            {1668}out(c, (pkCli_1642,m1_2081));
                                                            {1669}in(c, em2_2082: bitstring);
                                                            {1670}let m2_2083: bitstring = em2_2082 in
                                                            {1671}let (=OpenSecureChannelResponse,=Cli,Ns_2084: bitstring,ST_2085: bitstring,TTL_2086: bitstring) = m2_2083 in
                                                            {1672}let Kcli_2087: bitstring = h((Nc_2080,Ns_2084)) in
                                                            {1673}out(c, senc(mCli(pkCli_1642,pkSess_2077),Kcli_2087))
                                                        )
                                                        else
                                                            {1674}let pkSess_2088: bitstring = pub(sk(Sess)) in
                                                            {1675}out(c, GetEndpointRequest);
                                                            {1676}in(c, (=GetEndpointResponse,=pkSess_2088,=None,SP_2089: bitstring,UP_2090: bitstring));
                                                            {1677}new Nc_2091: bitstring;
                                                            {1678}let m1_2092: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2091) in
                                                            {1679}out(c, (pkCli_1642,m1_2092));
                                                            {1680}in(c, em2_2093: bitstring);
                                                            {1681}let m2_2094: bitstring = em2_2093 in
                                                            {1682}let (=OpenSecureChannelResponse,=Cli,Ns_2095: bitstring,ST_2096: bitstring,TTL_2097: bitstring) = m2_2094 in
                                                            {1683}let Kcli_2098: bitstring = h((Nc_2091,Ns_2095)) in
                                                            {1684}out(c, senc(mCli(pkCli_1642,pkSess_2088),Kcli_2098))
                                                    )
                                                    else
                                                        {1685}let pkSess_2099: bitstring = fail-any in
                                                        {1686}out(c, GetEndpointRequest);
                                                        {1687}in(c, (=GetEndpointResponse,=pkSess_2099,=None,SP_2100: bitstring,UP_2101: bitstring));
                                                        {1688}new Nc_2102: bitstring;
                                                        {1689}let m1_2103: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2102) in
                                                        {1690}out(c, (pkCli_1642,m1_2103));
                                                        {1691}in(c, em2_2104: bitstring);
                                                        {1692}let m2_2105: bitstring = em2_2104 in
                                                        {1693}let (=OpenSecureChannelResponse,=Cli,Ns_2106: bitstring,ST_2107: bitstring,TTL_2108: bitstring) = m2_2105 in
                                                        {1694}let Kcli_2109: bitstring = h((Nc_2102,Ns_2106)) in
                                                        {1695}out(c, senc(mCli(pkCli_1642,pkSess_2099),Kcli_2109))
                                            )
                                            else
                                                {1696}let pkSess_2110: bitstring = fail-any in
                                                {1697}out(c, GetEndpointRequest);
                                                {1698}in(c, (=GetEndpointResponse,=pkSess_2110,=None,SP_2111: bitstring,UP_2112: bitstring));
                                                {1699}new Nc_2113: bitstring;
                                                {1700}let m1_2114: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2113) in
                                                {1701}out(c, (pkCli_1642,m1_2114));
                                                {1702}in(c, em2_2115: bitstring);
                                                {1703}let m2_2116: bitstring = em2_2115 in
                                                {1704}let (=OpenSecureChannelResponse,=Cli,Ns_2117: bitstring,ST_2118: bitstring,TTL_2119: bitstring) = m2_2116 in
                                                {1705}let Kcli_2120: bitstring = h((Nc_2113,Ns_2117)) in
                                                {1706}out(c, senc(mCli(pkCli_1642,pkSess_2110),Kcli_2120))
                                    )
                                    else
                                        {1707}let pkSess_2121: bitstring = fail-any in
                                        {1708}out(c, GetEndpointRequest);
                                        {1709}in(c, (=GetEndpointResponse,=pkSess_2121,=None,SP_2122: bitstring,UP_2123: bitstring));
                                        {1710}new Nc_2124: bitstring;
                                        {1711}let m1_2125: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2124) in
                                        {1712}out(c, (pkCli_1642,m1_2125));
                                        {1713}in(c, em2_2126: bitstring);
                                        {1714}let m2_2127: bitstring = em2_2126 in
                                        {1715}let (=OpenSecureChannelResponse,=Cli,Ns_2128: bitstring,ST_2129: bitstring,TTL_2130: bitstring) = m2_2127 in
                                        {1716}let Kcli_2131: bitstring = h((Nc_2124,Ns_2128)) in
                                        {1717}out(c, senc(mCli(pkCli_1642,pkSess_2121),Kcli_2131))
                        )
                        else
                            {1718}let pkDisco_2132: bitstring = fail-any in
                            {1719}let v_2133: bool = (Sess = A) in
                            (
                                {1720}if v_2133 then
                                (
                                    {1721}let pkSess_2134: bitstring = pub(skA) in
                                    {1722}out(c, GetEndpointRequest);
                                    {1723}in(c, (=GetEndpointResponse,=pkSess_2134,=None,SP_2135: bitstring,UP_2136: bitstring));
                                    {1724}new Nc_2137: bitstring;
                                    {1725}let m1_2138: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2137) in
                                    {1726}out(c, (pkCli_1642,m1_2138));
                                    {1727}in(c, em2_2139: bitstring);
                                    {1728}let m2_2140: bitstring = em2_2139 in
                                    {1729}let (=OpenSecureChannelResponse,=Cli,Ns_2141: bitstring,ST_2142: bitstring,TTL_2143: bitstring) = m2_2140 in
                                    {1730}let Kcli_2144: bitstring = h((Nc_2137,Ns_2141)) in
                                    {1731}out(c, senc(mCli(pkCli_1642,pkSess_2134),Kcli_2144))
                                )
                                else
                                    {1732}let v_2145: bool = (Sess = B) in
                                    (
                                        {1733}if v_2145 then
                                        (
                                            {1734}let pkSess_2146: bitstring = pub(skB) in
                                            {1735}out(c, GetEndpointRequest);
                                            {1736}in(c, (=GetEndpointResponse,=pkSess_2146,=None,SP_2147: bitstring,UP_2148: bitstring));
                                            {1737}new Nc_2149: bitstring;
                                            {1738}let m1_2150: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2149) in
                                            {1739}out(c, (pkCli_1642,m1_2150));
                                            {1740}in(c, em2_2151: bitstring);
                                            {1741}let m2_2152: bitstring = em2_2151 in
                                            {1742}let (=OpenSecureChannelResponse,=Cli,Ns_2153: bitstring,ST_2154: bitstring,TTL_2155: bitstring) = m2_2152 in
                                            {1743}let Kcli_2156: bitstring = h((Nc_2149,Ns_2153)) in
                                            {1744}out(c, senc(mCli(pkCli_1642,pkSess_2146),Kcli_2156))
                                        )
                                        else
                                            {1745}let v_2157: bool = (Sess = C) in
                                            (
                                                {1746}if v_2157 then
                                                (
                                                    {1747}let pkSess_2158: bitstring = pub(skC) in
                                                    {1748}out(c, GetEndpointRequest);
                                                    {1749}in(c, (=GetEndpointResponse,=pkSess_2158,=None,SP_2159: bitstring,UP_2160: bitstring));
                                                    {1750}new Nc_2161: bitstring;
                                                    {1751}let m1_2162: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2161) in
                                                    {1752}out(c, (pkCli_1642,m1_2162));
                                                    {1753}in(c, em2_2163: bitstring);
                                                    {1754}let m2_2164: bitstring = em2_2163 in
                                                    {1755}let (=OpenSecureChannelResponse,=Cli,Ns_2165: bitstring,ST_2166: bitstring,TTL_2167: bitstring) = m2_2164 in
                                                    {1756}let Kcli_2168: bitstring = h((Nc_2161,Ns_2165)) in
                                                    {1757}out(c, senc(mCli(pkCli_1642,pkSess_2158),Kcli_2168))
                                                )
                                                else
                                                    {1758}let pkSess_2169: bitstring = pub(sk(Sess)) in
                                                    {1759}out(c, GetEndpointRequest);
                                                    {1760}in(c, (=GetEndpointResponse,=pkSess_2169,=None,SP_2170: bitstring,UP_2171: bitstring));
                                                    {1761}new Nc_2172: bitstring;
                                                    {1762}let m1_2173: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2172) in
                                                    {1763}out(c, (pkCli_1642,m1_2173));
                                                    {1764}in(c, em2_2174: bitstring);
                                                    {1765}let m2_2175: bitstring = em2_2174 in
                                                    {1766}let (=OpenSecureChannelResponse,=Cli,Ns_2176: bitstring,ST_2177: bitstring,TTL_2178: bitstring) = m2_2175 in
                                                    {1767}let Kcli_2179: bitstring = h((Nc_2172,Ns_2176)) in
                                                    {1768}out(c, senc(mCli(pkCli_1642,pkSess_2169),Kcli_2179))
                                            )
                                            else
                                                {1769}let pkSess_2180: bitstring = fail-any in
                                                {1770}out(c, GetEndpointRequest);
                                                {1771}in(c, (=GetEndpointResponse,=pkSess_2180,=None,SP_2181: bitstring,UP_2182: bitstring));
                                                {1772}new Nc_2183: bitstring;
                                                {1773}let m1_2184: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2183) in
                                                {1774}out(c, (pkCli_1642,m1_2184));
                                                {1775}in(c, em2_2185: bitstring);
                                                {1776}let m2_2186: bitstring = em2_2185 in
                                                {1777}let (=OpenSecureChannelResponse,=Cli,Ns_2187: bitstring,ST_2188: bitstring,TTL_2189: bitstring) = m2_2186 in
                                                {1778}let Kcli_2190: bitstring = h((Nc_2183,Ns_2187)) in
                                                {1779}out(c, senc(mCli(pkCli_1642,pkSess_2180),Kcli_2190))
                                    )
                                    else
                                        {1780}let pkSess_2191: bitstring = fail-any in
                                        {1781}out(c, GetEndpointRequest);
                                        {1782}in(c, (=GetEndpointResponse,=pkSess_2191,=None,SP_2192: bitstring,UP_2193: bitstring));
                                        {1783}new Nc_2194: bitstring;
                                        {1784}let m1_2195: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2194) in
                                        {1785}out(c, (pkCli_1642,m1_2195));
                                        {1786}in(c, em2_2196: bitstring);
                                        {1787}let m2_2197: bitstring = em2_2196 in
                                        {1788}let (=OpenSecureChannelResponse,=Cli,Ns_2198: bitstring,ST_2199: bitstring,TTL_2200: bitstring) = m2_2197 in
                                        {1789}let Kcli_2201: bitstring = h((Nc_2194,Ns_2198)) in
                                        {1790}out(c, senc(mCli(pkCli_1642,pkSess_2191),Kcli_2201))
                            )
                            else
                                {1791}let pkSess_2202: bitstring = fail-any in
                                {1792}out(c, GetEndpointRequest);
                                {1793}in(c, (=GetEndpointResponse,=pkSess_2202,=None,SP_2203: bitstring,UP_2204: bitstring));
                                {1794}new Nc_2205: bitstring;
                                {1795}let m1_2206: bitstring = (OpenSecureChannelRequest,Sess,pkCli_1642,Nc_2205) in
                                {1796}out(c, (pkCli_1642,m1_2206));
                                {1797}in(c, em2_2207: bitstring);
                                {1798}let m2_2208: bitstring = em2_2207 in
                                {1799}let (=OpenSecureChannelResponse,=Cli,Ns_2209: bitstring,ST_2210: bitstring,TTL_2211: bitstring) = m2_2208 in
                                {1800}let Kcli_2212: bitstring = h((Nc_2205,Ns_2209)) in
                                {1801}out(c, senc(mCli(pkCli_1642,pkSess_2202),Kcli_2212))
                    )
                    else
                        {1802}let skCli_2213: bitstring = fail-any in
                        {1803}let pkCli_2214: bitstring = pub(skCli_2213) in
                        {1804}let v_2215: bool = (Disco = A) in
                        (
                            {1805}if v_2215 then
                            (
                                {1806}let pkDisco_2216: bitstring = pub(skA) in
                                {1807}let v_2217: bool = (Sess = A) in
                                (
                                    {1808}if v_2217 then
                                    (
                                        {1809}let pkSess_2218: bitstring = pub(skA) in
                                        {1810}out(c, GetEndpointRequest);
                                        {1811}in(c, (=GetEndpointResponse,=pkSess_2218,=None,SP_2219: bitstring,UP_2220: bitstring));
                                        {1812}new Nc_2221: bitstring;
                                        {1813}let m1_2222: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2221) in
                                        {1814}out(c, (pkCli_2214,m1_2222));
                                        {1815}in(c, em2_2223: bitstring);
                                        {1816}let m2_2224: bitstring = em2_2223 in
                                        {1817}let (=OpenSecureChannelResponse,=Cli,Ns_2225: bitstring,ST_2226: bitstring,TTL_2227: bitstring) = m2_2224 in
                                        {1818}let Kcli_2228: bitstring = h((Nc_2221,Ns_2225)) in
                                        {1819}out(c, senc(mCli(pkCli_2214,pkSess_2218),Kcli_2228))
                                    )
                                    else
                                        {1820}let v_2229: bool = (Sess = B) in
                                        (
                                            {1821}if v_2229 then
                                            (
                                                {1822}let pkSess_2230: bitstring = pub(skB) in
                                                {1823}out(c, GetEndpointRequest);
                                                {1824}in(c, (=GetEndpointResponse,=pkSess_2230,=None,SP_2231: bitstring,UP_2232: bitstring));
                                                {1825}new Nc_2233: bitstring;
                                                {1826}let m1_2234: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2233) in
                                                {1827}out(c, (pkCli_2214,m1_2234));
                                                {1828}in(c, em2_2235: bitstring);
                                                {1829}let m2_2236: bitstring = em2_2235 in
                                                {1830}let (=OpenSecureChannelResponse,=Cli,Ns_2237: bitstring,ST_2238: bitstring,TTL_2239: bitstring) = m2_2236 in
                                                {1831}let Kcli_2240: bitstring = h((Nc_2233,Ns_2237)) in
                                                {1832}out(c, senc(mCli(pkCli_2214,pkSess_2230),Kcli_2240))
                                            )
                                            else
                                                {1833}let v_2241: bool = (Sess = C) in
                                                (
                                                    {1834}if v_2241 then
                                                    (
                                                        {1835}let pkSess_2242: bitstring = pub(skC) in
                                                        {1836}out(c, GetEndpointRequest);
                                                        {1837}in(c, (=GetEndpointResponse,=pkSess_2242,=None,SP_2243: bitstring,UP_2244: bitstring));
                                                        {1838}new Nc_2245: bitstring;
                                                        {1839}let m1_2246: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2245) in
                                                        {1840}out(c, (pkCli_2214,m1_2246));
                                                        {1841}in(c, em2_2247: bitstring);
                                                        {1842}let m2_2248: bitstring = em2_2247 in
                                                        {1843}let (=OpenSecureChannelResponse,=Cli,Ns_2249: bitstring,ST_2250: bitstring,TTL_2251: bitstring) = m2_2248 in
                                                        {1844}let Kcli_2252: bitstring = h((Nc_2245,Ns_2249)) in
                                                        {1845}out(c, senc(mCli(pkCli_2214,pkSess_2242),Kcli_2252))
                                                    )
                                                    else
                                                        {1846}let pkSess_2253: bitstring = pub(sk(Sess)) in
                                                        {1847}out(c, GetEndpointRequest);
                                                        {1848}in(c, (=GetEndpointResponse,=pkSess_2253,=None,SP_2254: bitstring,UP_2255: bitstring));
                                                        {1849}new Nc_2256: bitstring;
                                                        {1850}let m1_2257: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2256) in
                                                        {1851}out(c, (pkCli_2214,m1_2257));
                                                        {1852}in(c, em2_2258: bitstring);
                                                        {1853}let m2_2259: bitstring = em2_2258 in
                                                        {1854}let (=OpenSecureChannelResponse,=Cli,Ns_2260: bitstring,ST_2261: bitstring,TTL_2262: bitstring) = m2_2259 in
                                                        {1855}let Kcli_2263: bitstring = h((Nc_2256,Ns_2260)) in
                                                        {1856}out(c, senc(mCli(pkCli_2214,pkSess_2253),Kcli_2263))
                                                )
                                                else
                                                    {1857}let pkSess_2264: bitstring = fail-any in
                                                    {1858}out(c, GetEndpointRequest);
                                                    {1859}in(c, (=GetEndpointResponse,=pkSess_2264,=None,SP_2265: bitstring,UP_2266: bitstring));
                                                    {1860}new Nc_2267: bitstring;
                                                    {1861}let m1_2268: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2267) in
                                                    {1862}out(c, (pkCli_2214,m1_2268));
                                                    {1863}in(c, em2_2269: bitstring);
                                                    {1864}let m2_2270: bitstring = em2_2269 in
                                                    {1865}let (=OpenSecureChannelResponse,=Cli,Ns_2271: bitstring,ST_2272: bitstring,TTL_2273: bitstring) = m2_2270 in
                                                    {1866}let Kcli_2274: bitstring = h((Nc_2267,Ns_2271)) in
                                                    {1867}out(c, senc(mCli(pkCli_2214,pkSess_2264),Kcli_2274))
                                        )
                                        else
                                            {1868}let pkSess_2275: bitstring = fail-any in
                                            {1869}out(c, GetEndpointRequest);
                                            {1870}in(c, (=GetEndpointResponse,=pkSess_2275,=None,SP_2276: bitstring,UP_2277: bitstring));
                                            {1871}new Nc_2278: bitstring;
                                            {1872}let m1_2279: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2278) in
                                            {1873}out(c, (pkCli_2214,m1_2279));
                                            {1874}in(c, em2_2280: bitstring);
                                            {1875}let m2_2281: bitstring = em2_2280 in
                                            {1876}let (=OpenSecureChannelResponse,=Cli,Ns_2282: bitstring,ST_2283: bitstring,TTL_2284: bitstring) = m2_2281 in
                                            {1877}let Kcli_2285: bitstring = h((Nc_2278,Ns_2282)) in
                                            {1878}out(c, senc(mCli(pkCli_2214,pkSess_2275),Kcli_2285))
                                )
                                else
                                    {1879}let pkSess_2286: bitstring = fail-any in
                                    {1880}out(c, GetEndpointRequest);
                                    {1881}in(c, (=GetEndpointResponse,=pkSess_2286,=None,SP_2287: bitstring,UP_2288: bitstring));
                                    {1882}new Nc_2289: bitstring;
                                    {1883}let m1_2290: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2289) in
                                    {1884}out(c, (pkCli_2214,m1_2290));
                                    {1885}in(c, em2_2291: bitstring);
                                    {1886}let m2_2292: bitstring = em2_2291 in
                                    {1887}let (=OpenSecureChannelResponse,=Cli,Ns_2293: bitstring,ST_2294: bitstring,TTL_2295: bitstring) = m2_2292 in
                                    {1888}let Kcli_2296: bitstring = h((Nc_2289,Ns_2293)) in
                                    {1889}out(c, senc(mCli(pkCli_2214,pkSess_2286),Kcli_2296))
                            )
                            else
                                {1890}let v_2297: bool = (Disco = B) in
                                (
                                    {1891}if v_2297 then
                                    (
                                        {1892}let pkDisco_2298: bitstring = pub(skB) in
                                        {1893}let v_2299: bool = (Sess = A) in
                                        (
                                            {1894}if v_2299 then
                                            (
                                                {1895}let pkSess_2300: bitstring = pub(skA) in
                                                {1896}out(c, GetEndpointRequest);
                                                {1897}in(c, (=GetEndpointResponse,=pkSess_2300,=None,SP_2301: bitstring,UP_2302: bitstring));
                                                {1898}new Nc_2303: bitstring;
                                                {1899}let m1_2304: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2303) in
                                                {1900}out(c, (pkCli_2214,m1_2304));
                                                {1901}in(c, em2_2305: bitstring);
                                                {1902}let m2_2306: bitstring = em2_2305 in
                                                {1903}let (=OpenSecureChannelResponse,=Cli,Ns_2307: bitstring,ST_2308: bitstring,TTL_2309: bitstring) = m2_2306 in
                                                {1904}let Kcli_2310: bitstring = h((Nc_2303,Ns_2307)) in
                                                {1905}out(c, senc(mCli(pkCli_2214,pkSess_2300),Kcli_2310))
                                            )
                                            else
                                                {1906}let v_2311: bool = (Sess = B) in
                                                (
                                                    {1907}if v_2311 then
                                                    (
                                                        {1908}let pkSess_2312: bitstring = pub(skB) in
                                                        {1909}out(c, GetEndpointRequest);
                                                        {1910}in(c, (=GetEndpointResponse,=pkSess_2312,=None,SP_2313: bitstring,UP_2314: bitstring));
                                                        {1911}new Nc_2315: bitstring;
                                                        {1912}let m1_2316: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2315) in
                                                        {1913}out(c, (pkCli_2214,m1_2316));
                                                        {1914}in(c, em2_2317: bitstring);
                                                        {1915}let m2_2318: bitstring = em2_2317 in
                                                        {1916}let (=OpenSecureChannelResponse,=Cli,Ns_2319: bitstring,ST_2320: bitstring,TTL_2321: bitstring) = m2_2318 in
                                                        {1917}let Kcli_2322: bitstring = h((Nc_2315,Ns_2319)) in
                                                        {1918}out(c, senc(mCli(pkCli_2214,pkSess_2312),Kcli_2322))
                                                    )
                                                    else
                                                        {1919}let v_2323: bool = (Sess = C) in
                                                        (
                                                            {1920}if v_2323 then
                                                            (
                                                                {1921}let pkSess_2324: bitstring = pub(skC) in
                                                                {1922}out(c, GetEndpointRequest);
                                                                {1923}in(c, (=GetEndpointResponse,=pkSess_2324,=None,SP_2325: bitstring,UP_2326: bitstring));
                                                                {1924}new Nc_2327: bitstring;
                                                                {1925}let m1_2328: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2327) in
                                                                {1926}out(c, (pkCli_2214,m1_2328));
                                                                {1927}in(c, em2_2329: bitstring);
                                                                {1928}let m2_2330: bitstring = em2_2329 in
                                                                {1929}let (=OpenSecureChannelResponse,=Cli,Ns_2331: bitstring,ST_2332: bitstring,TTL_2333: bitstring) = m2_2330 in
                                                                {1930}let Kcli_2334: bitstring = h((Nc_2327,Ns_2331)) in
                                                                {1931}out(c, senc(mCli(pkCli_2214,pkSess_2324),Kcli_2334))
                                                            )
                                                            else
                                                                {1932}let pkSess_2335: bitstring = pub(sk(Sess)) in
                                                                {1933}out(c, GetEndpointRequest);
                                                                {1934}in(c, (=GetEndpointResponse,=pkSess_2335,=None,SP_2336: bitstring,UP_2337: bitstring));
                                                                {1935}new Nc_2338: bitstring;
                                                                {1936}let m1_2339: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2338) in
                                                                {1937}out(c, (pkCli_2214,m1_2339));
                                                                {1938}in(c, em2_2340: bitstring);
                                                                {1939}let m2_2341: bitstring = em2_2340 in
                                                                {1940}let (=OpenSecureChannelResponse,=Cli,Ns_2342: bitstring,ST_2343: bitstring,TTL_2344: bitstring) = m2_2341 in
                                                                {1941}let Kcli_2345: bitstring = h((Nc_2338,Ns_2342)) in
                                                                {1942}out(c, senc(mCli(pkCli_2214,pkSess_2335),Kcli_2345))
                                                        )
                                                        else
                                                            {1943}let pkSess_2346: bitstring = fail-any in
                                                            {1944}out(c, GetEndpointRequest);
                                                            {1945}in(c, (=GetEndpointResponse,=pkSess_2346,=None,SP_2347: bitstring,UP_2348: bitstring));
                                                            {1946}new Nc_2349: bitstring;
                                                            {1947}let m1_2350: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2349) in
                                                            {1948}out(c, (pkCli_2214,m1_2350));
                                                            {1949}in(c, em2_2351: bitstring);
                                                            {1950}let m2_2352: bitstring = em2_2351 in
                                                            {1951}let (=OpenSecureChannelResponse,=Cli,Ns_2353: bitstring,ST_2354: bitstring,TTL_2355: bitstring) = m2_2352 in
                                                            {1952}let Kcli_2356: bitstring = h((Nc_2349,Ns_2353)) in
                                                            {1953}out(c, senc(mCli(pkCli_2214,pkSess_2346),Kcli_2356))
                                                )
                                                else
                                                    {1954}let pkSess_2357: bitstring = fail-any in
                                                    {1955}out(c, GetEndpointRequest);
                                                    {1956}in(c, (=GetEndpointResponse,=pkSess_2357,=None,SP_2358: bitstring,UP_2359: bitstring));
                                                    {1957}new Nc_2360: bitstring;
                                                    {1958}let m1_2361: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2360) in
                                                    {1959}out(c, (pkCli_2214,m1_2361));
                                                    {1960}in(c, em2_2362: bitstring);
                                                    {1961}let m2_2363: bitstring = em2_2362 in
                                                    {1962}let (=OpenSecureChannelResponse,=Cli,Ns_2364: bitstring,ST_2365: bitstring,TTL_2366: bitstring) = m2_2363 in
                                                    {1963}let Kcli_2367: bitstring = h((Nc_2360,Ns_2364)) in
                                                    {1964}out(c, senc(mCli(pkCli_2214,pkSess_2357),Kcli_2367))
                                        )
                                        else
                                            {1965}let pkSess_2368: bitstring = fail-any in
                                            {1966}out(c, GetEndpointRequest);
                                            {1967}in(c, (=GetEndpointResponse,=pkSess_2368,=None,SP_2369: bitstring,UP_2370: bitstring));
                                            {1968}new Nc_2371: bitstring;
                                            {1969}let m1_2372: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2371) in
                                            {1970}out(c, (pkCli_2214,m1_2372));
                                            {1971}in(c, em2_2373: bitstring);
                                            {1972}let m2_2374: bitstring = em2_2373 in
                                            {1973}let (=OpenSecureChannelResponse,=Cli,Ns_2375: bitstring,ST_2376: bitstring,TTL_2377: bitstring) = m2_2374 in
                                            {1974}let Kcli_2378: bitstring = h((Nc_2371,Ns_2375)) in
                                            {1975}out(c, senc(mCli(pkCli_2214,pkSess_2368),Kcli_2378))
                                    )
                                    else
                                        {1976}let v_2379: bool = (Disco = C) in
                                        (
                                            {1977}if v_2379 then
                                            (
                                                {1978}let pkDisco_2380: bitstring = pub(skC) in
                                                {1979}let v_2381: bool = (Sess = A) in
                                                (
                                                    {1980}if v_2381 then
                                                    (
                                                        {1981}let pkSess_2382: bitstring = pub(skA) in
                                                        {1982}out(c, GetEndpointRequest);
                                                        {1983}in(c, (=GetEndpointResponse,=pkSess_2382,=None,SP_2383: bitstring,UP_2384: bitstring));
                                                        {1984}new Nc_2385: bitstring;
                                                        {1985}let m1_2386: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2385) in
                                                        {1986}out(c, (pkCli_2214,m1_2386));
                                                        {1987}in(c, em2_2387: bitstring);
                                                        {1988}let m2_2388: bitstring = em2_2387 in
                                                        {1989}let (=OpenSecureChannelResponse,=Cli,Ns_2389: bitstring,ST_2390: bitstring,TTL_2391: bitstring) = m2_2388 in
                                                        {1990}let Kcli_2392: bitstring = h((Nc_2385,Ns_2389)) in
                                                        {1991}out(c, senc(mCli(pkCli_2214,pkSess_2382),Kcli_2392))
                                                    )
                                                    else
                                                        {1992}let v_2393: bool = (Sess = B) in
                                                        (
                                                            {1993}if v_2393 then
                                                            (
                                                                {1994}let pkSess_2394: bitstring = pub(skB) in
                                                                {1995}out(c, GetEndpointRequest);
                                                                {1996}in(c, (=GetEndpointResponse,=pkSess_2394,=None,SP_2395: bitstring,UP_2396: bitstring));
                                                                {1997}new Nc_2397: bitstring;
                                                                {1998}let m1_2398: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2397) in
                                                                {1999}out(c, (pkCli_2214,m1_2398));
                                                                {2000}in(c, em2_2399: bitstring);
                                                                {2001}let m2_2400: bitstring = em2_2399 in
                                                                {2002}let (=OpenSecureChannelResponse,=Cli,Ns_2401: bitstring,ST_2402: bitstring,TTL_2403: bitstring) = m2_2400 in
                                                                {2003}let Kcli_2404: bitstring = h((Nc_2397,Ns_2401)) in
                                                                {2004}out(c, senc(mCli(pkCli_2214,pkSess_2394),Kcli_2404))
                                                            )
                                                            else
                                                                {2005}let v_2405: bool = (Sess = C) in
                                                                (
                                                                    {2006}if v_2405 then
                                                                    (
                                                                        {2007}let pkSess_2406: bitstring = pub(skC) in
                                                                        {2008}out(c, GetEndpointRequest);
                                                                        {2009}in(c, (=GetEndpointResponse,=pkSess_2406,=None,SP_2407: bitstring,UP_2408: bitstring));
                                                                        {2010}new Nc_2409: bitstring;
                                                                        {2011}let m1_2410: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2409) in
                                                                        {2012}out(c, (pkCli_2214,m1_2410));
                                                                        {2013}in(c, em2_2411: bitstring);
                                                                        {2014}let m2_2412: bitstring = em2_2411 in
                                                                        {2015}let (=OpenSecureChannelResponse,=Cli,Ns_2413: bitstring,ST_2414: bitstring,TTL_2415: bitstring) = m2_2412 in
                                                                        {2016}let Kcli_2416: bitstring = h((Nc_2409,Ns_2413)) in
                                                                        {2017}out(c, senc(mCli(pkCli_2214,pkSess_2406),Kcli_2416))
                                                                    )
                                                                    else
                                                                        {2018}let pkSess_2417: bitstring = pub(sk(Sess)) in
                                                                        {2019}out(c, GetEndpointRequest);
                                                                        {2020}in(c, (=GetEndpointResponse,=pkSess_2417,=None,SP_2418: bitstring,UP_2419: bitstring));
                                                                        {2021}new Nc_2420: bitstring;
                                                                        {2022}let m1_2421: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2420) in
                                                                        {2023}out(c, (pkCli_2214,m1_2421));
                                                                        {2024}in(c, em2_2422: bitstring);
                                                                        {2025}let m2_2423: bitstring = em2_2422 in
                                                                        {2026}let (=OpenSecureChannelResponse,=Cli,Ns_2424: bitstring,ST_2425: bitstring,TTL_2426: bitstring) = m2_2423 in
                                                                        {2027}let Kcli_2427: bitstring = h((Nc_2420,Ns_2424)) in
                                                                        {2028}out(c, senc(mCli(pkCli_2214,pkSess_2417),Kcli_2427))
                                                                )
                                                                else
                                                                    {2029}let pkSess_2428: bitstring = fail-any in
                                                                    {2030}out(c, GetEndpointRequest);
                                                                    {2031}in(c, (=GetEndpointResponse,=pkSess_2428,=None,SP_2429: bitstring,UP_2430: bitstring));
                                                                    {2032}new Nc_2431: bitstring;
                                                                    {2033}let m1_2432: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2431) in
                                                                    {2034}out(c, (pkCli_2214,m1_2432));
                                                                    {2035}in(c, em2_2433: bitstring);
                                                                    {2036}let m2_2434: bitstring = em2_2433 in
                                                                    {2037}let (=OpenSecureChannelResponse,=Cli,Ns_2435: bitstring,ST_2436: bitstring,TTL_2437: bitstring) = m2_2434 in
                                                                    {2038}let Kcli_2438: bitstring = h((Nc_2431,Ns_2435)) in
                                                                    {2039}out(c, senc(mCli(pkCli_2214,pkSess_2428),Kcli_2438))
                                                        )
                                                        else
                                                            {2040}let pkSess_2439: bitstring = fail-any in
                                                            {2041}out(c, GetEndpointRequest);
                                                            {2042}in(c, (=GetEndpointResponse,=pkSess_2439,=None,SP_2440: bitstring,UP_2441: bitstring));
                                                            {2043}new Nc_2442: bitstring;
                                                            {2044}let m1_2443: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2442) in
                                                            {2045}out(c, (pkCli_2214,m1_2443));
                                                            {2046}in(c, em2_2444: bitstring);
                                                            {2047}let m2_2445: bitstring = em2_2444 in
                                                            {2048}let (=OpenSecureChannelResponse,=Cli,Ns_2446: bitstring,ST_2447: bitstring,TTL_2448: bitstring) = m2_2445 in
                                                            {2049}let Kcli_2449: bitstring = h((Nc_2442,Ns_2446)) in
                                                            {2050}out(c, senc(mCli(pkCli_2214,pkSess_2439),Kcli_2449))
                                                )
                                                else
                                                    {2051}let pkSess_2450: bitstring = fail-any in
                                                    {2052}out(c, GetEndpointRequest);
                                                    {2053}in(c, (=GetEndpointResponse,=pkSess_2450,=None,SP_2451: bitstring,UP_2452: bitstring));
                                                    {2054}new Nc_2453: bitstring;
                                                    {2055}let m1_2454: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2453) in
                                                    {2056}out(c, (pkCli_2214,m1_2454));
                                                    {2057}in(c, em2_2455: bitstring);
                                                    {2058}let m2_2456: bitstring = em2_2455 in
                                                    {2059}let (=OpenSecureChannelResponse,=Cli,Ns_2457: bitstring,ST_2458: bitstring,TTL_2459: bitstring) = m2_2456 in
                                                    {2060}let Kcli_2460: bitstring = h((Nc_2453,Ns_2457)) in
                                                    {2061}out(c, senc(mCli(pkCli_2214,pkSess_2450),Kcli_2460))
                                            )
                                            else
                                                {2062}let pkDisco_2461: bitstring = pub(sk(Disco)) in
                                                {2063}let v_2462: bool = (Sess = A) in
                                                (
                                                    {2064}if v_2462 then
                                                    (
                                                        {2065}let pkSess_2463: bitstring = pub(skA) in
                                                        {2066}out(c, GetEndpointRequest);
                                                        {2067}in(c, (=GetEndpointResponse,=pkSess_2463,=None,SP_2464: bitstring,UP_2465: bitstring));
                                                        {2068}new Nc_2466: bitstring;
                                                        {2069}let m1_2467: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2466) in
                                                        {2070}out(c, (pkCli_2214,m1_2467));
                                                        {2071}in(c, em2_2468: bitstring);
                                                        {2072}let m2_2469: bitstring = em2_2468 in
                                                        {2073}let (=OpenSecureChannelResponse,=Cli,Ns_2470: bitstring,ST_2471: bitstring,TTL_2472: bitstring) = m2_2469 in
                                                        {2074}let Kcli_2473: bitstring = h((Nc_2466,Ns_2470)) in
                                                        {2075}out(c, senc(mCli(pkCli_2214,pkSess_2463),Kcli_2473))
                                                    )
                                                    else
                                                        {2076}let v_2474: bool = (Sess = B) in
                                                        (
                                                            {2077}if v_2474 then
                                                            (
                                                                {2078}let pkSess_2475: bitstring = pub(skB) in
                                                                {2079}out(c, GetEndpointRequest);
                                                                {2080}in(c, (=GetEndpointResponse,=pkSess_2475,=None,SP_2476: bitstring,UP_2477: bitstring));
                                                                {2081}new Nc_2478: bitstring;
                                                                {2082}let m1_2479: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2478) in
                                                                {2083}out(c, (pkCli_2214,m1_2479));
                                                                {2084}in(c, em2_2480: bitstring);
                                                                {2085}let m2_2481: bitstring = em2_2480 in
                                                                {2086}let (=OpenSecureChannelResponse,=Cli,Ns_2482: bitstring,ST_2483: bitstring,TTL_2484: bitstring) = m2_2481 in
                                                                {2087}let Kcli_2485: bitstring = h((Nc_2478,Ns_2482)) in
                                                                {2088}out(c, senc(mCli(pkCli_2214,pkSess_2475),Kcli_2485))
                                                            )
                                                            else
                                                                {2089}let v_2486: bool = (Sess = C) in
                                                                (
                                                                    {2090}if v_2486 then
                                                                    (
                                                                        {2091}let pkSess_2487: bitstring = pub(skC) in
                                                                        {2092}out(c, GetEndpointRequest);
                                                                        {2093}in(c, (=GetEndpointResponse,=pkSess_2487,=None,SP_2488: bitstring,UP_2489: bitstring));
                                                                        {2094}new Nc_2490: bitstring;
                                                                        {2095}let m1_2491: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2490) in
                                                                        {2096}out(c, (pkCli_2214,m1_2491));
                                                                        {2097}in(c, em2_2492: bitstring);
                                                                        {2098}let m2_2493: bitstring = em2_2492 in
                                                                        {2099}let (=OpenSecureChannelResponse,=Cli,Ns_2494: bitstring,ST_2495: bitstring,TTL_2496: bitstring) = m2_2493 in
                                                                        {2100}let Kcli_2497: bitstring = h((Nc_2490,Ns_2494)) in
                                                                        {2101}out(c, senc(mCli(pkCli_2214,pkSess_2487),Kcli_2497))
                                                                    )
                                                                    else
                                                                        {2102}let pkSess_2498: bitstring = pub(sk(Sess)) in
                                                                        {2103}out(c, GetEndpointRequest);
                                                                        {2104}in(c, (=GetEndpointResponse,=pkSess_2498,=None,SP_2499: bitstring,UP_2500: bitstring));
                                                                        {2105}new Nc_2501: bitstring;
                                                                        {2106}let m1_2502: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2501) in
                                                                        {2107}out(c, (pkCli_2214,m1_2502));
                                                                        {2108}in(c, em2_2503: bitstring);
                                                                        {2109}let m2_2504: bitstring = em2_2503 in
                                                                        {2110}let (=OpenSecureChannelResponse,=Cli,Ns_2505: bitstring,ST_2506: bitstring,TTL_2507: bitstring) = m2_2504 in
                                                                        {2111}let Kcli_2508: bitstring = h((Nc_2501,Ns_2505)) in
                                                                        {2112}out(c, senc(mCli(pkCli_2214,pkSess_2498),Kcli_2508))
                                                                )
                                                                else
                                                                    {2113}let pkSess_2509: bitstring = fail-any in
                                                                    {2114}out(c, GetEndpointRequest);
                                                                    {2115}in(c, (=GetEndpointResponse,=pkSess_2509,=None,SP_2510: bitstring,UP_2511: bitstring));
                                                                    {2116}new Nc_2512: bitstring;
                                                                    {2117}let m1_2513: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2512) in
                                                                    {2118}out(c, (pkCli_2214,m1_2513));
                                                                    {2119}in(c, em2_2514: bitstring);
                                                                    {2120}let m2_2515: bitstring = em2_2514 in
                                                                    {2121}let (=OpenSecureChannelResponse,=Cli,Ns_2516: bitstring,ST_2517: bitstring,TTL_2518: bitstring) = m2_2515 in
                                                                    {2122}let Kcli_2519: bitstring = h((Nc_2512,Ns_2516)) in
                                                                    {2123}out(c, senc(mCli(pkCli_2214,pkSess_2509),Kcli_2519))
                                                        )
                                                        else
                                                            {2124}let pkSess_2520: bitstring = fail-any in
                                                            {2125}out(c, GetEndpointRequest);
                                                            {2126}in(c, (=GetEndpointResponse,=pkSess_2520,=None,SP_2521: bitstring,UP_2522: bitstring));
                                                            {2127}new Nc_2523: bitstring;
                                                            {2128}let m1_2524: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2523) in
                                                            {2129}out(c, (pkCli_2214,m1_2524));
                                                            {2130}in(c, em2_2525: bitstring);
                                                            {2131}let m2_2526: bitstring = em2_2525 in
                                                            {2132}let (=OpenSecureChannelResponse,=Cli,Ns_2527: bitstring,ST_2528: bitstring,TTL_2529: bitstring) = m2_2526 in
                                                            {2133}let Kcli_2530: bitstring = h((Nc_2523,Ns_2527)) in
                                                            {2134}out(c, senc(mCli(pkCli_2214,pkSess_2520),Kcli_2530))
                                                )
                                                else
                                                    {2135}let pkSess_2531: bitstring = fail-any in
                                                    {2136}out(c, GetEndpointRequest);
                                                    {2137}in(c, (=GetEndpointResponse,=pkSess_2531,=None,SP_2532: bitstring,UP_2533: bitstring));
                                                    {2138}new Nc_2534: bitstring;
                                                    {2139}let m1_2535: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2534) in
                                                    {2140}out(c, (pkCli_2214,m1_2535));
                                                    {2141}in(c, em2_2536: bitstring);
                                                    {2142}let m2_2537: bitstring = em2_2536 in
                                                    {2143}let (=OpenSecureChannelResponse,=Cli,Ns_2538: bitstring,ST_2539: bitstring,TTL_2540: bitstring) = m2_2537 in
                                                    {2144}let Kcli_2541: bitstring = h((Nc_2534,Ns_2538)) in
                                                    {2145}out(c, senc(mCli(pkCli_2214,pkSess_2531),Kcli_2541))
                                        )
                                        else
                                            {2146}let pkDisco_2542: bitstring = fail-any in
                                            {2147}let v_2543: bool = (Sess = A) in
                                            (
                                                {2148}if v_2543 then
                                                (
                                                    {2149}let pkSess_2544: bitstring = pub(skA) in
                                                    {2150}out(c, GetEndpointRequest);
                                                    {2151}in(c, (=GetEndpointResponse,=pkSess_2544,=None,SP_2545: bitstring,UP_2546: bitstring));
                                                    {2152}new Nc_2547: bitstring;
                                                    {2153}let m1_2548: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2547) in
                                                    {2154}out(c, (pkCli_2214,m1_2548));
                                                    {2155}in(c, em2_2549: bitstring);
                                                    {2156}let m2_2550: bitstring = em2_2549 in
                                                    {2157}let (=OpenSecureChannelResponse,=Cli,Ns_2551: bitstring,ST_2552: bitstring,TTL_2553: bitstring) = m2_2550 in
                                                    {2158}let Kcli_2554: bitstring = h((Nc_2547,Ns_2551)) in
                                                    {2159}out(c, senc(mCli(pkCli_2214,pkSess_2544),Kcli_2554))
                                                )
                                                else
                                                    {2160}let v_2555: bool = (Sess = B) in
                                                    (
                                                        {2161}if v_2555 then
                                                        (
                                                            {2162}let pkSess_2556: bitstring = pub(skB) in
                                                            {2163}out(c, GetEndpointRequest);
                                                            {2164}in(c, (=GetEndpointResponse,=pkSess_2556,=None,SP_2557: bitstring,UP_2558: bitstring));
                                                            {2165}new Nc_2559: bitstring;
                                                            {2166}let m1_2560: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2559) in
                                                            {2167}out(c, (pkCli_2214,m1_2560));
                                                            {2168}in(c, em2_2561: bitstring);
                                                            {2169}let m2_2562: bitstring = em2_2561 in
                                                            {2170}let (=OpenSecureChannelResponse,=Cli,Ns_2563: bitstring,ST_2564: bitstring,TTL_2565: bitstring) = m2_2562 in
                                                            {2171}let Kcli_2566: bitstring = h((Nc_2559,Ns_2563)) in
                                                            {2172}out(c, senc(mCli(pkCli_2214,pkSess_2556),Kcli_2566))
                                                        )
                                                        else
                                                            {2173}let v_2567: bool = (Sess = C) in
                                                            (
                                                                {2174}if v_2567 then
                                                                (
                                                                    {2175}let pkSess_2568: bitstring = pub(skC) in
                                                                    {2176}out(c, GetEndpointRequest);
                                                                    {2177}in(c, (=GetEndpointResponse,=pkSess_2568,=None,SP_2569: bitstring,UP_2570: bitstring));
                                                                    {2178}new Nc_2571: bitstring;
                                                                    {2179}let m1_2572: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2571) in
                                                                    {2180}out(c, (pkCli_2214,m1_2572));
                                                                    {2181}in(c, em2_2573: bitstring);
                                                                    {2182}let m2_2574: bitstring = em2_2573 in
                                                                    {2183}let (=OpenSecureChannelResponse,=Cli,Ns_2575: bitstring,ST_2576: bitstring,TTL_2577: bitstring) = m2_2574 in
                                                                    {2184}let Kcli_2578: bitstring = h((Nc_2571,Ns_2575)) in
                                                                    {2185}out(c, senc(mCli(pkCli_2214,pkSess_2568),Kcli_2578))
                                                                )
                                                                else
                                                                    {2186}let pkSess_2579: bitstring = pub(sk(Sess)) in
                                                                    {2187}out(c, GetEndpointRequest);
                                                                    {2188}in(c, (=GetEndpointResponse,=pkSess_2579,=None,SP_2580: bitstring,UP_2581: bitstring));
                                                                    {2189}new Nc_2582: bitstring;
                                                                    {2190}let m1_2583: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2582) in
                                                                    {2191}out(c, (pkCli_2214,m1_2583));
                                                                    {2192}in(c, em2_2584: bitstring);
                                                                    {2193}let m2_2585: bitstring = em2_2584 in
                                                                    {2194}let (=OpenSecureChannelResponse,=Cli,Ns_2586: bitstring,ST_2587: bitstring,TTL_2588: bitstring) = m2_2585 in
                                                                    {2195}let Kcli_2589: bitstring = h((Nc_2582,Ns_2586)) in
                                                                    {2196}out(c, senc(mCli(pkCli_2214,pkSess_2579),Kcli_2589))
                                                            )
                                                            else
                                                                {2197}let pkSess_2590: bitstring = fail-any in
                                                                {2198}out(c, GetEndpointRequest);
                                                                {2199}in(c, (=GetEndpointResponse,=pkSess_2590,=None,SP_2591: bitstring,UP_2592: bitstring));
                                                                {2200}new Nc_2593: bitstring;
                                                                {2201}let m1_2594: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2593) in
                                                                {2202}out(c, (pkCli_2214,m1_2594));
                                                                {2203}in(c, em2_2595: bitstring);
                                                                {2204}let m2_2596: bitstring = em2_2595 in
                                                                {2205}let (=OpenSecureChannelResponse,=Cli,Ns_2597: bitstring,ST_2598: bitstring,TTL_2599: bitstring) = m2_2596 in
                                                                {2206}let Kcli_2600: bitstring = h((Nc_2593,Ns_2597)) in
                                                                {2207}out(c, senc(mCli(pkCli_2214,pkSess_2590),Kcli_2600))
                                                    )
                                                    else
                                                        {2208}let pkSess_2601: bitstring = fail-any in
                                                        {2209}out(c, GetEndpointRequest);
                                                        {2210}in(c, (=GetEndpointResponse,=pkSess_2601,=None,SP_2602: bitstring,UP_2603: bitstring));
                                                        {2211}new Nc_2604: bitstring;
                                                        {2212}let m1_2605: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2604) in
                                                        {2213}out(c, (pkCli_2214,m1_2605));
                                                        {2214}in(c, em2_2606: bitstring);
                                                        {2215}let m2_2607: bitstring = em2_2606 in
                                                        {2216}let (=OpenSecureChannelResponse,=Cli,Ns_2608: bitstring,ST_2609: bitstring,TTL_2610: bitstring) = m2_2607 in
                                                        {2217}let Kcli_2611: bitstring = h((Nc_2604,Ns_2608)) in
                                                        {2218}out(c, senc(mCli(pkCli_2214,pkSess_2601),Kcli_2611))
                                            )
                                            else
                                                {2219}let pkSess_2612: bitstring = fail-any in
                                                {2220}out(c, GetEndpointRequest);
                                                {2221}in(c, (=GetEndpointResponse,=pkSess_2612,=None,SP_2613: bitstring,UP_2614: bitstring));
                                                {2222}new Nc_2615: bitstring;
                                                {2223}let m1_2616: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2615) in
                                                {2224}out(c, (pkCli_2214,m1_2616));
                                                {2225}in(c, em2_2617: bitstring);
                                                {2226}let m2_2618: bitstring = em2_2617 in
                                                {2227}let (=OpenSecureChannelResponse,=Cli,Ns_2619: bitstring,ST_2620: bitstring,TTL_2621: bitstring) = m2_2618 in
                                                {2228}let Kcli_2622: bitstring = h((Nc_2615,Ns_2619)) in
                                                {2229}out(c, senc(mCli(pkCli_2214,pkSess_2612),Kcli_2622))
                                )
                                else
                                    {2230}let pkDisco_2623: bitstring = fail-any in
                                    {2231}let v_2624: bool = (Sess = A) in
                                    (
                                        {2232}if v_2624 then
                                        (
                                            {2233}let pkSess_2625: bitstring = pub(skA) in
                                            {2234}out(c, GetEndpointRequest);
                                            {2235}in(c, (=GetEndpointResponse,=pkSess_2625,=None,SP_2626: bitstring,UP_2627: bitstring));
                                            {2236}new Nc_2628: bitstring;
                                            {2237}let m1_2629: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2628) in
                                            {2238}out(c, (pkCli_2214,m1_2629));
                                            {2239}in(c, em2_2630: bitstring);
                                            {2240}let m2_2631: bitstring = em2_2630 in
                                            {2241}let (=OpenSecureChannelResponse,=Cli,Ns_2632: bitstring,ST_2633: bitstring,TTL_2634: bitstring) = m2_2631 in
                                            {2242}let Kcli_2635: bitstring = h((Nc_2628,Ns_2632)) in
                                            {2243}out(c, senc(mCli(pkCli_2214,pkSess_2625),Kcli_2635))
                                        )
                                        else
                                            {2244}let v_2636: bool = (Sess = B) in
                                            (
                                                {2245}if v_2636 then
                                                (
                                                    {2246}let pkSess_2637: bitstring = pub(skB) in
                                                    {2247}out(c, GetEndpointRequest);
                                                    {2248}in(c, (=GetEndpointResponse,=pkSess_2637,=None,SP_2638: bitstring,UP_2639: bitstring));
                                                    {2249}new Nc_2640: bitstring;
                                                    {2250}let m1_2641: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2640) in
                                                    {2251}out(c, (pkCli_2214,m1_2641));
                                                    {2252}in(c, em2_2642: bitstring);
                                                    {2253}let m2_2643: bitstring = em2_2642 in
                                                    {2254}let (=OpenSecureChannelResponse,=Cli,Ns_2644: bitstring,ST_2645: bitstring,TTL_2646: bitstring) = m2_2643 in
                                                    {2255}let Kcli_2647: bitstring = h((Nc_2640,Ns_2644)) in
                                                    {2256}out(c, senc(mCli(pkCli_2214,pkSess_2637),Kcli_2647))
                                                )
                                                else
                                                    {2257}let v_2648: bool = (Sess = C) in
                                                    (
                                                        {2258}if v_2648 then
                                                        (
                                                            {2259}let pkSess_2649: bitstring = pub(skC) in
                                                            {2260}out(c, GetEndpointRequest);
                                                            {2261}in(c, (=GetEndpointResponse,=pkSess_2649,=None,SP_2650: bitstring,UP_2651: bitstring));
                                                            {2262}new Nc_2652: bitstring;
                                                            {2263}let m1_2653: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2652) in
                                                            {2264}out(c, (pkCli_2214,m1_2653));
                                                            {2265}in(c, em2_2654: bitstring);
                                                            {2266}let m2_2655: bitstring = em2_2654 in
                                                            {2267}let (=OpenSecureChannelResponse,=Cli,Ns_2656: bitstring,ST_2657: bitstring,TTL_2658: bitstring) = m2_2655 in
                                                            {2268}let Kcli_2659: bitstring = h((Nc_2652,Ns_2656)) in
                                                            {2269}out(c, senc(mCli(pkCli_2214,pkSess_2649),Kcli_2659))
                                                        )
                                                        else
                                                            {2270}let pkSess_2660: bitstring = pub(sk(Sess)) in
                                                            {2271}out(c, GetEndpointRequest);
                                                            {2272}in(c, (=GetEndpointResponse,=pkSess_2660,=None,SP_2661: bitstring,UP_2662: bitstring));
                                                            {2273}new Nc_2663: bitstring;
                                                            {2274}let m1_2664: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2663) in
                                                            {2275}out(c, (pkCli_2214,m1_2664));
                                                            {2276}in(c, em2_2665: bitstring);
                                                            {2277}let m2_2666: bitstring = em2_2665 in
                                                            {2278}let (=OpenSecureChannelResponse,=Cli,Ns_2667: bitstring,ST_2668: bitstring,TTL_2669: bitstring) = m2_2666 in
                                                            {2279}let Kcli_2670: bitstring = h((Nc_2663,Ns_2667)) in
                                                            {2280}out(c, senc(mCli(pkCli_2214,pkSess_2660),Kcli_2670))
                                                    )
                                                    else
                                                        {2281}let pkSess_2671: bitstring = fail-any in
                                                        {2282}out(c, GetEndpointRequest);
                                                        {2283}in(c, (=GetEndpointResponse,=pkSess_2671,=None,SP_2672: bitstring,UP_2673: bitstring));
                                                        {2284}new Nc_2674: bitstring;
                                                        {2285}let m1_2675: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2674) in
                                                        {2286}out(c, (pkCli_2214,m1_2675));
                                                        {2287}in(c, em2_2676: bitstring);
                                                        {2288}let m2_2677: bitstring = em2_2676 in
                                                        {2289}let (=OpenSecureChannelResponse,=Cli,Ns_2678: bitstring,ST_2679: bitstring,TTL_2680: bitstring) = m2_2677 in
                                                        {2290}let Kcli_2681: bitstring = h((Nc_2674,Ns_2678)) in
                                                        {2291}out(c, senc(mCli(pkCli_2214,pkSess_2671),Kcli_2681))
                                            )
                                            else
                                                {2292}let pkSess_2682: bitstring = fail-any in
                                                {2293}out(c, GetEndpointRequest);
                                                {2294}in(c, (=GetEndpointResponse,=pkSess_2682,=None,SP_2683: bitstring,UP_2684: bitstring));
                                                {2295}new Nc_2685: bitstring;
                                                {2296}let m1_2686: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2685) in
                                                {2297}out(c, (pkCli_2214,m1_2686));
                                                {2298}in(c, em2_2687: bitstring);
                                                {2299}let m2_2688: bitstring = em2_2687 in
                                                {2300}let (=OpenSecureChannelResponse,=Cli,Ns_2689: bitstring,ST_2690: bitstring,TTL_2691: bitstring) = m2_2688 in
                                                {2301}let Kcli_2692: bitstring = h((Nc_2685,Ns_2689)) in
                                                {2302}out(c, senc(mCli(pkCli_2214,pkSess_2682),Kcli_2692))
                                    )
                                    else
                                        {2303}let pkSess_2693: bitstring = fail-any in
                                        {2304}out(c, GetEndpointRequest);
                                        {2305}in(c, (=GetEndpointResponse,=pkSess_2693,=None,SP_2694: bitstring,UP_2695: bitstring));
                                        {2306}new Nc_2696: bitstring;
                                        {2307}let m1_2697: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2696) in
                                        {2308}out(c, (pkCli_2214,m1_2697));
                                        {2309}in(c, em2_2698: bitstring);
                                        {2310}let m2_2699: bitstring = em2_2698 in
                                        {2311}let (=OpenSecureChannelResponse,=Cli,Ns_2700: bitstring,ST_2701: bitstring,TTL_2702: bitstring) = m2_2699 in
                                        {2312}let Kcli_2703: bitstring = h((Nc_2696,Ns_2700)) in
                                        {2313}out(c, senc(mCli(pkCli_2214,pkSess_2693),Kcli_2703))
                        )
                        else
                            {2314}let pkDisco_2704: bitstring = fail-any in
                            {2315}let v_2705: bool = (Sess = A) in
                            (
                                {2316}if v_2705 then
                                (
                                    {2317}let pkSess_2706: bitstring = pub(skA) in
                                    {2318}out(c, GetEndpointRequest);
                                    {2319}in(c, (=GetEndpointResponse,=pkSess_2706,=None,SP_2707: bitstring,UP_2708: bitstring));
                                    {2320}new Nc_2709: bitstring;
                                    {2321}let m1_2710: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2709) in
                                    {2322}out(c, (pkCli_2214,m1_2710));
                                    {2323}in(c, em2_2711: bitstring);
                                    {2324}let m2_2712: bitstring = em2_2711 in
                                    {2325}let (=OpenSecureChannelResponse,=Cli,Ns_2713: bitstring,ST_2714: bitstring,TTL_2715: bitstring) = m2_2712 in
                                    {2326}let Kcli_2716: bitstring = h((Nc_2709,Ns_2713)) in
                                    {2327}out(c, senc(mCli(pkCli_2214,pkSess_2706),Kcli_2716))
                                )
                                else
                                    {2328}let v_2717: bool = (Sess = B) in
                                    (
                                        {2329}if v_2717 then
                                        (
                                            {2330}let pkSess_2718: bitstring = pub(skB) in
                                            {2331}out(c, GetEndpointRequest);
                                            {2332}in(c, (=GetEndpointResponse,=pkSess_2718,=None,SP_2719: bitstring,UP_2720: bitstring));
                                            {2333}new Nc_2721: bitstring;
                                            {2334}let m1_2722: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2721) in
                                            {2335}out(c, (pkCli_2214,m1_2722));
                                            {2336}in(c, em2_2723: bitstring);
                                            {2337}let m2_2724: bitstring = em2_2723 in
                                            {2338}let (=OpenSecureChannelResponse,=Cli,Ns_2725: bitstring,ST_2726: bitstring,TTL_2727: bitstring) = m2_2724 in
                                            {2339}let Kcli_2728: bitstring = h((Nc_2721,Ns_2725)) in
                                            {2340}out(c, senc(mCli(pkCli_2214,pkSess_2718),Kcli_2728))
                                        )
                                        else
                                            {2341}let v_2729: bool = (Sess = C) in
                                            (
                                                {2342}if v_2729 then
                                                (
                                                    {2343}let pkSess_2730: bitstring = pub(skC) in
                                                    {2344}out(c, GetEndpointRequest);
                                                    {2345}in(c, (=GetEndpointResponse,=pkSess_2730,=None,SP_2731: bitstring,UP_2732: bitstring));
                                                    {2346}new Nc_2733: bitstring;
                                                    {2347}let m1_2734: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2733) in
                                                    {2348}out(c, (pkCli_2214,m1_2734));
                                                    {2349}in(c, em2_2735: bitstring);
                                                    {2350}let m2_2736: bitstring = em2_2735 in
                                                    {2351}let (=OpenSecureChannelResponse,=Cli,Ns_2737: bitstring,ST_2738: bitstring,TTL_2739: bitstring) = m2_2736 in
                                                    {2352}let Kcli_2740: bitstring = h((Nc_2733,Ns_2737)) in
                                                    {2353}out(c, senc(mCli(pkCli_2214,pkSess_2730),Kcli_2740))
                                                )
                                                else
                                                    {2354}let pkSess_2741: bitstring = pub(sk(Sess)) in
                                                    {2355}out(c, GetEndpointRequest);
                                                    {2356}in(c, (=GetEndpointResponse,=pkSess_2741,=None,SP_2742: bitstring,UP_2743: bitstring));
                                                    {2357}new Nc_2744: bitstring;
                                                    {2358}let m1_2745: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2744) in
                                                    {2359}out(c, (pkCli_2214,m1_2745));
                                                    {2360}in(c, em2_2746: bitstring);
                                                    {2361}let m2_2747: bitstring = em2_2746 in
                                                    {2362}let (=OpenSecureChannelResponse,=Cli,Ns_2748: bitstring,ST_2749: bitstring,TTL_2750: bitstring) = m2_2747 in
                                                    {2363}let Kcli_2751: bitstring = h((Nc_2744,Ns_2748)) in
                                                    {2364}out(c, senc(mCli(pkCli_2214,pkSess_2741),Kcli_2751))
                                            )
                                            else
                                                {2365}let pkSess_2752: bitstring = fail-any in
                                                {2366}out(c, GetEndpointRequest);
                                                {2367}in(c, (=GetEndpointResponse,=pkSess_2752,=None,SP_2753: bitstring,UP_2754: bitstring));
                                                {2368}new Nc_2755: bitstring;
                                                {2369}let m1_2756: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2755) in
                                                {2370}out(c, (pkCli_2214,m1_2756));
                                                {2371}in(c, em2_2757: bitstring);
                                                {2372}let m2_2758: bitstring = em2_2757 in
                                                {2373}let (=OpenSecureChannelResponse,=Cli,Ns_2759: bitstring,ST_2760: bitstring,TTL_2761: bitstring) = m2_2758 in
                                                {2374}let Kcli_2762: bitstring = h((Nc_2755,Ns_2759)) in
                                                {2375}out(c, senc(mCli(pkCli_2214,pkSess_2752),Kcli_2762))
                                    )
                                    else
                                        {2376}let pkSess_2763: bitstring = fail-any in
                                        {2377}out(c, GetEndpointRequest);
                                        {2378}in(c, (=GetEndpointResponse,=pkSess_2763,=None,SP_2764: bitstring,UP_2765: bitstring));
                                        {2379}new Nc_2766: bitstring;
                                        {2380}let m1_2767: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2766) in
                                        {2381}out(c, (pkCli_2214,m1_2767));
                                        {2382}in(c, em2_2768: bitstring);
                                        {2383}let m2_2769: bitstring = em2_2768 in
                                        {2384}let (=OpenSecureChannelResponse,=Cli,Ns_2770: bitstring,ST_2771: bitstring,TTL_2772: bitstring) = m2_2769 in
                                        {2385}let Kcli_2773: bitstring = h((Nc_2766,Ns_2770)) in
                                        {2386}out(c, senc(mCli(pkCli_2214,pkSess_2763),Kcli_2773))
                            )
                            else
                                {2387}let pkSess_2774: bitstring = fail-any in
                                {2388}out(c, GetEndpointRequest);
                                {2389}in(c, (=GetEndpointResponse,=pkSess_2774,=None,SP_2775: bitstring,UP_2776: bitstring));
                                {2390}new Nc_2777: bitstring;
                                {2391}let m1_2778: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2214,Nc_2777) in
                                {2392}out(c, (pkCli_2214,m1_2778));
                                {2393}in(c, em2_2779: bitstring);
                                {2394}let m2_2780: bitstring = em2_2779 in
                                {2395}let (=OpenSecureChannelResponse,=Cli,Ns_2781: bitstring,ST_2782: bitstring,TTL_2783: bitstring) = m2_2780 in
                                {2396}let Kcli_2784: bitstring = h((Nc_2777,Ns_2781)) in
                                {2397}out(c, senc(mCli(pkCli_2214,pkSess_2774),Kcli_2784))
            )
            else
                {2398}let skCli_2785: bitstring = fail-any in
                {2399}let pkCli_2786: bitstring = pub(skCli_2785) in
                {2400}let v_2787: bool = (Disco = A) in
                (
                    {2401}if v_2787 then
                    (
                        {2402}let pkDisco_2788: bitstring = pub(skA) in
                        {2403}let v_2789: bool = (Sess = A) in
                        (
                            {2404}if v_2789 then
                            (
                                {2405}let pkSess_2790: bitstring = pub(skA) in
                                {2406}out(c, GetEndpointRequest);
                                {2407}in(c, (=GetEndpointResponse,=pkSess_2790,=None,SP_2791: bitstring,UP_2792: bitstring));
                                {2408}new Nc_2793: bitstring;
                                {2409}let m1_2794: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2793) in
                                {2410}out(c, (pkCli_2786,m1_2794));
                                {2411}in(c, em2_2795: bitstring);
                                {2412}let m2_2796: bitstring = em2_2795 in
                                {2413}let (=OpenSecureChannelResponse,=Cli,Ns_2797: bitstring,ST_2798: bitstring,TTL_2799: bitstring) = m2_2796 in
                                {2414}let Kcli_2800: bitstring = h((Nc_2793,Ns_2797)) in
                                {2415}out(c, senc(mCli(pkCli_2786,pkSess_2790),Kcli_2800))
                            )
                            else
                                {2416}let v_2801: bool = (Sess = B) in
                                (
                                    {2417}if v_2801 then
                                    (
                                        {2418}let pkSess_2802: bitstring = pub(skB) in
                                        {2419}out(c, GetEndpointRequest);
                                        {2420}in(c, (=GetEndpointResponse,=pkSess_2802,=None,SP_2803: bitstring,UP_2804: bitstring));
                                        {2421}new Nc_2805: bitstring;
                                        {2422}let m1_2806: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2805) in
                                        {2423}out(c, (pkCli_2786,m1_2806));
                                        {2424}in(c, em2_2807: bitstring);
                                        {2425}let m2_2808: bitstring = em2_2807 in
                                        {2426}let (=OpenSecureChannelResponse,=Cli,Ns_2809: bitstring,ST_2810: bitstring,TTL_2811: bitstring) = m2_2808 in
                                        {2427}let Kcli_2812: bitstring = h((Nc_2805,Ns_2809)) in
                                        {2428}out(c, senc(mCli(pkCli_2786,pkSess_2802),Kcli_2812))
                                    )
                                    else
                                        {2429}let v_2813: bool = (Sess = C) in
                                        (
                                            {2430}if v_2813 then
                                            (
                                                {2431}let pkSess_2814: bitstring = pub(skC) in
                                                {2432}out(c, GetEndpointRequest);
                                                {2433}in(c, (=GetEndpointResponse,=pkSess_2814,=None,SP_2815: bitstring,UP_2816: bitstring));
                                                {2434}new Nc_2817: bitstring;
                                                {2435}let m1_2818: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2817) in
                                                {2436}out(c, (pkCli_2786,m1_2818));
                                                {2437}in(c, em2_2819: bitstring);
                                                {2438}let m2_2820: bitstring = em2_2819 in
                                                {2439}let (=OpenSecureChannelResponse,=Cli,Ns_2821: bitstring,ST_2822: bitstring,TTL_2823: bitstring) = m2_2820 in
                                                {2440}let Kcli_2824: bitstring = h((Nc_2817,Ns_2821)) in
                                                {2441}out(c, senc(mCli(pkCli_2786,pkSess_2814),Kcli_2824))
                                            )
                                            else
                                                {2442}let pkSess_2825: bitstring = pub(sk(Sess)) in
                                                {2443}out(c, GetEndpointRequest);
                                                {2444}in(c, (=GetEndpointResponse,=pkSess_2825,=None,SP_2826: bitstring,UP_2827: bitstring));
                                                {2445}new Nc_2828: bitstring;
                                                {2446}let m1_2829: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2828) in
                                                {2447}out(c, (pkCli_2786,m1_2829));
                                                {2448}in(c, em2_2830: bitstring);
                                                {2449}let m2_2831: bitstring = em2_2830 in
                                                {2450}let (=OpenSecureChannelResponse,=Cli,Ns_2832: bitstring,ST_2833: bitstring,TTL_2834: bitstring) = m2_2831 in
                                                {2451}let Kcli_2835: bitstring = h((Nc_2828,Ns_2832)) in
                                                {2452}out(c, senc(mCli(pkCli_2786,pkSess_2825),Kcli_2835))
                                        )
                                        else
                                            {2453}let pkSess_2836: bitstring = fail-any in
                                            {2454}out(c, GetEndpointRequest);
                                            {2455}in(c, (=GetEndpointResponse,=pkSess_2836,=None,SP_2837: bitstring,UP_2838: bitstring));
                                            {2456}new Nc_2839: bitstring;
                                            {2457}let m1_2840: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2839) in
                                            {2458}out(c, (pkCli_2786,m1_2840));
                                            {2459}in(c, em2_2841: bitstring);
                                            {2460}let m2_2842: bitstring = em2_2841 in
                                            {2461}let (=OpenSecureChannelResponse,=Cli,Ns_2843: bitstring,ST_2844: bitstring,TTL_2845: bitstring) = m2_2842 in
                                            {2462}let Kcli_2846: bitstring = h((Nc_2839,Ns_2843)) in
                                            {2463}out(c, senc(mCli(pkCli_2786,pkSess_2836),Kcli_2846))
                                )
                                else
                                    {2464}let pkSess_2847: bitstring = fail-any in
                                    {2465}out(c, GetEndpointRequest);
                                    {2466}in(c, (=GetEndpointResponse,=pkSess_2847,=None,SP_2848: bitstring,UP_2849: bitstring));
                                    {2467}new Nc_2850: bitstring;
                                    {2468}let m1_2851: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2850) in
                                    {2469}out(c, (pkCli_2786,m1_2851));
                                    {2470}in(c, em2_2852: bitstring);
                                    {2471}let m2_2853: bitstring = em2_2852 in
                                    {2472}let (=OpenSecureChannelResponse,=Cli,Ns_2854: bitstring,ST_2855: bitstring,TTL_2856: bitstring) = m2_2853 in
                                    {2473}let Kcli_2857: bitstring = h((Nc_2850,Ns_2854)) in
                                    {2474}out(c, senc(mCli(pkCli_2786,pkSess_2847),Kcli_2857))
                        )
                        else
                            {2475}let pkSess_2858: bitstring = fail-any in
                            {2476}out(c, GetEndpointRequest);
                            {2477}in(c, (=GetEndpointResponse,=pkSess_2858,=None,SP_2859: bitstring,UP_2860: bitstring));
                            {2478}new Nc_2861: bitstring;
                            {2479}let m1_2862: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2861) in
                            {2480}out(c, (pkCli_2786,m1_2862));
                            {2481}in(c, em2_2863: bitstring);
                            {2482}let m2_2864: bitstring = em2_2863 in
                            {2483}let (=OpenSecureChannelResponse,=Cli,Ns_2865: bitstring,ST_2866: bitstring,TTL_2867: bitstring) = m2_2864 in
                            {2484}let Kcli_2868: bitstring = h((Nc_2861,Ns_2865)) in
                            {2485}out(c, senc(mCli(pkCli_2786,pkSess_2858),Kcli_2868))
                    )
                    else
                        {2486}let v_2869: bool = (Disco = B) in
                        (
                            {2487}if v_2869 then
                            (
                                {2488}let pkDisco_2870: bitstring = pub(skB) in
                                {2489}let v_2871: bool = (Sess = A) in
                                (
                                    {2490}if v_2871 then
                                    (
                                        {2491}let pkSess_2872: bitstring = pub(skA) in
                                        {2492}out(c, GetEndpointRequest);
                                        {2493}in(c, (=GetEndpointResponse,=pkSess_2872,=None,SP_2873: bitstring,UP_2874: bitstring));
                                        {2494}new Nc_2875: bitstring;
                                        {2495}let m1_2876: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2875) in
                                        {2496}out(c, (pkCli_2786,m1_2876));
                                        {2497}in(c, em2_2877: bitstring);
                                        {2498}let m2_2878: bitstring = em2_2877 in
                                        {2499}let (=OpenSecureChannelResponse,=Cli,Ns_2879: bitstring,ST_2880: bitstring,TTL_2881: bitstring) = m2_2878 in
                                        {2500}let Kcli_2882: bitstring = h((Nc_2875,Ns_2879)) in
                                        {2501}out(c, senc(mCli(pkCli_2786,pkSess_2872),Kcli_2882))
                                    )
                                    else
                                        {2502}let v_2883: bool = (Sess = B) in
                                        (
                                            {2503}if v_2883 then
                                            (
                                                {2504}let pkSess_2884: bitstring = pub(skB) in
                                                {2505}out(c, GetEndpointRequest);
                                                {2506}in(c, (=GetEndpointResponse,=pkSess_2884,=None,SP_2885: bitstring,UP_2886: bitstring));
                                                {2507}new Nc_2887: bitstring;
                                                {2508}let m1_2888: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2887) in
                                                {2509}out(c, (pkCli_2786,m1_2888));
                                                {2510}in(c, em2_2889: bitstring);
                                                {2511}let m2_2890: bitstring = em2_2889 in
                                                {2512}let (=OpenSecureChannelResponse,=Cli,Ns_2891: bitstring,ST_2892: bitstring,TTL_2893: bitstring) = m2_2890 in
                                                {2513}let Kcli_2894: bitstring = h((Nc_2887,Ns_2891)) in
                                                {2514}out(c, senc(mCli(pkCli_2786,pkSess_2884),Kcli_2894))
                                            )
                                            else
                                                {2515}let v_2895: bool = (Sess = C) in
                                                (
                                                    {2516}if v_2895 then
                                                    (
                                                        {2517}let pkSess_2896: bitstring = pub(skC) in
                                                        {2518}out(c, GetEndpointRequest);
                                                        {2519}in(c, (=GetEndpointResponse,=pkSess_2896,=None,SP_2897: bitstring,UP_2898: bitstring));
                                                        {2520}new Nc_2899: bitstring;
                                                        {2521}let m1_2900: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2899) in
                                                        {2522}out(c, (pkCli_2786,m1_2900));
                                                        {2523}in(c, em2_2901: bitstring);
                                                        {2524}let m2_2902: bitstring = em2_2901 in
                                                        {2525}let (=OpenSecureChannelResponse,=Cli,Ns_2903: bitstring,ST_2904: bitstring,TTL_2905: bitstring) = m2_2902 in
                                                        {2526}let Kcli_2906: bitstring = h((Nc_2899,Ns_2903)) in
                                                        {2527}out(c, senc(mCli(pkCli_2786,pkSess_2896),Kcli_2906))
                                                    )
                                                    else
                                                        {2528}let pkSess_2907: bitstring = pub(sk(Sess)) in
                                                        {2529}out(c, GetEndpointRequest);
                                                        {2530}in(c, (=GetEndpointResponse,=pkSess_2907,=None,SP_2908: bitstring,UP_2909: bitstring));
                                                        {2531}new Nc_2910: bitstring;
                                                        {2532}let m1_2911: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2910) in
                                                        {2533}out(c, (pkCli_2786,m1_2911));
                                                        {2534}in(c, em2_2912: bitstring);
                                                        {2535}let m2_2913: bitstring = em2_2912 in
                                                        {2536}let (=OpenSecureChannelResponse,=Cli,Ns_2914: bitstring,ST_2915: bitstring,TTL_2916: bitstring) = m2_2913 in
                                                        {2537}let Kcli_2917: bitstring = h((Nc_2910,Ns_2914)) in
                                                        {2538}out(c, senc(mCli(pkCli_2786,pkSess_2907),Kcli_2917))
                                                )
                                                else
                                                    {2539}let pkSess_2918: bitstring = fail-any in
                                                    {2540}out(c, GetEndpointRequest);
                                                    {2541}in(c, (=GetEndpointResponse,=pkSess_2918,=None,SP_2919: bitstring,UP_2920: bitstring));
                                                    {2542}new Nc_2921: bitstring;
                                                    {2543}let m1_2922: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2921) in
                                                    {2544}out(c, (pkCli_2786,m1_2922));
                                                    {2545}in(c, em2_2923: bitstring);
                                                    {2546}let m2_2924: bitstring = em2_2923 in
                                                    {2547}let (=OpenSecureChannelResponse,=Cli,Ns_2925: bitstring,ST_2926: bitstring,TTL_2927: bitstring) = m2_2924 in
                                                    {2548}let Kcli_2928: bitstring = h((Nc_2921,Ns_2925)) in
                                                    {2549}out(c, senc(mCli(pkCli_2786,pkSess_2918),Kcli_2928))
                                        )
                                        else
                                            {2550}let pkSess_2929: bitstring = fail-any in
                                            {2551}out(c, GetEndpointRequest);
                                            {2552}in(c, (=GetEndpointResponse,=pkSess_2929,=None,SP_2930: bitstring,UP_2931: bitstring));
                                            {2553}new Nc_2932: bitstring;
                                            {2554}let m1_2933: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2932) in
                                            {2555}out(c, (pkCli_2786,m1_2933));
                                            {2556}in(c, em2_2934: bitstring);
                                            {2557}let m2_2935: bitstring = em2_2934 in
                                            {2558}let (=OpenSecureChannelResponse,=Cli,Ns_2936: bitstring,ST_2937: bitstring,TTL_2938: bitstring) = m2_2935 in
                                            {2559}let Kcli_2939: bitstring = h((Nc_2932,Ns_2936)) in
                                            {2560}out(c, senc(mCli(pkCli_2786,pkSess_2929),Kcli_2939))
                                )
                                else
                                    {2561}let pkSess_2940: bitstring = fail-any in
                                    {2562}out(c, GetEndpointRequest);
                                    {2563}in(c, (=GetEndpointResponse,=pkSess_2940,=None,SP_2941: bitstring,UP_2942: bitstring));
                                    {2564}new Nc_2943: bitstring;
                                    {2565}let m1_2944: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2943) in
                                    {2566}out(c, (pkCli_2786,m1_2944));
                                    {2567}in(c, em2_2945: bitstring);
                                    {2568}let m2_2946: bitstring = em2_2945 in
                                    {2569}let (=OpenSecureChannelResponse,=Cli,Ns_2947: bitstring,ST_2948: bitstring,TTL_2949: bitstring) = m2_2946 in
                                    {2570}let Kcli_2950: bitstring = h((Nc_2943,Ns_2947)) in
                                    {2571}out(c, senc(mCli(pkCli_2786,pkSess_2940),Kcli_2950))
                            )
                            else
                                {2572}let v_2951: bool = (Disco = C) in
                                (
                                    {2573}if v_2951 then
                                    (
                                        {2574}let pkDisco_2952: bitstring = pub(skC) in
                                        {2575}let v_2953: bool = (Sess = A) in
                                        (
                                            {2576}if v_2953 then
                                            (
                                                {2577}let pkSess_2954: bitstring = pub(skA) in
                                                {2578}out(c, GetEndpointRequest);
                                                {2579}in(c, (=GetEndpointResponse,=pkSess_2954,=None,SP_2955: bitstring,UP_2956: bitstring));
                                                {2580}new Nc_2957: bitstring;
                                                {2581}let m1_2958: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2957) in
                                                {2582}out(c, (pkCli_2786,m1_2958));
                                                {2583}in(c, em2_2959: bitstring);
                                                {2584}let m2_2960: bitstring = em2_2959 in
                                                {2585}let (=OpenSecureChannelResponse,=Cli,Ns_2961: bitstring,ST_2962: bitstring,TTL_2963: bitstring) = m2_2960 in
                                                {2586}let Kcli_2964: bitstring = h((Nc_2957,Ns_2961)) in
                                                {2587}out(c, senc(mCli(pkCli_2786,pkSess_2954),Kcli_2964))
                                            )
                                            else
                                                {2588}let v_2965: bool = (Sess = B) in
                                                (
                                                    {2589}if v_2965 then
                                                    (
                                                        {2590}let pkSess_2966: bitstring = pub(skB) in
                                                        {2591}out(c, GetEndpointRequest);
                                                        {2592}in(c, (=GetEndpointResponse,=pkSess_2966,=None,SP_2967: bitstring,UP_2968: bitstring));
                                                        {2593}new Nc_2969: bitstring;
                                                        {2594}let m1_2970: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2969) in
                                                        {2595}out(c, (pkCli_2786,m1_2970));
                                                        {2596}in(c, em2_2971: bitstring);
                                                        {2597}let m2_2972: bitstring = em2_2971 in
                                                        {2598}let (=OpenSecureChannelResponse,=Cli,Ns_2973: bitstring,ST_2974: bitstring,TTL_2975: bitstring) = m2_2972 in
                                                        {2599}let Kcli_2976: bitstring = h((Nc_2969,Ns_2973)) in
                                                        {2600}out(c, senc(mCli(pkCli_2786,pkSess_2966),Kcli_2976))
                                                    )
                                                    else
                                                        {2601}let v_2977: bool = (Sess = C) in
                                                        (
                                                            {2602}if v_2977 then
                                                            (
                                                                {2603}let pkSess_2978: bitstring = pub(skC) in
                                                                {2604}out(c, GetEndpointRequest);
                                                                {2605}in(c, (=GetEndpointResponse,=pkSess_2978,=None,SP_2979: bitstring,UP_2980: bitstring));
                                                                {2606}new Nc_2981: bitstring;
                                                                {2607}let m1_2982: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2981) in
                                                                {2608}out(c, (pkCli_2786,m1_2982));
                                                                {2609}in(c, em2_2983: bitstring);
                                                                {2610}let m2_2984: bitstring = em2_2983 in
                                                                {2611}let (=OpenSecureChannelResponse,=Cli,Ns_2985: bitstring,ST_2986: bitstring,TTL_2987: bitstring) = m2_2984 in
                                                                {2612}let Kcli_2988: bitstring = h((Nc_2981,Ns_2985)) in
                                                                {2613}out(c, senc(mCli(pkCli_2786,pkSess_2978),Kcli_2988))
                                                            )
                                                            else
                                                                {2614}let pkSess_2989: bitstring = pub(sk(Sess)) in
                                                                {2615}out(c, GetEndpointRequest);
                                                                {2616}in(c, (=GetEndpointResponse,=pkSess_2989,=None,SP_2990: bitstring,UP_2991: bitstring));
                                                                {2617}new Nc_2992: bitstring;
                                                                {2618}let m1_2993: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_2992) in
                                                                {2619}out(c, (pkCli_2786,m1_2993));
                                                                {2620}in(c, em2_2994: bitstring);
                                                                {2621}let m2_2995: bitstring = em2_2994 in
                                                                {2622}let (=OpenSecureChannelResponse,=Cli,Ns_2996: bitstring,ST_2997: bitstring,TTL_2998: bitstring) = m2_2995 in
                                                                {2623}let Kcli_2999: bitstring = h((Nc_2992,Ns_2996)) in
                                                                {2624}out(c, senc(mCli(pkCli_2786,pkSess_2989),Kcli_2999))
                                                        )
                                                        else
                                                            {2625}let pkSess_3000: bitstring = fail-any in
                                                            {2626}out(c, GetEndpointRequest);
                                                            {2627}in(c, (=GetEndpointResponse,=pkSess_3000,=None,SP_3001: bitstring,UP_3002: bitstring));
                                                            {2628}new Nc_3003: bitstring;
                                                            {2629}let m1_3004: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3003) in
                                                            {2630}out(c, (pkCli_2786,m1_3004));
                                                            {2631}in(c, em2_3005: bitstring);
                                                            {2632}let m2_3006: bitstring = em2_3005 in
                                                            {2633}let (=OpenSecureChannelResponse,=Cli,Ns_3007: bitstring,ST_3008: bitstring,TTL_3009: bitstring) = m2_3006 in
                                                            {2634}let Kcli_3010: bitstring = h((Nc_3003,Ns_3007)) in
                                                            {2635}out(c, senc(mCli(pkCli_2786,pkSess_3000),Kcli_3010))
                                                )
                                                else
                                                    {2636}let pkSess_3011: bitstring = fail-any in
                                                    {2637}out(c, GetEndpointRequest);
                                                    {2638}in(c, (=GetEndpointResponse,=pkSess_3011,=None,SP_3012: bitstring,UP_3013: bitstring));
                                                    {2639}new Nc_3014: bitstring;
                                                    {2640}let m1_3015: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3014) in
                                                    {2641}out(c, (pkCli_2786,m1_3015));
                                                    {2642}in(c, em2_3016: bitstring);
                                                    {2643}let m2_3017: bitstring = em2_3016 in
                                                    {2644}let (=OpenSecureChannelResponse,=Cli,Ns_3018: bitstring,ST_3019: bitstring,TTL_3020: bitstring) = m2_3017 in
                                                    {2645}let Kcli_3021: bitstring = h((Nc_3014,Ns_3018)) in
                                                    {2646}out(c, senc(mCli(pkCli_2786,pkSess_3011),Kcli_3021))
                                        )
                                        else
                                            {2647}let pkSess_3022: bitstring = fail-any in
                                            {2648}out(c, GetEndpointRequest);
                                            {2649}in(c, (=GetEndpointResponse,=pkSess_3022,=None,SP_3023: bitstring,UP_3024: bitstring));
                                            {2650}new Nc_3025: bitstring;
                                            {2651}let m1_3026: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3025) in
                                            {2652}out(c, (pkCli_2786,m1_3026));
                                            {2653}in(c, em2_3027: bitstring);
                                            {2654}let m2_3028: bitstring = em2_3027 in
                                            {2655}let (=OpenSecureChannelResponse,=Cli,Ns_3029: bitstring,ST_3030: bitstring,TTL_3031: bitstring) = m2_3028 in
                                            {2656}let Kcli_3032: bitstring = h((Nc_3025,Ns_3029)) in
                                            {2657}out(c, senc(mCli(pkCli_2786,pkSess_3022),Kcli_3032))
                                    )
                                    else
                                        {2658}let pkDisco_3033: bitstring = pub(sk(Disco)) in
                                        {2659}let v_3034: bool = (Sess = A) in
                                        (
                                            {2660}if v_3034 then
                                            (
                                                {2661}let pkSess_3035: bitstring = pub(skA) in
                                                {2662}out(c, GetEndpointRequest);
                                                {2663}in(c, (=GetEndpointResponse,=pkSess_3035,=None,SP_3036: bitstring,UP_3037: bitstring));
                                                {2664}new Nc_3038: bitstring;
                                                {2665}let m1_3039: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3038) in
                                                {2666}out(c, (pkCli_2786,m1_3039));
                                                {2667}in(c, em2_3040: bitstring);
                                                {2668}let m2_3041: bitstring = em2_3040 in
                                                {2669}let (=OpenSecureChannelResponse,=Cli,Ns_3042: bitstring,ST_3043: bitstring,TTL_3044: bitstring) = m2_3041 in
                                                {2670}let Kcli_3045: bitstring = h((Nc_3038,Ns_3042)) in
                                                {2671}out(c, senc(mCli(pkCli_2786,pkSess_3035),Kcli_3045))
                                            )
                                            else
                                                {2672}let v_3046: bool = (Sess = B) in
                                                (
                                                    {2673}if v_3046 then
                                                    (
                                                        {2674}let pkSess_3047: bitstring = pub(skB) in
                                                        {2675}out(c, GetEndpointRequest);
                                                        {2676}in(c, (=GetEndpointResponse,=pkSess_3047,=None,SP_3048: bitstring,UP_3049: bitstring));
                                                        {2677}new Nc_3050: bitstring;
                                                        {2678}let m1_3051: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3050) in
                                                        {2679}out(c, (pkCli_2786,m1_3051));
                                                        {2680}in(c, em2_3052: bitstring);
                                                        {2681}let m2_3053: bitstring = em2_3052 in
                                                        {2682}let (=OpenSecureChannelResponse,=Cli,Ns_3054: bitstring,ST_3055: bitstring,TTL_3056: bitstring) = m2_3053 in
                                                        {2683}let Kcli_3057: bitstring = h((Nc_3050,Ns_3054)) in
                                                        {2684}out(c, senc(mCli(pkCli_2786,pkSess_3047),Kcli_3057))
                                                    )
                                                    else
                                                        {2685}let v_3058: bool = (Sess = C) in
                                                        (
                                                            {2686}if v_3058 then
                                                            (
                                                                {2687}let pkSess_3059: bitstring = pub(skC) in
                                                                {2688}out(c, GetEndpointRequest);
                                                                {2689}in(c, (=GetEndpointResponse,=pkSess_3059,=None,SP_3060: bitstring,UP_3061: bitstring));
                                                                {2690}new Nc_3062: bitstring;
                                                                {2691}let m1_3063: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3062) in
                                                                {2692}out(c, (pkCli_2786,m1_3063));
                                                                {2693}in(c, em2_3064: bitstring);
                                                                {2694}let m2_3065: bitstring = em2_3064 in
                                                                {2695}let (=OpenSecureChannelResponse,=Cli,Ns_3066: bitstring,ST_3067: bitstring,TTL_3068: bitstring) = m2_3065 in
                                                                {2696}let Kcli_3069: bitstring = h((Nc_3062,Ns_3066)) in
                                                                {2697}out(c, senc(mCli(pkCli_2786,pkSess_3059),Kcli_3069))
                                                            )
                                                            else
                                                                {2698}let pkSess_3070: bitstring = pub(sk(Sess)) in
                                                                {2699}out(c, GetEndpointRequest);
                                                                {2700}in(c, (=GetEndpointResponse,=pkSess_3070,=None,SP_3071: bitstring,UP_3072: bitstring));
                                                                {2701}new Nc_3073: bitstring;
                                                                {2702}let m1_3074: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3073) in
                                                                {2703}out(c, (pkCli_2786,m1_3074));
                                                                {2704}in(c, em2_3075: bitstring);
                                                                {2705}let m2_3076: bitstring = em2_3075 in
                                                                {2706}let (=OpenSecureChannelResponse,=Cli,Ns_3077: bitstring,ST_3078: bitstring,TTL_3079: bitstring) = m2_3076 in
                                                                {2707}let Kcli_3080: bitstring = h((Nc_3073,Ns_3077)) in
                                                                {2708}out(c, senc(mCli(pkCli_2786,pkSess_3070),Kcli_3080))
                                                        )
                                                        else
                                                            {2709}let pkSess_3081: bitstring = fail-any in
                                                            {2710}out(c, GetEndpointRequest);
                                                            {2711}in(c, (=GetEndpointResponse,=pkSess_3081,=None,SP_3082: bitstring,UP_3083: bitstring));
                                                            {2712}new Nc_3084: bitstring;
                                                            {2713}let m1_3085: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3084) in
                                                            {2714}out(c, (pkCli_2786,m1_3085));
                                                            {2715}in(c, em2_3086: bitstring);
                                                            {2716}let m2_3087: bitstring = em2_3086 in
                                                            {2717}let (=OpenSecureChannelResponse,=Cli,Ns_3088: bitstring,ST_3089: bitstring,TTL_3090: bitstring) = m2_3087 in
                                                            {2718}let Kcli_3091: bitstring = h((Nc_3084,Ns_3088)) in
                                                            {2719}out(c, senc(mCli(pkCli_2786,pkSess_3081),Kcli_3091))
                                                )
                                                else
                                                    {2720}let pkSess_3092: bitstring = fail-any in
                                                    {2721}out(c, GetEndpointRequest);
                                                    {2722}in(c, (=GetEndpointResponse,=pkSess_3092,=None,SP_3093: bitstring,UP_3094: bitstring));
                                                    {2723}new Nc_3095: bitstring;
                                                    {2724}let m1_3096: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3095) in
                                                    {2725}out(c, (pkCli_2786,m1_3096));
                                                    {2726}in(c, em2_3097: bitstring);
                                                    {2727}let m2_3098: bitstring = em2_3097 in
                                                    {2728}let (=OpenSecureChannelResponse,=Cli,Ns_3099: bitstring,ST_3100: bitstring,TTL_3101: bitstring) = m2_3098 in
                                                    {2729}let Kcli_3102: bitstring = h((Nc_3095,Ns_3099)) in
                                                    {2730}out(c, senc(mCli(pkCli_2786,pkSess_3092),Kcli_3102))
                                        )
                                        else
                                            {2731}let pkSess_3103: bitstring = fail-any in
                                            {2732}out(c, GetEndpointRequest);
                                            {2733}in(c, (=GetEndpointResponse,=pkSess_3103,=None,SP_3104: bitstring,UP_3105: bitstring));
                                            {2734}new Nc_3106: bitstring;
                                            {2735}let m1_3107: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3106) in
                                            {2736}out(c, (pkCli_2786,m1_3107));
                                            {2737}in(c, em2_3108: bitstring);
                                            {2738}let m2_3109: bitstring = em2_3108 in
                                            {2739}let (=OpenSecureChannelResponse,=Cli,Ns_3110: bitstring,ST_3111: bitstring,TTL_3112: bitstring) = m2_3109 in
                                            {2740}let Kcli_3113: bitstring = h((Nc_3106,Ns_3110)) in
                                            {2741}out(c, senc(mCli(pkCli_2786,pkSess_3103),Kcli_3113))
                                )
                                else
                                    {2742}let pkDisco_3114: bitstring = fail-any in
                                    {2743}let v_3115: bool = (Sess = A) in
                                    (
                                        {2744}if v_3115 then
                                        (
                                            {2745}let pkSess_3116: bitstring = pub(skA) in
                                            {2746}out(c, GetEndpointRequest);
                                            {2747}in(c, (=GetEndpointResponse,=pkSess_3116,=None,SP_3117: bitstring,UP_3118: bitstring));
                                            {2748}new Nc_3119: bitstring;
                                            {2749}let m1_3120: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3119) in
                                            {2750}out(c, (pkCli_2786,m1_3120));
                                            {2751}in(c, em2_3121: bitstring);
                                            {2752}let m2_3122: bitstring = em2_3121 in
                                            {2753}let (=OpenSecureChannelResponse,=Cli,Ns_3123: bitstring,ST_3124: bitstring,TTL_3125: bitstring) = m2_3122 in
                                            {2754}let Kcli_3126: bitstring = h((Nc_3119,Ns_3123)) in
                                            {2755}out(c, senc(mCli(pkCli_2786,pkSess_3116),Kcli_3126))
                                        )
                                        else
                                            {2756}let v_3127: bool = (Sess = B) in
                                            (
                                                {2757}if v_3127 then
                                                (
                                                    {2758}let pkSess_3128: bitstring = pub(skB) in
                                                    {2759}out(c, GetEndpointRequest);
                                                    {2760}in(c, (=GetEndpointResponse,=pkSess_3128,=None,SP_3129: bitstring,UP_3130: bitstring));
                                                    {2761}new Nc_3131: bitstring;
                                                    {2762}let m1_3132: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3131) in
                                                    {2763}out(c, (pkCli_2786,m1_3132));
                                                    {2764}in(c, em2_3133: bitstring);
                                                    {2765}let m2_3134: bitstring = em2_3133 in
                                                    {2766}let (=OpenSecureChannelResponse,=Cli,Ns_3135: bitstring,ST_3136: bitstring,TTL_3137: bitstring) = m2_3134 in
                                                    {2767}let Kcli_3138: bitstring = h((Nc_3131,Ns_3135)) in
                                                    {2768}out(c, senc(mCli(pkCli_2786,pkSess_3128),Kcli_3138))
                                                )
                                                else
                                                    {2769}let v_3139: bool = (Sess = C) in
                                                    (
                                                        {2770}if v_3139 then
                                                        (
                                                            {2771}let pkSess_3140: bitstring = pub(skC) in
                                                            {2772}out(c, GetEndpointRequest);
                                                            {2773}in(c, (=GetEndpointResponse,=pkSess_3140,=None,SP_3141: bitstring,UP_3142: bitstring));
                                                            {2774}new Nc_3143: bitstring;
                                                            {2775}let m1_3144: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3143) in
                                                            {2776}out(c, (pkCli_2786,m1_3144));
                                                            {2777}in(c, em2_3145: bitstring);
                                                            {2778}let m2_3146: bitstring = em2_3145 in
                                                            {2779}let (=OpenSecureChannelResponse,=Cli,Ns_3147: bitstring,ST_3148: bitstring,TTL_3149: bitstring) = m2_3146 in
                                                            {2780}let Kcli_3150: bitstring = h((Nc_3143,Ns_3147)) in
                                                            {2781}out(c, senc(mCli(pkCli_2786,pkSess_3140),Kcli_3150))
                                                        )
                                                        else
                                                            {2782}let pkSess_3151: bitstring = pub(sk(Sess)) in
                                                            {2783}out(c, GetEndpointRequest);
                                                            {2784}in(c, (=GetEndpointResponse,=pkSess_3151,=None,SP_3152: bitstring,UP_3153: bitstring));
                                                            {2785}new Nc_3154: bitstring;
                                                            {2786}let m1_3155: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3154) in
                                                            {2787}out(c, (pkCli_2786,m1_3155));
                                                            {2788}in(c, em2_3156: bitstring);
                                                            {2789}let m2_3157: bitstring = em2_3156 in
                                                            {2790}let (=OpenSecureChannelResponse,=Cli,Ns_3158: bitstring,ST_3159: bitstring,TTL_3160: bitstring) = m2_3157 in
                                                            {2791}let Kcli_3161: bitstring = h((Nc_3154,Ns_3158)) in
                                                            {2792}out(c, senc(mCli(pkCli_2786,pkSess_3151),Kcli_3161))
                                                    )
                                                    else
                                                        {2793}let pkSess_3162: bitstring = fail-any in
                                                        {2794}out(c, GetEndpointRequest);
                                                        {2795}in(c, (=GetEndpointResponse,=pkSess_3162,=None,SP_3163: bitstring,UP_3164: bitstring));
                                                        {2796}new Nc_3165: bitstring;
                                                        {2797}let m1_3166: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3165) in
                                                        {2798}out(c, (pkCli_2786,m1_3166));
                                                        {2799}in(c, em2_3167: bitstring);
                                                        {2800}let m2_3168: bitstring = em2_3167 in
                                                        {2801}let (=OpenSecureChannelResponse,=Cli,Ns_3169: bitstring,ST_3170: bitstring,TTL_3171: bitstring) = m2_3168 in
                                                        {2802}let Kcli_3172: bitstring = h((Nc_3165,Ns_3169)) in
                                                        {2803}out(c, senc(mCli(pkCli_2786,pkSess_3162),Kcli_3172))
                                            )
                                            else
                                                {2804}let pkSess_3173: bitstring = fail-any in
                                                {2805}out(c, GetEndpointRequest);
                                                {2806}in(c, (=GetEndpointResponse,=pkSess_3173,=None,SP_3174: bitstring,UP_3175: bitstring));
                                                {2807}new Nc_3176: bitstring;
                                                {2808}let m1_3177: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3176) in
                                                {2809}out(c, (pkCli_2786,m1_3177));
                                                {2810}in(c, em2_3178: bitstring);
                                                {2811}let m2_3179: bitstring = em2_3178 in
                                                {2812}let (=OpenSecureChannelResponse,=Cli,Ns_3180: bitstring,ST_3181: bitstring,TTL_3182: bitstring) = m2_3179 in
                                                {2813}let Kcli_3183: bitstring = h((Nc_3176,Ns_3180)) in
                                                {2814}out(c, senc(mCli(pkCli_2786,pkSess_3173),Kcli_3183))
                                    )
                                    else
                                        {2815}let pkSess_3184: bitstring = fail-any in
                                        {2816}out(c, GetEndpointRequest);
                                        {2817}in(c, (=GetEndpointResponse,=pkSess_3184,=None,SP_3185: bitstring,UP_3186: bitstring));
                                        {2818}new Nc_3187: bitstring;
                                        {2819}let m1_3188: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3187) in
                                        {2820}out(c, (pkCli_2786,m1_3188));
                                        {2821}in(c, em2_3189: bitstring);
                                        {2822}let m2_3190: bitstring = em2_3189 in
                                        {2823}let (=OpenSecureChannelResponse,=Cli,Ns_3191: bitstring,ST_3192: bitstring,TTL_3193: bitstring) = m2_3190 in
                                        {2824}let Kcli_3194: bitstring = h((Nc_3187,Ns_3191)) in
                                        {2825}out(c, senc(mCli(pkCli_2786,pkSess_3184),Kcli_3194))
                        )
                        else
                            {2826}let pkDisco_3195: bitstring = fail-any in
                            {2827}let v_3196: bool = (Sess = A) in
                            (
                                {2828}if v_3196 then
                                (
                                    {2829}let pkSess_3197: bitstring = pub(skA) in
                                    {2830}out(c, GetEndpointRequest);
                                    {2831}in(c, (=GetEndpointResponse,=pkSess_3197,=None,SP_3198: bitstring,UP_3199: bitstring));
                                    {2832}new Nc_3200: bitstring;
                                    {2833}let m1_3201: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3200) in
                                    {2834}out(c, (pkCli_2786,m1_3201));
                                    {2835}in(c, em2_3202: bitstring);
                                    {2836}let m2_3203: bitstring = em2_3202 in
                                    {2837}let (=OpenSecureChannelResponse,=Cli,Ns_3204: bitstring,ST_3205: bitstring,TTL_3206: bitstring) = m2_3203 in
                                    {2838}let Kcli_3207: bitstring = h((Nc_3200,Ns_3204)) in
                                    {2839}out(c, senc(mCli(pkCli_2786,pkSess_3197),Kcli_3207))
                                )
                                else
                                    {2840}let v_3208: bool = (Sess = B) in
                                    (
                                        {2841}if v_3208 then
                                        (
                                            {2842}let pkSess_3209: bitstring = pub(skB) in
                                            {2843}out(c, GetEndpointRequest);
                                            {2844}in(c, (=GetEndpointResponse,=pkSess_3209,=None,SP_3210: bitstring,UP_3211: bitstring));
                                            {2845}new Nc_3212: bitstring;
                                            {2846}let m1_3213: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3212) in
                                            {2847}out(c, (pkCli_2786,m1_3213));
                                            {2848}in(c, em2_3214: bitstring);
                                            {2849}let m2_3215: bitstring = em2_3214 in
                                            {2850}let (=OpenSecureChannelResponse,=Cli,Ns_3216: bitstring,ST_3217: bitstring,TTL_3218: bitstring) = m2_3215 in
                                            {2851}let Kcli_3219: bitstring = h((Nc_3212,Ns_3216)) in
                                            {2852}out(c, senc(mCli(pkCli_2786,pkSess_3209),Kcli_3219))
                                        )
                                        else
                                            {2853}let v_3220: bool = (Sess = C) in
                                            (
                                                {2854}if v_3220 then
                                                (
                                                    {2855}let pkSess_3221: bitstring = pub(skC) in
                                                    {2856}out(c, GetEndpointRequest);
                                                    {2857}in(c, (=GetEndpointResponse,=pkSess_3221,=None,SP_3222: bitstring,UP_3223: bitstring));
                                                    {2858}new Nc_3224: bitstring;
                                                    {2859}let m1_3225: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3224) in
                                                    {2860}out(c, (pkCli_2786,m1_3225));
                                                    {2861}in(c, em2_3226: bitstring);
                                                    {2862}let m2_3227: bitstring = em2_3226 in
                                                    {2863}let (=OpenSecureChannelResponse,=Cli,Ns_3228: bitstring,ST_3229: bitstring,TTL_3230: bitstring) = m2_3227 in
                                                    {2864}let Kcli_3231: bitstring = h((Nc_3224,Ns_3228)) in
                                                    {2865}out(c, senc(mCli(pkCli_2786,pkSess_3221),Kcli_3231))
                                                )
                                                else
                                                    {2866}let pkSess_3232: bitstring = pub(sk(Sess)) in
                                                    {2867}out(c, GetEndpointRequest);
                                                    {2868}in(c, (=GetEndpointResponse,=pkSess_3232,=None,SP_3233: bitstring,UP_3234: bitstring));
                                                    {2869}new Nc_3235: bitstring;
                                                    {2870}let m1_3236: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3235) in
                                                    {2871}out(c, (pkCli_2786,m1_3236));
                                                    {2872}in(c, em2_3237: bitstring);
                                                    {2873}let m2_3238: bitstring = em2_3237 in
                                                    {2874}let (=OpenSecureChannelResponse,=Cli,Ns_3239: bitstring,ST_3240: bitstring,TTL_3241: bitstring) = m2_3238 in
                                                    {2875}let Kcli_3242: bitstring = h((Nc_3235,Ns_3239)) in
                                                    {2876}out(c, senc(mCli(pkCli_2786,pkSess_3232),Kcli_3242))
                                            )
                                            else
                                                {2877}let pkSess_3243: bitstring = fail-any in
                                                {2878}out(c, GetEndpointRequest);
                                                {2879}in(c, (=GetEndpointResponse,=pkSess_3243,=None,SP_3244: bitstring,UP_3245: bitstring));
                                                {2880}new Nc_3246: bitstring;
                                                {2881}let m1_3247: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3246) in
                                                {2882}out(c, (pkCli_2786,m1_3247));
                                                {2883}in(c, em2_3248: bitstring);
                                                {2884}let m2_3249: bitstring = em2_3248 in
                                                {2885}let (=OpenSecureChannelResponse,=Cli,Ns_3250: bitstring,ST_3251: bitstring,TTL_3252: bitstring) = m2_3249 in
                                                {2886}let Kcli_3253: bitstring = h((Nc_3246,Ns_3250)) in
                                                {2887}out(c, senc(mCli(pkCli_2786,pkSess_3243),Kcli_3253))
                                    )
                                    else
                                        {2888}let pkSess_3254: bitstring = fail-any in
                                        {2889}out(c, GetEndpointRequest);
                                        {2890}in(c, (=GetEndpointResponse,=pkSess_3254,=None,SP_3255: bitstring,UP_3256: bitstring));
                                        {2891}new Nc_3257: bitstring;
                                        {2892}let m1_3258: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3257) in
                                        {2893}out(c, (pkCli_2786,m1_3258));
                                        {2894}in(c, em2_3259: bitstring);
                                        {2895}let m2_3260: bitstring = em2_3259 in
                                        {2896}let (=OpenSecureChannelResponse,=Cli,Ns_3261: bitstring,ST_3262: bitstring,TTL_3263: bitstring) = m2_3260 in
                                        {2897}let Kcli_3264: bitstring = h((Nc_3257,Ns_3261)) in
                                        {2898}out(c, senc(mCli(pkCli_2786,pkSess_3254),Kcli_3264))
                            )
                            else
                                {2899}let pkSess_3265: bitstring = fail-any in
                                {2900}out(c, GetEndpointRequest);
                                {2901}in(c, (=GetEndpointResponse,=pkSess_3265,=None,SP_3266: bitstring,UP_3267: bitstring));
                                {2902}new Nc_3268: bitstring;
                                {2903}let m1_3269: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3268) in
                                {2904}out(c, (pkCli_2786,m1_3269));
                                {2905}in(c, em2_3270: bitstring);
                                {2906}let m2_3271: bitstring = em2_3270 in
                                {2907}let (=OpenSecureChannelResponse,=Cli,Ns_3272: bitstring,ST_3273: bitstring,TTL_3274: bitstring) = m2_3271 in
                                {2908}let Kcli_3275: bitstring = h((Nc_3268,Ns_3272)) in
                                {2909}out(c, senc(mCli(pkCli_2786,pkSess_3265),Kcli_3275))
                )
                else
                    {2910}let pkDisco_3276: bitstring = fail-any in
                    {2911}let v_3277: bool = (Sess = A) in
                    (
                        {2912}if v_3277 then
                        (
                            {2913}let pkSess_3278: bitstring = pub(skA) in
                            {2914}out(c, GetEndpointRequest);
                            {2915}in(c, (=GetEndpointResponse,=pkSess_3278,=None,SP_3279: bitstring,UP_3280: bitstring));
                            {2916}new Nc_3281: bitstring;
                            {2917}let m1_3282: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3281) in
                            {2918}out(c, (pkCli_2786,m1_3282));
                            {2919}in(c, em2_3283: bitstring);
                            {2920}let m2_3284: bitstring = em2_3283 in
                            {2921}let (=OpenSecureChannelResponse,=Cli,Ns_3285: bitstring,ST_3286: bitstring,TTL_3287: bitstring) = m2_3284 in
                            {2922}let Kcli_3288: bitstring = h((Nc_3281,Ns_3285)) in
                            {2923}out(c, senc(mCli(pkCli_2786,pkSess_3278),Kcli_3288))
                        )
                        else
                            {2924}let v_3289: bool = (Sess = B) in
                            (
                                {2925}if v_3289 then
                                (
                                    {2926}let pkSess_3290: bitstring = pub(skB) in
                                    {2927}out(c, GetEndpointRequest);
                                    {2928}in(c, (=GetEndpointResponse,=pkSess_3290,=None,SP_3291: bitstring,UP_3292: bitstring));
                                    {2929}new Nc_3293: bitstring;
                                    {2930}let m1_3294: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3293) in
                                    {2931}out(c, (pkCli_2786,m1_3294));
                                    {2932}in(c, em2_3295: bitstring);
                                    {2933}let m2_3296: bitstring = em2_3295 in
                                    {2934}let (=OpenSecureChannelResponse,=Cli,Ns_3297: bitstring,ST_3298: bitstring,TTL_3299: bitstring) = m2_3296 in
                                    {2935}let Kcli_3300: bitstring = h((Nc_3293,Ns_3297)) in
                                    {2936}out(c, senc(mCli(pkCli_2786,pkSess_3290),Kcli_3300))
                                )
                                else
                                    {2937}let v_3301: bool = (Sess = C) in
                                    (
                                        {2938}if v_3301 then
                                        (
                                            {2939}let pkSess_3302: bitstring = pub(skC) in
                                            {2940}out(c, GetEndpointRequest);
                                            {2941}in(c, (=GetEndpointResponse,=pkSess_3302,=None,SP_3303: bitstring,UP_3304: bitstring));
                                            {2942}new Nc_3305: bitstring;
                                            {2943}let m1_3306: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3305) in
                                            {2944}out(c, (pkCli_2786,m1_3306));
                                            {2945}in(c, em2_3307: bitstring);
                                            {2946}let m2_3308: bitstring = em2_3307 in
                                            {2947}let (=OpenSecureChannelResponse,=Cli,Ns_3309: bitstring,ST_3310: bitstring,TTL_3311: bitstring) = m2_3308 in
                                            {2948}let Kcli_3312: bitstring = h((Nc_3305,Ns_3309)) in
                                            {2949}out(c, senc(mCli(pkCli_2786,pkSess_3302),Kcli_3312))
                                        )
                                        else
                                            {2950}let pkSess_3313: bitstring = pub(sk(Sess)) in
                                            {2951}out(c, GetEndpointRequest);
                                            {2952}in(c, (=GetEndpointResponse,=pkSess_3313,=None,SP_3314: bitstring,UP_3315: bitstring));
                                            {2953}new Nc_3316: bitstring;
                                            {2954}let m1_3317: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3316) in
                                            {2955}out(c, (pkCli_2786,m1_3317));
                                            {2956}in(c, em2_3318: bitstring);
                                            {2957}let m2_3319: bitstring = em2_3318 in
                                            {2958}let (=OpenSecureChannelResponse,=Cli,Ns_3320: bitstring,ST_3321: bitstring,TTL_3322: bitstring) = m2_3319 in
                                            {2959}let Kcli_3323: bitstring = h((Nc_3316,Ns_3320)) in
                                            {2960}out(c, senc(mCli(pkCli_2786,pkSess_3313),Kcli_3323))
                                    )
                                    else
                                        {2961}let pkSess_3324: bitstring = fail-any in
                                        {2962}out(c, GetEndpointRequest);
                                        {2963}in(c, (=GetEndpointResponse,=pkSess_3324,=None,SP_3325: bitstring,UP_3326: bitstring));
                                        {2964}new Nc_3327: bitstring;
                                        {2965}let m1_3328: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3327) in
                                        {2966}out(c, (pkCli_2786,m1_3328));
                                        {2967}in(c, em2_3329: bitstring);
                                        {2968}let m2_3330: bitstring = em2_3329 in
                                        {2969}let (=OpenSecureChannelResponse,=Cli,Ns_3331: bitstring,ST_3332: bitstring,TTL_3333: bitstring) = m2_3330 in
                                        {2970}let Kcli_3334: bitstring = h((Nc_3327,Ns_3331)) in
                                        {2971}out(c, senc(mCli(pkCli_2786,pkSess_3324),Kcli_3334))
                            )
                            else
                                {2972}let pkSess_3335: bitstring = fail-any in
                                {2973}out(c, GetEndpointRequest);
                                {2974}in(c, (=GetEndpointResponse,=pkSess_3335,=None,SP_3336: bitstring,UP_3337: bitstring));
                                {2975}new Nc_3338: bitstring;
                                {2976}let m1_3339: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3338) in
                                {2977}out(c, (pkCli_2786,m1_3339));
                                {2978}in(c, em2_3340: bitstring);
                                {2979}let m2_3341: bitstring = em2_3340 in
                                {2980}let (=OpenSecureChannelResponse,=Cli,Ns_3342: bitstring,ST_3343: bitstring,TTL_3344: bitstring) = m2_3341 in
                                {2981}let Kcli_3345: bitstring = h((Nc_3338,Ns_3342)) in
                                {2982}out(c, senc(mCli(pkCli_2786,pkSess_3335),Kcli_3345))
                    )
                    else
                        {2983}let pkSess_3346: bitstring = fail-any in
                        {2984}out(c, GetEndpointRequest);
                        {2985}in(c, (=GetEndpointResponse,=pkSess_3346,=None,SP_3347: bitstring,UP_3348: bitstring));
                        {2986}new Nc_3349: bitstring;
                        {2987}let m1_3350: bitstring = (OpenSecureChannelRequest,Sess,pkCli_2786,Nc_3349) in
                        {2988}out(c, (pkCli_2786,m1_3350));
                        {2989}in(c, em2_3351: bitstring);
                        {2990}let m2_3352: bitstring = em2_3351 in
                        {2991}let (=OpenSecureChannelResponse,=Cli,Ns_3353: bitstring,ST_3354: bitstring,TTL_3355: bitstring) = m2_3352 in
                        {2992}let Kcli_3356: bitstring = h((Nc_3349,Ns_3353)) in
                        {2993}out(c, senc(mCli(pkCli_2786,pkSess_3346),Kcli_3356))
    )
    else
        {2994}let skCli_3357: bitstring = fail-any in
        {2995}let pkCli_3358: bitstring = pub(skCli_3357) in
        {2996}let v_3359: bool = (Disco = A) in
        (
            {2997}if v_3359 then
            (
                {2998}let pkDisco_3360: bitstring = pub(skA) in
                {2999}let v_3361: bool = (Sess = A) in
                (
                    {3000}if v_3361 then
                    (
                        {3001}let pkSess_3362: bitstring = pub(skA) in
                        {3002}out(c, GetEndpointRequest);
                        {3003}in(c, (=GetEndpointResponse,=pkSess_3362,=None,SP_3363: bitstring,UP_3364: bitstring));
                        {3004}new Nc_3365: bitstring;
                        {3005}let m1_3366: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3365) in
                        {3006}out(c, (pkCli_3358,m1_3366));
                        {3007}in(c, em2_3367: bitstring);
                        {3008}let m2_3368: bitstring = em2_3367 in
                        {3009}let (=OpenSecureChannelResponse,=Cli,Ns_3369: bitstring,ST_3370: bitstring,TTL_3371: bitstring) = m2_3368 in
                        {3010}let Kcli_3372: bitstring = h((Nc_3365,Ns_3369)) in
                        {3011}out(c, senc(mCli(pkCli_3358,pkSess_3362),Kcli_3372))
                    )
                    else
                        {3012}let v_3373: bool = (Sess = B) in
                        (
                            {3013}if v_3373 then
                            (
                                {3014}let pkSess_3374: bitstring = pub(skB) in
                                {3015}out(c, GetEndpointRequest);
                                {3016}in(c, (=GetEndpointResponse,=pkSess_3374,=None,SP_3375: bitstring,UP_3376: bitstring));
                                {3017}new Nc_3377: bitstring;
                                {3018}let m1_3378: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3377) in
                                {3019}out(c, (pkCli_3358,m1_3378));
                                {3020}in(c, em2_3379: bitstring);
                                {3021}let m2_3380: bitstring = em2_3379 in
                                {3022}let (=OpenSecureChannelResponse,=Cli,Ns_3381: bitstring,ST_3382: bitstring,TTL_3383: bitstring) = m2_3380 in
                                {3023}let Kcli_3384: bitstring = h((Nc_3377,Ns_3381)) in
                                {3024}out(c, senc(mCli(pkCli_3358,pkSess_3374),Kcli_3384))
                            )
                            else
                                {3025}let v_3385: bool = (Sess = C) in
                                (
                                    {3026}if v_3385 then
                                    (
                                        {3027}let pkSess_3386: bitstring = pub(skC) in
                                        {3028}out(c, GetEndpointRequest);
                                        {3029}in(c, (=GetEndpointResponse,=pkSess_3386,=None,SP_3387: bitstring,UP_3388: bitstring));
                                        {3030}new Nc_3389: bitstring;
                                        {3031}let m1_3390: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3389) in
                                        {3032}out(c, (pkCli_3358,m1_3390));
                                        {3033}in(c, em2_3391: bitstring);
                                        {3034}let m2_3392: bitstring = em2_3391 in
                                        {3035}let (=OpenSecureChannelResponse,=Cli,Ns_3393: bitstring,ST_3394: bitstring,TTL_3395: bitstring) = m2_3392 in
                                        {3036}let Kcli_3396: bitstring = h((Nc_3389,Ns_3393)) in
                                        {3037}out(c, senc(mCli(pkCli_3358,pkSess_3386),Kcli_3396))
                                    )
                                    else
                                        {3038}let pkSess_3397: bitstring = pub(sk(Sess)) in
                                        {3039}out(c, GetEndpointRequest);
                                        {3040}in(c, (=GetEndpointResponse,=pkSess_3397,=None,SP_3398: bitstring,UP_3399: bitstring));
                                        {3041}new Nc_3400: bitstring;
                                        {3042}let m1_3401: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3400) in
                                        {3043}out(c, (pkCli_3358,m1_3401));
                                        {3044}in(c, em2_3402: bitstring);
                                        {3045}let m2_3403: bitstring = em2_3402 in
                                        {3046}let (=OpenSecureChannelResponse,=Cli,Ns_3404: bitstring,ST_3405: bitstring,TTL_3406: bitstring) = m2_3403 in
                                        {3047}let Kcli_3407: bitstring = h((Nc_3400,Ns_3404)) in
                                        {3048}out(c, senc(mCli(pkCli_3358,pkSess_3397),Kcli_3407))
                                )
                                else
                                    {3049}let pkSess_3408: bitstring = fail-any in
                                    {3050}out(c, GetEndpointRequest);
                                    {3051}in(c, (=GetEndpointResponse,=pkSess_3408,=None,SP_3409: bitstring,UP_3410: bitstring));
                                    {3052}new Nc_3411: bitstring;
                                    {3053}let m1_3412: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3411) in
                                    {3054}out(c, (pkCli_3358,m1_3412));
                                    {3055}in(c, em2_3413: bitstring);
                                    {3056}let m2_3414: bitstring = em2_3413 in
                                    {3057}let (=OpenSecureChannelResponse,=Cli,Ns_3415: bitstring,ST_3416: bitstring,TTL_3417: bitstring) = m2_3414 in
                                    {3058}let Kcli_3418: bitstring = h((Nc_3411,Ns_3415)) in
                                    {3059}out(c, senc(mCli(pkCli_3358,pkSess_3408),Kcli_3418))
                        )
                        else
                            {3060}let pkSess_3419: bitstring = fail-any in
                            {3061}out(c, GetEndpointRequest);
                            {3062}in(c, (=GetEndpointResponse,=pkSess_3419,=None,SP_3420: bitstring,UP_3421: bitstring));
                            {3063}new Nc_3422: bitstring;
                            {3064}let m1_3423: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3422) in
                            {3065}out(c, (pkCli_3358,m1_3423));
                            {3066}in(c, em2_3424: bitstring);
                            {3067}let m2_3425: bitstring = em2_3424 in
                            {3068}let (=OpenSecureChannelResponse,=Cli,Ns_3426: bitstring,ST_3427: bitstring,TTL_3428: bitstring) = m2_3425 in
                            {3069}let Kcli_3429: bitstring = h((Nc_3422,Ns_3426)) in
                            {3070}out(c, senc(mCli(pkCli_3358,pkSess_3419),Kcli_3429))
                )
                else
                    {3071}let pkSess_3430: bitstring = fail-any in
                    {3072}out(c, GetEndpointRequest);
                    {3073}in(c, (=GetEndpointResponse,=pkSess_3430,=None,SP_3431: bitstring,UP_3432: bitstring));
                    {3074}new Nc_3433: bitstring;
                    {3075}let m1_3434: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3433) in
                    {3076}out(c, (pkCli_3358,m1_3434));
                    {3077}in(c, em2_3435: bitstring);
                    {3078}let m2_3436: bitstring = em2_3435 in
                    {3079}let (=OpenSecureChannelResponse,=Cli,Ns_3437: bitstring,ST_3438: bitstring,TTL_3439: bitstring) = m2_3436 in
                    {3080}let Kcli_3440: bitstring = h((Nc_3433,Ns_3437)) in
                    {3081}out(c, senc(mCli(pkCli_3358,pkSess_3430),Kcli_3440))
            )
            else
                {3082}let v_3441: bool = (Disco = B) in
                (
                    {3083}if v_3441 then
                    (
                        {3084}let pkDisco_3442: bitstring = pub(skB) in
                        {3085}let v_3443: bool = (Sess = A) in
                        (
                            {3086}if v_3443 then
                            (
                                {3087}let pkSess_3444: bitstring = pub(skA) in
                                {3088}out(c, GetEndpointRequest);
                                {3089}in(c, (=GetEndpointResponse,=pkSess_3444,=None,SP_3445: bitstring,UP_3446: bitstring));
                                {3090}new Nc_3447: bitstring;
                                {3091}let m1_3448: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3447) in
                                {3092}out(c, (pkCli_3358,m1_3448));
                                {3093}in(c, em2_3449: bitstring);
                                {3094}let m2_3450: bitstring = em2_3449 in
                                {3095}let (=OpenSecureChannelResponse,=Cli,Ns_3451: bitstring,ST_3452: bitstring,TTL_3453: bitstring) = m2_3450 in
                                {3096}let Kcli_3454: bitstring = h((Nc_3447,Ns_3451)) in
                                {3097}out(c, senc(mCli(pkCli_3358,pkSess_3444),Kcli_3454))
                            )
                            else
                                {3098}let v_3455: bool = (Sess = B) in
                                (
                                    {3099}if v_3455 then
                                    (
                                        {3100}let pkSess_3456: bitstring = pub(skB) in
                                        {3101}out(c, GetEndpointRequest);
                                        {3102}in(c, (=GetEndpointResponse,=pkSess_3456,=None,SP_3457: bitstring,UP_3458: bitstring));
                                        {3103}new Nc_3459: bitstring;
                                        {3104}let m1_3460: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3459) in
                                        {3105}out(c, (pkCli_3358,m1_3460));
                                        {3106}in(c, em2_3461: bitstring);
                                        {3107}let m2_3462: bitstring = em2_3461 in
                                        {3108}let (=OpenSecureChannelResponse,=Cli,Ns_3463: bitstring,ST_3464: bitstring,TTL_3465: bitstring) = m2_3462 in
                                        {3109}let Kcli_3466: bitstring = h((Nc_3459,Ns_3463)) in
                                        {3110}out(c, senc(mCli(pkCli_3358,pkSess_3456),Kcli_3466))
                                    )
                                    else
                                        {3111}let v_3467: bool = (Sess = C) in
                                        (
                                            {3112}if v_3467 then
                                            (
                                                {3113}let pkSess_3468: bitstring = pub(skC) in
                                                {3114}out(c, GetEndpointRequest);
                                                {3115}in(c, (=GetEndpointResponse,=pkSess_3468,=None,SP_3469: bitstring,UP_3470: bitstring));
                                                {3116}new Nc_3471: bitstring;
                                                {3117}let m1_3472: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3471) in
                                                {3118}out(c, (pkCli_3358,m1_3472));
                                                {3119}in(c, em2_3473: bitstring);
                                                {3120}let m2_3474: bitstring = em2_3473 in
                                                {3121}let (=OpenSecureChannelResponse,=Cli,Ns_3475: bitstring,ST_3476: bitstring,TTL_3477: bitstring) = m2_3474 in
                                                {3122}let Kcli_3478: bitstring = h((Nc_3471,Ns_3475)) in
                                                {3123}out(c, senc(mCli(pkCli_3358,pkSess_3468),Kcli_3478))
                                            )
                                            else
                                                {3124}let pkSess_3479: bitstring = pub(sk(Sess)) in
                                                {3125}out(c, GetEndpointRequest);
                                                {3126}in(c, (=GetEndpointResponse,=pkSess_3479,=None,SP_3480: bitstring,UP_3481: bitstring));
                                                {3127}new Nc_3482: bitstring;
                                                {3128}let m1_3483: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3482) in
                                                {3129}out(c, (pkCli_3358,m1_3483));
                                                {3130}in(c, em2_3484: bitstring);
                                                {3131}let m2_3485: bitstring = em2_3484 in
                                                {3132}let (=OpenSecureChannelResponse,=Cli,Ns_3486: bitstring,ST_3487: bitstring,TTL_3488: bitstring) = m2_3485 in
                                                {3133}let Kcli_3489: bitstring = h((Nc_3482,Ns_3486)) in
                                                {3134}out(c, senc(mCli(pkCli_3358,pkSess_3479),Kcli_3489))
                                        )
                                        else
                                            {3135}let pkSess_3490: bitstring = fail-any in
                                            {3136}out(c, GetEndpointRequest);
                                            {3137}in(c, (=GetEndpointResponse,=pkSess_3490,=None,SP_3491: bitstring,UP_3492: bitstring));
                                            {3138}new Nc_3493: bitstring;
                                            {3139}let m1_3494: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3493) in
                                            {3140}out(c, (pkCli_3358,m1_3494));
                                            {3141}in(c, em2_3495: bitstring);
                                            {3142}let m2_3496: bitstring = em2_3495 in
                                            {3143}let (=OpenSecureChannelResponse,=Cli,Ns_3497: bitstring,ST_3498: bitstring,TTL_3499: bitstring) = m2_3496 in
                                            {3144}let Kcli_3500: bitstring = h((Nc_3493,Ns_3497)) in
                                            {3145}out(c, senc(mCli(pkCli_3358,pkSess_3490),Kcli_3500))
                                )
                                else
                                    {3146}let pkSess_3501: bitstring = fail-any in
                                    {3147}out(c, GetEndpointRequest);
                                    {3148}in(c, (=GetEndpointResponse,=pkSess_3501,=None,SP_3502: bitstring,UP_3503: bitstring));
                                    {3149}new Nc_3504: bitstring;
                                    {3150}let m1_3505: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3504) in
                                    {3151}out(c, (pkCli_3358,m1_3505));
                                    {3152}in(c, em2_3506: bitstring);
                                    {3153}let m2_3507: bitstring = em2_3506 in
                                    {3154}let (=OpenSecureChannelResponse,=Cli,Ns_3508: bitstring,ST_3509: bitstring,TTL_3510: bitstring) = m2_3507 in
                                    {3155}let Kcli_3511: bitstring = h((Nc_3504,Ns_3508)) in
                                    {3156}out(c, senc(mCli(pkCli_3358,pkSess_3501),Kcli_3511))
                        )
                        else
                            {3157}let pkSess_3512: bitstring = fail-any in
                            {3158}out(c, GetEndpointRequest);
                            {3159}in(c, (=GetEndpointResponse,=pkSess_3512,=None,SP_3513: bitstring,UP_3514: bitstring));
                            {3160}new Nc_3515: bitstring;
                            {3161}let m1_3516: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3515) in
                            {3162}out(c, (pkCli_3358,m1_3516));
                            {3163}in(c, em2_3517: bitstring);
                            {3164}let m2_3518: bitstring = em2_3517 in
                            {3165}let (=OpenSecureChannelResponse,=Cli,Ns_3519: bitstring,ST_3520: bitstring,TTL_3521: bitstring) = m2_3518 in
                            {3166}let Kcli_3522: bitstring = h((Nc_3515,Ns_3519)) in
                            {3167}out(c, senc(mCli(pkCli_3358,pkSess_3512),Kcli_3522))
                    )
                    else
                        {3168}let v_3523: bool = (Disco = C) in
                        (
                            {3169}if v_3523 then
                            (
                                {3170}let pkDisco_3524: bitstring = pub(skC) in
                                {3171}let v_3525: bool = (Sess = A) in
                                (
                                    {3172}if v_3525 then
                                    (
                                        {3173}let pkSess_3526: bitstring = pub(skA) in
                                        {3174}out(c, GetEndpointRequest);
                                        {3175}in(c, (=GetEndpointResponse,=pkSess_3526,=None,SP_3527: bitstring,UP_3528: bitstring));
                                        {3176}new Nc_3529: bitstring;
                                        {3177}let m1_3530: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3529) in
                                        {3178}out(c, (pkCli_3358,m1_3530));
                                        {3179}in(c, em2_3531: bitstring);
                                        {3180}let m2_3532: bitstring = em2_3531 in
                                        {3181}let (=OpenSecureChannelResponse,=Cli,Ns_3533: bitstring,ST_3534: bitstring,TTL_3535: bitstring) = m2_3532 in
                                        {3182}let Kcli_3536: bitstring = h((Nc_3529,Ns_3533)) in
                                        {3183}out(c, senc(mCli(pkCli_3358,pkSess_3526),Kcli_3536))
                                    )
                                    else
                                        {3184}let v_3537: bool = (Sess = B) in
                                        (
                                            {3185}if v_3537 then
                                            (
                                                {3186}let pkSess_3538: bitstring = pub(skB) in
                                                {3187}out(c, GetEndpointRequest);
                                                {3188}in(c, (=GetEndpointResponse,=pkSess_3538,=None,SP_3539: bitstring,UP_3540: bitstring));
                                                {3189}new Nc_3541: bitstring;
                                                {3190}let m1_3542: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3541) in
                                                {3191}out(c, (pkCli_3358,m1_3542));
                                                {3192}in(c, em2_3543: bitstring);
                                                {3193}let m2_3544: bitstring = em2_3543 in
                                                {3194}let (=OpenSecureChannelResponse,=Cli,Ns_3545: bitstring,ST_3546: bitstring,TTL_3547: bitstring) = m2_3544 in
                                                {3195}let Kcli_3548: bitstring = h((Nc_3541,Ns_3545)) in
                                                {3196}out(c, senc(mCli(pkCli_3358,pkSess_3538),Kcli_3548))
                                            )
                                            else
                                                {3197}let v_3549: bool = (Sess = C) in
                                                (
                                                    {3198}if v_3549 then
                                                    (
                                                        {3199}let pkSess_3550: bitstring = pub(skC) in
                                                        {3200}out(c, GetEndpointRequest);
                                                        {3201}in(c, (=GetEndpointResponse,=pkSess_3550,=None,SP_3551: bitstring,UP_3552: bitstring));
                                                        {3202}new Nc_3553: bitstring;
                                                        {3203}let m1_3554: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3553) in
                                                        {3204}out(c, (pkCli_3358,m1_3554));
                                                        {3205}in(c, em2_3555: bitstring);
                                                        {3206}let m2_3556: bitstring = em2_3555 in
                                                        {3207}let (=OpenSecureChannelResponse,=Cli,Ns_3557: bitstring,ST_3558: bitstring,TTL_3559: bitstring) = m2_3556 in
                                                        {3208}let Kcli_3560: bitstring = h((Nc_3553,Ns_3557)) in
                                                        {3209}out(c, senc(mCli(pkCli_3358,pkSess_3550),Kcli_3560))
                                                    )
                                                    else
                                                        {3210}let pkSess_3561: bitstring = pub(sk(Sess)) in
                                                        {3211}out(c, GetEndpointRequest);
                                                        {3212}in(c, (=GetEndpointResponse,=pkSess_3561,=None,SP_3562: bitstring,UP_3563: bitstring));
                                                        {3213}new Nc_3564: bitstring;
                                                        {3214}let m1_3565: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3564) in
                                                        {3215}out(c, (pkCli_3358,m1_3565));
                                                        {3216}in(c, em2_3566: bitstring);
                                                        {3217}let m2_3567: bitstring = em2_3566 in
                                                        {3218}let (=OpenSecureChannelResponse,=Cli,Ns_3568: bitstring,ST_3569: bitstring,TTL_3570: bitstring) = m2_3567 in
                                                        {3219}let Kcli_3571: bitstring = h((Nc_3564,Ns_3568)) in
                                                        {3220}out(c, senc(mCli(pkCli_3358,pkSess_3561),Kcli_3571))
                                                )
                                                else
                                                    {3221}let pkSess_3572: bitstring = fail-any in
                                                    {3222}out(c, GetEndpointRequest);
                                                    {3223}in(c, (=GetEndpointResponse,=pkSess_3572,=None,SP_3573: bitstring,UP_3574: bitstring));
                                                    {3224}new Nc_3575: bitstring;
                                                    {3225}let m1_3576: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3575) in
                                                    {3226}out(c, (pkCli_3358,m1_3576));
                                                    {3227}in(c, em2_3577: bitstring);
                                                    {3228}let m2_3578: bitstring = em2_3577 in
                                                    {3229}let (=OpenSecureChannelResponse,=Cli,Ns_3579: bitstring,ST_3580: bitstring,TTL_3581: bitstring) = m2_3578 in
                                                    {3230}let Kcli_3582: bitstring = h((Nc_3575,Ns_3579)) in
                                                    {3231}out(c, senc(mCli(pkCli_3358,pkSess_3572),Kcli_3582))
                                        )
                                        else
                                            {3232}let pkSess_3583: bitstring = fail-any in
                                            {3233}out(c, GetEndpointRequest);
                                            {3234}in(c, (=GetEndpointResponse,=pkSess_3583,=None,SP_3584: bitstring,UP_3585: bitstring));
                                            {3235}new Nc_3586: bitstring;
                                            {3236}let m1_3587: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3586) in
                                            {3237}out(c, (pkCli_3358,m1_3587));
                                            {3238}in(c, em2_3588: bitstring);
                                            {3239}let m2_3589: bitstring = em2_3588 in
                                            {3240}let (=OpenSecureChannelResponse,=Cli,Ns_3590: bitstring,ST_3591: bitstring,TTL_3592: bitstring) = m2_3589 in
                                            {3241}let Kcli_3593: bitstring = h((Nc_3586,Ns_3590)) in
                                            {3242}out(c, senc(mCli(pkCli_3358,pkSess_3583),Kcli_3593))
                                )
                                else
                                    {3243}let pkSess_3594: bitstring = fail-any in
                                    {3244}out(c, GetEndpointRequest);
                                    {3245}in(c, (=GetEndpointResponse,=pkSess_3594,=None,SP_3595: bitstring,UP_3596: bitstring));
                                    {3246}new Nc_3597: bitstring;
                                    {3247}let m1_3598: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3597) in
                                    {3248}out(c, (pkCli_3358,m1_3598));
                                    {3249}in(c, em2_3599: bitstring);
                                    {3250}let m2_3600: bitstring = em2_3599 in
                                    {3251}let (=OpenSecureChannelResponse,=Cli,Ns_3601: bitstring,ST_3602: bitstring,TTL_3603: bitstring) = m2_3600 in
                                    {3252}let Kcli_3604: bitstring = h((Nc_3597,Ns_3601)) in
                                    {3253}out(c, senc(mCli(pkCli_3358,pkSess_3594),Kcli_3604))
                            )
                            else
                                {3254}let pkDisco_3605: bitstring = pub(sk(Disco)) in
                                {3255}let v_3606: bool = (Sess = A) in
                                (
                                    {3256}if v_3606 then
                                    (
                                        {3257}let pkSess_3607: bitstring = pub(skA) in
                                        {3258}out(c, GetEndpointRequest);
                                        {3259}in(c, (=GetEndpointResponse,=pkSess_3607,=None,SP_3608: bitstring,UP_3609: bitstring));
                                        {3260}new Nc_3610: bitstring;
                                        {3261}let m1_3611: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3610) in
                                        {3262}out(c, (pkCli_3358,m1_3611));
                                        {3263}in(c, em2_3612: bitstring);
                                        {3264}let m2_3613: bitstring = em2_3612 in
                                        {3265}let (=OpenSecureChannelResponse,=Cli,Ns_3614: bitstring,ST_3615: bitstring,TTL_3616: bitstring) = m2_3613 in
                                        {3266}let Kcli_3617: bitstring = h((Nc_3610,Ns_3614)) in
                                        {3267}out(c, senc(mCli(pkCli_3358,pkSess_3607),Kcli_3617))
                                    )
                                    else
                                        {3268}let v_3618: bool = (Sess = B) in
                                        (
                                            {3269}if v_3618 then
                                            (
                                                {3270}let pkSess_3619: bitstring = pub(skB) in
                                                {3271}out(c, GetEndpointRequest);
                                                {3272}in(c, (=GetEndpointResponse,=pkSess_3619,=None,SP_3620: bitstring,UP_3621: bitstring));
                                                {3273}new Nc_3622: bitstring;
                                                {3274}let m1_3623: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3622) in
                                                {3275}out(c, (pkCli_3358,m1_3623));
                                                {3276}in(c, em2_3624: bitstring);
                                                {3277}let m2_3625: bitstring = em2_3624 in
                                                {3278}let (=OpenSecureChannelResponse,=Cli,Ns_3626: bitstring,ST_3627: bitstring,TTL_3628: bitstring) = m2_3625 in
                                                {3279}let Kcli_3629: bitstring = h((Nc_3622,Ns_3626)) in
                                                {3280}out(c, senc(mCli(pkCli_3358,pkSess_3619),Kcli_3629))
                                            )
                                            else
                                                {3281}let v_3630: bool = (Sess = C) in
                                                (
                                                    {3282}if v_3630 then
                                                    (
                                                        {3283}let pkSess_3631: bitstring = pub(skC) in
                                                        {3284}out(c, GetEndpointRequest);
                                                        {3285}in(c, (=GetEndpointResponse,=pkSess_3631,=None,SP_3632: bitstring,UP_3633: bitstring));
                                                        {3286}new Nc_3634: bitstring;
                                                        {3287}let m1_3635: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3634) in
                                                        {3288}out(c, (pkCli_3358,m1_3635));
                                                        {3289}in(c, em2_3636: bitstring);
                                                        {3290}let m2_3637: bitstring = em2_3636 in
                                                        {3291}let (=OpenSecureChannelResponse,=Cli,Ns_3638: bitstring,ST_3639: bitstring,TTL_3640: bitstring) = m2_3637 in
                                                        {3292}let Kcli_3641: bitstring = h((Nc_3634,Ns_3638)) in
                                                        {3293}out(c, senc(mCli(pkCli_3358,pkSess_3631),Kcli_3641))
                                                    )
                                                    else
                                                        {3294}let pkSess_3642: bitstring = pub(sk(Sess)) in
                                                        {3295}out(c, GetEndpointRequest);
                                                        {3296}in(c, (=GetEndpointResponse,=pkSess_3642,=None,SP_3643: bitstring,UP_3644: bitstring));
                                                        {3297}new Nc_3645: bitstring;
                                                        {3298}let m1_3646: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3645) in
                                                        {3299}out(c, (pkCli_3358,m1_3646));
                                                        {3300}in(c, em2_3647: bitstring);
                                                        {3301}let m2_3648: bitstring = em2_3647 in
                                                        {3302}let (=OpenSecureChannelResponse,=Cli,Ns_3649: bitstring,ST_3650: bitstring,TTL_3651: bitstring) = m2_3648 in
                                                        {3303}let Kcli_3652: bitstring = h((Nc_3645,Ns_3649)) in
                                                        {3304}out(c, senc(mCli(pkCli_3358,pkSess_3642),Kcli_3652))
                                                )
                                                else
                                                    {3305}let pkSess_3653: bitstring = fail-any in
                                                    {3306}out(c, GetEndpointRequest);
                                                    {3307}in(c, (=GetEndpointResponse,=pkSess_3653,=None,SP_3654: bitstring,UP_3655: bitstring));
                                                    {3308}new Nc_3656: bitstring;
                                                    {3309}let m1_3657: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3656) in
                                                    {3310}out(c, (pkCli_3358,m1_3657));
                                                    {3311}in(c, em2_3658: bitstring);
                                                    {3312}let m2_3659: bitstring = em2_3658 in
                                                    {3313}let (=OpenSecureChannelResponse,=Cli,Ns_3660: bitstring,ST_3661: bitstring,TTL_3662: bitstring) = m2_3659 in
                                                    {3314}let Kcli_3663: bitstring = h((Nc_3656,Ns_3660)) in
                                                    {3315}out(c, senc(mCli(pkCli_3358,pkSess_3653),Kcli_3663))
                                        )
                                        else
                                            {3316}let pkSess_3664: bitstring = fail-any in
                                            {3317}out(c, GetEndpointRequest);
                                            {3318}in(c, (=GetEndpointResponse,=pkSess_3664,=None,SP_3665: bitstring,UP_3666: bitstring));
                                            {3319}new Nc_3667: bitstring;
                                            {3320}let m1_3668: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3667) in
                                            {3321}out(c, (pkCli_3358,m1_3668));
                                            {3322}in(c, em2_3669: bitstring);
                                            {3323}let m2_3670: bitstring = em2_3669 in
                                            {3324}let (=OpenSecureChannelResponse,=Cli,Ns_3671: bitstring,ST_3672: bitstring,TTL_3673: bitstring) = m2_3670 in
                                            {3325}let Kcli_3674: bitstring = h((Nc_3667,Ns_3671)) in
                                            {3326}out(c, senc(mCli(pkCli_3358,pkSess_3664),Kcli_3674))
                                )
                                else
                                    {3327}let pkSess_3675: bitstring = fail-any in
                                    {3328}out(c, GetEndpointRequest);
                                    {3329}in(c, (=GetEndpointResponse,=pkSess_3675,=None,SP_3676: bitstring,UP_3677: bitstring));
                                    {3330}new Nc_3678: bitstring;
                                    {3331}let m1_3679: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3678) in
                                    {3332}out(c, (pkCli_3358,m1_3679));
                                    {3333}in(c, em2_3680: bitstring);
                                    {3334}let m2_3681: bitstring = em2_3680 in
                                    {3335}let (=OpenSecureChannelResponse,=Cli,Ns_3682: bitstring,ST_3683: bitstring,TTL_3684: bitstring) = m2_3681 in
                                    {3336}let Kcli_3685: bitstring = h((Nc_3678,Ns_3682)) in
                                    {3337}out(c, senc(mCli(pkCli_3358,pkSess_3675),Kcli_3685))
                        )
                        else
                            {3338}let pkDisco_3686: bitstring = fail-any in
                            {3339}let v_3687: bool = (Sess = A) in
                            (
                                {3340}if v_3687 then
                                (
                                    {3341}let pkSess_3688: bitstring = pub(skA) in
                                    {3342}out(c, GetEndpointRequest);
                                    {3343}in(c, (=GetEndpointResponse,=pkSess_3688,=None,SP_3689: bitstring,UP_3690: bitstring));
                                    {3344}new Nc_3691: bitstring;
                                    {3345}let m1_3692: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3691) in
                                    {3346}out(c, (pkCli_3358,m1_3692));
                                    {3347}in(c, em2_3693: bitstring);
                                    {3348}let m2_3694: bitstring = em2_3693 in
                                    {3349}let (=OpenSecureChannelResponse,=Cli,Ns_3695: bitstring,ST_3696: bitstring,TTL_3697: bitstring) = m2_3694 in
                                    {3350}let Kcli_3698: bitstring = h((Nc_3691,Ns_3695)) in
                                    {3351}out(c, senc(mCli(pkCli_3358,pkSess_3688),Kcli_3698))
                                )
                                else
                                    {3352}let v_3699: bool = (Sess = B) in
                                    (
                                        {3353}if v_3699 then
                                        (
                                            {3354}let pkSess_3700: bitstring = pub(skB) in
                                            {3355}out(c, GetEndpointRequest);
                                            {3356}in(c, (=GetEndpointResponse,=pkSess_3700,=None,SP_3701: bitstring,UP_3702: bitstring));
                                            {3357}new Nc_3703: bitstring;
                                            {3358}let m1_3704: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3703) in
                                            {3359}out(c, (pkCli_3358,m1_3704));
                                            {3360}in(c, em2_3705: bitstring);
                                            {3361}let m2_3706: bitstring = em2_3705 in
                                            {3362}let (=OpenSecureChannelResponse,=Cli,Ns_3707: bitstring,ST_3708: bitstring,TTL_3709: bitstring) = m2_3706 in
                                            {3363}let Kcli_3710: bitstring = h((Nc_3703,Ns_3707)) in
                                            {3364}out(c, senc(mCli(pkCli_3358,pkSess_3700),Kcli_3710))
                                        )
                                        else
                                            {3365}let v_3711: bool = (Sess = C) in
                                            (
                                                {3366}if v_3711 then
                                                (
                                                    {3367}let pkSess_3712: bitstring = pub(skC) in
                                                    {3368}out(c, GetEndpointRequest);
                                                    {3369}in(c, (=GetEndpointResponse,=pkSess_3712,=None,SP_3713: bitstring,UP_3714: bitstring));
                                                    {3370}new Nc_3715: bitstring;
                                                    {3371}let m1_3716: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3715) in
                                                    {3372}out(c, (pkCli_3358,m1_3716));
                                                    {3373}in(c, em2_3717: bitstring);
                                                    {3374}let m2_3718: bitstring = em2_3717 in
                                                    {3375}let (=OpenSecureChannelResponse,=Cli,Ns_3719: bitstring,ST_3720: bitstring,TTL_3721: bitstring) = m2_3718 in
                                                    {3376}let Kcli_3722: bitstring = h((Nc_3715,Ns_3719)) in
                                                    {3377}out(c, senc(mCli(pkCli_3358,pkSess_3712),Kcli_3722))
                                                )
                                                else
                                                    {3378}let pkSess_3723: bitstring = pub(sk(Sess)) in
                                                    {3379}out(c, GetEndpointRequest);
                                                    {3380}in(c, (=GetEndpointResponse,=pkSess_3723,=None,SP_3724: bitstring,UP_3725: bitstring));
                                                    {3381}new Nc_3726: bitstring;
                                                    {3382}let m1_3727: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3726) in
                                                    {3383}out(c, (pkCli_3358,m1_3727));
                                                    {3384}in(c, em2_3728: bitstring);
                                                    {3385}let m2_3729: bitstring = em2_3728 in
                                                    {3386}let (=OpenSecureChannelResponse,=Cli,Ns_3730: bitstring,ST_3731: bitstring,TTL_3732: bitstring) = m2_3729 in
                                                    {3387}let Kcli_3733: bitstring = h((Nc_3726,Ns_3730)) in
                                                    {3388}out(c, senc(mCli(pkCli_3358,pkSess_3723),Kcli_3733))
                                            )
                                            else
                                                {3389}let pkSess_3734: bitstring = fail-any in
                                                {3390}out(c, GetEndpointRequest);
                                                {3391}in(c, (=GetEndpointResponse,=pkSess_3734,=None,SP_3735: bitstring,UP_3736: bitstring));
                                                {3392}new Nc_3737: bitstring;
                                                {3393}let m1_3738: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3737) in
                                                {3394}out(c, (pkCli_3358,m1_3738));
                                                {3395}in(c, em2_3739: bitstring);
                                                {3396}let m2_3740: bitstring = em2_3739 in
                                                {3397}let (=OpenSecureChannelResponse,=Cli,Ns_3741: bitstring,ST_3742: bitstring,TTL_3743: bitstring) = m2_3740 in
                                                {3398}let Kcli_3744: bitstring = h((Nc_3737,Ns_3741)) in
                                                {3399}out(c, senc(mCli(pkCli_3358,pkSess_3734),Kcli_3744))
                                    )
                                    else
                                        {3400}let pkSess_3745: bitstring = fail-any in
                                        {3401}out(c, GetEndpointRequest);
                                        {3402}in(c, (=GetEndpointResponse,=pkSess_3745,=None,SP_3746: bitstring,UP_3747: bitstring));
                                        {3403}new Nc_3748: bitstring;
                                        {3404}let m1_3749: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3748) in
                                        {3405}out(c, (pkCli_3358,m1_3749));
                                        {3406}in(c, em2_3750: bitstring);
                                        {3407}let m2_3751: bitstring = em2_3750 in
                                        {3408}let (=OpenSecureChannelResponse,=Cli,Ns_3752: bitstring,ST_3753: bitstring,TTL_3754: bitstring) = m2_3751 in
                                        {3409}let Kcli_3755: bitstring = h((Nc_3748,Ns_3752)) in
                                        {3410}out(c, senc(mCli(pkCli_3358,pkSess_3745),Kcli_3755))
                            )
                            else
                                {3411}let pkSess_3756: bitstring = fail-any in
                                {3412}out(c, GetEndpointRequest);
                                {3413}in(c, (=GetEndpointResponse,=pkSess_3756,=None,SP_3757: bitstring,UP_3758: bitstring));
                                {3414}new Nc_3759: bitstring;
                                {3415}let m1_3760: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3759) in
                                {3416}out(c, (pkCli_3358,m1_3760));
                                {3417}in(c, em2_3761: bitstring);
                                {3418}let m2_3762: bitstring = em2_3761 in
                                {3419}let (=OpenSecureChannelResponse,=Cli,Ns_3763: bitstring,ST_3764: bitstring,TTL_3765: bitstring) = m2_3762 in
                                {3420}let Kcli_3766: bitstring = h((Nc_3759,Ns_3763)) in
                                {3421}out(c, senc(mCli(pkCli_3358,pkSess_3756),Kcli_3766))
                )
                else
                    {3422}let pkDisco_3767: bitstring = fail-any in
                    {3423}let v_3768: bool = (Sess = A) in
                    (
                        {3424}if v_3768 then
                        (
                            {3425}let pkSess_3769: bitstring = pub(skA) in
                            {3426}out(c, GetEndpointRequest);
                            {3427}in(c, (=GetEndpointResponse,=pkSess_3769,=None,SP_3770: bitstring,UP_3771: bitstring));
                            {3428}new Nc_3772: bitstring;
                            {3429}let m1_3773: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3772) in
                            {3430}out(c, (pkCli_3358,m1_3773));
                            {3431}in(c, em2_3774: bitstring);
                            {3432}let m2_3775: bitstring = em2_3774 in
                            {3433}let (=OpenSecureChannelResponse,=Cli,Ns_3776: bitstring,ST_3777: bitstring,TTL_3778: bitstring) = m2_3775 in
                            {3434}let Kcli_3779: bitstring = h((Nc_3772,Ns_3776)) in
                            {3435}out(c, senc(mCli(pkCli_3358,pkSess_3769),Kcli_3779))
                        )
                        else
                            {3436}let v_3780: bool = (Sess = B) in
                            (
                                {3437}if v_3780 then
                                (
                                    {3438}let pkSess_3781: bitstring = pub(skB) in
                                    {3439}out(c, GetEndpointRequest);
                                    {3440}in(c, (=GetEndpointResponse,=pkSess_3781,=None,SP_3782: bitstring,UP_3783: bitstring));
                                    {3441}new Nc_3784: bitstring;
                                    {3442}let m1_3785: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3784) in
                                    {3443}out(c, (pkCli_3358,m1_3785));
                                    {3444}in(c, em2_3786: bitstring);
                                    {3445}let m2_3787: bitstring = em2_3786 in
                                    {3446}let (=OpenSecureChannelResponse,=Cli,Ns_3788: bitstring,ST_3789: bitstring,TTL_3790: bitstring) = m2_3787 in
                                    {3447}let Kcli_3791: bitstring = h((Nc_3784,Ns_3788)) in
                                    {3448}out(c, senc(mCli(pkCli_3358,pkSess_3781),Kcli_3791))
                                )
                                else
                                    {3449}let v_3792: bool = (Sess = C) in
                                    (
                                        {3450}if v_3792 then
                                        (
                                            {3451}let pkSess_3793: bitstring = pub(skC) in
                                            {3452}out(c, GetEndpointRequest);
                                            {3453}in(c, (=GetEndpointResponse,=pkSess_3793,=None,SP_3794: bitstring,UP_3795: bitstring));
                                            {3454}new Nc_3796: bitstring;
                                            {3455}let m1_3797: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3796) in
                                            {3456}out(c, (pkCli_3358,m1_3797));
                                            {3457}in(c, em2_3798: bitstring);
                                            {3458}let m2_3799: bitstring = em2_3798 in
                                            {3459}let (=OpenSecureChannelResponse,=Cli,Ns_3800: bitstring,ST_3801: bitstring,TTL_3802: bitstring) = m2_3799 in
                                            {3460}let Kcli_3803: bitstring = h((Nc_3796,Ns_3800)) in
                                            {3461}out(c, senc(mCli(pkCli_3358,pkSess_3793),Kcli_3803))
                                        )
                                        else
                                            {3462}let pkSess_3804: bitstring = pub(sk(Sess)) in
                                            {3463}out(c, GetEndpointRequest);
                                            {3464}in(c, (=GetEndpointResponse,=pkSess_3804,=None,SP_3805: bitstring,UP_3806: bitstring));
                                            {3465}new Nc_3807: bitstring;
                                            {3466}let m1_3808: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3807) in
                                            {3467}out(c, (pkCli_3358,m1_3808));
                                            {3468}in(c, em2_3809: bitstring);
                                            {3469}let m2_3810: bitstring = em2_3809 in
                                            {3470}let (=OpenSecureChannelResponse,=Cli,Ns_3811: bitstring,ST_3812: bitstring,TTL_3813: bitstring) = m2_3810 in
                                            {3471}let Kcli_3814: bitstring = h((Nc_3807,Ns_3811)) in
                                            {3472}out(c, senc(mCli(pkCli_3358,pkSess_3804),Kcli_3814))
                                    )
                                    else
                                        {3473}let pkSess_3815: bitstring = fail-any in
                                        {3474}out(c, GetEndpointRequest);
                                        {3475}in(c, (=GetEndpointResponse,=pkSess_3815,=None,SP_3816: bitstring,UP_3817: bitstring));
                                        {3476}new Nc_3818: bitstring;
                                        {3477}let m1_3819: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3818) in
                                        {3478}out(c, (pkCli_3358,m1_3819));
                                        {3479}in(c, em2_3820: bitstring);
                                        {3480}let m2_3821: bitstring = em2_3820 in
                                        {3481}let (=OpenSecureChannelResponse,=Cli,Ns_3822: bitstring,ST_3823: bitstring,TTL_3824: bitstring) = m2_3821 in
                                        {3482}let Kcli_3825: bitstring = h((Nc_3818,Ns_3822)) in
                                        {3483}out(c, senc(mCli(pkCli_3358,pkSess_3815),Kcli_3825))
                            )
                            else
                                {3484}let pkSess_3826: bitstring = fail-any in
                                {3485}out(c, GetEndpointRequest);
                                {3486}in(c, (=GetEndpointResponse,=pkSess_3826,=None,SP_3827: bitstring,UP_3828: bitstring));
                                {3487}new Nc_3829: bitstring;
                                {3488}let m1_3830: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3829) in
                                {3489}out(c, (pkCli_3358,m1_3830));
                                {3490}in(c, em2_3831: bitstring);
                                {3491}let m2_3832: bitstring = em2_3831 in
                                {3492}let (=OpenSecureChannelResponse,=Cli,Ns_3833: bitstring,ST_3834: bitstring,TTL_3835: bitstring) = m2_3832 in
                                {3493}let Kcli_3836: bitstring = h((Nc_3829,Ns_3833)) in
                                {3494}out(c, senc(mCli(pkCli_3358,pkSess_3826),Kcli_3836))
                    )
                    else
                        {3495}let pkSess_3837: bitstring = fail-any in
                        {3496}out(c, GetEndpointRequest);
                        {3497}in(c, (=GetEndpointResponse,=pkSess_3837,=None,SP_3838: bitstring,UP_3839: bitstring));
                        {3498}new Nc_3840: bitstring;
                        {3499}let m1_3841: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3840) in
                        {3500}out(c, (pkCli_3358,m1_3841));
                        {3501}in(c, em2_3842: bitstring);
                        {3502}let m2_3843: bitstring = em2_3842 in
                        {3503}let (=OpenSecureChannelResponse,=Cli,Ns_3844: bitstring,ST_3845: bitstring,TTL_3846: bitstring) = m2_3843 in
                        {3504}let Kcli_3847: bitstring = h((Nc_3840,Ns_3844)) in
                        {3505}out(c, senc(mCli(pkCli_3358,pkSess_3837),Kcli_3847))
        )
        else
            {3506}let pkDisco_3848: bitstring = fail-any in
            {3507}let v_3849: bool = (Sess = A) in
            (
                {3508}if v_3849 then
                (
                    {3509}let pkSess_3850: bitstring = pub(skA) in
                    {3510}out(c, GetEndpointRequest);
                    {3511}in(c, (=GetEndpointResponse,=pkSess_3850,=None,SP_3851: bitstring,UP_3852: bitstring));
                    {3512}new Nc_3853: bitstring;
                    {3513}let m1_3854: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3853) in
                    {3514}out(c, (pkCli_3358,m1_3854));
                    {3515}in(c, em2_3855: bitstring);
                    {3516}let m2_3856: bitstring = em2_3855 in
                    {3517}let (=OpenSecureChannelResponse,=Cli,Ns_3857: bitstring,ST_3858: bitstring,TTL_3859: bitstring) = m2_3856 in
                    {3518}let Kcli_3860: bitstring = h((Nc_3853,Ns_3857)) in
                    {3519}out(c, senc(mCli(pkCli_3358,pkSess_3850),Kcli_3860))
                )
                else
                    {3520}let v_3861: bool = (Sess = B) in
                    (
                        {3521}if v_3861 then
                        (
                            {3522}let pkSess_3862: bitstring = pub(skB) in
                            {3523}out(c, GetEndpointRequest);
                            {3524}in(c, (=GetEndpointResponse,=pkSess_3862,=None,SP_3863: bitstring,UP_3864: bitstring));
                            {3525}new Nc_3865: bitstring;
                            {3526}let m1_3866: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3865) in
                            {3527}out(c, (pkCli_3358,m1_3866));
                            {3528}in(c, em2_3867: bitstring);
                            {3529}let m2_3868: bitstring = em2_3867 in
                            {3530}let (=OpenSecureChannelResponse,=Cli,Ns_3869: bitstring,ST_3870: bitstring,TTL_3871: bitstring) = m2_3868 in
                            {3531}let Kcli_3872: bitstring = h((Nc_3865,Ns_3869)) in
                            {3532}out(c, senc(mCli(pkCli_3358,pkSess_3862),Kcli_3872))
                        )
                        else
                            {3533}let v_3873: bool = (Sess = C) in
                            (
                                {3534}if v_3873 then
                                (
                                    {3535}let pkSess_3874: bitstring = pub(skC) in
                                    {3536}out(c, GetEndpointRequest);
                                    {3537}in(c, (=GetEndpointResponse,=pkSess_3874,=None,SP_3875: bitstring,UP_3876: bitstring));
                                    {3538}new Nc_3877: bitstring;
                                    {3539}let m1_3878: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3877) in
                                    {3540}out(c, (pkCli_3358,m1_3878));
                                    {3541}in(c, em2_3879: bitstring);
                                    {3542}let m2_3880: bitstring = em2_3879 in
                                    {3543}let (=OpenSecureChannelResponse,=Cli,Ns_3881: bitstring,ST_3882: bitstring,TTL_3883: bitstring) = m2_3880 in
                                    {3544}let Kcli_3884: bitstring = h((Nc_3877,Ns_3881)) in
                                    {3545}out(c, senc(mCli(pkCli_3358,pkSess_3874),Kcli_3884))
                                )
                                else
                                    {3546}let pkSess_3885: bitstring = pub(sk(Sess)) in
                                    {3547}out(c, GetEndpointRequest);
                                    {3548}in(c, (=GetEndpointResponse,=pkSess_3885,=None,SP_3886: bitstring,UP_3887: bitstring));
                                    {3549}new Nc_3888: bitstring;
                                    {3550}let m1_3889: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3888) in
                                    {3551}out(c, (pkCli_3358,m1_3889));
                                    {3552}in(c, em2_3890: bitstring);
                                    {3553}let m2_3891: bitstring = em2_3890 in
                                    {3554}let (=OpenSecureChannelResponse,=Cli,Ns_3892: bitstring,ST_3893: bitstring,TTL_3894: bitstring) = m2_3891 in
                                    {3555}let Kcli_3895: bitstring = h((Nc_3888,Ns_3892)) in
                                    {3556}out(c, senc(mCli(pkCli_3358,pkSess_3885),Kcli_3895))
                            )
                            else
                                {3557}let pkSess_3896: bitstring = fail-any in
                                {3558}out(c, GetEndpointRequest);
                                {3559}in(c, (=GetEndpointResponse,=pkSess_3896,=None,SP_3897: bitstring,UP_3898: bitstring));
                                {3560}new Nc_3899: bitstring;
                                {3561}let m1_3900: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3899) in
                                {3562}out(c, (pkCli_3358,m1_3900));
                                {3563}in(c, em2_3901: bitstring);
                                {3564}let m2_3902: bitstring = em2_3901 in
                                {3565}let (=OpenSecureChannelResponse,=Cli,Ns_3903: bitstring,ST_3904: bitstring,TTL_3905: bitstring) = m2_3902 in
                                {3566}let Kcli_3906: bitstring = h((Nc_3899,Ns_3903)) in
                                {3567}out(c, senc(mCli(pkCli_3358,pkSess_3896),Kcli_3906))
                    )
                    else
                        {3568}let pkSess_3907: bitstring = fail-any in
                        {3569}out(c, GetEndpointRequest);
                        {3570}in(c, (=GetEndpointResponse,=pkSess_3907,=None,SP_3908: bitstring,UP_3909: bitstring));
                        {3571}new Nc_3910: bitstring;
                        {3572}let m1_3911: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3910) in
                        {3573}out(c, (pkCli_3358,m1_3911));
                        {3574}in(c, em2_3912: bitstring);
                        {3575}let m2_3913: bitstring = em2_3912 in
                        {3576}let (=OpenSecureChannelResponse,=Cli,Ns_3914: bitstring,ST_3915: bitstring,TTL_3916: bitstring) = m2_3913 in
                        {3577}let Kcli_3917: bitstring = h((Nc_3910,Ns_3914)) in
                        {3578}out(c, senc(mCli(pkCli_3358,pkSess_3907),Kcli_3917))
            )
            else
                {3579}let pkSess_3918: bitstring = fail-any in
                {3580}out(c, GetEndpointRequest);
                {3581}in(c, (=GetEndpointResponse,=pkSess_3918,=None,SP_3919: bitstring,UP_3920: bitstring));
                {3582}new Nc_3921: bitstring;
                {3583}let m1_3922: bitstring = (OpenSecureChannelRequest,Sess,pkCli_3358,Nc_3921) in
                {3584}out(c, (pkCli_3358,m1_3922));
                {3585}in(c, em2_3923: bitstring);
                {3586}let m2_3924: bitstring = em2_3923 in
                {3587}let (=OpenSecureChannelResponse,=Cli,Ns_3925: bitstring,ST_3926: bitstring,TTL_3927: bitstring) = m2_3924 in
                {3588}let Kcli_3928: bitstring = h((Nc_3921,Ns_3925)) in
                {3589}out(c, senc(mCli(pkCli_3358,pkSess_3918),Kcli_3928))
) | (
    {3590}!
    {3591}in(c, (Cli_3929: host,Disco_3930: host,Sess_3931: host));
    {3592}let v_3932: bool = (Disco_3930 = A) in
    (
        {3593}if v_3932 then
        (
            {3594}let skDisco: bitstring = skA in
            {3595}let pkDisco_3933: bitstring = pub(skDisco) in
            {3596}let v_3934: bool = (Cli_3929 = A) in
            (
                {3597}if v_3934 then
                (
                    {3598}let pkCli_3935: bitstring = pub(skA) in
                    {3599}let v_3936: bool = (Sess_3931 = A) in
                    (
                        {3600}if v_3936 then
                        (
                            {3601}let pkSess_3937: bitstring = pub(skA) in
                            {3602}in(c, =GetEndpointRequest);
                            {3603}new SP_3938: bitstring;
                            {3604}new UP_3939: bitstring;
                            {3605}out(c, (GetEndpointResponse,pkSess_3937,None,SP_3938,UP_3939))
                        )
                        else
                            {3606}let v_3940: bool = (Sess_3931 = B) in
                            (
                                {3607}if v_3940 then
                                (
                                    {3608}let pkSess_3941: bitstring = pub(skB) in
                                    {3609}in(c, =GetEndpointRequest);
                                    {3610}new SP_3942: bitstring;
                                    {3611}new UP_3943: bitstring;
                                    {3612}out(c, (GetEndpointResponse,pkSess_3941,None,SP_3942,UP_3943))
                                )
                                else
                                    {3613}let v_3944: bool = (Sess_3931 = C) in
                                    (
                                        {3614}if v_3944 then
                                        (
                                            {3615}let pkSess_3945: bitstring = pub(skC) in
                                            {3616}in(c, =GetEndpointRequest);
                                            {3617}new SP_3946: bitstring;
                                            {3618}new UP_3947: bitstring;
                                            {3619}out(c, (GetEndpointResponse,pkSess_3945,None,SP_3946,UP_3947))
                                        )
                                        else
                                            {3620}let pkSess_3948: bitstring = pub(sk(Sess_3931)) in
                                            {3621}in(c, =GetEndpointRequest);
                                            {3622}new SP_3949: bitstring;
                                            {3623}new UP_3950: bitstring;
                                            {3624}out(c, (GetEndpointResponse,pkSess_3948,None,SP_3949,UP_3950))
                                    )
                                    else
                                        {3625}let pkSess_3951: bitstring = fail-any in
                                        {3626}in(c, =GetEndpointRequest);
                                        {3627}new SP_3952: bitstring;
                                        {3628}new UP_3953: bitstring;
                                        {3629}out(c, (GetEndpointResponse,pkSess_3951,None,SP_3952,UP_3953))
                            )
                            else
                                {3630}let pkSess_3954: bitstring = fail-any in
                                {3631}in(c, =GetEndpointRequest);
                                {3632}new SP_3955: bitstring;
                                {3633}new UP_3956: bitstring;
                                {3634}out(c, (GetEndpointResponse,pkSess_3954,None,SP_3955,UP_3956))
                    )
                    else
                        {3635}let pkSess_3957: bitstring = fail-any in
                        {3636}in(c, =GetEndpointRequest);
                        {3637}new SP_3958: bitstring;
                        {3638}new UP_3959: bitstring;
                        {3639}out(c, (GetEndpointResponse,pkSess_3957,None,SP_3958,UP_3959))
                )
                else
                    {3640}let v_3960: bool = (Cli_3929 = B) in
                    (
                        {3641}if v_3960 then
                        (
                            {3642}let pkCli_3961: bitstring = pub(skB) in
                            {3643}let v_3962: bool = (Sess_3931 = A) in
                            (
                                {3644}if v_3962 then
                                (
                                    {3645}let pkSess_3963: bitstring = pub(skA) in
                                    {3646}in(c, =GetEndpointRequest);
                                    {3647}new SP_3964: bitstring;
                                    {3648}new UP_3965: bitstring;
                                    {3649}out(c, (GetEndpointResponse,pkSess_3963,None,SP_3964,UP_3965))
                                )
                                else
                                    {3650}let v_3966: bool = (Sess_3931 = B) in
                                    (
                                        {3651}if v_3966 then
                                        (
                                            {3652}let pkSess_3967: bitstring = pub(skB) in
                                            {3653}in(c, =GetEndpointRequest);
                                            {3654}new SP_3968: bitstring;
                                            {3655}new UP_3969: bitstring;
                                            {3656}out(c, (GetEndpointResponse,pkSess_3967,None,SP_3968,UP_3969))
                                        )
                                        else
                                            {3657}let v_3970: bool = (Sess_3931 = C) in
                                            (
                                                {3658}if v_3970 then
                                                (
                                                    {3659}let pkSess_3971: bitstring = pub(skC) in
                                                    {3660}in(c, =GetEndpointRequest);
                                                    {3661}new SP_3972: bitstring;
                                                    {3662}new UP_3973: bitstring;
                                                    {3663}out(c, (GetEndpointResponse,pkSess_3971,None,SP_3972,UP_3973))
                                                )
                                                else
                                                    {3664}let pkSess_3974: bitstring = pub(sk(Sess_3931)) in
                                                    {3665}in(c, =GetEndpointRequest);
                                                    {3666}new SP_3975: bitstring;
                                                    {3667}new UP_3976: bitstring;
                                                    {3668}out(c, (GetEndpointResponse,pkSess_3974,None,SP_3975,UP_3976))
                                            )
                                            else
                                                {3669}let pkSess_3977: bitstring = fail-any in
                                                {3670}in(c, =GetEndpointRequest);
                                                {3671}new SP_3978: bitstring;
                                                {3672}new UP_3979: bitstring;
                                                {3673}out(c, (GetEndpointResponse,pkSess_3977,None,SP_3978,UP_3979))
                                    )
                                    else
                                        {3674}let pkSess_3980: bitstring = fail-any in
                                        {3675}in(c, =GetEndpointRequest);
                                        {3676}new SP_3981: bitstring;
                                        {3677}new UP_3982: bitstring;
                                        {3678}out(c, (GetEndpointResponse,pkSess_3980,None,SP_3981,UP_3982))
                            )
                            else
                                {3679}let pkSess_3983: bitstring = fail-any in
                                {3680}in(c, =GetEndpointRequest);
                                {3681}new SP_3984: bitstring;
                                {3682}new UP_3985: bitstring;
                                {3683}out(c, (GetEndpointResponse,pkSess_3983,None,SP_3984,UP_3985))
                        )
                        else
                            {3684}let v_3986: bool = (Cli_3929 = C) in
                            (
                                {3685}if v_3986 then
                                (
                                    {3686}let pkCli_3987: bitstring = pub(skC) in
                                    {3687}let v_3988: bool = (Sess_3931 = A) in
                                    (
                                        {3688}if v_3988 then
                                        (
                                            {3689}let pkSess_3989: bitstring = pub(skA) in
                                            {3690}in(c, =GetEndpointRequest);
                                            {3691}new SP_3990: bitstring;
                                            {3692}new UP_3991: bitstring;
                                            {3693}out(c, (GetEndpointResponse,pkSess_3989,None,SP_3990,UP_3991))
                                        )
                                        else
                                            {3694}let v_3992: bool = (Sess_3931 = B) in
                                            (
                                                {3695}if v_3992 then
                                                (
                                                    {3696}let pkSess_3993: bitstring = pub(skB) in
                                                    {3697}in(c, =GetEndpointRequest);
                                                    {3698}new SP_3994: bitstring;
                                                    {3699}new UP_3995: bitstring;
                                                    {3700}out(c, (GetEndpointResponse,pkSess_3993,None,SP_3994,UP_3995))
                                                )
                                                else
                                                    {3701}let v_3996: bool = (Sess_3931 = C) in
                                                    (
                                                        {3702}if v_3996 then
                                                        (
                                                            {3703}let pkSess_3997: bitstring = pub(skC) in
                                                            {3704}in(c, =GetEndpointRequest);
                                                            {3705}new SP_3998: bitstring;
                                                            {3706}new UP_3999: bitstring;
                                                            {3707}out(c, (GetEndpointResponse,pkSess_3997,None,SP_3998,UP_3999))
                                                        )
                                                        else
                                                            {3708}let pkSess_4000: bitstring = pub(sk(Sess_3931)) in
                                                            {3709}in(c, =GetEndpointRequest);
                                                            {3710}new SP_4001: bitstring;
                                                            {3711}new UP_4002: bitstring;
                                                            {3712}out(c, (GetEndpointResponse,pkSess_4000,None,SP_4001,UP_4002))
                                                    )
                                                    else
                                                        {3713}let pkSess_4003: bitstring = fail-any in
                                                        {3714}in(c, =GetEndpointRequest);
                                                        {3715}new SP_4004: bitstring;
                                                        {3716}new UP_4005: bitstring;
                                                        {3717}out(c, (GetEndpointResponse,pkSess_4003,None,SP_4004,UP_4005))
                                            )
                                            else
                                                {3718}let pkSess_4006: bitstring = fail-any in
                                                {3719}in(c, =GetEndpointRequest);
                                                {3720}new SP_4007: bitstring;
                                                {3721}new UP_4008: bitstring;
                                                {3722}out(c, (GetEndpointResponse,pkSess_4006,None,SP_4007,UP_4008))
                                    )
                                    else
                                        {3723}let pkSess_4009: bitstring = fail-any in
                                        {3724}in(c, =GetEndpointRequest);
                                        {3725}new SP_4010: bitstring;
                                        {3726}new UP_4011: bitstring;
                                        {3727}out(c, (GetEndpointResponse,pkSess_4009,None,SP_4010,UP_4011))
                                )
                                else
                                    {3728}let pkCli_4012: bitstring = pub(sk(Cli_3929)) in
                                    {3729}let v_4013: bool = (Sess_3931 = A) in
                                    (
                                        {3730}if v_4013 then
                                        (
                                            {3731}let pkSess_4014: bitstring = pub(skA) in
                                            {3732}in(c, =GetEndpointRequest);
                                            {3733}new SP_4015: bitstring;
                                            {3734}new UP_4016: bitstring;
                                            {3735}out(c, (GetEndpointResponse,pkSess_4014,None,SP_4015,UP_4016))
                                        )
                                        else
                                            {3736}let v_4017: bool = (Sess_3931 = B) in
                                            (
                                                {3737}if v_4017 then
                                                (
                                                    {3738}let pkSess_4018: bitstring = pub(skB) in
                                                    {3739}in(c, =GetEndpointRequest);
                                                    {3740}new SP_4019: bitstring;
                                                    {3741}new UP_4020: bitstring;
                                                    {3742}out(c, (GetEndpointResponse,pkSess_4018,None,SP_4019,UP_4020))
                                                )
                                                else
                                                    {3743}let v_4021: bool = (Sess_3931 = C) in
                                                    (
                                                        {3744}if v_4021 then
                                                        (
                                                            {3745}let pkSess_4022: bitstring = pub(skC) in
                                                            {3746}in(c, =GetEndpointRequest);
                                                            {3747}new SP_4023: bitstring;
                                                            {3748}new UP_4024: bitstring;
                                                            {3749}out(c, (GetEndpointResponse,pkSess_4022,None,SP_4023,UP_4024))
                                                        )
                                                        else
                                                            {3750}let pkSess_4025: bitstring = pub(sk(Sess_3931)) in
                                                            {3751}in(c, =GetEndpointRequest);
                                                            {3752}new SP_4026: bitstring;
                                                            {3753}new UP_4027: bitstring;
                                                            {3754}out(c, (GetEndpointResponse,pkSess_4025,None,SP_4026,UP_4027))
                                                    )
                                                    else
                                                        {3755}let pkSess_4028: bitstring = fail-any in
                                                        {3756}in(c, =GetEndpointRequest);
                                                        {3757}new SP_4029: bitstring;
                                                        {3758}new UP_4030: bitstring;
                                                        {3759}out(c, (GetEndpointResponse,pkSess_4028,None,SP_4029,UP_4030))
                                            )
                                            else
                                                {3760}let pkSess_4031: bitstring = fail-any in
                                                {3761}in(c, =GetEndpointRequest);
                                                {3762}new SP_4032: bitstring;
                                                {3763}new UP_4033: bitstring;
                                                {3764}out(c, (GetEndpointResponse,pkSess_4031,None,SP_4032,UP_4033))
                                    )
                                    else
                                        {3765}let pkSess_4034: bitstring = fail-any in
                                        {3766}in(c, =GetEndpointRequest);
                                        {3767}new SP_4035: bitstring;
                                        {3768}new UP_4036: bitstring;
                                        {3769}out(c, (GetEndpointResponse,pkSess_4034,None,SP_4035,UP_4036))
                            )
                            else
                                {3770}let pkCli_4037: bitstring = fail-any in
                                {3771}let v_4038: bool = (Sess_3931 = A) in
                                (
                                    {3772}if v_4038 then
                                    (
                                        {3773}let pkSess_4039: bitstring = pub(skA) in
                                        {3774}in(c, =GetEndpointRequest);
                                        {3775}new SP_4040: bitstring;
                                        {3776}new UP_4041: bitstring;
                                        {3777}out(c, (GetEndpointResponse,pkSess_4039,None,SP_4040,UP_4041))
                                    )
                                    else
                                        {3778}let v_4042: bool = (Sess_3931 = B) in
                                        (
                                            {3779}if v_4042 then
                                            (
                                                {3780}let pkSess_4043: bitstring = pub(skB) in
                                                {3781}in(c, =GetEndpointRequest);
                                                {3782}new SP_4044: bitstring;
                                                {3783}new UP_4045: bitstring;
                                                {3784}out(c, (GetEndpointResponse,pkSess_4043,None,SP_4044,UP_4045))
                                            )
                                            else
                                                {3785}let v_4046: bool = (Sess_3931 = C) in
                                                (
                                                    {3786}if v_4046 then
                                                    (
                                                        {3787}let pkSess_4047: bitstring = pub(skC) in
                                                        {3788}in(c, =GetEndpointRequest);
                                                        {3789}new SP_4048: bitstring;
                                                        {3790}new UP_4049: bitstring;
                                                        {3791}out(c, (GetEndpointResponse,pkSess_4047,None,SP_4048,UP_4049))
                                                    )
                                                    else
                                                        {3792}let pkSess_4050: bitstring = pub(sk(Sess_3931)) in
                                                        {3793}in(c, =GetEndpointRequest);
                                                        {3794}new SP_4051: bitstring;
                                                        {3795}new UP_4052: bitstring;
                                                        {3796}out(c, (GetEndpointResponse,pkSess_4050,None,SP_4051,UP_4052))
                                                )
                                                else
                                                    {3797}let pkSess_4053: bitstring = fail-any in
                                                    {3798}in(c, =GetEndpointRequest);
                                                    {3799}new SP_4054: bitstring;
                                                    {3800}new UP_4055: bitstring;
                                                    {3801}out(c, (GetEndpointResponse,pkSess_4053,None,SP_4054,UP_4055))
                                        )
                                        else
                                            {3802}let pkSess_4056: bitstring = fail-any in
                                            {3803}in(c, =GetEndpointRequest);
                                            {3804}new SP_4057: bitstring;
                                            {3805}new UP_4058: bitstring;
                                            {3806}out(c, (GetEndpointResponse,pkSess_4056,None,SP_4057,UP_4058))
                                )
                                else
                                    {3807}let pkSess_4059: bitstring = fail-any in
                                    {3808}in(c, =GetEndpointRequest);
                                    {3809}new SP_4060: bitstring;
                                    {3810}new UP_4061: bitstring;
                                    {3811}out(c, (GetEndpointResponse,pkSess_4059,None,SP_4060,UP_4061))
                    )
                    else
                        {3812}let pkCli_4062: bitstring = fail-any in
                        {3813}let v_4063: bool = (Sess_3931 = A) in
                        (
                            {3814}if v_4063 then
                            (
                                {3815}let pkSess_4064: bitstring = pub(skA) in
                                {3816}in(c, =GetEndpointRequest);
                                {3817}new SP_4065: bitstring;
                                {3818}new UP_4066: bitstring;
                                {3819}out(c, (GetEndpointResponse,pkSess_4064,None,SP_4065,UP_4066))
                            )
                            else
                                {3820}let v_4067: bool = (Sess_3931 = B) in
                                (
                                    {3821}if v_4067 then
                                    (
                                        {3822}let pkSess_4068: bitstring = pub(skB) in
                                        {3823}in(c, =GetEndpointRequest);
                                        {3824}new SP_4069: bitstring;
                                        {3825}new UP_4070: bitstring;
                                        {3826}out(c, (GetEndpointResponse,pkSess_4068,None,SP_4069,UP_4070))
                                    )
                                    else
                                        {3827}let v_4071: bool = (Sess_3931 = C) in
                                        (
                                            {3828}if v_4071 then
                                            (
                                                {3829}let pkSess_4072: bitstring = pub(skC) in
                                                {3830}in(c, =GetEndpointRequest);
                                                {3831}new SP_4073: bitstring;
                                                {3832}new UP_4074: bitstring;
                                                {3833}out(c, (GetEndpointResponse,pkSess_4072,None,SP_4073,UP_4074))
                                            )
                                            else
                                                {3834}let pkSess_4075: bitstring = pub(sk(Sess_3931)) in
                                                {3835}in(c, =GetEndpointRequest);
                                                {3836}new SP_4076: bitstring;
                                                {3837}new UP_4077: bitstring;
                                                {3838}out(c, (GetEndpointResponse,pkSess_4075,None,SP_4076,UP_4077))
                                        )
                                        else
                                            {3839}let pkSess_4078: bitstring = fail-any in
                                            {3840}in(c, =GetEndpointRequest);
                                            {3841}new SP_4079: bitstring;
                                            {3842}new UP_4080: bitstring;
                                            {3843}out(c, (GetEndpointResponse,pkSess_4078,None,SP_4079,UP_4080))
                                )
                                else
                                    {3844}let pkSess_4081: bitstring = fail-any in
                                    {3845}in(c, =GetEndpointRequest);
                                    {3846}new SP_4082: bitstring;
                                    {3847}new UP_4083: bitstring;
                                    {3848}out(c, (GetEndpointResponse,pkSess_4081,None,SP_4082,UP_4083))
                        )
                        else
                            {3849}let pkSess_4084: bitstring = fail-any in
                            {3850}in(c, =GetEndpointRequest);
                            {3851}new SP_4085: bitstring;
                            {3852}new UP_4086: bitstring;
                            {3853}out(c, (GetEndpointResponse,pkSess_4084,None,SP_4085,UP_4086))
            )
            else
                {3854}let pkCli_4087: bitstring = fail-any in
                {3855}let v_4088: bool = (Sess_3931 = A) in
                (
                    {3856}if v_4088 then
                    (
                        {3857}let pkSess_4089: bitstring = pub(skA) in
                        {3858}in(c, =GetEndpointRequest);
                        {3859}new SP_4090: bitstring;
                        {3860}new UP_4091: bitstring;
                        {3861}out(c, (GetEndpointResponse,pkSess_4089,None,SP_4090,UP_4091))
                    )
                    else
                        {3862}let v_4092: bool = (Sess_3931 = B) in
                        (
                            {3863}if v_4092 then
                            (
                                {3864}let pkSess_4093: bitstring = pub(skB) in
                                {3865}in(c, =GetEndpointRequest);
                                {3866}new SP_4094: bitstring;
                                {3867}new UP_4095: bitstring;
                                {3868}out(c, (GetEndpointResponse,pkSess_4093,None,SP_4094,UP_4095))
                            )
                            else
                                {3869}let v_4096: bool = (Sess_3931 = C) in
                                (
                                    {3870}if v_4096 then
                                    (
                                        {3871}let pkSess_4097: bitstring = pub(skC) in
                                        {3872}in(c, =GetEndpointRequest);
                                        {3873}new SP_4098: bitstring;
                                        {3874}new UP_4099: bitstring;
                                        {3875}out(c, (GetEndpointResponse,pkSess_4097,None,SP_4098,UP_4099))
                                    )
                                    else
                                        {3876}let pkSess_4100: bitstring = pub(sk(Sess_3931)) in
                                        {3877}in(c, =GetEndpointRequest);
                                        {3878}new SP_4101: bitstring;
                                        {3879}new UP_4102: bitstring;
                                        {3880}out(c, (GetEndpointResponse,pkSess_4100,None,SP_4101,UP_4102))
                                )
                                else
                                    {3881}let pkSess_4103: bitstring = fail-any in
                                    {3882}in(c, =GetEndpointRequest);
                                    {3883}new SP_4104: bitstring;
                                    {3884}new UP_4105: bitstring;
                                    {3885}out(c, (GetEndpointResponse,pkSess_4103,None,SP_4104,UP_4105))
                        )
                        else
                            {3886}let pkSess_4106: bitstring = fail-any in
                            {3887}in(c, =GetEndpointRequest);
                            {3888}new SP_4107: bitstring;
                            {3889}new UP_4108: bitstring;
                            {3890}out(c, (GetEndpointResponse,pkSess_4106,None,SP_4107,UP_4108))
                )
                else
                    {3891}let pkSess_4109: bitstring = fail-any in
                    {3892}in(c, =GetEndpointRequest);
                    {3893}new SP_4110: bitstring;
                    {3894}new UP_4111: bitstring;
                    {3895}out(c, (GetEndpointResponse,pkSess_4109,None,SP_4110,UP_4111))
        )
        else
            {3896}let v_4112: bool = (Disco_3930 = B) in
            (
                {3897}if v_4112 then
                (
                    {3898}let skDisco_4113: bitstring = skB in
                    {3899}let pkDisco_4114: bitstring = pub(skDisco_4113) in
                    {3900}let v_4115: bool = (Cli_3929 = A) in
                    (
                        {3901}if v_4115 then
                        (
                            {3902}let pkCli_4116: bitstring = pub(skA) in
                            {3903}let v_4117: bool = (Sess_3931 = A) in
                            (
                                {3904}if v_4117 then
                                (
                                    {3905}let pkSess_4118: bitstring = pub(skA) in
                                    {3906}in(c, =GetEndpointRequest);
                                    {3907}new SP_4119: bitstring;
                                    {3908}new UP_4120: bitstring;
                                    {3909}out(c, (GetEndpointResponse,pkSess_4118,None,SP_4119,UP_4120))
                                )
                                else
                                    {3910}let v_4121: bool = (Sess_3931 = B) in
                                    (
                                        {3911}if v_4121 then
                                        (
                                            {3912}let pkSess_4122: bitstring = pub(skB) in
                                            {3913}in(c, =GetEndpointRequest);
                                            {3914}new SP_4123: bitstring;
                                            {3915}new UP_4124: bitstring;
                                            {3916}out(c, (GetEndpointResponse,pkSess_4122,None,SP_4123,UP_4124))
                                        )
                                        else
                                            {3917}let v_4125: bool = (Sess_3931 = C) in
                                            (
                                                {3918}if v_4125 then
                                                (
                                                    {3919}let pkSess_4126: bitstring = pub(skC) in
                                                    {3920}in(c, =GetEndpointRequest);
                                                    {3921}new SP_4127: bitstring;
                                                    {3922}new UP_4128: bitstring;
                                                    {3923}out(c, (GetEndpointResponse,pkSess_4126,None,SP_4127,UP_4128))
                                                )
                                                else
                                                    {3924}let pkSess_4129: bitstring = pub(sk(Sess_3931)) in
                                                    {3925}in(c, =GetEndpointRequest);
                                                    {3926}new SP_4130: bitstring;
                                                    {3927}new UP_4131: bitstring;
                                                    {3928}out(c, (GetEndpointResponse,pkSess_4129,None,SP_4130,UP_4131))
                                            )
                                            else
                                                {3929}let pkSess_4132: bitstring = fail-any in
                                                {3930}in(c, =GetEndpointRequest);
                                                {3931}new SP_4133: bitstring;
                                                {3932}new UP_4134: bitstring;
                                                {3933}out(c, (GetEndpointResponse,pkSess_4132,None,SP_4133,UP_4134))
                                    )
                                    else
                                        {3934}let pkSess_4135: bitstring = fail-any in
                                        {3935}in(c, =GetEndpointRequest);
                                        {3936}new SP_4136: bitstring;
                                        {3937}new UP_4137: bitstring;
                                        {3938}out(c, (GetEndpointResponse,pkSess_4135,None,SP_4136,UP_4137))
                            )
                            else
                                {3939}let pkSess_4138: bitstring = fail-any in
                                {3940}in(c, =GetEndpointRequest);
                                {3941}new SP_4139: bitstring;
                                {3942}new UP_4140: bitstring;
                                {3943}out(c, (GetEndpointResponse,pkSess_4138,None,SP_4139,UP_4140))
                        )
                        else
                            {3944}let v_4141: bool = (Cli_3929 = B) in
                            (
                                {3945}if v_4141 then
                                (
                                    {3946}let pkCli_4142: bitstring = pub(skB) in
                                    {3947}let v_4143: bool = (Sess_3931 = A) in
                                    (
                                        {3948}if v_4143 then
                                        (
                                            {3949}let pkSess_4144: bitstring = pub(skA) in
                                            {3950}in(c, =GetEndpointRequest);
                                            {3951}new SP_4145: bitstring;
                                            {3952}new UP_4146: bitstring;
                                            {3953}out(c, (GetEndpointResponse,pkSess_4144,None,SP_4145,UP_4146))
                                        )
                                        else
                                            {3954}let v_4147: bool = (Sess_3931 = B) in
                                            (
                                                {3955}if v_4147 then
                                                (
                                                    {3956}let pkSess_4148: bitstring = pub(skB) in
                                                    {3957}in(c, =GetEndpointRequest);
                                                    {3958}new SP_4149: bitstring;
                                                    {3959}new UP_4150: bitstring;
                                                    {3960}out(c, (GetEndpointResponse,pkSess_4148,None,SP_4149,UP_4150))
                                                )
                                                else
                                                    {3961}let v_4151: bool = (Sess_3931 = C) in
                                                    (
                                                        {3962}if v_4151 then
                                                        (
                                                            {3963}let pkSess_4152: bitstring = pub(skC) in
                                                            {3964}in(c, =GetEndpointRequest);
                                                            {3965}new SP_4153: bitstring;
                                                            {3966}new UP_4154: bitstring;
                                                            {3967}out(c, (GetEndpointResponse,pkSess_4152,None,SP_4153,UP_4154))
                                                        )
                                                        else
                                                            {3968}let pkSess_4155: bitstring = pub(sk(Sess_3931)) in
                                                            {3969}in(c, =GetEndpointRequest);
                                                            {3970}new SP_4156: bitstring;
                                                            {3971}new UP_4157: bitstring;
                                                            {3972}out(c, (GetEndpointResponse,pkSess_4155,None,SP_4156,UP_4157))
                                                    )
                                                    else
                                                        {3973}let pkSess_4158: bitstring = fail-any in
                                                        {3974}in(c, =GetEndpointRequest);
                                                        {3975}new SP_4159: bitstring;
                                                        {3976}new UP_4160: bitstring;
                                                        {3977}out(c, (GetEndpointResponse,pkSess_4158,None,SP_4159,UP_4160))
                                            )
                                            else
                                                {3978}let pkSess_4161: bitstring = fail-any in
                                                {3979}in(c, =GetEndpointRequest);
                                                {3980}new SP_4162: bitstring;
                                                {3981}new UP_4163: bitstring;
                                                {3982}out(c, (GetEndpointResponse,pkSess_4161,None,SP_4162,UP_4163))
                                    )
                                    else
                                        {3983}let pkSess_4164: bitstring = fail-any in
                                        {3984}in(c, =GetEndpointRequest);
                                        {3985}new SP_4165: bitstring;
                                        {3986}new UP_4166: bitstring;
                                        {3987}out(c, (GetEndpointResponse,pkSess_4164,None,SP_4165,UP_4166))
                                )
                                else
                                    {3988}let v_4167: bool = (Cli_3929 = C) in
                                    (
                                        {3989}if v_4167 then
                                        (
                                            {3990}let pkCli_4168: bitstring = pub(skC) in
                                            {3991}let v_4169: bool = (Sess_3931 = A) in
                                            (
                                                {3992}if v_4169 then
                                                (
                                                    {3993}let pkSess_4170: bitstring = pub(skA) in
                                                    {3994}in(c, =GetEndpointRequest);
                                                    {3995}new SP_4171: bitstring;
                                                    {3996}new UP_4172: bitstring;
                                                    {3997}out(c, (GetEndpointResponse,pkSess_4170,None,SP_4171,UP_4172))
                                                )
                                                else
                                                    {3998}let v_4173: bool = (Sess_3931 = B) in
                                                    (
                                                        {3999}if v_4173 then
                                                        (
                                                            {4000}let pkSess_4174: bitstring = pub(skB) in
                                                            {4001}in(c, =GetEndpointRequest);
                                                            {4002}new SP_4175: bitstring;
                                                            {4003}new UP_4176: bitstring;
                                                            {4004}out(c, (GetEndpointResponse,pkSess_4174,None,SP_4175,UP_4176))
                                                        )
                                                        else
                                                            {4005}let v_4177: bool = (Sess_3931 = C) in
                                                            (
                                                                {4006}if v_4177 then
                                                                (
                                                                    {4007}let pkSess_4178: bitstring = pub(skC) in
                                                                    {4008}in(c, =GetEndpointRequest);
                                                                    {4009}new SP_4179: bitstring;
                                                                    {4010}new UP_4180: bitstring;
                                                                    {4011}out(c, (GetEndpointResponse,pkSess_4178,None,SP_4179,UP_4180))
                                                                )
                                                                else
                                                                    {4012}let pkSess_4181: bitstring = pub(sk(Sess_3931)) in
                                                                    {4013}in(c, =GetEndpointRequest);
                                                                    {4014}new SP_4182: bitstring;
                                                                    {4015}new UP_4183: bitstring;
                                                                    {4016}out(c, (GetEndpointResponse,pkSess_4181,None,SP_4182,UP_4183))
                                                            )
                                                            else
                                                                {4017}let pkSess_4184: bitstring = fail-any in
                                                                {4018}in(c, =GetEndpointRequest);
                                                                {4019}new SP_4185: bitstring;
                                                                {4020}new UP_4186: bitstring;
                                                                {4021}out(c, (GetEndpointResponse,pkSess_4184,None,SP_4185,UP_4186))
                                                    )
                                                    else
                                                        {4022}let pkSess_4187: bitstring = fail-any in
                                                        {4023}in(c, =GetEndpointRequest);
                                                        {4024}new SP_4188: bitstring;
                                                        {4025}new UP_4189: bitstring;
                                                        {4026}out(c, (GetEndpointResponse,pkSess_4187,None,SP_4188,UP_4189))
                                            )
                                            else
                                                {4027}let pkSess_4190: bitstring = fail-any in
                                                {4028}in(c, =GetEndpointRequest);
                                                {4029}new SP_4191: bitstring;
                                                {4030}new UP_4192: bitstring;
                                                {4031}out(c, (GetEndpointResponse,pkSess_4190,None,SP_4191,UP_4192))
                                        )
                                        else
                                            {4032}let pkCli_4193: bitstring = pub(sk(Cli_3929)) in
                                            {4033}let v_4194: bool = (Sess_3931 = A) in
                                            (
                                                {4034}if v_4194 then
                                                (
                                                    {4035}let pkSess_4195: bitstring = pub(skA) in
                                                    {4036}in(c, =GetEndpointRequest);
                                                    {4037}new SP_4196: bitstring;
                                                    {4038}new UP_4197: bitstring;
                                                    {4039}out(c, (GetEndpointResponse,pkSess_4195,None,SP_4196,UP_4197))
                                                )
                                                else
                                                    {4040}let v_4198: bool = (Sess_3931 = B) in
                                                    (
                                                        {4041}if v_4198 then
                                                        (
                                                            {4042}let pkSess_4199: bitstring = pub(skB) in
                                                            {4043}in(c, =GetEndpointRequest);
                                                            {4044}new SP_4200: bitstring;
                                                            {4045}new UP_4201: bitstring;
                                                            {4046}out(c, (GetEndpointResponse,pkSess_4199,None,SP_4200,UP_4201))
                                                        )
                                                        else
                                                            {4047}let v_4202: bool = (Sess_3931 = C) in
                                                            (
                                                                {4048}if v_4202 then
                                                                (
                                                                    {4049}let pkSess_4203: bitstring = pub(skC) in
                                                                    {4050}in(c, =GetEndpointRequest);
                                                                    {4051}new SP_4204: bitstring;
                                                                    {4052}new UP_4205: bitstring;
                                                                    {4053}out(c, (GetEndpointResponse,pkSess_4203,None,SP_4204,UP_4205))
                                                                )
                                                                else
                                                                    {4054}let pkSess_4206: bitstring = pub(sk(Sess_3931)) in
                                                                    {4055}in(c, =GetEndpointRequest);
                                                                    {4056}new SP_4207: bitstring;
                                                                    {4057}new UP_4208: bitstring;
                                                                    {4058}out(c, (GetEndpointResponse,pkSess_4206,None,SP_4207,UP_4208))
                                                            )
                                                            else
                                                                {4059}let pkSess_4209: bitstring = fail-any in
                                                                {4060}in(c, =GetEndpointRequest);
                                                                {4061}new SP_4210: bitstring;
                                                                {4062}new UP_4211: bitstring;
                                                                {4063}out(c, (GetEndpointResponse,pkSess_4209,None,SP_4210,UP_4211))
                                                    )
                                                    else
                                                        {4064}let pkSess_4212: bitstring = fail-any in
                                                        {4065}in(c, =GetEndpointRequest);
                                                        {4066}new SP_4213: bitstring;
                                                        {4067}new UP_4214: bitstring;
                                                        {4068}out(c, (GetEndpointResponse,pkSess_4212,None,SP_4213,UP_4214))
                                            )
                                            else
                                                {4069}let pkSess_4215: bitstring = fail-any in
                                                {4070}in(c, =GetEndpointRequest);
                                                {4071}new SP_4216: bitstring;
                                                {4072}new UP_4217: bitstring;
                                                {4073}out(c, (GetEndpointResponse,pkSess_4215,None,SP_4216,UP_4217))
                                    )
                                    else
                                        {4074}let pkCli_4218: bitstring = fail-any in
                                        {4075}let v_4219: bool = (Sess_3931 = A) in
                                        (
                                            {4076}if v_4219 then
                                            (
                                                {4077}let pkSess_4220: bitstring = pub(skA) in
                                                {4078}in(c, =GetEndpointRequest);
                                                {4079}new SP_4221: bitstring;
                                                {4080}new UP_4222: bitstring;
                                                {4081}out(c, (GetEndpointResponse,pkSess_4220,None,SP_4221,UP_4222))
                                            )
                                            else
                                                {4082}let v_4223: bool = (Sess_3931 = B) in
                                                (
                                                    {4083}if v_4223 then
                                                    (
                                                        {4084}let pkSess_4224: bitstring = pub(skB) in
                                                        {4085}in(c, =GetEndpointRequest);
                                                        {4086}new SP_4225: bitstring;
                                                        {4087}new UP_4226: bitstring;
                                                        {4088}out(c, (GetEndpointResponse,pkSess_4224,None,SP_4225,UP_4226))
                                                    )
                                                    else
                                                        {4089}let v_4227: bool = (Sess_3931 = C) in
                                                        (
                                                            {4090}if v_4227 then
                                                            (
                                                                {4091}let pkSess_4228: bitstring = pub(skC) in
                                                                {4092}in(c, =GetEndpointRequest);
                                                                {4093}new SP_4229: bitstring;
                                                                {4094}new UP_4230: bitstring;
                                                                {4095}out(c, (GetEndpointResponse,pkSess_4228,None,SP_4229,UP_4230))
                                                            )
                                                            else
                                                                {4096}let pkSess_4231: bitstring = pub(sk(Sess_3931)) in
                                                                {4097}in(c, =GetEndpointRequest);
                                                                {4098}new SP_4232: bitstring;
                                                                {4099}new UP_4233: bitstring;
                                                                {4100}out(c, (GetEndpointResponse,pkSess_4231,None,SP_4232,UP_4233))
                                                        )
                                                        else
                                                            {4101}let pkSess_4234: bitstring = fail-any in
                                                            {4102}in(c, =GetEndpointRequest);
                                                            {4103}new SP_4235: bitstring;
                                                            {4104}new UP_4236: bitstring;
                                                            {4105}out(c, (GetEndpointResponse,pkSess_4234,None,SP_4235,UP_4236))
                                                )
                                                else
                                                    {4106}let pkSess_4237: bitstring = fail-any in
                                                    {4107}in(c, =GetEndpointRequest);
                                                    {4108}new SP_4238: bitstring;
                                                    {4109}new UP_4239: bitstring;
                                                    {4110}out(c, (GetEndpointResponse,pkSess_4237,None,SP_4238,UP_4239))
                                        )
                                        else
                                            {4111}let pkSess_4240: bitstring = fail-any in
                                            {4112}in(c, =GetEndpointRequest);
                                            {4113}new SP_4241: bitstring;
                                            {4114}new UP_4242: bitstring;
                                            {4115}out(c, (GetEndpointResponse,pkSess_4240,None,SP_4241,UP_4242))
                            )
                            else
                                {4116}let pkCli_4243: bitstring = fail-any in
                                {4117}let v_4244: bool = (Sess_3931 = A) in
                                (
                                    {4118}if v_4244 then
                                    (
                                        {4119}let pkSess_4245: bitstring = pub(skA) in
                                        {4120}in(c, =GetEndpointRequest);
                                        {4121}new SP_4246: bitstring;
                                        {4122}new UP_4247: bitstring;
                                        {4123}out(c, (GetEndpointResponse,pkSess_4245,None,SP_4246,UP_4247))
                                    )
                                    else
                                        {4124}let v_4248: bool = (Sess_3931 = B) in
                                        (
                                            {4125}if v_4248 then
                                            (
                                                {4126}let pkSess_4249: bitstring = pub(skB) in
                                                {4127}in(c, =GetEndpointRequest);
                                                {4128}new SP_4250: bitstring;
                                                {4129}new UP_4251: bitstring;
                                                {4130}out(c, (GetEndpointResponse,pkSess_4249,None,SP_4250,UP_4251))
                                            )
                                            else
                                                {4131}let v_4252: bool = (Sess_3931 = C) in
                                                (
                                                    {4132}if v_4252 then
                                                    (
                                                        {4133}let pkSess_4253: bitstring = pub(skC) in
                                                        {4134}in(c, =GetEndpointRequest);
                                                        {4135}new SP_4254: bitstring;
                                                        {4136}new UP_4255: bitstring;
                                                        {4137}out(c, (GetEndpointResponse,pkSess_4253,None,SP_4254,UP_4255))
                                                    )
                                                    else
                                                        {4138}let pkSess_4256: bitstring = pub(sk(Sess_3931)) in
                                                        {4139}in(c, =GetEndpointRequest);
                                                        {4140}new SP_4257: bitstring;
                                                        {4141}new UP_4258: bitstring;
                                                        {4142}out(c, (GetEndpointResponse,pkSess_4256,None,SP_4257,UP_4258))
                                                )
                                                else
                                                    {4143}let pkSess_4259: bitstring = fail-any in
                                                    {4144}in(c, =GetEndpointRequest);
                                                    {4145}new SP_4260: bitstring;
                                                    {4146}new UP_4261: bitstring;
                                                    {4147}out(c, (GetEndpointResponse,pkSess_4259,None,SP_4260,UP_4261))
                                        )
                                        else
                                            {4148}let pkSess_4262: bitstring = fail-any in
                                            {4149}in(c, =GetEndpointRequest);
                                            {4150}new SP_4263: bitstring;
                                            {4151}new UP_4264: bitstring;
                                            {4152}out(c, (GetEndpointResponse,pkSess_4262,None,SP_4263,UP_4264))
                                )
                                else
                                    {4153}let pkSess_4265: bitstring = fail-any in
                                    {4154}in(c, =GetEndpointRequest);
                                    {4155}new SP_4266: bitstring;
                                    {4156}new UP_4267: bitstring;
                                    {4157}out(c, (GetEndpointResponse,pkSess_4265,None,SP_4266,UP_4267))
                    )
                    else
                        {4158}let pkCli_4268: bitstring = fail-any in
                        {4159}let v_4269: bool = (Sess_3931 = A) in
                        (
                            {4160}if v_4269 then
                            (
                                {4161}let pkSess_4270: bitstring = pub(skA) in
                                {4162}in(c, =GetEndpointRequest);
                                {4163}new SP_4271: bitstring;
                                {4164}new UP_4272: bitstring;
                                {4165}out(c, (GetEndpointResponse,pkSess_4270,None,SP_4271,UP_4272))
                            )
                            else
                                {4166}let v_4273: bool = (Sess_3931 = B) in
                                (
                                    {4167}if v_4273 then
                                    (
                                        {4168}let pkSess_4274: bitstring = pub(skB) in
                                        {4169}in(c, =GetEndpointRequest);
                                        {4170}new SP_4275: bitstring;
                                        {4171}new UP_4276: bitstring;
                                        {4172}out(c, (GetEndpointResponse,pkSess_4274,None,SP_4275,UP_4276))
                                    )
                                    else
                                        {4173}let v_4277: bool = (Sess_3931 = C) in
                                        (
                                            {4174}if v_4277 then
                                            (
                                                {4175}let pkSess_4278: bitstring = pub(skC) in
                                                {4176}in(c, =GetEndpointRequest);
                                                {4177}new SP_4279: bitstring;
                                                {4178}new UP_4280: bitstring;
                                                {4179}out(c, (GetEndpointResponse,pkSess_4278,None,SP_4279,UP_4280))
                                            )
                                            else
                                                {4180}let pkSess_4281: bitstring = pub(sk(Sess_3931)) in
                                                {4181}in(c, =GetEndpointRequest);
                                                {4182}new SP_4282: bitstring;
                                                {4183}new UP_4283: bitstring;
                                                {4184}out(c, (GetEndpointResponse,pkSess_4281,None,SP_4282,UP_4283))
                                        )
                                        else
                                            {4185}let pkSess_4284: bitstring = fail-any in
                                            {4186}in(c, =GetEndpointRequest);
                                            {4187}new SP_4285: bitstring;
                                            {4188}new UP_4286: bitstring;
                                            {4189}out(c, (GetEndpointResponse,pkSess_4284,None,SP_4285,UP_4286))
                                )
                                else
                                    {4190}let pkSess_4287: bitstring = fail-any in
                                    {4191}in(c, =GetEndpointRequest);
                                    {4192}new SP_4288: bitstring;
                                    {4193}new UP_4289: bitstring;
                                    {4194}out(c, (GetEndpointResponse,pkSess_4287,None,SP_4288,UP_4289))
                        )
                        else
                            {4195}let pkSess_4290: bitstring = fail-any in
                            {4196}in(c, =GetEndpointRequest);
                            {4197}new SP_4291: bitstring;
                            {4198}new UP_4292: bitstring;
                            {4199}out(c, (GetEndpointResponse,pkSess_4290,None,SP_4291,UP_4292))
                )
                else
                    {4200}let =true = (Disco_3930 = C) in
                    (
                        {4201}let skDisco_4293: bitstring = skC in
                        {4202}let pkDisco_4294: bitstring = pub(skDisco_4293) in
                        {4203}let v_4295: bool = (Cli_3929 = A) in
                        (
                            {4204}if v_4295 then
                            (
                                {4205}let pkCli_4296: bitstring = pub(skA) in
                                {4206}let v_4297: bool = (Sess_3931 = A) in
                                (
                                    {4207}if v_4297 then
                                    (
                                        {4208}let pkSess_4298: bitstring = pub(skA) in
                                        {4209}in(c, =GetEndpointRequest);
                                        {4210}new SP_4299: bitstring;
                                        {4211}new UP_4300: bitstring;
                                        {4212}out(c, (GetEndpointResponse,pkSess_4298,None,SP_4299,UP_4300))
                                    )
                                    else
                                        {4213}let v_4301: bool = (Sess_3931 = B) in
                                        (
                                            {4214}if v_4301 then
                                            (
                                                {4215}let pkSess_4302: bitstring = pub(skB) in
                                                {4216}in(c, =GetEndpointRequest);
                                                {4217}new SP_4303: bitstring;
                                                {4218}new UP_4304: bitstring;
                                                {4219}out(c, (GetEndpointResponse,pkSess_4302,None,SP_4303,UP_4304))
                                            )
                                            else
                                                {4220}let v_4305: bool = (Sess_3931 = C) in
                                                (
                                                    {4221}if v_4305 then
                                                    (
                                                        {4222}let pkSess_4306: bitstring = pub(skC) in
                                                        {4223}in(c, =GetEndpointRequest);
                                                        {4224}new SP_4307: bitstring;
                                                        {4225}new UP_4308: bitstring;
                                                        {4226}out(c, (GetEndpointResponse,pkSess_4306,None,SP_4307,UP_4308))
                                                    )
                                                    else
                                                        {4227}let pkSess_4309: bitstring = pub(sk(Sess_3931)) in
                                                        {4228}in(c, =GetEndpointRequest);
                                                        {4229}new SP_4310: bitstring;
                                                        {4230}new UP_4311: bitstring;
                                                        {4231}out(c, (GetEndpointResponse,pkSess_4309,None,SP_4310,UP_4311))
                                                )
                                                else
                                                    {4232}let pkSess_4312: bitstring = fail-any in
                                                    {4233}in(c, =GetEndpointRequest);
                                                    {4234}new SP_4313: bitstring;
                                                    {4235}new UP_4314: bitstring;
                                                    {4236}out(c, (GetEndpointResponse,pkSess_4312,None,SP_4313,UP_4314))
                                        )
                                        else
                                            {4237}let pkSess_4315: bitstring = fail-any in
                                            {4238}in(c, =GetEndpointRequest);
                                            {4239}new SP_4316: bitstring;
                                            {4240}new UP_4317: bitstring;
                                            {4241}out(c, (GetEndpointResponse,pkSess_4315,None,SP_4316,UP_4317))
                                )
                                else
                                    {4242}let pkSess_4318: bitstring = fail-any in
                                    {4243}in(c, =GetEndpointRequest);
                                    {4244}new SP_4319: bitstring;
                                    {4245}new UP_4320: bitstring;
                                    {4246}out(c, (GetEndpointResponse,pkSess_4318,None,SP_4319,UP_4320))
                            )
                            else
                                {4247}let v_4321: bool = (Cli_3929 = B) in
                                (
                                    {4248}if v_4321 then
                                    (
                                        {4249}let pkCli_4322: bitstring = pub(skB) in
                                        {4250}let v_4323: bool = (Sess_3931 = A) in
                                        (
                                            {4251}if v_4323 then
                                            (
                                                {4252}let pkSess_4324: bitstring = pub(skA) in
                                                {4253}in(c, =GetEndpointRequest);
                                                {4254}new SP_4325: bitstring;
                                                {4255}new UP_4326: bitstring;
                                                {4256}out(c, (GetEndpointResponse,pkSess_4324,None,SP_4325,UP_4326))
                                            )
                                            else
                                                {4257}let v_4327: bool = (Sess_3931 = B) in
                                                (
                                                    {4258}if v_4327 then
                                                    (
                                                        {4259}let pkSess_4328: bitstring = pub(skB) in
                                                        {4260}in(c, =GetEndpointRequest);
                                                        {4261}new SP_4329: bitstring;
                                                        {4262}new UP_4330: bitstring;
                                                        {4263}out(c, (GetEndpointResponse,pkSess_4328,None,SP_4329,UP_4330))
                                                    )
                                                    else
                                                        {4264}let v_4331: bool = (Sess_3931 = C) in
                                                        (
                                                            {4265}if v_4331 then
                                                            (
                                                                {4266}let pkSess_4332: bitstring = pub(skC) in
                                                                {4267}in(c, =GetEndpointRequest);
                                                                {4268}new SP_4333: bitstring;
                                                                {4269}new UP_4334: bitstring;
                                                                {4270}out(c, (GetEndpointResponse,pkSess_4332,None,SP_4333,UP_4334))
                                                            )
                                                            else
                                                                {4271}let pkSess_4335: bitstring = pub(sk(Sess_3931)) in
                                                                {4272}in(c, =GetEndpointRequest);
                                                                {4273}new SP_4336: bitstring;
                                                                {4274}new UP_4337: bitstring;
                                                                {4275}out(c, (GetEndpointResponse,pkSess_4335,None,SP_4336,UP_4337))
                                                        )
                                                        else
                                                            {4276}let pkSess_4338: bitstring = fail-any in
                                                            {4277}in(c, =GetEndpointRequest);
                                                            {4278}new SP_4339: bitstring;
                                                            {4279}new UP_4340: bitstring;
                                                            {4280}out(c, (GetEndpointResponse,pkSess_4338,None,SP_4339,UP_4340))
                                                )
                                                else
                                                    {4281}let pkSess_4341: bitstring = fail-any in
                                                    {4282}in(c, =GetEndpointRequest);
                                                    {4283}new SP_4342: bitstring;
                                                    {4284}new UP_4343: bitstring;
                                                    {4285}out(c, (GetEndpointResponse,pkSess_4341,None,SP_4342,UP_4343))
                                        )
                                        else
                                            {4286}let pkSess_4344: bitstring = fail-any in
                                            {4287}in(c, =GetEndpointRequest);
                                            {4288}new SP_4345: bitstring;
                                            {4289}new UP_4346: bitstring;
                                            {4290}out(c, (GetEndpointResponse,pkSess_4344,None,SP_4345,UP_4346))
                                    )
                                    else
                                        {4291}let v_4347: bool = (Cli_3929 = C) in
                                        (
                                            {4292}if v_4347 then
                                            (
                                                {4293}let pkCli_4348: bitstring = pub(skC) in
                                                {4294}let v_4349: bool = (Sess_3931 = A) in
                                                (
                                                    {4295}if v_4349 then
                                                    (
                                                        {4296}let pkSess_4350: bitstring = pub(skA) in
                                                        {4297}in(c, =GetEndpointRequest);
                                                        {4298}new SP_4351: bitstring;
                                                        {4299}new UP_4352: bitstring;
                                                        {4300}out(c, (GetEndpointResponse,pkSess_4350,None,SP_4351,UP_4352))
                                                    )
                                                    else
                                                        {4301}let v_4353: bool = (Sess_3931 = B) in
                                                        (
                                                            {4302}if v_4353 then
                                                            (
                                                                {4303}let pkSess_4354: bitstring = pub(skB) in
                                                                {4304}in(c, =GetEndpointRequest);
                                                                {4305}new SP_4355: bitstring;
                                                                {4306}new UP_4356: bitstring;
                                                                {4307}out(c, (GetEndpointResponse,pkSess_4354,None,SP_4355,UP_4356))
                                                            )
                                                            else
                                                                {4308}let v_4357: bool = (Sess_3931 = C) in
                                                                (
                                                                    {4309}if v_4357 then
                                                                    (
                                                                        {4310}let pkSess_4358: bitstring = pub(skC) in
                                                                        {4311}in(c, =GetEndpointRequest);
                                                                        {4312}new SP_4359: bitstring;
                                                                        {4313}new UP_4360: bitstring;
                                                                        {4314}out(c, (GetEndpointResponse,pkSess_4358,None,SP_4359,UP_4360))
                                                                    )
                                                                    else
                                                                        {4315}let pkSess_4361: bitstring = pub(sk(Sess_3931)) in
                                                                        {4316}in(c, =GetEndpointRequest);
                                                                        {4317}new SP_4362: bitstring;
                                                                        {4318}new UP_4363: bitstring;
                                                                        {4319}out(c, (GetEndpointResponse,pkSess_4361,None,SP_4362,UP_4363))
                                                                )
                                                                else
                                                                    {4320}let pkSess_4364: bitstring = fail-any in
                                                                    {4321}in(c, =GetEndpointRequest);
                                                                    {4322}new SP_4365: bitstring;
                                                                    {4323}new UP_4366: bitstring;
                                                                    {4324}out(c, (GetEndpointResponse,pkSess_4364,None,SP_4365,UP_4366))
                                                        )
                                                        else
                                                            {4325}let pkSess_4367: bitstring = fail-any in
                                                            {4326}in(c, =GetEndpointRequest);
                                                            {4327}new SP_4368: bitstring;
                                                            {4328}new UP_4369: bitstring;
                                                            {4329}out(c, (GetEndpointResponse,pkSess_4367,None,SP_4368,UP_4369))
                                                )
                                                else
                                                    {4330}let pkSess_4370: bitstring = fail-any in
                                                    {4331}in(c, =GetEndpointRequest);
                                                    {4332}new SP_4371: bitstring;
                                                    {4333}new UP_4372: bitstring;
                                                    {4334}out(c, (GetEndpointResponse,pkSess_4370,None,SP_4371,UP_4372))
                                            )
                                            else
                                                {4335}let pkCli_4373: bitstring = pub(sk(Cli_3929)) in
                                                {4336}let v_4374: bool = (Sess_3931 = A) in
                                                (
                                                    {4337}if v_4374 then
                                                    (
                                                        {4338}let pkSess_4375: bitstring = pub(skA) in
                                                        {4339}in(c, =GetEndpointRequest);
                                                        {4340}new SP_4376: bitstring;
                                                        {4341}new UP_4377: bitstring;
                                                        {4342}out(c, (GetEndpointResponse,pkSess_4375,None,SP_4376,UP_4377))
                                                    )
                                                    else
                                                        {4343}let v_4378: bool = (Sess_3931 = B) in
                                                        (
                                                            {4344}if v_4378 then
                                                            (
                                                                {4345}let pkSess_4379: bitstring = pub(skB) in
                                                                {4346}in(c, =GetEndpointRequest);
                                                                {4347}new SP_4380: bitstring;
                                                                {4348}new UP_4381: bitstring;
                                                                {4349}out(c, (GetEndpointResponse,pkSess_4379,None,SP_4380,UP_4381))
                                                            )
                                                            else
                                                                {4350}let v_4382: bool = (Sess_3931 = C) in
                                                                (
                                                                    {4351}if v_4382 then
                                                                    (
                                                                        {4352}let pkSess_4383: bitstring = pub(skC) in
                                                                        {4353}in(c, =GetEndpointRequest);
                                                                        {4354}new SP_4384: bitstring;
                                                                        {4355}new UP_4385: bitstring;
                                                                        {4356}out(c, (GetEndpointResponse,pkSess_4383,None,SP_4384,UP_4385))
                                                                    )
                                                                    else
                                                                        {4357}let pkSess_4386: bitstring = pub(sk(Sess_3931)) in
                                                                        {4358}in(c, =GetEndpointRequest);
                                                                        {4359}new SP_4387: bitstring;
                                                                        {4360}new UP_4388: bitstring;
                                                                        {4361}out(c, (GetEndpointResponse,pkSess_4386,None,SP_4387,UP_4388))
                                                                )
                                                                else
                                                                    {4362}let pkSess_4389: bitstring = fail-any in
                                                                    {4363}in(c, =GetEndpointRequest);
                                                                    {4364}new SP_4390: bitstring;
                                                                    {4365}new UP_4391: bitstring;
                                                                    {4366}out(c, (GetEndpointResponse,pkSess_4389,None,SP_4390,UP_4391))
                                                        )
                                                        else
                                                            {4367}let pkSess_4392: bitstring = fail-any in
                                                            {4368}in(c, =GetEndpointRequest);
                                                            {4369}new SP_4393: bitstring;
                                                            {4370}new UP_4394: bitstring;
                                                            {4371}out(c, (GetEndpointResponse,pkSess_4392,None,SP_4393,UP_4394))
                                                )
                                                else
                                                    {4372}let pkSess_4395: bitstring = fail-any in
                                                    {4373}in(c, =GetEndpointRequest);
                                                    {4374}new SP_4396: bitstring;
                                                    {4375}new UP_4397: bitstring;
                                                    {4376}out(c, (GetEndpointResponse,pkSess_4395,None,SP_4396,UP_4397))
                                        )
                                        else
                                            {4377}let pkCli_4398: bitstring = fail-any in
                                            {4378}let v_4399: bool = (Sess_3931 = A) in
                                            (
                                                {4379}if v_4399 then
                                                (
                                                    {4380}let pkSess_4400: bitstring = pub(skA) in
                                                    {4381}in(c, =GetEndpointRequest);
                                                    {4382}new SP_4401: bitstring;
                                                    {4383}new UP_4402: bitstring;
                                                    {4384}out(c, (GetEndpointResponse,pkSess_4400,None,SP_4401,UP_4402))
                                                )
                                                else
                                                    {4385}let v_4403: bool = (Sess_3931 = B) in
                                                    (
                                                        {4386}if v_4403 then
                                                        (
                                                            {4387}let pkSess_4404: bitstring = pub(skB) in
                                                            {4388}in(c, =GetEndpointRequest);
                                                            {4389}new SP_4405: bitstring;
                                                            {4390}new UP_4406: bitstring;
                                                            {4391}out(c, (GetEndpointResponse,pkSess_4404,None,SP_4405,UP_4406))
                                                        )
                                                        else
                                                            {4392}let v_4407: bool = (Sess_3931 = C) in
                                                            (
                                                                {4393}if v_4407 then
                                                                (
                                                                    {4394}let pkSess_4408: bitstring = pub(skC) in
                                                                    {4395}in(c, =GetEndpointRequest);
                                                                    {4396}new SP_4409: bitstring;
                                                                    {4397}new UP_4410: bitstring;
                                                                    {4398}out(c, (GetEndpointResponse,pkSess_4408,None,SP_4409,UP_4410))
                                                                )
                                                                else
                                                                    {4399}let pkSess_4411: bitstring = pub(sk(Sess_3931)) in
                                                                    {4400}in(c, =GetEndpointRequest);
                                                                    {4401}new SP_4412: bitstring;
                                                                    {4402}new UP_4413: bitstring;
                                                                    {4403}out(c, (GetEndpointResponse,pkSess_4411,None,SP_4412,UP_4413))
                                                            )
                                                            else
                                                                {4404}let pkSess_4414: bitstring = fail-any in
                                                                {4405}in(c, =GetEndpointRequest);
                                                                {4406}new SP_4415: bitstring;
                                                                {4407}new UP_4416: bitstring;
                                                                {4408}out(c, (GetEndpointResponse,pkSess_4414,None,SP_4415,UP_4416))
                                                    )
                                                    else
                                                        {4409}let pkSess_4417: bitstring = fail-any in
                                                        {4410}in(c, =GetEndpointRequest);
                                                        {4411}new SP_4418: bitstring;
                                                        {4412}new UP_4419: bitstring;
                                                        {4413}out(c, (GetEndpointResponse,pkSess_4417,None,SP_4418,UP_4419))
                                            )
                                            else
                                                {4414}let pkSess_4420: bitstring = fail-any in
                                                {4415}in(c, =GetEndpointRequest);
                                                {4416}new SP_4421: bitstring;
                                                {4417}new UP_4422: bitstring;
                                                {4418}out(c, (GetEndpointResponse,pkSess_4420,None,SP_4421,UP_4422))
                                )
                                else
                                    {4419}let pkCli_4423: bitstring = fail-any in
                                    {4420}let v_4424: bool = (Sess_3931 = A) in
                                    (
                                        {4421}if v_4424 then
                                        (
                                            {4422}let pkSess_4425: bitstring = pub(skA) in
                                            {4423}in(c, =GetEndpointRequest);
                                            {4424}new SP_4426: bitstring;
                                            {4425}new UP_4427: bitstring;
                                            {4426}out(c, (GetEndpointResponse,pkSess_4425,None,SP_4426,UP_4427))
                                        )
                                        else
                                            {4427}let v_4428: bool = (Sess_3931 = B) in
                                            (
                                                {4428}if v_4428 then
                                                (
                                                    {4429}let pkSess_4429: bitstring = pub(skB) in
                                                    {4430}in(c, =GetEndpointRequest);
                                                    {4431}new SP_4430: bitstring;
                                                    {4432}new UP_4431: bitstring;
                                                    {4433}out(c, (GetEndpointResponse,pkSess_4429,None,SP_4430,UP_4431))
                                                )
                                                else
                                                    {4434}let v_4432: bool = (Sess_3931 = C) in
                                                    (
                                                        {4435}if v_4432 then
                                                        (
                                                            {4436}let pkSess_4433: bitstring = pub(skC) in
                                                            {4437}in(c, =GetEndpointRequest);
                                                            {4438}new SP_4434: bitstring;
                                                            {4439}new UP_4435: bitstring;
                                                            {4440}out(c, (GetEndpointResponse,pkSess_4433,None,SP_4434,UP_4435))
                                                        )
                                                        else
                                                            {4441}let pkSess_4436: bitstring = pub(sk(Sess_3931)) in
                                                            {4442}in(c, =GetEndpointRequest);
                                                            {4443}new SP_4437: bitstring;
                                                            {4444}new UP_4438: bitstring;
                                                            {4445}out(c, (GetEndpointResponse,pkSess_4436,None,SP_4437,UP_4438))
                                                    )
                                                    else
                                                        {4446}let pkSess_4439: bitstring = fail-any in
                                                        {4447}in(c, =GetEndpointRequest);
                                                        {4448}new SP_4440: bitstring;
                                                        {4449}new UP_4441: bitstring;
                                                        {4450}out(c, (GetEndpointResponse,pkSess_4439,None,SP_4440,UP_4441))
                                            )
                                            else
                                                {4451}let pkSess_4442: bitstring = fail-any in
                                                {4452}in(c, =GetEndpointRequest);
                                                {4453}new SP_4443: bitstring;
                                                {4454}new UP_4444: bitstring;
                                                {4455}out(c, (GetEndpointResponse,pkSess_4442,None,SP_4443,UP_4444))
                                    )
                                    else
                                        {4456}let pkSess_4445: bitstring = fail-any in
                                        {4457}in(c, =GetEndpointRequest);
                                        {4458}new SP_4446: bitstring;
                                        {4459}new UP_4447: bitstring;
                                        {4460}out(c, (GetEndpointResponse,pkSess_4445,None,SP_4446,UP_4447))
                        )
                        else
                            {4461}let pkCli_4448: bitstring = fail-any in
                            {4462}let v_4449: bool = (Sess_3931 = A) in
                            (
                                {4463}if v_4449 then
                                (
                                    {4464}let pkSess_4450: bitstring = pub(skA) in
                                    {4465}in(c, =GetEndpointRequest);
                                    {4466}new SP_4451: bitstring;
                                    {4467}new UP_4452: bitstring;
                                    {4468}out(c, (GetEndpointResponse,pkSess_4450,None,SP_4451,UP_4452))
                                )
                                else
                                    {4469}let v_4453: bool = (Sess_3931 = B) in
                                    (
                                        {4470}if v_4453 then
                                        (
                                            {4471}let pkSess_4454: bitstring = pub(skB) in
                                            {4472}in(c, =GetEndpointRequest);
                                            {4473}new SP_4455: bitstring;
                                            {4474}new UP_4456: bitstring;
                                            {4475}out(c, (GetEndpointResponse,pkSess_4454,None,SP_4455,UP_4456))
                                        )
                                        else
                                            {4476}let v_4457: bool = (Sess_3931 = C) in
                                            (
                                                {4477}if v_4457 then
                                                (
                                                    {4478}let pkSess_4458: bitstring = pub(skC) in
                                                    {4479}in(c, =GetEndpointRequest);
                                                    {4480}new SP_4459: bitstring;
                                                    {4481}new UP_4460: bitstring;
                                                    {4482}out(c, (GetEndpointResponse,pkSess_4458,None,SP_4459,UP_4460))
                                                )
                                                else
                                                    {4483}let pkSess_4461: bitstring = pub(sk(Sess_3931)) in
                                                    {4484}in(c, =GetEndpointRequest);
                                                    {4485}new SP_4462: bitstring;
                                                    {4486}new UP_4463: bitstring;
                                                    {4487}out(c, (GetEndpointResponse,pkSess_4461,None,SP_4462,UP_4463))
                                            )
                                            else
                                                {4488}let pkSess_4464: bitstring = fail-any in
                                                {4489}in(c, =GetEndpointRequest);
                                                {4490}new SP_4465: bitstring;
                                                {4491}new UP_4466: bitstring;
                                                {4492}out(c, (GetEndpointResponse,pkSess_4464,None,SP_4465,UP_4466))
                                    )
                                    else
                                        {4493}let pkSess_4467: bitstring = fail-any in
                                        {4494}in(c, =GetEndpointRequest);
                                        {4495}new SP_4468: bitstring;
                                        {4496}new UP_4469: bitstring;
                                        {4497}out(c, (GetEndpointResponse,pkSess_4467,None,SP_4468,UP_4469))
                            )
                            else
                                {4498}let pkSess_4470: bitstring = fail-any in
                                {4499}in(c, =GetEndpointRequest);
                                {4500}new SP_4471: bitstring;
                                {4501}new UP_4472: bitstring;
                                {4502}out(c, (GetEndpointResponse,pkSess_4470,None,SP_4471,UP_4472))
                    )
                    else
                        {4503}let skDisco_4473: bitstring = fail-any in
                        {4504}let pkDisco_4474: bitstring = pub(skDisco_4473) in
                        {4505}let v_4475: bool = (Cli_3929 = A) in
                        (
                            {4506}if v_4475 then
                            (
                                {4507}let pkCli_4476: bitstring = pub(skA) in
                                {4508}let v_4477: bool = (Sess_3931 = A) in
                                (
                                    {4509}if v_4477 then
                                    (
                                        {4510}let pkSess_4478: bitstring = pub(skA) in
                                        {4511}in(c, =GetEndpointRequest);
                                        {4512}new SP_4479: bitstring;
                                        {4513}new UP_4480: bitstring;
                                        {4514}out(c, (GetEndpointResponse,pkSess_4478,None,SP_4479,UP_4480))
                                    )
                                    else
                                        {4515}let v_4481: bool = (Sess_3931 = B) in
                                        (
                                            {4516}if v_4481 then
                                            (
                                                {4517}let pkSess_4482: bitstring = pub(skB) in
                                                {4518}in(c, =GetEndpointRequest);
                                                {4519}new SP_4483: bitstring;
                                                {4520}new UP_4484: bitstring;
                                                {4521}out(c, (GetEndpointResponse,pkSess_4482,None,SP_4483,UP_4484))
                                            )
                                            else
                                                {4522}let v_4485: bool = (Sess_3931 = C) in
                                                (
                                                    {4523}if v_4485 then
                                                    (
                                                        {4524}let pkSess_4486: bitstring = pub(skC) in
                                                        {4525}in(c, =GetEndpointRequest);
                                                        {4526}new SP_4487: bitstring;
                                                        {4527}new UP_4488: bitstring;
                                                        {4528}out(c, (GetEndpointResponse,pkSess_4486,None,SP_4487,UP_4488))
                                                    )
                                                    else
                                                        {4529}let pkSess_4489: bitstring = pub(sk(Sess_3931)) in
                                                        {4530}in(c, =GetEndpointRequest);
                                                        {4531}new SP_4490: bitstring;
                                                        {4532}new UP_4491: bitstring;
                                                        {4533}out(c, (GetEndpointResponse,pkSess_4489,None,SP_4490,UP_4491))
                                                )
                                                else
                                                    {4534}let pkSess_4492: bitstring = fail-any in
                                                    {4535}in(c, =GetEndpointRequest);
                                                    {4536}new SP_4493: bitstring;
                                                    {4537}new UP_4494: bitstring;
                                                    {4538}out(c, (GetEndpointResponse,pkSess_4492,None,SP_4493,UP_4494))
                                        )
                                        else
                                            {4539}let pkSess_4495: bitstring = fail-any in
                                            {4540}in(c, =GetEndpointRequest);
                                            {4541}new SP_4496: bitstring;
                                            {4542}new UP_4497: bitstring;
                                            {4543}out(c, (GetEndpointResponse,pkSess_4495,None,SP_4496,UP_4497))
                                )
                                else
                                    {4544}let pkSess_4498: bitstring = fail-any in
                                    {4545}in(c, =GetEndpointRequest);
                                    {4546}new SP_4499: bitstring;
                                    {4547}new UP_4500: bitstring;
                                    {4548}out(c, (GetEndpointResponse,pkSess_4498,None,SP_4499,UP_4500))
                            )
                            else
                                {4549}let v_4501: bool = (Cli_3929 = B) in
                                (
                                    {4550}if v_4501 then
                                    (
                                        {4551}let pkCli_4502: bitstring = pub(skB) in
                                        {4552}let v_4503: bool = (Sess_3931 = A) in
                                        (
                                            {4553}if v_4503 then
                                            (
                                                {4554}let pkSess_4504: bitstring = pub(skA) in
                                                {4555}in(c, =GetEndpointRequest);
                                                {4556}new SP_4505: bitstring;
                                                {4557}new UP_4506: bitstring;
                                                {4558}out(c, (GetEndpointResponse,pkSess_4504,None,SP_4505,UP_4506))
                                            )
                                            else
                                                {4559}let v_4507: bool = (Sess_3931 = B) in
                                                (
                                                    {4560}if v_4507 then
                                                    (
                                                        {4561}let pkSess_4508: bitstring = pub(skB) in
                                                        {4562}in(c, =GetEndpointRequest);
                                                        {4563}new SP_4509: bitstring;
                                                        {4564}new UP_4510: bitstring;
                                                        {4565}out(c, (GetEndpointResponse,pkSess_4508,None,SP_4509,UP_4510))
                                                    )
                                                    else
                                                        {4566}let v_4511: bool = (Sess_3931 = C) in
                                                        (
                                                            {4567}if v_4511 then
                                                            (
                                                                {4568}let pkSess_4512: bitstring = pub(skC) in
                                                                {4569}in(c, =GetEndpointRequest);
                                                                {4570}new SP_4513: bitstring;
                                                                {4571}new UP_4514: bitstring;
                                                                {4572}out(c, (GetEndpointResponse,pkSess_4512,None,SP_4513,UP_4514))
                                                            )
                                                            else
                                                                {4573}let pkSess_4515: bitstring = pub(sk(Sess_3931)) in
                                                                {4574}in(c, =GetEndpointRequest);
                                                                {4575}new SP_4516: bitstring;
                                                                {4576}new UP_4517: bitstring;
                                                                {4577}out(c, (GetEndpointResponse,pkSess_4515,None,SP_4516,UP_4517))
                                                        )
                                                        else
                                                            {4578}let pkSess_4518: bitstring = fail-any in
                                                            {4579}in(c, =GetEndpointRequest);
                                                            {4580}new SP_4519: bitstring;
                                                            {4581}new UP_4520: bitstring;
                                                            {4582}out(c, (GetEndpointResponse,pkSess_4518,None,SP_4519,UP_4520))
                                                )
                                                else
                                                    {4583}let pkSess_4521: bitstring = fail-any in
                                                    {4584}in(c, =GetEndpointRequest);
                                                    {4585}new SP_4522: bitstring;
                                                    {4586}new UP_4523: bitstring;
                                                    {4587}out(c, (GetEndpointResponse,pkSess_4521,None,SP_4522,UP_4523))
                                        )
                                        else
                                            {4588}let pkSess_4524: bitstring = fail-any in
                                            {4589}in(c, =GetEndpointRequest);
                                            {4590}new SP_4525: bitstring;
                                            {4591}new UP_4526: bitstring;
                                            {4592}out(c, (GetEndpointResponse,pkSess_4524,None,SP_4525,UP_4526))
                                    )
                                    else
                                        {4593}let v_4527: bool = (Cli_3929 = C) in
                                        (
                                            {4594}if v_4527 then
                                            (
                                                {4595}let pkCli_4528: bitstring = pub(skC) in
                                                {4596}let v_4529: bool = (Sess_3931 = A) in
                                                (
                                                    {4597}if v_4529 then
                                                    (
                                                        {4598}let pkSess_4530: bitstring = pub(skA) in
                                                        {4599}in(c, =GetEndpointRequest);
                                                        {4600}new SP_4531: bitstring;
                                                        {4601}new UP_4532: bitstring;
                                                        {4602}out(c, (GetEndpointResponse,pkSess_4530,None,SP_4531,UP_4532))
                                                    )
                                                    else
                                                        {4603}let v_4533: bool = (Sess_3931 = B) in
                                                        (
                                                            {4604}if v_4533 then
                                                            (
                                                                {4605}let pkSess_4534: bitstring = pub(skB) in
                                                                {4606}in(c, =GetEndpointRequest);
                                                                {4607}new SP_4535: bitstring;
                                                                {4608}new UP_4536: bitstring;
                                                                {4609}out(c, (GetEndpointResponse,pkSess_4534,None,SP_4535,UP_4536))
                                                            )
                                                            else
                                                                {4610}let v_4537: bool = (Sess_3931 = C) in
                                                                (
                                                                    {4611}if v_4537 then
                                                                    (
                                                                        {4612}let pkSess_4538: bitstring = pub(skC) in
                                                                        {4613}in(c, =GetEndpointRequest);
                                                                        {4614}new SP_4539: bitstring;
                                                                        {4615}new UP_4540: bitstring;
                                                                        {4616}out(c, (GetEndpointResponse,pkSess_4538,None,SP_4539,UP_4540))
                                                                    )
                                                                    else
                                                                        {4617}let pkSess_4541: bitstring = pub(sk(Sess_3931)) in
                                                                        {4618}in(c, =GetEndpointRequest);
                                                                        {4619}new SP_4542: bitstring;
                                                                        {4620}new UP_4543: bitstring;
                                                                        {4621}out(c, (GetEndpointResponse,pkSess_4541,None,SP_4542,UP_4543))
                                                                )
                                                                else
                                                                    {4622}let pkSess_4544: bitstring = fail-any in
                                                                    {4623}in(c, =GetEndpointRequest);
                                                                    {4624}new SP_4545: bitstring;
                                                                    {4625}new UP_4546: bitstring;
                                                                    {4626}out(c, (GetEndpointResponse,pkSess_4544,None,SP_4545,UP_4546))
                                                        )
                                                        else
                                                            {4627}let pkSess_4547: bitstring = fail-any in
                                                            {4628}in(c, =GetEndpointRequest);
                                                            {4629}new SP_4548: bitstring;
                                                            {4630}new UP_4549: bitstring;
                                                            {4631}out(c, (GetEndpointResponse,pkSess_4547,None,SP_4548,UP_4549))
                                                )
                                                else
                                                    {4632}let pkSess_4550: bitstring = fail-any in
                                                    {4633}in(c, =GetEndpointRequest);
                                                    {4634}new SP_4551: bitstring;
                                                    {4635}new UP_4552: bitstring;
                                                    {4636}out(c, (GetEndpointResponse,pkSess_4550,None,SP_4551,UP_4552))
                                            )
                                            else
                                                {4637}let pkCli_4553: bitstring = pub(sk(Cli_3929)) in
                                                {4638}let v_4554: bool = (Sess_3931 = A) in
                                                (
                                                    {4639}if v_4554 then
                                                    (
                                                        {4640}let pkSess_4555: bitstring = pub(skA) in
                                                        {4641}in(c, =GetEndpointRequest);
                                                        {4642}new SP_4556: bitstring;
                                                        {4643}new UP_4557: bitstring;
                                                        {4644}out(c, (GetEndpointResponse,pkSess_4555,None,SP_4556,UP_4557))
                                                    )
                                                    else
                                                        {4645}let v_4558: bool = (Sess_3931 = B) in
                                                        (
                                                            {4646}if v_4558 then
                                                            (
                                                                {4647}let pkSess_4559: bitstring = pub(skB) in
                                                                {4648}in(c, =GetEndpointRequest);
                                                                {4649}new SP_4560: bitstring;
                                                                {4650}new UP_4561: bitstring;
                                                                {4651}out(c, (GetEndpointResponse,pkSess_4559,None,SP_4560,UP_4561))
                                                            )
                                                            else
                                                                {4652}let v_4562: bool = (Sess_3931 = C) in
                                                                (
                                                                    {4653}if v_4562 then
                                                                    (
                                                                        {4654}let pkSess_4563: bitstring = pub(skC) in
                                                                        {4655}in(c, =GetEndpointRequest);
                                                                        {4656}new SP_4564: bitstring;
                                                                        {4657}new UP_4565: bitstring;
                                                                        {4658}out(c, (GetEndpointResponse,pkSess_4563,None,SP_4564,UP_4565))
                                                                    )
                                                                    else
                                                                        {4659}let pkSess_4566: bitstring = pub(sk(Sess_3931)) in
                                                                        {4660}in(c, =GetEndpointRequest);
                                                                        {4661}new SP_4567: bitstring;
                                                                        {4662}new UP_4568: bitstring;
                                                                        {4663}out(c, (GetEndpointResponse,pkSess_4566,None,SP_4567,UP_4568))
                                                                )
                                                                else
                                                                    {4664}let pkSess_4569: bitstring = fail-any in
                                                                    {4665}in(c, =GetEndpointRequest);
                                                                    {4666}new SP_4570: bitstring;
                                                                    {4667}new UP_4571: bitstring;
                                                                    {4668}out(c, (GetEndpointResponse,pkSess_4569,None,SP_4570,UP_4571))
                                                        )
                                                        else
                                                            {4669}let pkSess_4572: bitstring = fail-any in
                                                            {4670}in(c, =GetEndpointRequest);
                                                            {4671}new SP_4573: bitstring;
                                                            {4672}new UP_4574: bitstring;
                                                            {4673}out(c, (GetEndpointResponse,pkSess_4572,None,SP_4573,UP_4574))
                                                )
                                                else
                                                    {4674}let pkSess_4575: bitstring = fail-any in
                                                    {4675}in(c, =GetEndpointRequest);
                                                    {4676}new SP_4576: bitstring;
                                                    {4677}new UP_4577: bitstring;
                                                    {4678}out(c, (GetEndpointResponse,pkSess_4575,None,SP_4576,UP_4577))
                                        )
                                        else
                                            {4679}let pkCli_4578: bitstring = fail-any in
                                            {4680}let v_4579: bool = (Sess_3931 = A) in
                                            (
                                                {4681}if v_4579 then
                                                (
                                                    {4682}let pkSess_4580: bitstring = pub(skA) in
                                                    {4683}in(c, =GetEndpointRequest);
                                                    {4684}new SP_4581: bitstring;
                                                    {4685}new UP_4582: bitstring;
                                                    {4686}out(c, (GetEndpointResponse,pkSess_4580,None,SP_4581,UP_4582))
                                                )
                                                else
                                                    {4687}let v_4583: bool = (Sess_3931 = B) in
                                                    (
                                                        {4688}if v_4583 then
                                                        (
                                                            {4689}let pkSess_4584: bitstring = pub(skB) in
                                                            {4690}in(c, =GetEndpointRequest);
                                                            {4691}new SP_4585: bitstring;
                                                            {4692}new UP_4586: bitstring;
                                                            {4693}out(c, (GetEndpointResponse,pkSess_4584,None,SP_4585,UP_4586))
                                                        )
                                                        else
                                                            {4694}let v_4587: bool = (Sess_3931 = C) in
                                                            (
                                                                {4695}if v_4587 then
                                                                (
                                                                    {4696}let pkSess_4588: bitstring = pub(skC) in
                                                                    {4697}in(c, =GetEndpointRequest);
                                                                    {4698}new SP_4589: bitstring;
                                                                    {4699}new UP_4590: bitstring;
                                                                    {4700}out(c, (GetEndpointResponse,pkSess_4588,None,SP_4589,UP_4590))
                                                                )
                                                                else
                                                                    {4701}let pkSess_4591: bitstring = pub(sk(Sess_3931)) in
                                                                    {4702}in(c, =GetEndpointRequest);
                                                                    {4703}new SP_4592: bitstring;
                                                                    {4704}new UP_4593: bitstring;
                                                                    {4705}out(c, (GetEndpointResponse,pkSess_4591,None,SP_4592,UP_4593))
                                                            )
                                                            else
                                                                {4706}let pkSess_4594: bitstring = fail-any in
                                                                {4707}in(c, =GetEndpointRequest);
                                                                {4708}new SP_4595: bitstring;
                                                                {4709}new UP_4596: bitstring;
                                                                {4710}out(c, (GetEndpointResponse,pkSess_4594,None,SP_4595,UP_4596))
                                                    )
                                                    else
                                                        {4711}let pkSess_4597: bitstring = fail-any in
                                                        {4712}in(c, =GetEndpointRequest);
                                                        {4713}new SP_4598: bitstring;
                                                        {4714}new UP_4599: bitstring;
                                                        {4715}out(c, (GetEndpointResponse,pkSess_4597,None,SP_4598,UP_4599))
                                            )
                                            else
                                                {4716}let pkSess_4600: bitstring = fail-any in
                                                {4717}in(c, =GetEndpointRequest);
                                                {4718}new SP_4601: bitstring;
                                                {4719}new UP_4602: bitstring;
                                                {4720}out(c, (GetEndpointResponse,pkSess_4600,None,SP_4601,UP_4602))
                                )
                                else
                                    {4721}let pkCli_4603: bitstring = fail-any in
                                    {4722}let v_4604: bool = (Sess_3931 = A) in
                                    (
                                        {4723}if v_4604 then
                                        (
                                            {4724}let pkSess_4605: bitstring = pub(skA) in
                                            {4725}in(c, =GetEndpointRequest);
                                            {4726}new SP_4606: bitstring;
                                            {4727}new UP_4607: bitstring;
                                            {4728}out(c, (GetEndpointResponse,pkSess_4605,None,SP_4606,UP_4607))
                                        )
                                        else
                                            {4729}let v_4608: bool = (Sess_3931 = B) in
                                            (
                                                {4730}if v_4608 then
                                                (
                                                    {4731}let pkSess_4609: bitstring = pub(skB) in
                                                    {4732}in(c, =GetEndpointRequest);
                                                    {4733}new SP_4610: bitstring;
                                                    {4734}new UP_4611: bitstring;
                                                    {4735}out(c, (GetEndpointResponse,pkSess_4609,None,SP_4610,UP_4611))
                                                )
                                                else
                                                    {4736}let v_4612: bool = (Sess_3931 = C) in
                                                    (
                                                        {4737}if v_4612 then
                                                        (
                                                            {4738}let pkSess_4613: bitstring = pub(skC) in
                                                            {4739}in(c, =GetEndpointRequest);
                                                            {4740}new SP_4614: bitstring;
                                                            {4741}new UP_4615: bitstring;
                                                            {4742}out(c, (GetEndpointResponse,pkSess_4613,None,SP_4614,UP_4615))
                                                        )
                                                        else
                                                            {4743}let pkSess_4616: bitstring = pub(sk(Sess_3931)) in
                                                            {4744}in(c, =GetEndpointRequest);
                                                            {4745}new SP_4617: bitstring;
                                                            {4746}new UP_4618: bitstring;
                                                            {4747}out(c, (GetEndpointResponse,pkSess_4616,None,SP_4617,UP_4618))
                                                    )
                                                    else
                                                        {4748}let pkSess_4619: bitstring = fail-any in
                                                        {4749}in(c, =GetEndpointRequest);
                                                        {4750}new SP_4620: bitstring;
                                                        {4751}new UP_4621: bitstring;
                                                        {4752}out(c, (GetEndpointResponse,pkSess_4619,None,SP_4620,UP_4621))
                                            )
                                            else
                                                {4753}let pkSess_4622: bitstring = fail-any in
                                                {4754}in(c, =GetEndpointRequest);
                                                {4755}new SP_4623: bitstring;
                                                {4756}new UP_4624: bitstring;
                                                {4757}out(c, (GetEndpointResponse,pkSess_4622,None,SP_4623,UP_4624))
                                    )
                                    else
                                        {4758}let pkSess_4625: bitstring = fail-any in
                                        {4759}in(c, =GetEndpointRequest);
                                        {4760}new SP_4626: bitstring;
                                        {4761}new UP_4627: bitstring;
                                        {4762}out(c, (GetEndpointResponse,pkSess_4625,None,SP_4626,UP_4627))
                        )
                        else
                            {4763}let pkCli_4628: bitstring = fail-any in
                            {4764}let v_4629: bool = (Sess_3931 = A) in
                            (
                                {4765}if v_4629 then
                                (
                                    {4766}let pkSess_4630: bitstring = pub(skA) in
                                    {4767}in(c, =GetEndpointRequest);
                                    {4768}new SP_4631: bitstring;
                                    {4769}new UP_4632: bitstring;
                                    {4770}out(c, (GetEndpointResponse,pkSess_4630,None,SP_4631,UP_4632))
                                )
                                else
                                    {4771}let v_4633: bool = (Sess_3931 = B) in
                                    (
                                        {4772}if v_4633 then
                                        (
                                            {4773}let pkSess_4634: bitstring = pub(skB) in
                                            {4774}in(c, =GetEndpointRequest);
                                            {4775}new SP_4635: bitstring;
                                            {4776}new UP_4636: bitstring;
                                            {4777}out(c, (GetEndpointResponse,pkSess_4634,None,SP_4635,UP_4636))
                                        )
                                        else
                                            {4778}let v_4637: bool = (Sess_3931 = C) in
                                            (
                                                {4779}if v_4637 then
                                                (
                                                    {4780}let pkSess_4638: bitstring = pub(skC) in
                                                    {4781}in(c, =GetEndpointRequest);
                                                    {4782}new SP_4639: bitstring;
                                                    {4783}new UP_4640: bitstring;
                                                    {4784}out(c, (GetEndpointResponse,pkSess_4638,None,SP_4639,UP_4640))
                                                )
                                                else
                                                    {4785}let pkSess_4641: bitstring = pub(sk(Sess_3931)) in
                                                    {4786}in(c, =GetEndpointRequest);
                                                    {4787}new SP_4642: bitstring;
                                                    {4788}new UP_4643: bitstring;
                                                    {4789}out(c, (GetEndpointResponse,pkSess_4641,None,SP_4642,UP_4643))
                                            )
                                            else
                                                {4790}let pkSess_4644: bitstring = fail-any in
                                                {4791}in(c, =GetEndpointRequest);
                                                {4792}new SP_4645: bitstring;
                                                {4793}new UP_4646: bitstring;
                                                {4794}out(c, (GetEndpointResponse,pkSess_4644,None,SP_4645,UP_4646))
                                    )
                                    else
                                        {4795}let pkSess_4647: bitstring = fail-any in
                                        {4796}in(c, =GetEndpointRequest);
                                        {4797}new SP_4648: bitstring;
                                        {4798}new UP_4649: bitstring;
                                        {4799}out(c, (GetEndpointResponse,pkSess_4647,None,SP_4648,UP_4649))
                            )
                            else
                                {4800}let pkSess_4650: bitstring = fail-any in
                                {4801}in(c, =GetEndpointRequest);
                                {4802}new SP_4651: bitstring;
                                {4803}new UP_4652: bitstring;
                                {4804}out(c, (GetEndpointResponse,pkSess_4650,None,SP_4651,UP_4652))
            )
            else
                {4805}let skDisco_4653: bitstring = fail-any in
                {4806}let pkDisco_4654: bitstring = pub(skDisco_4653) in
                {4807}let v_4655: bool = (Cli_3929 = A) in
                (
                    {4808}if v_4655 then
                    (
                        {4809}let pkCli_4656: bitstring = pub(skA) in
                        {4810}let v_4657: bool = (Sess_3931 = A) in
                        (
                            {4811}if v_4657 then
                            (
                                {4812}let pkSess_4658: bitstring = pub(skA) in
                                {4813}in(c, =GetEndpointRequest);
                                {4814}new SP_4659: bitstring;
                                {4815}new UP_4660: bitstring;
                                {4816}out(c, (GetEndpointResponse,pkSess_4658,None,SP_4659,UP_4660))
                            )
                            else
                                {4817}let v_4661: bool = (Sess_3931 = B) in
                                (
                                    {4818}if v_4661 then
                                    (
                                        {4819}let pkSess_4662: bitstring = pub(skB) in
                                        {4820}in(c, =GetEndpointRequest);
                                        {4821}new SP_4663: bitstring;
                                        {4822}new UP_4664: bitstring;
                                        {4823}out(c, (GetEndpointResponse,pkSess_4662,None,SP_4663,UP_4664))
                                    )
                                    else
                                        {4824}let v_4665: bool = (Sess_3931 = C) in
                                        (
                                            {4825}if v_4665 then
                                            (
                                                {4826}let pkSess_4666: bitstring = pub(skC) in
                                                {4827}in(c, =GetEndpointRequest);
                                                {4828}new SP_4667: bitstring;
                                                {4829}new UP_4668: bitstring;
                                                {4830}out(c, (GetEndpointResponse,pkSess_4666,None,SP_4667,UP_4668))
                                            )
                                            else
                                                {4831}let pkSess_4669: bitstring = pub(sk(Sess_3931)) in
                                                {4832}in(c, =GetEndpointRequest);
                                                {4833}new SP_4670: bitstring;
                                                {4834}new UP_4671: bitstring;
                                                {4835}out(c, (GetEndpointResponse,pkSess_4669,None,SP_4670,UP_4671))
                                        )
                                        else
                                            {4836}let pkSess_4672: bitstring = fail-any in
                                            {4837}in(c, =GetEndpointRequest);
                                            {4838}new SP_4673: bitstring;
                                            {4839}new UP_4674: bitstring;
                                            {4840}out(c, (GetEndpointResponse,pkSess_4672,None,SP_4673,UP_4674))
                                )
                                else
                                    {4841}let pkSess_4675: bitstring = fail-any in
                                    {4842}in(c, =GetEndpointRequest);
                                    {4843}new SP_4676: bitstring;
                                    {4844}new UP_4677: bitstring;
                                    {4845}out(c, (GetEndpointResponse,pkSess_4675,None,SP_4676,UP_4677))
                        )
                        else
                            {4846}let pkSess_4678: bitstring = fail-any in
                            {4847}in(c, =GetEndpointRequest);
                            {4848}new SP_4679: bitstring;
                            {4849}new UP_4680: bitstring;
                            {4850}out(c, (GetEndpointResponse,pkSess_4678,None,SP_4679,UP_4680))
                    )
                    else
                        {4851}let v_4681: bool = (Cli_3929 = B) in
                        (
                            {4852}if v_4681 then
                            (
                                {4853}let pkCli_4682: bitstring = pub(skB) in
                                {4854}let v_4683: bool = (Sess_3931 = A) in
                                (
                                    {4855}if v_4683 then
                                    (
                                        {4856}let pkSess_4684: bitstring = pub(skA) in
                                        {4857}in(c, =GetEndpointRequest);
                                        {4858}new SP_4685: bitstring;
                                        {4859}new UP_4686: bitstring;
                                        {4860}out(c, (GetEndpointResponse,pkSess_4684,None,SP_4685,UP_4686))
                                    )
                                    else
                                        {4861}let v_4687: bool = (Sess_3931 = B) in
                                        (
                                            {4862}if v_4687 then
                                            (
                                                {4863}let pkSess_4688: bitstring = pub(skB) in
                                                {4864}in(c, =GetEndpointRequest);
                                                {4865}new SP_4689: bitstring;
                                                {4866}new UP_4690: bitstring;
                                                {4867}out(c, (GetEndpointResponse,pkSess_4688,None,SP_4689,UP_4690))
                                            )
                                            else
                                                {4868}let v_4691: bool = (Sess_3931 = C) in
                                                (
                                                    {4869}if v_4691 then
                                                    (
                                                        {4870}let pkSess_4692: bitstring = pub(skC) in
                                                        {4871}in(c, =GetEndpointRequest);
                                                        {4872}new SP_4693: bitstring;
                                                        {4873}new UP_4694: bitstring;
                                                        {4874}out(c, (GetEndpointResponse,pkSess_4692,None,SP_4693,UP_4694))
                                                    )
                                                    else
                                                        {4875}let pkSess_4695: bitstring = pub(sk(Sess_3931)) in
                                                        {4876}in(c, =GetEndpointRequest);
                                                        {4877}new SP_4696: bitstring;
                                                        {4878}new UP_4697: bitstring;
                                                        {4879}out(c, (GetEndpointResponse,pkSess_4695,None,SP_4696,UP_4697))
                                                )
                                                else
                                                    {4880}let pkSess_4698: bitstring = fail-any in
                                                    {4881}in(c, =GetEndpointRequest);
                                                    {4882}new SP_4699: bitstring;
                                                    {4883}new UP_4700: bitstring;
                                                    {4884}out(c, (GetEndpointResponse,pkSess_4698,None,SP_4699,UP_4700))
                                        )
                                        else
                                            {4885}let pkSess_4701: bitstring = fail-any in
                                            {4886}in(c, =GetEndpointRequest);
                                            {4887}new SP_4702: bitstring;
                                            {4888}new UP_4703: bitstring;
                                            {4889}out(c, (GetEndpointResponse,pkSess_4701,None,SP_4702,UP_4703))
                                )
                                else
                                    {4890}let pkSess_4704: bitstring = fail-any in
                                    {4891}in(c, =GetEndpointRequest);
                                    {4892}new SP_4705: bitstring;
                                    {4893}new UP_4706: bitstring;
                                    {4894}out(c, (GetEndpointResponse,pkSess_4704,None,SP_4705,UP_4706))
                            )
                            else
                                {4895}let v_4707: bool = (Cli_3929 = C) in
                                (
                                    {4896}if v_4707 then
                                    (
                                        {4897}let pkCli_4708: bitstring = pub(skC) in
                                        {4898}let v_4709: bool = (Sess_3931 = A) in
                                        (
                                            {4899}if v_4709 then
                                            (
                                                {4900}let pkSess_4710: bitstring = pub(skA) in
                                                {4901}in(c, =GetEndpointRequest);
                                                {4902}new SP_4711: bitstring;
                                                {4903}new UP_4712: bitstring;
                                                {4904}out(c, (GetEndpointResponse,pkSess_4710,None,SP_4711,UP_4712))
                                            )
                                            else
                                                {4905}let v_4713: bool = (Sess_3931 = B) in
                                                (
                                                    {4906}if v_4713 then
                                                    (
                                                        {4907}let pkSess_4714: bitstring = pub(skB) in
                                                        {4908}in(c, =GetEndpointRequest);
                                                        {4909}new SP_4715: bitstring;
                                                        {4910}new UP_4716: bitstring;
                                                        {4911}out(c, (GetEndpointResponse,pkSess_4714,None,SP_4715,UP_4716))
                                                    )
                                                    else
                                                        {4912}let v_4717: bool = (Sess_3931 = C) in
                                                        (
                                                            {4913}if v_4717 then
                                                            (
                                                                {4914}let pkSess_4718: bitstring = pub(skC) in
                                                                {4915}in(c, =GetEndpointRequest);
                                                                {4916}new SP_4719: bitstring;
                                                                {4917}new UP_4720: bitstring;
                                                                {4918}out(c, (GetEndpointResponse,pkSess_4718,None,SP_4719,UP_4720))
                                                            )
                                                            else
                                                                {4919}let pkSess_4721: bitstring = pub(sk(Sess_3931)) in
                                                                {4920}in(c, =GetEndpointRequest);
                                                                {4921}new SP_4722: bitstring;
                                                                {4922}new UP_4723: bitstring;
                                                                {4923}out(c, (GetEndpointResponse,pkSess_4721,None,SP_4722,UP_4723))
                                                        )
                                                        else
                                                            {4924}let pkSess_4724: bitstring = fail-any in
                                                            {4925}in(c, =GetEndpointRequest);
                                                            {4926}new SP_4725: bitstring;
                                                            {4927}new UP_4726: bitstring;
                                                            {4928}out(c, (GetEndpointResponse,pkSess_4724,None,SP_4725,UP_4726))
                                                )
                                                else
                                                    {4929}let pkSess_4727: bitstring = fail-any in
                                                    {4930}in(c, =GetEndpointRequest);
                                                    {4931}new SP_4728: bitstring;
                                                    {4932}new UP_4729: bitstring;
                                                    {4933}out(c, (GetEndpointResponse,pkSess_4727,None,SP_4728,UP_4729))
                                        )
                                        else
                                            {4934}let pkSess_4730: bitstring = fail-any in
                                            {4935}in(c, =GetEndpointRequest);
                                            {4936}new SP_4731: bitstring;
                                            {4937}new UP_4732: bitstring;
                                            {4938}out(c, (GetEndpointResponse,pkSess_4730,None,SP_4731,UP_4732))
                                    )
                                    else
                                        {4939}let pkCli_4733: bitstring = pub(sk(Cli_3929)) in
                                        {4940}let v_4734: bool = (Sess_3931 = A) in
                                        (
                                            {4941}if v_4734 then
                                            (
                                                {4942}let pkSess_4735: bitstring = pub(skA) in
                                                {4943}in(c, =GetEndpointRequest);
                                                {4944}new SP_4736: bitstring;
                                                {4945}new UP_4737: bitstring;
                                                {4946}out(c, (GetEndpointResponse,pkSess_4735,None,SP_4736,UP_4737))
                                            )
                                            else
                                                {4947}let v_4738: bool = (Sess_3931 = B) in
                                                (
                                                    {4948}if v_4738 then
                                                    (
                                                        {4949}let pkSess_4739: bitstring = pub(skB) in
                                                        {4950}in(c, =GetEndpointRequest);
                                                        {4951}new SP_4740: bitstring;
                                                        {4952}new UP_4741: bitstring;
                                                        {4953}out(c, (GetEndpointResponse,pkSess_4739,None,SP_4740,UP_4741))
                                                    )
                                                    else
                                                        {4954}let v_4742: bool = (Sess_3931 = C) in
                                                        (
                                                            {4955}if v_4742 then
                                                            (
                                                                {4956}let pkSess_4743: bitstring = pub(skC) in
                                                                {4957}in(c, =GetEndpointRequest);
                                                                {4958}new SP_4744: bitstring;
                                                                {4959}new UP_4745: bitstring;
                                                                {4960}out(c, (GetEndpointResponse,pkSess_4743,None,SP_4744,UP_4745))
                                                            )
                                                            else
                                                                {4961}let pkSess_4746: bitstring = pub(sk(Sess_3931)) in
                                                                {4962}in(c, =GetEndpointRequest);
                                                                {4963}new SP_4747: bitstring;
                                                                {4964}new UP_4748: bitstring;
                                                                {4965}out(c, (GetEndpointResponse,pkSess_4746,None,SP_4747,UP_4748))
                                                        )
                                                        else
                                                            {4966}let pkSess_4749: bitstring = fail-any in
                                                            {4967}in(c, =GetEndpointRequest);
                                                            {4968}new SP_4750: bitstring;
                                                            {4969}new UP_4751: bitstring;
                                                            {4970}out(c, (GetEndpointResponse,pkSess_4749,None,SP_4750,UP_4751))
                                                )
                                                else
                                                    {4971}let pkSess_4752: bitstring = fail-any in
                                                    {4972}in(c, =GetEndpointRequest);
                                                    {4973}new SP_4753: bitstring;
                                                    {4974}new UP_4754: bitstring;
                                                    {4975}out(c, (GetEndpointResponse,pkSess_4752,None,SP_4753,UP_4754))
                                        )
                                        else
                                            {4976}let pkSess_4755: bitstring = fail-any in
                                            {4977}in(c, =GetEndpointRequest);
                                            {4978}new SP_4756: bitstring;
                                            {4979}new UP_4757: bitstring;
                                            {4980}out(c, (GetEndpointResponse,pkSess_4755,None,SP_4756,UP_4757))
                                )
                                else
                                    {4981}let pkCli_4758: bitstring = fail-any in
                                    {4982}let v_4759: bool = (Sess_3931 = A) in
                                    (
                                        {4983}if v_4759 then
                                        (
                                            {4984}let pkSess_4760: bitstring = pub(skA) in
                                            {4985}in(c, =GetEndpointRequest);
                                            {4986}new SP_4761: bitstring;
                                            {4987}new UP_4762: bitstring;
                                            {4988}out(c, (GetEndpointResponse,pkSess_4760,None,SP_4761,UP_4762))
                                        )
                                        else
                                            {4989}let v_4763: bool = (Sess_3931 = B) in
                                            (
                                                {4990}if v_4763 then
                                                (
                                                    {4991}let pkSess_4764: bitstring = pub(skB) in
                                                    {4992}in(c, =GetEndpointRequest);
                                                    {4993}new SP_4765: bitstring;
                                                    {4994}new UP_4766: bitstring;
                                                    {4995}out(c, (GetEndpointResponse,pkSess_4764,None,SP_4765,UP_4766))
                                                )
                                                else
                                                    {4996}let v_4767: bool = (Sess_3931 = C) in
                                                    (
                                                        {4997}if v_4767 then
                                                        (
                                                            {4998}let pkSess_4768: bitstring = pub(skC) in
                                                            {4999}in(c, =GetEndpointRequest);
                                                            {5000}new SP_4769: bitstring;
                                                            {5001}new UP_4770: bitstring;
                                                            {5002}out(c, (GetEndpointResponse,pkSess_4768,None,SP_4769,UP_4770))
                                                        )
                                                        else
                                                            {5003}let pkSess_4771: bitstring = pub(sk(Sess_3931)) in
                                                            {5004}in(c, =GetEndpointRequest);
                                                            {5005}new SP_4772: bitstring;
                                                            {5006}new UP_4773: bitstring;
                                                            {5007}out(c, (GetEndpointResponse,pkSess_4771,None,SP_4772,UP_4773))
                                                    )
                                                    else
                                                        {5008}let pkSess_4774: bitstring = fail-any in
                                                        {5009}in(c, =GetEndpointRequest);
                                                        {5010}new SP_4775: bitstring;
                                                        {5011}new UP_4776: bitstring;
                                                        {5012}out(c, (GetEndpointResponse,pkSess_4774,None,SP_4775,UP_4776))
                                            )
                                            else
                                                {5013}let pkSess_4777: bitstring = fail-any in
                                                {5014}in(c, =GetEndpointRequest);
                                                {5015}new SP_4778: bitstring;
                                                {5016}new UP_4779: bitstring;
                                                {5017}out(c, (GetEndpointResponse,pkSess_4777,None,SP_4778,UP_4779))
                                    )
                                    else
                                        {5018}let pkSess_4780: bitstring = fail-any in
                                        {5019}in(c, =GetEndpointRequest);
                                        {5020}new SP_4781: bitstring;
                                        {5021}new UP_4782: bitstring;
                                        {5022}out(c, (GetEndpointResponse,pkSess_4780,None,SP_4781,UP_4782))
                        )
                        else
                            {5023}let pkCli_4783: bitstring = fail-any in
                            {5024}let v_4784: bool = (Sess_3931 = A) in
                            (
                                {5025}if v_4784 then
                                (
                                    {5026}let pkSess_4785: bitstring = pub(skA) in
                                    {5027}in(c, =GetEndpointRequest);
                                    {5028}new SP_4786: bitstring;
                                    {5029}new UP_4787: bitstring;
                                    {5030}out(c, (GetEndpointResponse,pkSess_4785,None,SP_4786,UP_4787))
                                )
                                else
                                    {5031}let v_4788: bool = (Sess_3931 = B) in
                                    (
                                        {5032}if v_4788 then
                                        (
                                            {5033}let pkSess_4789: bitstring = pub(skB) in
                                            {5034}in(c, =GetEndpointRequest);
                                            {5035}new SP_4790: bitstring;
                                            {5036}new UP_4791: bitstring;
                                            {5037}out(c, (GetEndpointResponse,pkSess_4789,None,SP_4790,UP_4791))
                                        )
                                        else
                                            {5038}let v_4792: bool = (Sess_3931 = C) in
                                            (
                                                {5039}if v_4792 then
                                                (
                                                    {5040}let pkSess_4793: bitstring = pub(skC) in
                                                    {5041}in(c, =GetEndpointRequest);
                                                    {5042}new SP_4794: bitstring;
                                                    {5043}new UP_4795: bitstring;
                                                    {5044}out(c, (GetEndpointResponse,pkSess_4793,None,SP_4794,UP_4795))
                                                )
                                                else
                                                    {5045}let pkSess_4796: bitstring = pub(sk(Sess_3931)) in
                                                    {5046}in(c, =GetEndpointRequest);
                                                    {5047}new SP_4797: bitstring;
                                                    {5048}new UP_4798: bitstring;
                                                    {5049}out(c, (GetEndpointResponse,pkSess_4796,None,SP_4797,UP_4798))
                                            )
                                            else
                                                {5050}let pkSess_4799: bitstring = fail-any in
                                                {5051}in(c, =GetEndpointRequest);
                                                {5052}new SP_4800: bitstring;
                                                {5053}new UP_4801: bitstring;
                                                {5054}out(c, (GetEndpointResponse,pkSess_4799,None,SP_4800,UP_4801))
                                    )
                                    else
                                        {5055}let pkSess_4802: bitstring = fail-any in
                                        {5056}in(c, =GetEndpointRequest);
                                        {5057}new SP_4803: bitstring;
                                        {5058}new UP_4804: bitstring;
                                        {5059}out(c, (GetEndpointResponse,pkSess_4802,None,SP_4803,UP_4804))
                            )
                            else
                                {5060}let pkSess_4805: bitstring = fail-any in
                                {5061}in(c, =GetEndpointRequest);
                                {5062}new SP_4806: bitstring;
                                {5063}new UP_4807: bitstring;
                                {5064}out(c, (GetEndpointResponse,pkSess_4805,None,SP_4806,UP_4807))
                )
                else
                    {5065}let pkCli_4808: bitstring = fail-any in
                    {5066}let v_4809: bool = (Sess_3931 = A) in
                    (
                        {5067}if v_4809 then
                        (
                            {5068}let pkSess_4810: bitstring = pub(skA) in
                            {5069}in(c, =GetEndpointRequest);
                            {5070}new SP_4811: bitstring;
                            {5071}new UP_4812: bitstring;
                            {5072}out(c, (GetEndpointResponse,pkSess_4810,None,SP_4811,UP_4812))
                        )
                        else
                            {5073}let v_4813: bool = (Sess_3931 = B) in
                            (
                                {5074}if v_4813 then
                                (
                                    {5075}let pkSess_4814: bitstring = pub(skB) in
                                    {5076}in(c, =GetEndpointRequest);
                                    {5077}new SP_4815: bitstring;
                                    {5078}new UP_4816: bitstring;
                                    {5079}out(c, (GetEndpointResponse,pkSess_4814,None,SP_4815,UP_4816))
                                )
                                else
                                    {5080}let v_4817: bool = (Sess_3931 = C) in
                                    (
                                        {5081}if v_4817 then
                                        (
                                            {5082}let pkSess_4818: bitstring = pub(skC) in
                                            {5083}in(c, =GetEndpointRequest);
                                            {5084}new SP_4819: bitstring;
                                            {5085}new UP_4820: bitstring;
                                            {5086}out(c, (GetEndpointResponse,pkSess_4818,None,SP_4819,UP_4820))
                                        )
                                        else
                                            {5087}let pkSess_4821: bitstring = pub(sk(Sess_3931)) in
                                            {5088}in(c, =GetEndpointRequest);
                                            {5089}new SP_4822: bitstring;
                                            {5090}new UP_4823: bitstring;
                                            {5091}out(c, (GetEndpointResponse,pkSess_4821,None,SP_4822,UP_4823))
                                    )
                                    else
                                        {5092}let pkSess_4824: bitstring = fail-any in
                                        {5093}in(c, =GetEndpointRequest);
                                        {5094}new SP_4825: bitstring;
                                        {5095}new UP_4826: bitstring;
                                        {5096}out(c, (GetEndpointResponse,pkSess_4824,None,SP_4825,UP_4826))
                            )
                            else
                                {5097}let pkSess_4827: bitstring = fail-any in
                                {5098}in(c, =GetEndpointRequest);
                                {5099}new SP_4828: bitstring;
                                {5100}new UP_4829: bitstring;
                                {5101}out(c, (GetEndpointResponse,pkSess_4827,None,SP_4828,UP_4829))
                    )
                    else
                        {5102}let pkSess_4830: bitstring = fail-any in
                        {5103}in(c, =GetEndpointRequest);
                        {5104}new SP_4831: bitstring;
                        {5105}new UP_4832: bitstring;
                        {5106}out(c, (GetEndpointResponse,pkSess_4830,None,SP_4831,UP_4832))
    )
    else
        {5107}let skDisco_4833: bitstring = fail-any in
        {5108}let pkDisco_4834: bitstring = pub(skDisco_4833) in
        {5109}let v_4835: bool = (Cli_3929 = A) in
        (
            {5110}if v_4835 then
            (
                {5111}let pkCli_4836: bitstring = pub(skA) in
                {5112}let v_4837: bool = (Sess_3931 = A) in
                (
                    {5113}if v_4837 then
                    (
                        {5114}let pkSess_4838: bitstring = pub(skA) in
                        {5115}in(c, =GetEndpointRequest);
                        {5116}new SP_4839: bitstring;
                        {5117}new UP_4840: bitstring;
                        {5118}out(c, (GetEndpointResponse,pkSess_4838,None,SP_4839,UP_4840))
                    )
                    else
                        {5119}let v_4841: bool = (Sess_3931 = B) in
                        (
                            {5120}if v_4841 then
                            (
                                {5121}let pkSess_4842: bitstring = pub(skB) in
                                {5122}in(c, =GetEndpointRequest);
                                {5123}new SP_4843: bitstring;
                                {5124}new UP_4844: bitstring;
                                {5125}out(c, (GetEndpointResponse,pkSess_4842,None,SP_4843,UP_4844))
                            )
                            else
                                {5126}let v_4845: bool = (Sess_3931 = C) in
                                (
                                    {5127}if v_4845 then
                                    (
                                        {5128}let pkSess_4846: bitstring = pub(skC) in
                                        {5129}in(c, =GetEndpointRequest);
                                        {5130}new SP_4847: bitstring;
                                        {5131}new UP_4848: bitstring;
                                        {5132}out(c, (GetEndpointResponse,pkSess_4846,None,SP_4847,UP_4848))
                                    )
                                    else
                                        {5133}let pkSess_4849: bitstring = pub(sk(Sess_3931)) in
                                        {5134}in(c, =GetEndpointRequest);
                                        {5135}new SP_4850: bitstring;
                                        {5136}new UP_4851: bitstring;
                                        {5137}out(c, (GetEndpointResponse,pkSess_4849,None,SP_4850,UP_4851))
                                )
                                else
                                    {5138}let pkSess_4852: bitstring = fail-any in
                                    {5139}in(c, =GetEndpointRequest);
                                    {5140}new SP_4853: bitstring;
                                    {5141}new UP_4854: bitstring;
                                    {5142}out(c, (GetEndpointResponse,pkSess_4852,None,SP_4853,UP_4854))
                        )
                        else
                            {5143}let pkSess_4855: bitstring = fail-any in
                            {5144}in(c, =GetEndpointRequest);
                            {5145}new SP_4856: bitstring;
                            {5146}new UP_4857: bitstring;
                            {5147}out(c, (GetEndpointResponse,pkSess_4855,None,SP_4856,UP_4857))
                )
                else
                    {5148}let pkSess_4858: bitstring = fail-any in
                    {5149}in(c, =GetEndpointRequest);
                    {5150}new SP_4859: bitstring;
                    {5151}new UP_4860: bitstring;
                    {5152}out(c, (GetEndpointResponse,pkSess_4858,None,SP_4859,UP_4860))
            )
            else
                {5153}let v_4861: bool = (Cli_3929 = B) in
                (
                    {5154}if v_4861 then
                    (
                        {5155}let pkCli_4862: bitstring = pub(skB) in
                        {5156}let v_4863: bool = (Sess_3931 = A) in
                        (
                            {5157}if v_4863 then
                            (
                                {5158}let pkSess_4864: bitstring = pub(skA) in
                                {5159}in(c, =GetEndpointRequest);
                                {5160}new SP_4865: bitstring;
                                {5161}new UP_4866: bitstring;
                                {5162}out(c, (GetEndpointResponse,pkSess_4864,None,SP_4865,UP_4866))
                            )
                            else
                                {5163}let v_4867: bool = (Sess_3931 = B) in
                                (
                                    {5164}if v_4867 then
                                    (
                                        {5165}let pkSess_4868: bitstring = pub(skB) in
                                        {5166}in(c, =GetEndpointRequest);
                                        {5167}new SP_4869: bitstring;
                                        {5168}new UP_4870: bitstring;
                                        {5169}out(c, (GetEndpointResponse,pkSess_4868,None,SP_4869,UP_4870))
                                    )
                                    else
                                        {5170}let v_4871: bool = (Sess_3931 = C) in
                                        (
                                            {5171}if v_4871 then
                                            (
                                                {5172}let pkSess_4872: bitstring = pub(skC) in
                                                {5173}in(c, =GetEndpointRequest);
                                                {5174}new SP_4873: bitstring;
                                                {5175}new UP_4874: bitstring;
                                                {5176}out(c, (GetEndpointResponse,pkSess_4872,None,SP_4873,UP_4874))
                                            )
                                            else
                                                {5177}let pkSess_4875: bitstring = pub(sk(Sess_3931)) in
                                                {5178}in(c, =GetEndpointRequest);
                                                {5179}new SP_4876: bitstring;
                                                {5180}new UP_4877: bitstring;
                                                {5181}out(c, (GetEndpointResponse,pkSess_4875,None,SP_4876,UP_4877))
                                        )
                                        else
                                            {5182}let pkSess_4878: bitstring = fail-any in
                                            {5183}in(c, =GetEndpointRequest);
                                            {5184}new SP_4879: bitstring;
                                            {5185}new UP_4880: bitstring;
                                            {5186}out(c, (GetEndpointResponse,pkSess_4878,None,SP_4879,UP_4880))
                                )
                                else
                                    {5187}let pkSess_4881: bitstring = fail-any in
                                    {5188}in(c, =GetEndpointRequest);
                                    {5189}new SP_4882: bitstring;
                                    {5190}new UP_4883: bitstring;
                                    {5191}out(c, (GetEndpointResponse,pkSess_4881,None,SP_4882,UP_4883))
                        )
                        else
                            {5192}let pkSess_4884: bitstring = fail-any in
                            {5193}in(c, =GetEndpointRequest);
                            {5194}new SP_4885: bitstring;
                            {5195}new UP_4886: bitstring;
                            {5196}out(c, (GetEndpointResponse,pkSess_4884,None,SP_4885,UP_4886))
                    )
                    else
                        {5197}let v_4887: bool = (Cli_3929 = C) in
                        (
                            {5198}if v_4887 then
                            (
                                {5199}let pkCli_4888: bitstring = pub(skC) in
                                {5200}let v_4889: bool = (Sess_3931 = A) in
                                (
                                    {5201}if v_4889 then
                                    (
                                        {5202}let pkSess_4890: bitstring = pub(skA) in
                                        {5203}in(c, =GetEndpointRequest);
                                        {5204}new SP_4891: bitstring;
                                        {5205}new UP_4892: bitstring;
                                        {5206}out(c, (GetEndpointResponse,pkSess_4890,None,SP_4891,UP_4892))
                                    )
                                    else
                                        {5207}let v_4893: bool = (Sess_3931 = B) in
                                        (
                                            {5208}if v_4893 then
                                            (
                                                {5209}let pkSess_4894: bitstring = pub(skB) in
                                                {5210}in(c, =GetEndpointRequest);
                                                {5211}new SP_4895: bitstring;
                                                {5212}new UP_4896: bitstring;
                                                {5213}out(c, (GetEndpointResponse,pkSess_4894,None,SP_4895,UP_4896))
                                            )
                                            else
                                                {5214}let v_4897: bool = (Sess_3931 = C) in
                                                (
                                                    {5215}if v_4897 then
                                                    (
                                                        {5216}let pkSess_4898: bitstring = pub(skC) in
                                                        {5217}in(c, =GetEndpointRequest);
                                                        {5218}new SP_4899: bitstring;
                                                        {5219}new UP_4900: bitstring;
                                                        {5220}out(c, (GetEndpointResponse,pkSess_4898,None,SP_4899,UP_4900))
                                                    )
                                                    else
                                                        {5221}let pkSess_4901: bitstring = pub(sk(Sess_3931)) in
                                                        {5222}in(c, =GetEndpointRequest);
                                                        {5223}new SP_4902: bitstring;
                                                        {5224}new UP_4903: bitstring;
                                                        {5225}out(c, (GetEndpointResponse,pkSess_4901,None,SP_4902,UP_4903))
                                                )
                                                else
                                                    {5226}let pkSess_4904: bitstring = fail-any in
                                                    {5227}in(c, =GetEndpointRequest);
                                                    {5228}new SP_4905: bitstring;
                                                    {5229}new UP_4906: bitstring;
                                                    {5230}out(c, (GetEndpointResponse,pkSess_4904,None,SP_4905,UP_4906))
                                        )
                                        else
                                            {5231}let pkSess_4907: bitstring = fail-any in
                                            {5232}in(c, =GetEndpointRequest);
                                            {5233}new SP_4908: bitstring;
                                            {5234}new UP_4909: bitstring;
                                            {5235}out(c, (GetEndpointResponse,pkSess_4907,None,SP_4908,UP_4909))
                                )
                                else
                                    {5236}let pkSess_4910: bitstring = fail-any in
                                    {5237}in(c, =GetEndpointRequest);
                                    {5238}new SP_4911: bitstring;
                                    {5239}new UP_4912: bitstring;
                                    {5240}out(c, (GetEndpointResponse,pkSess_4910,None,SP_4911,UP_4912))
                            )
                            else
                                {5241}let pkCli_4913: bitstring = pub(sk(Cli_3929)) in
                                {5242}let v_4914: bool = (Sess_3931 = A) in
                                (
                                    {5243}if v_4914 then
                                    (
                                        {5244}let pkSess_4915: bitstring = pub(skA) in
                                        {5245}in(c, =GetEndpointRequest);
                                        {5246}new SP_4916: bitstring;
                                        {5247}new UP_4917: bitstring;
                                        {5248}out(c, (GetEndpointResponse,pkSess_4915,None,SP_4916,UP_4917))
                                    )
                                    else
                                        {5249}let v_4918: bool = (Sess_3931 = B) in
                                        (
                                            {5250}if v_4918 then
                                            (
                                                {5251}let pkSess_4919: bitstring = pub(skB) in
                                                {5252}in(c, =GetEndpointRequest);
                                                {5253}new SP_4920: bitstring;
                                                {5254}new UP_4921: bitstring;
                                                {5255}out(c, (GetEndpointResponse,pkSess_4919,None,SP_4920,UP_4921))
                                            )
                                            else
                                                {5256}let v_4922: bool = (Sess_3931 = C) in
                                                (
                                                    {5257}if v_4922 then
                                                    (
                                                        {5258}let pkSess_4923: bitstring = pub(skC) in
                                                        {5259}in(c, =GetEndpointRequest);
                                                        {5260}new SP_4924: bitstring;
                                                        {5261}new UP_4925: bitstring;
                                                        {5262}out(c, (GetEndpointResponse,pkSess_4923,None,SP_4924,UP_4925))
                                                    )
                                                    else
                                                        {5263}let pkSess_4926: bitstring = pub(sk(Sess_3931)) in
                                                        {5264}in(c, =GetEndpointRequest);
                                                        {5265}new SP_4927: bitstring;
                                                        {5266}new UP_4928: bitstring;
                                                        {5267}out(c, (GetEndpointResponse,pkSess_4926,None,SP_4927,UP_4928))
                                                )
                                                else
                                                    {5268}let pkSess_4929: bitstring = fail-any in
                                                    {5269}in(c, =GetEndpointRequest);
                                                    {5270}new SP_4930: bitstring;
                                                    {5271}new UP_4931: bitstring;
                                                    {5272}out(c, (GetEndpointResponse,pkSess_4929,None,SP_4930,UP_4931))
                                        )
                                        else
                                            {5273}let pkSess_4932: bitstring = fail-any in
                                            {5274}in(c, =GetEndpointRequest);
                                            {5275}new SP_4933: bitstring;
                                            {5276}new UP_4934: bitstring;
                                            {5277}out(c, (GetEndpointResponse,pkSess_4932,None,SP_4933,UP_4934))
                                )
                                else
                                    {5278}let pkSess_4935: bitstring = fail-any in
                                    {5279}in(c, =GetEndpointRequest);
                                    {5280}new SP_4936: bitstring;
                                    {5281}new UP_4937: bitstring;
                                    {5282}out(c, (GetEndpointResponse,pkSess_4935,None,SP_4936,UP_4937))
                        )
                        else
                            {5283}let pkCli_4938: bitstring = fail-any in
                            {5284}let v_4939: bool = (Sess_3931 = A) in
                            (
                                {5285}if v_4939 then
                                (
                                    {5286}let pkSess_4940: bitstring = pub(skA) in
                                    {5287}in(c, =GetEndpointRequest);
                                    {5288}new SP_4941: bitstring;
                                    {5289}new UP_4942: bitstring;
                                    {5290}out(c, (GetEndpointResponse,pkSess_4940,None,SP_4941,UP_4942))
                                )
                                else
                                    {5291}let v_4943: bool = (Sess_3931 = B) in
                                    (
                                        {5292}if v_4943 then
                                        (
                                            {5293}let pkSess_4944: bitstring = pub(skB) in
                                            {5294}in(c, =GetEndpointRequest);
                                            {5295}new SP_4945: bitstring;
                                            {5296}new UP_4946: bitstring;
                                            {5297}out(c, (GetEndpointResponse,pkSess_4944,None,SP_4945,UP_4946))
                                        )
                                        else
                                            {5298}let v_4947: bool = (Sess_3931 = C) in
                                            (
                                                {5299}if v_4947 then
                                                (
                                                    {5300}let pkSess_4948: bitstring = pub(skC) in
                                                    {5301}in(c, =GetEndpointRequest);
                                                    {5302}new SP_4949: bitstring;
                                                    {5303}new UP_4950: bitstring;
                                                    {5304}out(c, (GetEndpointResponse,pkSess_4948,None,SP_4949,UP_4950))
                                                )
                                                else
                                                    {5305}let pkSess_4951: bitstring = pub(sk(Sess_3931)) in
                                                    {5306}in(c, =GetEndpointRequest);
                                                    {5307}new SP_4952: bitstring;
                                                    {5308}new UP_4953: bitstring;
                                                    {5309}out(c, (GetEndpointResponse,pkSess_4951,None,SP_4952,UP_4953))
                                            )
                                            else
                                                {5310}let pkSess_4954: bitstring = fail-any in
                                                {5311}in(c, =GetEndpointRequest);
                                                {5312}new SP_4955: bitstring;
                                                {5313}new UP_4956: bitstring;
                                                {5314}out(c, (GetEndpointResponse,pkSess_4954,None,SP_4955,UP_4956))
                                    )
                                    else
                                        {5315}let pkSess_4957: bitstring = fail-any in
                                        {5316}in(c, =GetEndpointRequest);
                                        {5317}new SP_4958: bitstring;
                                        {5318}new UP_4959: bitstring;
                                        {5319}out(c, (GetEndpointResponse,pkSess_4957,None,SP_4958,UP_4959))
                            )
                            else
                                {5320}let pkSess_4960: bitstring = fail-any in
                                {5321}in(c, =GetEndpointRequest);
                                {5322}new SP_4961: bitstring;
                                {5323}new UP_4962: bitstring;
                                {5324}out(c, (GetEndpointResponse,pkSess_4960,None,SP_4961,UP_4962))
                )
                else
                    {5325}let pkCli_4963: bitstring = fail-any in
                    {5326}let v_4964: bool = (Sess_3931 = A) in
                    (
                        {5327}if v_4964 then
                        (
                            {5328}let pkSess_4965: bitstring = pub(skA) in
                            {5329}in(c, =GetEndpointRequest);
                            {5330}new SP_4966: bitstring;
                            {5331}new UP_4967: bitstring;
                            {5332}out(c, (GetEndpointResponse,pkSess_4965,None,SP_4966,UP_4967))
                        )
                        else
                            {5333}let v_4968: bool = (Sess_3931 = B) in
                            (
                                {5334}if v_4968 then
                                (
                                    {5335}let pkSess_4969: bitstring = pub(skB) in
                                    {5336}in(c, =GetEndpointRequest);
                                    {5337}new SP_4970: bitstring;
                                    {5338}new UP_4971: bitstring;
                                    {5339}out(c, (GetEndpointResponse,pkSess_4969,None,SP_4970,UP_4971))
                                )
                                else
                                    {5340}let v_4972: bool = (Sess_3931 = C) in
                                    (
                                        {5341}if v_4972 then
                                        (
                                            {5342}let pkSess_4973: bitstring = pub(skC) in
                                            {5343}in(c, =GetEndpointRequest);
                                            {5344}new SP_4974: bitstring;
                                            {5345}new UP_4975: bitstring;
                                            {5346}out(c, (GetEndpointResponse,pkSess_4973,None,SP_4974,UP_4975))
                                        )
                                        else
                                            {5347}let pkSess_4976: bitstring = pub(sk(Sess_3931)) in
                                            {5348}in(c, =GetEndpointRequest);
                                            {5349}new SP_4977: bitstring;
                                            {5350}new UP_4978: bitstring;
                                            {5351}out(c, (GetEndpointResponse,pkSess_4976,None,SP_4977,UP_4978))
                                    )
                                    else
                                        {5352}let pkSess_4979: bitstring = fail-any in
                                        {5353}in(c, =GetEndpointRequest);
                                        {5354}new SP_4980: bitstring;
                                        {5355}new UP_4981: bitstring;
                                        {5356}out(c, (GetEndpointResponse,pkSess_4979,None,SP_4980,UP_4981))
                            )
                            else
                                {5357}let pkSess_4982: bitstring = fail-any in
                                {5358}in(c, =GetEndpointRequest);
                                {5359}new SP_4983: bitstring;
                                {5360}new UP_4984: bitstring;
                                {5361}out(c, (GetEndpointResponse,pkSess_4982,None,SP_4983,UP_4984))
                    )
                    else
                        {5362}let pkSess_4985: bitstring = fail-any in
                        {5363}in(c, =GetEndpointRequest);
                        {5364}new SP_4986: bitstring;
                        {5365}new UP_4987: bitstring;
                        {5366}out(c, (GetEndpointResponse,pkSess_4985,None,SP_4986,UP_4987))
        )
        else
            {5367}let pkCli_4988: bitstring = fail-any in
            {5368}let v_4989: bool = (Sess_3931 = A) in
            (
                {5369}if v_4989 then
                (
                    {5370}let pkSess_4990: bitstring = pub(skA) in
                    {5371}in(c, =GetEndpointRequest);
                    {5372}new SP_4991: bitstring;
                    {5373}new UP_4992: bitstring;
                    {5374}out(c, (GetEndpointResponse,pkSess_4990,None,SP_4991,UP_4992))
                )
                else
                    {5375}let v_4993: bool = (Sess_3931 = B) in
                    (
                        {5376}if v_4993 then
                        (
                            {5377}let pkSess_4994: bitstring = pub(skB) in
                            {5378}in(c, =GetEndpointRequest);
                            {5379}new SP_4995: bitstring;
                            {5380}new UP_4996: bitstring;
                            {5381}out(c, (GetEndpointResponse,pkSess_4994,None,SP_4995,UP_4996))
                        )
                        else
                            {5382}let v_4997: bool = (Sess_3931 = C) in
                            (
                                {5383}if v_4997 then
                                (
                                    {5384}let pkSess_4998: bitstring = pub(skC) in
                                    {5385}in(c, =GetEndpointRequest);
                                    {5386}new SP_4999: bitstring;
                                    {5387}new UP_5000: bitstring;
                                    {5388}out(c, (GetEndpointResponse,pkSess_4998,None,SP_4999,UP_5000))
                                )
                                else
                                    {5389}let pkSess_5001: bitstring = pub(sk(Sess_3931)) in
                                    {5390}in(c, =GetEndpointRequest);
                                    {5391}new SP_5002: bitstring;
                                    {5392}new UP_5003: bitstring;
                                    {5393}out(c, (GetEndpointResponse,pkSess_5001,None,SP_5002,UP_5003))
                            )
                            else
                                {5394}let pkSess_5004: bitstring = fail-any in
                                {5395}in(c, =GetEndpointRequest);
                                {5396}new SP_5005: bitstring;
                                {5397}new UP_5006: bitstring;
                                {5398}out(c, (GetEndpointResponse,pkSess_5004,None,SP_5005,UP_5006))
                    )
                    else
                        {5399}let pkSess_5007: bitstring = fail-any in
                        {5400}in(c, =GetEndpointRequest);
                        {5401}new SP_5008: bitstring;
                        {5402}new UP_5009: bitstring;
                        {5403}out(c, (GetEndpointResponse,pkSess_5007,None,SP_5008,UP_5009))
            )
            else
                {5404}let pkSess_5010: bitstring = fail-any in
                {5405}in(c, =GetEndpointRequest);
                {5406}new SP_5011: bitstring;
                {5407}new UP_5012: bitstring;
                {5408}out(c, (GetEndpointResponse,pkSess_5010,None,SP_5011,UP_5012))
) | (
    {5409}!
    {5410}in(c, (Cli_5013: host,Disco_5014: host,Sess_5015: host));
    {5411}let v_5016: bool = (Sess_5015 = A) in
    (
        {5412}if v_5016 then
        (
            {5413}let skSess: bitstring = skA in
            {5414}let pkSess_5017: bitstring = pub(skSess) in
            {5415}let v_5018: bool = (Cli_5013 = A) in
            (
                {5416}if v_5018 then
                (
                    {5417}let pkCli_5019: bitstring = pub(skA) in
                    {5418}let v_5020: bool = (Disco_5014 = A) in
                    (
                        {5419}if v_5020 then
                        (
                            {5420}let pkDisco_5021: bitstring = pub(skA) in
                            {5421}in(c, (=pkCli_5019,em1: bitstring));
                            {5422}let m1_5022: bitstring = em1 in
                            {5423}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5023: bitstring) = m1_5022 in
                            {5424}new Ns_5024: bitstring;
                            {5425}new ST_5025: bitstring;
                            {5426}new TTL_5026: bitstring;
                            {5427}let m2_5027: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5024,ST_5025,TTL_5026) in
                            {5428}out(c, m2_5027);
                            {5429}let Ksrv: bitstring = h((Ns_5024,Nc_5023)) in
                            {5430}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv))
                        )
                        else
                            {5431}let v_5028: bool = (Disco_5014 = B) in
                            (
                                {5432}if v_5028 then
                                (
                                    {5433}let pkDisco_5029: bitstring = pub(skB) in
                                    {5434}in(c, (=pkCli_5019,em1_5030: bitstring));
                                    {5435}let m1_5031: bitstring = em1_5030 in
                                    {5436}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5032: bitstring) = m1_5031 in
                                    {5437}new Ns_5033: bitstring;
                                    {5438}new ST_5034: bitstring;
                                    {5439}new TTL_5035: bitstring;
                                    {5440}let m2_5036: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5033,ST_5034,TTL_5035) in
                                    {5441}out(c, m2_5036);
                                    {5442}let Ksrv_5037: bitstring = h((Ns_5033,Nc_5032)) in
                                    {5443}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv_5037))
                                )
                                else
                                    {5444}let v_5038: bool = (Disco_5014 = C) in
                                    (
                                        {5445}if v_5038 then
                                        (
                                            {5446}let pkDisco_5039: bitstring = pub(skC) in
                                            {5447}in(c, (=pkCli_5019,em1_5040: bitstring));
                                            {5448}let m1_5041: bitstring = em1_5040 in
                                            {5449}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5042: bitstring) = m1_5041 in
                                            {5450}new Ns_5043: bitstring;
                                            {5451}new ST_5044: bitstring;
                                            {5452}new TTL_5045: bitstring;
                                            {5453}let m2_5046: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5043,ST_5044,TTL_5045) in
                                            {5454}out(c, m2_5046);
                                            {5455}let Ksrv_5047: bitstring = h((Ns_5043,Nc_5042)) in
                                            {5456}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv_5047))
                                        )
                                        else
                                            {5457}let pkDisco_5048: bitstring = pub(sk(Disco_5014)) in
                                            {5458}in(c, (=pkCli_5019,em1_5049: bitstring));
                                            {5459}let m1_5050: bitstring = em1_5049 in
                                            {5460}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5051: bitstring) = m1_5050 in
                                            {5461}new Ns_5052: bitstring;
                                            {5462}new ST_5053: bitstring;
                                            {5463}new TTL_5054: bitstring;
                                            {5464}let m2_5055: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5052,ST_5053,TTL_5054) in
                                            {5465}out(c, m2_5055);
                                            {5466}let Ksrv_5056: bitstring = h((Ns_5052,Nc_5051)) in
                                            {5467}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv_5056))
                                    )
                                    else
                                        {5468}let pkDisco_5057: bitstring = fail-any in
                                        {5469}in(c, (=pkCli_5019,em1_5058: bitstring));
                                        {5470}let m1_5059: bitstring = em1_5058 in
                                        {5471}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5060: bitstring) = m1_5059 in
                                        {5472}new Ns_5061: bitstring;
                                        {5473}new ST_5062: bitstring;
                                        {5474}new TTL_5063: bitstring;
                                        {5475}let m2_5064: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5061,ST_5062,TTL_5063) in
                                        {5476}out(c, m2_5064);
                                        {5477}let Ksrv_5065: bitstring = h((Ns_5061,Nc_5060)) in
                                        {5478}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv_5065))
                            )
                            else
                                {5479}let pkDisco_5066: bitstring = fail-any in
                                {5480}in(c, (=pkCli_5019,em1_5067: bitstring));
                                {5481}let m1_5068: bitstring = em1_5067 in
                                {5482}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5069: bitstring) = m1_5068 in
                                {5483}new Ns_5070: bitstring;
                                {5484}new ST_5071: bitstring;
                                {5485}new TTL_5072: bitstring;
                                {5486}let m2_5073: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5070,ST_5071,TTL_5072) in
                                {5487}out(c, m2_5073);
                                {5488}let Ksrv_5074: bitstring = h((Ns_5070,Nc_5069)) in
                                {5489}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv_5074))
                    )
                    else
                        {5490}let pkDisco_5075: bitstring = fail-any in
                        {5491}in(c, (=pkCli_5019,em1_5076: bitstring));
                        {5492}let m1_5077: bitstring = em1_5076 in
                        {5493}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5019,Nc_5078: bitstring) = m1_5077 in
                        {5494}new Ns_5079: bitstring;
                        {5495}new ST_5080: bitstring;
                        {5496}new TTL_5081: bitstring;
                        {5497}let m2_5082: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5079,ST_5080,TTL_5081) in
                        {5498}out(c, m2_5082);
                        {5499}let Ksrv_5083: bitstring = h((Ns_5079,Nc_5078)) in
                        {5500}out(c, senc(mSrv(pkCli_5019,pkSess_5017),Ksrv_5083))
                )
                else
                    {5501}let v_5084: bool = (Cli_5013 = B) in
                    (
                        {5502}if v_5084 then
                        (
                            {5503}let pkCli_5085: bitstring = pub(skB) in
                            {5504}let v_5086: bool = (Disco_5014 = A) in
                            (
                                {5505}if v_5086 then
                                (
                                    {5506}let pkDisco_5087: bitstring = pub(skA) in
                                    {5507}in(c, (=pkCli_5085,em1_5088: bitstring));
                                    {5508}let m1_5089: bitstring = em1_5088 in
                                    {5509}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5090: bitstring) = m1_5089 in
                                    {5510}new Ns_5091: bitstring;
                                    {5511}new ST_5092: bitstring;
                                    {5512}new TTL_5093: bitstring;
                                    {5513}let m2_5094: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5091,ST_5092,TTL_5093) in
                                    {5514}out(c, m2_5094);
                                    {5515}let Ksrv_5095: bitstring = h((Ns_5091,Nc_5090)) in
                                    {5516}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5095))
                                )
                                else
                                    {5517}let v_5096: bool = (Disco_5014 = B) in
                                    (
                                        {5518}if v_5096 then
                                        (
                                            {5519}let pkDisco_5097: bitstring = pub(skB) in
                                            {5520}in(c, (=pkCli_5085,em1_5098: bitstring));
                                            {5521}let m1_5099: bitstring = em1_5098 in
                                            {5522}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5100: bitstring) = m1_5099 in
                                            {5523}new Ns_5101: bitstring;
                                            {5524}new ST_5102: bitstring;
                                            {5525}new TTL_5103: bitstring;
                                            {5526}let m2_5104: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5101,ST_5102,TTL_5103) in
                                            {5527}out(c, m2_5104);
                                            {5528}let Ksrv_5105: bitstring = h((Ns_5101,Nc_5100)) in
                                            {5529}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5105))
                                        )
                                        else
                                            {5530}let v_5106: bool = (Disco_5014 = C) in
                                            (
                                                {5531}if v_5106 then
                                                (
                                                    {5532}let pkDisco_5107: bitstring = pub(skC) in
                                                    {5533}in(c, (=pkCli_5085,em1_5108: bitstring));
                                                    {5534}let m1_5109: bitstring = em1_5108 in
                                                    {5535}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5110: bitstring) = m1_5109 in
                                                    {5536}new Ns_5111: bitstring;
                                                    {5537}new ST_5112: bitstring;
                                                    {5538}new TTL_5113: bitstring;
                                                    {5539}let m2_5114: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5111,ST_5112,TTL_5113) in
                                                    {5540}out(c, m2_5114);
                                                    {5541}let Ksrv_5115: bitstring = h((Ns_5111,Nc_5110)) in
                                                    {5542}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5115))
                                                )
                                                else
                                                    {5543}let pkDisco_5116: bitstring = pub(sk(Disco_5014)) in
                                                    {5544}in(c, (=pkCli_5085,em1_5117: bitstring));
                                                    {5545}let m1_5118: bitstring = em1_5117 in
                                                    {5546}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5119: bitstring) = m1_5118 in
                                                    {5547}new Ns_5120: bitstring;
                                                    {5548}new ST_5121: bitstring;
                                                    {5549}new TTL_5122: bitstring;
                                                    {5550}let m2_5123: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5120,ST_5121,TTL_5122) in
                                                    {5551}out(c, m2_5123);
                                                    {5552}let Ksrv_5124: bitstring = h((Ns_5120,Nc_5119)) in
                                                    {5553}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5124))
                                            )
                                            else
                                                {5554}let pkDisco_5125: bitstring = fail-any in
                                                {5555}in(c, (=pkCli_5085,em1_5126: bitstring));
                                                {5556}let m1_5127: bitstring = em1_5126 in
                                                {5557}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5128: bitstring) = m1_5127 in
                                                {5558}new Ns_5129: bitstring;
                                                {5559}new ST_5130: bitstring;
                                                {5560}new TTL_5131: bitstring;
                                                {5561}let m2_5132: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5129,ST_5130,TTL_5131) in
                                                {5562}out(c, m2_5132);
                                                {5563}let Ksrv_5133: bitstring = h((Ns_5129,Nc_5128)) in
                                                {5564}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5133))
                                    )
                                    else
                                        {5565}let pkDisco_5134: bitstring = fail-any in
                                        {5566}in(c, (=pkCli_5085,em1_5135: bitstring));
                                        {5567}let m1_5136: bitstring = em1_5135 in
                                        {5568}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5137: bitstring) = m1_5136 in
                                        {5569}new Ns_5138: bitstring;
                                        {5570}new ST_5139: bitstring;
                                        {5571}new TTL_5140: bitstring;
                                        {5572}let m2_5141: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5138,ST_5139,TTL_5140) in
                                        {5573}out(c, m2_5141);
                                        {5574}let Ksrv_5142: bitstring = h((Ns_5138,Nc_5137)) in
                                        {5575}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5142))
                            )
                            else
                                {5576}let pkDisco_5143: bitstring = fail-any in
                                {5577}in(c, (=pkCli_5085,em1_5144: bitstring));
                                {5578}let m1_5145: bitstring = em1_5144 in
                                {5579}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5085,Nc_5146: bitstring) = m1_5145 in
                                {5580}new Ns_5147: bitstring;
                                {5581}new ST_5148: bitstring;
                                {5582}new TTL_5149: bitstring;
                                {5583}let m2_5150: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5147,ST_5148,TTL_5149) in
                                {5584}out(c, m2_5150);
                                {5585}let Ksrv_5151: bitstring = h((Ns_5147,Nc_5146)) in
                                {5586}out(c, senc(mSrv(pkCli_5085,pkSess_5017),Ksrv_5151))
                        )
                        else
                            {5587}let v_5152: bool = (Cli_5013 = C) in
                            (
                                {5588}if v_5152 then
                                (
                                    {5589}let pkCli_5153: bitstring = pub(skC) in
                                    {5590}let v_5154: bool = (Disco_5014 = A) in
                                    (
                                        {5591}if v_5154 then
                                        (
                                            {5592}let pkDisco_5155: bitstring = pub(skA) in
                                            {5593}in(c, (=pkCli_5153,em1_5156: bitstring));
                                            {5594}let m1_5157: bitstring = em1_5156 in
                                            {5595}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5158: bitstring) = m1_5157 in
                                            {5596}new Ns_5159: bitstring;
                                            {5597}new ST_5160: bitstring;
                                            {5598}new TTL_5161: bitstring;
                                            {5599}let m2_5162: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5159,ST_5160,TTL_5161) in
                                            {5600}out(c, m2_5162);
                                            {5601}let Ksrv_5163: bitstring = h((Ns_5159,Nc_5158)) in
                                            {5602}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5163))
                                        )
                                        else
                                            {5603}let v_5164: bool = (Disco_5014 = B) in
                                            (
                                                {5604}if v_5164 then
                                                (
                                                    {5605}let pkDisco_5165: bitstring = pub(skB) in
                                                    {5606}in(c, (=pkCli_5153,em1_5166: bitstring));
                                                    {5607}let m1_5167: bitstring = em1_5166 in
                                                    {5608}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5168: bitstring) = m1_5167 in
                                                    {5609}new Ns_5169: bitstring;
                                                    {5610}new ST_5170: bitstring;
                                                    {5611}new TTL_5171: bitstring;
                                                    {5612}let m2_5172: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5169,ST_5170,TTL_5171) in
                                                    {5613}out(c, m2_5172);
                                                    {5614}let Ksrv_5173: bitstring = h((Ns_5169,Nc_5168)) in
                                                    {5615}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5173))
                                                )
                                                else
                                                    {5616}let v_5174: bool = (Disco_5014 = C) in
                                                    (
                                                        {5617}if v_5174 then
                                                        (
                                                            {5618}let pkDisco_5175: bitstring = pub(skC) in
                                                            {5619}in(c, (=pkCli_5153,em1_5176: bitstring));
                                                            {5620}let m1_5177: bitstring = em1_5176 in
                                                            {5621}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5178: bitstring) = m1_5177 in
                                                            {5622}new Ns_5179: bitstring;
                                                            {5623}new ST_5180: bitstring;
                                                            {5624}new TTL_5181: bitstring;
                                                            {5625}let m2_5182: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5179,ST_5180,TTL_5181) in
                                                            {5626}out(c, m2_5182);
                                                            {5627}let Ksrv_5183: bitstring = h((Ns_5179,Nc_5178)) in
                                                            {5628}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5183))
                                                        )
                                                        else
                                                            {5629}let pkDisco_5184: bitstring = pub(sk(Disco_5014)) in
                                                            {5630}in(c, (=pkCli_5153,em1_5185: bitstring));
                                                            {5631}let m1_5186: bitstring = em1_5185 in
                                                            {5632}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5187: bitstring) = m1_5186 in
                                                            {5633}new Ns_5188: bitstring;
                                                            {5634}new ST_5189: bitstring;
                                                            {5635}new TTL_5190: bitstring;
                                                            {5636}let m2_5191: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5188,ST_5189,TTL_5190) in
                                                            {5637}out(c, m2_5191);
                                                            {5638}let Ksrv_5192: bitstring = h((Ns_5188,Nc_5187)) in
                                                            {5639}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5192))
                                                    )
                                                    else
                                                        {5640}let pkDisco_5193: bitstring = fail-any in
                                                        {5641}in(c, (=pkCli_5153,em1_5194: bitstring));
                                                        {5642}let m1_5195: bitstring = em1_5194 in
                                                        {5643}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5196: bitstring) = m1_5195 in
                                                        {5644}new Ns_5197: bitstring;
                                                        {5645}new ST_5198: bitstring;
                                                        {5646}new TTL_5199: bitstring;
                                                        {5647}let m2_5200: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5197,ST_5198,TTL_5199) in
                                                        {5648}out(c, m2_5200);
                                                        {5649}let Ksrv_5201: bitstring = h((Ns_5197,Nc_5196)) in
                                                        {5650}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5201))
                                            )
                                            else
                                                {5651}let pkDisco_5202: bitstring = fail-any in
                                                {5652}in(c, (=pkCli_5153,em1_5203: bitstring));
                                                {5653}let m1_5204: bitstring = em1_5203 in
                                                {5654}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5205: bitstring) = m1_5204 in
                                                {5655}new Ns_5206: bitstring;
                                                {5656}new ST_5207: bitstring;
                                                {5657}new TTL_5208: bitstring;
                                                {5658}let m2_5209: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5206,ST_5207,TTL_5208) in
                                                {5659}out(c, m2_5209);
                                                {5660}let Ksrv_5210: bitstring = h((Ns_5206,Nc_5205)) in
                                                {5661}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5210))
                                    )
                                    else
                                        {5662}let pkDisco_5211: bitstring = fail-any in
                                        {5663}in(c, (=pkCli_5153,em1_5212: bitstring));
                                        {5664}let m1_5213: bitstring = em1_5212 in
                                        {5665}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5153,Nc_5214: bitstring) = m1_5213 in
                                        {5666}new Ns_5215: bitstring;
                                        {5667}new ST_5216: bitstring;
                                        {5668}new TTL_5217: bitstring;
                                        {5669}let m2_5218: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5215,ST_5216,TTL_5217) in
                                        {5670}out(c, m2_5218);
                                        {5671}let Ksrv_5219: bitstring = h((Ns_5215,Nc_5214)) in
                                        {5672}out(c, senc(mSrv(pkCli_5153,pkSess_5017),Ksrv_5219))
                                )
                                else
                                    {5673}let pkCli_5220: bitstring = pub(sk(Cli_5013)) in
                                    {5674}let v_5221: bool = (Disco_5014 = A) in
                                    (
                                        {5675}if v_5221 then
                                        (
                                            {5676}let pkDisco_5222: bitstring = pub(skA) in
                                            {5677}in(c, (=pkCli_5220,em1_5223: bitstring));
                                            {5678}let m1_5224: bitstring = em1_5223 in
                                            {5679}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5225: bitstring) = m1_5224 in
                                            {5680}new Ns_5226: bitstring;
                                            {5681}new ST_5227: bitstring;
                                            {5682}new TTL_5228: bitstring;
                                            {5683}let m2_5229: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5226,ST_5227,TTL_5228) in
                                            {5684}out(c, m2_5229);
                                            {5685}let Ksrv_5230: bitstring = h((Ns_5226,Nc_5225)) in
                                            {5686}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5230))
                                        )
                                        else
                                            {5687}let v_5231: bool = (Disco_5014 = B) in
                                            (
                                                {5688}if v_5231 then
                                                (
                                                    {5689}let pkDisco_5232: bitstring = pub(skB) in
                                                    {5690}in(c, (=pkCli_5220,em1_5233: bitstring));
                                                    {5691}let m1_5234: bitstring = em1_5233 in
                                                    {5692}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5235: bitstring) = m1_5234 in
                                                    {5693}new Ns_5236: bitstring;
                                                    {5694}new ST_5237: bitstring;
                                                    {5695}new TTL_5238: bitstring;
                                                    {5696}let m2_5239: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5236,ST_5237,TTL_5238) in
                                                    {5697}out(c, m2_5239);
                                                    {5698}let Ksrv_5240: bitstring = h((Ns_5236,Nc_5235)) in
                                                    {5699}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5240))
                                                )
                                                else
                                                    {5700}let v_5241: bool = (Disco_5014 = C) in
                                                    (
                                                        {5701}if v_5241 then
                                                        (
                                                            {5702}let pkDisco_5242: bitstring = pub(skC) in
                                                            {5703}in(c, (=pkCli_5220,em1_5243: bitstring));
                                                            {5704}let m1_5244: bitstring = em1_5243 in
                                                            {5705}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5245: bitstring) = m1_5244 in
                                                            {5706}new Ns_5246: bitstring;
                                                            {5707}new ST_5247: bitstring;
                                                            {5708}new TTL_5248: bitstring;
                                                            {5709}let m2_5249: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5246,ST_5247,TTL_5248) in
                                                            {5710}out(c, m2_5249);
                                                            {5711}let Ksrv_5250: bitstring = h((Ns_5246,Nc_5245)) in
                                                            {5712}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5250))
                                                        )
                                                        else
                                                            {5713}let pkDisco_5251: bitstring = pub(sk(Disco_5014)) in
                                                            {5714}in(c, (=pkCli_5220,em1_5252: bitstring));
                                                            {5715}let m1_5253: bitstring = em1_5252 in
                                                            {5716}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5254: bitstring) = m1_5253 in
                                                            {5717}new Ns_5255: bitstring;
                                                            {5718}new ST_5256: bitstring;
                                                            {5719}new TTL_5257: bitstring;
                                                            {5720}let m2_5258: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5255,ST_5256,TTL_5257) in
                                                            {5721}out(c, m2_5258);
                                                            {5722}let Ksrv_5259: bitstring = h((Ns_5255,Nc_5254)) in
                                                            {5723}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5259))
                                                    )
                                                    else
                                                        {5724}let pkDisco_5260: bitstring = fail-any in
                                                        {5725}in(c, (=pkCli_5220,em1_5261: bitstring));
                                                        {5726}let m1_5262: bitstring = em1_5261 in
                                                        {5727}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5263: bitstring) = m1_5262 in
                                                        {5728}new Ns_5264: bitstring;
                                                        {5729}new ST_5265: bitstring;
                                                        {5730}new TTL_5266: bitstring;
                                                        {5731}let m2_5267: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5264,ST_5265,TTL_5266) in
                                                        {5732}out(c, m2_5267);
                                                        {5733}let Ksrv_5268: bitstring = h((Ns_5264,Nc_5263)) in
                                                        {5734}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5268))
                                            )
                                            else
                                                {5735}let pkDisco_5269: bitstring = fail-any in
                                                {5736}in(c, (=pkCli_5220,em1_5270: bitstring));
                                                {5737}let m1_5271: bitstring = em1_5270 in
                                                {5738}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5272: bitstring) = m1_5271 in
                                                {5739}new Ns_5273: bitstring;
                                                {5740}new ST_5274: bitstring;
                                                {5741}new TTL_5275: bitstring;
                                                {5742}let m2_5276: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5273,ST_5274,TTL_5275) in
                                                {5743}out(c, m2_5276);
                                                {5744}let Ksrv_5277: bitstring = h((Ns_5273,Nc_5272)) in
                                                {5745}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5277))
                                    )
                                    else
                                        {5746}let pkDisco_5278: bitstring = fail-any in
                                        {5747}in(c, (=pkCli_5220,em1_5279: bitstring));
                                        {5748}let m1_5280: bitstring = em1_5279 in
                                        {5749}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5220,Nc_5281: bitstring) = m1_5280 in
                                        {5750}new Ns_5282: bitstring;
                                        {5751}new ST_5283: bitstring;
                                        {5752}new TTL_5284: bitstring;
                                        {5753}let m2_5285: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5282,ST_5283,TTL_5284) in
                                        {5754}out(c, m2_5285);
                                        {5755}let Ksrv_5286: bitstring = h((Ns_5282,Nc_5281)) in
                                        {5756}out(c, senc(mSrv(pkCli_5220,pkSess_5017),Ksrv_5286))
                            )
                            else
                                {5757}let pkCli_5287: bitstring = fail-any in
                                {5758}let v_5288: bool = (Disco_5014 = A) in
                                (
                                    {5759}if v_5288 then
                                    (
                                        {5760}let pkDisco_5289: bitstring = pub(skA) in
                                        {5761}in(c, (=pkCli_5287,em1_5290: bitstring));
                                        {5762}let m1_5291: bitstring = em1_5290 in
                                        {5763}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5292: bitstring) = m1_5291 in
                                        {5764}new Ns_5293: bitstring;
                                        {5765}new ST_5294: bitstring;
                                        {5766}new TTL_5295: bitstring;
                                        {5767}let m2_5296: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5293,ST_5294,TTL_5295) in
                                        {5768}out(c, m2_5296);
                                        {5769}let Ksrv_5297: bitstring = h((Ns_5293,Nc_5292)) in
                                        {5770}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5297))
                                    )
                                    else
                                        {5771}let v_5298: bool = (Disco_5014 = B) in
                                        (
                                            {5772}if v_5298 then
                                            (
                                                {5773}let pkDisco_5299: bitstring = pub(skB) in
                                                {5774}in(c, (=pkCli_5287,em1_5300: bitstring));
                                                {5775}let m1_5301: bitstring = em1_5300 in
                                                {5776}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5302: bitstring) = m1_5301 in
                                                {5777}new Ns_5303: bitstring;
                                                {5778}new ST_5304: bitstring;
                                                {5779}new TTL_5305: bitstring;
                                                {5780}let m2_5306: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5303,ST_5304,TTL_5305) in
                                                {5781}out(c, m2_5306);
                                                {5782}let Ksrv_5307: bitstring = h((Ns_5303,Nc_5302)) in
                                                {5783}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5307))
                                            )
                                            else
                                                {5784}let v_5308: bool = (Disco_5014 = C) in
                                                (
                                                    {5785}if v_5308 then
                                                    (
                                                        {5786}let pkDisco_5309: bitstring = pub(skC) in
                                                        {5787}in(c, (=pkCli_5287,em1_5310: bitstring));
                                                        {5788}let m1_5311: bitstring = em1_5310 in
                                                        {5789}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5312: bitstring) = m1_5311 in
                                                        {5790}new Ns_5313: bitstring;
                                                        {5791}new ST_5314: bitstring;
                                                        {5792}new TTL_5315: bitstring;
                                                        {5793}let m2_5316: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5313,ST_5314,TTL_5315) in
                                                        {5794}out(c, m2_5316);
                                                        {5795}let Ksrv_5317: bitstring = h((Ns_5313,Nc_5312)) in
                                                        {5796}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5317))
                                                    )
                                                    else
                                                        {5797}let pkDisco_5318: bitstring = pub(sk(Disco_5014)) in
                                                        {5798}in(c, (=pkCli_5287,em1_5319: bitstring));
                                                        {5799}let m1_5320: bitstring = em1_5319 in
                                                        {5800}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5321: bitstring) = m1_5320 in
                                                        {5801}new Ns_5322: bitstring;
                                                        {5802}new ST_5323: bitstring;
                                                        {5803}new TTL_5324: bitstring;
                                                        {5804}let m2_5325: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5322,ST_5323,TTL_5324) in
                                                        {5805}out(c, m2_5325);
                                                        {5806}let Ksrv_5326: bitstring = h((Ns_5322,Nc_5321)) in
                                                        {5807}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5326))
                                                )
                                                else
                                                    {5808}let pkDisco_5327: bitstring = fail-any in
                                                    {5809}in(c, (=pkCli_5287,em1_5328: bitstring));
                                                    {5810}let m1_5329: bitstring = em1_5328 in
                                                    {5811}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5330: bitstring) = m1_5329 in
                                                    {5812}new Ns_5331: bitstring;
                                                    {5813}new ST_5332: bitstring;
                                                    {5814}new TTL_5333: bitstring;
                                                    {5815}let m2_5334: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5331,ST_5332,TTL_5333) in
                                                    {5816}out(c, m2_5334);
                                                    {5817}let Ksrv_5335: bitstring = h((Ns_5331,Nc_5330)) in
                                                    {5818}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5335))
                                        )
                                        else
                                            {5819}let pkDisco_5336: bitstring = fail-any in
                                            {5820}in(c, (=pkCli_5287,em1_5337: bitstring));
                                            {5821}let m1_5338: bitstring = em1_5337 in
                                            {5822}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5339: bitstring) = m1_5338 in
                                            {5823}new Ns_5340: bitstring;
                                            {5824}new ST_5341: bitstring;
                                            {5825}new TTL_5342: bitstring;
                                            {5826}let m2_5343: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5340,ST_5341,TTL_5342) in
                                            {5827}out(c, m2_5343);
                                            {5828}let Ksrv_5344: bitstring = h((Ns_5340,Nc_5339)) in
                                            {5829}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5344))
                                )
                                else
                                    {5830}let pkDisco_5345: bitstring = fail-any in
                                    {5831}in(c, (=pkCli_5287,em1_5346: bitstring));
                                    {5832}let m1_5347: bitstring = em1_5346 in
                                    {5833}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5287,Nc_5348: bitstring) = m1_5347 in
                                    {5834}new Ns_5349: bitstring;
                                    {5835}new ST_5350: bitstring;
                                    {5836}new TTL_5351: bitstring;
                                    {5837}let m2_5352: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5349,ST_5350,TTL_5351) in
                                    {5838}out(c, m2_5352);
                                    {5839}let Ksrv_5353: bitstring = h((Ns_5349,Nc_5348)) in
                                    {5840}out(c, senc(mSrv(pkCli_5287,pkSess_5017),Ksrv_5353))
                    )
                    else
                        {5841}let pkCli_5354: bitstring = fail-any in
                        {5842}let v_5355: bool = (Disco_5014 = A) in
                        (
                            {5843}if v_5355 then
                            (
                                {5844}let pkDisco_5356: bitstring = pub(skA) in
                                {5845}in(c, (=pkCli_5354,em1_5357: bitstring));
                                {5846}let m1_5358: bitstring = em1_5357 in
                                {5847}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5359: bitstring) = m1_5358 in
                                {5848}new Ns_5360: bitstring;
                                {5849}new ST_5361: bitstring;
                                {5850}new TTL_5362: bitstring;
                                {5851}let m2_5363: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5360,ST_5361,TTL_5362) in
                                {5852}out(c, m2_5363);
                                {5853}let Ksrv_5364: bitstring = h((Ns_5360,Nc_5359)) in
                                {5854}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5364))
                            )
                            else
                                {5855}let v_5365: bool = (Disco_5014 = B) in
                                (
                                    {5856}if v_5365 then
                                    (
                                        {5857}let pkDisco_5366: bitstring = pub(skB) in
                                        {5858}in(c, (=pkCli_5354,em1_5367: bitstring));
                                        {5859}let m1_5368: bitstring = em1_5367 in
                                        {5860}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5369: bitstring) = m1_5368 in
                                        {5861}new Ns_5370: bitstring;
                                        {5862}new ST_5371: bitstring;
                                        {5863}new TTL_5372: bitstring;
                                        {5864}let m2_5373: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5370,ST_5371,TTL_5372) in
                                        {5865}out(c, m2_5373);
                                        {5866}let Ksrv_5374: bitstring = h((Ns_5370,Nc_5369)) in
                                        {5867}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5374))
                                    )
                                    else
                                        {5868}let v_5375: bool = (Disco_5014 = C) in
                                        (
                                            {5869}if v_5375 then
                                            (
                                                {5870}let pkDisco_5376: bitstring = pub(skC) in
                                                {5871}in(c, (=pkCli_5354,em1_5377: bitstring));
                                                {5872}let m1_5378: bitstring = em1_5377 in
                                                {5873}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5379: bitstring) = m1_5378 in
                                                {5874}new Ns_5380: bitstring;
                                                {5875}new ST_5381: bitstring;
                                                {5876}new TTL_5382: bitstring;
                                                {5877}let m2_5383: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5380,ST_5381,TTL_5382) in
                                                {5878}out(c, m2_5383);
                                                {5879}let Ksrv_5384: bitstring = h((Ns_5380,Nc_5379)) in
                                                {5880}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5384))
                                            )
                                            else
                                                {5881}let pkDisco_5385: bitstring = pub(sk(Disco_5014)) in
                                                {5882}in(c, (=pkCli_5354,em1_5386: bitstring));
                                                {5883}let m1_5387: bitstring = em1_5386 in
                                                {5884}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5388: bitstring) = m1_5387 in
                                                {5885}new Ns_5389: bitstring;
                                                {5886}new ST_5390: bitstring;
                                                {5887}new TTL_5391: bitstring;
                                                {5888}let m2_5392: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5389,ST_5390,TTL_5391) in
                                                {5889}out(c, m2_5392);
                                                {5890}let Ksrv_5393: bitstring = h((Ns_5389,Nc_5388)) in
                                                {5891}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5393))
                                        )
                                        else
                                            {5892}let pkDisco_5394: bitstring = fail-any in
                                            {5893}in(c, (=pkCli_5354,em1_5395: bitstring));
                                            {5894}let m1_5396: bitstring = em1_5395 in
                                            {5895}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5397: bitstring) = m1_5396 in
                                            {5896}new Ns_5398: bitstring;
                                            {5897}new ST_5399: bitstring;
                                            {5898}new TTL_5400: bitstring;
                                            {5899}let m2_5401: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5398,ST_5399,TTL_5400) in
                                            {5900}out(c, m2_5401);
                                            {5901}let Ksrv_5402: bitstring = h((Ns_5398,Nc_5397)) in
                                            {5902}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5402))
                                )
                                else
                                    {5903}let pkDisco_5403: bitstring = fail-any in
                                    {5904}in(c, (=pkCli_5354,em1_5404: bitstring));
                                    {5905}let m1_5405: bitstring = em1_5404 in
                                    {5906}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5406: bitstring) = m1_5405 in
                                    {5907}new Ns_5407: bitstring;
                                    {5908}new ST_5408: bitstring;
                                    {5909}new TTL_5409: bitstring;
                                    {5910}let m2_5410: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5407,ST_5408,TTL_5409) in
                                    {5911}out(c, m2_5410);
                                    {5912}let Ksrv_5411: bitstring = h((Ns_5407,Nc_5406)) in
                                    {5913}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5411))
                        )
                        else
                            {5914}let pkDisco_5412: bitstring = fail-any in
                            {5915}in(c, (=pkCli_5354,em1_5413: bitstring));
                            {5916}let m1_5414: bitstring = em1_5413 in
                            {5917}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5354,Nc_5415: bitstring) = m1_5414 in
                            {5918}new Ns_5416: bitstring;
                            {5919}new ST_5417: bitstring;
                            {5920}new TTL_5418: bitstring;
                            {5921}let m2_5419: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5416,ST_5417,TTL_5418) in
                            {5922}out(c, m2_5419);
                            {5923}let Ksrv_5420: bitstring = h((Ns_5416,Nc_5415)) in
                            {5924}out(c, senc(mSrv(pkCli_5354,pkSess_5017),Ksrv_5420))
            )
            else
                {5925}let pkCli_5421: bitstring = fail-any in
                {5926}let v_5422: bool = (Disco_5014 = A) in
                (
                    {5927}if v_5422 then
                    (
                        {5928}let pkDisco_5423: bitstring = pub(skA) in
                        {5929}in(c, (=pkCli_5421,em1_5424: bitstring));
                        {5930}let m1_5425: bitstring = em1_5424 in
                        {5931}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5426: bitstring) = m1_5425 in
                        {5932}new Ns_5427: bitstring;
                        {5933}new ST_5428: bitstring;
                        {5934}new TTL_5429: bitstring;
                        {5935}let m2_5430: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5427,ST_5428,TTL_5429) in
                        {5936}out(c, m2_5430);
                        {5937}let Ksrv_5431: bitstring = h((Ns_5427,Nc_5426)) in
                        {5938}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5431))
                    )
                    else
                        {5939}let v_5432: bool = (Disco_5014 = B) in
                        (
                            {5940}if v_5432 then
                            (
                                {5941}let pkDisco_5433: bitstring = pub(skB) in
                                {5942}in(c, (=pkCli_5421,em1_5434: bitstring));
                                {5943}let m1_5435: bitstring = em1_5434 in
                                {5944}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5436: bitstring) = m1_5435 in
                                {5945}new Ns_5437: bitstring;
                                {5946}new ST_5438: bitstring;
                                {5947}new TTL_5439: bitstring;
                                {5948}let m2_5440: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5437,ST_5438,TTL_5439) in
                                {5949}out(c, m2_5440);
                                {5950}let Ksrv_5441: bitstring = h((Ns_5437,Nc_5436)) in
                                {5951}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5441))
                            )
                            else
                                {5952}let v_5442: bool = (Disco_5014 = C) in
                                (
                                    {5953}if v_5442 then
                                    (
                                        {5954}let pkDisco_5443: bitstring = pub(skC) in
                                        {5955}in(c, (=pkCli_5421,em1_5444: bitstring));
                                        {5956}let m1_5445: bitstring = em1_5444 in
                                        {5957}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5446: bitstring) = m1_5445 in
                                        {5958}new Ns_5447: bitstring;
                                        {5959}new ST_5448: bitstring;
                                        {5960}new TTL_5449: bitstring;
                                        {5961}let m2_5450: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5447,ST_5448,TTL_5449) in
                                        {5962}out(c, m2_5450);
                                        {5963}let Ksrv_5451: bitstring = h((Ns_5447,Nc_5446)) in
                                        {5964}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5451))
                                    )
                                    else
                                        {5965}let pkDisco_5452: bitstring = pub(sk(Disco_5014)) in
                                        {5966}in(c, (=pkCli_5421,em1_5453: bitstring));
                                        {5967}let m1_5454: bitstring = em1_5453 in
                                        {5968}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5455: bitstring) = m1_5454 in
                                        {5969}new Ns_5456: bitstring;
                                        {5970}new ST_5457: bitstring;
                                        {5971}new TTL_5458: bitstring;
                                        {5972}let m2_5459: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5456,ST_5457,TTL_5458) in
                                        {5973}out(c, m2_5459);
                                        {5974}let Ksrv_5460: bitstring = h((Ns_5456,Nc_5455)) in
                                        {5975}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5460))
                                )
                                else
                                    {5976}let pkDisco_5461: bitstring = fail-any in
                                    {5977}in(c, (=pkCli_5421,em1_5462: bitstring));
                                    {5978}let m1_5463: bitstring = em1_5462 in
                                    {5979}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5464: bitstring) = m1_5463 in
                                    {5980}new Ns_5465: bitstring;
                                    {5981}new ST_5466: bitstring;
                                    {5982}new TTL_5467: bitstring;
                                    {5983}let m2_5468: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5465,ST_5466,TTL_5467) in
                                    {5984}out(c, m2_5468);
                                    {5985}let Ksrv_5469: bitstring = h((Ns_5465,Nc_5464)) in
                                    {5986}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5469))
                        )
                        else
                            {5987}let pkDisco_5470: bitstring = fail-any in
                            {5988}in(c, (=pkCli_5421,em1_5471: bitstring));
                            {5989}let m1_5472: bitstring = em1_5471 in
                            {5990}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5473: bitstring) = m1_5472 in
                            {5991}new Ns_5474: bitstring;
                            {5992}new ST_5475: bitstring;
                            {5993}new TTL_5476: bitstring;
                            {5994}let m2_5477: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5474,ST_5475,TTL_5476) in
                            {5995}out(c, m2_5477);
                            {5996}let Ksrv_5478: bitstring = h((Ns_5474,Nc_5473)) in
                            {5997}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5478))
                )
                else
                    {5998}let pkDisco_5479: bitstring = fail-any in
                    {5999}in(c, (=pkCli_5421,em1_5480: bitstring));
                    {6000}let m1_5481: bitstring = em1_5480 in
                    {6001}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5421,Nc_5482: bitstring) = m1_5481 in
                    {6002}new Ns_5483: bitstring;
                    {6003}new ST_5484: bitstring;
                    {6004}new TTL_5485: bitstring;
                    {6005}let m2_5486: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5483,ST_5484,TTL_5485) in
                    {6006}out(c, m2_5486);
                    {6007}let Ksrv_5487: bitstring = h((Ns_5483,Nc_5482)) in
                    {6008}out(c, senc(mSrv(pkCli_5421,pkSess_5017),Ksrv_5487))
        )
        else
            {6009}let v_5488: bool = (Sess_5015 = B) in
            (
                {6010}if v_5488 then
                (
                    {6011}let skSess_5489: bitstring = skB in
                    {6012}let pkSess_5490: bitstring = pub(skSess_5489) in
                    {6013}let v_5491: bool = (Cli_5013 = A) in
                    (
                        {6014}if v_5491 then
                        (
                            {6015}let pkCli_5492: bitstring = pub(skA) in
                            {6016}let v_5493: bool = (Disco_5014 = A) in
                            (
                                {6017}if v_5493 then
                                (
                                    {6018}let pkDisco_5494: bitstring = pub(skA) in
                                    {6019}in(c, (=pkCli_5492,em1_5495: bitstring));
                                    {6020}let m1_5496: bitstring = em1_5495 in
                                    {6021}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5497: bitstring) = m1_5496 in
                                    {6022}new Ns_5498: bitstring;
                                    {6023}new ST_5499: bitstring;
                                    {6024}new TTL_5500: bitstring;
                                    {6025}let m2_5501: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5498,ST_5499,TTL_5500) in
                                    {6026}out(c, m2_5501);
                                    {6027}let Ksrv_5502: bitstring = h((Ns_5498,Nc_5497)) in
                                    {6028}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5502))
                                )
                                else
                                    {6029}let v_5503: bool = (Disco_5014 = B) in
                                    (
                                        {6030}if v_5503 then
                                        (
                                            {6031}let pkDisco_5504: bitstring = pub(skB) in
                                            {6032}in(c, (=pkCli_5492,em1_5505: bitstring));
                                            {6033}let m1_5506: bitstring = em1_5505 in
                                            {6034}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5507: bitstring) = m1_5506 in
                                            {6035}new Ns_5508: bitstring;
                                            {6036}new ST_5509: bitstring;
                                            {6037}new TTL_5510: bitstring;
                                            {6038}let m2_5511: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5508,ST_5509,TTL_5510) in
                                            {6039}out(c, m2_5511);
                                            {6040}let Ksrv_5512: bitstring = h((Ns_5508,Nc_5507)) in
                                            {6041}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5512))
                                        )
                                        else
                                            {6042}let v_5513: bool = (Disco_5014 = C) in
                                            (
                                                {6043}if v_5513 then
                                                (
                                                    {6044}let pkDisco_5514: bitstring = pub(skC) in
                                                    {6045}in(c, (=pkCli_5492,em1_5515: bitstring));
                                                    {6046}let m1_5516: bitstring = em1_5515 in
                                                    {6047}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5517: bitstring) = m1_5516 in
                                                    {6048}new Ns_5518: bitstring;
                                                    {6049}new ST_5519: bitstring;
                                                    {6050}new TTL_5520: bitstring;
                                                    {6051}let m2_5521: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5518,ST_5519,TTL_5520) in
                                                    {6052}out(c, m2_5521);
                                                    {6053}let Ksrv_5522: bitstring = h((Ns_5518,Nc_5517)) in
                                                    {6054}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5522))
                                                )
                                                else
                                                    {6055}let pkDisco_5523: bitstring = pub(sk(Disco_5014)) in
                                                    {6056}in(c, (=pkCli_5492,em1_5524: bitstring));
                                                    {6057}let m1_5525: bitstring = em1_5524 in
                                                    {6058}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5526: bitstring) = m1_5525 in
                                                    {6059}new Ns_5527: bitstring;
                                                    {6060}new ST_5528: bitstring;
                                                    {6061}new TTL_5529: bitstring;
                                                    {6062}let m2_5530: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5527,ST_5528,TTL_5529) in
                                                    {6063}out(c, m2_5530);
                                                    {6064}let Ksrv_5531: bitstring = h((Ns_5527,Nc_5526)) in
                                                    {6065}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5531))
                                            )
                                            else
                                                {6066}let pkDisco_5532: bitstring = fail-any in
                                                {6067}in(c, (=pkCli_5492,em1_5533: bitstring));
                                                {6068}let m1_5534: bitstring = em1_5533 in
                                                {6069}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5535: bitstring) = m1_5534 in
                                                {6070}new Ns_5536: bitstring;
                                                {6071}new ST_5537: bitstring;
                                                {6072}new TTL_5538: bitstring;
                                                {6073}let m2_5539: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5536,ST_5537,TTL_5538) in
                                                {6074}out(c, m2_5539);
                                                {6075}let Ksrv_5540: bitstring = h((Ns_5536,Nc_5535)) in
                                                {6076}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5540))
                                    )
                                    else
                                        {6077}let pkDisco_5541: bitstring = fail-any in
                                        {6078}in(c, (=pkCli_5492,em1_5542: bitstring));
                                        {6079}let m1_5543: bitstring = em1_5542 in
                                        {6080}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5544: bitstring) = m1_5543 in
                                        {6081}new Ns_5545: bitstring;
                                        {6082}new ST_5546: bitstring;
                                        {6083}new TTL_5547: bitstring;
                                        {6084}let m2_5548: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5545,ST_5546,TTL_5547) in
                                        {6085}out(c, m2_5548);
                                        {6086}let Ksrv_5549: bitstring = h((Ns_5545,Nc_5544)) in
                                        {6087}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5549))
                            )
                            else
                                {6088}let pkDisco_5550: bitstring = fail-any in
                                {6089}in(c, (=pkCli_5492,em1_5551: bitstring));
                                {6090}let m1_5552: bitstring = em1_5551 in
                                {6091}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5492,Nc_5553: bitstring) = m1_5552 in
                                {6092}new Ns_5554: bitstring;
                                {6093}new ST_5555: bitstring;
                                {6094}new TTL_5556: bitstring;
                                {6095}let m2_5557: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5554,ST_5555,TTL_5556) in
                                {6096}out(c, m2_5557);
                                {6097}let Ksrv_5558: bitstring = h((Ns_5554,Nc_5553)) in
                                {6098}out(c, senc(mSrv(pkCli_5492,pkSess_5490),Ksrv_5558))
                        )
                        else
                            {6099}let v_5559: bool = (Cli_5013 = B) in
                            (
                                {6100}if v_5559 then
                                (
                                    {6101}let pkCli_5560: bitstring = pub(skB) in
                                    {6102}let v_5561: bool = (Disco_5014 = A) in
                                    (
                                        {6103}if v_5561 then
                                        (
                                            {6104}let pkDisco_5562: bitstring = pub(skA) in
                                            {6105}in(c, (=pkCli_5560,em1_5563: bitstring));
                                            {6106}let m1_5564: bitstring = em1_5563 in
                                            {6107}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5565: bitstring) = m1_5564 in
                                            {6108}new Ns_5566: bitstring;
                                            {6109}new ST_5567: bitstring;
                                            {6110}new TTL_5568: bitstring;
                                            {6111}let m2_5569: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5566,ST_5567,TTL_5568) in
                                            {6112}out(c, m2_5569);
                                            {6113}let Ksrv_5570: bitstring = h((Ns_5566,Nc_5565)) in
                                            {6114}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5570))
                                        )
                                        else
                                            {6115}let v_5571: bool = (Disco_5014 = B) in
                                            (
                                                {6116}if v_5571 then
                                                (
                                                    {6117}let pkDisco_5572: bitstring = pub(skB) in
                                                    {6118}in(c, (=pkCli_5560,em1_5573: bitstring));
                                                    {6119}let m1_5574: bitstring = em1_5573 in
                                                    {6120}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5575: bitstring) = m1_5574 in
                                                    {6121}new Ns_5576: bitstring;
                                                    {6122}new ST_5577: bitstring;
                                                    {6123}new TTL_5578: bitstring;
                                                    {6124}let m2_5579: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5576,ST_5577,TTL_5578) in
                                                    {6125}out(c, m2_5579);
                                                    {6126}let Ksrv_5580: bitstring = h((Ns_5576,Nc_5575)) in
                                                    {6127}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5580))
                                                )
                                                else
                                                    {6128}let v_5581: bool = (Disco_5014 = C) in
                                                    (
                                                        {6129}if v_5581 then
                                                        (
                                                            {6130}let pkDisco_5582: bitstring = pub(skC) in
                                                            {6131}in(c, (=pkCli_5560,em1_5583: bitstring));
                                                            {6132}let m1_5584: bitstring = em1_5583 in
                                                            {6133}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5585: bitstring) = m1_5584 in
                                                            {6134}new Ns_5586: bitstring;
                                                            {6135}new ST_5587: bitstring;
                                                            {6136}new TTL_5588: bitstring;
                                                            {6137}let m2_5589: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5586,ST_5587,TTL_5588) in
                                                            {6138}out(c, m2_5589);
                                                            {6139}let Ksrv_5590: bitstring = h((Ns_5586,Nc_5585)) in
                                                            {6140}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5590))
                                                        )
                                                        else
                                                            {6141}let pkDisco_5591: bitstring = pub(sk(Disco_5014)) in
                                                            {6142}in(c, (=pkCli_5560,em1_5592: bitstring));
                                                            {6143}let m1_5593: bitstring = em1_5592 in
                                                            {6144}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5594: bitstring) = m1_5593 in
                                                            {6145}new Ns_5595: bitstring;
                                                            {6146}new ST_5596: bitstring;
                                                            {6147}new TTL_5597: bitstring;
                                                            {6148}let m2_5598: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5595,ST_5596,TTL_5597) in
                                                            {6149}out(c, m2_5598);
                                                            {6150}let Ksrv_5599: bitstring = h((Ns_5595,Nc_5594)) in
                                                            {6151}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5599))
                                                    )
                                                    else
                                                        {6152}let pkDisco_5600: bitstring = fail-any in
                                                        {6153}in(c, (=pkCli_5560,em1_5601: bitstring));
                                                        {6154}let m1_5602: bitstring = em1_5601 in
                                                        {6155}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5603: bitstring) = m1_5602 in
                                                        {6156}new Ns_5604: bitstring;
                                                        {6157}new ST_5605: bitstring;
                                                        {6158}new TTL_5606: bitstring;
                                                        {6159}let m2_5607: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5604,ST_5605,TTL_5606) in
                                                        {6160}out(c, m2_5607);
                                                        {6161}let Ksrv_5608: bitstring = h((Ns_5604,Nc_5603)) in
                                                        {6162}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5608))
                                            )
                                            else
                                                {6163}let pkDisco_5609: bitstring = fail-any in
                                                {6164}in(c, (=pkCli_5560,em1_5610: bitstring));
                                                {6165}let m1_5611: bitstring = em1_5610 in
                                                {6166}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5612: bitstring) = m1_5611 in
                                                {6167}new Ns_5613: bitstring;
                                                {6168}new ST_5614: bitstring;
                                                {6169}new TTL_5615: bitstring;
                                                {6170}let m2_5616: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5613,ST_5614,TTL_5615) in
                                                {6171}out(c, m2_5616);
                                                {6172}let Ksrv_5617: bitstring = h((Ns_5613,Nc_5612)) in
                                                {6173}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5617))
                                    )
                                    else
                                        {6174}let pkDisco_5618: bitstring = fail-any in
                                        {6175}in(c, (=pkCli_5560,em1_5619: bitstring));
                                        {6176}let m1_5620: bitstring = em1_5619 in
                                        {6177}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5560,Nc_5621: bitstring) = m1_5620 in
                                        {6178}new Ns_5622: bitstring;
                                        {6179}new ST_5623: bitstring;
                                        {6180}new TTL_5624: bitstring;
                                        {6181}let m2_5625: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5622,ST_5623,TTL_5624) in
                                        {6182}out(c, m2_5625);
                                        {6183}let Ksrv_5626: bitstring = h((Ns_5622,Nc_5621)) in
                                        {6184}out(c, senc(mSrv(pkCli_5560,pkSess_5490),Ksrv_5626))
                                )
                                else
                                    {6185}let v_5627: bool = (Cli_5013 = C) in
                                    (
                                        {6186}if v_5627 then
                                        (
                                            {6187}let pkCli_5628: bitstring = pub(skC) in
                                            {6188}let v_5629: bool = (Disco_5014 = A) in
                                            (
                                                {6189}if v_5629 then
                                                (
                                                    {6190}let pkDisco_5630: bitstring = pub(skA) in
                                                    {6191}in(c, (=pkCli_5628,em1_5631: bitstring));
                                                    {6192}let m1_5632: bitstring = em1_5631 in
                                                    {6193}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5633: bitstring) = m1_5632 in
                                                    {6194}new Ns_5634: bitstring;
                                                    {6195}new ST_5635: bitstring;
                                                    {6196}new TTL_5636: bitstring;
                                                    {6197}let m2_5637: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5634,ST_5635,TTL_5636) in
                                                    {6198}out(c, m2_5637);
                                                    {6199}let Ksrv_5638: bitstring = h((Ns_5634,Nc_5633)) in
                                                    {6200}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5638))
                                                )
                                                else
                                                    {6201}let v_5639: bool = (Disco_5014 = B) in
                                                    (
                                                        {6202}if v_5639 then
                                                        (
                                                            {6203}let pkDisco_5640: bitstring = pub(skB) in
                                                            {6204}in(c, (=pkCli_5628,em1_5641: bitstring));
                                                            {6205}let m1_5642: bitstring = em1_5641 in
                                                            {6206}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5643: bitstring) = m1_5642 in
                                                            {6207}new Ns_5644: bitstring;
                                                            {6208}new ST_5645: bitstring;
                                                            {6209}new TTL_5646: bitstring;
                                                            {6210}let m2_5647: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5644,ST_5645,TTL_5646) in
                                                            {6211}out(c, m2_5647);
                                                            {6212}let Ksrv_5648: bitstring = h((Ns_5644,Nc_5643)) in
                                                            {6213}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5648))
                                                        )
                                                        else
                                                            {6214}let v_5649: bool = (Disco_5014 = C) in
                                                            (
                                                                {6215}if v_5649 then
                                                                (
                                                                    {6216}let pkDisco_5650: bitstring = pub(skC) in
                                                                    {6217}in(c, (=pkCli_5628,em1_5651: bitstring));
                                                                    {6218}let m1_5652: bitstring = em1_5651 in
                                                                    {6219}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5653: bitstring) = m1_5652 in
                                                                    {6220}new Ns_5654: bitstring;
                                                                    {6221}new ST_5655: bitstring;
                                                                    {6222}new TTL_5656: bitstring;
                                                                    {6223}let m2_5657: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5654,ST_5655,TTL_5656) in
                                                                    {6224}out(c, m2_5657);
                                                                    {6225}let Ksrv_5658: bitstring = h((Ns_5654,Nc_5653)) in
                                                                    {6226}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5658))
                                                                )
                                                                else
                                                                    {6227}let pkDisco_5659: bitstring = pub(sk(Disco_5014)) in
                                                                    {6228}in(c, (=pkCli_5628,em1_5660: bitstring));
                                                                    {6229}let m1_5661: bitstring = em1_5660 in
                                                                    {6230}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5662: bitstring) = m1_5661 in
                                                                    {6231}new Ns_5663: bitstring;
                                                                    {6232}new ST_5664: bitstring;
                                                                    {6233}new TTL_5665: bitstring;
                                                                    {6234}let m2_5666: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5663,ST_5664,TTL_5665) in
                                                                    {6235}out(c, m2_5666);
                                                                    {6236}let Ksrv_5667: bitstring = h((Ns_5663,Nc_5662)) in
                                                                    {6237}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5667))
                                                            )
                                                            else
                                                                {6238}let pkDisco_5668: bitstring = fail-any in
                                                                {6239}in(c, (=pkCli_5628,em1_5669: bitstring));
                                                                {6240}let m1_5670: bitstring = em1_5669 in
                                                                {6241}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5671: bitstring) = m1_5670 in
                                                                {6242}new Ns_5672: bitstring;
                                                                {6243}new ST_5673: bitstring;
                                                                {6244}new TTL_5674: bitstring;
                                                                {6245}let m2_5675: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5672,ST_5673,TTL_5674) in
                                                                {6246}out(c, m2_5675);
                                                                {6247}let Ksrv_5676: bitstring = h((Ns_5672,Nc_5671)) in
                                                                {6248}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5676))
                                                    )
                                                    else
                                                        {6249}let pkDisco_5677: bitstring = fail-any in
                                                        {6250}in(c, (=pkCli_5628,em1_5678: bitstring));
                                                        {6251}let m1_5679: bitstring = em1_5678 in
                                                        {6252}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5680: bitstring) = m1_5679 in
                                                        {6253}new Ns_5681: bitstring;
                                                        {6254}new ST_5682: bitstring;
                                                        {6255}new TTL_5683: bitstring;
                                                        {6256}let m2_5684: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5681,ST_5682,TTL_5683) in
                                                        {6257}out(c, m2_5684);
                                                        {6258}let Ksrv_5685: bitstring = h((Ns_5681,Nc_5680)) in
                                                        {6259}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5685))
                                            )
                                            else
                                                {6260}let pkDisco_5686: bitstring = fail-any in
                                                {6261}in(c, (=pkCli_5628,em1_5687: bitstring));
                                                {6262}let m1_5688: bitstring = em1_5687 in
                                                {6263}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5628,Nc_5689: bitstring) = m1_5688 in
                                                {6264}new Ns_5690: bitstring;
                                                {6265}new ST_5691: bitstring;
                                                {6266}new TTL_5692: bitstring;
                                                {6267}let m2_5693: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5690,ST_5691,TTL_5692) in
                                                {6268}out(c, m2_5693);
                                                {6269}let Ksrv_5694: bitstring = h((Ns_5690,Nc_5689)) in
                                                {6270}out(c, senc(mSrv(pkCli_5628,pkSess_5490),Ksrv_5694))
                                        )
                                        else
                                            {6271}let pkCli_5695: bitstring = pub(sk(Cli_5013)) in
                                            {6272}let v_5696: bool = (Disco_5014 = A) in
                                            (
                                                {6273}if v_5696 then
                                                (
                                                    {6274}let pkDisco_5697: bitstring = pub(skA) in
                                                    {6275}in(c, (=pkCli_5695,em1_5698: bitstring));
                                                    {6276}let m1_5699: bitstring = em1_5698 in
                                                    {6277}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5700: bitstring) = m1_5699 in
                                                    {6278}new Ns_5701: bitstring;
                                                    {6279}new ST_5702: bitstring;
                                                    {6280}new TTL_5703: bitstring;
                                                    {6281}let m2_5704: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5701,ST_5702,TTL_5703) in
                                                    {6282}out(c, m2_5704);
                                                    {6283}let Ksrv_5705: bitstring = h((Ns_5701,Nc_5700)) in
                                                    {6284}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5705))
                                                )
                                                else
                                                    {6285}let v_5706: bool = (Disco_5014 = B) in
                                                    (
                                                        {6286}if v_5706 then
                                                        (
                                                            {6287}let pkDisco_5707: bitstring = pub(skB) in
                                                            {6288}in(c, (=pkCli_5695,em1_5708: bitstring));
                                                            {6289}let m1_5709: bitstring = em1_5708 in
                                                            {6290}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5710: bitstring) = m1_5709 in
                                                            {6291}new Ns_5711: bitstring;
                                                            {6292}new ST_5712: bitstring;
                                                            {6293}new TTL_5713: bitstring;
                                                            {6294}let m2_5714: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5711,ST_5712,TTL_5713) in
                                                            {6295}out(c, m2_5714);
                                                            {6296}let Ksrv_5715: bitstring = h((Ns_5711,Nc_5710)) in
                                                            {6297}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5715))
                                                        )
                                                        else
                                                            {6298}let v_5716: bool = (Disco_5014 = C) in
                                                            (
                                                                {6299}if v_5716 then
                                                                (
                                                                    {6300}let pkDisco_5717: bitstring = pub(skC) in
                                                                    {6301}in(c, (=pkCli_5695,em1_5718: bitstring));
                                                                    {6302}let m1_5719: bitstring = em1_5718 in
                                                                    {6303}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5720: bitstring) = m1_5719 in
                                                                    {6304}new Ns_5721: bitstring;
                                                                    {6305}new ST_5722: bitstring;
                                                                    {6306}new TTL_5723: bitstring;
                                                                    {6307}let m2_5724: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5721,ST_5722,TTL_5723) in
                                                                    {6308}out(c, m2_5724);
                                                                    {6309}let Ksrv_5725: bitstring = h((Ns_5721,Nc_5720)) in
                                                                    {6310}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5725))
                                                                )
                                                                else
                                                                    {6311}let pkDisco_5726: bitstring = pub(sk(Disco_5014)) in
                                                                    {6312}in(c, (=pkCli_5695,em1_5727: bitstring));
                                                                    {6313}let m1_5728: bitstring = em1_5727 in
                                                                    {6314}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5729: bitstring) = m1_5728 in
                                                                    {6315}new Ns_5730: bitstring;
                                                                    {6316}new ST_5731: bitstring;
                                                                    {6317}new TTL_5732: bitstring;
                                                                    {6318}let m2_5733: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5730,ST_5731,TTL_5732) in
                                                                    {6319}out(c, m2_5733);
                                                                    {6320}let Ksrv_5734: bitstring = h((Ns_5730,Nc_5729)) in
                                                                    {6321}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5734))
                                                            )
                                                            else
                                                                {6322}let pkDisco_5735: bitstring = fail-any in
                                                                {6323}in(c, (=pkCli_5695,em1_5736: bitstring));
                                                                {6324}let m1_5737: bitstring = em1_5736 in
                                                                {6325}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5738: bitstring) = m1_5737 in
                                                                {6326}new Ns_5739: bitstring;
                                                                {6327}new ST_5740: bitstring;
                                                                {6328}new TTL_5741: bitstring;
                                                                {6329}let m2_5742: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5739,ST_5740,TTL_5741) in
                                                                {6330}out(c, m2_5742);
                                                                {6331}let Ksrv_5743: bitstring = h((Ns_5739,Nc_5738)) in
                                                                {6332}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5743))
                                                    )
                                                    else
                                                        {6333}let pkDisco_5744: bitstring = fail-any in
                                                        {6334}in(c, (=pkCli_5695,em1_5745: bitstring));
                                                        {6335}let m1_5746: bitstring = em1_5745 in
                                                        {6336}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5747: bitstring) = m1_5746 in
                                                        {6337}new Ns_5748: bitstring;
                                                        {6338}new ST_5749: bitstring;
                                                        {6339}new TTL_5750: bitstring;
                                                        {6340}let m2_5751: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5748,ST_5749,TTL_5750) in
                                                        {6341}out(c, m2_5751);
                                                        {6342}let Ksrv_5752: bitstring = h((Ns_5748,Nc_5747)) in
                                                        {6343}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5752))
                                            )
                                            else
                                                {6344}let pkDisco_5753: bitstring = fail-any in
                                                {6345}in(c, (=pkCli_5695,em1_5754: bitstring));
                                                {6346}let m1_5755: bitstring = em1_5754 in
                                                {6347}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5695,Nc_5756: bitstring) = m1_5755 in
                                                {6348}new Ns_5757: bitstring;
                                                {6349}new ST_5758: bitstring;
                                                {6350}new TTL_5759: bitstring;
                                                {6351}let m2_5760: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5757,ST_5758,TTL_5759) in
                                                {6352}out(c, m2_5760);
                                                {6353}let Ksrv_5761: bitstring = h((Ns_5757,Nc_5756)) in
                                                {6354}out(c, senc(mSrv(pkCli_5695,pkSess_5490),Ksrv_5761))
                                    )
                                    else
                                        {6355}let pkCli_5762: bitstring = fail-any in
                                        {6356}let v_5763: bool = (Disco_5014 = A) in
                                        (
                                            {6357}if v_5763 then
                                            (
                                                {6358}let pkDisco_5764: bitstring = pub(skA) in
                                                {6359}in(c, (=pkCli_5762,em1_5765: bitstring));
                                                {6360}let m1_5766: bitstring = em1_5765 in
                                                {6361}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5767: bitstring) = m1_5766 in
                                                {6362}new Ns_5768: bitstring;
                                                {6363}new ST_5769: bitstring;
                                                {6364}new TTL_5770: bitstring;
                                                {6365}let m2_5771: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5768,ST_5769,TTL_5770) in
                                                {6366}out(c, m2_5771);
                                                {6367}let Ksrv_5772: bitstring = h((Ns_5768,Nc_5767)) in
                                                {6368}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5772))
                                            )
                                            else
                                                {6369}let v_5773: bool = (Disco_5014 = B) in
                                                (
                                                    {6370}if v_5773 then
                                                    (
                                                        {6371}let pkDisco_5774: bitstring = pub(skB) in
                                                        {6372}in(c, (=pkCli_5762,em1_5775: bitstring));
                                                        {6373}let m1_5776: bitstring = em1_5775 in
                                                        {6374}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5777: bitstring) = m1_5776 in
                                                        {6375}new Ns_5778: bitstring;
                                                        {6376}new ST_5779: bitstring;
                                                        {6377}new TTL_5780: bitstring;
                                                        {6378}let m2_5781: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5778,ST_5779,TTL_5780) in
                                                        {6379}out(c, m2_5781);
                                                        {6380}let Ksrv_5782: bitstring = h((Ns_5778,Nc_5777)) in
                                                        {6381}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5782))
                                                    )
                                                    else
                                                        {6382}let v_5783: bool = (Disco_5014 = C) in
                                                        (
                                                            {6383}if v_5783 then
                                                            (
                                                                {6384}let pkDisco_5784: bitstring = pub(skC) in
                                                                {6385}in(c, (=pkCli_5762,em1_5785: bitstring));
                                                                {6386}let m1_5786: bitstring = em1_5785 in
                                                                {6387}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5787: bitstring) = m1_5786 in
                                                                {6388}new Ns_5788: bitstring;
                                                                {6389}new ST_5789: bitstring;
                                                                {6390}new TTL_5790: bitstring;
                                                                {6391}let m2_5791: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5788,ST_5789,TTL_5790) in
                                                                {6392}out(c, m2_5791);
                                                                {6393}let Ksrv_5792: bitstring = h((Ns_5788,Nc_5787)) in
                                                                {6394}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5792))
                                                            )
                                                            else
                                                                {6395}let pkDisco_5793: bitstring = pub(sk(Disco_5014)) in
                                                                {6396}in(c, (=pkCli_5762,em1_5794: bitstring));
                                                                {6397}let m1_5795: bitstring = em1_5794 in
                                                                {6398}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5796: bitstring) = m1_5795 in
                                                                {6399}new Ns_5797: bitstring;
                                                                {6400}new ST_5798: bitstring;
                                                                {6401}new TTL_5799: bitstring;
                                                                {6402}let m2_5800: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5797,ST_5798,TTL_5799) in
                                                                {6403}out(c, m2_5800);
                                                                {6404}let Ksrv_5801: bitstring = h((Ns_5797,Nc_5796)) in
                                                                {6405}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5801))
                                                        )
                                                        else
                                                            {6406}let pkDisco_5802: bitstring = fail-any in
                                                            {6407}in(c, (=pkCli_5762,em1_5803: bitstring));
                                                            {6408}let m1_5804: bitstring = em1_5803 in
                                                            {6409}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5805: bitstring) = m1_5804 in
                                                            {6410}new Ns_5806: bitstring;
                                                            {6411}new ST_5807: bitstring;
                                                            {6412}new TTL_5808: bitstring;
                                                            {6413}let m2_5809: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5806,ST_5807,TTL_5808) in
                                                            {6414}out(c, m2_5809);
                                                            {6415}let Ksrv_5810: bitstring = h((Ns_5806,Nc_5805)) in
                                                            {6416}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5810))
                                                )
                                                else
                                                    {6417}let pkDisco_5811: bitstring = fail-any in
                                                    {6418}in(c, (=pkCli_5762,em1_5812: bitstring));
                                                    {6419}let m1_5813: bitstring = em1_5812 in
                                                    {6420}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5814: bitstring) = m1_5813 in
                                                    {6421}new Ns_5815: bitstring;
                                                    {6422}new ST_5816: bitstring;
                                                    {6423}new TTL_5817: bitstring;
                                                    {6424}let m2_5818: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5815,ST_5816,TTL_5817) in
                                                    {6425}out(c, m2_5818);
                                                    {6426}let Ksrv_5819: bitstring = h((Ns_5815,Nc_5814)) in
                                                    {6427}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5819))
                                        )
                                        else
                                            {6428}let pkDisco_5820: bitstring = fail-any in
                                            {6429}in(c, (=pkCli_5762,em1_5821: bitstring));
                                            {6430}let m1_5822: bitstring = em1_5821 in
                                            {6431}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5762,Nc_5823: bitstring) = m1_5822 in
                                            {6432}new Ns_5824: bitstring;
                                            {6433}new ST_5825: bitstring;
                                            {6434}new TTL_5826: bitstring;
                                            {6435}let m2_5827: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5824,ST_5825,TTL_5826) in
                                            {6436}out(c, m2_5827);
                                            {6437}let Ksrv_5828: bitstring = h((Ns_5824,Nc_5823)) in
                                            {6438}out(c, senc(mSrv(pkCli_5762,pkSess_5490),Ksrv_5828))
                            )
                            else
                                {6439}let pkCli_5829: bitstring = fail-any in
                                {6440}let v_5830: bool = (Disco_5014 = A) in
                                (
                                    {6441}if v_5830 then
                                    (
                                        {6442}let pkDisco_5831: bitstring = pub(skA) in
                                        {6443}in(c, (=pkCli_5829,em1_5832: bitstring));
                                        {6444}let m1_5833: bitstring = em1_5832 in
                                        {6445}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5834: bitstring) = m1_5833 in
                                        {6446}new Ns_5835: bitstring;
                                        {6447}new ST_5836: bitstring;
                                        {6448}new TTL_5837: bitstring;
                                        {6449}let m2_5838: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5835,ST_5836,TTL_5837) in
                                        {6450}out(c, m2_5838);
                                        {6451}let Ksrv_5839: bitstring = h((Ns_5835,Nc_5834)) in
                                        {6452}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5839))
                                    )
                                    else
                                        {6453}let v_5840: bool = (Disco_5014 = B) in
                                        (
                                            {6454}if v_5840 then
                                            (
                                                {6455}let pkDisco_5841: bitstring = pub(skB) in
                                                {6456}in(c, (=pkCli_5829,em1_5842: bitstring));
                                                {6457}let m1_5843: bitstring = em1_5842 in
                                                {6458}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5844: bitstring) = m1_5843 in
                                                {6459}new Ns_5845: bitstring;
                                                {6460}new ST_5846: bitstring;
                                                {6461}new TTL_5847: bitstring;
                                                {6462}let m2_5848: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5845,ST_5846,TTL_5847) in
                                                {6463}out(c, m2_5848);
                                                {6464}let Ksrv_5849: bitstring = h((Ns_5845,Nc_5844)) in
                                                {6465}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5849))
                                            )
                                            else
                                                {6466}let v_5850: bool = (Disco_5014 = C) in
                                                (
                                                    {6467}if v_5850 then
                                                    (
                                                        {6468}let pkDisco_5851: bitstring = pub(skC) in
                                                        {6469}in(c, (=pkCli_5829,em1_5852: bitstring));
                                                        {6470}let m1_5853: bitstring = em1_5852 in
                                                        {6471}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5854: bitstring) = m1_5853 in
                                                        {6472}new Ns_5855: bitstring;
                                                        {6473}new ST_5856: bitstring;
                                                        {6474}new TTL_5857: bitstring;
                                                        {6475}let m2_5858: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5855,ST_5856,TTL_5857) in
                                                        {6476}out(c, m2_5858);
                                                        {6477}let Ksrv_5859: bitstring = h((Ns_5855,Nc_5854)) in
                                                        {6478}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5859))
                                                    )
                                                    else
                                                        {6479}let pkDisco_5860: bitstring = pub(sk(Disco_5014)) in
                                                        {6480}in(c, (=pkCli_5829,em1_5861: bitstring));
                                                        {6481}let m1_5862: bitstring = em1_5861 in
                                                        {6482}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5863: bitstring) = m1_5862 in
                                                        {6483}new Ns_5864: bitstring;
                                                        {6484}new ST_5865: bitstring;
                                                        {6485}new TTL_5866: bitstring;
                                                        {6486}let m2_5867: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5864,ST_5865,TTL_5866) in
                                                        {6487}out(c, m2_5867);
                                                        {6488}let Ksrv_5868: bitstring = h((Ns_5864,Nc_5863)) in
                                                        {6489}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5868))
                                                )
                                                else
                                                    {6490}let pkDisco_5869: bitstring = fail-any in
                                                    {6491}in(c, (=pkCli_5829,em1_5870: bitstring));
                                                    {6492}let m1_5871: bitstring = em1_5870 in
                                                    {6493}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5872: bitstring) = m1_5871 in
                                                    {6494}new Ns_5873: bitstring;
                                                    {6495}new ST_5874: bitstring;
                                                    {6496}new TTL_5875: bitstring;
                                                    {6497}let m2_5876: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5873,ST_5874,TTL_5875) in
                                                    {6498}out(c, m2_5876);
                                                    {6499}let Ksrv_5877: bitstring = h((Ns_5873,Nc_5872)) in
                                                    {6500}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5877))
                                        )
                                        else
                                            {6501}let pkDisco_5878: bitstring = fail-any in
                                            {6502}in(c, (=pkCli_5829,em1_5879: bitstring));
                                            {6503}let m1_5880: bitstring = em1_5879 in
                                            {6504}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5881: bitstring) = m1_5880 in
                                            {6505}new Ns_5882: bitstring;
                                            {6506}new ST_5883: bitstring;
                                            {6507}new TTL_5884: bitstring;
                                            {6508}let m2_5885: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5882,ST_5883,TTL_5884) in
                                            {6509}out(c, m2_5885);
                                            {6510}let Ksrv_5886: bitstring = h((Ns_5882,Nc_5881)) in
                                            {6511}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5886))
                                )
                                else
                                    {6512}let pkDisco_5887: bitstring = fail-any in
                                    {6513}in(c, (=pkCli_5829,em1_5888: bitstring));
                                    {6514}let m1_5889: bitstring = em1_5888 in
                                    {6515}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5829,Nc_5890: bitstring) = m1_5889 in
                                    {6516}new Ns_5891: bitstring;
                                    {6517}new ST_5892: bitstring;
                                    {6518}new TTL_5893: bitstring;
                                    {6519}let m2_5894: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5891,ST_5892,TTL_5893) in
                                    {6520}out(c, m2_5894);
                                    {6521}let Ksrv_5895: bitstring = h((Ns_5891,Nc_5890)) in
                                    {6522}out(c, senc(mSrv(pkCli_5829,pkSess_5490),Ksrv_5895))
                    )
                    else
                        {6523}let pkCli_5896: bitstring = fail-any in
                        {6524}let v_5897: bool = (Disco_5014 = A) in
                        (
                            {6525}if v_5897 then
                            (
                                {6526}let pkDisco_5898: bitstring = pub(skA) in
                                {6527}in(c, (=pkCli_5896,em1_5899: bitstring));
                                {6528}let m1_5900: bitstring = em1_5899 in
                                {6529}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5901: bitstring) = m1_5900 in
                                {6530}new Ns_5902: bitstring;
                                {6531}new ST_5903: bitstring;
                                {6532}new TTL_5904: bitstring;
                                {6533}let m2_5905: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5902,ST_5903,TTL_5904) in
                                {6534}out(c, m2_5905);
                                {6535}let Ksrv_5906: bitstring = h((Ns_5902,Nc_5901)) in
                                {6536}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5906))
                            )
                            else
                                {6537}let v_5907: bool = (Disco_5014 = B) in
                                (
                                    {6538}if v_5907 then
                                    (
                                        {6539}let pkDisco_5908: bitstring = pub(skB) in
                                        {6540}in(c, (=pkCli_5896,em1_5909: bitstring));
                                        {6541}let m1_5910: bitstring = em1_5909 in
                                        {6542}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5911: bitstring) = m1_5910 in
                                        {6543}new Ns_5912: bitstring;
                                        {6544}new ST_5913: bitstring;
                                        {6545}new TTL_5914: bitstring;
                                        {6546}let m2_5915: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5912,ST_5913,TTL_5914) in
                                        {6547}out(c, m2_5915);
                                        {6548}let Ksrv_5916: bitstring = h((Ns_5912,Nc_5911)) in
                                        {6549}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5916))
                                    )
                                    else
                                        {6550}let v_5917: bool = (Disco_5014 = C) in
                                        (
                                            {6551}if v_5917 then
                                            (
                                                {6552}let pkDisco_5918: bitstring = pub(skC) in
                                                {6553}in(c, (=pkCli_5896,em1_5919: bitstring));
                                                {6554}let m1_5920: bitstring = em1_5919 in
                                                {6555}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5921: bitstring) = m1_5920 in
                                                {6556}new Ns_5922: bitstring;
                                                {6557}new ST_5923: bitstring;
                                                {6558}new TTL_5924: bitstring;
                                                {6559}let m2_5925: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5922,ST_5923,TTL_5924) in
                                                {6560}out(c, m2_5925);
                                                {6561}let Ksrv_5926: bitstring = h((Ns_5922,Nc_5921)) in
                                                {6562}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5926))
                                            )
                                            else
                                                {6563}let pkDisco_5927: bitstring = pub(sk(Disco_5014)) in
                                                {6564}in(c, (=pkCli_5896,em1_5928: bitstring));
                                                {6565}let m1_5929: bitstring = em1_5928 in
                                                {6566}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5930: bitstring) = m1_5929 in
                                                {6567}new Ns_5931: bitstring;
                                                {6568}new ST_5932: bitstring;
                                                {6569}new TTL_5933: bitstring;
                                                {6570}let m2_5934: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5931,ST_5932,TTL_5933) in
                                                {6571}out(c, m2_5934);
                                                {6572}let Ksrv_5935: bitstring = h((Ns_5931,Nc_5930)) in
                                                {6573}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5935))
                                        )
                                        else
                                            {6574}let pkDisco_5936: bitstring = fail-any in
                                            {6575}in(c, (=pkCli_5896,em1_5937: bitstring));
                                            {6576}let m1_5938: bitstring = em1_5937 in
                                            {6577}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5939: bitstring) = m1_5938 in
                                            {6578}new Ns_5940: bitstring;
                                            {6579}new ST_5941: bitstring;
                                            {6580}new TTL_5942: bitstring;
                                            {6581}let m2_5943: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5940,ST_5941,TTL_5942) in
                                            {6582}out(c, m2_5943);
                                            {6583}let Ksrv_5944: bitstring = h((Ns_5940,Nc_5939)) in
                                            {6584}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5944))
                                )
                                else
                                    {6585}let pkDisco_5945: bitstring = fail-any in
                                    {6586}in(c, (=pkCli_5896,em1_5946: bitstring));
                                    {6587}let m1_5947: bitstring = em1_5946 in
                                    {6588}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5948: bitstring) = m1_5947 in
                                    {6589}new Ns_5949: bitstring;
                                    {6590}new ST_5950: bitstring;
                                    {6591}new TTL_5951: bitstring;
                                    {6592}let m2_5952: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5949,ST_5950,TTL_5951) in
                                    {6593}out(c, m2_5952);
                                    {6594}let Ksrv_5953: bitstring = h((Ns_5949,Nc_5948)) in
                                    {6595}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5953))
                        )
                        else
                            {6596}let pkDisco_5954: bitstring = fail-any in
                            {6597}in(c, (=pkCli_5896,em1_5955: bitstring));
                            {6598}let m1_5956: bitstring = em1_5955 in
                            {6599}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5896,Nc_5957: bitstring) = m1_5956 in
                            {6600}new Ns_5958: bitstring;
                            {6601}new ST_5959: bitstring;
                            {6602}new TTL_5960: bitstring;
                            {6603}let m2_5961: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5958,ST_5959,TTL_5960) in
                            {6604}out(c, m2_5961);
                            {6605}let Ksrv_5962: bitstring = h((Ns_5958,Nc_5957)) in
                            {6606}out(c, senc(mSrv(pkCli_5896,pkSess_5490),Ksrv_5962))
                )
                else
                    {6607}let =true = (Sess_5015 = C) in
                    (
                        {6608}let skSess_5963: bitstring = skC in
                        {6609}let pkSess_5964: bitstring = pub(skSess_5963) in
                        {6610}let v_5965: bool = (Cli_5013 = A) in
                        (
                            {6611}if v_5965 then
                            (
                                {6612}let pkCli_5966: bitstring = pub(skA) in
                                {6613}let v_5967: bool = (Disco_5014 = A) in
                                (
                                    {6614}if v_5967 then
                                    (
                                        {6615}let pkDisco_5968: bitstring = pub(skA) in
                                        {6616}in(c, (=pkCli_5966,em1_5969: bitstring));
                                        {6617}let m1_5970: bitstring = em1_5969 in
                                        {6618}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_5971: bitstring) = m1_5970 in
                                        {6619}new Ns_5972: bitstring;
                                        {6620}new ST_5973: bitstring;
                                        {6621}new TTL_5974: bitstring;
                                        {6622}let m2_5975: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5972,ST_5973,TTL_5974) in
                                        {6623}out(c, m2_5975);
                                        {6624}let Ksrv_5976: bitstring = h((Ns_5972,Nc_5971)) in
                                        {6625}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_5976))
                                    )
                                    else
                                        {6626}let v_5977: bool = (Disco_5014 = B) in
                                        (
                                            {6627}if v_5977 then
                                            (
                                                {6628}let pkDisco_5978: bitstring = pub(skB) in
                                                {6629}in(c, (=pkCli_5966,em1_5979: bitstring));
                                                {6630}let m1_5980: bitstring = em1_5979 in
                                                {6631}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_5981: bitstring) = m1_5980 in
                                                {6632}new Ns_5982: bitstring;
                                                {6633}new ST_5983: bitstring;
                                                {6634}new TTL_5984: bitstring;
                                                {6635}let m2_5985: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5982,ST_5983,TTL_5984) in
                                                {6636}out(c, m2_5985);
                                                {6637}let Ksrv_5986: bitstring = h((Ns_5982,Nc_5981)) in
                                                {6638}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_5986))
                                            )
                                            else
                                                {6639}let v_5987: bool = (Disco_5014 = C) in
                                                (
                                                    {6640}if v_5987 then
                                                    (
                                                        {6641}let pkDisco_5988: bitstring = pub(skC) in
                                                        {6642}in(c, (=pkCli_5966,em1_5989: bitstring));
                                                        {6643}let m1_5990: bitstring = em1_5989 in
                                                        {6644}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_5991: bitstring) = m1_5990 in
                                                        {6645}new Ns_5992: bitstring;
                                                        {6646}new ST_5993: bitstring;
                                                        {6647}new TTL_5994: bitstring;
                                                        {6648}let m2_5995: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_5992,ST_5993,TTL_5994) in
                                                        {6649}out(c, m2_5995);
                                                        {6650}let Ksrv_5996: bitstring = h((Ns_5992,Nc_5991)) in
                                                        {6651}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_5996))
                                                    )
                                                    else
                                                        {6652}let pkDisco_5997: bitstring = pub(sk(Disco_5014)) in
                                                        {6653}in(c, (=pkCli_5966,em1_5998: bitstring));
                                                        {6654}let m1_5999: bitstring = em1_5998 in
                                                        {6655}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_6000: bitstring) = m1_5999 in
                                                        {6656}new Ns_6001: bitstring;
                                                        {6657}new ST_6002: bitstring;
                                                        {6658}new TTL_6003: bitstring;
                                                        {6659}let m2_6004: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6001,ST_6002,TTL_6003) in
                                                        {6660}out(c, m2_6004);
                                                        {6661}let Ksrv_6005: bitstring = h((Ns_6001,Nc_6000)) in
                                                        {6662}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_6005))
                                                )
                                                else
                                                    {6663}let pkDisco_6006: bitstring = fail-any in
                                                    {6664}in(c, (=pkCli_5966,em1_6007: bitstring));
                                                    {6665}let m1_6008: bitstring = em1_6007 in
                                                    {6666}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_6009: bitstring) = m1_6008 in
                                                    {6667}new Ns_6010: bitstring;
                                                    {6668}new ST_6011: bitstring;
                                                    {6669}new TTL_6012: bitstring;
                                                    {6670}let m2_6013: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6010,ST_6011,TTL_6012) in
                                                    {6671}out(c, m2_6013);
                                                    {6672}let Ksrv_6014: bitstring = h((Ns_6010,Nc_6009)) in
                                                    {6673}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_6014))
                                        )
                                        else
                                            {6674}let pkDisco_6015: bitstring = fail-any in
                                            {6675}in(c, (=pkCli_5966,em1_6016: bitstring));
                                            {6676}let m1_6017: bitstring = em1_6016 in
                                            {6677}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_6018: bitstring) = m1_6017 in
                                            {6678}new Ns_6019: bitstring;
                                            {6679}new ST_6020: bitstring;
                                            {6680}new TTL_6021: bitstring;
                                            {6681}let m2_6022: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6019,ST_6020,TTL_6021) in
                                            {6682}out(c, m2_6022);
                                            {6683}let Ksrv_6023: bitstring = h((Ns_6019,Nc_6018)) in
                                            {6684}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_6023))
                                )
                                else
                                    {6685}let pkDisco_6024: bitstring = fail-any in
                                    {6686}in(c, (=pkCli_5966,em1_6025: bitstring));
                                    {6687}let m1_6026: bitstring = em1_6025 in
                                    {6688}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_5966,Nc_6027: bitstring) = m1_6026 in
                                    {6689}new Ns_6028: bitstring;
                                    {6690}new ST_6029: bitstring;
                                    {6691}new TTL_6030: bitstring;
                                    {6692}let m2_6031: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6028,ST_6029,TTL_6030) in
                                    {6693}out(c, m2_6031);
                                    {6694}let Ksrv_6032: bitstring = h((Ns_6028,Nc_6027)) in
                                    {6695}out(c, senc(mSrv(pkCli_5966,pkSess_5964),Ksrv_6032))
                            )
                            else
                                {6696}let v_6033: bool = (Cli_5013 = B) in
                                (
                                    {6697}if v_6033 then
                                    (
                                        {6698}let pkCli_6034: bitstring = pub(skB) in
                                        {6699}let v_6035: bool = (Disco_5014 = A) in
                                        (
                                            {6700}if v_6035 then
                                            (
                                                {6701}let pkDisco_6036: bitstring = pub(skA) in
                                                {6702}in(c, (=pkCli_6034,em1_6037: bitstring));
                                                {6703}let m1_6038: bitstring = em1_6037 in
                                                {6704}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6039: bitstring) = m1_6038 in
                                                {6705}new Ns_6040: bitstring;
                                                {6706}new ST_6041: bitstring;
                                                {6707}new TTL_6042: bitstring;
                                                {6708}let m2_6043: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6040,ST_6041,TTL_6042) in
                                                {6709}out(c, m2_6043);
                                                {6710}let Ksrv_6044: bitstring = h((Ns_6040,Nc_6039)) in
                                                {6711}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6044))
                                            )
                                            else
                                                {6712}let v_6045: bool = (Disco_5014 = B) in
                                                (
                                                    {6713}if v_6045 then
                                                    (
                                                        {6714}let pkDisco_6046: bitstring = pub(skB) in
                                                        {6715}in(c, (=pkCli_6034,em1_6047: bitstring));
                                                        {6716}let m1_6048: bitstring = em1_6047 in
                                                        {6717}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6049: bitstring) = m1_6048 in
                                                        {6718}new Ns_6050: bitstring;
                                                        {6719}new ST_6051: bitstring;
                                                        {6720}new TTL_6052: bitstring;
                                                        {6721}let m2_6053: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6050,ST_6051,TTL_6052) in
                                                        {6722}out(c, m2_6053);
                                                        {6723}let Ksrv_6054: bitstring = h((Ns_6050,Nc_6049)) in
                                                        {6724}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6054))
                                                    )
                                                    else
                                                        {6725}let v_6055: bool = (Disco_5014 = C) in
                                                        (
                                                            {6726}if v_6055 then
                                                            (
                                                                {6727}let pkDisco_6056: bitstring = pub(skC) in
                                                                {6728}in(c, (=pkCli_6034,em1_6057: bitstring));
                                                                {6729}let m1_6058: bitstring = em1_6057 in
                                                                {6730}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6059: bitstring) = m1_6058 in
                                                                {6731}new Ns_6060: bitstring;
                                                                {6732}new ST_6061: bitstring;
                                                                {6733}new TTL_6062: bitstring;
                                                                {6734}let m2_6063: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6060,ST_6061,TTL_6062) in
                                                                {6735}out(c, m2_6063);
                                                                {6736}let Ksrv_6064: bitstring = h((Ns_6060,Nc_6059)) in
                                                                {6737}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6064))
                                                            )
                                                            else
                                                                {6738}let pkDisco_6065: bitstring = pub(sk(Disco_5014)) in
                                                                {6739}in(c, (=pkCli_6034,em1_6066: bitstring));
                                                                {6740}let m1_6067: bitstring = em1_6066 in
                                                                {6741}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6068: bitstring) = m1_6067 in
                                                                {6742}new Ns_6069: bitstring;
                                                                {6743}new ST_6070: bitstring;
                                                                {6744}new TTL_6071: bitstring;
                                                                {6745}let m2_6072: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6069,ST_6070,TTL_6071) in
                                                                {6746}out(c, m2_6072);
                                                                {6747}let Ksrv_6073: bitstring = h((Ns_6069,Nc_6068)) in
                                                                {6748}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6073))
                                                        )
                                                        else
                                                            {6749}let pkDisco_6074: bitstring = fail-any in
                                                            {6750}in(c, (=pkCli_6034,em1_6075: bitstring));
                                                            {6751}let m1_6076: bitstring = em1_6075 in
                                                            {6752}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6077: bitstring) = m1_6076 in
                                                            {6753}new Ns_6078: bitstring;
                                                            {6754}new ST_6079: bitstring;
                                                            {6755}new TTL_6080: bitstring;
                                                            {6756}let m2_6081: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6078,ST_6079,TTL_6080) in
                                                            {6757}out(c, m2_6081);
                                                            {6758}let Ksrv_6082: bitstring = h((Ns_6078,Nc_6077)) in
                                                            {6759}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6082))
                                                )
                                                else
                                                    {6760}let pkDisco_6083: bitstring = fail-any in
                                                    {6761}in(c, (=pkCli_6034,em1_6084: bitstring));
                                                    {6762}let m1_6085: bitstring = em1_6084 in
                                                    {6763}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6086: bitstring) = m1_6085 in
                                                    {6764}new Ns_6087: bitstring;
                                                    {6765}new ST_6088: bitstring;
                                                    {6766}new TTL_6089: bitstring;
                                                    {6767}let m2_6090: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6087,ST_6088,TTL_6089) in
                                                    {6768}out(c, m2_6090);
                                                    {6769}let Ksrv_6091: bitstring = h((Ns_6087,Nc_6086)) in
                                                    {6770}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6091))
                                        )
                                        else
                                            {6771}let pkDisco_6092: bitstring = fail-any in
                                            {6772}in(c, (=pkCli_6034,em1_6093: bitstring));
                                            {6773}let m1_6094: bitstring = em1_6093 in
                                            {6774}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6034,Nc_6095: bitstring) = m1_6094 in
                                            {6775}new Ns_6096: bitstring;
                                            {6776}new ST_6097: bitstring;
                                            {6777}new TTL_6098: bitstring;
                                            {6778}let m2_6099: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6096,ST_6097,TTL_6098) in
                                            {6779}out(c, m2_6099);
                                            {6780}let Ksrv_6100: bitstring = h((Ns_6096,Nc_6095)) in
                                            {6781}out(c, senc(mSrv(pkCli_6034,pkSess_5964),Ksrv_6100))
                                    )
                                    else
                                        {6782}let v_6101: bool = (Cli_5013 = C) in
                                        (
                                            {6783}if v_6101 then
                                            (
                                                {6784}let pkCli_6102: bitstring = pub(skC) in
                                                {6785}let v_6103: bool = (Disco_5014 = A) in
                                                (
                                                    {6786}if v_6103 then
                                                    (
                                                        {6787}let pkDisco_6104: bitstring = pub(skA) in
                                                        {6788}in(c, (=pkCli_6102,em1_6105: bitstring));
                                                        {6789}let m1_6106: bitstring = em1_6105 in
                                                        {6790}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6107: bitstring) = m1_6106 in
                                                        {6791}new Ns_6108: bitstring;
                                                        {6792}new ST_6109: bitstring;
                                                        {6793}new TTL_6110: bitstring;
                                                        {6794}let m2_6111: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6108,ST_6109,TTL_6110) in
                                                        {6795}out(c, m2_6111);
                                                        {6796}let Ksrv_6112: bitstring = h((Ns_6108,Nc_6107)) in
                                                        {6797}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6112))
                                                    )
                                                    else
                                                        {6798}let v_6113: bool = (Disco_5014 = B) in
                                                        (
                                                            {6799}if v_6113 then
                                                            (
                                                                {6800}let pkDisco_6114: bitstring = pub(skB) in
                                                                {6801}in(c, (=pkCli_6102,em1_6115: bitstring));
                                                                {6802}let m1_6116: bitstring = em1_6115 in
                                                                {6803}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6117: bitstring) = m1_6116 in
                                                                {6804}new Ns_6118: bitstring;
                                                                {6805}new ST_6119: bitstring;
                                                                {6806}new TTL_6120: bitstring;
                                                                {6807}let m2_6121: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6118,ST_6119,TTL_6120) in
                                                                {6808}out(c, m2_6121);
                                                                {6809}let Ksrv_6122: bitstring = h((Ns_6118,Nc_6117)) in
                                                                {6810}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6122))
                                                            )
                                                            else
                                                                {6811}let v_6123: bool = (Disco_5014 = C) in
                                                                (
                                                                    {6812}if v_6123 then
                                                                    (
                                                                        {6813}let pkDisco_6124: bitstring = pub(skC) in
                                                                        {6814}in(c, (=pkCli_6102,em1_6125: bitstring));
                                                                        {6815}let m1_6126: bitstring = em1_6125 in
                                                                        {6816}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6127: bitstring) = m1_6126 in
                                                                        {6817}new Ns_6128: bitstring;
                                                                        {6818}new ST_6129: bitstring;
                                                                        {6819}new TTL_6130: bitstring;
                                                                        {6820}let m2_6131: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6128,ST_6129,TTL_6130) in
                                                                        {6821}out(c, m2_6131);
                                                                        {6822}let Ksrv_6132: bitstring = h((Ns_6128,Nc_6127)) in
                                                                        {6823}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6132))
                                                                    )
                                                                    else
                                                                        {6824}let pkDisco_6133: bitstring = pub(sk(Disco_5014)) in
                                                                        {6825}in(c, (=pkCli_6102,em1_6134: bitstring));
                                                                        {6826}let m1_6135: bitstring = em1_6134 in
                                                                        {6827}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6136: bitstring) = m1_6135 in
                                                                        {6828}new Ns_6137: bitstring;
                                                                        {6829}new ST_6138: bitstring;
                                                                        {6830}new TTL_6139: bitstring;
                                                                        {6831}let m2_6140: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6137,ST_6138,TTL_6139) in
                                                                        {6832}out(c, m2_6140);
                                                                        {6833}let Ksrv_6141: bitstring = h((Ns_6137,Nc_6136)) in
                                                                        {6834}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6141))
                                                                )
                                                                else
                                                                    {6835}let pkDisco_6142: bitstring = fail-any in
                                                                    {6836}in(c, (=pkCli_6102,em1_6143: bitstring));
                                                                    {6837}let m1_6144: bitstring = em1_6143 in
                                                                    {6838}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6145: bitstring) = m1_6144 in
                                                                    {6839}new Ns_6146: bitstring;
                                                                    {6840}new ST_6147: bitstring;
                                                                    {6841}new TTL_6148: bitstring;
                                                                    {6842}let m2_6149: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6146,ST_6147,TTL_6148) in
                                                                    {6843}out(c, m2_6149);
                                                                    {6844}let Ksrv_6150: bitstring = h((Ns_6146,Nc_6145)) in
                                                                    {6845}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6150))
                                                        )
                                                        else
                                                            {6846}let pkDisco_6151: bitstring = fail-any in
                                                            {6847}in(c, (=pkCli_6102,em1_6152: bitstring));
                                                            {6848}let m1_6153: bitstring = em1_6152 in
                                                            {6849}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6154: bitstring) = m1_6153 in
                                                            {6850}new Ns_6155: bitstring;
                                                            {6851}new ST_6156: bitstring;
                                                            {6852}new TTL_6157: bitstring;
                                                            {6853}let m2_6158: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6155,ST_6156,TTL_6157) in
                                                            {6854}out(c, m2_6158);
                                                            {6855}let Ksrv_6159: bitstring = h((Ns_6155,Nc_6154)) in
                                                            {6856}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6159))
                                                )
                                                else
                                                    {6857}let pkDisco_6160: bitstring = fail-any in
                                                    {6858}in(c, (=pkCli_6102,em1_6161: bitstring));
                                                    {6859}let m1_6162: bitstring = em1_6161 in
                                                    {6860}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6102,Nc_6163: bitstring) = m1_6162 in
                                                    {6861}new Ns_6164: bitstring;
                                                    {6862}new ST_6165: bitstring;
                                                    {6863}new TTL_6166: bitstring;
                                                    {6864}let m2_6167: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6164,ST_6165,TTL_6166) in
                                                    {6865}out(c, m2_6167);
                                                    {6866}let Ksrv_6168: bitstring = h((Ns_6164,Nc_6163)) in
                                                    {6867}out(c, senc(mSrv(pkCli_6102,pkSess_5964),Ksrv_6168))
                                            )
                                            else
                                                {6868}let pkCli_6169: bitstring = pub(sk(Cli_5013)) in
                                                {6869}let v_6170: bool = (Disco_5014 = A) in
                                                (
                                                    {6870}if v_6170 then
                                                    (
                                                        {6871}let pkDisco_6171: bitstring = pub(skA) in
                                                        {6872}in(c, (=pkCli_6169,em1_6172: bitstring));
                                                        {6873}let m1_6173: bitstring = em1_6172 in
                                                        {6874}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6174: bitstring) = m1_6173 in
                                                        {6875}new Ns_6175: bitstring;
                                                        {6876}new ST_6176: bitstring;
                                                        {6877}new TTL_6177: bitstring;
                                                        {6878}let m2_6178: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6175,ST_6176,TTL_6177) in
                                                        {6879}out(c, m2_6178);
                                                        {6880}let Ksrv_6179: bitstring = h((Ns_6175,Nc_6174)) in
                                                        {6881}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6179))
                                                    )
                                                    else
                                                        {6882}let v_6180: bool = (Disco_5014 = B) in
                                                        (
                                                            {6883}if v_6180 then
                                                            (
                                                                {6884}let pkDisco_6181: bitstring = pub(skB) in
                                                                {6885}in(c, (=pkCli_6169,em1_6182: bitstring));
                                                                {6886}let m1_6183: bitstring = em1_6182 in
                                                                {6887}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6184: bitstring) = m1_6183 in
                                                                {6888}new Ns_6185: bitstring;
                                                                {6889}new ST_6186: bitstring;
                                                                {6890}new TTL_6187: bitstring;
                                                                {6891}let m2_6188: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6185,ST_6186,TTL_6187) in
                                                                {6892}out(c, m2_6188);
                                                                {6893}let Ksrv_6189: bitstring = h((Ns_6185,Nc_6184)) in
                                                                {6894}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6189))
                                                            )
                                                            else
                                                                {6895}let v_6190: bool = (Disco_5014 = C) in
                                                                (
                                                                    {6896}if v_6190 then
                                                                    (
                                                                        {6897}let pkDisco_6191: bitstring = pub(skC) in
                                                                        {6898}in(c, (=pkCli_6169,em1_6192: bitstring));
                                                                        {6899}let m1_6193: bitstring = em1_6192 in
                                                                        {6900}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6194: bitstring) = m1_6193 in
                                                                        {6901}new Ns_6195: bitstring;
                                                                        {6902}new ST_6196: bitstring;
                                                                        {6903}new TTL_6197: bitstring;
                                                                        {6904}let m2_6198: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6195,ST_6196,TTL_6197) in
                                                                        {6905}out(c, m2_6198);
                                                                        {6906}let Ksrv_6199: bitstring = h((Ns_6195,Nc_6194)) in
                                                                        {6907}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6199))
                                                                    )
                                                                    else
                                                                        {6908}let pkDisco_6200: bitstring = pub(sk(Disco_5014)) in
                                                                        {6909}in(c, (=pkCli_6169,em1_6201: bitstring));
                                                                        {6910}let m1_6202: bitstring = em1_6201 in
                                                                        {6911}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6203: bitstring) = m1_6202 in
                                                                        {6912}new Ns_6204: bitstring;
                                                                        {6913}new ST_6205: bitstring;
                                                                        {6914}new TTL_6206: bitstring;
                                                                        {6915}let m2_6207: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6204,ST_6205,TTL_6206) in
                                                                        {6916}out(c, m2_6207);
                                                                        {6917}let Ksrv_6208: bitstring = h((Ns_6204,Nc_6203)) in
                                                                        {6918}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6208))
                                                                )
                                                                else
                                                                    {6919}let pkDisco_6209: bitstring = fail-any in
                                                                    {6920}in(c, (=pkCli_6169,em1_6210: bitstring));
                                                                    {6921}let m1_6211: bitstring = em1_6210 in
                                                                    {6922}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6212: bitstring) = m1_6211 in
                                                                    {6923}new Ns_6213: bitstring;
                                                                    {6924}new ST_6214: bitstring;
                                                                    {6925}new TTL_6215: bitstring;
                                                                    {6926}let m2_6216: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6213,ST_6214,TTL_6215) in
                                                                    {6927}out(c, m2_6216);
                                                                    {6928}let Ksrv_6217: bitstring = h((Ns_6213,Nc_6212)) in
                                                                    {6929}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6217))
                                                        )
                                                        else
                                                            {6930}let pkDisco_6218: bitstring = fail-any in
                                                            {6931}in(c, (=pkCli_6169,em1_6219: bitstring));
                                                            {6932}let m1_6220: bitstring = em1_6219 in
                                                            {6933}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6221: bitstring) = m1_6220 in
                                                            {6934}new Ns_6222: bitstring;
                                                            {6935}new ST_6223: bitstring;
                                                            {6936}new TTL_6224: bitstring;
                                                            {6937}let m2_6225: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6222,ST_6223,TTL_6224) in
                                                            {6938}out(c, m2_6225);
                                                            {6939}let Ksrv_6226: bitstring = h((Ns_6222,Nc_6221)) in
                                                            {6940}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6226))
                                                )
                                                else
                                                    {6941}let pkDisco_6227: bitstring = fail-any in
                                                    {6942}in(c, (=pkCli_6169,em1_6228: bitstring));
                                                    {6943}let m1_6229: bitstring = em1_6228 in
                                                    {6944}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6169,Nc_6230: bitstring) = m1_6229 in
                                                    {6945}new Ns_6231: bitstring;
                                                    {6946}new ST_6232: bitstring;
                                                    {6947}new TTL_6233: bitstring;
                                                    {6948}let m2_6234: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6231,ST_6232,TTL_6233) in
                                                    {6949}out(c, m2_6234);
                                                    {6950}let Ksrv_6235: bitstring = h((Ns_6231,Nc_6230)) in
                                                    {6951}out(c, senc(mSrv(pkCli_6169,pkSess_5964),Ksrv_6235))
                                        )
                                        else
                                            {6952}let pkCli_6236: bitstring = fail-any in
                                            {6953}let v_6237: bool = (Disco_5014 = A) in
                                            (
                                                {6954}if v_6237 then
                                                (
                                                    {6955}let pkDisco_6238: bitstring = pub(skA) in
                                                    {6956}in(c, (=pkCli_6236,em1_6239: bitstring));
                                                    {6957}let m1_6240: bitstring = em1_6239 in
                                                    {6958}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6241: bitstring) = m1_6240 in
                                                    {6959}new Ns_6242: bitstring;
                                                    {6960}new ST_6243: bitstring;
                                                    {6961}new TTL_6244: bitstring;
                                                    {6962}let m2_6245: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6242,ST_6243,TTL_6244) in
                                                    {6963}out(c, m2_6245);
                                                    {6964}let Ksrv_6246: bitstring = h((Ns_6242,Nc_6241)) in
                                                    {6965}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6246))
                                                )
                                                else
                                                    {6966}let v_6247: bool = (Disco_5014 = B) in
                                                    (
                                                        {6967}if v_6247 then
                                                        (
                                                            {6968}let pkDisco_6248: bitstring = pub(skB) in
                                                            {6969}in(c, (=pkCli_6236,em1_6249: bitstring));
                                                            {6970}let m1_6250: bitstring = em1_6249 in
                                                            {6971}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6251: bitstring) = m1_6250 in
                                                            {6972}new Ns_6252: bitstring;
                                                            {6973}new ST_6253: bitstring;
                                                            {6974}new TTL_6254: bitstring;
                                                            {6975}let m2_6255: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6252,ST_6253,TTL_6254) in
                                                            {6976}out(c, m2_6255);
                                                            {6977}let Ksrv_6256: bitstring = h((Ns_6252,Nc_6251)) in
                                                            {6978}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6256))
                                                        )
                                                        else
                                                            {6979}let v_6257: bool = (Disco_5014 = C) in
                                                            (
                                                                {6980}if v_6257 then
                                                                (
                                                                    {6981}let pkDisco_6258: bitstring = pub(skC) in
                                                                    {6982}in(c, (=pkCli_6236,em1_6259: bitstring));
                                                                    {6983}let m1_6260: bitstring = em1_6259 in
                                                                    {6984}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6261: bitstring) = m1_6260 in
                                                                    {6985}new Ns_6262: bitstring;
                                                                    {6986}new ST_6263: bitstring;
                                                                    {6987}new TTL_6264: bitstring;
                                                                    {6988}let m2_6265: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6262,ST_6263,TTL_6264) in
                                                                    {6989}out(c, m2_6265);
                                                                    {6990}let Ksrv_6266: bitstring = h((Ns_6262,Nc_6261)) in
                                                                    {6991}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6266))
                                                                )
                                                                else
                                                                    {6992}let pkDisco_6267: bitstring = pub(sk(Disco_5014)) in
                                                                    {6993}in(c, (=pkCli_6236,em1_6268: bitstring));
                                                                    {6994}let m1_6269: bitstring = em1_6268 in
                                                                    {6995}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6270: bitstring) = m1_6269 in
                                                                    {6996}new Ns_6271: bitstring;
                                                                    {6997}new ST_6272: bitstring;
                                                                    {6998}new TTL_6273: bitstring;
                                                                    {6999}let m2_6274: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6271,ST_6272,TTL_6273) in
                                                                    {7000}out(c, m2_6274);
                                                                    {7001}let Ksrv_6275: bitstring = h((Ns_6271,Nc_6270)) in
                                                                    {7002}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6275))
                                                            )
                                                            else
                                                                {7003}let pkDisco_6276: bitstring = fail-any in
                                                                {7004}in(c, (=pkCli_6236,em1_6277: bitstring));
                                                                {7005}let m1_6278: bitstring = em1_6277 in
                                                                {7006}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6279: bitstring) = m1_6278 in
                                                                {7007}new Ns_6280: bitstring;
                                                                {7008}new ST_6281: bitstring;
                                                                {7009}new TTL_6282: bitstring;
                                                                {7010}let m2_6283: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6280,ST_6281,TTL_6282) in
                                                                {7011}out(c, m2_6283);
                                                                {7012}let Ksrv_6284: bitstring = h((Ns_6280,Nc_6279)) in
                                                                {7013}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6284))
                                                    )
                                                    else
                                                        {7014}let pkDisco_6285: bitstring = fail-any in
                                                        {7015}in(c, (=pkCli_6236,em1_6286: bitstring));
                                                        {7016}let m1_6287: bitstring = em1_6286 in
                                                        {7017}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6288: bitstring) = m1_6287 in
                                                        {7018}new Ns_6289: bitstring;
                                                        {7019}new ST_6290: bitstring;
                                                        {7020}new TTL_6291: bitstring;
                                                        {7021}let m2_6292: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6289,ST_6290,TTL_6291) in
                                                        {7022}out(c, m2_6292);
                                                        {7023}let Ksrv_6293: bitstring = h((Ns_6289,Nc_6288)) in
                                                        {7024}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6293))
                                            )
                                            else
                                                {7025}let pkDisco_6294: bitstring = fail-any in
                                                {7026}in(c, (=pkCli_6236,em1_6295: bitstring));
                                                {7027}let m1_6296: bitstring = em1_6295 in
                                                {7028}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6236,Nc_6297: bitstring) = m1_6296 in
                                                {7029}new Ns_6298: bitstring;
                                                {7030}new ST_6299: bitstring;
                                                {7031}new TTL_6300: bitstring;
                                                {7032}let m2_6301: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6298,ST_6299,TTL_6300) in
                                                {7033}out(c, m2_6301);
                                                {7034}let Ksrv_6302: bitstring = h((Ns_6298,Nc_6297)) in
                                                {7035}out(c, senc(mSrv(pkCli_6236,pkSess_5964),Ksrv_6302))
                                )
                                else
                                    {7036}let pkCli_6303: bitstring = fail-any in
                                    {7037}let v_6304: bool = (Disco_5014 = A) in
                                    (
                                        {7038}if v_6304 then
                                        (
                                            {7039}let pkDisco_6305: bitstring = pub(skA) in
                                            {7040}in(c, (=pkCli_6303,em1_6306: bitstring));
                                            {7041}let m1_6307: bitstring = em1_6306 in
                                            {7042}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6308: bitstring) = m1_6307 in
                                            {7043}new Ns_6309: bitstring;
                                            {7044}new ST_6310: bitstring;
                                            {7045}new TTL_6311: bitstring;
                                            {7046}let m2_6312: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6309,ST_6310,TTL_6311) in
                                            {7047}out(c, m2_6312);
                                            {7048}let Ksrv_6313: bitstring = h((Ns_6309,Nc_6308)) in
                                            {7049}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6313))
                                        )
                                        else
                                            {7050}let v_6314: bool = (Disco_5014 = B) in
                                            (
                                                {7051}if v_6314 then
                                                (
                                                    {7052}let pkDisco_6315: bitstring = pub(skB) in
                                                    {7053}in(c, (=pkCli_6303,em1_6316: bitstring));
                                                    {7054}let m1_6317: bitstring = em1_6316 in
                                                    {7055}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6318: bitstring) = m1_6317 in
                                                    {7056}new Ns_6319: bitstring;
                                                    {7057}new ST_6320: bitstring;
                                                    {7058}new TTL_6321: bitstring;
                                                    {7059}let m2_6322: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6319,ST_6320,TTL_6321) in
                                                    {7060}out(c, m2_6322);
                                                    {7061}let Ksrv_6323: bitstring = h((Ns_6319,Nc_6318)) in
                                                    {7062}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6323))
                                                )
                                                else
                                                    {7063}let v_6324: bool = (Disco_5014 = C) in
                                                    (
                                                        {7064}if v_6324 then
                                                        (
                                                            {7065}let pkDisco_6325: bitstring = pub(skC) in
                                                            {7066}in(c, (=pkCli_6303,em1_6326: bitstring));
                                                            {7067}let m1_6327: bitstring = em1_6326 in
                                                            {7068}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6328: bitstring) = m1_6327 in
                                                            {7069}new Ns_6329: bitstring;
                                                            {7070}new ST_6330: bitstring;
                                                            {7071}new TTL_6331: bitstring;
                                                            {7072}let m2_6332: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6329,ST_6330,TTL_6331) in
                                                            {7073}out(c, m2_6332);
                                                            {7074}let Ksrv_6333: bitstring = h((Ns_6329,Nc_6328)) in
                                                            {7075}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6333))
                                                        )
                                                        else
                                                            {7076}let pkDisco_6334: bitstring = pub(sk(Disco_5014)) in
                                                            {7077}in(c, (=pkCli_6303,em1_6335: bitstring));
                                                            {7078}let m1_6336: bitstring = em1_6335 in
                                                            {7079}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6337: bitstring) = m1_6336 in
                                                            {7080}new Ns_6338: bitstring;
                                                            {7081}new ST_6339: bitstring;
                                                            {7082}new TTL_6340: bitstring;
                                                            {7083}let m2_6341: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6338,ST_6339,TTL_6340) in
                                                            {7084}out(c, m2_6341);
                                                            {7085}let Ksrv_6342: bitstring = h((Ns_6338,Nc_6337)) in
                                                            {7086}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6342))
                                                    )
                                                    else
                                                        {7087}let pkDisco_6343: bitstring = fail-any in
                                                        {7088}in(c, (=pkCli_6303,em1_6344: bitstring));
                                                        {7089}let m1_6345: bitstring = em1_6344 in
                                                        {7090}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6346: bitstring) = m1_6345 in
                                                        {7091}new Ns_6347: bitstring;
                                                        {7092}new ST_6348: bitstring;
                                                        {7093}new TTL_6349: bitstring;
                                                        {7094}let m2_6350: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6347,ST_6348,TTL_6349) in
                                                        {7095}out(c, m2_6350);
                                                        {7096}let Ksrv_6351: bitstring = h((Ns_6347,Nc_6346)) in
                                                        {7097}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6351))
                                            )
                                            else
                                                {7098}let pkDisco_6352: bitstring = fail-any in
                                                {7099}in(c, (=pkCli_6303,em1_6353: bitstring));
                                                {7100}let m1_6354: bitstring = em1_6353 in
                                                {7101}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6355: bitstring) = m1_6354 in
                                                {7102}new Ns_6356: bitstring;
                                                {7103}new ST_6357: bitstring;
                                                {7104}new TTL_6358: bitstring;
                                                {7105}let m2_6359: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6356,ST_6357,TTL_6358) in
                                                {7106}out(c, m2_6359);
                                                {7107}let Ksrv_6360: bitstring = h((Ns_6356,Nc_6355)) in
                                                {7108}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6360))
                                    )
                                    else
                                        {7109}let pkDisco_6361: bitstring = fail-any in
                                        {7110}in(c, (=pkCli_6303,em1_6362: bitstring));
                                        {7111}let m1_6363: bitstring = em1_6362 in
                                        {7112}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6303,Nc_6364: bitstring) = m1_6363 in
                                        {7113}new Ns_6365: bitstring;
                                        {7114}new ST_6366: bitstring;
                                        {7115}new TTL_6367: bitstring;
                                        {7116}let m2_6368: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6365,ST_6366,TTL_6367) in
                                        {7117}out(c, m2_6368);
                                        {7118}let Ksrv_6369: bitstring = h((Ns_6365,Nc_6364)) in
                                        {7119}out(c, senc(mSrv(pkCli_6303,pkSess_5964),Ksrv_6369))
                        )
                        else
                            {7120}let pkCli_6370: bitstring = fail-any in
                            {7121}let v_6371: bool = (Disco_5014 = A) in
                            (
                                {7122}if v_6371 then
                                (
                                    {7123}let pkDisco_6372: bitstring = pub(skA) in
                                    {7124}in(c, (=pkCli_6370,em1_6373: bitstring));
                                    {7125}let m1_6374: bitstring = em1_6373 in
                                    {7126}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6375: bitstring) = m1_6374 in
                                    {7127}new Ns_6376: bitstring;
                                    {7128}new ST_6377: bitstring;
                                    {7129}new TTL_6378: bitstring;
                                    {7130}let m2_6379: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6376,ST_6377,TTL_6378) in
                                    {7131}out(c, m2_6379);
                                    {7132}let Ksrv_6380: bitstring = h((Ns_6376,Nc_6375)) in
                                    {7133}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6380))
                                )
                                else
                                    {7134}let v_6381: bool = (Disco_5014 = B) in
                                    (
                                        {7135}if v_6381 then
                                        (
                                            {7136}let pkDisco_6382: bitstring = pub(skB) in
                                            {7137}in(c, (=pkCli_6370,em1_6383: bitstring));
                                            {7138}let m1_6384: bitstring = em1_6383 in
                                            {7139}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6385: bitstring) = m1_6384 in
                                            {7140}new Ns_6386: bitstring;
                                            {7141}new ST_6387: bitstring;
                                            {7142}new TTL_6388: bitstring;
                                            {7143}let m2_6389: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6386,ST_6387,TTL_6388) in
                                            {7144}out(c, m2_6389);
                                            {7145}let Ksrv_6390: bitstring = h((Ns_6386,Nc_6385)) in
                                            {7146}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6390))
                                        )
                                        else
                                            {7147}let v_6391: bool = (Disco_5014 = C) in
                                            (
                                                {7148}if v_6391 then
                                                (
                                                    {7149}let pkDisco_6392: bitstring = pub(skC) in
                                                    {7150}in(c, (=pkCli_6370,em1_6393: bitstring));
                                                    {7151}let m1_6394: bitstring = em1_6393 in
                                                    {7152}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6395: bitstring) = m1_6394 in
                                                    {7153}new Ns_6396: bitstring;
                                                    {7154}new ST_6397: bitstring;
                                                    {7155}new TTL_6398: bitstring;
                                                    {7156}let m2_6399: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6396,ST_6397,TTL_6398) in
                                                    {7157}out(c, m2_6399);
                                                    {7158}let Ksrv_6400: bitstring = h((Ns_6396,Nc_6395)) in
                                                    {7159}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6400))
                                                )
                                                else
                                                    {7160}let pkDisco_6401: bitstring = pub(sk(Disco_5014)) in
                                                    {7161}in(c, (=pkCli_6370,em1_6402: bitstring));
                                                    {7162}let m1_6403: bitstring = em1_6402 in
                                                    {7163}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6404: bitstring) = m1_6403 in
                                                    {7164}new Ns_6405: bitstring;
                                                    {7165}new ST_6406: bitstring;
                                                    {7166}new TTL_6407: bitstring;
                                                    {7167}let m2_6408: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6405,ST_6406,TTL_6407) in
                                                    {7168}out(c, m2_6408);
                                                    {7169}let Ksrv_6409: bitstring = h((Ns_6405,Nc_6404)) in
                                                    {7170}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6409))
                                            )
                                            else
                                                {7171}let pkDisco_6410: bitstring = fail-any in
                                                {7172}in(c, (=pkCli_6370,em1_6411: bitstring));
                                                {7173}let m1_6412: bitstring = em1_6411 in
                                                {7174}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6413: bitstring) = m1_6412 in
                                                {7175}new Ns_6414: bitstring;
                                                {7176}new ST_6415: bitstring;
                                                {7177}new TTL_6416: bitstring;
                                                {7178}let m2_6417: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6414,ST_6415,TTL_6416) in
                                                {7179}out(c, m2_6417);
                                                {7180}let Ksrv_6418: bitstring = h((Ns_6414,Nc_6413)) in
                                                {7181}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6418))
                                    )
                                    else
                                        {7182}let pkDisco_6419: bitstring = fail-any in
                                        {7183}in(c, (=pkCli_6370,em1_6420: bitstring));
                                        {7184}let m1_6421: bitstring = em1_6420 in
                                        {7185}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6422: bitstring) = m1_6421 in
                                        {7186}new Ns_6423: bitstring;
                                        {7187}new ST_6424: bitstring;
                                        {7188}new TTL_6425: bitstring;
                                        {7189}let m2_6426: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6423,ST_6424,TTL_6425) in
                                        {7190}out(c, m2_6426);
                                        {7191}let Ksrv_6427: bitstring = h((Ns_6423,Nc_6422)) in
                                        {7192}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6427))
                            )
                            else
                                {7193}let pkDisco_6428: bitstring = fail-any in
                                {7194}in(c, (=pkCli_6370,em1_6429: bitstring));
                                {7195}let m1_6430: bitstring = em1_6429 in
                                {7196}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6370,Nc_6431: bitstring) = m1_6430 in
                                {7197}new Ns_6432: bitstring;
                                {7198}new ST_6433: bitstring;
                                {7199}new TTL_6434: bitstring;
                                {7200}let m2_6435: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6432,ST_6433,TTL_6434) in
                                {7201}out(c, m2_6435);
                                {7202}let Ksrv_6436: bitstring = h((Ns_6432,Nc_6431)) in
                                {7203}out(c, senc(mSrv(pkCli_6370,pkSess_5964),Ksrv_6436))
                    )
                    else
                        {7204}let skSess_6437: bitstring = fail-any in
                        {7205}let pkSess_6438: bitstring = pub(skSess_6437) in
                        {7206}let v_6439: bool = (Cli_5013 = A) in
                        (
                            {7207}if v_6439 then
                            (
                                {7208}let pkCli_6440: bitstring = pub(skA) in
                                {7209}let v_6441: bool = (Disco_5014 = A) in
                                (
                                    {7210}if v_6441 then
                                    (
                                        {7211}let pkDisco_6442: bitstring = pub(skA) in
                                        {7212}in(c, (=pkCli_6440,em1_6443: bitstring));
                                        {7213}let m1_6444: bitstring = em1_6443 in
                                        {7214}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6445: bitstring) = m1_6444 in
                                        {7215}new Ns_6446: bitstring;
                                        {7216}new ST_6447: bitstring;
                                        {7217}new TTL_6448: bitstring;
                                        {7218}let m2_6449: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6446,ST_6447,TTL_6448) in
                                        {7219}out(c, m2_6449);
                                        {7220}let Ksrv_6450: bitstring = h((Ns_6446,Nc_6445)) in
                                        {7221}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6450))
                                    )
                                    else
                                        {7222}let v_6451: bool = (Disco_5014 = B) in
                                        (
                                            {7223}if v_6451 then
                                            (
                                                {7224}let pkDisco_6452: bitstring = pub(skB) in
                                                {7225}in(c, (=pkCli_6440,em1_6453: bitstring));
                                                {7226}let m1_6454: bitstring = em1_6453 in
                                                {7227}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6455: bitstring) = m1_6454 in
                                                {7228}new Ns_6456: bitstring;
                                                {7229}new ST_6457: bitstring;
                                                {7230}new TTL_6458: bitstring;
                                                {7231}let m2_6459: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6456,ST_6457,TTL_6458) in
                                                {7232}out(c, m2_6459);
                                                {7233}let Ksrv_6460: bitstring = h((Ns_6456,Nc_6455)) in
                                                {7234}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6460))
                                            )
                                            else
                                                {7235}let v_6461: bool = (Disco_5014 = C) in
                                                (
                                                    {7236}if v_6461 then
                                                    (
                                                        {7237}let pkDisco_6462: bitstring = pub(skC) in
                                                        {7238}in(c, (=pkCli_6440,em1_6463: bitstring));
                                                        {7239}let m1_6464: bitstring = em1_6463 in
                                                        {7240}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6465: bitstring) = m1_6464 in
                                                        {7241}new Ns_6466: bitstring;
                                                        {7242}new ST_6467: bitstring;
                                                        {7243}new TTL_6468: bitstring;
                                                        {7244}let m2_6469: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6466,ST_6467,TTL_6468) in
                                                        {7245}out(c, m2_6469);
                                                        {7246}let Ksrv_6470: bitstring = h((Ns_6466,Nc_6465)) in
                                                        {7247}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6470))
                                                    )
                                                    else
                                                        {7248}let pkDisco_6471: bitstring = pub(sk(Disco_5014)) in
                                                        {7249}in(c, (=pkCli_6440,em1_6472: bitstring));
                                                        {7250}let m1_6473: bitstring = em1_6472 in
                                                        {7251}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6474: bitstring) = m1_6473 in
                                                        {7252}new Ns_6475: bitstring;
                                                        {7253}new ST_6476: bitstring;
                                                        {7254}new TTL_6477: bitstring;
                                                        {7255}let m2_6478: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6475,ST_6476,TTL_6477) in
                                                        {7256}out(c, m2_6478);
                                                        {7257}let Ksrv_6479: bitstring = h((Ns_6475,Nc_6474)) in
                                                        {7258}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6479))
                                                )
                                                else
                                                    {7259}let pkDisco_6480: bitstring = fail-any in
                                                    {7260}in(c, (=pkCli_6440,em1_6481: bitstring));
                                                    {7261}let m1_6482: bitstring = em1_6481 in
                                                    {7262}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6483: bitstring) = m1_6482 in
                                                    {7263}new Ns_6484: bitstring;
                                                    {7264}new ST_6485: bitstring;
                                                    {7265}new TTL_6486: bitstring;
                                                    {7266}let m2_6487: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6484,ST_6485,TTL_6486) in
                                                    {7267}out(c, m2_6487);
                                                    {7268}let Ksrv_6488: bitstring = h((Ns_6484,Nc_6483)) in
                                                    {7269}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6488))
                                        )
                                        else
                                            {7270}let pkDisco_6489: bitstring = fail-any in
                                            {7271}in(c, (=pkCli_6440,em1_6490: bitstring));
                                            {7272}let m1_6491: bitstring = em1_6490 in
                                            {7273}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6492: bitstring) = m1_6491 in
                                            {7274}new Ns_6493: bitstring;
                                            {7275}new ST_6494: bitstring;
                                            {7276}new TTL_6495: bitstring;
                                            {7277}let m2_6496: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6493,ST_6494,TTL_6495) in
                                            {7278}out(c, m2_6496);
                                            {7279}let Ksrv_6497: bitstring = h((Ns_6493,Nc_6492)) in
                                            {7280}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6497))
                                )
                                else
                                    {7281}let pkDisco_6498: bitstring = fail-any in
                                    {7282}in(c, (=pkCli_6440,em1_6499: bitstring));
                                    {7283}let m1_6500: bitstring = em1_6499 in
                                    {7284}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6440,Nc_6501: bitstring) = m1_6500 in
                                    {7285}new Ns_6502: bitstring;
                                    {7286}new ST_6503: bitstring;
                                    {7287}new TTL_6504: bitstring;
                                    {7288}let m2_6505: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6502,ST_6503,TTL_6504) in
                                    {7289}out(c, m2_6505);
                                    {7290}let Ksrv_6506: bitstring = h((Ns_6502,Nc_6501)) in
                                    {7291}out(c, senc(mSrv(pkCli_6440,pkSess_6438),Ksrv_6506))
                            )
                            else
                                {7292}let v_6507: bool = (Cli_5013 = B) in
                                (
                                    {7293}if v_6507 then
                                    (
                                        {7294}let pkCli_6508: bitstring = pub(skB) in
                                        {7295}let v_6509: bool = (Disco_5014 = A) in
                                        (
                                            {7296}if v_6509 then
                                            (
                                                {7297}let pkDisco_6510: bitstring = pub(skA) in
                                                {7298}in(c, (=pkCli_6508,em1_6511: bitstring));
                                                {7299}let m1_6512: bitstring = em1_6511 in
                                                {7300}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6513: bitstring) = m1_6512 in
                                                {7301}new Ns_6514: bitstring;
                                                {7302}new ST_6515: bitstring;
                                                {7303}new TTL_6516: bitstring;
                                                {7304}let m2_6517: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6514,ST_6515,TTL_6516) in
                                                {7305}out(c, m2_6517);
                                                {7306}let Ksrv_6518: bitstring = h((Ns_6514,Nc_6513)) in
                                                {7307}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6518))
                                            )
                                            else
                                                {7308}let v_6519: bool = (Disco_5014 = B) in
                                                (
                                                    {7309}if v_6519 then
                                                    (
                                                        {7310}let pkDisco_6520: bitstring = pub(skB) in
                                                        {7311}in(c, (=pkCli_6508,em1_6521: bitstring));
                                                        {7312}let m1_6522: bitstring = em1_6521 in
                                                        {7313}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6523: bitstring) = m1_6522 in
                                                        {7314}new Ns_6524: bitstring;
                                                        {7315}new ST_6525: bitstring;
                                                        {7316}new TTL_6526: bitstring;
                                                        {7317}let m2_6527: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6524,ST_6525,TTL_6526) in
                                                        {7318}out(c, m2_6527);
                                                        {7319}let Ksrv_6528: bitstring = h((Ns_6524,Nc_6523)) in
                                                        {7320}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6528))
                                                    )
                                                    else
                                                        {7321}let v_6529: bool = (Disco_5014 = C) in
                                                        (
                                                            {7322}if v_6529 then
                                                            (
                                                                {7323}let pkDisco_6530: bitstring = pub(skC) in
                                                                {7324}in(c, (=pkCli_6508,em1_6531: bitstring));
                                                                {7325}let m1_6532: bitstring = em1_6531 in
                                                                {7326}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6533: bitstring) = m1_6532 in
                                                                {7327}new Ns_6534: bitstring;
                                                                {7328}new ST_6535: bitstring;
                                                                {7329}new TTL_6536: bitstring;
                                                                {7330}let m2_6537: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6534,ST_6535,TTL_6536) in
                                                                {7331}out(c, m2_6537);
                                                                {7332}let Ksrv_6538: bitstring = h((Ns_6534,Nc_6533)) in
                                                                {7333}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6538))
                                                            )
                                                            else
                                                                {7334}let pkDisco_6539: bitstring = pub(sk(Disco_5014)) in
                                                                {7335}in(c, (=pkCli_6508,em1_6540: bitstring));
                                                                {7336}let m1_6541: bitstring = em1_6540 in
                                                                {7337}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6542: bitstring) = m1_6541 in
                                                                {7338}new Ns_6543: bitstring;
                                                                {7339}new ST_6544: bitstring;
                                                                {7340}new TTL_6545: bitstring;
                                                                {7341}let m2_6546: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6543,ST_6544,TTL_6545) in
                                                                {7342}out(c, m2_6546);
                                                                {7343}let Ksrv_6547: bitstring = h((Ns_6543,Nc_6542)) in
                                                                {7344}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6547))
                                                        )
                                                        else
                                                            {7345}let pkDisco_6548: bitstring = fail-any in
                                                            {7346}in(c, (=pkCli_6508,em1_6549: bitstring));
                                                            {7347}let m1_6550: bitstring = em1_6549 in
                                                            {7348}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6551: bitstring) = m1_6550 in
                                                            {7349}new Ns_6552: bitstring;
                                                            {7350}new ST_6553: bitstring;
                                                            {7351}new TTL_6554: bitstring;
                                                            {7352}let m2_6555: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6552,ST_6553,TTL_6554) in
                                                            {7353}out(c, m2_6555);
                                                            {7354}let Ksrv_6556: bitstring = h((Ns_6552,Nc_6551)) in
                                                            {7355}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6556))
                                                )
                                                else
                                                    {7356}let pkDisco_6557: bitstring = fail-any in
                                                    {7357}in(c, (=pkCli_6508,em1_6558: bitstring));
                                                    {7358}let m1_6559: bitstring = em1_6558 in
                                                    {7359}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6560: bitstring) = m1_6559 in
                                                    {7360}new Ns_6561: bitstring;
                                                    {7361}new ST_6562: bitstring;
                                                    {7362}new TTL_6563: bitstring;
                                                    {7363}let m2_6564: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6561,ST_6562,TTL_6563) in
                                                    {7364}out(c, m2_6564);
                                                    {7365}let Ksrv_6565: bitstring = h((Ns_6561,Nc_6560)) in
                                                    {7366}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6565))
                                        )
                                        else
                                            {7367}let pkDisco_6566: bitstring = fail-any in
                                            {7368}in(c, (=pkCli_6508,em1_6567: bitstring));
                                            {7369}let m1_6568: bitstring = em1_6567 in
                                            {7370}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6508,Nc_6569: bitstring) = m1_6568 in
                                            {7371}new Ns_6570: bitstring;
                                            {7372}new ST_6571: bitstring;
                                            {7373}new TTL_6572: bitstring;
                                            {7374}let m2_6573: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6570,ST_6571,TTL_6572) in
                                            {7375}out(c, m2_6573);
                                            {7376}let Ksrv_6574: bitstring = h((Ns_6570,Nc_6569)) in
                                            {7377}out(c, senc(mSrv(pkCli_6508,pkSess_6438),Ksrv_6574))
                                    )
                                    else
                                        {7378}let v_6575: bool = (Cli_5013 = C) in
                                        (
                                            {7379}if v_6575 then
                                            (
                                                {7380}let pkCli_6576: bitstring = pub(skC) in
                                                {7381}let v_6577: bool = (Disco_5014 = A) in
                                                (
                                                    {7382}if v_6577 then
                                                    (
                                                        {7383}let pkDisco_6578: bitstring = pub(skA) in
                                                        {7384}in(c, (=pkCli_6576,em1_6579: bitstring));
                                                        {7385}let m1_6580: bitstring = em1_6579 in
                                                        {7386}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6581: bitstring) = m1_6580 in
                                                        {7387}new Ns_6582: bitstring;
                                                        {7388}new ST_6583: bitstring;
                                                        {7389}new TTL_6584: bitstring;
                                                        {7390}let m2_6585: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6582,ST_6583,TTL_6584) in
                                                        {7391}out(c, m2_6585);
                                                        {7392}let Ksrv_6586: bitstring = h((Ns_6582,Nc_6581)) in
                                                        {7393}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6586))
                                                    )
                                                    else
                                                        {7394}let v_6587: bool = (Disco_5014 = B) in
                                                        (
                                                            {7395}if v_6587 then
                                                            (
                                                                {7396}let pkDisco_6588: bitstring = pub(skB) in
                                                                {7397}in(c, (=pkCli_6576,em1_6589: bitstring));
                                                                {7398}let m1_6590: bitstring = em1_6589 in
                                                                {7399}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6591: bitstring) = m1_6590 in
                                                                {7400}new Ns_6592: bitstring;
                                                                {7401}new ST_6593: bitstring;
                                                                {7402}new TTL_6594: bitstring;
                                                                {7403}let m2_6595: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6592,ST_6593,TTL_6594) in
                                                                {7404}out(c, m2_6595);
                                                                {7405}let Ksrv_6596: bitstring = h((Ns_6592,Nc_6591)) in
                                                                {7406}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6596))
                                                            )
                                                            else
                                                                {7407}let v_6597: bool = (Disco_5014 = C) in
                                                                (
                                                                    {7408}if v_6597 then
                                                                    (
                                                                        {7409}let pkDisco_6598: bitstring = pub(skC) in
                                                                        {7410}in(c, (=pkCli_6576,em1_6599: bitstring));
                                                                        {7411}let m1_6600: bitstring = em1_6599 in
                                                                        {7412}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6601: bitstring) = m1_6600 in
                                                                        {7413}new Ns_6602: bitstring;
                                                                        {7414}new ST_6603: bitstring;
                                                                        {7415}new TTL_6604: bitstring;
                                                                        {7416}let m2_6605: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6602,ST_6603,TTL_6604) in
                                                                        {7417}out(c, m2_6605);
                                                                        {7418}let Ksrv_6606: bitstring = h((Ns_6602,Nc_6601)) in
                                                                        {7419}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6606))
                                                                    )
                                                                    else
                                                                        {7420}let pkDisco_6607: bitstring = pub(sk(Disco_5014)) in
                                                                        {7421}in(c, (=pkCli_6576,em1_6608: bitstring));
                                                                        {7422}let m1_6609: bitstring = em1_6608 in
                                                                        {7423}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6610: bitstring) = m1_6609 in
                                                                        {7424}new Ns_6611: bitstring;
                                                                        {7425}new ST_6612: bitstring;
                                                                        {7426}new TTL_6613: bitstring;
                                                                        {7427}let m2_6614: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6611,ST_6612,TTL_6613) in
                                                                        {7428}out(c, m2_6614);
                                                                        {7429}let Ksrv_6615: bitstring = h((Ns_6611,Nc_6610)) in
                                                                        {7430}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6615))
                                                                )
                                                                else
                                                                    {7431}let pkDisco_6616: bitstring = fail-any in
                                                                    {7432}in(c, (=pkCli_6576,em1_6617: bitstring));
                                                                    {7433}let m1_6618: bitstring = em1_6617 in
                                                                    {7434}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6619: bitstring) = m1_6618 in
                                                                    {7435}new Ns_6620: bitstring;
                                                                    {7436}new ST_6621: bitstring;
                                                                    {7437}new TTL_6622: bitstring;
                                                                    {7438}let m2_6623: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6620,ST_6621,TTL_6622) in
                                                                    {7439}out(c, m2_6623);
                                                                    {7440}let Ksrv_6624: bitstring = h((Ns_6620,Nc_6619)) in
                                                                    {7441}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6624))
                                                        )
                                                        else
                                                            {7442}let pkDisco_6625: bitstring = fail-any in
                                                            {7443}in(c, (=pkCli_6576,em1_6626: bitstring));
                                                            {7444}let m1_6627: bitstring = em1_6626 in
                                                            {7445}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6628: bitstring) = m1_6627 in
                                                            {7446}new Ns_6629: bitstring;
                                                            {7447}new ST_6630: bitstring;
                                                            {7448}new TTL_6631: bitstring;
                                                            {7449}let m2_6632: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6629,ST_6630,TTL_6631) in
                                                            {7450}out(c, m2_6632);
                                                            {7451}let Ksrv_6633: bitstring = h((Ns_6629,Nc_6628)) in
                                                            {7452}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6633))
                                                )
                                                else
                                                    {7453}let pkDisco_6634: bitstring = fail-any in
                                                    {7454}in(c, (=pkCli_6576,em1_6635: bitstring));
                                                    {7455}let m1_6636: bitstring = em1_6635 in
                                                    {7456}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6576,Nc_6637: bitstring) = m1_6636 in
                                                    {7457}new Ns_6638: bitstring;
                                                    {7458}new ST_6639: bitstring;
                                                    {7459}new TTL_6640: bitstring;
                                                    {7460}let m2_6641: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6638,ST_6639,TTL_6640) in
                                                    {7461}out(c, m2_6641);
                                                    {7462}let Ksrv_6642: bitstring = h((Ns_6638,Nc_6637)) in
                                                    {7463}out(c, senc(mSrv(pkCli_6576,pkSess_6438),Ksrv_6642))
                                            )
                                            else
                                                {7464}let pkCli_6643: bitstring = pub(sk(Cli_5013)) in
                                                {7465}let v_6644: bool = (Disco_5014 = A) in
                                                (
                                                    {7466}if v_6644 then
                                                    (
                                                        {7467}let pkDisco_6645: bitstring = pub(skA) in
                                                        {7468}in(c, (=pkCli_6643,em1_6646: bitstring));
                                                        {7469}let m1_6647: bitstring = em1_6646 in
                                                        {7470}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6648: bitstring) = m1_6647 in
                                                        {7471}new Ns_6649: bitstring;
                                                        {7472}new ST_6650: bitstring;
                                                        {7473}new TTL_6651: bitstring;
                                                        {7474}let m2_6652: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6649,ST_6650,TTL_6651) in
                                                        {7475}out(c, m2_6652);
                                                        {7476}let Ksrv_6653: bitstring = h((Ns_6649,Nc_6648)) in
                                                        {7477}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6653))
                                                    )
                                                    else
                                                        {7478}let v_6654: bool = (Disco_5014 = B) in
                                                        (
                                                            {7479}if v_6654 then
                                                            (
                                                                {7480}let pkDisco_6655: bitstring = pub(skB) in
                                                                {7481}in(c, (=pkCli_6643,em1_6656: bitstring));
                                                                {7482}let m1_6657: bitstring = em1_6656 in
                                                                {7483}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6658: bitstring) = m1_6657 in
                                                                {7484}new Ns_6659: bitstring;
                                                                {7485}new ST_6660: bitstring;
                                                                {7486}new TTL_6661: bitstring;
                                                                {7487}let m2_6662: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6659,ST_6660,TTL_6661) in
                                                                {7488}out(c, m2_6662);
                                                                {7489}let Ksrv_6663: bitstring = h((Ns_6659,Nc_6658)) in
                                                                {7490}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6663))
                                                            )
                                                            else
                                                                {7491}let v_6664: bool = (Disco_5014 = C) in
                                                                (
                                                                    {7492}if v_6664 then
                                                                    (
                                                                        {7493}let pkDisco_6665: bitstring = pub(skC) in
                                                                        {7494}in(c, (=pkCli_6643,em1_6666: bitstring));
                                                                        {7495}let m1_6667: bitstring = em1_6666 in
                                                                        {7496}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6668: bitstring) = m1_6667 in
                                                                        {7497}new Ns_6669: bitstring;
                                                                        {7498}new ST_6670: bitstring;
                                                                        {7499}new TTL_6671: bitstring;
                                                                        {7500}let m2_6672: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6669,ST_6670,TTL_6671) in
                                                                        {7501}out(c, m2_6672);
                                                                        {7502}let Ksrv_6673: bitstring = h((Ns_6669,Nc_6668)) in
                                                                        {7503}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6673))
                                                                    )
                                                                    else
                                                                        {7504}let pkDisco_6674: bitstring = pub(sk(Disco_5014)) in
                                                                        {7505}in(c, (=pkCli_6643,em1_6675: bitstring));
                                                                        {7506}let m1_6676: bitstring = em1_6675 in
                                                                        {7507}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6677: bitstring) = m1_6676 in
                                                                        {7508}new Ns_6678: bitstring;
                                                                        {7509}new ST_6679: bitstring;
                                                                        {7510}new TTL_6680: bitstring;
                                                                        {7511}let m2_6681: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6678,ST_6679,TTL_6680) in
                                                                        {7512}out(c, m2_6681);
                                                                        {7513}let Ksrv_6682: bitstring = h((Ns_6678,Nc_6677)) in
                                                                        {7514}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6682))
                                                                )
                                                                else
                                                                    {7515}let pkDisco_6683: bitstring = fail-any in
                                                                    {7516}in(c, (=pkCli_6643,em1_6684: bitstring));
                                                                    {7517}let m1_6685: bitstring = em1_6684 in
                                                                    {7518}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6686: bitstring) = m1_6685 in
                                                                    {7519}new Ns_6687: bitstring;
                                                                    {7520}new ST_6688: bitstring;
                                                                    {7521}new TTL_6689: bitstring;
                                                                    {7522}let m2_6690: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6687,ST_6688,TTL_6689) in
                                                                    {7523}out(c, m2_6690);
                                                                    {7524}let Ksrv_6691: bitstring = h((Ns_6687,Nc_6686)) in
                                                                    {7525}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6691))
                                                        )
                                                        else
                                                            {7526}let pkDisco_6692: bitstring = fail-any in
                                                            {7527}in(c, (=pkCli_6643,em1_6693: bitstring));
                                                            {7528}let m1_6694: bitstring = em1_6693 in
                                                            {7529}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6695: bitstring) = m1_6694 in
                                                            {7530}new Ns_6696: bitstring;
                                                            {7531}new ST_6697: bitstring;
                                                            {7532}new TTL_6698: bitstring;
                                                            {7533}let m2_6699: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6696,ST_6697,TTL_6698) in
                                                            {7534}out(c, m2_6699);
                                                            {7535}let Ksrv_6700: bitstring = h((Ns_6696,Nc_6695)) in
                                                            {7536}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6700))
                                                )
                                                else
                                                    {7537}let pkDisco_6701: bitstring = fail-any in
                                                    {7538}in(c, (=pkCli_6643,em1_6702: bitstring));
                                                    {7539}let m1_6703: bitstring = em1_6702 in
                                                    {7540}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6643,Nc_6704: bitstring) = m1_6703 in
                                                    {7541}new Ns_6705: bitstring;
                                                    {7542}new ST_6706: bitstring;
                                                    {7543}new TTL_6707: bitstring;
                                                    {7544}let m2_6708: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6705,ST_6706,TTL_6707) in
                                                    {7545}out(c, m2_6708);
                                                    {7546}let Ksrv_6709: bitstring = h((Ns_6705,Nc_6704)) in
                                                    {7547}out(c, senc(mSrv(pkCli_6643,pkSess_6438),Ksrv_6709))
                                        )
                                        else
                                            {7548}let pkCli_6710: bitstring = fail-any in
                                            {7549}let v_6711: bool = (Disco_5014 = A) in
                                            (
                                                {7550}if v_6711 then
                                                (
                                                    {7551}let pkDisco_6712: bitstring = pub(skA) in
                                                    {7552}in(c, (=pkCli_6710,em1_6713: bitstring));
                                                    {7553}let m1_6714: bitstring = em1_6713 in
                                                    {7554}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6715: bitstring) = m1_6714 in
                                                    {7555}new Ns_6716: bitstring;
                                                    {7556}new ST_6717: bitstring;
                                                    {7557}new TTL_6718: bitstring;
                                                    {7558}let m2_6719: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6716,ST_6717,TTL_6718) in
                                                    {7559}out(c, m2_6719);
                                                    {7560}let Ksrv_6720: bitstring = h((Ns_6716,Nc_6715)) in
                                                    {7561}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6720))
                                                )
                                                else
                                                    {7562}let v_6721: bool = (Disco_5014 = B) in
                                                    (
                                                        {7563}if v_6721 then
                                                        (
                                                            {7564}let pkDisco_6722: bitstring = pub(skB) in
                                                            {7565}in(c, (=pkCli_6710,em1_6723: bitstring));
                                                            {7566}let m1_6724: bitstring = em1_6723 in
                                                            {7567}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6725: bitstring) = m1_6724 in
                                                            {7568}new Ns_6726: bitstring;
                                                            {7569}new ST_6727: bitstring;
                                                            {7570}new TTL_6728: bitstring;
                                                            {7571}let m2_6729: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6726,ST_6727,TTL_6728) in
                                                            {7572}out(c, m2_6729);
                                                            {7573}let Ksrv_6730: bitstring = h((Ns_6726,Nc_6725)) in
                                                            {7574}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6730))
                                                        )
                                                        else
                                                            {7575}let v_6731: bool = (Disco_5014 = C) in
                                                            (
                                                                {7576}if v_6731 then
                                                                (
                                                                    {7577}let pkDisco_6732: bitstring = pub(skC) in
                                                                    {7578}in(c, (=pkCli_6710,em1_6733: bitstring));
                                                                    {7579}let m1_6734: bitstring = em1_6733 in
                                                                    {7580}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6735: bitstring) = m1_6734 in
                                                                    {7581}new Ns_6736: bitstring;
                                                                    {7582}new ST_6737: bitstring;
                                                                    {7583}new TTL_6738: bitstring;
                                                                    {7584}let m2_6739: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6736,ST_6737,TTL_6738) in
                                                                    {7585}out(c, m2_6739);
                                                                    {7586}let Ksrv_6740: bitstring = h((Ns_6736,Nc_6735)) in
                                                                    {7587}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6740))
                                                                )
                                                                else
                                                                    {7588}let pkDisco_6741: bitstring = pub(sk(Disco_5014)) in
                                                                    {7589}in(c, (=pkCli_6710,em1_6742: bitstring));
                                                                    {7590}let m1_6743: bitstring = em1_6742 in
                                                                    {7591}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6744: bitstring) = m1_6743 in
                                                                    {7592}new Ns_6745: bitstring;
                                                                    {7593}new ST_6746: bitstring;
                                                                    {7594}new TTL_6747: bitstring;
                                                                    {7595}let m2_6748: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6745,ST_6746,TTL_6747) in
                                                                    {7596}out(c, m2_6748);
                                                                    {7597}let Ksrv_6749: bitstring = h((Ns_6745,Nc_6744)) in
                                                                    {7598}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6749))
                                                            )
                                                            else
                                                                {7599}let pkDisco_6750: bitstring = fail-any in
                                                                {7600}in(c, (=pkCli_6710,em1_6751: bitstring));
                                                                {7601}let m1_6752: bitstring = em1_6751 in
                                                                {7602}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6753: bitstring) = m1_6752 in
                                                                {7603}new Ns_6754: bitstring;
                                                                {7604}new ST_6755: bitstring;
                                                                {7605}new TTL_6756: bitstring;
                                                                {7606}let m2_6757: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6754,ST_6755,TTL_6756) in
                                                                {7607}out(c, m2_6757);
                                                                {7608}let Ksrv_6758: bitstring = h((Ns_6754,Nc_6753)) in
                                                                {7609}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6758))
                                                    )
                                                    else
                                                        {7610}let pkDisco_6759: bitstring = fail-any in
                                                        {7611}in(c, (=pkCli_6710,em1_6760: bitstring));
                                                        {7612}let m1_6761: bitstring = em1_6760 in
                                                        {7613}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6762: bitstring) = m1_6761 in
                                                        {7614}new Ns_6763: bitstring;
                                                        {7615}new ST_6764: bitstring;
                                                        {7616}new TTL_6765: bitstring;
                                                        {7617}let m2_6766: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6763,ST_6764,TTL_6765) in
                                                        {7618}out(c, m2_6766);
                                                        {7619}let Ksrv_6767: bitstring = h((Ns_6763,Nc_6762)) in
                                                        {7620}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6767))
                                            )
                                            else
                                                {7621}let pkDisco_6768: bitstring = fail-any in
                                                {7622}in(c, (=pkCli_6710,em1_6769: bitstring));
                                                {7623}let m1_6770: bitstring = em1_6769 in
                                                {7624}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6710,Nc_6771: bitstring) = m1_6770 in
                                                {7625}new Ns_6772: bitstring;
                                                {7626}new ST_6773: bitstring;
                                                {7627}new TTL_6774: bitstring;
                                                {7628}let m2_6775: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6772,ST_6773,TTL_6774) in
                                                {7629}out(c, m2_6775);
                                                {7630}let Ksrv_6776: bitstring = h((Ns_6772,Nc_6771)) in
                                                {7631}out(c, senc(mSrv(pkCli_6710,pkSess_6438),Ksrv_6776))
                                )
                                else
                                    {7632}let pkCli_6777: bitstring = fail-any in
                                    {7633}let v_6778: bool = (Disco_5014 = A) in
                                    (
                                        {7634}if v_6778 then
                                        (
                                            {7635}let pkDisco_6779: bitstring = pub(skA) in
                                            {7636}in(c, (=pkCli_6777,em1_6780: bitstring));
                                            {7637}let m1_6781: bitstring = em1_6780 in
                                            {7638}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6782: bitstring) = m1_6781 in
                                            {7639}new Ns_6783: bitstring;
                                            {7640}new ST_6784: bitstring;
                                            {7641}new TTL_6785: bitstring;
                                            {7642}let m2_6786: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6783,ST_6784,TTL_6785) in
                                            {7643}out(c, m2_6786);
                                            {7644}let Ksrv_6787: bitstring = h((Ns_6783,Nc_6782)) in
                                            {7645}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6787))
                                        )
                                        else
                                            {7646}let v_6788: bool = (Disco_5014 = B) in
                                            (
                                                {7647}if v_6788 then
                                                (
                                                    {7648}let pkDisco_6789: bitstring = pub(skB) in
                                                    {7649}in(c, (=pkCli_6777,em1_6790: bitstring));
                                                    {7650}let m1_6791: bitstring = em1_6790 in
                                                    {7651}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6792: bitstring) = m1_6791 in
                                                    {7652}new Ns_6793: bitstring;
                                                    {7653}new ST_6794: bitstring;
                                                    {7654}new TTL_6795: bitstring;
                                                    {7655}let m2_6796: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6793,ST_6794,TTL_6795) in
                                                    {7656}out(c, m2_6796);
                                                    {7657}let Ksrv_6797: bitstring = h((Ns_6793,Nc_6792)) in
                                                    {7658}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6797))
                                                )
                                                else
                                                    {7659}let v_6798: bool = (Disco_5014 = C) in
                                                    (
                                                        {7660}if v_6798 then
                                                        (
                                                            {7661}let pkDisco_6799: bitstring = pub(skC) in
                                                            {7662}in(c, (=pkCli_6777,em1_6800: bitstring));
                                                            {7663}let m1_6801: bitstring = em1_6800 in
                                                            {7664}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6802: bitstring) = m1_6801 in
                                                            {7665}new Ns_6803: bitstring;
                                                            {7666}new ST_6804: bitstring;
                                                            {7667}new TTL_6805: bitstring;
                                                            {7668}let m2_6806: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6803,ST_6804,TTL_6805) in
                                                            {7669}out(c, m2_6806);
                                                            {7670}let Ksrv_6807: bitstring = h((Ns_6803,Nc_6802)) in
                                                            {7671}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6807))
                                                        )
                                                        else
                                                            {7672}let pkDisco_6808: bitstring = pub(sk(Disco_5014)) in
                                                            {7673}in(c, (=pkCli_6777,em1_6809: bitstring));
                                                            {7674}let m1_6810: bitstring = em1_6809 in
                                                            {7675}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6811: bitstring) = m1_6810 in
                                                            {7676}new Ns_6812: bitstring;
                                                            {7677}new ST_6813: bitstring;
                                                            {7678}new TTL_6814: bitstring;
                                                            {7679}let m2_6815: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6812,ST_6813,TTL_6814) in
                                                            {7680}out(c, m2_6815);
                                                            {7681}let Ksrv_6816: bitstring = h((Ns_6812,Nc_6811)) in
                                                            {7682}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6816))
                                                    )
                                                    else
                                                        {7683}let pkDisco_6817: bitstring = fail-any in
                                                        {7684}in(c, (=pkCli_6777,em1_6818: bitstring));
                                                        {7685}let m1_6819: bitstring = em1_6818 in
                                                        {7686}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6820: bitstring) = m1_6819 in
                                                        {7687}new Ns_6821: bitstring;
                                                        {7688}new ST_6822: bitstring;
                                                        {7689}new TTL_6823: bitstring;
                                                        {7690}let m2_6824: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6821,ST_6822,TTL_6823) in
                                                        {7691}out(c, m2_6824);
                                                        {7692}let Ksrv_6825: bitstring = h((Ns_6821,Nc_6820)) in
                                                        {7693}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6825))
                                            )
                                            else
                                                {7694}let pkDisco_6826: bitstring = fail-any in
                                                {7695}in(c, (=pkCli_6777,em1_6827: bitstring));
                                                {7696}let m1_6828: bitstring = em1_6827 in
                                                {7697}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6829: bitstring) = m1_6828 in
                                                {7698}new Ns_6830: bitstring;
                                                {7699}new ST_6831: bitstring;
                                                {7700}new TTL_6832: bitstring;
                                                {7701}let m2_6833: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6830,ST_6831,TTL_6832) in
                                                {7702}out(c, m2_6833);
                                                {7703}let Ksrv_6834: bitstring = h((Ns_6830,Nc_6829)) in
                                                {7704}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6834))
                                    )
                                    else
                                        {7705}let pkDisco_6835: bitstring = fail-any in
                                        {7706}in(c, (=pkCli_6777,em1_6836: bitstring));
                                        {7707}let m1_6837: bitstring = em1_6836 in
                                        {7708}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6777,Nc_6838: bitstring) = m1_6837 in
                                        {7709}new Ns_6839: bitstring;
                                        {7710}new ST_6840: bitstring;
                                        {7711}new TTL_6841: bitstring;
                                        {7712}let m2_6842: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6839,ST_6840,TTL_6841) in
                                        {7713}out(c, m2_6842);
                                        {7714}let Ksrv_6843: bitstring = h((Ns_6839,Nc_6838)) in
                                        {7715}out(c, senc(mSrv(pkCli_6777,pkSess_6438),Ksrv_6843))
                        )
                        else
                            {7716}let pkCli_6844: bitstring = fail-any in
                            {7717}let v_6845: bool = (Disco_5014 = A) in
                            (
                                {7718}if v_6845 then
                                (
                                    {7719}let pkDisco_6846: bitstring = pub(skA) in
                                    {7720}in(c, (=pkCli_6844,em1_6847: bitstring));
                                    {7721}let m1_6848: bitstring = em1_6847 in
                                    {7722}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6849: bitstring) = m1_6848 in
                                    {7723}new Ns_6850: bitstring;
                                    {7724}new ST_6851: bitstring;
                                    {7725}new TTL_6852: bitstring;
                                    {7726}let m2_6853: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6850,ST_6851,TTL_6852) in
                                    {7727}out(c, m2_6853);
                                    {7728}let Ksrv_6854: bitstring = h((Ns_6850,Nc_6849)) in
                                    {7729}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6854))
                                )
                                else
                                    {7730}let v_6855: bool = (Disco_5014 = B) in
                                    (
                                        {7731}if v_6855 then
                                        (
                                            {7732}let pkDisco_6856: bitstring = pub(skB) in
                                            {7733}in(c, (=pkCli_6844,em1_6857: bitstring));
                                            {7734}let m1_6858: bitstring = em1_6857 in
                                            {7735}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6859: bitstring) = m1_6858 in
                                            {7736}new Ns_6860: bitstring;
                                            {7737}new ST_6861: bitstring;
                                            {7738}new TTL_6862: bitstring;
                                            {7739}let m2_6863: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6860,ST_6861,TTL_6862) in
                                            {7740}out(c, m2_6863);
                                            {7741}let Ksrv_6864: bitstring = h((Ns_6860,Nc_6859)) in
                                            {7742}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6864))
                                        )
                                        else
                                            {7743}let v_6865: bool = (Disco_5014 = C) in
                                            (
                                                {7744}if v_6865 then
                                                (
                                                    {7745}let pkDisco_6866: bitstring = pub(skC) in
                                                    {7746}in(c, (=pkCli_6844,em1_6867: bitstring));
                                                    {7747}let m1_6868: bitstring = em1_6867 in
                                                    {7748}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6869: bitstring) = m1_6868 in
                                                    {7749}new Ns_6870: bitstring;
                                                    {7750}new ST_6871: bitstring;
                                                    {7751}new TTL_6872: bitstring;
                                                    {7752}let m2_6873: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6870,ST_6871,TTL_6872) in
                                                    {7753}out(c, m2_6873);
                                                    {7754}let Ksrv_6874: bitstring = h((Ns_6870,Nc_6869)) in
                                                    {7755}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6874))
                                                )
                                                else
                                                    {7756}let pkDisco_6875: bitstring = pub(sk(Disco_5014)) in
                                                    {7757}in(c, (=pkCli_6844,em1_6876: bitstring));
                                                    {7758}let m1_6877: bitstring = em1_6876 in
                                                    {7759}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6878: bitstring) = m1_6877 in
                                                    {7760}new Ns_6879: bitstring;
                                                    {7761}new ST_6880: bitstring;
                                                    {7762}new TTL_6881: bitstring;
                                                    {7763}let m2_6882: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6879,ST_6880,TTL_6881) in
                                                    {7764}out(c, m2_6882);
                                                    {7765}let Ksrv_6883: bitstring = h((Ns_6879,Nc_6878)) in
                                                    {7766}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6883))
                                            )
                                            else
                                                {7767}let pkDisco_6884: bitstring = fail-any in
                                                {7768}in(c, (=pkCli_6844,em1_6885: bitstring));
                                                {7769}let m1_6886: bitstring = em1_6885 in
                                                {7770}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6887: bitstring) = m1_6886 in
                                                {7771}new Ns_6888: bitstring;
                                                {7772}new ST_6889: bitstring;
                                                {7773}new TTL_6890: bitstring;
                                                {7774}let m2_6891: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6888,ST_6889,TTL_6890) in
                                                {7775}out(c, m2_6891);
                                                {7776}let Ksrv_6892: bitstring = h((Ns_6888,Nc_6887)) in
                                                {7777}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6892))
                                    )
                                    else
                                        {7778}let pkDisco_6893: bitstring = fail-any in
                                        {7779}in(c, (=pkCli_6844,em1_6894: bitstring));
                                        {7780}let m1_6895: bitstring = em1_6894 in
                                        {7781}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6896: bitstring) = m1_6895 in
                                        {7782}new Ns_6897: bitstring;
                                        {7783}new ST_6898: bitstring;
                                        {7784}new TTL_6899: bitstring;
                                        {7785}let m2_6900: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6897,ST_6898,TTL_6899) in
                                        {7786}out(c, m2_6900);
                                        {7787}let Ksrv_6901: bitstring = h((Ns_6897,Nc_6896)) in
                                        {7788}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6901))
                            )
                            else
                                {7789}let pkDisco_6902: bitstring = fail-any in
                                {7790}in(c, (=pkCli_6844,em1_6903: bitstring));
                                {7791}let m1_6904: bitstring = em1_6903 in
                                {7792}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6844,Nc_6905: bitstring) = m1_6904 in
                                {7793}new Ns_6906: bitstring;
                                {7794}new ST_6907: bitstring;
                                {7795}new TTL_6908: bitstring;
                                {7796}let m2_6909: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6906,ST_6907,TTL_6908) in
                                {7797}out(c, m2_6909);
                                {7798}let Ksrv_6910: bitstring = h((Ns_6906,Nc_6905)) in
                                {7799}out(c, senc(mSrv(pkCli_6844,pkSess_6438),Ksrv_6910))
            )
            else
                {7800}let skSess_6911: bitstring = fail-any in
                {7801}let pkSess_6912: bitstring = pub(skSess_6911) in
                {7802}let v_6913: bool = (Cli_5013 = A) in
                (
                    {7803}if v_6913 then
                    (
                        {7804}let pkCli_6914: bitstring = pub(skA) in
                        {7805}let v_6915: bool = (Disco_5014 = A) in
                        (
                            {7806}if v_6915 then
                            (
                                {7807}let pkDisco_6916: bitstring = pub(skA) in
                                {7808}in(c, (=pkCli_6914,em1_6917: bitstring));
                                {7809}let m1_6918: bitstring = em1_6917 in
                                {7810}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6919: bitstring) = m1_6918 in
                                {7811}new Ns_6920: bitstring;
                                {7812}new ST_6921: bitstring;
                                {7813}new TTL_6922: bitstring;
                                {7814}let m2_6923: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6920,ST_6921,TTL_6922) in
                                {7815}out(c, m2_6923);
                                {7816}let Ksrv_6924: bitstring = h((Ns_6920,Nc_6919)) in
                                {7817}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6924))
                            )
                            else
                                {7818}let v_6925: bool = (Disco_5014 = B) in
                                (
                                    {7819}if v_6925 then
                                    (
                                        {7820}let pkDisco_6926: bitstring = pub(skB) in
                                        {7821}in(c, (=pkCli_6914,em1_6927: bitstring));
                                        {7822}let m1_6928: bitstring = em1_6927 in
                                        {7823}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6929: bitstring) = m1_6928 in
                                        {7824}new Ns_6930: bitstring;
                                        {7825}new ST_6931: bitstring;
                                        {7826}new TTL_6932: bitstring;
                                        {7827}let m2_6933: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6930,ST_6931,TTL_6932) in
                                        {7828}out(c, m2_6933);
                                        {7829}let Ksrv_6934: bitstring = h((Ns_6930,Nc_6929)) in
                                        {7830}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6934))
                                    )
                                    else
                                        {7831}let v_6935: bool = (Disco_5014 = C) in
                                        (
                                            {7832}if v_6935 then
                                            (
                                                {7833}let pkDisco_6936: bitstring = pub(skC) in
                                                {7834}in(c, (=pkCli_6914,em1_6937: bitstring));
                                                {7835}let m1_6938: bitstring = em1_6937 in
                                                {7836}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6939: bitstring) = m1_6938 in
                                                {7837}new Ns_6940: bitstring;
                                                {7838}new ST_6941: bitstring;
                                                {7839}new TTL_6942: bitstring;
                                                {7840}let m2_6943: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6940,ST_6941,TTL_6942) in
                                                {7841}out(c, m2_6943);
                                                {7842}let Ksrv_6944: bitstring = h((Ns_6940,Nc_6939)) in
                                                {7843}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6944))
                                            )
                                            else
                                                {7844}let pkDisco_6945: bitstring = pub(sk(Disco_5014)) in
                                                {7845}in(c, (=pkCli_6914,em1_6946: bitstring));
                                                {7846}let m1_6947: bitstring = em1_6946 in
                                                {7847}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6948: bitstring) = m1_6947 in
                                                {7848}new Ns_6949: bitstring;
                                                {7849}new ST_6950: bitstring;
                                                {7850}new TTL_6951: bitstring;
                                                {7851}let m2_6952: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6949,ST_6950,TTL_6951) in
                                                {7852}out(c, m2_6952);
                                                {7853}let Ksrv_6953: bitstring = h((Ns_6949,Nc_6948)) in
                                                {7854}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6953))
                                        )
                                        else
                                            {7855}let pkDisco_6954: bitstring = fail-any in
                                            {7856}in(c, (=pkCli_6914,em1_6955: bitstring));
                                            {7857}let m1_6956: bitstring = em1_6955 in
                                            {7858}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6957: bitstring) = m1_6956 in
                                            {7859}new Ns_6958: bitstring;
                                            {7860}new ST_6959: bitstring;
                                            {7861}new TTL_6960: bitstring;
                                            {7862}let m2_6961: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6958,ST_6959,TTL_6960) in
                                            {7863}out(c, m2_6961);
                                            {7864}let Ksrv_6962: bitstring = h((Ns_6958,Nc_6957)) in
                                            {7865}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6962))
                                )
                                else
                                    {7866}let pkDisco_6963: bitstring = fail-any in
                                    {7867}in(c, (=pkCli_6914,em1_6964: bitstring));
                                    {7868}let m1_6965: bitstring = em1_6964 in
                                    {7869}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6966: bitstring) = m1_6965 in
                                    {7870}new Ns_6967: bitstring;
                                    {7871}new ST_6968: bitstring;
                                    {7872}new TTL_6969: bitstring;
                                    {7873}let m2_6970: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6967,ST_6968,TTL_6969) in
                                    {7874}out(c, m2_6970);
                                    {7875}let Ksrv_6971: bitstring = h((Ns_6967,Nc_6966)) in
                                    {7876}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6971))
                        )
                        else
                            {7877}let pkDisco_6972: bitstring = fail-any in
                            {7878}in(c, (=pkCli_6914,em1_6973: bitstring));
                            {7879}let m1_6974: bitstring = em1_6973 in
                            {7880}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6914,Nc_6975: bitstring) = m1_6974 in
                            {7881}new Ns_6976: bitstring;
                            {7882}new ST_6977: bitstring;
                            {7883}new TTL_6978: bitstring;
                            {7884}let m2_6979: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6976,ST_6977,TTL_6978) in
                            {7885}out(c, m2_6979);
                            {7886}let Ksrv_6980: bitstring = h((Ns_6976,Nc_6975)) in
                            {7887}out(c, senc(mSrv(pkCli_6914,pkSess_6912),Ksrv_6980))
                    )
                    else
                        {7888}let v_6981: bool = (Cli_5013 = B) in
                        (
                            {7889}if v_6981 then
                            (
                                {7890}let pkCli_6982: bitstring = pub(skB) in
                                {7891}let v_6983: bool = (Disco_5014 = A) in
                                (
                                    {7892}if v_6983 then
                                    (
                                        {7893}let pkDisco_6984: bitstring = pub(skA) in
                                        {7894}in(c, (=pkCli_6982,em1_6985: bitstring));
                                        {7895}let m1_6986: bitstring = em1_6985 in
                                        {7896}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_6987: bitstring) = m1_6986 in
                                        {7897}new Ns_6988: bitstring;
                                        {7898}new ST_6989: bitstring;
                                        {7899}new TTL_6990: bitstring;
                                        {7900}let m2_6991: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6988,ST_6989,TTL_6990) in
                                        {7901}out(c, m2_6991);
                                        {7902}let Ksrv_6992: bitstring = h((Ns_6988,Nc_6987)) in
                                        {7903}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_6992))
                                    )
                                    else
                                        {7904}let v_6993: bool = (Disco_5014 = B) in
                                        (
                                            {7905}if v_6993 then
                                            (
                                                {7906}let pkDisco_6994: bitstring = pub(skB) in
                                                {7907}in(c, (=pkCli_6982,em1_6995: bitstring));
                                                {7908}let m1_6996: bitstring = em1_6995 in
                                                {7909}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_6997: bitstring) = m1_6996 in
                                                {7910}new Ns_6998: bitstring;
                                                {7911}new ST_6999: bitstring;
                                                {7912}new TTL_7000: bitstring;
                                                {7913}let m2_7001: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_6998,ST_6999,TTL_7000) in
                                                {7914}out(c, m2_7001);
                                                {7915}let Ksrv_7002: bitstring = h((Ns_6998,Nc_6997)) in
                                                {7916}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_7002))
                                            )
                                            else
                                                {7917}let v_7003: bool = (Disco_5014 = C) in
                                                (
                                                    {7918}if v_7003 then
                                                    (
                                                        {7919}let pkDisco_7004: bitstring = pub(skC) in
                                                        {7920}in(c, (=pkCli_6982,em1_7005: bitstring));
                                                        {7921}let m1_7006: bitstring = em1_7005 in
                                                        {7922}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_7007: bitstring) = m1_7006 in
                                                        {7923}new Ns_7008: bitstring;
                                                        {7924}new ST_7009: bitstring;
                                                        {7925}new TTL_7010: bitstring;
                                                        {7926}let m2_7011: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7008,ST_7009,TTL_7010) in
                                                        {7927}out(c, m2_7011);
                                                        {7928}let Ksrv_7012: bitstring = h((Ns_7008,Nc_7007)) in
                                                        {7929}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_7012))
                                                    )
                                                    else
                                                        {7930}let pkDisco_7013: bitstring = pub(sk(Disco_5014)) in
                                                        {7931}in(c, (=pkCli_6982,em1_7014: bitstring));
                                                        {7932}let m1_7015: bitstring = em1_7014 in
                                                        {7933}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_7016: bitstring) = m1_7015 in
                                                        {7934}new Ns_7017: bitstring;
                                                        {7935}new ST_7018: bitstring;
                                                        {7936}new TTL_7019: bitstring;
                                                        {7937}let m2_7020: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7017,ST_7018,TTL_7019) in
                                                        {7938}out(c, m2_7020);
                                                        {7939}let Ksrv_7021: bitstring = h((Ns_7017,Nc_7016)) in
                                                        {7940}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_7021))
                                                )
                                                else
                                                    {7941}let pkDisco_7022: bitstring = fail-any in
                                                    {7942}in(c, (=pkCli_6982,em1_7023: bitstring));
                                                    {7943}let m1_7024: bitstring = em1_7023 in
                                                    {7944}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_7025: bitstring) = m1_7024 in
                                                    {7945}new Ns_7026: bitstring;
                                                    {7946}new ST_7027: bitstring;
                                                    {7947}new TTL_7028: bitstring;
                                                    {7948}let m2_7029: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7026,ST_7027,TTL_7028) in
                                                    {7949}out(c, m2_7029);
                                                    {7950}let Ksrv_7030: bitstring = h((Ns_7026,Nc_7025)) in
                                                    {7951}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_7030))
                                        )
                                        else
                                            {7952}let pkDisco_7031: bitstring = fail-any in
                                            {7953}in(c, (=pkCli_6982,em1_7032: bitstring));
                                            {7954}let m1_7033: bitstring = em1_7032 in
                                            {7955}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_7034: bitstring) = m1_7033 in
                                            {7956}new Ns_7035: bitstring;
                                            {7957}new ST_7036: bitstring;
                                            {7958}new TTL_7037: bitstring;
                                            {7959}let m2_7038: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7035,ST_7036,TTL_7037) in
                                            {7960}out(c, m2_7038);
                                            {7961}let Ksrv_7039: bitstring = h((Ns_7035,Nc_7034)) in
                                            {7962}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_7039))
                                )
                                else
                                    {7963}let pkDisco_7040: bitstring = fail-any in
                                    {7964}in(c, (=pkCli_6982,em1_7041: bitstring));
                                    {7965}let m1_7042: bitstring = em1_7041 in
                                    {7966}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_6982,Nc_7043: bitstring) = m1_7042 in
                                    {7967}new Ns_7044: bitstring;
                                    {7968}new ST_7045: bitstring;
                                    {7969}new TTL_7046: bitstring;
                                    {7970}let m2_7047: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7044,ST_7045,TTL_7046) in
                                    {7971}out(c, m2_7047);
                                    {7972}let Ksrv_7048: bitstring = h((Ns_7044,Nc_7043)) in
                                    {7973}out(c, senc(mSrv(pkCli_6982,pkSess_6912),Ksrv_7048))
                            )
                            else
                                {7974}let v_7049: bool = (Cli_5013 = C) in
                                (
                                    {7975}if v_7049 then
                                    (
                                        {7976}let pkCli_7050: bitstring = pub(skC) in
                                        {7977}let v_7051: bool = (Disco_5014 = A) in
                                        (
                                            {7978}if v_7051 then
                                            (
                                                {7979}let pkDisco_7052: bitstring = pub(skA) in
                                                {7980}in(c, (=pkCli_7050,em1_7053: bitstring));
                                                {7981}let m1_7054: bitstring = em1_7053 in
                                                {7982}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7055: bitstring) = m1_7054 in
                                                {7983}new Ns_7056: bitstring;
                                                {7984}new ST_7057: bitstring;
                                                {7985}new TTL_7058: bitstring;
                                                {7986}let m2_7059: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7056,ST_7057,TTL_7058) in
                                                {7987}out(c, m2_7059);
                                                {7988}let Ksrv_7060: bitstring = h((Ns_7056,Nc_7055)) in
                                                {7989}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7060))
                                            )
                                            else
                                                {7990}let v_7061: bool = (Disco_5014 = B) in
                                                (
                                                    {7991}if v_7061 then
                                                    (
                                                        {7992}let pkDisco_7062: bitstring = pub(skB) in
                                                        {7993}in(c, (=pkCli_7050,em1_7063: bitstring));
                                                        {7994}let m1_7064: bitstring = em1_7063 in
                                                        {7995}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7065: bitstring) = m1_7064 in
                                                        {7996}new Ns_7066: bitstring;
                                                        {7997}new ST_7067: bitstring;
                                                        {7998}new TTL_7068: bitstring;
                                                        {7999}let m2_7069: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7066,ST_7067,TTL_7068) in
                                                        {8000}out(c, m2_7069);
                                                        {8001}let Ksrv_7070: bitstring = h((Ns_7066,Nc_7065)) in
                                                        {8002}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7070))
                                                    )
                                                    else
                                                        {8003}let v_7071: bool = (Disco_5014 = C) in
                                                        (
                                                            {8004}if v_7071 then
                                                            (
                                                                {8005}let pkDisco_7072: bitstring = pub(skC) in
                                                                {8006}in(c, (=pkCli_7050,em1_7073: bitstring));
                                                                {8007}let m1_7074: bitstring = em1_7073 in
                                                                {8008}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7075: bitstring) = m1_7074 in
                                                                {8009}new Ns_7076: bitstring;
                                                                {8010}new ST_7077: bitstring;
                                                                {8011}new TTL_7078: bitstring;
                                                                {8012}let m2_7079: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7076,ST_7077,TTL_7078) in
                                                                {8013}out(c, m2_7079);
                                                                {8014}let Ksrv_7080: bitstring = h((Ns_7076,Nc_7075)) in
                                                                {8015}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7080))
                                                            )
                                                            else
                                                                {8016}let pkDisco_7081: bitstring = pub(sk(Disco_5014)) in
                                                                {8017}in(c, (=pkCli_7050,em1_7082: bitstring));
                                                                {8018}let m1_7083: bitstring = em1_7082 in
                                                                {8019}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7084: bitstring) = m1_7083 in
                                                                {8020}new Ns_7085: bitstring;
                                                                {8021}new ST_7086: bitstring;
                                                                {8022}new TTL_7087: bitstring;
                                                                {8023}let m2_7088: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7085,ST_7086,TTL_7087) in
                                                                {8024}out(c, m2_7088);
                                                                {8025}let Ksrv_7089: bitstring = h((Ns_7085,Nc_7084)) in
                                                                {8026}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7089))
                                                        )
                                                        else
                                                            {8027}let pkDisco_7090: bitstring = fail-any in
                                                            {8028}in(c, (=pkCli_7050,em1_7091: bitstring));
                                                            {8029}let m1_7092: bitstring = em1_7091 in
                                                            {8030}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7093: bitstring) = m1_7092 in
                                                            {8031}new Ns_7094: bitstring;
                                                            {8032}new ST_7095: bitstring;
                                                            {8033}new TTL_7096: bitstring;
                                                            {8034}let m2_7097: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7094,ST_7095,TTL_7096) in
                                                            {8035}out(c, m2_7097);
                                                            {8036}let Ksrv_7098: bitstring = h((Ns_7094,Nc_7093)) in
                                                            {8037}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7098))
                                                )
                                                else
                                                    {8038}let pkDisco_7099: bitstring = fail-any in
                                                    {8039}in(c, (=pkCli_7050,em1_7100: bitstring));
                                                    {8040}let m1_7101: bitstring = em1_7100 in
                                                    {8041}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7102: bitstring) = m1_7101 in
                                                    {8042}new Ns_7103: bitstring;
                                                    {8043}new ST_7104: bitstring;
                                                    {8044}new TTL_7105: bitstring;
                                                    {8045}let m2_7106: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7103,ST_7104,TTL_7105) in
                                                    {8046}out(c, m2_7106);
                                                    {8047}let Ksrv_7107: bitstring = h((Ns_7103,Nc_7102)) in
                                                    {8048}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7107))
                                        )
                                        else
                                            {8049}let pkDisco_7108: bitstring = fail-any in
                                            {8050}in(c, (=pkCli_7050,em1_7109: bitstring));
                                            {8051}let m1_7110: bitstring = em1_7109 in
                                            {8052}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7050,Nc_7111: bitstring) = m1_7110 in
                                            {8053}new Ns_7112: bitstring;
                                            {8054}new ST_7113: bitstring;
                                            {8055}new TTL_7114: bitstring;
                                            {8056}let m2_7115: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7112,ST_7113,TTL_7114) in
                                            {8057}out(c, m2_7115);
                                            {8058}let Ksrv_7116: bitstring = h((Ns_7112,Nc_7111)) in
                                            {8059}out(c, senc(mSrv(pkCli_7050,pkSess_6912),Ksrv_7116))
                                    )
                                    else
                                        {8060}let pkCli_7117: bitstring = pub(sk(Cli_5013)) in
                                        {8061}let v_7118: bool = (Disco_5014 = A) in
                                        (
                                            {8062}if v_7118 then
                                            (
                                                {8063}let pkDisco_7119: bitstring = pub(skA) in
                                                {8064}in(c, (=pkCli_7117,em1_7120: bitstring));
                                                {8065}let m1_7121: bitstring = em1_7120 in
                                                {8066}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7122: bitstring) = m1_7121 in
                                                {8067}new Ns_7123: bitstring;
                                                {8068}new ST_7124: bitstring;
                                                {8069}new TTL_7125: bitstring;
                                                {8070}let m2_7126: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7123,ST_7124,TTL_7125) in
                                                {8071}out(c, m2_7126);
                                                {8072}let Ksrv_7127: bitstring = h((Ns_7123,Nc_7122)) in
                                                {8073}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7127))
                                            )
                                            else
                                                {8074}let v_7128: bool = (Disco_5014 = B) in
                                                (
                                                    {8075}if v_7128 then
                                                    (
                                                        {8076}let pkDisco_7129: bitstring = pub(skB) in
                                                        {8077}in(c, (=pkCli_7117,em1_7130: bitstring));
                                                        {8078}let m1_7131: bitstring = em1_7130 in
                                                        {8079}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7132: bitstring) = m1_7131 in
                                                        {8080}new Ns_7133: bitstring;
                                                        {8081}new ST_7134: bitstring;
                                                        {8082}new TTL_7135: bitstring;
                                                        {8083}let m2_7136: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7133,ST_7134,TTL_7135) in
                                                        {8084}out(c, m2_7136);
                                                        {8085}let Ksrv_7137: bitstring = h((Ns_7133,Nc_7132)) in
                                                        {8086}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7137))
                                                    )
                                                    else
                                                        {8087}let v_7138: bool = (Disco_5014 = C) in
                                                        (
                                                            {8088}if v_7138 then
                                                            (
                                                                {8089}let pkDisco_7139: bitstring = pub(skC) in
                                                                {8090}in(c, (=pkCli_7117,em1_7140: bitstring));
                                                                {8091}let m1_7141: bitstring = em1_7140 in
                                                                {8092}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7142: bitstring) = m1_7141 in
                                                                {8093}new Ns_7143: bitstring;
                                                                {8094}new ST_7144: bitstring;
                                                                {8095}new TTL_7145: bitstring;
                                                                {8096}let m2_7146: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7143,ST_7144,TTL_7145) in
                                                                {8097}out(c, m2_7146);
                                                                {8098}let Ksrv_7147: bitstring = h((Ns_7143,Nc_7142)) in
                                                                {8099}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7147))
                                                            )
                                                            else
                                                                {8100}let pkDisco_7148: bitstring = pub(sk(Disco_5014)) in
                                                                {8101}in(c, (=pkCli_7117,em1_7149: bitstring));
                                                                {8102}let m1_7150: bitstring = em1_7149 in
                                                                {8103}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7151: bitstring) = m1_7150 in
                                                                {8104}new Ns_7152: bitstring;
                                                                {8105}new ST_7153: bitstring;
                                                                {8106}new TTL_7154: bitstring;
                                                                {8107}let m2_7155: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7152,ST_7153,TTL_7154) in
                                                                {8108}out(c, m2_7155);
                                                                {8109}let Ksrv_7156: bitstring = h((Ns_7152,Nc_7151)) in
                                                                {8110}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7156))
                                                        )
                                                        else
                                                            {8111}let pkDisco_7157: bitstring = fail-any in
                                                            {8112}in(c, (=pkCli_7117,em1_7158: bitstring));
                                                            {8113}let m1_7159: bitstring = em1_7158 in
                                                            {8114}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7160: bitstring) = m1_7159 in
                                                            {8115}new Ns_7161: bitstring;
                                                            {8116}new ST_7162: bitstring;
                                                            {8117}new TTL_7163: bitstring;
                                                            {8118}let m2_7164: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7161,ST_7162,TTL_7163) in
                                                            {8119}out(c, m2_7164);
                                                            {8120}let Ksrv_7165: bitstring = h((Ns_7161,Nc_7160)) in
                                                            {8121}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7165))
                                                )
                                                else
                                                    {8122}let pkDisco_7166: bitstring = fail-any in
                                                    {8123}in(c, (=pkCli_7117,em1_7167: bitstring));
                                                    {8124}let m1_7168: bitstring = em1_7167 in
                                                    {8125}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7169: bitstring) = m1_7168 in
                                                    {8126}new Ns_7170: bitstring;
                                                    {8127}new ST_7171: bitstring;
                                                    {8128}new TTL_7172: bitstring;
                                                    {8129}let m2_7173: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7170,ST_7171,TTL_7172) in
                                                    {8130}out(c, m2_7173);
                                                    {8131}let Ksrv_7174: bitstring = h((Ns_7170,Nc_7169)) in
                                                    {8132}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7174))
                                        )
                                        else
                                            {8133}let pkDisco_7175: bitstring = fail-any in
                                            {8134}in(c, (=pkCli_7117,em1_7176: bitstring));
                                            {8135}let m1_7177: bitstring = em1_7176 in
                                            {8136}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7117,Nc_7178: bitstring) = m1_7177 in
                                            {8137}new Ns_7179: bitstring;
                                            {8138}new ST_7180: bitstring;
                                            {8139}new TTL_7181: bitstring;
                                            {8140}let m2_7182: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7179,ST_7180,TTL_7181) in
                                            {8141}out(c, m2_7182);
                                            {8142}let Ksrv_7183: bitstring = h((Ns_7179,Nc_7178)) in
                                            {8143}out(c, senc(mSrv(pkCli_7117,pkSess_6912),Ksrv_7183))
                                )
                                else
                                    {8144}let pkCli_7184: bitstring = fail-any in
                                    {8145}let v_7185: bool = (Disco_5014 = A) in
                                    (
                                        {8146}if v_7185 then
                                        (
                                            {8147}let pkDisco_7186: bitstring = pub(skA) in
                                            {8148}in(c, (=pkCli_7184,em1_7187: bitstring));
                                            {8149}let m1_7188: bitstring = em1_7187 in
                                            {8150}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7189: bitstring) = m1_7188 in
                                            {8151}new Ns_7190: bitstring;
                                            {8152}new ST_7191: bitstring;
                                            {8153}new TTL_7192: bitstring;
                                            {8154}let m2_7193: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7190,ST_7191,TTL_7192) in
                                            {8155}out(c, m2_7193);
                                            {8156}let Ksrv_7194: bitstring = h((Ns_7190,Nc_7189)) in
                                            {8157}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7194))
                                        )
                                        else
                                            {8158}let v_7195: bool = (Disco_5014 = B) in
                                            (
                                                {8159}if v_7195 then
                                                (
                                                    {8160}let pkDisco_7196: bitstring = pub(skB) in
                                                    {8161}in(c, (=pkCli_7184,em1_7197: bitstring));
                                                    {8162}let m1_7198: bitstring = em1_7197 in
                                                    {8163}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7199: bitstring) = m1_7198 in
                                                    {8164}new Ns_7200: bitstring;
                                                    {8165}new ST_7201: bitstring;
                                                    {8166}new TTL_7202: bitstring;
                                                    {8167}let m2_7203: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7200,ST_7201,TTL_7202) in
                                                    {8168}out(c, m2_7203);
                                                    {8169}let Ksrv_7204: bitstring = h((Ns_7200,Nc_7199)) in
                                                    {8170}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7204))
                                                )
                                                else
                                                    {8171}let v_7205: bool = (Disco_5014 = C) in
                                                    (
                                                        {8172}if v_7205 then
                                                        (
                                                            {8173}let pkDisco_7206: bitstring = pub(skC) in
                                                            {8174}in(c, (=pkCli_7184,em1_7207: bitstring));
                                                            {8175}let m1_7208: bitstring = em1_7207 in
                                                            {8176}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7209: bitstring) = m1_7208 in
                                                            {8177}new Ns_7210: bitstring;
                                                            {8178}new ST_7211: bitstring;
                                                            {8179}new TTL_7212: bitstring;
                                                            {8180}let m2_7213: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7210,ST_7211,TTL_7212) in
                                                            {8181}out(c, m2_7213);
                                                            {8182}let Ksrv_7214: bitstring = h((Ns_7210,Nc_7209)) in
                                                            {8183}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7214))
                                                        )
                                                        else
                                                            {8184}let pkDisco_7215: bitstring = pub(sk(Disco_5014)) in
                                                            {8185}in(c, (=pkCli_7184,em1_7216: bitstring));
                                                            {8186}let m1_7217: bitstring = em1_7216 in
                                                            {8187}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7218: bitstring) = m1_7217 in
                                                            {8188}new Ns_7219: bitstring;
                                                            {8189}new ST_7220: bitstring;
                                                            {8190}new TTL_7221: bitstring;
                                                            {8191}let m2_7222: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7219,ST_7220,TTL_7221) in
                                                            {8192}out(c, m2_7222);
                                                            {8193}let Ksrv_7223: bitstring = h((Ns_7219,Nc_7218)) in
                                                            {8194}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7223))
                                                    )
                                                    else
                                                        {8195}let pkDisco_7224: bitstring = fail-any in
                                                        {8196}in(c, (=pkCli_7184,em1_7225: bitstring));
                                                        {8197}let m1_7226: bitstring = em1_7225 in
                                                        {8198}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7227: bitstring) = m1_7226 in
                                                        {8199}new Ns_7228: bitstring;
                                                        {8200}new ST_7229: bitstring;
                                                        {8201}new TTL_7230: bitstring;
                                                        {8202}let m2_7231: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7228,ST_7229,TTL_7230) in
                                                        {8203}out(c, m2_7231);
                                                        {8204}let Ksrv_7232: bitstring = h((Ns_7228,Nc_7227)) in
                                                        {8205}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7232))
                                            )
                                            else
                                                {8206}let pkDisco_7233: bitstring = fail-any in
                                                {8207}in(c, (=pkCli_7184,em1_7234: bitstring));
                                                {8208}let m1_7235: bitstring = em1_7234 in
                                                {8209}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7236: bitstring) = m1_7235 in
                                                {8210}new Ns_7237: bitstring;
                                                {8211}new ST_7238: bitstring;
                                                {8212}new TTL_7239: bitstring;
                                                {8213}let m2_7240: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7237,ST_7238,TTL_7239) in
                                                {8214}out(c, m2_7240);
                                                {8215}let Ksrv_7241: bitstring = h((Ns_7237,Nc_7236)) in
                                                {8216}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7241))
                                    )
                                    else
                                        {8217}let pkDisco_7242: bitstring = fail-any in
                                        {8218}in(c, (=pkCli_7184,em1_7243: bitstring));
                                        {8219}let m1_7244: bitstring = em1_7243 in
                                        {8220}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7184,Nc_7245: bitstring) = m1_7244 in
                                        {8221}new Ns_7246: bitstring;
                                        {8222}new ST_7247: bitstring;
                                        {8223}new TTL_7248: bitstring;
                                        {8224}let m2_7249: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7246,ST_7247,TTL_7248) in
                                        {8225}out(c, m2_7249);
                                        {8226}let Ksrv_7250: bitstring = h((Ns_7246,Nc_7245)) in
                                        {8227}out(c, senc(mSrv(pkCli_7184,pkSess_6912),Ksrv_7250))
                        )
                        else
                            {8228}let pkCli_7251: bitstring = fail-any in
                            {8229}let v_7252: bool = (Disco_5014 = A) in
                            (
                                {8230}if v_7252 then
                                (
                                    {8231}let pkDisco_7253: bitstring = pub(skA) in
                                    {8232}in(c, (=pkCli_7251,em1_7254: bitstring));
                                    {8233}let m1_7255: bitstring = em1_7254 in
                                    {8234}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7256: bitstring) = m1_7255 in
                                    {8235}new Ns_7257: bitstring;
                                    {8236}new ST_7258: bitstring;
                                    {8237}new TTL_7259: bitstring;
                                    {8238}let m2_7260: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7257,ST_7258,TTL_7259) in
                                    {8239}out(c, m2_7260);
                                    {8240}let Ksrv_7261: bitstring = h((Ns_7257,Nc_7256)) in
                                    {8241}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7261))
                                )
                                else
                                    {8242}let v_7262: bool = (Disco_5014 = B) in
                                    (
                                        {8243}if v_7262 then
                                        (
                                            {8244}let pkDisco_7263: bitstring = pub(skB) in
                                            {8245}in(c, (=pkCli_7251,em1_7264: bitstring));
                                            {8246}let m1_7265: bitstring = em1_7264 in
                                            {8247}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7266: bitstring) = m1_7265 in
                                            {8248}new Ns_7267: bitstring;
                                            {8249}new ST_7268: bitstring;
                                            {8250}new TTL_7269: bitstring;
                                            {8251}let m2_7270: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7267,ST_7268,TTL_7269) in
                                            {8252}out(c, m2_7270);
                                            {8253}let Ksrv_7271: bitstring = h((Ns_7267,Nc_7266)) in
                                            {8254}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7271))
                                        )
                                        else
                                            {8255}let v_7272: bool = (Disco_5014 = C) in
                                            (
                                                {8256}if v_7272 then
                                                (
                                                    {8257}let pkDisco_7273: bitstring = pub(skC) in
                                                    {8258}in(c, (=pkCli_7251,em1_7274: bitstring));
                                                    {8259}let m1_7275: bitstring = em1_7274 in
                                                    {8260}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7276: bitstring) = m1_7275 in
                                                    {8261}new Ns_7277: bitstring;
                                                    {8262}new ST_7278: bitstring;
                                                    {8263}new TTL_7279: bitstring;
                                                    {8264}let m2_7280: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7277,ST_7278,TTL_7279) in
                                                    {8265}out(c, m2_7280);
                                                    {8266}let Ksrv_7281: bitstring = h((Ns_7277,Nc_7276)) in
                                                    {8267}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7281))
                                                )
                                                else
                                                    {8268}let pkDisco_7282: bitstring = pub(sk(Disco_5014)) in
                                                    {8269}in(c, (=pkCli_7251,em1_7283: bitstring));
                                                    {8270}let m1_7284: bitstring = em1_7283 in
                                                    {8271}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7285: bitstring) = m1_7284 in
                                                    {8272}new Ns_7286: bitstring;
                                                    {8273}new ST_7287: bitstring;
                                                    {8274}new TTL_7288: bitstring;
                                                    {8275}let m2_7289: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7286,ST_7287,TTL_7288) in
                                                    {8276}out(c, m2_7289);
                                                    {8277}let Ksrv_7290: bitstring = h((Ns_7286,Nc_7285)) in
                                                    {8278}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7290))
                                            )
                                            else
                                                {8279}let pkDisco_7291: bitstring = fail-any in
                                                {8280}in(c, (=pkCli_7251,em1_7292: bitstring));
                                                {8281}let m1_7293: bitstring = em1_7292 in
                                                {8282}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7294: bitstring) = m1_7293 in
                                                {8283}new Ns_7295: bitstring;
                                                {8284}new ST_7296: bitstring;
                                                {8285}new TTL_7297: bitstring;
                                                {8286}let m2_7298: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7295,ST_7296,TTL_7297) in
                                                {8287}out(c, m2_7298);
                                                {8288}let Ksrv_7299: bitstring = h((Ns_7295,Nc_7294)) in
                                                {8289}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7299))
                                    )
                                    else
                                        {8290}let pkDisco_7300: bitstring = fail-any in
                                        {8291}in(c, (=pkCli_7251,em1_7301: bitstring));
                                        {8292}let m1_7302: bitstring = em1_7301 in
                                        {8293}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7303: bitstring) = m1_7302 in
                                        {8294}new Ns_7304: bitstring;
                                        {8295}new ST_7305: bitstring;
                                        {8296}new TTL_7306: bitstring;
                                        {8297}let m2_7307: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7304,ST_7305,TTL_7306) in
                                        {8298}out(c, m2_7307);
                                        {8299}let Ksrv_7308: bitstring = h((Ns_7304,Nc_7303)) in
                                        {8300}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7308))
                            )
                            else
                                {8301}let pkDisco_7309: bitstring = fail-any in
                                {8302}in(c, (=pkCli_7251,em1_7310: bitstring));
                                {8303}let m1_7311: bitstring = em1_7310 in
                                {8304}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7251,Nc_7312: bitstring) = m1_7311 in
                                {8305}new Ns_7313: bitstring;
                                {8306}new ST_7314: bitstring;
                                {8307}new TTL_7315: bitstring;
                                {8308}let m2_7316: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7313,ST_7314,TTL_7315) in
                                {8309}out(c, m2_7316);
                                {8310}let Ksrv_7317: bitstring = h((Ns_7313,Nc_7312)) in
                                {8311}out(c, senc(mSrv(pkCli_7251,pkSess_6912),Ksrv_7317))
                )
                else
                    {8312}let pkCli_7318: bitstring = fail-any in
                    {8313}let v_7319: bool = (Disco_5014 = A) in
                    (
                        {8314}if v_7319 then
                        (
                            {8315}let pkDisco_7320: bitstring = pub(skA) in
                            {8316}in(c, (=pkCli_7318,em1_7321: bitstring));
                            {8317}let m1_7322: bitstring = em1_7321 in
                            {8318}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7323: bitstring) = m1_7322 in
                            {8319}new Ns_7324: bitstring;
                            {8320}new ST_7325: bitstring;
                            {8321}new TTL_7326: bitstring;
                            {8322}let m2_7327: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7324,ST_7325,TTL_7326) in
                            {8323}out(c, m2_7327);
                            {8324}let Ksrv_7328: bitstring = h((Ns_7324,Nc_7323)) in
                            {8325}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7328))
                        )
                        else
                            {8326}let v_7329: bool = (Disco_5014 = B) in
                            (
                                {8327}if v_7329 then
                                (
                                    {8328}let pkDisco_7330: bitstring = pub(skB) in
                                    {8329}in(c, (=pkCli_7318,em1_7331: bitstring));
                                    {8330}let m1_7332: bitstring = em1_7331 in
                                    {8331}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7333: bitstring) = m1_7332 in
                                    {8332}new Ns_7334: bitstring;
                                    {8333}new ST_7335: bitstring;
                                    {8334}new TTL_7336: bitstring;
                                    {8335}let m2_7337: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7334,ST_7335,TTL_7336) in
                                    {8336}out(c, m2_7337);
                                    {8337}let Ksrv_7338: bitstring = h((Ns_7334,Nc_7333)) in
                                    {8338}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7338))
                                )
                                else
                                    {8339}let v_7339: bool = (Disco_5014 = C) in
                                    (
                                        {8340}if v_7339 then
                                        (
                                            {8341}let pkDisco_7340: bitstring = pub(skC) in
                                            {8342}in(c, (=pkCli_7318,em1_7341: bitstring));
                                            {8343}let m1_7342: bitstring = em1_7341 in
                                            {8344}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7343: bitstring) = m1_7342 in
                                            {8345}new Ns_7344: bitstring;
                                            {8346}new ST_7345: bitstring;
                                            {8347}new TTL_7346: bitstring;
                                            {8348}let m2_7347: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7344,ST_7345,TTL_7346) in
                                            {8349}out(c, m2_7347);
                                            {8350}let Ksrv_7348: bitstring = h((Ns_7344,Nc_7343)) in
                                            {8351}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7348))
                                        )
                                        else
                                            {8352}let pkDisco_7349: bitstring = pub(sk(Disco_5014)) in
                                            {8353}in(c, (=pkCli_7318,em1_7350: bitstring));
                                            {8354}let m1_7351: bitstring = em1_7350 in
                                            {8355}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7352: bitstring) = m1_7351 in
                                            {8356}new Ns_7353: bitstring;
                                            {8357}new ST_7354: bitstring;
                                            {8358}new TTL_7355: bitstring;
                                            {8359}let m2_7356: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7353,ST_7354,TTL_7355) in
                                            {8360}out(c, m2_7356);
                                            {8361}let Ksrv_7357: bitstring = h((Ns_7353,Nc_7352)) in
                                            {8362}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7357))
                                    )
                                    else
                                        {8363}let pkDisco_7358: bitstring = fail-any in
                                        {8364}in(c, (=pkCli_7318,em1_7359: bitstring));
                                        {8365}let m1_7360: bitstring = em1_7359 in
                                        {8366}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7361: bitstring) = m1_7360 in
                                        {8367}new Ns_7362: bitstring;
                                        {8368}new ST_7363: bitstring;
                                        {8369}new TTL_7364: bitstring;
                                        {8370}let m2_7365: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7362,ST_7363,TTL_7364) in
                                        {8371}out(c, m2_7365);
                                        {8372}let Ksrv_7366: bitstring = h((Ns_7362,Nc_7361)) in
                                        {8373}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7366))
                            )
                            else
                                {8374}let pkDisco_7367: bitstring = fail-any in
                                {8375}in(c, (=pkCli_7318,em1_7368: bitstring));
                                {8376}let m1_7369: bitstring = em1_7368 in
                                {8377}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7370: bitstring) = m1_7369 in
                                {8378}new Ns_7371: bitstring;
                                {8379}new ST_7372: bitstring;
                                {8380}new TTL_7373: bitstring;
                                {8381}let m2_7374: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7371,ST_7372,TTL_7373) in
                                {8382}out(c, m2_7374);
                                {8383}let Ksrv_7375: bitstring = h((Ns_7371,Nc_7370)) in
                                {8384}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7375))
                    )
                    else
                        {8385}let pkDisco_7376: bitstring = fail-any in
                        {8386}in(c, (=pkCli_7318,em1_7377: bitstring));
                        {8387}let m1_7378: bitstring = em1_7377 in
                        {8388}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7318,Nc_7379: bitstring) = m1_7378 in
                        {8389}new Ns_7380: bitstring;
                        {8390}new ST_7381: bitstring;
                        {8391}new TTL_7382: bitstring;
                        {8392}let m2_7383: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7380,ST_7381,TTL_7382) in
                        {8393}out(c, m2_7383);
                        {8394}let Ksrv_7384: bitstring = h((Ns_7380,Nc_7379)) in
                        {8395}out(c, senc(mSrv(pkCli_7318,pkSess_6912),Ksrv_7384))
    )
    else
        {8396}let skSess_7385: bitstring = fail-any in
        {8397}let pkSess_7386: bitstring = pub(skSess_7385) in
        {8398}let v_7387: bool = (Cli_5013 = A) in
        (
            {8399}if v_7387 then
            (
                {8400}let pkCli_7388: bitstring = pub(skA) in
                {8401}let v_7389: bool = (Disco_5014 = A) in
                (
                    {8402}if v_7389 then
                    (
                        {8403}let pkDisco_7390: bitstring = pub(skA) in
                        {8404}in(c, (=pkCli_7388,em1_7391: bitstring));
                        {8405}let m1_7392: bitstring = em1_7391 in
                        {8406}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7393: bitstring) = m1_7392 in
                        {8407}new Ns_7394: bitstring;
                        {8408}new ST_7395: bitstring;
                        {8409}new TTL_7396: bitstring;
                        {8410}let m2_7397: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7394,ST_7395,TTL_7396) in
                        {8411}out(c, m2_7397);
                        {8412}let Ksrv_7398: bitstring = h((Ns_7394,Nc_7393)) in
                        {8413}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7398))
                    )
                    else
                        {8414}let v_7399: bool = (Disco_5014 = B) in
                        (
                            {8415}if v_7399 then
                            (
                                {8416}let pkDisco_7400: bitstring = pub(skB) in
                                {8417}in(c, (=pkCli_7388,em1_7401: bitstring));
                                {8418}let m1_7402: bitstring = em1_7401 in
                                {8419}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7403: bitstring) = m1_7402 in
                                {8420}new Ns_7404: bitstring;
                                {8421}new ST_7405: bitstring;
                                {8422}new TTL_7406: bitstring;
                                {8423}let m2_7407: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7404,ST_7405,TTL_7406) in
                                {8424}out(c, m2_7407);
                                {8425}let Ksrv_7408: bitstring = h((Ns_7404,Nc_7403)) in
                                {8426}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7408))
                            )
                            else
                                {8427}let v_7409: bool = (Disco_5014 = C) in
                                (
                                    {8428}if v_7409 then
                                    (
                                        {8429}let pkDisco_7410: bitstring = pub(skC) in
                                        {8430}in(c, (=pkCli_7388,em1_7411: bitstring));
                                        {8431}let m1_7412: bitstring = em1_7411 in
                                        {8432}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7413: bitstring) = m1_7412 in
                                        {8433}new Ns_7414: bitstring;
                                        {8434}new ST_7415: bitstring;
                                        {8435}new TTL_7416: bitstring;
                                        {8436}let m2_7417: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7414,ST_7415,TTL_7416) in
                                        {8437}out(c, m2_7417);
                                        {8438}let Ksrv_7418: bitstring = h((Ns_7414,Nc_7413)) in
                                        {8439}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7418))
                                    )
                                    else
                                        {8440}let pkDisco_7419: bitstring = pub(sk(Disco_5014)) in
                                        {8441}in(c, (=pkCli_7388,em1_7420: bitstring));
                                        {8442}let m1_7421: bitstring = em1_7420 in
                                        {8443}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7422: bitstring) = m1_7421 in
                                        {8444}new Ns_7423: bitstring;
                                        {8445}new ST_7424: bitstring;
                                        {8446}new TTL_7425: bitstring;
                                        {8447}let m2_7426: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7423,ST_7424,TTL_7425) in
                                        {8448}out(c, m2_7426);
                                        {8449}let Ksrv_7427: bitstring = h((Ns_7423,Nc_7422)) in
                                        {8450}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7427))
                                )
                                else
                                    {8451}let pkDisco_7428: bitstring = fail-any in
                                    {8452}in(c, (=pkCli_7388,em1_7429: bitstring));
                                    {8453}let m1_7430: bitstring = em1_7429 in
                                    {8454}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7431: bitstring) = m1_7430 in
                                    {8455}new Ns_7432: bitstring;
                                    {8456}new ST_7433: bitstring;
                                    {8457}new TTL_7434: bitstring;
                                    {8458}let m2_7435: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7432,ST_7433,TTL_7434) in
                                    {8459}out(c, m2_7435);
                                    {8460}let Ksrv_7436: bitstring = h((Ns_7432,Nc_7431)) in
                                    {8461}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7436))
                        )
                        else
                            {8462}let pkDisco_7437: bitstring = fail-any in
                            {8463}in(c, (=pkCli_7388,em1_7438: bitstring));
                            {8464}let m1_7439: bitstring = em1_7438 in
                            {8465}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7440: bitstring) = m1_7439 in
                            {8466}new Ns_7441: bitstring;
                            {8467}new ST_7442: bitstring;
                            {8468}new TTL_7443: bitstring;
                            {8469}let m2_7444: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7441,ST_7442,TTL_7443) in
                            {8470}out(c, m2_7444);
                            {8471}let Ksrv_7445: bitstring = h((Ns_7441,Nc_7440)) in
                            {8472}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7445))
                )
                else
                    {8473}let pkDisco_7446: bitstring = fail-any in
                    {8474}in(c, (=pkCli_7388,em1_7447: bitstring));
                    {8475}let m1_7448: bitstring = em1_7447 in
                    {8476}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7388,Nc_7449: bitstring) = m1_7448 in
                    {8477}new Ns_7450: bitstring;
                    {8478}new ST_7451: bitstring;
                    {8479}new TTL_7452: bitstring;
                    {8480}let m2_7453: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7450,ST_7451,TTL_7452) in
                    {8481}out(c, m2_7453);
                    {8482}let Ksrv_7454: bitstring = h((Ns_7450,Nc_7449)) in
                    {8483}out(c, senc(mSrv(pkCli_7388,pkSess_7386),Ksrv_7454))
            )
            else
                {8484}let v_7455: bool = (Cli_5013 = B) in
                (
                    {8485}if v_7455 then
                    (
                        {8486}let pkCli_7456: bitstring = pub(skB) in
                        {8487}let v_7457: bool = (Disco_5014 = A) in
                        (
                            {8488}if v_7457 then
                            (
                                {8489}let pkDisco_7458: bitstring = pub(skA) in
                                {8490}in(c, (=pkCli_7456,em1_7459: bitstring));
                                {8491}let m1_7460: bitstring = em1_7459 in
                                {8492}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7461: bitstring) = m1_7460 in
                                {8493}new Ns_7462: bitstring;
                                {8494}new ST_7463: bitstring;
                                {8495}new TTL_7464: bitstring;
                                {8496}let m2_7465: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7462,ST_7463,TTL_7464) in
                                {8497}out(c, m2_7465);
                                {8498}let Ksrv_7466: bitstring = h((Ns_7462,Nc_7461)) in
                                {8499}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7466))
                            )
                            else
                                {8500}let v_7467: bool = (Disco_5014 = B) in
                                (
                                    {8501}if v_7467 then
                                    (
                                        {8502}let pkDisco_7468: bitstring = pub(skB) in
                                        {8503}in(c, (=pkCli_7456,em1_7469: bitstring));
                                        {8504}let m1_7470: bitstring = em1_7469 in
                                        {8505}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7471: bitstring) = m1_7470 in
                                        {8506}new Ns_7472: bitstring;
                                        {8507}new ST_7473: bitstring;
                                        {8508}new TTL_7474: bitstring;
                                        {8509}let m2_7475: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7472,ST_7473,TTL_7474) in
                                        {8510}out(c, m2_7475);
                                        {8511}let Ksrv_7476: bitstring = h((Ns_7472,Nc_7471)) in
                                        {8512}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7476))
                                    )
                                    else
                                        {8513}let v_7477: bool = (Disco_5014 = C) in
                                        (
                                            {8514}if v_7477 then
                                            (
                                                {8515}let pkDisco_7478: bitstring = pub(skC) in
                                                {8516}in(c, (=pkCli_7456,em1_7479: bitstring));
                                                {8517}let m1_7480: bitstring = em1_7479 in
                                                {8518}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7481: bitstring) = m1_7480 in
                                                {8519}new Ns_7482: bitstring;
                                                {8520}new ST_7483: bitstring;
                                                {8521}new TTL_7484: bitstring;
                                                {8522}let m2_7485: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7482,ST_7483,TTL_7484) in
                                                {8523}out(c, m2_7485);
                                                {8524}let Ksrv_7486: bitstring = h((Ns_7482,Nc_7481)) in
                                                {8525}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7486))
                                            )
                                            else
                                                {8526}let pkDisco_7487: bitstring = pub(sk(Disco_5014)) in
                                                {8527}in(c, (=pkCli_7456,em1_7488: bitstring));
                                                {8528}let m1_7489: bitstring = em1_7488 in
                                                {8529}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7490: bitstring) = m1_7489 in
                                                {8530}new Ns_7491: bitstring;
                                                {8531}new ST_7492: bitstring;
                                                {8532}new TTL_7493: bitstring;
                                                {8533}let m2_7494: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7491,ST_7492,TTL_7493) in
                                                {8534}out(c, m2_7494);
                                                {8535}let Ksrv_7495: bitstring = h((Ns_7491,Nc_7490)) in
                                                {8536}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7495))
                                        )
                                        else
                                            {8537}let pkDisco_7496: bitstring = fail-any in
                                            {8538}in(c, (=pkCli_7456,em1_7497: bitstring));
                                            {8539}let m1_7498: bitstring = em1_7497 in
                                            {8540}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7499: bitstring) = m1_7498 in
                                            {8541}new Ns_7500: bitstring;
                                            {8542}new ST_7501: bitstring;
                                            {8543}new TTL_7502: bitstring;
                                            {8544}let m2_7503: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7500,ST_7501,TTL_7502) in
                                            {8545}out(c, m2_7503);
                                            {8546}let Ksrv_7504: bitstring = h((Ns_7500,Nc_7499)) in
                                            {8547}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7504))
                                )
                                else
                                    {8548}let pkDisco_7505: bitstring = fail-any in
                                    {8549}in(c, (=pkCli_7456,em1_7506: bitstring));
                                    {8550}let m1_7507: bitstring = em1_7506 in
                                    {8551}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7508: bitstring) = m1_7507 in
                                    {8552}new Ns_7509: bitstring;
                                    {8553}new ST_7510: bitstring;
                                    {8554}new TTL_7511: bitstring;
                                    {8555}let m2_7512: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7509,ST_7510,TTL_7511) in
                                    {8556}out(c, m2_7512);
                                    {8557}let Ksrv_7513: bitstring = h((Ns_7509,Nc_7508)) in
                                    {8558}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7513))
                        )
                        else
                            {8559}let pkDisco_7514: bitstring = fail-any in
                            {8560}in(c, (=pkCli_7456,em1_7515: bitstring));
                            {8561}let m1_7516: bitstring = em1_7515 in
                            {8562}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7456,Nc_7517: bitstring) = m1_7516 in
                            {8563}new Ns_7518: bitstring;
                            {8564}new ST_7519: bitstring;
                            {8565}new TTL_7520: bitstring;
                            {8566}let m2_7521: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7518,ST_7519,TTL_7520) in
                            {8567}out(c, m2_7521);
                            {8568}let Ksrv_7522: bitstring = h((Ns_7518,Nc_7517)) in
                            {8569}out(c, senc(mSrv(pkCli_7456,pkSess_7386),Ksrv_7522))
                    )
                    else
                        {8570}let v_7523: bool = (Cli_5013 = C) in
                        (
                            {8571}if v_7523 then
                            (
                                {8572}let pkCli_7524: bitstring = pub(skC) in
                                {8573}let v_7525: bool = (Disco_5014 = A) in
                                (
                                    {8574}if v_7525 then
                                    (
                                        {8575}let pkDisco_7526: bitstring = pub(skA) in
                                        {8576}in(c, (=pkCli_7524,em1_7527: bitstring));
                                        {8577}let m1_7528: bitstring = em1_7527 in
                                        {8578}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7529: bitstring) = m1_7528 in
                                        {8579}new Ns_7530: bitstring;
                                        {8580}new ST_7531: bitstring;
                                        {8581}new TTL_7532: bitstring;
                                        {8582}let m2_7533: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7530,ST_7531,TTL_7532) in
                                        {8583}out(c, m2_7533);
                                        {8584}let Ksrv_7534: bitstring = h((Ns_7530,Nc_7529)) in
                                        {8585}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7534))
                                    )
                                    else
                                        {8586}let v_7535: bool = (Disco_5014 = B) in
                                        (
                                            {8587}if v_7535 then
                                            (
                                                {8588}let pkDisco_7536: bitstring = pub(skB) in
                                                {8589}in(c, (=pkCli_7524,em1_7537: bitstring));
                                                {8590}let m1_7538: bitstring = em1_7537 in
                                                {8591}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7539: bitstring) = m1_7538 in
                                                {8592}new Ns_7540: bitstring;
                                                {8593}new ST_7541: bitstring;
                                                {8594}new TTL_7542: bitstring;
                                                {8595}let m2_7543: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7540,ST_7541,TTL_7542) in
                                                {8596}out(c, m2_7543);
                                                {8597}let Ksrv_7544: bitstring = h((Ns_7540,Nc_7539)) in
                                                {8598}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7544))
                                            )
                                            else
                                                {8599}let v_7545: bool = (Disco_5014 = C) in
                                                (
                                                    {8600}if v_7545 then
                                                    (
                                                        {8601}let pkDisco_7546: bitstring = pub(skC) in
                                                        {8602}in(c, (=pkCli_7524,em1_7547: bitstring));
                                                        {8603}let m1_7548: bitstring = em1_7547 in
                                                        {8604}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7549: bitstring) = m1_7548 in
                                                        {8605}new Ns_7550: bitstring;
                                                        {8606}new ST_7551: bitstring;
                                                        {8607}new TTL_7552: bitstring;
                                                        {8608}let m2_7553: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7550,ST_7551,TTL_7552) in
                                                        {8609}out(c, m2_7553);
                                                        {8610}let Ksrv_7554: bitstring = h((Ns_7550,Nc_7549)) in
                                                        {8611}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7554))
                                                    )
                                                    else
                                                        {8612}let pkDisco_7555: bitstring = pub(sk(Disco_5014)) in
                                                        {8613}in(c, (=pkCli_7524,em1_7556: bitstring));
                                                        {8614}let m1_7557: bitstring = em1_7556 in
                                                        {8615}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7558: bitstring) = m1_7557 in
                                                        {8616}new Ns_7559: bitstring;
                                                        {8617}new ST_7560: bitstring;
                                                        {8618}new TTL_7561: bitstring;
                                                        {8619}let m2_7562: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7559,ST_7560,TTL_7561) in
                                                        {8620}out(c, m2_7562);
                                                        {8621}let Ksrv_7563: bitstring = h((Ns_7559,Nc_7558)) in
                                                        {8622}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7563))
                                                )
                                                else
                                                    {8623}let pkDisco_7564: bitstring = fail-any in
                                                    {8624}in(c, (=pkCli_7524,em1_7565: bitstring));
                                                    {8625}let m1_7566: bitstring = em1_7565 in
                                                    {8626}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7567: bitstring) = m1_7566 in
                                                    {8627}new Ns_7568: bitstring;
                                                    {8628}new ST_7569: bitstring;
                                                    {8629}new TTL_7570: bitstring;
                                                    {8630}let m2_7571: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7568,ST_7569,TTL_7570) in
                                                    {8631}out(c, m2_7571);
                                                    {8632}let Ksrv_7572: bitstring = h((Ns_7568,Nc_7567)) in
                                                    {8633}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7572))
                                        )
                                        else
                                            {8634}let pkDisco_7573: bitstring = fail-any in
                                            {8635}in(c, (=pkCli_7524,em1_7574: bitstring));
                                            {8636}let m1_7575: bitstring = em1_7574 in
                                            {8637}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7576: bitstring) = m1_7575 in
                                            {8638}new Ns_7577: bitstring;
                                            {8639}new ST_7578: bitstring;
                                            {8640}new TTL_7579: bitstring;
                                            {8641}let m2_7580: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7577,ST_7578,TTL_7579) in
                                            {8642}out(c, m2_7580);
                                            {8643}let Ksrv_7581: bitstring = h((Ns_7577,Nc_7576)) in
                                            {8644}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7581))
                                )
                                else
                                    {8645}let pkDisco_7582: bitstring = fail-any in
                                    {8646}in(c, (=pkCli_7524,em1_7583: bitstring));
                                    {8647}let m1_7584: bitstring = em1_7583 in
                                    {8648}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7524,Nc_7585: bitstring) = m1_7584 in
                                    {8649}new Ns_7586: bitstring;
                                    {8650}new ST_7587: bitstring;
                                    {8651}new TTL_7588: bitstring;
                                    {8652}let m2_7589: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7586,ST_7587,TTL_7588) in
                                    {8653}out(c, m2_7589);
                                    {8654}let Ksrv_7590: bitstring = h((Ns_7586,Nc_7585)) in
                                    {8655}out(c, senc(mSrv(pkCli_7524,pkSess_7386),Ksrv_7590))
                            )
                            else
                                {8656}let pkCli_7591: bitstring = pub(sk(Cli_5013)) in
                                {8657}let v_7592: bool = (Disco_5014 = A) in
                                (
                                    {8658}if v_7592 then
                                    (
                                        {8659}let pkDisco_7593: bitstring = pub(skA) in
                                        {8660}in(c, (=pkCli_7591,em1_7594: bitstring));
                                        {8661}let m1_7595: bitstring = em1_7594 in
                                        {8662}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7596: bitstring) = m1_7595 in
                                        {8663}new Ns_7597: bitstring;
                                        {8664}new ST_7598: bitstring;
                                        {8665}new TTL_7599: bitstring;
                                        {8666}let m2_7600: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7597,ST_7598,TTL_7599) in
                                        {8667}out(c, m2_7600);
                                        {8668}let Ksrv_7601: bitstring = h((Ns_7597,Nc_7596)) in
                                        {8669}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7601))
                                    )
                                    else
                                        {8670}let v_7602: bool = (Disco_5014 = B) in
                                        (
                                            {8671}if v_7602 then
                                            (
                                                {8672}let pkDisco_7603: bitstring = pub(skB) in
                                                {8673}in(c, (=pkCli_7591,em1_7604: bitstring));
                                                {8674}let m1_7605: bitstring = em1_7604 in
                                                {8675}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7606: bitstring) = m1_7605 in
                                                {8676}new Ns_7607: bitstring;
                                                {8677}new ST_7608: bitstring;
                                                {8678}new TTL_7609: bitstring;
                                                {8679}let m2_7610: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7607,ST_7608,TTL_7609) in
                                                {8680}out(c, m2_7610);
                                                {8681}let Ksrv_7611: bitstring = h((Ns_7607,Nc_7606)) in
                                                {8682}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7611))
                                            )
                                            else
                                                {8683}let v_7612: bool = (Disco_5014 = C) in
                                                (
                                                    {8684}if v_7612 then
                                                    (
                                                        {8685}let pkDisco_7613: bitstring = pub(skC) in
                                                        {8686}in(c, (=pkCli_7591,em1_7614: bitstring));
                                                        {8687}let m1_7615: bitstring = em1_7614 in
                                                        {8688}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7616: bitstring) = m1_7615 in
                                                        {8689}new Ns_7617: bitstring;
                                                        {8690}new ST_7618: bitstring;
                                                        {8691}new TTL_7619: bitstring;
                                                        {8692}let m2_7620: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7617,ST_7618,TTL_7619) in
                                                        {8693}out(c, m2_7620);
                                                        {8694}let Ksrv_7621: bitstring = h((Ns_7617,Nc_7616)) in
                                                        {8695}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7621))
                                                    )
                                                    else
                                                        {8696}let pkDisco_7622: bitstring = pub(sk(Disco_5014)) in
                                                        {8697}in(c, (=pkCli_7591,em1_7623: bitstring));
                                                        {8698}let m1_7624: bitstring = em1_7623 in
                                                        {8699}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7625: bitstring) = m1_7624 in
                                                        {8700}new Ns_7626: bitstring;
                                                        {8701}new ST_7627: bitstring;
                                                        {8702}new TTL_7628: bitstring;
                                                        {8703}let m2_7629: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7626,ST_7627,TTL_7628) in
                                                        {8704}out(c, m2_7629);
                                                        {8705}let Ksrv_7630: bitstring = h((Ns_7626,Nc_7625)) in
                                                        {8706}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7630))
                                                )
                                                else
                                                    {8707}let pkDisco_7631: bitstring = fail-any in
                                                    {8708}in(c, (=pkCli_7591,em1_7632: bitstring));
                                                    {8709}let m1_7633: bitstring = em1_7632 in
                                                    {8710}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7634: bitstring) = m1_7633 in
                                                    {8711}new Ns_7635: bitstring;
                                                    {8712}new ST_7636: bitstring;
                                                    {8713}new TTL_7637: bitstring;
                                                    {8714}let m2_7638: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7635,ST_7636,TTL_7637) in
                                                    {8715}out(c, m2_7638);
                                                    {8716}let Ksrv_7639: bitstring = h((Ns_7635,Nc_7634)) in
                                                    {8717}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7639))
                                        )
                                        else
                                            {8718}let pkDisco_7640: bitstring = fail-any in
                                            {8719}in(c, (=pkCli_7591,em1_7641: bitstring));
                                            {8720}let m1_7642: bitstring = em1_7641 in
                                            {8721}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7643: bitstring) = m1_7642 in
                                            {8722}new Ns_7644: bitstring;
                                            {8723}new ST_7645: bitstring;
                                            {8724}new TTL_7646: bitstring;
                                            {8725}let m2_7647: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7644,ST_7645,TTL_7646) in
                                            {8726}out(c, m2_7647);
                                            {8727}let Ksrv_7648: bitstring = h((Ns_7644,Nc_7643)) in
                                            {8728}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7648))
                                )
                                else
                                    {8729}let pkDisco_7649: bitstring = fail-any in
                                    {8730}in(c, (=pkCli_7591,em1_7650: bitstring));
                                    {8731}let m1_7651: bitstring = em1_7650 in
                                    {8732}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7591,Nc_7652: bitstring) = m1_7651 in
                                    {8733}new Ns_7653: bitstring;
                                    {8734}new ST_7654: bitstring;
                                    {8735}new TTL_7655: bitstring;
                                    {8736}let m2_7656: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7653,ST_7654,TTL_7655) in
                                    {8737}out(c, m2_7656);
                                    {8738}let Ksrv_7657: bitstring = h((Ns_7653,Nc_7652)) in
                                    {8739}out(c, senc(mSrv(pkCli_7591,pkSess_7386),Ksrv_7657))
                        )
                        else
                            {8740}let pkCli_7658: bitstring = fail-any in
                            {8741}let v_7659: bool = (Disco_5014 = A) in
                            (
                                {8742}if v_7659 then
                                (
                                    {8743}let pkDisco_7660: bitstring = pub(skA) in
                                    {8744}in(c, (=pkCli_7658,em1_7661: bitstring));
                                    {8745}let m1_7662: bitstring = em1_7661 in
                                    {8746}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7663: bitstring) = m1_7662 in
                                    {8747}new Ns_7664: bitstring;
                                    {8748}new ST_7665: bitstring;
                                    {8749}new TTL_7666: bitstring;
                                    {8750}let m2_7667: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7664,ST_7665,TTL_7666) in
                                    {8751}out(c, m2_7667);
                                    {8752}let Ksrv_7668: bitstring = h((Ns_7664,Nc_7663)) in
                                    {8753}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7668))
                                )
                                else
                                    {8754}let v_7669: bool = (Disco_5014 = B) in
                                    (
                                        {8755}if v_7669 then
                                        (
                                            {8756}let pkDisco_7670: bitstring = pub(skB) in
                                            {8757}in(c, (=pkCli_7658,em1_7671: bitstring));
                                            {8758}let m1_7672: bitstring = em1_7671 in
                                            {8759}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7673: bitstring) = m1_7672 in
                                            {8760}new Ns_7674: bitstring;
                                            {8761}new ST_7675: bitstring;
                                            {8762}new TTL_7676: bitstring;
                                            {8763}let m2_7677: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7674,ST_7675,TTL_7676) in
                                            {8764}out(c, m2_7677);
                                            {8765}let Ksrv_7678: bitstring = h((Ns_7674,Nc_7673)) in
                                            {8766}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7678))
                                        )
                                        else
                                            {8767}let v_7679: bool = (Disco_5014 = C) in
                                            (
                                                {8768}if v_7679 then
                                                (
                                                    {8769}let pkDisco_7680: bitstring = pub(skC) in
                                                    {8770}in(c, (=pkCli_7658,em1_7681: bitstring));
                                                    {8771}let m1_7682: bitstring = em1_7681 in
                                                    {8772}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7683: bitstring) = m1_7682 in
                                                    {8773}new Ns_7684: bitstring;
                                                    {8774}new ST_7685: bitstring;
                                                    {8775}new TTL_7686: bitstring;
                                                    {8776}let m2_7687: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7684,ST_7685,TTL_7686) in
                                                    {8777}out(c, m2_7687);
                                                    {8778}let Ksrv_7688: bitstring = h((Ns_7684,Nc_7683)) in
                                                    {8779}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7688))
                                                )
                                                else
                                                    {8780}let pkDisco_7689: bitstring = pub(sk(Disco_5014)) in
                                                    {8781}in(c, (=pkCli_7658,em1_7690: bitstring));
                                                    {8782}let m1_7691: bitstring = em1_7690 in
                                                    {8783}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7692: bitstring) = m1_7691 in
                                                    {8784}new Ns_7693: bitstring;
                                                    {8785}new ST_7694: bitstring;
                                                    {8786}new TTL_7695: bitstring;
                                                    {8787}let m2_7696: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7693,ST_7694,TTL_7695) in
                                                    {8788}out(c, m2_7696);
                                                    {8789}let Ksrv_7697: bitstring = h((Ns_7693,Nc_7692)) in
                                                    {8790}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7697))
                                            )
                                            else
                                                {8791}let pkDisco_7698: bitstring = fail-any in
                                                {8792}in(c, (=pkCli_7658,em1_7699: bitstring));
                                                {8793}let m1_7700: bitstring = em1_7699 in
                                                {8794}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7701: bitstring) = m1_7700 in
                                                {8795}new Ns_7702: bitstring;
                                                {8796}new ST_7703: bitstring;
                                                {8797}new TTL_7704: bitstring;
                                                {8798}let m2_7705: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7702,ST_7703,TTL_7704) in
                                                {8799}out(c, m2_7705);
                                                {8800}let Ksrv_7706: bitstring = h((Ns_7702,Nc_7701)) in
                                                {8801}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7706))
                                    )
                                    else
                                        {8802}let pkDisco_7707: bitstring = fail-any in
                                        {8803}in(c, (=pkCli_7658,em1_7708: bitstring));
                                        {8804}let m1_7709: bitstring = em1_7708 in
                                        {8805}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7710: bitstring) = m1_7709 in
                                        {8806}new Ns_7711: bitstring;
                                        {8807}new ST_7712: bitstring;
                                        {8808}new TTL_7713: bitstring;
                                        {8809}let m2_7714: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7711,ST_7712,TTL_7713) in
                                        {8810}out(c, m2_7714);
                                        {8811}let Ksrv_7715: bitstring = h((Ns_7711,Nc_7710)) in
                                        {8812}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7715))
                            )
                            else
                                {8813}let pkDisco_7716: bitstring = fail-any in
                                {8814}in(c, (=pkCli_7658,em1_7717: bitstring));
                                {8815}let m1_7718: bitstring = em1_7717 in
                                {8816}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7658,Nc_7719: bitstring) = m1_7718 in
                                {8817}new Ns_7720: bitstring;
                                {8818}new ST_7721: bitstring;
                                {8819}new TTL_7722: bitstring;
                                {8820}let m2_7723: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7720,ST_7721,TTL_7722) in
                                {8821}out(c, m2_7723);
                                {8822}let Ksrv_7724: bitstring = h((Ns_7720,Nc_7719)) in
                                {8823}out(c, senc(mSrv(pkCli_7658,pkSess_7386),Ksrv_7724))
                )
                else
                    {8824}let pkCli_7725: bitstring = fail-any in
                    {8825}let v_7726: bool = (Disco_5014 = A) in
                    (
                        {8826}if v_7726 then
                        (
                            {8827}let pkDisco_7727: bitstring = pub(skA) in
                            {8828}in(c, (=pkCli_7725,em1_7728: bitstring));
                            {8829}let m1_7729: bitstring = em1_7728 in
                            {8830}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7730: bitstring) = m1_7729 in
                            {8831}new Ns_7731: bitstring;
                            {8832}new ST_7732: bitstring;
                            {8833}new TTL_7733: bitstring;
                            {8834}let m2_7734: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7731,ST_7732,TTL_7733) in
                            {8835}out(c, m2_7734);
                            {8836}let Ksrv_7735: bitstring = h((Ns_7731,Nc_7730)) in
                            {8837}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7735))
                        )
                        else
                            {8838}let v_7736: bool = (Disco_5014 = B) in
                            (
                                {8839}if v_7736 then
                                (
                                    {8840}let pkDisco_7737: bitstring = pub(skB) in
                                    {8841}in(c, (=pkCli_7725,em1_7738: bitstring));
                                    {8842}let m1_7739: bitstring = em1_7738 in
                                    {8843}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7740: bitstring) = m1_7739 in
                                    {8844}new Ns_7741: bitstring;
                                    {8845}new ST_7742: bitstring;
                                    {8846}new TTL_7743: bitstring;
                                    {8847}let m2_7744: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7741,ST_7742,TTL_7743) in
                                    {8848}out(c, m2_7744);
                                    {8849}let Ksrv_7745: bitstring = h((Ns_7741,Nc_7740)) in
                                    {8850}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7745))
                                )
                                else
                                    {8851}let v_7746: bool = (Disco_5014 = C) in
                                    (
                                        {8852}if v_7746 then
                                        (
                                            {8853}let pkDisco_7747: bitstring = pub(skC) in
                                            {8854}in(c, (=pkCli_7725,em1_7748: bitstring));
                                            {8855}let m1_7749: bitstring = em1_7748 in
                                            {8856}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7750: bitstring) = m1_7749 in
                                            {8857}new Ns_7751: bitstring;
                                            {8858}new ST_7752: bitstring;
                                            {8859}new TTL_7753: bitstring;
                                            {8860}let m2_7754: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7751,ST_7752,TTL_7753) in
                                            {8861}out(c, m2_7754);
                                            {8862}let Ksrv_7755: bitstring = h((Ns_7751,Nc_7750)) in
                                            {8863}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7755))
                                        )
                                        else
                                            {8864}let pkDisco_7756: bitstring = pub(sk(Disco_5014)) in
                                            {8865}in(c, (=pkCli_7725,em1_7757: bitstring));
                                            {8866}let m1_7758: bitstring = em1_7757 in
                                            {8867}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7759: bitstring) = m1_7758 in
                                            {8868}new Ns_7760: bitstring;
                                            {8869}new ST_7761: bitstring;
                                            {8870}new TTL_7762: bitstring;
                                            {8871}let m2_7763: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7760,ST_7761,TTL_7762) in
                                            {8872}out(c, m2_7763);
                                            {8873}let Ksrv_7764: bitstring = h((Ns_7760,Nc_7759)) in
                                            {8874}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7764))
                                    )
                                    else
                                        {8875}let pkDisco_7765: bitstring = fail-any in
                                        {8876}in(c, (=pkCli_7725,em1_7766: bitstring));
                                        {8877}let m1_7767: bitstring = em1_7766 in
                                        {8878}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7768: bitstring) = m1_7767 in
                                        {8879}new Ns_7769: bitstring;
                                        {8880}new ST_7770: bitstring;
                                        {8881}new TTL_7771: bitstring;
                                        {8882}let m2_7772: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7769,ST_7770,TTL_7771) in
                                        {8883}out(c, m2_7772);
                                        {8884}let Ksrv_7773: bitstring = h((Ns_7769,Nc_7768)) in
                                        {8885}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7773))
                            )
                            else
                                {8886}let pkDisco_7774: bitstring = fail-any in
                                {8887}in(c, (=pkCli_7725,em1_7775: bitstring));
                                {8888}let m1_7776: bitstring = em1_7775 in
                                {8889}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7777: bitstring) = m1_7776 in
                                {8890}new Ns_7778: bitstring;
                                {8891}new ST_7779: bitstring;
                                {8892}new TTL_7780: bitstring;
                                {8893}let m2_7781: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7778,ST_7779,TTL_7780) in
                                {8894}out(c, m2_7781);
                                {8895}let Ksrv_7782: bitstring = h((Ns_7778,Nc_7777)) in
                                {8896}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7782))
                    )
                    else
                        {8897}let pkDisco_7783: bitstring = fail-any in
                        {8898}in(c, (=pkCli_7725,em1_7784: bitstring));
                        {8899}let m1_7785: bitstring = em1_7784 in
                        {8900}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7725,Nc_7786: bitstring) = m1_7785 in
                        {8901}new Ns_7787: bitstring;
                        {8902}new ST_7788: bitstring;
                        {8903}new TTL_7789: bitstring;
                        {8904}let m2_7790: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7787,ST_7788,TTL_7789) in
                        {8905}out(c, m2_7790);
                        {8906}let Ksrv_7791: bitstring = h((Ns_7787,Nc_7786)) in
                        {8907}out(c, senc(mSrv(pkCli_7725,pkSess_7386),Ksrv_7791))
        )
        else
            {8908}let pkCli_7792: bitstring = fail-any in
            {8909}let v_7793: bool = (Disco_5014 = A) in
            (
                {8910}if v_7793 then
                (
                    {8911}let pkDisco_7794: bitstring = pub(skA) in
                    {8912}in(c, (=pkCli_7792,em1_7795: bitstring));
                    {8913}let m1_7796: bitstring = em1_7795 in
                    {8914}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7797: bitstring) = m1_7796 in
                    {8915}new Ns_7798: bitstring;
                    {8916}new ST_7799: bitstring;
                    {8917}new TTL_7800: bitstring;
                    {8918}let m2_7801: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7798,ST_7799,TTL_7800) in
                    {8919}out(c, m2_7801);
                    {8920}let Ksrv_7802: bitstring = h((Ns_7798,Nc_7797)) in
                    {8921}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7802))
                )
                else
                    {8922}let v_7803: bool = (Disco_5014 = B) in
                    (
                        {8923}if v_7803 then
                        (
                            {8924}let pkDisco_7804: bitstring = pub(skB) in
                            {8925}in(c, (=pkCli_7792,em1_7805: bitstring));
                            {8926}let m1_7806: bitstring = em1_7805 in
                            {8927}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7807: bitstring) = m1_7806 in
                            {8928}new Ns_7808: bitstring;
                            {8929}new ST_7809: bitstring;
                            {8930}new TTL_7810: bitstring;
                            {8931}let m2_7811: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7808,ST_7809,TTL_7810) in
                            {8932}out(c, m2_7811);
                            {8933}let Ksrv_7812: bitstring = h((Ns_7808,Nc_7807)) in
                            {8934}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7812))
                        )
                        else
                            {8935}let v_7813: bool = (Disco_5014 = C) in
                            (
                                {8936}if v_7813 then
                                (
                                    {8937}let pkDisco_7814: bitstring = pub(skC) in
                                    {8938}in(c, (=pkCli_7792,em1_7815: bitstring));
                                    {8939}let m1_7816: bitstring = em1_7815 in
                                    {8940}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7817: bitstring) = m1_7816 in
                                    {8941}new Ns_7818: bitstring;
                                    {8942}new ST_7819: bitstring;
                                    {8943}new TTL_7820: bitstring;
                                    {8944}let m2_7821: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7818,ST_7819,TTL_7820) in
                                    {8945}out(c, m2_7821);
                                    {8946}let Ksrv_7822: bitstring = h((Ns_7818,Nc_7817)) in
                                    {8947}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7822))
                                )
                                else
                                    {8948}let pkDisco_7823: bitstring = pub(sk(Disco_5014)) in
                                    {8949}in(c, (=pkCli_7792,em1_7824: bitstring));
                                    {8950}let m1_7825: bitstring = em1_7824 in
                                    {8951}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7826: bitstring) = m1_7825 in
                                    {8952}new Ns_7827: bitstring;
                                    {8953}new ST_7828: bitstring;
                                    {8954}new TTL_7829: bitstring;
                                    {8955}let m2_7830: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7827,ST_7828,TTL_7829) in
                                    {8956}out(c, m2_7830);
                                    {8957}let Ksrv_7831: bitstring = h((Ns_7827,Nc_7826)) in
                                    {8958}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7831))
                            )
                            else
                                {8959}let pkDisco_7832: bitstring = fail-any in
                                {8960}in(c, (=pkCli_7792,em1_7833: bitstring));
                                {8961}let m1_7834: bitstring = em1_7833 in
                                {8962}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7835: bitstring) = m1_7834 in
                                {8963}new Ns_7836: bitstring;
                                {8964}new ST_7837: bitstring;
                                {8965}new TTL_7838: bitstring;
                                {8966}let m2_7839: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7836,ST_7837,TTL_7838) in
                                {8967}out(c, m2_7839);
                                {8968}let Ksrv_7840: bitstring = h((Ns_7836,Nc_7835)) in
                                {8969}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7840))
                    )
                    else
                        {8970}let pkDisco_7841: bitstring = fail-any in
                        {8971}in(c, (=pkCli_7792,em1_7842: bitstring));
                        {8972}let m1_7843: bitstring = em1_7842 in
                        {8973}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7844: bitstring) = m1_7843 in
                        {8974}new Ns_7845: bitstring;
                        {8975}new ST_7846: bitstring;
                        {8976}new TTL_7847: bitstring;
                        {8977}let m2_7848: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7845,ST_7846,TTL_7847) in
                        {8978}out(c, m2_7848);
                        {8979}let Ksrv_7849: bitstring = h((Ns_7845,Nc_7844)) in
                        {8980}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7849))
            )
            else
                {8981}let pkDisco_7850: bitstring = fail-any in
                {8982}in(c, (=pkCli_7792,em1_7851: bitstring));
                {8983}let m1_7852: bitstring = em1_7851 in
                {8984}let (=OpenSecureChannelRequest,=Sess_5015,=pkCli_7792,Nc_7853: bitstring) = m1_7852 in
                {8985}new Ns_7854: bitstring;
                {8986}new ST_7855: bitstring;
                {8987}new TTL_7856: bitstring;
                {8988}let m2_7857: bitstring = (OpenSecureChannelResponse,Cli_5013,Ns_7854,ST_7855,TTL_7856) in
                {8989}out(c, m2_7857);
                {8990}let Ksrv_7858: bitstring = h((Ns_7854,Nc_7853)) in
                {8991}out(c, senc(mSrv(pkCli_7792,pkSess_7386),Ksrv_7858))
)

-- Query not attacker(mSrv(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 76 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 108 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 124 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 124 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 128 rules. 368 rules in the queue.
1200 rules inserted. The rule base contains 99 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 144 rules. 294 rules in the queue.
1600 rules inserted. The rule base contains 162 rules. 280 rules in the queue.
1800 rules inserted. The rule base contains 266 rules. 201 rules in the queue.
2000 rules inserted. The rule base contains 390 rules. 111 rules in the queue.
Starting query not attacker(mSrv(pub(skA[]),pub(skC[])))
goal reachable: attacker(mSrv(pub(skA[]),pub(skC[])))
Abbreviations:
Ns_34676 = Ns_5972[em1_5969 = (OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672),Sess_5015 = C[],Disco_5014 = A[],Cli_5013 = A[],!1 = @sid_34673]
ST_34677 = ST_5973[em1_5969 = (OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672),Sess_5015 = C[],Disco_5014 = A[],Cli_5013 = A[],!1 = @sid_34673]
TTL_34678 = TTL_5974[em1_5969 = (OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672),Sess_5015 = C[],Disco_5014 = A[],Cli_5013 = A[],!1 = @sid_34673]

1. The attacker has some term Nc_34672.
attacker(Nc_34672).

2. The attacker initially knows C[].
attacker(C[]).

3. The attacker initially knows A[].
attacker(A[]).

4. By 3, the attacker may know A[].
By 3, the attacker may know A[].
By 2, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

5. The message pub(skA[]) may be sent to the attacker at output {2}.
attacker(pub(skA[])).

6. Using the function OpenSecureChannelRequest the attacker may obtain OpenSecureChannelRequest.
attacker(OpenSecureChannelRequest).

7. By 6, the attacker may know OpenSecureChannelRequest.
By 2, the attacker may know C[].
By 5, the attacker may know pub(skA[]).
By 1, the attacker may know Nc_34672.
Using the function 4-tuple the attacker may obtain (OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672).
attacker((OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672)).

8. By 5, the attacker may know pub(skA[]).
By 7, the attacker may know (OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672).
Using the function 2-tuple the attacker may obtain (pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672)).
attacker((pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672))).

9. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {5410}.
The message (pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672)) that the attacker may have by 8 may be received at input {6616}.
So the message (OpenSecureChannelResponse,A[],Ns_34676,ST_34677,TTL_34678) may be sent to the attacker at output {6623}.
attacker((OpenSecureChannelResponse,A[],Ns_34676,ST_34677,TTL_34678)).

10. By 9, the attacker may know (OpenSecureChannelResponse,A[],Ns_34676,ST_34677,TTL_34678).
Using the function 3-proj-5-tuple the attacker may obtain Ns_34676.
attacker(Ns_34676).

11. By 10, the attacker may know Ns_34676.
By 1, the attacker may know Nc_34672.
Using the function 2-tuple the attacker may obtain (Ns_34676,Nc_34672).
attacker((Ns_34676,Nc_34672)).

12. By 11, the attacker may know (Ns_34676,Nc_34672).
Using the function h the attacker may obtain h((Ns_34676,Nc_34672)).
attacker(h((Ns_34676,Nc_34672))).

13. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {5410}.
The message (pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_34672)) that the attacker may have by 8 may be received at input {6616}.
So the message senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_34676,Nc_34672))) may be sent to the attacker at output {6625}.
attacker(senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_34676,Nc_34672)))).

14. By 13, the attacker may know senc(mSrv(pub(skA[]),pub(skC[])),h((Ns_34676,Nc_34672))).
By 12, the attacker may know h((Ns_34676,Nc_34672)).
Using the function sdec the attacker may obtain mSrv(pub(skA[]),pub(skC[])).
attacker(mSrv(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {5410} in copy a_34679

in(c, (pub(skA),(OpenSecureChannelRequest,C,pub(skA),a))) at {6616} in copy a_34679

new Ns_5972 creating Ns_34680 at {6619} in copy a_34679

new ST_5973 creating ST_34681 at {6620} in copy a_34679

new TTL_5974 creating TTL_34682 at {6621} in copy a_34679

out(c, (OpenSecureChannelResponse,A,Ns_34680,ST_34681,TTL_34682)) at {6623} in copy a_34679

out(c, senc(mSrv(pub(skA),pub(skC)),h((Ns_34680,a)))) at {6625} in copy a_34679

The attacker has the message mSrv(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mSrv(pub(skA[]),pub(skC[]))) is false.
-- Query not attacker(mCli(pub(skA[]),pub(skC[])))
Completing...
200 rules inserted. The rule base contains 76 rules. 388 rules in the queue.
400 rules inserted. The rule base contains 108 rules. 388 rules in the queue.
600 rules inserted. The rule base contains 124 rules. 386 rules in the queue.
800 rules inserted. The rule base contains 124 rules. 386 rules in the queue.
1000 rules inserted. The rule base contains 128 rules. 368 rules in the queue.
1200 rules inserted. The rule base contains 99 rules. 360 rules in the queue.
1400 rules inserted. The rule base contains 144 rules. 294 rules in the queue.
1600 rules inserted. The rule base contains 162 rules. 280 rules in the queue.
1800 rules inserted. The rule base contains 266 rules. 201 rules in the queue.
2000 rules inserted. The rule base contains 390 rules. 111 rules in the queue.
Starting query not attacker(mCli(pub(skA[]),pub(skC[])))
goal reachable: attacker(mCli(pub(skA[]),pub(skC[])))
Abbreviations:
Nc_86131 = Nc_528[UP_527 = UP_86127,SP_526 = SP_86126,Sess = C[],Disco = A[],Cli = A[],!1 = @sid_86128]

1. The attacker has some term Ns_86123.
attacker(Ns_86123).

2. The attacker initially knows C[].
attacker(C[]).

3. The attacker initially knows A[].
attacker(A[]).

4. By 3, the attacker may know A[].
By 3, the attacker may know A[].
By 2, the attacker may know C[].
Using the function 3-tuple the attacker may obtain (A[],A[],C[]).
attacker((A[],A[],C[])).

5. The attacker has some term UP_86127.
attacker(UP_86127).

6. The attacker has some term SP_86126.
attacker(SP_86126).

7. Using the function None the attacker may obtain None.
attacker(None).

8. The message pub(skC[]) may be sent to the attacker at output {6}.
attacker(pub(skC[])).

9. Using the function GetEndpointResponse the attacker may obtain GetEndpointResponse.
attacker(GetEndpointResponse).

10. By 9, the attacker may know GetEndpointResponse.
By 8, the attacker may know pub(skC[]).
By 7, the attacker may know None.
By 6, the attacker may know SP_86126.
By 5, the attacker may know UP_86127.
Using the function 5-tuple the attacker may obtain (GetEndpointResponse,pub(skC[]),None,SP_86126,UP_86127).
attacker((GetEndpointResponse,pub(skC[]),None,SP_86126,UP_86127)).

11. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_86126,UP_86127) that the attacker may have by 10 may be received at input {46}.
So the message (pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_86131)) may be sent to the attacker at output {49}.
attacker((pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_86131))).

12. By 11, the attacker may know (pub(skA[]),(OpenSecureChannelRequest,C[],pub(skA[]),Nc_86131)).
Using the function 2-proj-2-tuple the attacker may obtain (OpenSecureChannelRequest,C[],pub(skA[]),Nc_86131).
attacker((OpenSecureChannelRequest,C[],pub(skA[]),Nc_86131)).

13. By 12, the attacker may know (OpenSecureChannelRequest,C[],pub(skA[]),Nc_86131).
Using the function 4-proj-4-tuple the attacker may obtain Nc_86131.
attacker(Nc_86131).

14. By 13, the attacker may know Nc_86131.
By 1, the attacker may know Ns_86123.
Using the function 2-tuple the attacker may obtain (Nc_86131,Ns_86123).
attacker((Nc_86131,Ns_86123)).

15. By 14, the attacker may know (Nc_86131,Ns_86123).
Using the function h the attacker may obtain h((Nc_86131,Ns_86123)).
attacker(h((Nc_86131,Ns_86123))).

16. The attacker has some term TTL_86125.
attacker(TTL_86125).

17. The attacker has some term ST_86124.
attacker(ST_86124).

18. Using the function OpenSecureChannelResponse the attacker may obtain OpenSecureChannelResponse.
attacker(OpenSecureChannelResponse).

19. By 18, the attacker may know OpenSecureChannelResponse.
By 3, the attacker may know A[].
By 1, the attacker may know Ns_86123.
By 17, the attacker may know ST_86124.
By 16, the attacker may know TTL_86125.
Using the function 5-tuple the attacker may obtain (OpenSecureChannelResponse,A[],Ns_86123,ST_86124,TTL_86125).
attacker((OpenSecureChannelResponse,A[],Ns_86123,ST_86124,TTL_86125)).

20. The message (A[],A[],C[]) that the attacker may have by 4 may be received at input {8}.
The message (GetEndpointResponse,pub(skC[]),None,SP_86126,UP_86127) that the attacker may have by 10 may be received at input {46}.
The message (OpenSecureChannelResponse,A[],Ns_86123,ST_86124,TTL_86125) that the attacker may have by 19 may be received at input {50}.
So the message senc(mCli(pub(skA[]),pub(skC[])),h((Nc_86131,Ns_86123))) may be sent to the attacker at output {54}.
attacker(senc(mCli(pub(skA[]),pub(skC[])),h((Nc_86131,Ns_86123)))).

21. By 20, the attacker may know senc(mCli(pub(skA[]),pub(skC[])),h((Nc_86131,Ns_86123))).
By 15, the attacker may know h((Nc_86131,Ns_86123)).
Using the function sdec the attacker may obtain mCli(pub(skA[]),pub(skC[])).
attacker(mCli(pub(skA[]),pub(skC[]))).


A more detailed output of the traces is available with
  set traceDisplay = long.

out(c, pub(skA)) at {2}

out(c, pub(skB)) at {4}

out(c, pub(skC)) at {6}

in(c, (A,A,C)) at {8} in copy a_86134

out(c, GetEndpointRequest) at {45} in copy a_86134

in(c, (GetEndpointResponse,pub(skC),None,a_86133,a_86132)) at {46} in copy a_86134

new Nc_528 creating Nc_86138 at {47} in copy a_86134

out(c, (pub(skA),(OpenSecureChannelRequest,C,pub(skA),Nc_86138))) at {49} in copy a_86134

in(c, (OpenSecureChannelResponse,A,a_86135,a_86136,a_86137)) at {50} in copy a_86134

out(c, senc(mCli(pub(skA),pub(skC)),h((Nc_86138,a_86135)))) at {54} in copy a_86134

The attacker has the message mCli(pub(skA),pub(skC)).
A trace has been found.
RESULT not attacker(mCli(pub(skA[]),pub(skC[]))) is false.
