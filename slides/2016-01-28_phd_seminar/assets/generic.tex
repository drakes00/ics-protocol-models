\begin{tikzpicture}[
        typetag/.style={rectangle, draw}
    ]
    \node[draw, anchor=west] (SCADA2) at (0,0.5){SCADA$_{2}$}; 
    \node[draw, anchor=west] (SCADA1) at (0,1.5){SCADA$_{1}$}; 
    \node[draw, anchor=west] (SCADAc) at (0,2.5){SCADA$_{corrupt}$};
    
    \coordinate (bus0) at ($(1,0)+(SCADAc.east |- 42,0)$);
    \draw (bus0) -- (bus0 |- 42,3);

    \draw (SCADA2.east) -- (bus0 |- SCADA2.east);
    \draw (SCADA1.east) -- (bus0 |- SCADA1.east);
    \draw (SCADAc.east) -- (bus0 |- SCADAc.east);

    \node[draw, anchor=west] (I1) at ($(0.25,0)+(bus0 |- 42,1)$){I$_{1}$};

    \node[anchor=west, typetag, text width=1.7cm] (GHc) at ($(1.25,0)+(bus0 |- 42,1)$) {Gateway\\$_{corrupt}$};
    \node[anchor=west] (ARAMIS) at (GHc.east){ARAMIS};
    \node[anchor=west, typetag, text width=1.7cm] (GBc) at (ARAMIS.east) {Gateway\\$_{corrupt}$};
    \node[draw, fit={(ARAMIS) (GHc) (GBc)}] {};

    \draw (bus0 |- I1.west) -- (I1.west);
    \draw (I1.east) -- (GHc.west);

    \node[draw] (I2) at ($(I1.north)+(0,1)$){I$_{2}$};
    \draw (I2.south) -- (I1.north);
    
    \node[draw, anchor=west] (I4) at ($(0.5,0)+(GBc.east |- 42,1)$){I$_{4}$};
    
    \coordinate (bus1) at ($(0.25,0)+(I4.east |- 42,0)$);
    \draw (bus1) -- (bus1 |- 42,3);

    \draw (GBc.east) -- (I4.west);

    \node[draw] (I3) at ($(I4.north)+(0,1)$){I$_{3}$};
    \draw (I3.south) -- (I4.north);

    \node[draw, anchor=west, text width=1.4cm] (PLC2) at ($(1,0)+(bus1 |- 42,0.5)$){PLC$_{2}$};
    \node[draw, anchor=west, text width=1.4cm] (PLC1) at ($(1,0)+(bus1 |- 42,1.5)$){PLC$_{1}$};
    \node[draw, anchor=west, text width=1.7cm] (PLCc) at ($(1,0)+(bus1 |- 42,2.5)$){PLC$_{corrupt}$};
    
    \draw (I4.east) -- (bus1 |- I4.east);
    \draw (PLC2.west) -- (bus1 |- PLC2.west);
    \draw (PLC1.west) -- (bus1 |- PLC1.west);
    \draw (PLCc.west) -- (bus1 |- PLCc.west);
\end{tikzpicture}
