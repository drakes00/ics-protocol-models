\documentclass{beamer}

\usepackage[T1]{fontenc}
\usepackage{inputenc}

\usepackage{xspace}
\usepackage{xcolor}
\usepackage{multirow}

\usepackage{tikz}
\usetikzlibrary{arrows,snakes,backgrounds,patterns,matrix,shapes,fit,calc,shadows,plotmarks,intersections,shapes.geometric}

\usepackage{algpseudocode}
\usepackage{algorithm}

\usepackage{amsmath}
\usepackage{listings}
\lstset{
    basicstyle=\footnotesize,
    language=Caml,
    captionpos=b,
    frame=TB,
    showstringspaces=false,
    escapeinside={<@}{@>},
}


\usetheme{Boadilla}
\usecolortheme{dolphin}
\useoutertheme{infolines}

\beamertemplatenavigationsymbolsempty
\setbeamertemplate{footline}{
    \leavevmode%
    \hbox{%
    \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
        \usebeamerfont{author in head/foot}\insertshortauthor%~~\beamer@ifempty{\insertshortinstitute}{}{(\insertshortinstitute)}
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
        \usebeamerfont{title in head/foot}\insertshorttitle
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
        \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
        \insertframenumber{} / 23%\inserttotalframenumber
            \hspace*{2ex}
    \end{beamercolorbox}}%
    \vskip0pt%
}


\newcommand{\TODO}{{\color{red}\bf [TODO]}}
\newcommand{\cybersec}{cybersecurity\xspace}
\newcommand{\Cybersec}{Cybersecurity\xspace}
\newcommand{\aramis}{Aramis\xspace}
\newcommand{\DiH}{Diffie-Hellman\xspace}
\newcommand{\XOR}{Exclusive-Or\xspace}
\newcommand{\modbus}{MODBUS\xspace}
\newcommand{\opcua}{OPC-UA\xspace}

\graphicspath{{assets/}}
\makeatletter
    \def\input@path{{assets/}}
\makeatother


\title{Filtering and Verifying Applicative Flows in Industrial Systems}
\author[Maxime Puys]{Maxime Puys\\[.5cm]Supervisors: Marie-Laure Potet and Jean-Louis Roch}
\institute{VERIMAG, Univ. Grenoble Alpes}
\date{January 28, 2016}



\begin{document}

\begin{frame}
    \maketitle

    \begin{columns}
        \begin{column}{.2\textwidth}
            \resizebox{\textwidth}{!}{
                \includegraphics{logo_verimag}
            }
        \end{column}
        \begin{column}{.2\textwidth}
            \resizebox{\textwidth}{!}{
                \includegraphics{logo_uga}
            }
        \end{column}
        \begin{column}{.15\textwidth}
            \resizebox{\textwidth}{!}{
                \includegraphics{logo_pia}
            }
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Industrial Systems}

    \begin{columns}
        \begin{column}{.3\textwidth}
            \resizebox{\textwidth}{!}{
                \includegraphics{scada}
            }
        \end{column}
        \begin{column}{.3\textwidth}
            \resizebox{\textwidth}{!}{
                \includegraphics{plc}
            }
        \end{column}
        \begin{column}{.3\textwidth}
            \resizebox{\textwidth}{!}{
                \includegraphics{plant}
            }
        \end{column}
    \end{columns}
    
    \begin{block}{Hot topic}
        \begin{itemize}
            \item Increasing number of attacks showed in the medias since Stuxnet \cite{Lan11}.
            \item Becoming a priority for government agencies.
            \begin{itemize}
                \item LPM to ensure the security of OIVs.
                \item Publications from ANSSI, DGA, ...
            \end{itemize}
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}
    \frametitle{Disambiguation}
    
    \begin{block}{Security concepts}
        \begin{itemize}
            \item Safety = Protection against identified/natural difficulties.
            \begin{itemize}
                \item Historic industrial concern.
            \end{itemize}
            \item \Cybersec = Protection against malicious adversaries.
            \begin{itemize}
                \item Often called Security.
            \end{itemize}
        \end{itemize}
    \end{block}
    \vfill
    \begin{figure}[htb]
        \resizebox{.85\columnwidth}{!}{
            \input{venn}
        }
        \vspace{-.2cm}
        \caption{Relations among security concepts}
    \end{figure}
    \vspace{-.5cm}
    \begin{itemize}
        \item Ludovic Pietre-Cambacedes' thesis: On the relationships between safety and security, Telecom ParisTech and EDF, 2010.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Differences between Industrial and Business IT}
    
    \begin{itemize}
        \item Really long-term installations, hard to patch, lot of legacy hosts.
            %\vfill
        %\item Inserting a new component must not imply existing devices modification.
            %\vfill
            \vfill
        \item Security objectives are different from traditional systems:
        \begin{itemize}
            %\item For audibility reasons and sometime performance, confidentiality is often avoided.
            \item Availability, integrity, authentication and non-repudiation.% are however very important.
        \end{itemize}
            \vfill
        %\item Industrial systems usually implement safety but rarely \cybersec:
        %\begin{itemize}
        %    \item Conditional dependancy, mutual strength, antagonism and independancy.
        %\end{itemize}
        %    \vfill
        \item Messages are READ/WRITE commands to PLCs.
        \begin{itemize}
            \item Sometimes SUBSCRIPTIONS, RPCs or grouped commands.
            \item Industrial protocols: \modbus, \opcua.
        \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{\aramis Project}% 1/2}

    \begin{itemize}
        \item Architecture Robuste pour les Automates et Mat\'eriels des Infrastructures Sensibles.
        \begin{itemize}
            \item PIA: Ministry of Industry, supervised by ANSSI.
        \end{itemize}
            \vspace{1em}
        \item Partners: ATOS World Grid, SecLab, CEA-leti, PERSYVAL-Lab.
            \vspace{1em}
        \item Objective: build a transparent device to filter industrial flows.
        \begin{itemize}
            \item Communication protocols are stopped and re-created.
            \item Applicative filtering with domain specific constraints.
        \end{itemize}
        %    \vfill
        %\item Total: 4 PhD students and 2 engineers.
    \end{itemize}
    %\vfill
    \begin{figure}[htb]
        \resizebox{.8\columnwidth}{!}{
            \input{aramis}
        }
        \caption{Idea of \aramis}
    \end{figure}
\end{frame}

%\begin{frame}
%    \frametitle{\aramis Project 2/2}
%
%    %\vspace{-1em}
%    \begin{itemize}
%        \item \aramis device must be really hardened:
%        \begin{itemize}
%            \item Around 350 requirements (including 100 for security).
%        \end{itemize}
%        %    \vfill
%        %\item Combine security properties of the protocols with domain specific
%        %    constraints in term of flows.
%    \end{itemize}
%    %\vspace{-.5cm}
%    %\begin{itemize}
%    %    \item I will participate within three parts:
%    %    \begin{itemize}
%    %        \item Applicative filtering,
%    %        \item Security requirements
%    %        \item Certification process.
%    %    \end{itemize}
%    %\end{itemize}
%\end{frame}

\begin{frame}
    \frametitle{Scientific Objectives}
    
    Attack models and industrial domain specific protection for provable security properties.
    %Difficult to combine security properties provided by protocols with
    %domain-specific constraints.
    \vfill
    \begin{itemize}
        \item Applicative filtering
            \vfill
        \item Attack models
            \vfill
        \item Verification of Industrial Protocols
    \end{itemize}
    \vfill
    Not redo the safety.
    %\begin{block}{Applicative filtering}
    %    Considering domain-specific constraints in term of messages flow.
    %\end{block}
    %\vfill
    %\begin{block}{Attack models}
    %    Model attacks against industrial communications according to various
    %    parameters (e.g.: network architecture, attacker's objectives, security
    %    properties of protocols).
    %\end{block}
    %\vfill
    %\begin{block}{Verification of Industrial Protocols}
    %    Formal verification of the security properties claimed by industrial
    %    protocols.
    %\end{block}
\end{frame}

\section{Applicative Filtering}

\begin{frame}
    \frametitle{Table of Contents}
    
    \tableofcontents[currentsection]
\end{frame}

\begin{frame}
    \frametitle{\aramis Filter}

    \begin{figure}[htb]
        \resizebox{\columnwidth}{!}{
            \input{aramis_zoom}
        }
        \caption{Zoom on the \aramis device}
    \end{figure}
    \vspace{-1.3em}
    \begin{itemize}
        \item Double proxy and firewall.
            \vfill
        \item Embedded device:
        \begin{itemize}
            \item Memory and time constraint.
            %\item No code loading (rules must be interpreted).
        \end{itemize}
    \end{itemize}
\end{frame}

%\begin{frame}
%    \frametitle{Problem Statement}
%
%    \begin{block}{Objectives}
%        {\bf Applicative filtering:} focus on the packet's payload.
%
%        Understand the semantics behind the message to allow or reject.
%    \end{block}
%    \vfill
%    \begin{itemize}
%        \item Packets are interpreted by the \aramis device:
%        \begin{itemize}
%            \item Allow to filter the meaning of the message regardless of the protocol.
%        \end{itemize}
%    \end{itemize}
%    \vfill
%    \begin{itemize}
%        \item Messages are mostly read/write commands on variables.
%    \end{itemize}
%    \vspace{-.7em}
%    \begin{table}[htb]
%        \begin{tabular}{|c|c|}
%            \hline
%            {\bf Read Command}      & {\bf Write Command}           \\
%            \hline
%            \multicolumn{2}{|c|}{User has access to the variable?}  \\
%            \hline
%            Variable can be read ?  & Variable can be written ?     \\
%            \hline
%                                    & Value to write is valid ?     \\
%            \hline
%        \end{tabular}
%        \caption{What can be filtered?}
%    \end{table}
%    \vfill
%\end{frame}

\begin{frame}
    \frametitle{Current Filters}
    
    \begin{block}{Variable whitelist}
        {\sf foo {\color{red} 1} {\color{blue} int} {\color{green!50!black} RW} {\color{cyan} SERVER {\em IP:Port}} {\color{yellow!50!black} ACCEPT\_FROM {\em IP/Mask}} {\color{orange} VALUES 0 100}}

        \medskip
        A variable belongs to a {\color{cyan} server} and can be accessed by some {\color{yellow!50!black} clients}.

        It has a {\color{red} size}, a {\color{blue} type}, different {\color{green!50!black} permissions}, and {\color{orange} valid values}.
    \end{block}
    \vfill
    \begin{block}{Kinematic filters}
        {\sf (foo == False AND bar >= 5) PREVENT (baz := False)}

        \medskip
        The filter memorizes the values of variables into $\sigma$.

        \begin{algorithmic}
            \If {$incomingMessage$ {\bf matches} $rightPredicate$}
                \If {$\sigma \vdash leftPredicate$}
                    \State $Take~action.$
                \EndIf
            \EndIf
        \end{algorithmic}
        {\bf Drawback:} Only guaranties local decision.%applicable if global view of the system.
    \end{block}
\end{frame}

\begin{frame}
    \frametitle{Perspectives : Temporal Filters}% (against DOS)}

    \begin{itemize}
        \item Protection against DOS attacks launched by robots.
    \end{itemize}
    \vfill
    \begin{example}
        No more than {\color{blue} N commands} {\color{red} within T seconds}.
    \end{example}
    \vfill
    \begin{example}
        Boolean values are not flipping {\color{blue} more than N times} {\color{red} within T seconds}.
    \end{example}
    \vfill
    \begin{example}
        Integer values are not changing {\color{blue} more than N times} and with an {\color{orange} amplitude higher than M\%} {\color{red} within T seconds}.
    \end{example}
\end{frame}

\section{Attack Models}

\begin{frame}
    \frametitle{Table of Contents}
    
    \tableofcontents[currentsection]
\end{frame}

\begin{frame}
    \frametitle{Approach}
 
    \begin{itemize}
        %\item Similar to risk analysis (e.g.: EBIOS\cite{EBIOS}, MEHARI\cite{MEHARI}).
        %    \vfill
        \item Objectives:
        \begin{itemize}
            \item Model a SCADA system and its threats.
            \item Model the security properties of protocols.
            \item Deduce attack scenarios.
            \item Generate corresponding traffic.
        \end{itemize}
            \vfill
        \item Attacks found: must be covered by \aramis.
    \end{itemize}
    %\vfill
    %\begin{figure}[htb]
    %    \resizebox{.6\textwidth}{!}{
    %        \input{ebios}
    %    }
    %    \caption{EBIOS method}
    %\end{figure}
\end{frame}

\begin{frame}
    \frametitle{Specification of Attack Scenarios}

    \begin{figure}[htb]
        \resizebox{.35\textwidth}{!}{
            \input{approach_attack_model}
        }
        \caption{Attack specification}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{A Simple Example}

    \vspace{-.7em}
    \begin{figure}[htb]
        \resizebox{.7\textwidth}{!}{
            \input{attack_example}
        }
        \caption{Network architecture}
    \end{figure}
    \vspace{-1em}
    \begin{itemize}
        \item Objective of {\color{red} Intruder}: Attack the integrity of the comm. to {\color{green!70!black} PLC$_{2}$}.
        \begin{itemize}
            \item Realization: message replay, modification, ...
        \end{itemize}
            \vfill
        \item Protocol of {\color{green!70!black} PLC$_{2}$}: \opcua (2 security modes).
            \vfill
        \item Capacities of {\color{red} Intruder}:
        \begin{itemize}
            \item None if secured mode.
            \item Replay and forge if not secured mode.
        \end{itemize}
            \vfill
        \item Attack scenario: {\color{red} Intruder} replays a request on unsecure \opcua.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{General Approach}

    \vspace{-2em}
    \begin{figure}[htb]
        \resizebox{\textwidth}{!}{
            \input{generic}
        }
        \caption{Network architecture}
    \end{figure}
    \vfill
    \begin{itemize}
        \item Systematic study of multiple possible parameters:
        \begin{itemize}
            \item Attackers, objectives, protocoles, capacities, ...
        \end{itemize}
        %\item More than one attacker (possibly colluding).
        %\item More complex objectives.
        %\item More capacities than forging.
        %\item Several protocols with different security properties
        %\begin{itemize}
        %    \item And different security modes.
        %\end{itemize}
        %    \vfill
        %\item Perspective: Interference of flows within ARAMIS device.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Attack Traffic Generation}

    \begin{itemize}
        \item From scenarios of attack models.
    \end{itemize}
    \vfill
    \begin{figure}[htb]
        \resizebox{.8\textwidth}{!}{
            \input{ter}
        }
        \caption{How to generate attack traffic}
    \end{figure}
    \vfill
    \begin{itemize}
        \item Supervision of two TER interns with Emmanuel Perrier:
        \begin{itemize}
            \item Francesco Furfaro and Joris Chaffard.
        \end{itemize}
    \end{itemize}
\end{frame}

%\begin{frame}[fragile]
%    \frametitle{CSP\cite{Hoa78} Example}
%
%    \begin{itemize}
%        \item Replay a message
%    \end{itemize}
%    \vfill
%    \begin{lstlisting}[caption=Pseudo CSP for message replay]
%P() =
%    c?packet ->
%    RemoveHeader(packet, msg) ->
%    c!msg ->
%    STOP
%    \end{lstlisting}
%    \vfill
%    \begin{itemize}
%        \item RemoveHeader() is another helper (possibly not in CSP).
%    \end{itemize}
%\end{frame}

\section{Verification of Industrial Protocols}

\begin{frame}
    \frametitle{Table of Contents}
    
    \tableofcontents[currentsection]
\end{frame}

\begin{frame}
    \frametitle{Cryptographic Protocol Verification}

    \begin{itemize}
        \item Attack modeling relies on security properties of protocols.
        \begin{itemize}
            \item Check if they are ensured.
        \end{itemize}
            \vfill
        \item How to use protocol verification tools (e.g.: AVISPA\cite{AVISPA06_manual}, ProVerif\cite{Bla01}) on industrial protocols?
        \begin{itemize}
            \item Tools can verify secrecy and authentication.
        \end{itemize}
            \vfill
        \item Focus on properties required by industry:
        \begin{itemize}
            \item Integrity.
            \item Availability.
        \end{itemize}
    \end{itemize}
    %\vfill
    %\begin{block}{Flow integrity}
    %    Messages received by a peer are the same as those sent by another.
    %    
    %    Take into account the order of the messages.
    %\end{block}
\end{frame}

\begin{frame}
    \frametitle{Modeling \opcua}

    \begin{itemize}
        \item New standard for industrial communications.
        \item Security similar to TLS\cite{DR08}.
    \end{itemize}
    \begin{columns}
        \begin{column}{.5\textwidth}
            \begin{figure}[htb]
                \resizebox{1.1\textwidth}{!}{
                    \includegraphics{opcua}
                }
                \caption{Sub-protocol of \opcua}
            \end{figure}
        \end{column}
        \begin{column}{.5\textwidth}
            \begin{itemize}
                \item Goal: Model \opcua in verification tools.
                \begin{enumerate}
                    \item Verify secrecy and authentication.
                    \item Model industry properties such as integrity.
                    \item Application to other industrial protocols.
                \end{enumerate}
            \end{itemize}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Advanced modeling researches}

    \begin{block}{Benchmark of Verification Tools}
        \begin{itemize}
            \item Joint work with Pascal Lafourcade.
            \item Goal: Compare performances of some tools with complex algebraic properties.
            \begin{itemize}
                \item 6 tools compared on 21 protocols (nearly 400 test runs).
            \end{itemize}
            \item Publication in FPS'15.
        \end{itemize}
    \end{block}
    \vfill
    \begin{block}{Distributed Computation Protocol}
        \begin{itemize}
            \item Joint work with Pascal Lafourcade, Jean-Guillaume Dumas (LJK) and Jean-Baptiste Orfila (LJK).
            \item Goal: Prove the security of a distributed computation protocol.
            \begin{itemize}
                \item New algebraic properties: Homomorphic properties.
            \end{itemize}
            %\item Submitted to AFRICACRYPT'16.
        \end{itemize}
    \end{block}
    %\begin{itemize}
    %    \item Interest for the thesis: Advanced aspects of the verification tools.
    %\end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Conclusion}

    \begin{figure}[htb]
        \centering
        \resizebox {.7\textwidth} {!} {
            \input{thesis}
        }
        \caption{Axes of my thesis}
    \end{figure}
    \vspace{-1em}
    \begin{itemize}
        \item Strong industrial context.
        \item Stimulating interaction with government agencies.
        \item Possible project with LIG and GIPSA-lab on attack generation against industrial systems.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Complete Publication List}

    \begin{enumerate}
        \item M. Potet, L. Mounier, M. Puys, and L. Dureuil. {\bf Lazart: A symbolic approach for evaluation the robustness of secured codes against control Flow Injections.} In {\em ICST'14}, 2014.
            \vfill
        \item M. Puys, L. Rivi\`ere, J. Bringer, and T. Le. {\bf High-Level Simulation for multiple fault Injection Evaluation.} In {\em QASA'14}, 2014.
            \vfill
        \item L. Rivi\`ere, M. Potet, T. Le, J. Bringer, H. Chabanne, and M. Puys. {\bf Combining High-Level and low-level approaches to evaluate software implementations robustness against multiple fault Injection Attacks.} In {\em FPS'14}, 2014.
            \vfill
        \item P. Lafourcade and M. Puys. {\bf Performance Evaluations of cryptographic protocols verification tools dealing with Algebraic Properties.} In {\em FPS'15}, 2015.
    \end{enumerate}
\end{frame}

\begin{frame}
    \frametitle{Conclusion}

    \begin{center}
        Thanks for your attention!
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Safety and Security}
    
    \begin{figure}[htb]
        \resizebox{.6\columnwidth}{!}{
            %\includegraphics{liens_safety_secu}
            \input{safety_secu}
        }
        \caption{How to link safety and security \cite{Pie10}}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Purdue Model}

    \begin{figure}[htb]
        \resizebox{.8\columnwidth}{!}{
            \input{purdue}
        }

        \caption{Purdue model \cite{Wil91}}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Cryptograpfic Protocols Verification}

    \begin{exampleblock}{Needham-Schroeder}
        \vspace{-.8em}
        \begin{columns}
            \begin{column}{.45\textwidth}
            \begin{enumerate}
                \item A $\rightarrow$ B : $\{A,N_{A}\}_{KB}$
                \item B $\rightarrow$ A : $\{N_{A},N_{B}\}_{KA}$
                \item A $\rightarrow$ B : $\{N_{B}\}_{KB}$
            \end{enumerate}
            \end{column}
            ~
            \begin{column}{.45\textwidth}
                Designed and {\bf proved} in 1978.\\% by Roger Needham and Michael Schroeder.\\
                Broken in 1996 (17 years after).\\% by Gavin Lowe using \casperfdr, known as {\em Man-In-The-Middle} attack.\\
            \end{column}
        \end{columns}
    \end{exampleblock}

    \begin{exampleblock}{Man-In-The-Middle attack}
        \vspace{-.8em}
        \begin{columns}
            \begin{column}{.45\textwidth}
                \begin{enumerate}
                    \item A $\rightarrow$ I : $\{A,N_{A}\}_{KI}$
                    \item[]
                    \item[]
                          \setcounter{enumi}{1}
                    \item I $\rightarrow$ A : $\{N_{A},N_{B}\}_{KA}$
                    \item A $\rightarrow$ I : $\{N_{B}\}_{KI}$
                    \item[]
                \end{enumerate}
            \end{column}
            ~
            \begin{column}{.45\textwidth}
                \begin{enumerate}
                    \item[]
                          \setcounter{enumi}{0}
                    \item I $\rightarrow$ B : $\{A,N_{A}\}_{KB}$
                    \item B $\rightarrow$ I : $\{N_{A},N_{B}\}_{KA}$
                    \item[]
                    \item[]
                          \setcounter{enumi}{2}
                    \item I $\rightarrow$ B : $\{N_{B}\}_{KB}$
                \end{enumerate}
            \end{column}
        \end{columns}
    \end{exampleblock}
    \vfill
    \begin{itemize}
        \item Way too much possible combinations.% outpaces the humans' capabilities.
        \begin{itemize}
            \item Need of automation using tools.
        \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]
    \frametitle{References}
    
    \bibliographystyle{amsalpha}
    \bibliography{phdBiblio}
\end{frame}

\end{document}
