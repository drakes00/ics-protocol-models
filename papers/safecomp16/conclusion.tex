We provide a formal verification of the industry standard
communication protocol: \opcua, relying its official specifications
\cite{MLD09,opcua_part2,opcua_part4,opcua_part6}.
We use \proverif{} a tool for automatic cryptographic protocol
verification.  Protocol modelings were tedious tasks since
specifications are often elusive to allow interoperability.
Particularly due to unclear statements on the use of cryptography with
security mode \sms, we studied the protocol with and without
counter-measures and proved the need of encryption for secrets to
ensure messages security properties.  We also found attacks on
authentication and provided counter-measures.

In the future, we aim at testing the attacks we found on official
implementations which are proprietary. This next work would analyze
if these implementations filled the gap as did {\em FreeOpcUa}, 
adopting the prudent engineering practices advised in~\cite{AN96} to
circumvent the attacks.
%If they do, then our analysis formally proves the security of the protocol.
%More generally, we are also interested in
%studying how to model integrity properties for messages and
%communication flows in \proverif{} since it is one of the requirements
%of industrial protocols.
