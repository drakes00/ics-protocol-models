\begin{frame}[fragile] \frametitle{On an example: {\tt VerifyPIN}}
% Au niveau source Ã§a peut se traduire par :
\begin{columns}[t]
    \begin{column}{0.55\textwidth}\vspace{-18em}
\begin{lstlisting}[
  basicstyle=\footnotesize\ttfamily,
]
int verify(char buffer[4]) {
  int i;
  for(i = 0; i < 4; i++) {
    if(buffer[i] != pin[i]) {
      authenticated = 0;
      goto FAILURE;
    }
  }
  authenticated = 1;
  return EXIT_SUCCESS;
FAILURE:
  return EXIT_FAILURE;
}
\end{lstlisting}
\end{column}
\begin{column}{0.4\textwidth}
\includegraphics[height=8cm]{simplebb5color.pdf} 
\end{column}
\end{columns}
\end{frame}

\begin{frame} \frametitle{Results obtained for the {\tt VerifyPIN} example}
\vfill
Number of test execution produced:
\begin{center}
\begin{tabular}{|l|c|c|c|}
\hline
 \# fault injections &  no input constraints   & input PIN is incorrect \\
\hline
fault $==$0 & 1    & 0   \\
\hline
%fault $==$1 &    &  {\bf 1} (Ex. \ref{attack1F})  \\
fault $==$1 & x &  {\bf 1}  \\
\hline
fault $==$2 & x    &  {\bf 1}  \\
\hline
% fault $>=$ 3 &     &  {\bf 3} (Ex. \ref{attack4F})    \\
fault $>=$ 3 & x     &  {\bf 3}    \\
\hline
%Total  & & x & 1  & 5\\
%\hline
\end{tabular}
\end{center}
\vfill
\begin{block}{A 1-fault attack scenario}
Circumvent the whole loop (PIN verification) execution \\
{\bf Optional mutation on bb4}
\end{block}
\vfill
\begin{block}{A 4-faults attack scenario}
Change the result (inside the loop) when checking each PIN digit \\
{\bf Mandatory mutation on bb1: force the flow to bb3}
\end{block}
\vfill
\end{frame}

\begin{frame}[fragile]{A PIN {\tt Verify} procedure with countermeasures (CM)}
\begin{columns}[t]
    \begin{column}{0.70\textwidth}\vspace{-21em}
\begin{tiny}
\begin{lstlisting}[basicstyle=\tiny\ttfamily,
]
char triesLeft = maxTries; 
char triesLeftBackup = -maxTries; // triesleft BACKUP
BYTE Verify(char buffer[4]) {
   int i;
   int stepCounter = INITIAL_VALUE;	   // instruction counter
   short char t1 = triesLeft;
   if(t1 != -triesLeftBackup) goto CM ;  // check with triesleft BACKUP
   if(triesLeft <= 0) return EXIT_FAILURE;
   t1--; triesLeft = t1; triesLeftBackup++;
   if(triesLeft != -triesLeftBackup) goto CM ;
   equal = BOOL_TRUE;
   for(i = 0; i < 4; i++)
    {equal=equal&((buffer[i]!=pin[i])?BOOL_FALSE:BOOL_TRUE);
    stepCounter++; };
   if(equal == BOOL_TRUE) {
      if(equal != BOOL_TRUE) goto CM ;  // redundant test
      triesLeft = maxTries; triesLeftBackup = -maxTries;
      if (triesLeft != -triesLeftBackup) goto CM ;
      authenticated = 1;
      if(stepCounter == INITIAL_VALUE + 4)  // check instruction counter
         return EXIT_SUCCESS; }  // TO BE REACHED
   else { 
      authenticated = 0;
      if(stepCounter == INITIAL_VALUE + 4) // check instruction counter
         return EXIT_FAILURE; }
}
\end{lstlisting}
\end{tiny}
\end{column}
\begin{column}{0.3\textwidth}
\includegraphics[height=8cm]{modifiedbb12colorComp.pdf} 
\end{column}
\end{columns}
\end{frame}
%
%\begin{frame}[fragile]{CFG coloring}
%\vfill 
%Attack objective = authentication and then avoid CM \dots
%\vfill
%\begin{columns}[t]
%\begin{column}{0.40\textwidth}
%\includegraphics[height=7.5cm]{modifiedbb12colorComp.pdf}
%\end{column}
%\begin{column}{0.40\textwidth}
%\includegraphics[height=7.5cm]{modifiedcounter_measurecolorComp.pdf}
%\end{column}
%\end{columns}
%\vfill
%\end{frame}
%
%\begin{frame}[fragile]{Number of test cases obtained}
%\vfill
%\begin{scriptsize}
%\begin{center}
%\begin{tabular}{|l|c|c|}
%\hline
%Number of & All detected attacks & Without redundant attacks \\
%\hline
%fault ==0 &  0  &0   \\
%\hline
%fault ==1 &  $1^*$   & $1^*$  \\
%\hline
%fault ==2 &  2  & 2   \\
%\hline
%fault ==3 &  5  & 0 \\
%\hline
%fault ==4 & 11 &   1    \\
%\hline
%fault $>$=5 & 13 &  0  \\
%\hline
%\end{tabular}
%\end{center}
%\end{scriptsize}
%\vfill
%\begin{block}{Examples of scenarios}
%\begin{itemize}
%\item 1-fault: 5 loop executions (out-of-bound error)
%\item $\geq$ 2-faults: need to prevent specific counter-measure execution
%\end{itemize}
%\end{block}
%\vfill
%\begin{block}{Redundant attack}
%$\exists$ a smaller attack (with less faults) covering the same fault injection locations
%\end{block}
%\vfill
%\end{frame}

