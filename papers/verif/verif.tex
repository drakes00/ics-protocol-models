%\documentclass[a4paper]{article}
\documentclass{llncs}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

\usepackage{multirow}

\usepackage{graphicx}
\usepackage{xstring}
\usepackage{xspace}
\usepackage{amstext}

%\usepackage{showframe}
\usepackage{times}

\usepackage{auto-pst-pdf}
\usepackage{msc}

% ========== Don't touch ==========
\makeatletter
    \def\msc@frame{no}
    \def\msc@settitle{}
\makeatother

\newcommand{\dosmnone}[3]{#1}
\newcommand{\dosmsign}[3]{#1, $\left\{\mbox{h(#1)}\right\}_{\mbox{#3}}$}
\newcommand{\dosmsignandencrypt}[3]{$\left\{\mbox{#1}\right\}_{\mbox{#2}}$, $\left\{\mbox{h(#1)}\right\}_{\mbox{#3}}$}

\newcommand{\smn}{None}
\newcommand{\sms}{Sign}
\newcommand{\smse}{SignAndEncrypt}
\newcommand{\smseshort}{SignEnc}

\newcommand{\sm}{\IfStrEq{\smname}{\smn}{\dosmnone}{\IfStrEq{\smname}{\sms}{\dosmsign}{\dosmsignandencrypt}}}

\newcommand{\ifsmnotnone}[1]{\IfStrEq{\smname}{\smn}{}{#1}}
\newcommand{\smname}{\smseshort}
% ========== Don't touch ==========

\newcommand{\UNSAFE}{{\color{red!50!black} UNSAFE}\xspace}
\newcommand{\SAFE}{{\color{green!50!black} SAFE}\xspace}
\newcommand{\NA}{{\color{blue!50!black} N/A}\xspace}
\newcommand{\TODO}{{\color{red}\bf TODO}\xspace}
\newcommand{\DiH}{Diffie-Hellman\xspace}
\newcommand{\proverif}{ProVerif\xspace}
\newcommand{\ofmc}{OFMC\xspace}
\newcommand{\spear}{SPEAR II\xspace}
\newcommand{\opcua}{OPC-UA\xspace}
\newcommand{\opc}{OPC\xspace}
\newcommand{\dcom}{DCOM\xspace}
\newcommand{\mms}{MMS\xspace}
\newcommand{\iec}[1]{IEC\xspace#1\xspace}
\newcommand{\iccp}{ICCP\xspace}
\newcommand{\modbus}{MODBUS\xspace}
\newcommand{\profinet}{PROFINET\xspace}
\newcommand{\etherip}{EtherNet/IP\xspace}
\newcommand{\dnp}{DNP3\xspace}
\newcommand{\eg}{{\em e.g.}\xspace}
\newcommand{\etal}{{\em et al.}\xspace}
\newcommand{\securechan}{{\em OpenSecureChannel}\xspace}
\newcommand{\session}{{\em CreateSession}\xspace}

\title{Formal Analysis of Security Properties on the \opcua SCADA Protocol}
\author{Maxime Puys$^1$ \and Marie-Laure Potet$^1$ \and Pascal Lafourcade$^{1,2}$}
\institute{(1) Verimag, University Grenoble Alpes,  Gi\`eres, France \\
  \texttt{firstname.lastname@imag.fr}\\
   (2) LIMOS, University Clermont Auvergne,  Campus des C\'ezeaux, Aubi\`ere, France\\
  \texttt{pascal.lafourcade@udamail.fr}
  \thanks{This work has been partially supported by the LabEx PERSYVAL-Lab
      (ANR-11-LABX-0025) and the project {\em Programme Investissement d’Avenir
      FSN AAP Sécurité Numérique n\textsuperscript{o}3} ARAMIS (P3342-146798).}
}
\date{}

\begin{document}

\maketitle

\begin{abstract}
    Industrial systems are publicly the target of cyberattacks since Stuxnet
    \cite{Lan11}.  Nowadays they often communicate over insecure media such
    as Internet.  Due to their interaction with the physical world, it
    is crucial to prove the security of their protocols.  In this
    paper, we  formally study of the security of one of the
    most used industrial protocols: \opcua.  Using
    ProVerif, a well known cryptographic protocol verification tool,
    we are able to check secrecy and authentication properties.  We
    find several attacks on the protocols and provide countermeasures.
\end{abstract}

\section{Introduction}
\input{intro}

%\section{Misc}
%
%\paragraph{NonIdent} Considering a powerful intruder, anybody could play the role of the client and
%the role of the server, including the interder.
%In such model, a legitimate client could communicate with a rogue server.
%
%
%\paragraph{Ident} A more realistic model supposes that the client and the server know each other
%and would only communicate together.
%Obviously, these models are equivalent if the protocol does not provide any
%authentication method.
%Integrity only applies in this model since it abstracts hosts identity
%(integrity can be seen as a mono-session authentication).

%% \section{\modbus}
%% \input{modbus}


\section{\opcua OpenSecureChannel}\label{sec:secure_channel}
\input{opcua_secure_channel}

\section{\opcua CreateSession}\label{sec:session}
\input{opcua_session}

%\section{Flow integrity}
%%TODO \input{flow}
%Idée: Modéliser l'envoie et la réception de messages jusqu'à fermeture du cannal.
%A la fin envoyer les messages envoyés et reçus à un oracle qui les compare.
%
%\section{TODO list}
%
%\begin{itemize}
%    \item Comment s'articulent la signature et le chiffrement (signature d'un haché, d'un chiffré, ...) ?
%    \item Logjam $\Rightarrow$ Oui, vulnérable si hypothèse de DH OK
%    \item Quel type de chiffrement (CBC, ...) ?
%    \item Est-ce que tout est réellement signé (constantes publiques) ?
%\end{itemize}

\section{Conclusion}\label{sec:conclusion}
\input{conclusion}

\bibliographystyle{unsrt}
\bibliography{phdBiblio}

\end{document}
