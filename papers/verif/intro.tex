Industrial systems also called SCADA (Supervisory Control And Data
Acquisition) have been known to be targeted by cyberattacks since the
famous Stuxnet case~\cite{Lan11} in 2010.  Due to the criticity of
their interaction with the physical world, these systems can
potentially be really harmful for humans and environment.  The
frequence of such attacks is increasing to become one of the priorities for
governmental agencies (\eg~\cite{SFS11} from the US National Institute of
Standards and Technology (NIST) or
\cite{ANSSI12_guide_securite_industrielle_en} from the French {\em Agence
nationale de la sécurité des systèmes d'information} (ANSSI)).
%As
%industrial systems historically have been physically isolated from the
%rest of the world, there were less exposed to cyber attacks and their
%security was less considered. Nowadays, such attacks become feasible
%because these systems are spreading geographically and communicating
%more and more through unsafe mediums like Internet.


%Industrial systems have specificities. First the isolation of such
%systems requires the attacker to be physically present in the
%system. Then compagnies focused more on the protection against natural
%deceases and human mistakes than cybersecurity (often call security).
%In the context of security there is an adversary willing to perform malicious
%actions.
Industrial systems differ from other systems because of
the really long lifetime of there devices and their difficulty to
patch in case of vulnerabilities.
Such specificities encourage to carefully check
standards and applications before deploying them.
%It also explain the number of legacy hosts.
%Moreover, most of industrial protocols are proprietary and
%provide a very low level of security if
%any, \eg \modbus~\cite{MODBUS}, \profinet~\cite{PROFINET}, \etherip~\cite{Bro01}
%or
%\dnp~\cite{CR04}.
%However, in 2006, the {\em OPC Foundation} (an industry consortium)
%released the first version of \opcua~\cite{MLD09}, which is presented
%as the new standard for industrial communications. %% This standard  and whose security
%% is quite closer to business IT's protocols such as TLS~\cite{DR08}.
%% This directly applies to communication protocols.
As it already appeared for business IT's protocols for twenty years,
automated verification is crucial in order to discover flaws in the
protocols' specifications before assessing implementations. However,
the lack of formal verification of industrial protocols has been
emphasized in 2006 by Igure \etal~\cite{ILW06} and in 2009 by
Patel \emph{\etal}~\cite{PBG09}.  They particularly argued that
automated protocol verification allows us to understand most of the
vulnerabilities of a protocol before changing its standards which
helps at minimizing the number of revisions which costs time and
money.  Moreover, due to the combinational explosion of the number of
possible execution traces and the increasing complexity of the
systems, only automated verification can ensure the security of a
protocol in a given model.

%\subsection{State-of-the-art}\label{sec:intro_sota}
\paragraph{State-of-the-art:}\label{sec:intro_sota}

%The security of industrial protocols becomes a hot topic and some works are
%present in the literature.
Most of the works on the security of industrial protocols only rely on
specifications written in human language rather than using formal methods.
In 2004, Dzung \etal~\cite{} proposed a detailed survey on the security in SCADA
systems including unformal analysis on the security properties offered by
various industrial protocols: \opc (Open Platform Communications),
\mms (Manufacturing Message Specification),
\iec{61850}, \iccp (Inter-Control Center Communications Protocol) and \etherip.
Still in 2004, Clarke \etal~\cite{CR04} discussed the security of \dnp
(Distributed Network Protocol) and \iccp.
In 2006, in the technical documentation of \opcua (OPC Unified Architecture) the
authors detailled the security measures of the protocol (specialy in part 2, 4
and 6).
In 2015, Wanying \etal summarizeed the security offered by \modbus, \dnp and
\opcua.

On the other hand, some works propose new versions of existing protocols to make
them secure against malicious adversaries.
In 2007, Patel \etal~\cite{PY07} studied the security of \dnp and proposed two
ways of enhancing it through digital signatures and challenge-response models.
In 2009, Fovino \etal~\cite{FCMT09} proposed a secure version of \modbus
relying on well-known cryptographic primitives such as RSA or SHA2.
%This version of the protocol also need to introduce new components in the system
%to allow existing devices to use these cryptographic primitives.
In 2013, Hayes \etal~\cite{HE13} designed another secure \modbus protocol using
hash-based message authentication codes (HMACs) and built on STCP (Stream
Transmission Control Protocol).

To the best of our knowledge, the only work directly making use of formal
methods to prove the security of industrial protocols or find attack against
them is from Graham \etal~\cite{GP05} in 2005.
They proposed a formal verification of \dnp using \ofmc~\cite{BMV03} (Open-Source Fixed-Point Model-Checker) and
\spear~\cite{SH01} (Security Protocol Engineering and Analysis Resource).
%% \TODO Sadly we were not able to access their modelings to discuss them with
%% ours.
%In 2008, Dutertre~\cite{Dut08} detailed formal specifications of \modbus
%developed using PVS, a generic theorem prover in order to help proving the
%consistancy of an implementation with the standards.

%\subsection{Contributions}
\paragraph{Contributions:}

We propose a formal analysis of the security of
% standard \modbus protocol and
%the correction proposed in~\cite{FCMT09}.%,HE13}.
%We also assess the 
the sub-protocols involved in the \opcua handshake, namely \opcua
\securechan and \opcua \session.  We are able to find
attacks against both of them and provide some countermeasures.  This
work makes use of one of the most efficient tools in the domain of
cryptographic protocol verification according to \cite{LP15},
namely \proverif developed by Blanchet \etal~\cite{Bla01}.  It
analyzes a protocol written either in Horn clauses format or using a
subset of the Pi-calculus for an unbounded number of sessions
considering the classical Dolev-Yao intruder model~\cite{DY81}.  This
powerful intruder controls the network, listens, stops, forges,
replays or modifies some messages according to its capabilities and
knowledge.  The perfect encryption hypothesis is assumed, meaning that
it is not possible to decrypt a ciphertext without its encryption key
or to forge a signature without knowing the secret key.  In this
context, \proverif can verify security properties of
a protocol such as secrecy and authentication.  The first property
ensures that a secret message cannot be discovered by an unauthorized
agent (including the intruder).  The authentication property means
that one participant of the protocol is guaranteed to communicate with
another one.

\paragraph{Outline:} In the Section~\ref{sec:secure_channel}, we analyse the
security of \opcua \securechan and \opcua \session in Section~\ref{sec:session}.
Finally, we conclude in Section~\ref{sec:conclusion}.
