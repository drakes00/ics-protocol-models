\begin{tikzpicture}[
    arrow/.style={thick,<-,shorten >=2pt,shorten <=2pt,>=stealth},
]
    \draw (0,0) rectangle (8,2.5) node at (4,.4) {Aramis}; % ARAMIS
    
    \draw (.5,1) rectangle (2.5,2) node at (1.5,1.5) {Client}; % GH
    \draw (5.5,1) rectangle (7.5,2) node at (6.5,1.5) {Server}; % GB

    \draw[arrow,green] (-.5,.5) -- (.5,1.25); % Arrow BL
    \draw[arrow,green] (-.5,1.5) -- (.5,1.5); % Arrow ML
    \draw[arrow,green] (-.5,2.5) -- (.5,1.75); % Arrow TL

    \draw[arrow,green] (7.5,1.25) -- (8.5,.5); % Arrow BR
    \draw[arrow,red] (7.5,1.5) -- (8.5,1.5); % Arrow MR
    \draw[arrow,red] (7.5,1.75) -- (8.5,2.5); % Arrow TR
    
    \draw (3,1) rectangle (5,2) node at (4,1.5) {Filter}; % Filters

    \draw[arrow,blue,very thick] (5,1.5) -- (5.5,1.5); % Arrow SF
    \draw[arrow,blue,very thick] (2.5,1.5) -- (3,1.5); % Arrow FC

    \draw (3,3) rectangle (5,4) node at (4,3.5) {Rules}; % Rules
    \draw[arrow] (4,2) -- (4,3);

    \draw (0,3) rectangle (2,4) node at (.45,3.85) {\tiny Legend:};
    \draw[arrow,blue,very thick] (.7, 3.6) -- (.2,3.6) node [anchor=west] at (.5,3.6) {\tiny Ad-hoc lang.};
    \draw[arrow,red] (.7, 3.37) -- (.2,3.37) node [anchor=west] at (.5,3.37) {\tiny Attack msg.};
    \draw[arrow,green] (.7, 3.12) -- (.2,3.12) node [anchor=west] at (.5,3.12) {\tiny Normal msg.};
\end{tikzpicture}
