\documentclass{article}
%\documentclass{IEEEtran}

%\usepackage{fullpage}
%\usepackage[left=3.8cm,right=3.8cm]{geometry}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

\usepackage[french]{babel}

\usepackage{authblk}

\usepackage{listings}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{graphicx}
\graphicspath{{assets/}}
\makeatletter
    \def\input@path{{assets/}}
\makeatother

\usepackage{xstring}

%\usepackage{times}

\usepackage{auto-pst-pdf}
\ifpdf
    \usepackage{todonotes}
    \usepackage{tikz}
    \usetikzlibrary{arrows,automata}
\else
    \usepackage{msc}
\fi

% ========== Don't touch ==========
\makeatletter
    \def\msc@frame{no}
    \def\msc@settitle{}
\makeatother

\newcommand{\dosmnone}[3]{#1}
\newcommand{\dosmsign}[3]{#1, $\left\{\mbox{#1}\right\}_{\mbox{#3}}$}
\newcommand{\dosmsignandencrypt}[3]{$\left\{\mbox{#1}\right\}_{\mbox{#2}}$, $\left\{\mbox{#1}\right\}_{\mbox{#3}}$}

\newcommand{\smn}{None}
\newcommand{\sms}{Sign}
\newcommand{\smse}{SignAndEncrypt}

\newcommand{\sm}{\IfStrEq{\smname}{\smn}{\dosmnone}{\IfStrEq{\smname}{\sms}{\dosmsign}{\dosmsignandencrypt}}}

\newcommand{\ifsmnotnone}[1]{\IfStrEq{\smname}{\smn}{}{#1}}
\newcommand{\smname}{\smn}
% ========== Don't touch ==========

\usepackage{xspace}

\newcommand{\UNSAFE}{{\color{red!50!black} UNSAFE}\xspace}
\newcommand{\SAFE}{{\color{green!50!black} SAFE}\xspace}
\newcommand{\ex}{ex. :\xspace}
\newcommand{\proverif}{ProVerif\xspace}
\newcommand{\avispa}{AVISPA\xspace}
\newcommand{\clatse}{CL-Atse\xspace}
\newcommand{\ofmc}{OFMC\xspace}
\newcommand{\satmc}{SAT-MC\xspace}
\newcommand{\tasp}{TA4SP\xspace}
\newcommand{\tamarin}{Tamarin\xspace}
\newcommand{\scyther}{Scyther\xspace}
\newcommand{\aramis}{ARAMIS\xspace}
\newcommand{\opcua}{OPC-UA\xspace}

\title{Filtrage et vérification de flux métiers dans les systèmes industriels}

\author{
    Maxime Puys, Marie-Laure Potet et Jean-Louis Roch\\
    Univ. Grenoble Alpes, VERIMAG, F-38000 Grenoble, France\\
    CNRS, VERIMAG, F-38000 Grenoble, France\\
    {\texttt Prénom.Nom@imag.fr}
    \thanks{Ce travail a été partiellement financé par le LabEx PERSYVAL-Lab
    (ANR–11-LABX-0025) et le projet Programme Investissement d’Avenir FSN AAP
    Sécurité Numérique \no 3 ARAMIS (P3342-146798).}
}

\date{}

\begin{document}

\maketitle

\begin{abstract}
    De plus en plus d’attaques informatiques contre les systèmes industriels
    sont présentées par les médias.
    Ces systèmes tendent à devenir géographiquement distribués et à communiquer
    via des réseaux vulnérables tels qu’Internet.
    Régissant de nos jours des domaines tels que la production et la
    distribution d'énergie, l'assainissement des eaux ou le nucléaire, la
    sécurité des systèmes industriels devient une priorité pour les gouvernements.
    L'une des difficultés de la sécurisation des infrastructures industrielles est
    la conciliation des propriétés de sécurité avec les attendus métiers en
    terme de flux.
    Pour ce faire, nous regardons comment filtrer les messages en tenant compte
    des aspects métiers.
    Ensuite, nous nous intéressons à la vérification formelle des propriétés
    des protocoles de communication industriels.
    Enfin nous proposons une approche {\em Model-Based Testing} permettant de
    générer des attaques informatiques contre des systèmes industriels.
    %en fonction de paramètres tels que les objectifs, les capacités des
    %attaquants et leur positions dans une architecture réseau.
\end{abstract}

\section{Introduction}

De plus en plus d'attaques informatiques contre les systèmes industriels sont
présentées par les médias.
Ces systèmes tendent à devenir géographiquement distribués et à communiquer via
des réseaux vulnérables tels qu'Internet.
Depuis son apparition, l'informatique industrielle a toujours été physiquement
isolée du reste du monde.
Les attaques nécessitaient d'être présent sur le site et étaient peu probables.
L'industrie a donc préféré se focaliser sur la protection contre les risques
naturels et les erreurs de manipulation, appelée {\em sûreté}~\cite{Pie10,PS09,
IAEA96}.
La particularité de la sécurité informatique face à la sûreté est la volonté
de nuire de l'attaquant, doublée de sa capacité à réfléchir et à apprendre de
ses erreurs, suivant ainsi l'état de l'art de la sécurité informatique.
Aujourd'hui, ces systèmes régissent aussi bien la production et la distribution
d'énergie, l'assainissement des eaux ou le nucléaire.
Il apparaît que leur protection contre les attaques informatiques devient une
priorité des agences gouvernementales avec notamment la sécurisation des
opérateurs d'importance vitale~\cite{Leg07_oiv}, détaillée dans le Livre blanc
sur la défense et la sécurité nationale (édition de 2008~\cite{LivreBlanc08}
puis de 2013~\cite{LivreBlanc13}).

L'une des difficultés de la sécurisation des infrastructures industrielles est la
conciliation des propriétés de sécurité avec les attendus métiers en terme de
flux, parfois en adéquation mais aussi parfois antagonistes~\cite{Pie10}.
Pour ce faire, la section \ref{sec:contribs} détaille trois axes :
(i) le filtrage des messages tenant compte des aspects métiers, (ii) la
vérification formelle des propriétés des protocoles de communication industriels,
(iii) un approche {\em Model-Based Testing} pour décrire les attaques
informatiques contre les systèmes industriels en fonction de paramètres tels que
les objectifs, les capacités des attaquants et leur position dans une
architecture réseau.
Enfin la section \ref{sec:concl} conclut.

\section{Contributions}\label{sec:contribs}

Cette section propose trois axes pour la sécurisation des infrastructures
industrielles, s'intéressant à différents niveaux d'abstraction de sécurité
et qui devraient être intégrés dans une approche de bout en bout.

\subsection{Filtrage des communications}\label{sec:aramis}

Un premier axe de notre travail se déroule dans le cadre du projet \aramis{}
\cite{aramis} qui vise à proposer un dispositif permettant de cloisonner
physiquement les réseaux et de filtrer les échanges pour rejeter tout flux
identifié comme non autorisé, donc potentiellement malveillant.
Cette fonctionnalité distingue les filtres~\cite{DESIRE10,StoneGate11,rWeb13,
DZNetwork14} des systèmes de détection d'intrusion~\cite{StoneGate13,Pax99,
Suricata,Snort}.
La spécificité de ce projet est de fournir simultanément ces deux
fonctionnalités dans un même dispositif robuste, dont l'ajout n'impacte pas le
système existant.
%Ceci, tout en le protégeant d'agressions qu'elles soient issues du monde
%extérieur ou internes.
%La figure \ref{fig:aramis} montre le placement du dispositif \aramis{} dans un
%système industriel.
La majeure partie des communications se résument à des requêtes envoyées par des
clients vers des systèmes SCADA (système de contrôle et d'acquisition de données
à grande échelle).
Cependant, les protocoles plus récents proposent des services plus complexes
tels que la découverte interactive des composants du serveur ou la demande
d'historique des commandes.
Afin de palier les attaques portant sur la couche réseaux, tous les messages
sont interprétés puis transformés dans une langage intermédiaire.
Cette conversion des protocoles de communication en un format commun permet
d'effectuer un filtrage applicatif en prenant en compte les besoins liés au
corps de métier du système industriel à protéger.
Ainsi, ce filtrage peut prendre plusieurs formes incluant :
\begin{itemize}
    \item La vérification des identités des clients et serveurs communiquant
        entre eux,
    \item La vérification des permissions d'accès des clients aux différentes
        variables des serveurs,
    \item La vérification des contenus des messages eux-mêmes avec la
        possibilité de garder en mémoire l'état de certaines variables du
        serveur afin détecter des messages rendu illicites par le contexte des
        messages précédents.
        Ce type de filtrage peut par exemple empêcher l'ouverture d'un
        disjoncteur déjà ouvert.
\end{itemize}

Comme tout filtrage local, il ne garantit qu'une décision dépendant de sa
connaissance de l'état du système.
Enfin, les systèmes industriels acceptant une latence maximale de l'ordre du
centième de seconde, le filtrage doit être pensé pour une efficacité maximale.
Cela passe par l'utilisation de structures de données possédant une faible 
complexité d'accès ou de recherche tels que des tables de hashage ou des
B-Arbres~\cite{Bay71}.
De plus, des analyses de pire temps d'exécution devraient assurer le respect
des contraintes temporelles.

%\begin{figure}
%    \resizebox{\textwidth}{!}{
%        \input{aramis}
%    }
%    \caption{Placement du dispositif \aramis{}}
%    \label{fig:aramis}
%\end{figure}

\subsection{Vérification formelle de protocoles industriels}\label{sec:protocols}

%Les protocoles sont un ingrédient essentiel des communications réseaux de notre
%époque.
%Ces communications pouvant être attaquées soit en espionnant le trafic, soit en
%le modifiant,
Il apparaît depuis plusieurs décennies que la preuve formelle de
la sécurité des protocoles de communication est un enjeu majeur.
Un exemple connu est {\em miTLS} \cite{BFKPS13}, une implémentation prouvée
du protocole TLS \cite{DR08} servant par exemple au paiement en ligne.
%Les traveaux d'analyse de protocoles ont commencé avec la contribution de
%G. Lowe \cite{Low96}, brisant le protocole {\em Needham-Schoeder} en 1995.
%Depuis, les outils d'analyse et les travaux de modélisation se sont multipliés.
%Ces outils reposent sur des approches théoriques variées telles que la
%réécriture, la résolution de contrainte, les clauses de Horn ou les
%{\em SAT-solvers}.
Il existe plusieurs outils permettant de modéliser des protocoles afin d'en
tester la sécurité tels que : \avispa~\cite{AVISPA05}%
%(\ofmc~\cite{BMV03}, \tasp~\cite{TA4SP}, \clatse~\cite{Tur06}, \satmc~\cite{AC04})
, \tamarin~\cite{MSCB13}, \scyther~\cite{Cre08}, \proverif~\cite{Bla01}.
Ces outils considèrent un intrus dit de Dolev-Yao \cite{DY81} qui contrôle le
réseau, espionne, stoppe, forge, modifie, entrelace ou rejoue des messages en
utilisant la connaissance des messages qu'il a appris précédemment.
Il est alors possible de spécifier des propriétés telles que l'{\em intégrité
d'origine} (le plus souvent assurée par des mécanismes d'authentification) et la
{\em confidentialité}.
La première propriété signifie qu'un participant est convaincu qu'il parle avec
un participant bien identifié.
La confidentialité assure qu'un agent (y compris l'intrus) n'accède qu'aux
messages qui lui sont destinés.
Enfin, les outils se basent sur l'hypothèse du chiffrement parfait, selon
laquelle il n'est pas possible de déchiffrer un message sans la chef de
chiffrement ou d'usurper une signature.

Les protocoles de communication des systèmes industriels tels que
\opcua~\cite{MLD09} (futur standard des communications industrielles) n'ont
jamais été vérifiés de cette façon.
Nous proposons donc de tester formellement la sécurité de ces protocoles et
notamment les sous-protocoles {\em OpenSecureChannel} et {\em CreateSession},
intervenant dans le {\em handshake} d'\opcua, à l'aide de l'outil \proverif.
% à l'aide
%d'outils de vérification de protocoles.
%En violant le secret, un intrus pourrait compromettre une clef de chiffrement,
%ce qui révèlerait le contenu des communication.
%D'autre part, en attaquant l'autentification, un intrus pourrait se faire passer
%pour un serveur aux yeux d'un client ou beaucoup plus grave, se faire passer
%pour un client aux yeux d'un serveur.
%Ce scénario gravissime autoriserait l'intrus à lancer des commandes ayant un
%réel impact sur le monde extérieur.
Enfin, la difficulté d'appliquer ce type d'approche aux protocoles industriels
repose sur le fait qu'ils s'intéressent plus à la {\em disponibilité} et à 
l'{\em intégrité des messages} qu'à l'{\em intégrité d'origine} et la
{\em confidentialité}.
L'expression de ces propriétés dans les langages des outils est donc un défi
important.

\subsection{Modèles d'attaques}\label{sec:models}

%Enfin, nous souhaitons tirer parti des travaux sur les méthodes d'analyse
%de risques telles que EBIOS \cite{EBIOS} et MEHARI \cite{MEHARI}.
%Ces méthodes servent à générer automatiquement des scénarios d'attaques en
%fonction des objectifs des attaquants et des biens que l'on souhaite protéger.

Enfin, nous nous intéressons à la mise en place d'un modèle générique permettant
de produire des scénarios d'attaques informatiques contre les systèmes industriels.
Cette phase d'analyse vise à être incluse dans une approche globale allant de la
modélisation du système à la production automatique des paquets réseau
implémentant et testant les attaques identifiées.
Cette approche {\em Model-Based Testing} aura pour objectif de vérifier si les
attaques trouvées par l'analyse de la modélisation sont  effectivement jouables
sur une plate-forme, voir de quantifier leur plausibilité.
La figure \ref{fig:metho} illustre la méthodologie que nous voulons développer.

\begin{figure}[htb]
    \centering
    \resizebox{.75\textwidth}{!}{
        \input{metho}
    }
    \caption{Méthodologie globale}
    \label{fig:metho}
\end{figure}

En partant d'une modélisation de l'infrastructure du système industriel et des
protections pouvant être présentes sur celui-ci (\ex des protocoles de
communication sécurisés), nous sommes en mesure de produire des suites d'actions
à réaliser par un attaquant pour atteindre un objectif.
Ces actions sont ensuite concrétisées en paquets réseaux à l'aide d'une
bibliothèque décrivant comment implémenter les vecteurs 
pour chaque protocole (\ex comment modifier un paquet \opcua, ou comment
outrepasser l'authentification d'un serveur SCADA).
Enfin, ces paquets sont instanciés, soit de manière aléatoire, soit en fonction
de la logique applicative de la plate-forme.

\section{Conclusion}\label{sec:concl}

En conclusion, cet article explique le filtrage au sein du dispositif \aramis.
Il aborde ensuite l'application d'outils de vérification de protocoles
cryptographiques aux protocoles de communication industriels.
Enfin il propose une approche {\em Model-Based Testing} permettant de jouer
des attaques obtenues à l'aide de l'analyse d'une modélisation du système.
Ces trois axes, présentés dans la figure \ref{fig:thesis} sont complémentaires.
En effet, l'approche modèles d'attaques est une approche globale dépendant de
différents paramètres incluant notamment les propriétés de sécurité offertes par les
protocoles de communication.
Or cette approche ne peut être pertinente que si ces propriétés sont prouvées.
Enfin, le filtre \aramis étant développé dans le cadre d'un projet industriel,
il est alors possible de tester sa capacité à bloquer des attaques à l'aide
de notre approche de modélisation.

\begin{figure}[htb]
    \centering
    \resizebox{.85\textwidth}{!}{
        \input{thesis}
    }
    \caption{Articulation des axes de recherche}
    \label{fig:thesis}
\end{figure}



%\section{Auteur}
%
%Maxime Puys est doctorant en deuxième année au laboratoire Verimag de
%l'Université Grenoble Alpes.
%Sous la direction de Marie-Laure Potet (Prof. Grenoble INP) et Jean-Louis Roch
%(MCF. Grenoble INP), il travaille sur la sécurité informatique dans les
%systèmes d'information industriels.
%Diplômé en 2014 du {\em Master Sécurité, Audit et Informatique Légale} de
%l'Université Grenoble Alpes, il a participé pendant deux ans à des recherches
%sur la sécurité des cartes à puce contre les attaques par fautes dans le
%laboratoire Verimag et l'entreprise SAFRAN Morpho.
%Intéressé par les méthodes formelles dans le domaine de la sécurité, il
%participe à les intégrer dans les projets concrets des industriels.

\bibliographystyle{plain-fr}
\bibliography{phdBiblio}

\end{document}
