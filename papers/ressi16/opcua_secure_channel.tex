\renewcommand{\smname}{\smn}
\resizebox{\textwidth}{!}{
    \begin{postscript}
        \begin{msc}{Secure channel creation}
            \setlength{\envinstdist}{1.5\envinstdist}
            \setlength{\instdist}{3.5\instdist}

            \declinst{cli}{OpcUaClient}{}
            \declinst{disco}{DiscoreryEndpoint}{}
            \declinst{sess}{SessionEndpoint}{}

            \mess{GetEndpointsRequest}[b]{cli}{disco}
            \nextlevel[1.5]

            \mess{SP, \smname, UP, pk(SessionEndpoint)}[b]{disco}{cli}
            \nextlevel[1.5]
            
            \action*{Validates pk(SessionEndpoint)}{cli}
            \nextlevel[2]
            
            \action*{Generates N$_{C}$}{cli}
            \nextlevel[2]

            \mess{pk(OpcUaClient), \sm{SP, $g^{N_{C}}$}{pk(SessionEndpoint)}{sk(OpcUaClient)}}[b]{cli}{sess}
            \nextlevel[2]

            \action*{Validates pk(OpcUaClient) }{sess}
            \nextlevel[2]

            \action*{Generates N$_{S}$ }{sess}
            \nextlevel[2]

            \ifsmnotnone{%
                \action*{$K_{srv}$ = $(g^{N_{C}})^{N_{S}}$ }{sess}
                \nextlevel[2]
            }

            \mess{\sm{$g^{N_{S}}$}{pk(OpcUaClient)}{sk(SessionEndpoint)}}[b]{sess}{cli}
            \nextlevel[2]

            \ifsmnotnone{%
                \action*{$K_{cli}$ = $(g^{N_{S}})^{N_{C}}$}{cli}
                \nextlevel[2]
            }
        \end{msc}
    \end{postscript}
}
